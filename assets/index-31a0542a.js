function az(e,n){for(var a=0;a<n.length;a++){const u=n[a];if(typeof u!="string"&&!Array.isArray(u)){for(const f in u)if(f!=="default"&&!(f in e)){const w=Object.getOwnPropertyDescriptor(u,f);w&&Object.defineProperty(e,f,w.get?w:{enumerable:!0,get:()=>u[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const w of f)if(w.type==="childList")for(const p of w.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&u(p)}).observe(document,{childList:!0,subtree:!0});function a(f){const w={};return f.integrity&&(w.integrity=f.integrity),f.referrerPolicy&&(w.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?w.credentials="include":f.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function u(f){if(f.ep)return;f.ep=!0;const w=a(f);fetch(f.href,w)}})();var EA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sz={exports:{}},wS={},lz={exports:{}},Jo={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib=Symbol.for("react.element"),TV=Symbol.for("react.portal"),EV=Symbol.for("react.fragment"),IV=Symbol.for("react.strict_mode"),CV=Symbol.for("react.profiler"),AV=Symbol.for("react.provider"),PV=Symbol.for("react.context"),MV=Symbol.for("react.forward_ref"),kV=Symbol.for("react.suspense"),RV=Symbol.for("react.memo"),DV=Symbol.for("react.lazy"),Q3=Symbol.iterator;function OV(e){return e===null||typeof e!="object"?null:(e=Q3&&e[Q3]||e["@@iterator"],typeof e=="function"?e:null)}var cz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uz=Object.assign,hz={};function T0(e,n,a){this.props=e,this.context=n,this.refs=hz,this.updater=a||cz}T0.prototype.isReactComponent={};T0.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};T0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function dz(){}dz.prototype=T0.prototype;function IA(e,n,a){this.props=e,this.context=n,this.refs=hz,this.updater=a||cz}var CA=IA.prototype=new dz;CA.constructor=IA;uz(CA,T0.prototype);CA.isPureReactComponent=!0;var eR=Array.isArray,pz=Object.prototype.hasOwnProperty,AA={current:null},fz={key:!0,ref:!0,__self:!0,__source:!0};function mz(e,n,a){var u,f={},w=null,p=null;if(n!=null)for(u in n.ref!==void 0&&(p=n.ref),n.key!==void 0&&(w=""+n.key),n)pz.call(n,u)&&!fz.hasOwnProperty(u)&&(f[u]=n[u]);var s=arguments.length-2;if(s===1)f.children=a;else if(1<s){for(var L=Array(s),F=0;F<s;F++)L[F]=arguments[F+2];f.children=L}if(e&&e.defaultProps)for(u in s=e.defaultProps,s)f[u]===void 0&&(f[u]=s[u]);return{$$typeof:ib,type:e,key:w,ref:p,props:f,_owner:AA.current}}function LV(e,n){return{$$typeof:ib,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function PA(e){return typeof e=="object"&&e!==null&&e.$$typeof===ib}function zV(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return n[a]})}var tR=/\/+/g;function PE(e,n){return typeof e=="object"&&e!==null&&e.key!=null?zV(""+e.key):n.toString(36)}function Yw(e,n,a,u,f){var w=typeof e;(w==="undefined"||w==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(w){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case ib:case TV:p=!0}}if(p)return p=e,f=f(p),e=u===""?"."+PE(p,0):u,eR(f)?(a="",e!=null&&(a=e.replace(tR,"$&/")+"/"),Yw(f,n,a,"",function(F){return F})):f!=null&&(PA(f)&&(f=LV(f,a+(!f.key||p&&p.key===f.key?"":(""+f.key).replace(tR,"$&/")+"/")+e)),n.push(f)),1;if(p=0,u=u===""?".":u+":",eR(e))for(var s=0;s<e.length;s++){w=e[s];var L=u+PE(w,s);p+=Yw(w,n,a,L,f)}else if(L=OV(e),typeof L=="function")for(e=L.call(e),s=0;!(w=e.next()).done;)w=w.value,L=u+PE(w,s++),p+=Yw(w,n,a,L,f);else if(w==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return p}function ww(e,n,a){if(e==null)return e;var u=[],f=0;return Yw(e,u,"","",function(w){return n.call(a,w,f++)}),u}function NV(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Mu={current:null},Kw={transition:null},jV={ReactCurrentDispatcher:Mu,ReactCurrentBatchConfig:Kw,ReactCurrentOwner:AA};Jo.Children={map:ww,forEach:function(e,n,a){ww(e,function(){n.apply(this,arguments)},a)},count:function(e){var n=0;return ww(e,function(){n++}),n},toArray:function(e){return ww(e,function(n){return n})||[]},only:function(e){if(!PA(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Jo.Component=T0;Jo.Fragment=EV;Jo.Profiler=CV;Jo.PureComponent=IA;Jo.StrictMode=IV;Jo.Suspense=kV;Jo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jV;Jo.cloneElement=function(e,n,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=uz({},e.props),f=e.key,w=e.ref,p=e._owner;if(n!=null){if(n.ref!==void 0&&(w=n.ref,p=AA.current),n.key!==void 0&&(f=""+n.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(L in n)pz.call(n,L)&&!fz.hasOwnProperty(L)&&(u[L]=n[L]===void 0&&s!==void 0?s[L]:n[L])}var L=arguments.length-2;if(L===1)u.children=a;else if(1<L){s=Array(L);for(var F=0;F<L;F++)s[F]=arguments[F+2];u.children=s}return{$$typeof:ib,type:e.type,key:f,ref:w,props:u,_owner:p}};Jo.createContext=function(e){return e={$$typeof:PV,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:AV,_context:e},e.Consumer=e};Jo.createElement=mz;Jo.createFactory=function(e){var n=mz.bind(null,e);return n.type=e,n};Jo.createRef=function(){return{current:null}};Jo.forwardRef=function(e){return{$$typeof:MV,render:e}};Jo.isValidElement=PA;Jo.lazy=function(e){return{$$typeof:DV,_payload:{_status:-1,_result:e},_init:NV}};Jo.memo=function(e,n){return{$$typeof:RV,type:e,compare:n===void 0?null:n}};Jo.startTransition=function(e){var n=Kw.transition;Kw.transition={};try{e()}finally{Kw.transition=n}};Jo.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Jo.useCallback=function(e,n){return Mu.current.useCallback(e,n)};Jo.useContext=function(e){return Mu.current.useContext(e)};Jo.useDebugValue=function(){};Jo.useDeferredValue=function(e){return Mu.current.useDeferredValue(e)};Jo.useEffect=function(e,n){return Mu.current.useEffect(e,n)};Jo.useId=function(){return Mu.current.useId()};Jo.useImperativeHandle=function(e,n,a){return Mu.current.useImperativeHandle(e,n,a)};Jo.useInsertionEffect=function(e,n){return Mu.current.useInsertionEffect(e,n)};Jo.useLayoutEffect=function(e,n){return Mu.current.useLayoutEffect(e,n)};Jo.useMemo=function(e,n){return Mu.current.useMemo(e,n)};Jo.useReducer=function(e,n,a){return Mu.current.useReducer(e,n,a)};Jo.useRef=function(e){return Mu.current.useRef(e)};Jo.useState=function(e){return Mu.current.useState(e)};Jo.useSyncExternalStore=function(e,n,a){return Mu.current.useSyncExternalStore(e,n,a)};Jo.useTransition=function(){return Mu.current.useTransition()};Jo.version="18.2.0";lz.exports=Jo;var fe=lz.exports;const ts=S0(fe),I2=az({__proto__:null,default:ts},[fe]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BV=fe,FV=Symbol.for("react.element"),VV=Symbol.for("react.fragment"),UV=Object.prototype.hasOwnProperty,$V=BV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GV={key:!0,ref:!0,__self:!0,__source:!0};function gz(e,n,a){var u,f={},w=null,p=null;a!==void 0&&(w=""+a),n.key!==void 0&&(w=""+n.key),n.ref!==void 0&&(p=n.ref);for(u in n)UV.call(n,u)&&!GV.hasOwnProperty(u)&&(f[u]=n[u]);if(e&&e.defaultProps)for(u in n=e.defaultProps,n)f[u]===void 0&&(f[u]=n[u]);return{$$typeof:FV,type:e,key:w,ref:p,props:f,_owner:$V.current}}wS.Fragment=VV;wS.jsx=gz;wS.jsxs=gz;sz.exports=wS;var y=sz.exports,kI={},_z={exports:{}},Yh={},yz={exports:{}},vz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(Qt,sr){var Tr=Qt.length;Qt.push(sr);e:for(;0<Tr;){var ln=Tr-1>>>1,vn=Qt[ln];if(0<f(vn,sr))Qt[ln]=sr,Qt[Tr]=vn,Tr=ln;else break e}}function a(Qt){return Qt.length===0?null:Qt[0]}function u(Qt){if(Qt.length===0)return null;var sr=Qt[0],Tr=Qt.pop();if(Tr!==sr){Qt[0]=Tr;e:for(var ln=0,vn=Qt.length,wi=vn>>>1;ln<wi;){var hi=2*(ln+1)-1,Vn=Qt[hi],Oi=hi+1,fn=Qt[Oi];if(0>f(Vn,Tr))Oi<vn&&0>f(fn,Vn)?(Qt[ln]=fn,Qt[Oi]=Tr,ln=Oi):(Qt[ln]=Vn,Qt[hi]=Tr,ln=hi);else if(Oi<vn&&0>f(fn,Tr))Qt[ln]=fn,Qt[Oi]=Tr,ln=Oi;else break e}}return sr}function f(Qt,sr){var Tr=Qt.sortIndex-sr.sortIndex;return Tr!==0?Tr:Qt.id-sr.id}if(typeof performance=="object"&&typeof performance.now=="function"){var w=performance;e.unstable_now=function(){return w.now()}}else{var p=Date,s=p.now();e.unstable_now=function(){return p.now()-s}}var L=[],F=[],G=1,H=null,X=3,ne=!1,ie=!1,se=!1,Te=typeof setTimeout=="function"?setTimeout:null,ue=typeof clearTimeout=="function"?clearTimeout:null,ce=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function de(Qt){for(var sr=a(F);sr!==null;){if(sr.callback===null)u(F);else if(sr.startTime<=Qt)u(F),sr.sortIndex=sr.expirationTime,n(L,sr);else break;sr=a(F)}}function Ee(Qt){if(se=!1,de(Qt),!ie)if(a(L)!==null)ie=!0,Xt(Ne);else{var sr=a(F);sr!==null&&Ht(Ee,sr.startTime-Qt)}}function Ne(Qt,sr){ie=!1,se&&(se=!1,ue(Ge),Ge=-1),ne=!0;var Tr=X;try{for(de(sr),H=a(L);H!==null&&(!(H.expirationTime>sr)||Qt&&!Et());){var ln=H.callback;if(typeof ln=="function"){H.callback=null,X=H.priorityLevel;var vn=ln(H.expirationTime<=sr);sr=e.unstable_now(),typeof vn=="function"?H.callback=vn:H===a(L)&&u(L),de(sr)}else u(L);H=a(L)}if(H!==null)var wi=!0;else{var hi=a(F);hi!==null&&Ht(Ee,hi.startTime-sr),wi=!1}return wi}finally{H=null,X=Tr,ne=!1}}var rt=!1,tt=null,Ge=-1,_t=5,yt=-1;function Et(){return!(e.unstable_now()-yt<_t)}function Wt(){if(tt!==null){var Qt=e.unstable_now();yt=Qt;var sr=!0;try{sr=tt(!0,Qt)}finally{sr?Ar():(rt=!1,tt=null)}}else rt=!1}var Ar;if(typeof ce=="function")Ar=function(){ce(Wt)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,nr=mt.port2;mt.port1.onmessage=Wt,Ar=function(){nr.postMessage(null)}}else Ar=function(){Te(Wt,0)};function Xt(Qt){tt=Qt,rt||(rt=!0,Ar())}function Ht(Qt,sr){Ge=Te(function(){Qt(e.unstable_now())},sr)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Qt){Qt.callback=null},e.unstable_continueExecution=function(){ie||ne||(ie=!0,Xt(Ne))},e.unstable_forceFrameRate=function(Qt){0>Qt||125<Qt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_t=0<Qt?Math.floor(1e3/Qt):5},e.unstable_getCurrentPriorityLevel=function(){return X},e.unstable_getFirstCallbackNode=function(){return a(L)},e.unstable_next=function(Qt){switch(X){case 1:case 2:case 3:var sr=3;break;default:sr=X}var Tr=X;X=sr;try{return Qt()}finally{X=Tr}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Qt,sr){switch(Qt){case 1:case 2:case 3:case 4:case 5:break;default:Qt=3}var Tr=X;X=Qt;try{return sr()}finally{X=Tr}},e.unstable_scheduleCallback=function(Qt,sr,Tr){var ln=e.unstable_now();switch(typeof Tr=="object"&&Tr!==null?(Tr=Tr.delay,Tr=typeof Tr=="number"&&0<Tr?ln+Tr:ln):Tr=ln,Qt){case 1:var vn=-1;break;case 2:vn=250;break;case 5:vn=1073741823;break;case 4:vn=1e4;break;default:vn=5e3}return vn=Tr+vn,Qt={id:G++,callback:sr,priorityLevel:Qt,startTime:Tr,expirationTime:vn,sortIndex:-1},Tr>ln?(Qt.sortIndex=Tr,n(F,Qt),a(L)===null&&Qt===a(F)&&(se?(ue(Ge),Ge=-1):se=!0,Ht(Ee,Tr-ln))):(Qt.sortIndex=vn,n(L,Qt),ie||ne||(ie=!0,Xt(Ne))),Qt},e.unstable_shouldYield=Et,e.unstable_wrapCallback=function(Qt){var sr=X;return function(){var Tr=X;X=sr;try{return Qt.apply(this,arguments)}finally{X=Tr}}}})(vz);yz.exports=vz;var qV=yz.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xz=fe,Hh=qV;function In(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)n+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bz=new Set,w1={};function Iy(e,n){r0(e,n),r0(e+"Capture",n)}function r0(e,n){for(w1[e]=n,e=0;e<n.length;e++)bz.add(n[e])}var Cm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),RI=Object.prototype.hasOwnProperty,WV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,rR={},nR={};function HV(e){return RI.call(nR,e)?!0:RI.call(rR,e)?!1:WV.test(e)?nR[e]=!0:(rR[e]=!0,!1)}function ZV(e,n,a,u){if(a!==null&&a.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return u?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XV(e,n,a,u){if(n===null||typeof n>"u"||ZV(e,n,a,u))return!0;if(u)return!1;if(a!==null)switch(a.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function ku(e,n,a,u,f,w,p){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=u,this.attributeNamespace=f,this.mustUseProperty=a,this.propertyName=e,this.type=n,this.sanitizeURL=w,this.removeEmptyString=p}var Pc={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pc[e]=new ku(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Pc[n]=new ku(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pc[e]=new ku(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pc[e]=new ku(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pc[e]=new ku(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pc[e]=new ku(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pc[e]=new ku(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pc[e]=new ku(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pc[e]=new ku(e,5,!1,e.toLowerCase(),null,!1,!1)});var MA=/[\-:]([a-z])/g;function kA(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(MA,kA);Pc[n]=new ku(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(MA,kA);Pc[n]=new ku(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(MA,kA);Pc[n]=new ku(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pc[e]=new ku(e,1,!1,e.toLowerCase(),null,!1,!1)});Pc.xlinkHref=new ku("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pc[e]=new ku(e,1,!1,e.toLowerCase(),null,!0,!0)});function RA(e,n,a,u){var f=Pc.hasOwnProperty(n)?Pc[n]:null;(f!==null?f.type!==0:u||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(XV(n,a,f,u)&&(a=null),u||f===null?HV(n)&&(a===null?e.removeAttribute(n):e.setAttribute(n,""+a)):f.mustUseProperty?e[f.propertyName]=a===null?f.type===3?!1:"":a:(n=f.attributeName,u=f.attributeNamespace,a===null?e.removeAttribute(n):(f=f.type,a=f===3||f===4&&a===!0?"":""+a,u?e.setAttributeNS(u,n,a):e.setAttribute(n,a))))}var Lm=xz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sw=Symbol.for("react.element"),Mv=Symbol.for("react.portal"),kv=Symbol.for("react.fragment"),DA=Symbol.for("react.strict_mode"),DI=Symbol.for("react.profiler"),wz=Symbol.for("react.provider"),Sz=Symbol.for("react.context"),OA=Symbol.for("react.forward_ref"),OI=Symbol.for("react.suspense"),LI=Symbol.for("react.suspense_list"),LA=Symbol.for("react.memo"),Dg=Symbol.for("react.lazy"),Tz=Symbol.for("react.offscreen"),iR=Symbol.iterator;function Dx(e){return e===null||typeof e!="object"?null:(e=iR&&e[iR]||e["@@iterator"],typeof e=="function"?e:null)}var Us=Object.assign,ME;function e1(e){if(ME===void 0)try{throw Error()}catch(a){var n=a.stack.trim().match(/\n( *(at )?)/);ME=n&&n[1]||""}return`
`+ME+e}var kE=!1;function RE(e,n){if(!e||kE)return"";kE=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(F){var u=F}Reflect.construct(e,[],n)}else{try{n.call()}catch(F){u=F}e.call(n.prototype)}else{try{throw Error()}catch(F){u=F}e()}}catch(F){if(F&&u&&typeof F.stack=="string"){for(var f=F.stack.split(`
`),w=u.stack.split(`
`),p=f.length-1,s=w.length-1;1<=p&&0<=s&&f[p]!==w[s];)s--;for(;1<=p&&0<=s;p--,s--)if(f[p]!==w[s]){if(p!==1||s!==1)do if(p--,s--,0>s||f[p]!==w[s]){var L=`
`+f[p].replace(" at new "," at ");return e.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",e.displayName)),L}while(1<=p&&0<=s);break}}}finally{kE=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?e1(e):""}function YV(e){switch(e.tag){case 5:return e1(e.type);case 16:return e1("Lazy");case 13:return e1("Suspense");case 19:return e1("SuspenseList");case 0:case 2:case 15:return e=RE(e.type,!1),e;case 11:return e=RE(e.type.render,!1),e;case 1:return e=RE(e.type,!0),e;default:return""}}function zI(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case kv:return"Fragment";case Mv:return"Portal";case DI:return"Profiler";case DA:return"StrictMode";case OI:return"Suspense";case LI:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Sz:return(e.displayName||"Context")+".Consumer";case wz:return(e._context.displayName||"Context")+".Provider";case OA:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case LA:return n=e.displayName||null,n!==null?n:zI(e.type)||"Memo";case Dg:n=e._payload,e=e._init;try{return zI(e(n))}catch{}}return null}function KV(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zI(n);case 8:return n===DA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function i_(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ez(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function JV(e){var n=Ez(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),u=""+e[n];if(!e.hasOwnProperty(n)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var f=a.get,w=a.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(p){u=""+p,w.call(this,p)}}),Object.defineProperty(e,n,{enumerable:a.enumerable}),{getValue:function(){return u},setValue:function(p){u=""+p},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Tw(e){e._valueTracker||(e._valueTracker=JV(e))}function Iz(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var a=n.getValue(),u="";return e&&(u=Ez(e)?e.checked?"true":"false":e.value),e=u,e!==a?(n.setValue(e),!0):!1}function C2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function NI(e,n){var a=n.checked;return Us({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function oR(e,n){var a=n.defaultValue==null?"":n.defaultValue,u=n.checked!=null?n.checked:n.defaultChecked;a=i_(n.value!=null?n.value:a),e._wrapperState={initialChecked:u,initialValue:a,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Cz(e,n){n=n.checked,n!=null&&RA(e,"checked",n,!1)}function jI(e,n){Cz(e,n);var a=i_(n.value),u=n.type;if(a!=null)u==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?BI(e,n.type,a):n.hasOwnProperty("defaultValue")&&BI(e,n.type,i_(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function aR(e,n,a){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var u=n.type;if(!(u!=="submit"&&u!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,a||n===e.value||(e.value=n),e.defaultValue=n}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function BI(e,n,a){(n!=="number"||C2(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var t1=Array.isArray;function $v(e,n,a,u){if(e=e.options,n){n={};for(var f=0;f<a.length;f++)n["$"+a[f]]=!0;for(a=0;a<e.length;a++)f=n.hasOwnProperty("$"+e[a].value),e[a].selected!==f&&(e[a].selected=f),f&&u&&(e[a].defaultSelected=!0)}else{for(a=""+i_(a),n=null,f=0;f<e.length;f++){if(e[f].value===a){e[f].selected=!0,u&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function FI(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(In(91));return Us({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sR(e,n){var a=n.value;if(a==null){if(a=n.children,n=n.defaultValue,a!=null){if(n!=null)throw Error(In(92));if(t1(a)){if(1<a.length)throw Error(In(93));a=a[0]}n=a}n==null&&(n=""),a=n}e._wrapperState={initialValue:i_(a)}}function Az(e,n){var a=i_(n.value),u=i_(n.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),n.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),u!=null&&(e.defaultValue=""+u)}function lR(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Pz(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function VI(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Pz(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ew,Mz=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,a,u,f){MSApp.execUnsafeLocalFunction(function(){return e(n,a,u,f)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Ew=Ew||document.createElement("div"),Ew.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Ew.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function S1(e,n){if(n){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=n;return}}e.textContent=n}var a1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QV=["Webkit","ms","Moz","O"];Object.keys(a1).forEach(function(e){QV.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),a1[n]=a1[e]})});function kz(e,n,a){return n==null||typeof n=="boolean"||n===""?"":a||typeof n!="number"||n===0||a1.hasOwnProperty(e)&&a1[e]?(""+n).trim():n+"px"}function Rz(e,n){e=e.style;for(var a in n)if(n.hasOwnProperty(a)){var u=a.indexOf("--")===0,f=kz(a,n[a],u);a==="float"&&(a="cssFloat"),u?e.setProperty(a,f):e[a]=f}}var eU=Us({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function UI(e,n){if(n){if(eU[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(In(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(In(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(In(61))}if(n.style!=null&&typeof n.style!="object")throw Error(In(62))}}function $I(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var GI=null;function zA(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qI=null,Gv=null,qv=null;function cR(e){if(e=sb(e)){if(typeof qI!="function")throw Error(In(280));var n=e.stateNode;n&&(n=CS(n),qI(e.stateNode,e.type,n))}}function Dz(e){Gv?qv?qv.push(e):qv=[e]:Gv=e}function Oz(){if(Gv){var e=Gv,n=qv;if(qv=Gv=null,cR(e),n)for(e=0;e<n.length;e++)cR(n[e])}}function Lz(e,n){return e(n)}function zz(){}var DE=!1;function Nz(e,n,a){if(DE)return e(n,a);DE=!0;try{return Lz(e,n,a)}finally{DE=!1,(Gv!==null||qv!==null)&&(zz(),Oz())}}function T1(e,n){var a=e.stateNode;if(a===null)return null;var u=CS(a);if(u===null)return null;a=u[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(In(231,n,typeof a));return a}var WI=!1;if(Cm)try{var Ox={};Object.defineProperty(Ox,"passive",{get:function(){WI=!0}}),window.addEventListener("test",Ox,Ox),window.removeEventListener("test",Ox,Ox)}catch{WI=!1}function tU(e,n,a,u,f,w,p,s,L){var F=Array.prototype.slice.call(arguments,3);try{n.apply(a,F)}catch(G){this.onError(G)}}var s1=!1,A2=null,P2=!1,HI=null,rU={onError:function(e){s1=!0,A2=e}};function nU(e,n,a,u,f,w,p,s,L){s1=!1,A2=null,tU.apply(rU,arguments)}function iU(e,n,a,u,f,w,p,s,L){if(nU.apply(this,arguments),s1){if(s1){var F=A2;s1=!1,A2=null}else throw Error(In(198));P2||(P2=!0,HI=F)}}function Cy(e){var n=e,a=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(a=n.return),e=n.return;while(e)}return n.tag===3?a:null}function jz(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function uR(e){if(Cy(e)!==e)throw Error(In(188))}function oU(e){var n=e.alternate;if(!n){if(n=Cy(e),n===null)throw Error(In(188));return n!==e?null:e}for(var a=e,u=n;;){var f=a.return;if(f===null)break;var w=f.alternate;if(w===null){if(u=f.return,u!==null){a=u;continue}break}if(f.child===w.child){for(w=f.child;w;){if(w===a)return uR(f),e;if(w===u)return uR(f),n;w=w.sibling}throw Error(In(188))}if(a.return!==u.return)a=f,u=w;else{for(var p=!1,s=f.child;s;){if(s===a){p=!0,a=f,u=w;break}if(s===u){p=!0,u=f,a=w;break}s=s.sibling}if(!p){for(s=w.child;s;){if(s===a){p=!0,a=w,u=f;break}if(s===u){p=!0,u=w,a=f;break}s=s.sibling}if(!p)throw Error(In(189))}}if(a.alternate!==u)throw Error(In(190))}if(a.tag!==3)throw Error(In(188));return a.stateNode.current===a?e:n}function Bz(e){return e=oU(e),e!==null?Fz(e):null}function Fz(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Fz(e);if(n!==null)return n;e=e.sibling}return null}var Vz=Hh.unstable_scheduleCallback,hR=Hh.unstable_cancelCallback,aU=Hh.unstable_shouldYield,sU=Hh.unstable_requestPaint,ml=Hh.unstable_now,lU=Hh.unstable_getCurrentPriorityLevel,NA=Hh.unstable_ImmediatePriority,Uz=Hh.unstable_UserBlockingPriority,M2=Hh.unstable_NormalPriority,cU=Hh.unstable_LowPriority,$z=Hh.unstable_IdlePriority,SS=null,Ef=null;function uU(e){if(Ef&&typeof Ef.onCommitFiberRoot=="function")try{Ef.onCommitFiberRoot(SS,e,void 0,(e.current.flags&128)===128)}catch{}}var Np=Math.clz32?Math.clz32:pU,hU=Math.log,dU=Math.LN2;function pU(e){return e>>>=0,e===0?32:31-(hU(e)/dU|0)|0}var Iw=64,Cw=4194304;function r1(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function k2(e,n){var a=e.pendingLanes;if(a===0)return 0;var u=0,f=e.suspendedLanes,w=e.pingedLanes,p=a&268435455;if(p!==0){var s=p&~f;s!==0?u=r1(s):(w&=p,w!==0&&(u=r1(w)))}else p=a&~f,p!==0?u=r1(p):w!==0&&(u=r1(w));if(u===0)return 0;if(n!==0&&n!==u&&!(n&f)&&(f=u&-u,w=n&-n,f>=w||f===16&&(w&4194240)!==0))return n;if(u&4&&(u|=a&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=u;0<n;)a=31-Np(n),f=1<<a,u|=e[a],n&=~f;return u}function fU(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mU(e,n){for(var a=e.suspendedLanes,u=e.pingedLanes,f=e.expirationTimes,w=e.pendingLanes;0<w;){var p=31-Np(w),s=1<<p,L=f[p];L===-1?(!(s&a)||s&u)&&(f[p]=fU(s,n)):L<=n&&(e.expiredLanes|=s),w&=~s}}function ZI(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Gz(){var e=Iw;return Iw<<=1,!(Iw&4194240)&&(Iw=64),e}function OE(e){for(var n=[],a=0;31>a;a++)n.push(e);return n}function ob(e,n,a){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-Np(n),e[n]=a}function gU(e,n){var a=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<a;){var f=31-Np(a),w=1<<f;n[f]=0,u[f]=-1,e[f]=-1,a&=~w}}function jA(e,n){var a=e.entangledLanes|=n;for(e=e.entanglements;a;){var u=31-Np(a),f=1<<u;f&n|e[u]&n&&(e[u]|=n),a&=~f}}var Ba=0;function qz(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Wz,BA,Hz,Zz,Xz,XI=!1,Aw=[],qg=null,Wg=null,Hg=null,E1=new Map,I1=new Map,Lg=[],_U="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dR(e,n){switch(e){case"focusin":case"focusout":qg=null;break;case"dragenter":case"dragleave":Wg=null;break;case"mouseover":case"mouseout":Hg=null;break;case"pointerover":case"pointerout":E1.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":I1.delete(n.pointerId)}}function Lx(e,n,a,u,f,w){return e===null||e.nativeEvent!==w?(e={blockedOn:n,domEventName:a,eventSystemFlags:u,nativeEvent:w,targetContainers:[f]},n!==null&&(n=sb(n),n!==null&&BA(n)),e):(e.eventSystemFlags|=u,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function yU(e,n,a,u,f){switch(n){case"focusin":return qg=Lx(qg,e,n,a,u,f),!0;case"dragenter":return Wg=Lx(Wg,e,n,a,u,f),!0;case"mouseover":return Hg=Lx(Hg,e,n,a,u,f),!0;case"pointerover":var w=f.pointerId;return E1.set(w,Lx(E1.get(w)||null,e,n,a,u,f)),!0;case"gotpointercapture":return w=f.pointerId,I1.set(w,Lx(I1.get(w)||null,e,n,a,u,f)),!0}return!1}function Yz(e){var n=sy(e.target);if(n!==null){var a=Cy(n);if(a!==null){if(n=a.tag,n===13){if(n=jz(a),n!==null){e.blockedOn=n,Xz(e.priority,function(){Hz(a)});return}}else if(n===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jw(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var a=YI(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);GI=u,a.target.dispatchEvent(u),GI=null}else return n=sb(a),n!==null&&BA(n),e.blockedOn=a,!1;n.shift()}return!0}function pR(e,n,a){Jw(e)&&a.delete(n)}function vU(){XI=!1,qg!==null&&Jw(qg)&&(qg=null),Wg!==null&&Jw(Wg)&&(Wg=null),Hg!==null&&Jw(Hg)&&(Hg=null),E1.forEach(pR),I1.forEach(pR)}function zx(e,n){e.blockedOn===n&&(e.blockedOn=null,XI||(XI=!0,Hh.unstable_scheduleCallback(Hh.unstable_NormalPriority,vU)))}function C1(e){function n(f){return zx(f,e)}if(0<Aw.length){zx(Aw[0],e);for(var a=1;a<Aw.length;a++){var u=Aw[a];u.blockedOn===e&&(u.blockedOn=null)}}for(qg!==null&&zx(qg,e),Wg!==null&&zx(Wg,e),Hg!==null&&zx(Hg,e),E1.forEach(n),I1.forEach(n),a=0;a<Lg.length;a++)u=Lg[a],u.blockedOn===e&&(u.blockedOn=null);for(;0<Lg.length&&(a=Lg[0],a.blockedOn===null);)Yz(a),a.blockedOn===null&&Lg.shift()}var Wv=Lm.ReactCurrentBatchConfig,R2=!0;function xU(e,n,a,u){var f=Ba,w=Wv.transition;Wv.transition=null;try{Ba=1,FA(e,n,a,u)}finally{Ba=f,Wv.transition=w}}function bU(e,n,a,u){var f=Ba,w=Wv.transition;Wv.transition=null;try{Ba=4,FA(e,n,a,u)}finally{Ba=f,Wv.transition=w}}function FA(e,n,a,u){if(R2){var f=YI(e,n,a,u);if(f===null)GE(e,n,u,D2,a),dR(e,u);else if(yU(f,e,n,a,u))u.stopPropagation();else if(dR(e,u),n&4&&-1<_U.indexOf(e)){for(;f!==null;){var w=sb(f);if(w!==null&&Wz(w),w=YI(e,n,a,u),w===null&&GE(e,n,u,D2,a),w===f)break;f=w}f!==null&&u.stopPropagation()}else GE(e,n,u,null,a)}}var D2=null;function YI(e,n,a,u){if(D2=null,e=zA(u),e=sy(e),e!==null)if(n=Cy(e),n===null)e=null;else if(a=n.tag,a===13){if(e=jz(n),e!==null)return e;e=null}else if(a===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return D2=e,null}function Kz(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lU()){case NA:return 1;case Uz:return 4;case M2:case cU:return 16;case $z:return 536870912;default:return 16}default:return 16}}var Fg=null,VA=null,Qw=null;function Jz(){if(Qw)return Qw;var e,n=VA,a=n.length,u,f="value"in Fg?Fg.value:Fg.textContent,w=f.length;for(e=0;e<a&&n[e]===f[e];e++);var p=a-e;for(u=1;u<=p&&n[a-u]===f[w-u];u++);return Qw=f.slice(e,1<u?1-u:void 0)}function e2(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Pw(){return!0}function fR(){return!1}function Kh(e){function n(a,u,f,w,p){this._reactName=a,this._targetInst=f,this.type=u,this.nativeEvent=w,this.target=p,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(a=e[s],this[s]=a?a(w):w[s]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Pw:fR,this.isPropagationStopped=fR,this}return Us(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Pw)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Pw)},persist:function(){},isPersistent:Pw}),n}var E0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},UA=Kh(E0),ab=Us({},E0,{view:0,detail:0}),wU=Kh(ab),LE,zE,Nx,TS=Us({},ab,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$A,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Nx&&(Nx&&e.type==="mousemove"?(LE=e.screenX-Nx.screenX,zE=e.screenY-Nx.screenY):zE=LE=0,Nx=e),LE)},movementY:function(e){return"movementY"in e?e.movementY:zE}}),mR=Kh(TS),SU=Us({},TS,{dataTransfer:0}),TU=Kh(SU),EU=Us({},ab,{relatedTarget:0}),NE=Kh(EU),IU=Us({},E0,{animationName:0,elapsedTime:0,pseudoElement:0}),CU=Kh(IU),AU=Us({},E0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),PU=Kh(AU),MU=Us({},E0,{data:0}),gR=Kh(MU),kU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OU(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=DU[e])?!!n[e]:!1}function $A(){return OU}var LU=Us({},ab,{key:function(e){if(e.key){var n=kU[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=e2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?RU[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$A,charCode:function(e){return e.type==="keypress"?e2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?e2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zU=Kh(LU),NU=Us({},TS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_R=Kh(NU),jU=Us({},ab,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$A}),BU=Kh(jU),FU=Us({},E0,{propertyName:0,elapsedTime:0,pseudoElement:0}),VU=Kh(FU),UU=Us({},TS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$U=Kh(UU),GU=[9,13,27,32],GA=Cm&&"CompositionEvent"in window,l1=null;Cm&&"documentMode"in document&&(l1=document.documentMode);var qU=Cm&&"TextEvent"in window&&!l1,Qz=Cm&&(!GA||l1&&8<l1&&11>=l1),yR=String.fromCharCode(32),vR=!1;function eN(e,n){switch(e){case"keyup":return GU.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tN(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rv=!1;function WU(e,n){switch(e){case"compositionend":return tN(n);case"keypress":return n.which!==32?null:(vR=!0,yR);case"textInput":return e=n.data,e===yR&&vR?null:e;default:return null}}function HU(e,n){if(Rv)return e==="compositionend"||!GA&&eN(e,n)?(e=Jz(),Qw=VA=Fg=null,Rv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Qz&&n.locale!=="ko"?null:n.data;default:return null}}var ZU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xR(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!ZU[e.type]:n==="textarea"}function rN(e,n,a,u){Dz(u),n=O2(n,"onChange"),0<n.length&&(a=new UA("onChange","change",null,a,u),e.push({event:a,listeners:n}))}var c1=null,A1=null;function XU(e){pN(e,0)}function ES(e){var n=Lv(e);if(Iz(n))return e}function YU(e,n){if(e==="change")return n}var nN=!1;if(Cm){var jE;if(Cm){var BE="oninput"in document;if(!BE){var bR=document.createElement("div");bR.setAttribute("oninput","return;"),BE=typeof bR.oninput=="function"}jE=BE}else jE=!1;nN=jE&&(!document.documentMode||9<document.documentMode)}function wR(){c1&&(c1.detachEvent("onpropertychange",iN),A1=c1=null)}function iN(e){if(e.propertyName==="value"&&ES(A1)){var n=[];rN(n,A1,e,zA(e)),Nz(XU,n)}}function KU(e,n,a){e==="focusin"?(wR(),c1=n,A1=a,c1.attachEvent("onpropertychange",iN)):e==="focusout"&&wR()}function JU(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ES(A1)}function QU(e,n){if(e==="click")return ES(n)}function e8(e,n){if(e==="input"||e==="change")return ES(n)}function t8(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Fp=typeof Object.is=="function"?Object.is:t8;function P1(e,n){if(Fp(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var a=Object.keys(e),u=Object.keys(n);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var f=a[u];if(!RI.call(n,f)||!Fp(e[f],n[f]))return!1}return!0}function SR(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function TR(e,n){var a=SR(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=n&&u>=n)return{node:a,offset:n-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=SR(a)}}function oN(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?oN(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function aN(){for(var e=window,n=C2();n instanceof e.HTMLIFrameElement;){try{var a=typeof n.contentWindow.location.href=="string"}catch{a=!1}if(a)e=n.contentWindow;else break;n=C2(e.document)}return n}function qA(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function r8(e){var n=aN(),a=e.focusedElem,u=e.selectionRange;if(n!==a&&a&&a.ownerDocument&&oN(a.ownerDocument.documentElement,a)){if(u!==null&&qA(a)){if(n=u.start,e=u.end,e===void 0&&(e=n),"selectionStart"in a)a.selectionStart=n,a.selectionEnd=Math.min(e,a.value.length);else if(e=(n=a.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var f=a.textContent.length,w=Math.min(u.start,f);u=u.end===void 0?w:Math.min(u.end,f),!e.extend&&w>u&&(f=u,u=w,w=f),f=TR(a,w);var p=TR(a,u);f&&p&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(n=n.createRange(),n.setStart(f.node,f.offset),e.removeAllRanges(),w>u?(e.addRange(n),e.extend(p.node,p.offset)):(n.setEnd(p.node,p.offset),e.addRange(n)))}}for(n=[],e=a;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<n.length;a++)e=n[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var n8=Cm&&"documentMode"in document&&11>=document.documentMode,Dv=null,KI=null,u1=null,JI=!1;function ER(e,n,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;JI||Dv==null||Dv!==C2(u)||(u=Dv,"selectionStart"in u&&qA(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),u1&&P1(u1,u)||(u1=u,u=O2(KI,"onSelect"),0<u.length&&(n=new UA("onSelect","select",null,n,a),e.push({event:n,listeners:u}),n.target=Dv)))}function Mw(e,n){var a={};return a[e.toLowerCase()]=n.toLowerCase(),a["Webkit"+e]="webkit"+n,a["Moz"+e]="moz"+n,a}var Ov={animationend:Mw("Animation","AnimationEnd"),animationiteration:Mw("Animation","AnimationIteration"),animationstart:Mw("Animation","AnimationStart"),transitionend:Mw("Transition","TransitionEnd")},FE={},sN={};Cm&&(sN=document.createElement("div").style,"AnimationEvent"in window||(delete Ov.animationend.animation,delete Ov.animationiteration.animation,delete Ov.animationstart.animation),"TransitionEvent"in window||delete Ov.transitionend.transition);function IS(e){if(FE[e])return FE[e];if(!Ov[e])return e;var n=Ov[e],a;for(a in n)if(n.hasOwnProperty(a)&&a in sN)return FE[e]=n[a];return e}var lN=IS("animationend"),cN=IS("animationiteration"),uN=IS("animationstart"),hN=IS("transitionend"),dN=new Map,IR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function f_(e,n){dN.set(e,n),Iy(n,[e])}for(var VE=0;VE<IR.length;VE++){var UE=IR[VE],i8=UE.toLowerCase(),o8=UE[0].toUpperCase()+UE.slice(1);f_(i8,"on"+o8)}f_(lN,"onAnimationEnd");f_(cN,"onAnimationIteration");f_(uN,"onAnimationStart");f_("dblclick","onDoubleClick");f_("focusin","onFocus");f_("focusout","onBlur");f_(hN,"onTransitionEnd");r0("onMouseEnter",["mouseout","mouseover"]);r0("onMouseLeave",["mouseout","mouseover"]);r0("onPointerEnter",["pointerout","pointerover"]);r0("onPointerLeave",["pointerout","pointerover"]);Iy("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Iy("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Iy("onBeforeInput",["compositionend","keypress","textInput","paste"]);Iy("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Iy("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Iy("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var n1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),a8=new Set("cancel close invalid load scroll toggle".split(" ").concat(n1));function CR(e,n,a){var u=e.type||"unknown-event";e.currentTarget=a,iU(u,n,void 0,e),e.currentTarget=null}function pN(e,n){n=(n&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],f=u.event;u=u.listeners;e:{var w=void 0;if(n)for(var p=u.length-1;0<=p;p--){var s=u[p],L=s.instance,F=s.currentTarget;if(s=s.listener,L!==w&&f.isPropagationStopped())break e;CR(f,s,F),w=L}else for(p=0;p<u.length;p++){if(s=u[p],L=s.instance,F=s.currentTarget,s=s.listener,L!==w&&f.isPropagationStopped())break e;CR(f,s,F),w=L}}}if(P2)throw e=HI,P2=!1,HI=null,e}function Ts(e,n){var a=n[nC];a===void 0&&(a=n[nC]=new Set);var u=e+"__bubble";a.has(u)||(fN(n,e,2,!1),a.add(u))}function $E(e,n,a){var u=0;n&&(u|=4),fN(a,e,u,n)}var kw="_reactListening"+Math.random().toString(36).slice(2);function M1(e){if(!e[kw]){e[kw]=!0,bz.forEach(function(a){a!=="selectionchange"&&(a8.has(a)||$E(a,!1,e),$E(a,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[kw]||(n[kw]=!0,$E("selectionchange",!1,n))}}function fN(e,n,a,u){switch(Kz(n)){case 1:var f=xU;break;case 4:f=bU;break;default:f=FA}a=f.bind(null,n,a,e),f=void 0,!WI||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),u?f!==void 0?e.addEventListener(n,a,{capture:!0,passive:f}):e.addEventListener(n,a,!0):f!==void 0?e.addEventListener(n,a,{passive:f}):e.addEventListener(n,a,!1)}function GE(e,n,a,u,f){var w=u;if(!(n&1)&&!(n&2)&&u!==null)e:for(;;){if(u===null)return;var p=u.tag;if(p===3||p===4){var s=u.stateNode.containerInfo;if(s===f||s.nodeType===8&&s.parentNode===f)break;if(p===4)for(p=u.return;p!==null;){var L=p.tag;if((L===3||L===4)&&(L=p.stateNode.containerInfo,L===f||L.nodeType===8&&L.parentNode===f))return;p=p.return}for(;s!==null;){if(p=sy(s),p===null)return;if(L=p.tag,L===5||L===6){u=w=p;continue e}s=s.parentNode}}u=u.return}Nz(function(){var F=w,G=zA(a),H=[];e:{var X=dN.get(e);if(X!==void 0){var ne=UA,ie=e;switch(e){case"keypress":if(e2(a)===0)break e;case"keydown":case"keyup":ne=zU;break;case"focusin":ie="focus",ne=NE;break;case"focusout":ie="blur",ne=NE;break;case"beforeblur":case"afterblur":ne=NE;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=mR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=TU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=BU;break;case lN:case cN:case uN:ne=CU;break;case hN:ne=VU;break;case"scroll":ne=wU;break;case"wheel":ne=$U;break;case"copy":case"cut":case"paste":ne=PU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=_R}var se=(n&4)!==0,Te=!se&&e==="scroll",ue=se?X!==null?X+"Capture":null:X;se=[];for(var ce=F,de;ce!==null;){de=ce;var Ee=de.stateNode;if(de.tag===5&&Ee!==null&&(de=Ee,ue!==null&&(Ee=T1(ce,ue),Ee!=null&&se.push(k1(ce,Ee,de)))),Te)break;ce=ce.return}0<se.length&&(X=new ne(X,ie,null,a,G),H.push({event:X,listeners:se}))}}if(!(n&7)){e:{if(X=e==="mouseover"||e==="pointerover",ne=e==="mouseout"||e==="pointerout",X&&a!==GI&&(ie=a.relatedTarget||a.fromElement)&&(sy(ie)||ie[Am]))break e;if((ne||X)&&(X=G.window===G?G:(X=G.ownerDocument)?X.defaultView||X.parentWindow:window,ne?(ie=a.relatedTarget||a.toElement,ne=F,ie=ie?sy(ie):null,ie!==null&&(Te=Cy(ie),ie!==Te||ie.tag!==5&&ie.tag!==6)&&(ie=null)):(ne=null,ie=F),ne!==ie)){if(se=mR,Ee="onMouseLeave",ue="onMouseEnter",ce="mouse",(e==="pointerout"||e==="pointerover")&&(se=_R,Ee="onPointerLeave",ue="onPointerEnter",ce="pointer"),Te=ne==null?X:Lv(ne),de=ie==null?X:Lv(ie),X=new se(Ee,ce+"leave",ne,a,G),X.target=Te,X.relatedTarget=de,Ee=null,sy(G)===F&&(se=new se(ue,ce+"enter",ie,a,G),se.target=de,se.relatedTarget=Te,Ee=se),Te=Ee,ne&&ie)t:{for(se=ne,ue=ie,ce=0,de=se;de;de=xv(de))ce++;for(de=0,Ee=ue;Ee;Ee=xv(Ee))de++;for(;0<ce-de;)se=xv(se),ce--;for(;0<de-ce;)ue=xv(ue),de--;for(;ce--;){if(se===ue||ue!==null&&se===ue.alternate)break t;se=xv(se),ue=xv(ue)}se=null}else se=null;ne!==null&&AR(H,X,ne,se,!1),ie!==null&&Te!==null&&AR(H,Te,ie,se,!0)}}e:{if(X=F?Lv(F):window,ne=X.nodeName&&X.nodeName.toLowerCase(),ne==="select"||ne==="input"&&X.type==="file")var Ne=YU;else if(xR(X))if(nN)Ne=e8;else{Ne=JU;var rt=KU}else(ne=X.nodeName)&&ne.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(Ne=QU);if(Ne&&(Ne=Ne(e,F))){rN(H,Ne,a,G);break e}rt&&rt(e,X,F),e==="focusout"&&(rt=X._wrapperState)&&rt.controlled&&X.type==="number"&&BI(X,"number",X.value)}switch(rt=F?Lv(F):window,e){case"focusin":(xR(rt)||rt.contentEditable==="true")&&(Dv=rt,KI=F,u1=null);break;case"focusout":u1=KI=Dv=null;break;case"mousedown":JI=!0;break;case"contextmenu":case"mouseup":case"dragend":JI=!1,ER(H,a,G);break;case"selectionchange":if(n8)break;case"keydown":case"keyup":ER(H,a,G)}var tt;if(GA)e:{switch(e){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Rv?eN(e,a)&&(Ge="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ge="onCompositionStart");Ge&&(Qz&&a.locale!=="ko"&&(Rv||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Rv&&(tt=Jz()):(Fg=G,VA="value"in Fg?Fg.value:Fg.textContent,Rv=!0)),rt=O2(F,Ge),0<rt.length&&(Ge=new gR(Ge,e,null,a,G),H.push({event:Ge,listeners:rt}),tt?Ge.data=tt:(tt=tN(a),tt!==null&&(Ge.data=tt)))),(tt=qU?WU(e,a):HU(e,a))&&(F=O2(F,"onBeforeInput"),0<F.length&&(G=new gR("onBeforeInput","beforeinput",null,a,G),H.push({event:G,listeners:F}),G.data=tt))}pN(H,n)})}function k1(e,n,a){return{instance:e,listener:n,currentTarget:a}}function O2(e,n){for(var a=n+"Capture",u=[];e!==null;){var f=e,w=f.stateNode;f.tag===5&&w!==null&&(f=w,w=T1(e,a),w!=null&&u.unshift(k1(e,w,f)),w=T1(e,n),w!=null&&u.push(k1(e,w,f))),e=e.return}return u}function xv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function AR(e,n,a,u,f){for(var w=n._reactName,p=[];a!==null&&a!==u;){var s=a,L=s.alternate,F=s.stateNode;if(L!==null&&L===u)break;s.tag===5&&F!==null&&(s=F,f?(L=T1(a,w),L!=null&&p.unshift(k1(a,L,s))):f||(L=T1(a,w),L!=null&&p.push(k1(a,L,s)))),a=a.return}p.length!==0&&e.push({event:n,listeners:p})}var s8=/\r\n?/g,l8=/\u0000|\uFFFD/g;function PR(e){return(typeof e=="string"?e:""+e).replace(s8,`
`).replace(l8,"")}function Rw(e,n,a){if(n=PR(n),PR(e)!==n&&a)throw Error(In(425))}function L2(){}var QI=null,eC=null;function tC(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var rC=typeof setTimeout=="function"?setTimeout:void 0,c8=typeof clearTimeout=="function"?clearTimeout:void 0,MR=typeof Promise=="function"?Promise:void 0,u8=typeof queueMicrotask=="function"?queueMicrotask:typeof MR<"u"?function(e){return MR.resolve(null).then(e).catch(h8)}:rC;function h8(e){setTimeout(function(){throw e})}function qE(e,n){var a=n,u=0;do{var f=a.nextSibling;if(e.removeChild(a),f&&f.nodeType===8)if(a=f.data,a==="/$"){if(u===0){e.removeChild(f),C1(n);return}u--}else a!=="$"&&a!=="$?"&&a!=="$!"||u++;a=f}while(a);C1(n)}function Zg(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function kR(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(n===0)return e;n--}else a==="/$"&&n++}e=e.previousSibling}return null}var I0=Math.random().toString(36).slice(2),wf="__reactFiber$"+I0,R1="__reactProps$"+I0,Am="__reactContainer$"+I0,nC="__reactEvents$"+I0,d8="__reactListeners$"+I0,p8="__reactHandles$"+I0;function sy(e){var n=e[wf];if(n)return n;for(var a=e.parentNode;a;){if(n=a[Am]||a[wf]){if(a=n.alternate,n.child!==null||a!==null&&a.child!==null)for(e=kR(e);e!==null;){if(a=e[wf])return a;e=kR(e)}return n}e=a,a=e.parentNode}return null}function sb(e){return e=e[wf]||e[Am],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(In(33))}function CS(e){return e[R1]||null}var iC=[],zv=-1;function m_(e){return{current:e}}function Es(e){0>zv||(e.current=iC[zv],iC[zv]=null,zv--)}function ps(e,n){zv++,iC[zv]=e.current,e.current=n}var o_={},Qc=m_(o_),ph=m_(!1),gy=o_;function n0(e,n){var a=e.type.contextTypes;if(!a)return o_;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===n)return u.__reactInternalMemoizedMaskedChildContext;var f={},w;for(w in a)f[w]=n[w];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=f),f}function fh(e){return e=e.childContextTypes,e!=null}function z2(){Es(ph),Es(Qc)}function RR(e,n,a){if(Qc.current!==o_)throw Error(In(168));ps(Qc,n),ps(ph,a)}function mN(e,n,a){var u=e.stateNode;if(n=n.childContextTypes,typeof u.getChildContext!="function")return a;u=u.getChildContext();for(var f in u)if(!(f in n))throw Error(In(108,KV(e)||"Unknown",f));return Us({},a,u)}function N2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||o_,gy=Qc.current,ps(Qc,e),ps(ph,ph.current),!0}function DR(e,n,a){var u=e.stateNode;if(!u)throw Error(In(169));a?(e=mN(e,n,gy),u.__reactInternalMemoizedMergedChildContext=e,Es(ph),Es(Qc),ps(Qc,e)):Es(ph),ps(ph,a)}var bm=null,AS=!1,WE=!1;function gN(e){bm===null?bm=[e]:bm.push(e)}function f8(e){AS=!0,gN(e)}function g_(){if(!WE&&bm!==null){WE=!0;var e=0,n=Ba;try{var a=bm;for(Ba=1;e<a.length;e++){var u=a[e];do u=u(!0);while(u!==null)}bm=null,AS=!1}catch(f){throw bm!==null&&(bm=bm.slice(e+1)),Vz(NA,g_),f}finally{Ba=n,WE=!1}}return null}var Nv=[],jv=0,j2=null,B2=0,Vd=[],Ud=0,_y=null,wm=1,Sm="";function ty(e,n){Nv[jv++]=B2,Nv[jv++]=j2,j2=e,B2=n}function _N(e,n,a){Vd[Ud++]=wm,Vd[Ud++]=Sm,Vd[Ud++]=_y,_y=e;var u=wm;e=Sm;var f=32-Np(u)-1;u&=~(1<<f),a+=1;var w=32-Np(n)+f;if(30<w){var p=f-f%5;w=(u&(1<<p)-1).toString(32),u>>=p,f-=p,wm=1<<32-Np(n)+f|a<<f|u,Sm=w+e}else wm=1<<w|a<<f|u,Sm=e}function WA(e){e.return!==null&&(ty(e,1),_N(e,1,0))}function HA(e){for(;e===j2;)j2=Nv[--jv],Nv[jv]=null,B2=Nv[--jv],Nv[jv]=null;for(;e===_y;)_y=Vd[--Ud],Vd[Ud]=null,Sm=Vd[--Ud],Vd[Ud]=null,wm=Vd[--Ud],Vd[Ud]=null}var qh=null,Gh=null,Ds=!1,Dp=null;function yN(e,n){var a=Gd(5,null,null,0);a.elementType="DELETED",a.stateNode=n,a.return=e,n=e.deletions,n===null?(e.deletions=[a],e.flags|=16):n.push(a)}function OR(e,n){switch(e.tag){case 5:var a=e.type;return n=n.nodeType!==1||a.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qh=e,Gh=Zg(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qh=e,Gh=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(a=_y!==null?{id:wm,overflow:Sm}:null,e.memoizedState={dehydrated:n,treeContext:a,retryLane:1073741824},a=Gd(18,null,null,0),a.stateNode=n,a.return=e,e.child=a,qh=e,Gh=null,!0):!1;default:return!1}}function oC(e){return(e.mode&1)!==0&&(e.flags&128)===0}function aC(e){if(Ds){var n=Gh;if(n){var a=n;if(!OR(e,n)){if(oC(e))throw Error(In(418));n=Zg(a.nextSibling);var u=qh;n&&OR(e,n)?yN(u,a):(e.flags=e.flags&-4097|2,Ds=!1,qh=e)}}else{if(oC(e))throw Error(In(418));e.flags=e.flags&-4097|2,Ds=!1,qh=e}}}function LR(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qh=e}function Dw(e){if(e!==qh)return!1;if(!Ds)return LR(e),Ds=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!tC(e.type,e.memoizedProps)),n&&(n=Gh)){if(oC(e))throw vN(),Error(In(418));for(;n;)yN(e,n),n=Zg(n.nextSibling)}if(LR(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(In(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(n===0){Gh=Zg(e.nextSibling);break e}n--}else a!=="$"&&a!=="$!"&&a!=="$?"||n++}e=e.nextSibling}Gh=null}}else Gh=qh?Zg(e.stateNode.nextSibling):null;return!0}function vN(){for(var e=Gh;e;)e=Zg(e.nextSibling)}function i0(){Gh=qh=null,Ds=!1}function ZA(e){Dp===null?Dp=[e]:Dp.push(e)}var m8=Lm.ReactCurrentBatchConfig;function kp(e,n){if(e&&e.defaultProps){n=Us({},n),e=e.defaultProps;for(var a in e)n[a]===void 0&&(n[a]=e[a]);return n}return n}var F2=m_(null),V2=null,Bv=null,XA=null;function YA(){XA=Bv=V2=null}function KA(e){var n=F2.current;Es(F2),e._currentValue=n}function sC(e,n,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,u!==null&&(u.childLanes|=n)):u!==null&&(u.childLanes&n)!==n&&(u.childLanes|=n),e===a)break;e=e.return}}function Hv(e,n){V2=e,XA=Bv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(hh=!0),e.firstContext=null)}function Yd(e){var n=e._currentValue;if(XA!==e)if(e={context:e,memoizedValue:n,next:null},Bv===null){if(V2===null)throw Error(In(308));Bv=e,V2.dependencies={lanes:0,firstContext:e}}else Bv=Bv.next=e;return n}var ly=null;function JA(e){ly===null?ly=[e]:ly.push(e)}function xN(e,n,a,u){var f=n.interleaved;return f===null?(a.next=a,JA(n)):(a.next=f.next,f.next=a),n.interleaved=a,Pm(e,u)}function Pm(e,n){e.lanes|=n;var a=e.alternate;for(a!==null&&(a.lanes|=n),a=e,e=e.return;e!==null;)e.childLanes|=n,a=e.alternate,a!==null&&(a.childLanes|=n),a=e,e=e.return;return a.tag===3?a.stateNode:null}var Og=!1;function QA(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bN(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Tm(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Xg(e,n,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,ca&2){var f=u.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),u.pending=n,Pm(e,a)}return f=u.interleaved,f===null?(n.next=n,JA(u)):(n.next=f.next,f.next=n),u.interleaved=n,Pm(e,a)}function t2(e,n,a){if(n=n.updateQueue,n!==null&&(n=n.shared,(a&4194240)!==0)){var u=n.lanes;u&=e.pendingLanes,a|=u,n.lanes=a,jA(e,a)}}function zR(e,n){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var f=null,w=null;if(a=a.firstBaseUpdate,a!==null){do{var p={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};w===null?f=w=p:w=w.next=p,a=a.next}while(a!==null);w===null?f=w=n:w=w.next=n}else f=w=n;a={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:w,shared:u.shared,effects:u.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=n:e.next=n,a.lastBaseUpdate=n}function U2(e,n,a,u){var f=e.updateQueue;Og=!1;var w=f.firstBaseUpdate,p=f.lastBaseUpdate,s=f.shared.pending;if(s!==null){f.shared.pending=null;var L=s,F=L.next;L.next=null,p===null?w=F:p.next=F,p=L;var G=e.alternate;G!==null&&(G=G.updateQueue,s=G.lastBaseUpdate,s!==p&&(s===null?G.firstBaseUpdate=F:s.next=F,G.lastBaseUpdate=L))}if(w!==null){var H=f.baseState;p=0,G=F=L=null,s=w;do{var X=s.lane,ne=s.eventTime;if((u&X)===X){G!==null&&(G=G.next={eventTime:ne,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var ie=e,se=s;switch(X=n,ne=a,se.tag){case 1:if(ie=se.payload,typeof ie=="function"){H=ie.call(ne,H,X);break e}H=ie;break e;case 3:ie.flags=ie.flags&-65537|128;case 0:if(ie=se.payload,X=typeof ie=="function"?ie.call(ne,H,X):ie,X==null)break e;H=Us({},H,X);break e;case 2:Og=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,X=f.effects,X===null?f.effects=[s]:X.push(s))}else ne={eventTime:ne,lane:X,tag:s.tag,payload:s.payload,callback:s.callback,next:null},G===null?(F=G=ne,L=H):G=G.next=ne,p|=X;if(s=s.next,s===null){if(s=f.shared.pending,s===null)break;X=s,s=X.next,X.next=null,f.lastBaseUpdate=X,f.shared.pending=null}}while(1);if(G===null&&(L=H),f.baseState=L,f.firstBaseUpdate=F,f.lastBaseUpdate=G,n=f.shared.interleaved,n!==null){f=n;do p|=f.lane,f=f.next;while(f!==n)}else w===null&&(f.shared.lanes=0);vy|=p,e.lanes=p,e.memoizedState=H}}function NR(e,n,a){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var u=e[n],f=u.callback;if(f!==null){if(u.callback=null,u=a,typeof f!="function")throw Error(In(191,f));f.call(u)}}}var wN=new xz.Component().refs;function lC(e,n,a,u){n=e.memoizedState,a=a(u,n),a=a==null?n:Us({},n,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var PS={isMounted:function(e){return(e=e._reactInternals)?Cy(e)===e:!1},enqueueSetState:function(e,n,a){e=e._reactInternals;var u=Au(),f=Kg(e),w=Tm(u,f);w.payload=n,a!=null&&(w.callback=a),n=Xg(e,w,f),n!==null&&(jp(n,e,f,u),t2(n,e,f))},enqueueReplaceState:function(e,n,a){e=e._reactInternals;var u=Au(),f=Kg(e),w=Tm(u,f);w.tag=1,w.payload=n,a!=null&&(w.callback=a),n=Xg(e,w,f),n!==null&&(jp(n,e,f,u),t2(n,e,f))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var a=Au(),u=Kg(e),f=Tm(a,u);f.tag=2,n!=null&&(f.callback=n),n=Xg(e,f,u),n!==null&&(jp(n,e,u,a),t2(n,e,u))}};function jR(e,n,a,u,f,w,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,w,p):n.prototype&&n.prototype.isPureReactComponent?!P1(a,u)||!P1(f,w):!0}function SN(e,n,a){var u=!1,f=o_,w=n.contextType;return typeof w=="object"&&w!==null?w=Yd(w):(f=fh(n)?gy:Qc.current,u=n.contextTypes,w=(u=u!=null)?n0(e,f):o_),n=new n(a,w),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=PS,e.stateNode=n,n._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=w),n}function BR(e,n,a,u){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(a,u),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(a,u),n.state!==e&&PS.enqueueReplaceState(n,n.state,null)}function cC(e,n,a,u){var f=e.stateNode;f.props=a,f.state=e.memoizedState,f.refs=wN,QA(e);var w=n.contextType;typeof w=="object"&&w!==null?f.context=Yd(w):(w=fh(n)?gy:Qc.current,f.context=n0(e,w)),f.state=e.memoizedState,w=n.getDerivedStateFromProps,typeof w=="function"&&(lC(e,n,w,a),f.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(n=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),n!==f.state&&PS.enqueueReplaceState(f,f.state,null),U2(e,a,f,u),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function jx(e,n,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(In(309));var u=a.stateNode}if(!u)throw Error(In(147,e));var f=u,w=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===w?n.ref:(n=function(p){var s=f.refs;s===wN&&(s=f.refs={}),p===null?delete s[w]:s[w]=p},n._stringRef=w,n)}if(typeof e!="string")throw Error(In(284));if(!a._owner)throw Error(In(290,e))}return e}function Ow(e,n){throw e=Object.prototype.toString.call(n),Error(In(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function FR(e){var n=e._init;return n(e._payload)}function TN(e){function n(ue,ce){if(e){var de=ue.deletions;de===null?(ue.deletions=[ce],ue.flags|=16):de.push(ce)}}function a(ue,ce){if(!e)return null;for(;ce!==null;)n(ue,ce),ce=ce.sibling;return null}function u(ue,ce){for(ue=new Map;ce!==null;)ce.key!==null?ue.set(ce.key,ce):ue.set(ce.index,ce),ce=ce.sibling;return ue}function f(ue,ce){return ue=Jg(ue,ce),ue.index=0,ue.sibling=null,ue}function w(ue,ce,de){return ue.index=de,e?(de=ue.alternate,de!==null?(de=de.index,de<ce?(ue.flags|=2,ce):de):(ue.flags|=2,ce)):(ue.flags|=1048576,ce)}function p(ue){return e&&ue.alternate===null&&(ue.flags|=2),ue}function s(ue,ce,de,Ee){return ce===null||ce.tag!==6?(ce=QE(de,ue.mode,Ee),ce.return=ue,ce):(ce=f(ce,de),ce.return=ue,ce)}function L(ue,ce,de,Ee){var Ne=de.type;return Ne===kv?G(ue,ce,de.props.children,Ee,de.key):ce!==null&&(ce.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Dg&&FR(Ne)===ce.type)?(Ee=f(ce,de.props),Ee.ref=jx(ue,ce,de),Ee.return=ue,Ee):(Ee=s2(de.type,de.key,de.props,null,ue.mode,Ee),Ee.ref=jx(ue,ce,de),Ee.return=ue,Ee)}function F(ue,ce,de,Ee){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==de.containerInfo||ce.stateNode.implementation!==de.implementation?(ce=eI(de,ue.mode,Ee),ce.return=ue,ce):(ce=f(ce,de.children||[]),ce.return=ue,ce)}function G(ue,ce,de,Ee,Ne){return ce===null||ce.tag!==7?(ce=fy(de,ue.mode,Ee,Ne),ce.return=ue,ce):(ce=f(ce,de),ce.return=ue,ce)}function H(ue,ce,de){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=QE(""+ce,ue.mode,de),ce.return=ue,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Sw:return de=s2(ce.type,ce.key,ce.props,null,ue.mode,de),de.ref=jx(ue,null,ce),de.return=ue,de;case Mv:return ce=eI(ce,ue.mode,de),ce.return=ue,ce;case Dg:var Ee=ce._init;return H(ue,Ee(ce._payload),de)}if(t1(ce)||Dx(ce))return ce=fy(ce,ue.mode,de,null),ce.return=ue,ce;Ow(ue,ce)}return null}function X(ue,ce,de,Ee){var Ne=ce!==null?ce.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return Ne!==null?null:s(ue,ce,""+de,Ee);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case Sw:return de.key===Ne?L(ue,ce,de,Ee):null;case Mv:return de.key===Ne?F(ue,ce,de,Ee):null;case Dg:return Ne=de._init,X(ue,ce,Ne(de._payload),Ee)}if(t1(de)||Dx(de))return Ne!==null?null:G(ue,ce,de,Ee,null);Ow(ue,de)}return null}function ne(ue,ce,de,Ee,Ne){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return ue=ue.get(de)||null,s(ce,ue,""+Ee,Ne);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case Sw:return ue=ue.get(Ee.key===null?de:Ee.key)||null,L(ce,ue,Ee,Ne);case Mv:return ue=ue.get(Ee.key===null?de:Ee.key)||null,F(ce,ue,Ee,Ne);case Dg:var rt=Ee._init;return ne(ue,ce,de,rt(Ee._payload),Ne)}if(t1(Ee)||Dx(Ee))return ue=ue.get(de)||null,G(ce,ue,Ee,Ne,null);Ow(ce,Ee)}return null}function ie(ue,ce,de,Ee){for(var Ne=null,rt=null,tt=ce,Ge=ce=0,_t=null;tt!==null&&Ge<de.length;Ge++){tt.index>Ge?(_t=tt,tt=null):_t=tt.sibling;var yt=X(ue,tt,de[Ge],Ee);if(yt===null){tt===null&&(tt=_t);break}e&&tt&&yt.alternate===null&&n(ue,tt),ce=w(yt,ce,Ge),rt===null?Ne=yt:rt.sibling=yt,rt=yt,tt=_t}if(Ge===de.length)return a(ue,tt),Ds&&ty(ue,Ge),Ne;if(tt===null){for(;Ge<de.length;Ge++)tt=H(ue,de[Ge],Ee),tt!==null&&(ce=w(tt,ce,Ge),rt===null?Ne=tt:rt.sibling=tt,rt=tt);return Ds&&ty(ue,Ge),Ne}for(tt=u(ue,tt);Ge<de.length;Ge++)_t=ne(tt,ue,Ge,de[Ge],Ee),_t!==null&&(e&&_t.alternate!==null&&tt.delete(_t.key===null?Ge:_t.key),ce=w(_t,ce,Ge),rt===null?Ne=_t:rt.sibling=_t,rt=_t);return e&&tt.forEach(function(Et){return n(ue,Et)}),Ds&&ty(ue,Ge),Ne}function se(ue,ce,de,Ee){var Ne=Dx(de);if(typeof Ne!="function")throw Error(In(150));if(de=Ne.call(de),de==null)throw Error(In(151));for(var rt=Ne=null,tt=ce,Ge=ce=0,_t=null,yt=de.next();tt!==null&&!yt.done;Ge++,yt=de.next()){tt.index>Ge?(_t=tt,tt=null):_t=tt.sibling;var Et=X(ue,tt,yt.value,Ee);if(Et===null){tt===null&&(tt=_t);break}e&&tt&&Et.alternate===null&&n(ue,tt),ce=w(Et,ce,Ge),rt===null?Ne=Et:rt.sibling=Et,rt=Et,tt=_t}if(yt.done)return a(ue,tt),Ds&&ty(ue,Ge),Ne;if(tt===null){for(;!yt.done;Ge++,yt=de.next())yt=H(ue,yt.value,Ee),yt!==null&&(ce=w(yt,ce,Ge),rt===null?Ne=yt:rt.sibling=yt,rt=yt);return Ds&&ty(ue,Ge),Ne}for(tt=u(ue,tt);!yt.done;Ge++,yt=de.next())yt=ne(tt,ue,Ge,yt.value,Ee),yt!==null&&(e&&yt.alternate!==null&&tt.delete(yt.key===null?Ge:yt.key),ce=w(yt,ce,Ge),rt===null?Ne=yt:rt.sibling=yt,rt=yt);return e&&tt.forEach(function(Wt){return n(ue,Wt)}),Ds&&ty(ue,Ge),Ne}function Te(ue,ce,de,Ee){if(typeof de=="object"&&de!==null&&de.type===kv&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case Sw:e:{for(var Ne=de.key,rt=ce;rt!==null;){if(rt.key===Ne){if(Ne=de.type,Ne===kv){if(rt.tag===7){a(ue,rt.sibling),ce=f(rt,de.props.children),ce.return=ue,ue=ce;break e}}else if(rt.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Dg&&FR(Ne)===rt.type){a(ue,rt.sibling),ce=f(rt,de.props),ce.ref=jx(ue,rt,de),ce.return=ue,ue=ce;break e}a(ue,rt);break}else n(ue,rt);rt=rt.sibling}de.type===kv?(ce=fy(de.props.children,ue.mode,Ee,de.key),ce.return=ue,ue=ce):(Ee=s2(de.type,de.key,de.props,null,ue.mode,Ee),Ee.ref=jx(ue,ce,de),Ee.return=ue,ue=Ee)}return p(ue);case Mv:e:{for(rt=de.key;ce!==null;){if(ce.key===rt)if(ce.tag===4&&ce.stateNode.containerInfo===de.containerInfo&&ce.stateNode.implementation===de.implementation){a(ue,ce.sibling),ce=f(ce,de.children||[]),ce.return=ue,ue=ce;break e}else{a(ue,ce);break}else n(ue,ce);ce=ce.sibling}ce=eI(de,ue.mode,Ee),ce.return=ue,ue=ce}return p(ue);case Dg:return rt=de._init,Te(ue,ce,rt(de._payload),Ee)}if(t1(de))return ie(ue,ce,de,Ee);if(Dx(de))return se(ue,ce,de,Ee);Ow(ue,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,ce!==null&&ce.tag===6?(a(ue,ce.sibling),ce=f(ce,de),ce.return=ue,ue=ce):(a(ue,ce),ce=QE(de,ue.mode,Ee),ce.return=ue,ue=ce),p(ue)):a(ue,ce)}return Te}var o0=TN(!0),EN=TN(!1),lb={},If=m_(lb),D1=m_(lb),O1=m_(lb);function cy(e){if(e===lb)throw Error(In(174));return e}function eP(e,n){switch(ps(O1,n),ps(D1,e),ps(If,lb),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:VI(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=VI(n,e)}Es(If),ps(If,n)}function a0(){Es(If),Es(D1),Es(O1)}function IN(e){cy(O1.current);var n=cy(If.current),a=VI(n,e.type);n!==a&&(ps(D1,e),ps(If,a))}function tP(e){D1.current===e&&(Es(If),Es(D1))}var Fs=m_(0);function $2(e){for(var n=e;n!==null;){if(n.tag===13){var a=n.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var HE=[];function rP(){for(var e=0;e<HE.length;e++)HE[e]._workInProgressVersionPrimary=null;HE.length=0}var r2=Lm.ReactCurrentDispatcher,ZE=Lm.ReactCurrentBatchConfig,yy=0,Vs=null,Ul=null,sc=null,G2=!1,h1=!1,L1=0,g8=0;function Hc(){throw Error(In(321))}function nP(e,n){if(n===null)return!1;for(var a=0;a<n.length&&a<e.length;a++)if(!Fp(e[a],n[a]))return!1;return!0}function iP(e,n,a,u,f,w){if(yy=w,Vs=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,r2.current=e===null||e.memoizedState===null?x8:b8,e=a(u,f),h1){w=0;do{if(h1=!1,L1=0,25<=w)throw Error(In(301));w+=1,sc=Ul=null,n.updateQueue=null,r2.current=w8,e=a(u,f)}while(h1)}if(r2.current=q2,n=Ul!==null&&Ul.next!==null,yy=0,sc=Ul=Vs=null,G2=!1,n)throw Error(In(300));return e}function oP(){var e=L1!==0;return L1=0,e}function vf(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sc===null?Vs.memoizedState=sc=e:sc=sc.next=e,sc}function Kd(){if(Ul===null){var e=Vs.alternate;e=e!==null?e.memoizedState:null}else e=Ul.next;var n=sc===null?Vs.memoizedState:sc.next;if(n!==null)sc=n,Ul=e;else{if(e===null)throw Error(In(310));Ul=e,e={memoizedState:Ul.memoizedState,baseState:Ul.baseState,baseQueue:Ul.baseQueue,queue:Ul.queue,next:null},sc===null?Vs.memoizedState=sc=e:sc=sc.next=e}return sc}function z1(e,n){return typeof n=="function"?n(e):n}function XE(e){var n=Kd(),a=n.queue;if(a===null)throw Error(In(311));a.lastRenderedReducer=e;var u=Ul,f=u.baseQueue,w=a.pending;if(w!==null){if(f!==null){var p=f.next;f.next=w.next,w.next=p}u.baseQueue=f=w,a.pending=null}if(f!==null){w=f.next,u=u.baseState;var s=p=null,L=null,F=w;do{var G=F.lane;if((yy&G)===G)L!==null&&(L=L.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),u=F.hasEagerState?F.eagerState:e(u,F.action);else{var H={lane:G,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};L===null?(s=L=H,p=u):L=L.next=H,Vs.lanes|=G,vy|=G}F=F.next}while(F!==null&&F!==w);L===null?p=u:L.next=s,Fp(u,n.memoizedState)||(hh=!0),n.memoizedState=u,n.baseState=p,n.baseQueue=L,a.lastRenderedState=u}if(e=a.interleaved,e!==null){f=e;do w=f.lane,Vs.lanes|=w,vy|=w,f=f.next;while(f!==e)}else f===null&&(a.lanes=0);return[n.memoizedState,a.dispatch]}function YE(e){var n=Kd(),a=n.queue;if(a===null)throw Error(In(311));a.lastRenderedReducer=e;var u=a.dispatch,f=a.pending,w=n.memoizedState;if(f!==null){a.pending=null;var p=f=f.next;do w=e(w,p.action),p=p.next;while(p!==f);Fp(w,n.memoizedState)||(hh=!0),n.memoizedState=w,n.baseQueue===null&&(n.baseState=w),a.lastRenderedState=w}return[w,u]}function CN(){}function AN(e,n){var a=Vs,u=Kd(),f=n(),w=!Fp(u.memoizedState,f);if(w&&(u.memoizedState=f,hh=!0),u=u.queue,aP(kN.bind(null,a,u,e),[e]),u.getSnapshot!==n||w||sc!==null&&sc.memoizedState.tag&1){if(a.flags|=2048,N1(9,MN.bind(null,a,u,f,n),void 0,null),lc===null)throw Error(In(349));yy&30||PN(a,n,f)}return f}function PN(e,n,a){e.flags|=16384,e={getSnapshot:n,value:a},n=Vs.updateQueue,n===null?(n={lastEffect:null,stores:null},Vs.updateQueue=n,n.stores=[e]):(a=n.stores,a===null?n.stores=[e]:a.push(e))}function MN(e,n,a,u){n.value=a,n.getSnapshot=u,RN(n)&&DN(e)}function kN(e,n,a){return a(function(){RN(n)&&DN(e)})}function RN(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!Fp(e,a)}catch{return!0}}function DN(e){var n=Pm(e,1);n!==null&&jp(n,e,1,-1)}function VR(e){var n=vf();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:z1,lastRenderedState:e},n.queue=e,e=e.dispatch=v8.bind(null,Vs,e),[n.memoizedState,e]}function N1(e,n,a,u){return e={tag:e,create:n,destroy:a,deps:u,next:null},n=Vs.updateQueue,n===null?(n={lastEffect:null,stores:null},Vs.updateQueue=n,n.lastEffect=e.next=e):(a=n.lastEffect,a===null?n.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,n.lastEffect=e)),e}function ON(){return Kd().memoizedState}function n2(e,n,a,u){var f=vf();Vs.flags|=e,f.memoizedState=N1(1|n,a,void 0,u===void 0?null:u)}function MS(e,n,a,u){var f=Kd();u=u===void 0?null:u;var w=void 0;if(Ul!==null){var p=Ul.memoizedState;if(w=p.destroy,u!==null&&nP(u,p.deps)){f.memoizedState=N1(n,a,w,u);return}}Vs.flags|=e,f.memoizedState=N1(1|n,a,w,u)}function UR(e,n){return n2(8390656,8,e,n)}function aP(e,n){return MS(2048,8,e,n)}function LN(e,n){return MS(4,2,e,n)}function zN(e,n){return MS(4,4,e,n)}function NN(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function jN(e,n,a){return a=a!=null?a.concat([e]):null,MS(4,4,NN.bind(null,n,e),a)}function sP(){}function BN(e,n){var a=Kd();n=n===void 0?null:n;var u=a.memoizedState;return u!==null&&n!==null&&nP(n,u[1])?u[0]:(a.memoizedState=[e,n],e)}function FN(e,n){var a=Kd();n=n===void 0?null:n;var u=a.memoizedState;return u!==null&&n!==null&&nP(n,u[1])?u[0]:(e=e(),a.memoizedState=[e,n],e)}function VN(e,n,a){return yy&21?(Fp(a,n)||(a=Gz(),Vs.lanes|=a,vy|=a,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,hh=!0),e.memoizedState=a)}function _8(e,n){var a=Ba;Ba=a!==0&&4>a?a:4,e(!0);var u=ZE.transition;ZE.transition={};try{e(!1),n()}finally{Ba=a,ZE.transition=u}}function UN(){return Kd().memoizedState}function y8(e,n,a){var u=Kg(e);if(a={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null},$N(e))GN(n,a);else if(a=xN(e,n,a,u),a!==null){var f=Au();jp(a,e,u,f),qN(a,n,u)}}function v8(e,n,a){var u=Kg(e),f={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null};if($N(e))GN(n,f);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=n.lastRenderedReducer,w!==null))try{var p=n.lastRenderedState,s=w(p,a);if(f.hasEagerState=!0,f.eagerState=s,Fp(s,p)){var L=n.interleaved;L===null?(f.next=f,JA(n)):(f.next=L.next,L.next=f),n.interleaved=f;return}}catch{}finally{}a=xN(e,n,f,u),a!==null&&(f=Au(),jp(a,e,u,f),qN(a,n,u))}}function $N(e){var n=e.alternate;return e===Vs||n!==null&&n===Vs}function GN(e,n){h1=G2=!0;var a=e.pending;a===null?n.next=n:(n.next=a.next,a.next=n),e.pending=n}function qN(e,n,a){if(a&4194240){var u=n.lanes;u&=e.pendingLanes,a|=u,n.lanes=a,jA(e,a)}}var q2={readContext:Yd,useCallback:Hc,useContext:Hc,useEffect:Hc,useImperativeHandle:Hc,useInsertionEffect:Hc,useLayoutEffect:Hc,useMemo:Hc,useReducer:Hc,useRef:Hc,useState:Hc,useDebugValue:Hc,useDeferredValue:Hc,useTransition:Hc,useMutableSource:Hc,useSyncExternalStore:Hc,useId:Hc,unstable_isNewReconciler:!1},x8={readContext:Yd,useCallback:function(e,n){return vf().memoizedState=[e,n===void 0?null:n],e},useContext:Yd,useEffect:UR,useImperativeHandle:function(e,n,a){return a=a!=null?a.concat([e]):null,n2(4194308,4,NN.bind(null,n,e),a)},useLayoutEffect:function(e,n){return n2(4194308,4,e,n)},useInsertionEffect:function(e,n){return n2(4,2,e,n)},useMemo:function(e,n){var a=vf();return n=n===void 0?null:n,e=e(),a.memoizedState=[e,n],e},useReducer:function(e,n,a){var u=vf();return n=a!==void 0?a(n):n,u.memoizedState=u.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},u.queue=e,e=e.dispatch=y8.bind(null,Vs,e),[u.memoizedState,e]},useRef:function(e){var n=vf();return e={current:e},n.memoizedState=e},useState:VR,useDebugValue:sP,useDeferredValue:function(e){return vf().memoizedState=e},useTransition:function(){var e=VR(!1),n=e[0];return e=_8.bind(null,e[1]),vf().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,a){var u=Vs,f=vf();if(Ds){if(a===void 0)throw Error(In(407));a=a()}else{if(a=n(),lc===null)throw Error(In(349));yy&30||PN(u,n,a)}f.memoizedState=a;var w={value:a,getSnapshot:n};return f.queue=w,UR(kN.bind(null,u,w,e),[e]),u.flags|=2048,N1(9,MN.bind(null,u,w,a,n),void 0,null),a},useId:function(){var e=vf(),n=lc.identifierPrefix;if(Ds){var a=Sm,u=wm;a=(u&~(1<<32-Np(u)-1)).toString(32)+a,n=":"+n+"R"+a,a=L1++,0<a&&(n+="H"+a.toString(32)),n+=":"}else a=g8++,n=":"+n+"r"+a.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},b8={readContext:Yd,useCallback:BN,useContext:Yd,useEffect:aP,useImperativeHandle:jN,useInsertionEffect:LN,useLayoutEffect:zN,useMemo:FN,useReducer:XE,useRef:ON,useState:function(){return XE(z1)},useDebugValue:sP,useDeferredValue:function(e){var n=Kd();return VN(n,Ul.memoizedState,e)},useTransition:function(){var e=XE(z1)[0],n=Kd().memoizedState;return[e,n]},useMutableSource:CN,useSyncExternalStore:AN,useId:UN,unstable_isNewReconciler:!1},w8={readContext:Yd,useCallback:BN,useContext:Yd,useEffect:aP,useImperativeHandle:jN,useInsertionEffect:LN,useLayoutEffect:zN,useMemo:FN,useReducer:YE,useRef:ON,useState:function(){return YE(z1)},useDebugValue:sP,useDeferredValue:function(e){var n=Kd();return Ul===null?n.memoizedState=e:VN(n,Ul.memoizedState,e)},useTransition:function(){var e=YE(z1)[0],n=Kd().memoizedState;return[e,n]},useMutableSource:CN,useSyncExternalStore:AN,useId:UN,unstable_isNewReconciler:!1};function s0(e,n){try{var a="",u=n;do a+=YV(u),u=u.return;while(u);var f=a}catch(w){f=`
Error generating stack: `+w.message+`
`+w.stack}return{value:e,source:n,stack:f,digest:null}}function KE(e,n,a){return{value:e,source:null,stack:a??null,digest:n??null}}function uC(e,n){try{console.error(n.value)}catch(a){setTimeout(function(){throw a})}}var S8=typeof WeakMap=="function"?WeakMap:Map;function WN(e,n,a){a=Tm(-1,a),a.tag=3,a.payload={element:null};var u=n.value;return a.callback=function(){H2||(H2=!0,xC=u),uC(e,n)},a}function HN(e,n,a){a=Tm(-1,a),a.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var f=n.value;a.payload=function(){return u(f)},a.callback=function(){uC(e,n)}}var w=e.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(a.callback=function(){uC(e,n),typeof u!="function"&&(Yg===null?Yg=new Set([this]):Yg.add(this));var p=n.stack;this.componentDidCatch(n.value,{componentStack:p!==null?p:""})}),a}function $R(e,n,a){var u=e.pingCache;if(u===null){u=e.pingCache=new S8;var f=new Set;u.set(n,f)}else f=u.get(n),f===void 0&&(f=new Set,u.set(n,f));f.has(a)||(f.add(a),e=N8.bind(null,e,n,a),n.then(e,e))}function GR(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function qR(e,n,a,u,f){return e.mode&1?(e.flags|=65536,e.lanes=f,e):(e===n?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(n=Tm(-1,1),n.tag=2,Xg(a,n,1))),a.lanes|=1),e)}var T8=Lm.ReactCurrentOwner,hh=!1;function Eu(e,n,a,u){n.child=e===null?EN(n,null,a,u):o0(n,e.child,a,u)}function WR(e,n,a,u,f){a=a.render;var w=n.ref;return Hv(n,f),u=iP(e,n,a,u,w,f),a=oP(),e!==null&&!hh?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~f,Mm(e,n,f)):(Ds&&a&&WA(n),n.flags|=1,Eu(e,n,u,f),n.child)}function HR(e,n,a,u,f){if(e===null){var w=a.type;return typeof w=="function"&&!mP(w)&&w.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(n.tag=15,n.type=w,ZN(e,n,w,u,f)):(e=s2(a.type,null,u,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(w=e.child,!(e.lanes&f)){var p=w.memoizedProps;if(a=a.compare,a=a!==null?a:P1,a(p,u)&&e.ref===n.ref)return Mm(e,n,f)}return n.flags|=1,e=Jg(w,u),e.ref=n.ref,e.return=n,n.child=e}function ZN(e,n,a,u,f){if(e!==null){var w=e.memoizedProps;if(P1(w,u)&&e.ref===n.ref)if(hh=!1,n.pendingProps=u=w,(e.lanes&f)!==0)e.flags&131072&&(hh=!0);else return n.lanes=e.lanes,Mm(e,n,f)}return hC(e,n,a,u,f)}function XN(e,n,a){var u=n.pendingProps,f=u.children,w=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},ps(Vv,Fh),Fh|=a;else{if(!(a&1073741824))return e=w!==null?w.baseLanes|a:a,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,ps(Vv,Fh),Fh|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=w!==null?w.baseLanes:a,ps(Vv,Fh),Fh|=u}else w!==null?(u=w.baseLanes|a,n.memoizedState=null):u=a,ps(Vv,Fh),Fh|=u;return Eu(e,n,f,a),n.child}function YN(e,n){var a=n.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(n.flags|=512,n.flags|=2097152)}function hC(e,n,a,u,f){var w=fh(a)?gy:Qc.current;return w=n0(n,w),Hv(n,f),a=iP(e,n,a,u,w,f),u=oP(),e!==null&&!hh?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~f,Mm(e,n,f)):(Ds&&u&&WA(n),n.flags|=1,Eu(e,n,a,f),n.child)}function ZR(e,n,a,u,f){if(fh(a)){var w=!0;N2(n)}else w=!1;if(Hv(n,f),n.stateNode===null)i2(e,n),SN(n,a,u),cC(n,a,u,f),u=!0;else if(e===null){var p=n.stateNode,s=n.memoizedProps;p.props=s;var L=p.context,F=a.contextType;typeof F=="object"&&F!==null?F=Yd(F):(F=fh(a)?gy:Qc.current,F=n0(n,F));var G=a.getDerivedStateFromProps,H=typeof G=="function"||typeof p.getSnapshotBeforeUpdate=="function";H||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(s!==u||L!==F)&&BR(n,p,u,F),Og=!1;var X=n.memoizedState;p.state=X,U2(n,u,p,f),L=n.memoizedState,s!==u||X!==L||ph.current||Og?(typeof G=="function"&&(lC(n,a,G,u),L=n.memoizedState),(s=Og||jR(n,a,s,u,X,L,F))?(H||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=u,n.memoizedState=L),p.props=u,p.state=L,p.context=F,u=s):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),u=!1)}else{p=n.stateNode,bN(e,n),s=n.memoizedProps,F=n.type===n.elementType?s:kp(n.type,s),p.props=F,H=n.pendingProps,X=p.context,L=a.contextType,typeof L=="object"&&L!==null?L=Yd(L):(L=fh(a)?gy:Qc.current,L=n0(n,L));var ne=a.getDerivedStateFromProps;(G=typeof ne=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(s!==H||X!==L)&&BR(n,p,u,L),Og=!1,X=n.memoizedState,p.state=X,U2(n,u,p,f);var ie=n.memoizedState;s!==H||X!==ie||ph.current||Og?(typeof ne=="function"&&(lC(n,a,ne,u),ie=n.memoizedState),(F=Og||jR(n,a,F,u,X,ie,L)||!1)?(G||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,ie,L),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,ie,L)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||s===e.memoizedProps&&X===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&X===e.memoizedState||(n.flags|=1024),n.memoizedProps=u,n.memoizedState=ie),p.props=u,p.state=ie,p.context=L,u=F):(typeof p.componentDidUpdate!="function"||s===e.memoizedProps&&X===e.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&X===e.memoizedState||(n.flags|=1024),u=!1)}return dC(e,n,a,u,w,f)}function dC(e,n,a,u,f,w){YN(e,n);var p=(n.flags&128)!==0;if(!u&&!p)return f&&DR(n,a,!1),Mm(e,n,w);u=n.stateNode,T8.current=n;var s=p&&typeof a.getDerivedStateFromError!="function"?null:u.render();return n.flags|=1,e!==null&&p?(n.child=o0(n,e.child,null,w),n.child=o0(n,null,s,w)):Eu(e,n,s,w),n.memoizedState=u.state,f&&DR(n,a,!0),n.child}function KN(e){var n=e.stateNode;n.pendingContext?RR(e,n.pendingContext,n.pendingContext!==n.context):n.context&&RR(e,n.context,!1),eP(e,n.containerInfo)}function XR(e,n,a,u,f){return i0(),ZA(f),n.flags|=256,Eu(e,n,a,u),n.child}var pC={dehydrated:null,treeContext:null,retryLane:0};function fC(e){return{baseLanes:e,cachePool:null,transitions:null}}function JN(e,n,a){var u=n.pendingProps,f=Fs.current,w=!1,p=(n.flags&128)!==0,s;if((s=p)||(s=e!==null&&e.memoizedState===null?!1:(f&2)!==0),s?(w=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),ps(Fs,f&1),e===null)return aC(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(p=u.children,e=u.fallback,w?(u=n.mode,w=n.child,p={mode:"hidden",children:p},!(u&1)&&w!==null?(w.childLanes=0,w.pendingProps=p):w=DS(p,u,0,null),e=fy(e,u,a,null),w.return=n,e.return=n,w.sibling=e,n.child=w,n.child.memoizedState=fC(a),n.memoizedState=pC,e):lP(n,p));if(f=e.memoizedState,f!==null&&(s=f.dehydrated,s!==null))return E8(e,n,p,u,s,f,a);if(w){w=u.fallback,p=n.mode,f=e.child,s=f.sibling;var L={mode:"hidden",children:u.children};return!(p&1)&&n.child!==f?(u=n.child,u.childLanes=0,u.pendingProps=L,n.deletions=null):(u=Jg(f,L),u.subtreeFlags=f.subtreeFlags&14680064),s!==null?w=Jg(s,w):(w=fy(w,p,a,null),w.flags|=2),w.return=n,u.return=n,u.sibling=w,n.child=u,u=w,w=n.child,p=e.child.memoizedState,p=p===null?fC(a):{baseLanes:p.baseLanes|a,cachePool:null,transitions:p.transitions},w.memoizedState=p,w.childLanes=e.childLanes&~a,n.memoizedState=pC,u}return w=e.child,e=w.sibling,u=Jg(w,{mode:"visible",children:u.children}),!(n.mode&1)&&(u.lanes=a),u.return=n,u.sibling=null,e!==null&&(a=n.deletions,a===null?(n.deletions=[e],n.flags|=16):a.push(e)),n.child=u,n.memoizedState=null,u}function lP(e,n){return n=DS({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function Lw(e,n,a,u){return u!==null&&ZA(u),o0(n,e.child,null,a),e=lP(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function E8(e,n,a,u,f,w,p){if(a)return n.flags&256?(n.flags&=-257,u=KE(Error(In(422))),Lw(e,n,p,u)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(w=u.fallback,f=n.mode,u=DS({mode:"visible",children:u.children},f,0,null),w=fy(w,f,p,null),w.flags|=2,u.return=n,w.return=n,u.sibling=w,n.child=u,n.mode&1&&o0(n,e.child,null,p),n.child.memoizedState=fC(p),n.memoizedState=pC,w);if(!(n.mode&1))return Lw(e,n,p,null);if(f.data==="$!"){if(u=f.nextSibling&&f.nextSibling.dataset,u)var s=u.dgst;return u=s,w=Error(In(419)),u=KE(w,u,void 0),Lw(e,n,p,u)}if(s=(p&e.childLanes)!==0,hh||s){if(u=lc,u!==null){switch(p&-p){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(u.suspendedLanes|p)?0:f,f!==0&&f!==w.retryLane&&(w.retryLane=f,Pm(e,f),jp(u,e,f,-1))}return fP(),u=KE(Error(In(421))),Lw(e,n,p,u)}return f.data==="$?"?(n.flags|=128,n.child=e.child,n=j8.bind(null,e),f._reactRetry=n,null):(e=w.treeContext,Gh=Zg(f.nextSibling),qh=n,Ds=!0,Dp=null,e!==null&&(Vd[Ud++]=wm,Vd[Ud++]=Sm,Vd[Ud++]=_y,wm=e.id,Sm=e.overflow,_y=n),n=lP(n,u.children),n.flags|=4096,n)}function YR(e,n,a){e.lanes|=n;var u=e.alternate;u!==null&&(u.lanes|=n),sC(e.return,n,a)}function JE(e,n,a,u,f){var w=e.memoizedState;w===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:f}:(w.isBackwards=n,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=a,w.tailMode=f)}function QN(e,n,a){var u=n.pendingProps,f=u.revealOrder,w=u.tail;if(Eu(e,n,u.children,a),u=Fs.current,u&2)u=u&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&YR(e,a,n);else if(e.tag===19)YR(e,a,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(ps(Fs,u),!(n.mode&1))n.memoizedState=null;else switch(f){case"forwards":for(a=n.child,f=null;a!==null;)e=a.alternate,e!==null&&$2(e)===null&&(f=a),a=a.sibling;a=f,a===null?(f=n.child,n.child=null):(f=a.sibling,a.sibling=null),JE(n,!1,f,a,w);break;case"backwards":for(a=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&$2(e)===null){n.child=f;break}e=f.sibling,f.sibling=a,a=f,f=e}JE(n,!0,a,null,w);break;case"together":JE(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function i2(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Mm(e,n,a){if(e!==null&&(n.dependencies=e.dependencies),vy|=n.lanes,!(a&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(In(153));if(n.child!==null){for(e=n.child,a=Jg(e,e.pendingProps),n.child=a,a.return=n;e.sibling!==null;)e=e.sibling,a=a.sibling=Jg(e,e.pendingProps),a.return=n;a.sibling=null}return n.child}function I8(e,n,a){switch(n.tag){case 3:KN(n),i0();break;case 5:IN(n);break;case 1:fh(n.type)&&N2(n);break;case 4:eP(n,n.stateNode.containerInfo);break;case 10:var u=n.type._context,f=n.memoizedProps.value;ps(F2,u._currentValue),u._currentValue=f;break;case 13:if(u=n.memoizedState,u!==null)return u.dehydrated!==null?(ps(Fs,Fs.current&1),n.flags|=128,null):a&n.child.childLanes?JN(e,n,a):(ps(Fs,Fs.current&1),e=Mm(e,n,a),e!==null?e.sibling:null);ps(Fs,Fs.current&1);break;case 19:if(u=(a&n.childLanes)!==0,e.flags&128){if(u)return QN(e,n,a);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ps(Fs,Fs.current),u)break;return null;case 22:case 23:return n.lanes=0,XN(e,n,a)}return Mm(e,n,a)}var ej,mC,tj,rj;ej=function(e,n){for(var a=n.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};mC=function(){};tj=function(e,n,a,u){var f=e.memoizedProps;if(f!==u){e=n.stateNode,cy(If.current);var w=null;switch(a){case"input":f=NI(e,f),u=NI(e,u),w=[];break;case"select":f=Us({},f,{value:void 0}),u=Us({},u,{value:void 0}),w=[];break;case"textarea":f=FI(e,f),u=FI(e,u),w=[];break;default:typeof f.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=L2)}UI(a,u);var p;a=null;for(F in f)if(!u.hasOwnProperty(F)&&f.hasOwnProperty(F)&&f[F]!=null)if(F==="style"){var s=f[F];for(p in s)s.hasOwnProperty(p)&&(a||(a={}),a[p]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(w1.hasOwnProperty(F)?w||(w=[]):(w=w||[]).push(F,null));for(F in u){var L=u[F];if(s=f!=null?f[F]:void 0,u.hasOwnProperty(F)&&L!==s&&(L!=null||s!=null))if(F==="style")if(s){for(p in s)!s.hasOwnProperty(p)||L&&L.hasOwnProperty(p)||(a||(a={}),a[p]="");for(p in L)L.hasOwnProperty(p)&&s[p]!==L[p]&&(a||(a={}),a[p]=L[p])}else a||(w||(w=[]),w.push(F,a)),a=L;else F==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,s=s?s.__html:void 0,L!=null&&s!==L&&(w=w||[]).push(F,L)):F==="children"?typeof L!="string"&&typeof L!="number"||(w=w||[]).push(F,""+L):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(w1.hasOwnProperty(F)?(L!=null&&F==="onScroll"&&Ts("scroll",e),w||s===L||(w=[])):(w=w||[]).push(F,L))}a&&(w=w||[]).push("style",a);var F=w;(n.updateQueue=F)&&(n.flags|=4)}};rj=function(e,n,a,u){a!==u&&(n.flags|=4)};function Bx(e,n){if(!Ds)switch(e.tailMode){case"hidden":n=e.tail;for(var a=null;n!==null;)n.alternate!==null&&(a=n),n=n.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Zc(e){var n=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(n)for(var f=e.child;f!==null;)a|=f.lanes|f.childLanes,u|=f.subtreeFlags&14680064,u|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)a|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=u,e.childLanes=a,n}function C8(e,n,a){var u=n.pendingProps;switch(HA(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zc(n),null;case 1:return fh(n.type)&&z2(),Zc(n),null;case 3:return u=n.stateNode,a0(),Es(ph),Es(Qc),rP(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(Dw(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Dp!==null&&(SC(Dp),Dp=null))),mC(e,n),Zc(n),null;case 5:tP(n);var f=cy(O1.current);if(a=n.type,e!==null&&n.stateNode!=null)tj(e,n,a,u,f),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!u){if(n.stateNode===null)throw Error(In(166));return Zc(n),null}if(e=cy(If.current),Dw(n)){u=n.stateNode,a=n.type;var w=n.memoizedProps;switch(u[wf]=n,u[R1]=w,e=(n.mode&1)!==0,a){case"dialog":Ts("cancel",u),Ts("close",u);break;case"iframe":case"object":case"embed":Ts("load",u);break;case"video":case"audio":for(f=0;f<n1.length;f++)Ts(n1[f],u);break;case"source":Ts("error",u);break;case"img":case"image":case"link":Ts("error",u),Ts("load",u);break;case"details":Ts("toggle",u);break;case"input":oR(u,w),Ts("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!w.multiple},Ts("invalid",u);break;case"textarea":sR(u,w),Ts("invalid",u)}UI(a,w),f=null;for(var p in w)if(w.hasOwnProperty(p)){var s=w[p];p==="children"?typeof s=="string"?u.textContent!==s&&(w.suppressHydrationWarning!==!0&&Rw(u.textContent,s,e),f=["children",s]):typeof s=="number"&&u.textContent!==""+s&&(w.suppressHydrationWarning!==!0&&Rw(u.textContent,s,e),f=["children",""+s]):w1.hasOwnProperty(p)&&s!=null&&p==="onScroll"&&Ts("scroll",u)}switch(a){case"input":Tw(u),aR(u,w,!0);break;case"textarea":Tw(u),lR(u);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(u.onclick=L2)}u=f,n.updateQueue=u,u!==null&&(n.flags|=4)}else{p=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Pz(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=p.createElement(a,{is:u.is}):(e=p.createElement(a),a==="select"&&(p=e,u.multiple?p.multiple=!0:u.size&&(p.size=u.size))):e=p.createElementNS(e,a),e[wf]=n,e[R1]=u,ej(e,n,!1,!1),n.stateNode=e;e:{switch(p=$I(a,u),a){case"dialog":Ts("cancel",e),Ts("close",e),f=u;break;case"iframe":case"object":case"embed":Ts("load",e),f=u;break;case"video":case"audio":for(f=0;f<n1.length;f++)Ts(n1[f],e);f=u;break;case"source":Ts("error",e),f=u;break;case"img":case"image":case"link":Ts("error",e),Ts("load",e),f=u;break;case"details":Ts("toggle",e),f=u;break;case"input":oR(e,u),f=NI(e,u),Ts("invalid",e);break;case"option":f=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},f=Us({},u,{value:void 0}),Ts("invalid",e);break;case"textarea":sR(e,u),f=FI(e,u),Ts("invalid",e);break;default:f=u}UI(a,f),s=f;for(w in s)if(s.hasOwnProperty(w)){var L=s[w];w==="style"?Rz(e,L):w==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&Mz(e,L)):w==="children"?typeof L=="string"?(a!=="textarea"||L!=="")&&S1(e,L):typeof L=="number"&&S1(e,""+L):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(w1.hasOwnProperty(w)?L!=null&&w==="onScroll"&&Ts("scroll",e):L!=null&&RA(e,w,L,p))}switch(a){case"input":Tw(e),aR(e,u,!1);break;case"textarea":Tw(e),lR(e);break;case"option":u.value!=null&&e.setAttribute("value",""+i_(u.value));break;case"select":e.multiple=!!u.multiple,w=u.value,w!=null?$v(e,!!u.multiple,w,!1):u.defaultValue!=null&&$v(e,!!u.multiple,u.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=L2)}switch(a){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Zc(n),null;case 6:if(e&&n.stateNode!=null)rj(e,n,e.memoizedProps,u);else{if(typeof u!="string"&&n.stateNode===null)throw Error(In(166));if(a=cy(O1.current),cy(If.current),Dw(n)){if(u=n.stateNode,a=n.memoizedProps,u[wf]=n,(w=u.nodeValue!==a)&&(e=qh,e!==null))switch(e.tag){case 3:Rw(u.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Rw(u.nodeValue,a,(e.mode&1)!==0)}w&&(n.flags|=4)}else u=(a.nodeType===9?a:a.ownerDocument).createTextNode(u),u[wf]=n,n.stateNode=u}return Zc(n),null;case 13:if(Es(Fs),u=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ds&&Gh!==null&&n.mode&1&&!(n.flags&128))vN(),i0(),n.flags|=98560,w=!1;else if(w=Dw(n),u!==null&&u.dehydrated!==null){if(e===null){if(!w)throw Error(In(318));if(w=n.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(In(317));w[wf]=n}else i0(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Zc(n),w=!1}else Dp!==null&&(SC(Dp),Dp=null),w=!0;if(!w)return n.flags&65536?n:null}return n.flags&128?(n.lanes=a,n):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(n.child.flags|=8192,n.mode&1&&(e===null||Fs.current&1?Gl===0&&(Gl=3):fP())),n.updateQueue!==null&&(n.flags|=4),Zc(n),null);case 4:return a0(),mC(e,n),e===null&&M1(n.stateNode.containerInfo),Zc(n),null;case 10:return KA(n.type._context),Zc(n),null;case 17:return fh(n.type)&&z2(),Zc(n),null;case 19:if(Es(Fs),w=n.memoizedState,w===null)return Zc(n),null;if(u=(n.flags&128)!==0,p=w.rendering,p===null)if(u)Bx(w,!1);else{if(Gl!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(p=$2(e),p!==null){for(n.flags|=128,Bx(w,!1),u=p.updateQueue,u!==null&&(n.updateQueue=u,n.flags|=4),n.subtreeFlags=0,u=a,a=n.child;a!==null;)w=a,e=u,w.flags&=14680066,p=w.alternate,p===null?(w.childLanes=0,w.lanes=e,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=p.childLanes,w.lanes=p.lanes,w.child=p.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=p.memoizedProps,w.memoizedState=p.memoizedState,w.updateQueue=p.updateQueue,w.type=p.type,e=p.dependencies,w.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return ps(Fs,Fs.current&1|2),n.child}e=e.sibling}w.tail!==null&&ml()>l0&&(n.flags|=128,u=!0,Bx(w,!1),n.lanes=4194304)}else{if(!u)if(e=$2(p),e!==null){if(n.flags|=128,u=!0,a=e.updateQueue,a!==null&&(n.updateQueue=a,n.flags|=4),Bx(w,!0),w.tail===null&&w.tailMode==="hidden"&&!p.alternate&&!Ds)return Zc(n),null}else 2*ml()-w.renderingStartTime>l0&&a!==1073741824&&(n.flags|=128,u=!0,Bx(w,!1),n.lanes=4194304);w.isBackwards?(p.sibling=n.child,n.child=p):(a=w.last,a!==null?a.sibling=p:n.child=p,w.last=p)}return w.tail!==null?(n=w.tail,w.rendering=n,w.tail=n.sibling,w.renderingStartTime=ml(),n.sibling=null,a=Fs.current,ps(Fs,u?a&1|2:a&1),n):(Zc(n),null);case 22:case 23:return pP(),u=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(n.flags|=8192),u&&n.mode&1?Fh&1073741824&&(Zc(n),n.subtreeFlags&6&&(n.flags|=8192)):Zc(n),null;case 24:return null;case 25:return null}throw Error(In(156,n.tag))}function A8(e,n){switch(HA(n),n.tag){case 1:return fh(n.type)&&z2(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return a0(),Es(ph),Es(Qc),rP(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return tP(n),null;case 13:if(Es(Fs),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(In(340));i0()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Es(Fs),null;case 4:return a0(),null;case 10:return KA(n.type._context),null;case 22:case 23:return pP(),null;case 24:return null;default:return null}}var zw=!1,Jc=!1,P8=typeof WeakSet=="function"?WeakSet:Set,bi=null;function Fv(e,n){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(u){nl(e,n,u)}else a.current=null}function gC(e,n,a){try{a()}catch(u){nl(e,n,u)}}var KR=!1;function M8(e,n){if(QI=R2,e=aN(),qA(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var f=u.anchorOffset,w=u.focusNode;u=u.focusOffset;try{a.nodeType,w.nodeType}catch{a=null;break e}var p=0,s=-1,L=-1,F=0,G=0,H=e,X=null;t:for(;;){for(var ne;H!==a||f!==0&&H.nodeType!==3||(s=p+f),H!==w||u!==0&&H.nodeType!==3||(L=p+u),H.nodeType===3&&(p+=H.nodeValue.length),(ne=H.firstChild)!==null;)X=H,H=ne;for(;;){if(H===e)break t;if(X===a&&++F===f&&(s=p),X===w&&++G===u&&(L=p),(ne=H.nextSibling)!==null)break;H=X,X=H.parentNode}H=ne}a=s===-1||L===-1?null:{start:s,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(eC={focusedElem:e,selectionRange:a},R2=!1,bi=n;bi!==null;)if(n=bi,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,bi=e;else for(;bi!==null;){n=bi;try{var ie=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(ie!==null){var se=ie.memoizedProps,Te=ie.memoizedState,ue=n.stateNode,ce=ue.getSnapshotBeforeUpdate(n.elementType===n.type?se:kp(n.type,se),Te);ue.__reactInternalSnapshotBeforeUpdate=ce}break;case 3:var de=n.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(In(163))}}catch(Ee){nl(n,n.return,Ee)}if(e=n.sibling,e!==null){e.return=n.return,bi=e;break}bi=n.return}return ie=KR,KR=!1,ie}function d1(e,n,a){var u=n.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&e)===e){var w=f.destroy;f.destroy=void 0,w!==void 0&&gC(n,a,w)}f=f.next}while(f!==u)}}function kS(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var u=a.create;a.destroy=u()}a=a.next}while(a!==n)}}function _C(e){var n=e.ref;if(n!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof n=="function"?n(e):n.current=e}}function nj(e){var n=e.alternate;n!==null&&(e.alternate=null,nj(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[wf],delete n[R1],delete n[nC],delete n[d8],delete n[p8])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ij(e){return e.tag===5||e.tag===3||e.tag===4}function JR(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ij(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yC(e,n,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?a.nodeType===8?a.parentNode.insertBefore(e,n):a.insertBefore(e,n):(a.nodeType===8?(n=a.parentNode,n.insertBefore(e,a)):(n=a,n.appendChild(e)),a=a._reactRootContainer,a!=null||n.onclick!==null||(n.onclick=L2));else if(u!==4&&(e=e.child,e!==null))for(yC(e,n,a),e=e.sibling;e!==null;)yC(e,n,a),e=e.sibling}function vC(e,n,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,n?a.insertBefore(e,n):a.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(vC(e,n,a),e=e.sibling;e!==null;)vC(e,n,a),e=e.sibling}var Ec=null,Rp=!1;function Pg(e,n,a){for(a=a.child;a!==null;)oj(e,n,a),a=a.sibling}function oj(e,n,a){if(Ef&&typeof Ef.onCommitFiberUnmount=="function")try{Ef.onCommitFiberUnmount(SS,a)}catch{}switch(a.tag){case 5:Jc||Fv(a,n);case 6:var u=Ec,f=Rp;Ec=null,Pg(e,n,a),Ec=u,Rp=f,Ec!==null&&(Rp?(e=Ec,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):Ec.removeChild(a.stateNode));break;case 18:Ec!==null&&(Rp?(e=Ec,a=a.stateNode,e.nodeType===8?qE(e.parentNode,a):e.nodeType===1&&qE(e,a),C1(e)):qE(Ec,a.stateNode));break;case 4:u=Ec,f=Rp,Ec=a.stateNode.containerInfo,Rp=!0,Pg(e,n,a),Ec=u,Rp=f;break;case 0:case 11:case 14:case 15:if(!Jc&&(u=a.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){f=u=u.next;do{var w=f,p=w.destroy;w=w.tag,p!==void 0&&(w&2||w&4)&&gC(a,n,p),f=f.next}while(f!==u)}Pg(e,n,a);break;case 1:if(!Jc&&(Fv(a,n),u=a.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=a.memoizedProps,u.state=a.memoizedState,u.componentWillUnmount()}catch(s){nl(a,n,s)}Pg(e,n,a);break;case 21:Pg(e,n,a);break;case 22:a.mode&1?(Jc=(u=Jc)||a.memoizedState!==null,Pg(e,n,a),Jc=u):Pg(e,n,a);break;default:Pg(e,n,a)}}function QR(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new P8),n.forEach(function(u){var f=B8.bind(null,e,u);a.has(u)||(a.add(u),u.then(f,f))})}}function Mp(e,n){var a=n.deletions;if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];try{var w=e,p=n,s=p;e:for(;s!==null;){switch(s.tag){case 5:Ec=s.stateNode,Rp=!1;break e;case 3:Ec=s.stateNode.containerInfo,Rp=!0;break e;case 4:Ec=s.stateNode.containerInfo,Rp=!0;break e}s=s.return}if(Ec===null)throw Error(In(160));oj(w,p,f),Ec=null,Rp=!1;var L=f.alternate;L!==null&&(L.return=null),f.return=null}catch(F){nl(f,n,F)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)aj(n,e),n=n.sibling}function aj(e,n){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Mp(n,e),_f(e),u&4){try{d1(3,e,e.return),kS(3,e)}catch(se){nl(e,e.return,se)}try{d1(5,e,e.return)}catch(se){nl(e,e.return,se)}}break;case 1:Mp(n,e),_f(e),u&512&&a!==null&&Fv(a,a.return);break;case 5:if(Mp(n,e),_f(e),u&512&&a!==null&&Fv(a,a.return),e.flags&32){var f=e.stateNode;try{S1(f,"")}catch(se){nl(e,e.return,se)}}if(u&4&&(f=e.stateNode,f!=null)){var w=e.memoizedProps,p=a!==null?a.memoizedProps:w,s=e.type,L=e.updateQueue;if(e.updateQueue=null,L!==null)try{s==="input"&&w.type==="radio"&&w.name!=null&&Cz(f,w),$I(s,p);var F=$I(s,w);for(p=0;p<L.length;p+=2){var G=L[p],H=L[p+1];G==="style"?Rz(f,H):G==="dangerouslySetInnerHTML"?Mz(f,H):G==="children"?S1(f,H):RA(f,G,H,F)}switch(s){case"input":jI(f,w);break;case"textarea":Az(f,w);break;case"select":var X=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!w.multiple;var ne=w.value;ne!=null?$v(f,!!w.multiple,ne,!1):X!==!!w.multiple&&(w.defaultValue!=null?$v(f,!!w.multiple,w.defaultValue,!0):$v(f,!!w.multiple,w.multiple?[]:"",!1))}f[R1]=w}catch(se){nl(e,e.return,se)}}break;case 6:if(Mp(n,e),_f(e),u&4){if(e.stateNode===null)throw Error(In(162));f=e.stateNode,w=e.memoizedProps;try{f.nodeValue=w}catch(se){nl(e,e.return,se)}}break;case 3:if(Mp(n,e),_f(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{C1(n.containerInfo)}catch(se){nl(e,e.return,se)}break;case 4:Mp(n,e),_f(e);break;case 13:Mp(n,e),_f(e),f=e.child,f.flags&8192&&(w=f.memoizedState!==null,f.stateNode.isHidden=w,!w||f.alternate!==null&&f.alternate.memoizedState!==null||(hP=ml())),u&4&&QR(e);break;case 22:if(G=a!==null&&a.memoizedState!==null,e.mode&1?(Jc=(F=Jc)||G,Mp(n,e),Jc=F):Mp(n,e),_f(e),u&8192){if(F=e.memoizedState!==null,(e.stateNode.isHidden=F)&&!G&&e.mode&1)for(bi=e,G=e.child;G!==null;){for(H=bi=G;bi!==null;){switch(X=bi,ne=X.child,X.tag){case 0:case 11:case 14:case 15:d1(4,X,X.return);break;case 1:Fv(X,X.return);var ie=X.stateNode;if(typeof ie.componentWillUnmount=="function"){u=X,a=X.return;try{n=u,ie.props=n.memoizedProps,ie.state=n.memoizedState,ie.componentWillUnmount()}catch(se){nl(u,a,se)}}break;case 5:Fv(X,X.return);break;case 22:if(X.memoizedState!==null){tD(H);continue}}ne!==null?(ne.return=X,bi=ne):tD(H)}G=G.sibling}e:for(G=null,H=e;;){if(H.tag===5){if(G===null){G=H;try{f=H.stateNode,F?(w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(s=H.stateNode,L=H.memoizedProps.style,p=L!=null&&L.hasOwnProperty("display")?L.display:null,s.style.display=kz("display",p))}catch(se){nl(e,e.return,se)}}}else if(H.tag===6){if(G===null)try{H.stateNode.nodeValue=F?"":H.memoizedProps}catch(se){nl(e,e.return,se)}}else if((H.tag!==22&&H.tag!==23||H.memoizedState===null||H===e)&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===e)break e;for(;H.sibling===null;){if(H.return===null||H.return===e)break e;G===H&&(G=null),H=H.return}G===H&&(G=null),H.sibling.return=H.return,H=H.sibling}}break;case 19:Mp(n,e),_f(e),u&4&&QR(e);break;case 21:break;default:Mp(n,e),_f(e)}}function _f(e){var n=e.flags;if(n&2){try{e:{for(var a=e.return;a!==null;){if(ij(a)){var u=a;break e}a=a.return}throw Error(In(160))}switch(u.tag){case 5:var f=u.stateNode;u.flags&32&&(S1(f,""),u.flags&=-33);var w=JR(e);vC(e,w,f);break;case 3:case 4:var p=u.stateNode.containerInfo,s=JR(e);yC(e,s,p);break;default:throw Error(In(161))}}catch(L){nl(e,e.return,L)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function k8(e,n,a){bi=e,sj(e)}function sj(e,n,a){for(var u=(e.mode&1)!==0;bi!==null;){var f=bi,w=f.child;if(f.tag===22&&u){var p=f.memoizedState!==null||zw;if(!p){var s=f.alternate,L=s!==null&&s.memoizedState!==null||Jc;s=zw;var F=Jc;if(zw=p,(Jc=L)&&!F)for(bi=f;bi!==null;)p=bi,L=p.child,p.tag===22&&p.memoizedState!==null?rD(f):L!==null?(L.return=p,bi=L):rD(f);for(;w!==null;)bi=w,sj(w),w=w.sibling;bi=f,zw=s,Jc=F}eD(e)}else f.subtreeFlags&8772&&w!==null?(w.return=f,bi=w):eD(e)}}function eD(e){for(;bi!==null;){var n=bi;if(n.flags&8772){var a=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Jc||kS(5,n);break;case 1:var u=n.stateNode;if(n.flags&4&&!Jc)if(a===null)u.componentDidMount();else{var f=n.elementType===n.type?a.memoizedProps:kp(n.type,a.memoizedProps);u.componentDidUpdate(f,a.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var w=n.updateQueue;w!==null&&NR(n,w,u);break;case 3:var p=n.updateQueue;if(p!==null){if(a=null,n.child!==null)switch(n.child.tag){case 5:a=n.child.stateNode;break;case 1:a=n.child.stateNode}NR(n,p,a)}break;case 5:var s=n.stateNode;if(a===null&&n.flags&4){a=s;var L=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&a.focus();break;case"img":L.src&&(a.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var F=n.alternate;if(F!==null){var G=F.memoizedState;if(G!==null){var H=G.dehydrated;H!==null&&C1(H)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(In(163))}Jc||n.flags&512&&_C(n)}catch(X){nl(n,n.return,X)}}if(n===e){bi=null;break}if(a=n.sibling,a!==null){a.return=n.return,bi=a;break}bi=n.return}}function tD(e){for(;bi!==null;){var n=bi;if(n===e){bi=null;break}var a=n.sibling;if(a!==null){a.return=n.return,bi=a;break}bi=n.return}}function rD(e){for(;bi!==null;){var n=bi;try{switch(n.tag){case 0:case 11:case 15:var a=n.return;try{kS(4,n)}catch(L){nl(n,a,L)}break;case 1:var u=n.stateNode;if(typeof u.componentDidMount=="function"){var f=n.return;try{u.componentDidMount()}catch(L){nl(n,f,L)}}var w=n.return;try{_C(n)}catch(L){nl(n,w,L)}break;case 5:var p=n.return;try{_C(n)}catch(L){nl(n,p,L)}}}catch(L){nl(n,n.return,L)}if(n===e){bi=null;break}var s=n.sibling;if(s!==null){s.return=n.return,bi=s;break}bi=n.return}}var R8=Math.ceil,W2=Lm.ReactCurrentDispatcher,cP=Lm.ReactCurrentOwner,qd=Lm.ReactCurrentBatchConfig,ca=0,lc=null,Pl=null,Ac=0,Fh=0,Vv=m_(0),Gl=0,j1=null,vy=0,RS=0,uP=0,p1=null,uh=null,hP=0,l0=1/0,xm=null,H2=!1,xC=null,Yg=null,Nw=!1,Vg=null,Z2=0,f1=0,bC=null,o2=-1,a2=0;function Au(){return ca&6?ml():o2!==-1?o2:o2=ml()}function Kg(e){return e.mode&1?ca&2&&Ac!==0?Ac&-Ac:m8.transition!==null?(a2===0&&(a2=Gz()),a2):(e=Ba,e!==0||(e=window.event,e=e===void 0?16:Kz(e.type)),e):1}function jp(e,n,a,u){if(50<f1)throw f1=0,bC=null,Error(In(185));ob(e,a,u),(!(ca&2)||e!==lc)&&(e===lc&&(!(ca&2)&&(RS|=a),Gl===4&&zg(e,Ac)),mh(e,u),a===1&&ca===0&&!(n.mode&1)&&(l0=ml()+500,AS&&g_()))}function mh(e,n){var a=e.callbackNode;mU(e,n);var u=k2(e,e===lc?Ac:0);if(u===0)a!==null&&hR(a),e.callbackNode=null,e.callbackPriority=0;else if(n=u&-u,e.callbackPriority!==n){if(a!=null&&hR(a),n===1)e.tag===0?f8(nD.bind(null,e)):gN(nD.bind(null,e)),u8(function(){!(ca&6)&&g_()}),a=null;else{switch(qz(u)){case 1:a=NA;break;case 4:a=Uz;break;case 16:a=M2;break;case 536870912:a=$z;break;default:a=M2}a=mj(a,lj.bind(null,e))}e.callbackPriority=n,e.callbackNode=a}}function lj(e,n){if(o2=-1,a2=0,ca&6)throw Error(In(327));var a=e.callbackNode;if(Zv()&&e.callbackNode!==a)return null;var u=k2(e,e===lc?Ac:0);if(u===0)return null;if(u&30||u&e.expiredLanes||n)n=X2(e,u);else{n=u;var f=ca;ca|=2;var w=uj();(lc!==e||Ac!==n)&&(xm=null,l0=ml()+500,py(e,n));do try{L8();break}catch(s){cj(e,s)}while(1);YA(),W2.current=w,ca=f,Pl!==null?n=0:(lc=null,Ac=0,n=Gl)}if(n!==0){if(n===2&&(f=ZI(e),f!==0&&(u=f,n=wC(e,f))),n===1)throw a=j1,py(e,0),zg(e,u),mh(e,ml()),a;if(n===6)zg(e,u);else{if(f=e.current.alternate,!(u&30)&&!D8(f)&&(n=X2(e,u),n===2&&(w=ZI(e),w!==0&&(u=w,n=wC(e,w))),n===1))throw a=j1,py(e,0),zg(e,u),mh(e,ml()),a;switch(e.finishedWork=f,e.finishedLanes=u,n){case 0:case 1:throw Error(In(345));case 2:ry(e,uh,xm);break;case 3:if(zg(e,u),(u&130023424)===u&&(n=hP+500-ml(),10<n)){if(k2(e,0)!==0)break;if(f=e.suspendedLanes,(f&u)!==u){Au(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=rC(ry.bind(null,e,uh,xm),n);break}ry(e,uh,xm);break;case 4:if(zg(e,u),(u&4194240)===u)break;for(n=e.eventTimes,f=-1;0<u;){var p=31-Np(u);w=1<<p,p=n[p],p>f&&(f=p),u&=~w}if(u=f,u=ml()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*R8(u/1960))-u,10<u){e.timeoutHandle=rC(ry.bind(null,e,uh,xm),u);break}ry(e,uh,xm);break;case 5:ry(e,uh,xm);break;default:throw Error(In(329))}}}return mh(e,ml()),e.callbackNode===a?lj.bind(null,e):null}function wC(e,n){var a=p1;return e.current.memoizedState.isDehydrated&&(py(e,n).flags|=256),e=X2(e,n),e!==2&&(n=uh,uh=a,n!==null&&SC(n)),e}function SC(e){uh===null?uh=e:uh.push.apply(uh,e)}function D8(e){for(var n=e;;){if(n.flags&16384){var a=n.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var u=0;u<a.length;u++){var f=a[u],w=f.getSnapshot;f=f.value;try{if(!Fp(w(),f))return!1}catch{return!1}}}if(a=n.child,n.subtreeFlags&16384&&a!==null)a.return=n,n=a;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function zg(e,n){for(n&=~uP,n&=~RS,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var a=31-Np(n),u=1<<a;e[a]=-1,n&=~u}}function nD(e){if(ca&6)throw Error(In(327));Zv();var n=k2(e,0);if(!(n&1))return mh(e,ml()),null;var a=X2(e,n);if(e.tag!==0&&a===2){var u=ZI(e);u!==0&&(n=u,a=wC(e,u))}if(a===1)throw a=j1,py(e,0),zg(e,n),mh(e,ml()),a;if(a===6)throw Error(In(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,ry(e,uh,xm),mh(e,ml()),null}function dP(e,n){var a=ca;ca|=1;try{return e(n)}finally{ca=a,ca===0&&(l0=ml()+500,AS&&g_())}}function xy(e){Vg!==null&&Vg.tag===0&&!(ca&6)&&Zv();var n=ca;ca|=1;var a=qd.transition,u=Ba;try{if(qd.transition=null,Ba=1,e)return e()}finally{Ba=u,qd.transition=a,ca=n,!(ca&6)&&g_()}}function pP(){Fh=Vv.current,Es(Vv)}function py(e,n){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,c8(a)),Pl!==null)for(a=Pl.return;a!==null;){var u=a;switch(HA(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&z2();break;case 3:a0(),Es(ph),Es(Qc),rP();break;case 5:tP(u);break;case 4:a0();break;case 13:Es(Fs);break;case 19:Es(Fs);break;case 10:KA(u.type._context);break;case 22:case 23:pP()}a=a.return}if(lc=e,Pl=e=Jg(e.current,null),Ac=Fh=n,Gl=0,j1=null,uP=RS=vy=0,uh=p1=null,ly!==null){for(n=0;n<ly.length;n++)if(a=ly[n],u=a.interleaved,u!==null){a.interleaved=null;var f=u.next,w=a.pending;if(w!==null){var p=w.next;w.next=f,u.next=p}a.pending=u}ly=null}return e}function cj(e,n){do{var a=Pl;try{if(YA(),r2.current=q2,G2){for(var u=Vs.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}G2=!1}if(yy=0,sc=Ul=Vs=null,h1=!1,L1=0,cP.current=null,a===null||a.return===null){Gl=1,j1=n,Pl=null;break}e:{var w=e,p=a.return,s=a,L=n;if(n=Ac,s.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var F=L,G=s,H=G.tag;if(!(G.mode&1)&&(H===0||H===11||H===15)){var X=G.alternate;X?(G.updateQueue=X.updateQueue,G.memoizedState=X.memoizedState,G.lanes=X.lanes):(G.updateQueue=null,G.memoizedState=null)}var ne=GR(p);if(ne!==null){ne.flags&=-257,qR(ne,p,s,w,n),ne.mode&1&&$R(w,F,n),n=ne,L=F;var ie=n.updateQueue;if(ie===null){var se=new Set;se.add(L),n.updateQueue=se}else ie.add(L);break e}else{if(!(n&1)){$R(w,F,n),fP();break e}L=Error(In(426))}}else if(Ds&&s.mode&1){var Te=GR(p);if(Te!==null){!(Te.flags&65536)&&(Te.flags|=256),qR(Te,p,s,w,n),ZA(s0(L,s));break e}}w=L=s0(L,s),Gl!==4&&(Gl=2),p1===null?p1=[w]:p1.push(w),w=p;do{switch(w.tag){case 3:w.flags|=65536,n&=-n,w.lanes|=n;var ue=WN(w,L,n);zR(w,ue);break e;case 1:s=L;var ce=w.type,de=w.stateNode;if(!(w.flags&128)&&(typeof ce.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(Yg===null||!Yg.has(de)))){w.flags|=65536,n&=-n,w.lanes|=n;var Ee=HN(w,s,n);zR(w,Ee);break e}}w=w.return}while(w!==null)}dj(a)}catch(Ne){n=Ne,Pl===a&&a!==null&&(Pl=a=a.return);continue}break}while(1)}function uj(){var e=W2.current;return W2.current=q2,e===null?q2:e}function fP(){(Gl===0||Gl===3||Gl===2)&&(Gl=4),lc===null||!(vy&268435455)&&!(RS&268435455)||zg(lc,Ac)}function X2(e,n){var a=ca;ca|=2;var u=uj();(lc!==e||Ac!==n)&&(xm=null,py(e,n));do try{O8();break}catch(f){cj(e,f)}while(1);if(YA(),ca=a,W2.current=u,Pl!==null)throw Error(In(261));return lc=null,Ac=0,Gl}function O8(){for(;Pl!==null;)hj(Pl)}function L8(){for(;Pl!==null&&!aU();)hj(Pl)}function hj(e){var n=fj(e.alternate,e,Fh);e.memoizedProps=e.pendingProps,n===null?dj(e):Pl=n,cP.current=null}function dj(e){var n=e;do{var a=n.alternate;if(e=n.return,n.flags&32768){if(a=A8(a,n),a!==null){a.flags&=32767,Pl=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gl=6,Pl=null;return}}else if(a=C8(a,n,Fh),a!==null){Pl=a;return}if(n=n.sibling,n!==null){Pl=n;return}Pl=n=e}while(n!==null);Gl===0&&(Gl=5)}function ry(e,n,a){var u=Ba,f=qd.transition;try{qd.transition=null,Ba=1,z8(e,n,a,u)}finally{qd.transition=f,Ba=u}return null}function z8(e,n,a,u){do Zv();while(Vg!==null);if(ca&6)throw Error(In(327));a=e.finishedWork;var f=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(In(177));e.callbackNode=null,e.callbackPriority=0;var w=a.lanes|a.childLanes;if(gU(e,w),e===lc&&(Pl=lc=null,Ac=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Nw||(Nw=!0,mj(M2,function(){return Zv(),null})),w=(a.flags&15990)!==0,a.subtreeFlags&15990||w){w=qd.transition,qd.transition=null;var p=Ba;Ba=1;var s=ca;ca|=4,cP.current=null,M8(e,a),aj(a,e),r8(eC),R2=!!QI,eC=QI=null,e.current=a,k8(a),sU(),ca=s,Ba=p,qd.transition=w}else e.current=a;if(Nw&&(Nw=!1,Vg=e,Z2=f),w=e.pendingLanes,w===0&&(Yg=null),uU(a.stateNode),mh(e,ml()),n!==null)for(u=e.onRecoverableError,a=0;a<n.length;a++)f=n[a],u(f.value,{componentStack:f.stack,digest:f.digest});if(H2)throw H2=!1,e=xC,xC=null,e;return Z2&1&&e.tag!==0&&Zv(),w=e.pendingLanes,w&1?e===bC?f1++:(f1=0,bC=e):f1=0,g_(),null}function Zv(){if(Vg!==null){var e=qz(Z2),n=qd.transition,a=Ba;try{if(qd.transition=null,Ba=16>e?16:e,Vg===null)var u=!1;else{if(e=Vg,Vg=null,Z2=0,ca&6)throw Error(In(331));var f=ca;for(ca|=4,bi=e.current;bi!==null;){var w=bi,p=w.child;if(bi.flags&16){var s=w.deletions;if(s!==null){for(var L=0;L<s.length;L++){var F=s[L];for(bi=F;bi!==null;){var G=bi;switch(G.tag){case 0:case 11:case 15:d1(8,G,w)}var H=G.child;if(H!==null)H.return=G,bi=H;else for(;bi!==null;){G=bi;var X=G.sibling,ne=G.return;if(nj(G),G===F){bi=null;break}if(X!==null){X.return=ne,bi=X;break}bi=ne}}}var ie=w.alternate;if(ie!==null){var se=ie.child;if(se!==null){ie.child=null;do{var Te=se.sibling;se.sibling=null,se=Te}while(se!==null)}}bi=w}}if(w.subtreeFlags&2064&&p!==null)p.return=w,bi=p;else e:for(;bi!==null;){if(w=bi,w.flags&2048)switch(w.tag){case 0:case 11:case 15:d1(9,w,w.return)}var ue=w.sibling;if(ue!==null){ue.return=w.return,bi=ue;break e}bi=w.return}}var ce=e.current;for(bi=ce;bi!==null;){p=bi;var de=p.child;if(p.subtreeFlags&2064&&de!==null)de.return=p,bi=de;else e:for(p=ce;bi!==null;){if(s=bi,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:kS(9,s)}}catch(Ne){nl(s,s.return,Ne)}if(s===p){bi=null;break e}var Ee=s.sibling;if(Ee!==null){Ee.return=s.return,bi=Ee;break e}bi=s.return}}if(ca=f,g_(),Ef&&typeof Ef.onPostCommitFiberRoot=="function")try{Ef.onPostCommitFiberRoot(SS,e)}catch{}u=!0}return u}finally{Ba=a,qd.transition=n}}return!1}function iD(e,n,a){n=s0(a,n),n=WN(e,n,1),e=Xg(e,n,1),n=Au(),e!==null&&(ob(e,1,n),mh(e,n))}function nl(e,n,a){if(e.tag===3)iD(e,e,a);else for(;n!==null;){if(n.tag===3){iD(n,e,a);break}else if(n.tag===1){var u=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Yg===null||!Yg.has(u))){e=s0(a,e),e=HN(n,e,1),n=Xg(n,e,1),e=Au(),n!==null&&(ob(n,1,e),mh(n,e));break}}n=n.return}}function N8(e,n,a){var u=e.pingCache;u!==null&&u.delete(n),n=Au(),e.pingedLanes|=e.suspendedLanes&a,lc===e&&(Ac&a)===a&&(Gl===4||Gl===3&&(Ac&130023424)===Ac&&500>ml()-hP?py(e,0):uP|=a),mh(e,n)}function pj(e,n){n===0&&(e.mode&1?(n=Cw,Cw<<=1,!(Cw&130023424)&&(Cw=4194304)):n=1);var a=Au();e=Pm(e,n),e!==null&&(ob(e,n,a),mh(e,a))}function j8(e){var n=e.memoizedState,a=0;n!==null&&(a=n.retryLane),pj(e,a)}function B8(e,n){var a=0;switch(e.tag){case 13:var u=e.stateNode,f=e.memoizedState;f!==null&&(a=f.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(In(314))}u!==null&&u.delete(n),pj(e,a)}var fj;fj=function(e,n,a){if(e!==null)if(e.memoizedProps!==n.pendingProps||ph.current)hh=!0;else{if(!(e.lanes&a)&&!(n.flags&128))return hh=!1,I8(e,n,a);hh=!!(e.flags&131072)}else hh=!1,Ds&&n.flags&1048576&&_N(n,B2,n.index);switch(n.lanes=0,n.tag){case 2:var u=n.type;i2(e,n),e=n.pendingProps;var f=n0(n,Qc.current);Hv(n,a),f=iP(null,n,u,e,f,a);var w=oP();return n.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,fh(u)?(w=!0,N2(n)):w=!1,n.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,QA(n),f.updater=PS,n.stateNode=f,f._reactInternals=n,cC(n,u,e,a),n=dC(null,n,u,!0,w,a)):(n.tag=0,Ds&&w&&WA(n),Eu(null,n,f,a),n=n.child),n;case 16:u=n.elementType;e:{switch(i2(e,n),e=n.pendingProps,f=u._init,u=f(u._payload),n.type=u,f=n.tag=V8(u),e=kp(u,e),f){case 0:n=hC(null,n,u,e,a);break e;case 1:n=ZR(null,n,u,e,a);break e;case 11:n=WR(null,n,u,e,a);break e;case 14:n=HR(null,n,u,kp(u.type,e),a);break e}throw Error(In(306,u,""))}return n;case 0:return u=n.type,f=n.pendingProps,f=n.elementType===u?f:kp(u,f),hC(e,n,u,f,a);case 1:return u=n.type,f=n.pendingProps,f=n.elementType===u?f:kp(u,f),ZR(e,n,u,f,a);case 3:e:{if(KN(n),e===null)throw Error(In(387));u=n.pendingProps,w=n.memoizedState,f=w.element,bN(e,n),U2(n,u,null,a);var p=n.memoizedState;if(u=p.element,w.isDehydrated)if(w={element:u,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},n.updateQueue.baseState=w,n.memoizedState=w,n.flags&256){f=s0(Error(In(423)),n),n=XR(e,n,u,a,f);break e}else if(u!==f){f=s0(Error(In(424)),n),n=XR(e,n,u,a,f);break e}else for(Gh=Zg(n.stateNode.containerInfo.firstChild),qh=n,Ds=!0,Dp=null,a=EN(n,null,u,a),n.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(i0(),u===f){n=Mm(e,n,a);break e}Eu(e,n,u,a)}n=n.child}return n;case 5:return IN(n),e===null&&aC(n),u=n.type,f=n.pendingProps,w=e!==null?e.memoizedProps:null,p=f.children,tC(u,f)?p=null:w!==null&&tC(u,w)&&(n.flags|=32),YN(e,n),Eu(e,n,p,a),n.child;case 6:return e===null&&aC(n),null;case 13:return JN(e,n,a);case 4:return eP(n,n.stateNode.containerInfo),u=n.pendingProps,e===null?n.child=o0(n,null,u,a):Eu(e,n,u,a),n.child;case 11:return u=n.type,f=n.pendingProps,f=n.elementType===u?f:kp(u,f),WR(e,n,u,f,a);case 7:return Eu(e,n,n.pendingProps,a),n.child;case 8:return Eu(e,n,n.pendingProps.children,a),n.child;case 12:return Eu(e,n,n.pendingProps.children,a),n.child;case 10:e:{if(u=n.type._context,f=n.pendingProps,w=n.memoizedProps,p=f.value,ps(F2,u._currentValue),u._currentValue=p,w!==null)if(Fp(w.value,p)){if(w.children===f.children&&!ph.current){n=Mm(e,n,a);break e}}else for(w=n.child,w!==null&&(w.return=n);w!==null;){var s=w.dependencies;if(s!==null){p=w.child;for(var L=s.firstContext;L!==null;){if(L.context===u){if(w.tag===1){L=Tm(-1,a&-a),L.tag=2;var F=w.updateQueue;if(F!==null){F=F.shared;var G=F.pending;G===null?L.next=L:(L.next=G.next,G.next=L),F.pending=L}}w.lanes|=a,L=w.alternate,L!==null&&(L.lanes|=a),sC(w.return,a,n),s.lanes|=a;break}L=L.next}}else if(w.tag===10)p=w.type===n.type?null:w.child;else if(w.tag===18){if(p=w.return,p===null)throw Error(In(341));p.lanes|=a,s=p.alternate,s!==null&&(s.lanes|=a),sC(p,a,n),p=w.sibling}else p=w.child;if(p!==null)p.return=w;else for(p=w;p!==null;){if(p===n){p=null;break}if(w=p.sibling,w!==null){w.return=p.return,p=w;break}p=p.return}w=p}Eu(e,n,f.children,a),n=n.child}return n;case 9:return f=n.type,u=n.pendingProps.children,Hv(n,a),f=Yd(f),u=u(f),n.flags|=1,Eu(e,n,u,a),n.child;case 14:return u=n.type,f=kp(u,n.pendingProps),f=kp(u.type,f),HR(e,n,u,f,a);case 15:return ZN(e,n,n.type,n.pendingProps,a);case 17:return u=n.type,f=n.pendingProps,f=n.elementType===u?f:kp(u,f),i2(e,n),n.tag=1,fh(u)?(e=!0,N2(n)):e=!1,Hv(n,a),SN(n,u,f),cC(n,u,f,a),dC(null,n,u,!0,e,a);case 19:return QN(e,n,a);case 22:return XN(e,n,a)}throw Error(In(156,n.tag))};function mj(e,n){return Vz(e,n)}function F8(e,n,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gd(e,n,a,u){return new F8(e,n,a,u)}function mP(e){return e=e.prototype,!(!e||!e.isReactComponent)}function V8(e){if(typeof e=="function")return mP(e)?1:0;if(e!=null){if(e=e.$$typeof,e===OA)return 11;if(e===LA)return 14}return 2}function Jg(e,n){var a=e.alternate;return a===null?(a=Gd(e.tag,n,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=n,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,n=e.dependencies,a.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function s2(e,n,a,u,f,w){var p=2;if(u=e,typeof e=="function")mP(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case kv:return fy(a.children,f,w,n);case DA:p=8,f|=8;break;case DI:return e=Gd(12,a,n,f|2),e.elementType=DI,e.lanes=w,e;case OI:return e=Gd(13,a,n,f),e.elementType=OI,e.lanes=w,e;case LI:return e=Gd(19,a,n,f),e.elementType=LI,e.lanes=w,e;case Tz:return DS(a,f,w,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case wz:p=10;break e;case Sz:p=9;break e;case OA:p=11;break e;case LA:p=14;break e;case Dg:p=16,u=null;break e}throw Error(In(130,e==null?e:typeof e,""))}return n=Gd(p,a,n,f),n.elementType=e,n.type=u,n.lanes=w,n}function fy(e,n,a,u){return e=Gd(7,e,u,n),e.lanes=a,e}function DS(e,n,a,u){return e=Gd(22,e,u,n),e.elementType=Tz,e.lanes=a,e.stateNode={isHidden:!1},e}function QE(e,n,a){return e=Gd(6,e,null,n),e.lanes=a,e}function eI(e,n,a){return n=Gd(4,e.children!==null?e.children:[],e.key,n),n.lanes=a,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function U8(e,n,a,u,f){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=OE(0),this.expirationTimes=OE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=OE(0),this.identifierPrefix=u,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function gP(e,n,a,u,f,w,p,s,L){return e=new U8(e,n,a,s,L),n===1?(n=1,w===!0&&(n|=8)):n=0,w=Gd(3,null,null,n),e.current=w,w.stateNode=e,w.memoizedState={element:u,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},QA(w),e}function $8(e,n,a){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mv,key:u==null?null:""+u,children:e,containerInfo:n,implementation:a}}function gj(e){if(!e)return o_;e=e._reactInternals;e:{if(Cy(e)!==e||e.tag!==1)throw Error(In(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(fh(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(In(171))}if(e.tag===1){var a=e.type;if(fh(a))return mN(e,a,n)}return n}function _j(e,n,a,u,f,w,p,s,L){return e=gP(a,u,!0,e,f,w,p,s,L),e.context=gj(null),a=e.current,u=Au(),f=Kg(a),w=Tm(u,f),w.callback=n??null,Xg(a,w,f),e.current.lanes=f,ob(e,f,u),mh(e,u),e}function OS(e,n,a,u){var f=n.current,w=Au(),p=Kg(f);return a=gj(a),n.context===null?n.context=a:n.pendingContext=a,n=Tm(w,p),n.payload={element:e},u=u===void 0?null:u,u!==null&&(n.callback=u),e=Xg(f,n,p),e!==null&&(jp(e,f,p,w),t2(e,f,p)),p}function Y2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function oD(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<n?a:n}}function _P(e,n){oD(e,n),(e=e.alternate)&&oD(e,n)}function G8(){return null}var yj=typeof reportError=="function"?reportError:function(e){console.error(e)};function yP(e){this._internalRoot=e}LS.prototype.render=yP.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(In(409));OS(e,n,null,null)};LS.prototype.unmount=yP.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;xy(function(){OS(null,e,null,null)}),n[Am]=null}};function LS(e){this._internalRoot=e}LS.prototype.unstable_scheduleHydration=function(e){if(e){var n=Zz();e={blockedOn:null,target:e,priority:n};for(var a=0;a<Lg.length&&n!==0&&n<Lg[a].priority;a++);Lg.splice(a,0,e),a===0&&Yz(e)}};function vP(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function aD(){}function q8(e,n,a,u,f){if(f){if(typeof u=="function"){var w=u;u=function(){var F=Y2(p);w.call(F)}}var p=_j(n,u,e,0,null,!1,!1,"",aD);return e._reactRootContainer=p,e[Am]=p.current,M1(e.nodeType===8?e.parentNode:e),xy(),p}for(;f=e.lastChild;)e.removeChild(f);if(typeof u=="function"){var s=u;u=function(){var F=Y2(L);s.call(F)}}var L=gP(e,0,!1,null,null,!1,!1,"",aD);return e._reactRootContainer=L,e[Am]=L.current,M1(e.nodeType===8?e.parentNode:e),xy(function(){OS(n,L,a,u)}),L}function NS(e,n,a,u,f){var w=a._reactRootContainer;if(w){var p=w;if(typeof f=="function"){var s=f;f=function(){var L=Y2(p);s.call(L)}}OS(n,p,e,f)}else p=q8(a,n,e,f,u);return Y2(p)}Wz=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var a=r1(n.pendingLanes);a!==0&&(jA(n,a|1),mh(n,ml()),!(ca&6)&&(l0=ml()+500,g_()))}break;case 13:xy(function(){var u=Pm(e,1);if(u!==null){var f=Au();jp(u,e,1,f)}}),_P(e,1)}};BA=function(e){if(e.tag===13){var n=Pm(e,134217728);if(n!==null){var a=Au();jp(n,e,134217728,a)}_P(e,134217728)}};Hz=function(e){if(e.tag===13){var n=Kg(e),a=Pm(e,n);if(a!==null){var u=Au();jp(a,e,n,u)}_P(e,n)}};Zz=function(){return Ba};Xz=function(e,n){var a=Ba;try{return Ba=e,n()}finally{Ba=a}};qI=function(e,n,a){switch(n){case"input":if(jI(e,a),n=a.name,a.type==="radio"&&n!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<a.length;n++){var u=a[n];if(u!==e&&u.form===e.form){var f=CS(u);if(!f)throw Error(In(90));Iz(u),jI(u,f)}}}break;case"textarea":Az(e,a);break;case"select":n=a.value,n!=null&&$v(e,!!a.multiple,n,!1)}};Lz=dP;zz=xy;var W8={usingClientEntryPoint:!1,Events:[sb,Lv,CS,Dz,Oz,dP]},Fx={findFiberByHostInstance:sy,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},H8={bundleType:Fx.bundleType,version:Fx.version,rendererPackageName:Fx.rendererPackageName,rendererConfig:Fx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lm.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Bz(e),e===null?null:e.stateNode},findFiberByHostInstance:Fx.findFiberByHostInstance||G8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jw.isDisabled&&jw.supportsFiber)try{SS=jw.inject(H8),Ef=jw}catch{}}Yh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W8;Yh.createPortal=function(e,n){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vP(n))throw Error(In(200));return $8(e,n,null,a)};Yh.createRoot=function(e,n){if(!vP(e))throw Error(In(299));var a=!1,u="",f=yj;return n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(u=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),n=gP(e,1,!1,null,null,a,!1,u,f),e[Am]=n.current,M1(e.nodeType===8?e.parentNode:e),new yP(n)};Yh.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(In(188)):(e=Object.keys(e).join(","),Error(In(268,e)));return e=Bz(n),e=e===null?null:e.stateNode,e};Yh.flushSync=function(e){return xy(e)};Yh.hydrate=function(e,n,a){if(!zS(n))throw Error(In(200));return NS(null,e,n,!0,a)};Yh.hydrateRoot=function(e,n,a){if(!vP(e))throw Error(In(405));var u=a!=null&&a.hydratedSources||null,f=!1,w="",p=yj;if(a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(w=a.identifierPrefix),a.onRecoverableError!==void 0&&(p=a.onRecoverableError)),n=_j(n,null,e,1,a??null,f,!1,w,p),e[Am]=n.current,M1(e),u)for(e=0;e<u.length;e++)a=u[e],f=a._getVersion,f=f(a._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[a,f]:n.mutableSourceEagerHydrationData.push(a,f);return new LS(n)};Yh.render=function(e,n,a){if(!zS(n))throw Error(In(200));return NS(null,e,n,!1,a)};Yh.unmountComponentAtNode=function(e){if(!zS(e))throw Error(In(40));return e._reactRootContainer?(xy(function(){NS(null,null,e,!1,function(){e._reactRootContainer=null,e[Am]=null})}),!0):!1};Yh.unstable_batchedUpdates=dP;Yh.unstable_renderSubtreeIntoContainer=function(e,n,a,u){if(!zS(a))throw Error(In(200));if(e==null||e._reactInternals===void 0)throw Error(In(38));return NS(e,n,a,!1,u)};Yh.version="18.2.0-next-9e3b772b8-20220608";function vj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vj)}catch(e){console.error(e)}}vj(),_z.exports=Yh;var jS=_z.exports,sD=jS;kI.createRoot=sD.createRoot,kI.hydrateRoot=sD.hydrateRoot;/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function B1(){return B1=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},B1.apply(this,arguments)}var Ug;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ug||(Ug={}));const lD="popstate";function Z8(e){e===void 0&&(e={});function n(u,f){let{pathname:w,search:p,hash:s}=u.location;return TC("",{pathname:w,search:p,hash:s},f.state&&f.state.usr||null,f.state&&f.state.key||"default")}function a(u,f){return typeof f=="string"?f:K2(f)}return Y8(n,a,null,e)}function ol(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function xP(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function X8(){return Math.random().toString(36).substr(2,8)}function cD(e,n){return{usr:e.state,key:e.key,idx:n}}function TC(e,n,a,u){return a===void 0&&(a=null),B1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?C0(n):n,{state:a,key:n&&n.key||u||X8()})}function K2(e){let{pathname:n="/",search:a="",hash:u=""}=e;return a&&a!=="?"&&(n+=a.charAt(0)==="?"?a:"?"+a),u&&u!=="#"&&(n+=u.charAt(0)==="#"?u:"#"+u),n}function C0(e){let n={};if(e){let a=e.indexOf("#");a>=0&&(n.hash=e.substr(a),e=e.substr(0,a));let u=e.indexOf("?");u>=0&&(n.search=e.substr(u),e=e.substr(0,u)),e&&(n.pathname=e)}return n}function Y8(e,n,a,u){u===void 0&&(u={});let{window:f=document.defaultView,v5Compat:w=!1}=u,p=f.history,s=Ug.Pop,L=null,F=G();F==null&&(F=0,p.replaceState(B1({},p.state,{idx:F}),""));function G(){return(p.state||{idx:null}).idx}function H(){s=Ug.Pop;let Te=G(),ue=Te==null?null:Te-F;F=Te,L&&L({action:s,location:se.location,delta:ue})}function X(Te,ue){s=Ug.Push;let ce=TC(se.location,Te,ue);a&&a(ce,Te),F=G()+1;let de=cD(ce,F),Ee=se.createHref(ce);try{p.pushState(de,"",Ee)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;f.location.assign(Ee)}w&&L&&L({action:s,location:se.location,delta:1})}function ne(Te,ue){s=Ug.Replace;let ce=TC(se.location,Te,ue);a&&a(ce,Te),F=G();let de=cD(ce,F),Ee=se.createHref(ce);p.replaceState(de,"",Ee),w&&L&&L({action:s,location:se.location,delta:0})}function ie(Te){let ue=f.location.origin!=="null"?f.location.origin:f.location.href,ce=typeof Te=="string"?Te:K2(Te);return ol(ue,"No window.location.(origin|href) available to create URL for href: "+ce),new URL(ce,ue)}let se={get action(){return s},get location(){return e(f,p)},listen(Te){if(L)throw new Error("A history only accepts one active listener");return f.addEventListener(lD,H),L=Te,()=>{f.removeEventListener(lD,H),L=null}},createHref(Te){return n(f,Te)},createURL:ie,encodeLocation(Te){let ue=ie(Te);return{pathname:ue.pathname,search:ue.search,hash:ue.hash}},push:X,replace:ne,go(Te){return p.go(Te)}};return se}var uD;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(uD||(uD={}));function K8(e,n,a){a===void 0&&(a="/");let u=typeof n=="string"?C0(n):n,f=c0(u.pathname||"/",a);if(f==null)return null;let w=xj(e);J8(w);let p=null;for(let s=0;p==null&&s<w.length;++s)p=s9(w[s],c9(f));return p}function xj(e,n,a,u){n===void 0&&(n=[]),a===void 0&&(a=[]),u===void 0&&(u="");let f=(w,p,s)=>{let L={relativePath:s===void 0?w.path||"":s,caseSensitive:w.caseSensitive===!0,childrenIndex:p,route:w};L.relativePath.startsWith("/")&&(ol(L.relativePath.startsWith(u),'Absolute route path "'+L.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),L.relativePath=L.relativePath.slice(u.length));let F=Qg([u,L.relativePath]),G=a.concat(L);w.children&&w.children.length>0&&(ol(w.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+F+'".')),xj(w.children,n,G,F)),!(w.path==null&&!w.index)&&n.push({path:F,score:o9(F,w.index),routesMeta:G})};return e.forEach((w,p)=>{var s;if(w.path===""||!((s=w.path)!=null&&s.includes("?")))f(w,p);else for(let L of bj(w.path))f(w,p,L)}),n}function bj(e){let n=e.split("/");if(n.length===0)return[];let[a,...u]=n,f=a.endsWith("?"),w=a.replace(/\?$/,"");if(u.length===0)return f?[w,""]:[w];let p=bj(u.join("/")),s=[];return s.push(...p.map(L=>L===""?w:[w,L].join("/"))),f&&s.push(...p),s.map(L=>e.startsWith("/")&&L===""?"/":L)}function J8(e){e.sort((n,a)=>n.score!==a.score?a.score-n.score:a9(n.routesMeta.map(u=>u.childrenIndex),a.routesMeta.map(u=>u.childrenIndex)))}const Q8=/^:[\w-]+$/,e9=3,t9=2,r9=1,n9=10,i9=-2,hD=e=>e==="*";function o9(e,n){let a=e.split("/"),u=a.length;return a.some(hD)&&(u+=i9),n&&(u+=t9),a.filter(f=>!hD(f)).reduce((f,w)=>f+(Q8.test(w)?e9:w===""?r9:n9),u)}function a9(e,n){return e.length===n.length&&e.slice(0,-1).every((u,f)=>u===n[f])?e[e.length-1]-n[n.length-1]:0}function s9(e,n){let{routesMeta:a}=e,u={},f="/",w=[];for(let p=0;p<a.length;++p){let s=a[p],L=p===a.length-1,F=f==="/"?n:n.slice(f.length)||"/",G=EC({path:s.relativePath,caseSensitive:s.caseSensitive,end:L},F);if(!G)return null;Object.assign(u,G.params);let H=s.route;w.push({params:u,pathname:Qg([f,G.pathname]),pathnameBase:f9(Qg([f,G.pathnameBase])),route:H}),G.pathnameBase!=="/"&&(f=Qg([f,G.pathnameBase]))}return w}function EC(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,u]=l9(e.path,e.caseSensitive,e.end),f=n.match(a);if(!f)return null;let w=f[0],p=w.replace(/(.)\/+$/,"$1"),s=f.slice(1);return{params:u.reduce((F,G,H)=>{let{paramName:X,isOptional:ne}=G;if(X==="*"){let se=s[H]||"";p=w.slice(0,w.length-se.length).replace(/(.)\/+$/,"$1")}const ie=s[H];return ne&&!ie?F[X]=void 0:F[X]=u9(ie||"",X),F},{}),pathname:w,pathnameBase:p,pattern:e}}function l9(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!0),xP(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let u=[],f="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,s,L)=>(u.push({paramName:s,isOptional:L!=null}),L?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(u.push({paramName:"*"}),f+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?f+="\\/*$":e!==""&&e!=="/"&&(f+="(?:(?=\\/|$))"),[new RegExp(f,n?void 0:"i"),u]}function c9(e){try{return decodeURI(e)}catch(n){return xP(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function u9(e,n){try{return decodeURIComponent(e)}catch(a){return xP(!1,'The value for the URL param "'+n+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),e}}function c0(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,u=e.charAt(a);return u&&u!=="/"?null:e.slice(a)||"/"}function h9(e,n){n===void 0&&(n="/");let{pathname:a,search:u="",hash:f=""}=typeof e=="string"?C0(e):e;return{pathname:a?a.startsWith("/")?a:d9(a,n):n,search:m9(u),hash:g9(f)}}function d9(e,n){let a=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(f=>{f===".."?a.length>1&&a.pop():f!=="."&&a.push(f)}),a.length>1?a.join("/"):"/"}function tI(e,n,a,u){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function p9(e){return e.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function wj(e,n){let a=p9(e);return n?a.map((u,f)=>f===e.length-1?u.pathname:u.pathnameBase):a.map(u=>u.pathnameBase)}function Sj(e,n,a,u){u===void 0&&(u=!1);let f;typeof e=="string"?f=C0(e):(f=B1({},e),ol(!f.pathname||!f.pathname.includes("?"),tI("?","pathname","search",f)),ol(!f.pathname||!f.pathname.includes("#"),tI("#","pathname","hash",f)),ol(!f.search||!f.search.includes("#"),tI("#","search","hash",f)));let w=e===""||f.pathname==="",p=w?"/":f.pathname,s;if(p==null)s=a;else{let H=n.length-1;if(!u&&p.startsWith("..")){let X=p.split("/");for(;X[0]==="..";)X.shift(),H-=1;f.pathname=X.join("/")}s=H>=0?n[H]:"/"}let L=h9(f,s),F=p&&p!=="/"&&p.endsWith("/"),G=(w||p===".")&&a.endsWith("/");return!L.pathname.endsWith("/")&&(F||G)&&(L.pathname+="/"),L}const Qg=e=>e.join("/").replace(/\/\/+/g,"/"),f9=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),m9=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,g9=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _9(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Tj=["post","put","patch","delete"];new Set(Tj);const y9=["get",...Tj];new Set(y9);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function F1(){return F1=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},F1.apply(this,arguments)}const BS=fe.createContext(null),Ej=fe.createContext(null),__=fe.createContext(null),FS=fe.createContext(null),y_=fe.createContext({outlet:null,matches:[],isDataRoute:!1}),Ij=fe.createContext(null);function v9(e,n){let{relative:a}=n===void 0?{}:n;cb()||ol(!1);let{basename:u,navigator:f}=fe.useContext(__),{hash:w,pathname:p,search:s}=VS(e,{relative:a}),L=p;return u!=="/"&&(L=p==="/"?u:Qg([u,p])),f.createHref({pathname:L,search:s,hash:w})}function cb(){return fe.useContext(FS)!=null}function Vp(){return cb()||ol(!1),fe.useContext(FS).location}function Cj(e){fe.useContext(__).static||fe.useLayoutEffect(e)}function ql(){let{isDataRoute:e}=fe.useContext(y_);return e?R9():x9()}function x9(){cb()||ol(!1);let e=fe.useContext(BS),{basename:n,future:a,navigator:u}=fe.useContext(__),{matches:f}=fe.useContext(y_),{pathname:w}=Vp(),p=JSON.stringify(wj(f,a.v7_relativeSplatPath)),s=fe.useRef(!1);return Cj(()=>{s.current=!0}),fe.useCallback(function(F,G){if(G===void 0&&(G={}),!s.current)return;if(typeof F=="number"){u.go(F);return}let H=Sj(F,JSON.parse(p),w,G.relative==="path");e==null&&n!=="/"&&(H.pathname=H.pathname==="/"?n:Qg([n,H.pathname])),(G.replace?u.replace:u.push)(H,G.state,G)},[n,u,p,w,e])}function Ay(){let{matches:e}=fe.useContext(y_),n=e[e.length-1];return n?n.params:{}}function VS(e,n){let{relative:a}=n===void 0?{}:n,{future:u}=fe.useContext(__),{matches:f}=fe.useContext(y_),{pathname:w}=Vp(),p=JSON.stringify(wj(f,u.v7_relativeSplatPath));return fe.useMemo(()=>Sj(e,JSON.parse(p),w,a==="path"),[e,p,w,a])}function b9(e,n){return w9(e,n)}function w9(e,n,a,u){cb()||ol(!1);let{navigator:f}=fe.useContext(__),{matches:w}=fe.useContext(y_),p=w[w.length-1],s=p?p.params:{};p&&p.pathname;let L=p?p.pathnameBase:"/";p&&p.route;let F=Vp(),G;if(n){var H;let Te=typeof n=="string"?C0(n):n;L==="/"||(H=Te.pathname)!=null&&H.startsWith(L)||ol(!1),G=Te}else G=F;let X=G.pathname||"/",ne=L==="/"?X:X.slice(L.length)||"/",ie=K8(e,{pathname:ne}),se=C9(ie&&ie.map(Te=>Object.assign({},Te,{params:Object.assign({},s,Te.params),pathname:Qg([L,f.encodeLocation?f.encodeLocation(Te.pathname).pathname:Te.pathname]),pathnameBase:Te.pathnameBase==="/"?L:Qg([L,f.encodeLocation?f.encodeLocation(Te.pathnameBase).pathname:Te.pathnameBase])})),w,a,u);return n&&se?fe.createElement(FS.Provider,{value:{location:F1({pathname:"/",search:"",hash:"",state:null,key:"default"},G),navigationType:Ug.Pop}},se):se}function S9(){let e=k9(),n=_9(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,f={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},w=null;return fe.createElement(fe.Fragment,null,fe.createElement("h2",null,"Unexpected Application Error!"),fe.createElement("h3",{style:{fontStyle:"italic"}},n),a?fe.createElement("pre",{style:f},a):null,w)}const T9=fe.createElement(S9,null);class E9 extends fe.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,a){return a.location!==n.location||a.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:a.error,location:a.location,revalidation:n.revalidation||a.revalidation}}componentDidCatch(n,a){console.error("React Router caught the following error during render",n,a)}render(){return this.state.error!==void 0?fe.createElement(y_.Provider,{value:this.props.routeContext},fe.createElement(Ij.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function I9(e){let{routeContext:n,match:a,children:u}=e,f=fe.useContext(BS);return f&&f.static&&f.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(f.staticContext._deepestRenderedBoundaryId=a.route.id),fe.createElement(y_.Provider,{value:n},u)}function C9(e,n,a,u){var f;if(n===void 0&&(n=[]),a===void 0&&(a=null),u===void 0&&(u=null),e==null){var w;if((w=a)!=null&&w.errors)e=a.matches;else return null}let p=e,s=(f=a)==null?void 0:f.errors;if(s!=null){let G=p.findIndex(H=>H.route.id&&(s==null?void 0:s[H.route.id]));G>=0||ol(!1),p=p.slice(0,Math.min(p.length,G+1))}let L=!1,F=-1;if(a&&u&&u.v7_partialHydration)for(let G=0;G<p.length;G++){let H=p[G];if((H.route.HydrateFallback||H.route.hydrateFallbackElement)&&(F=G),H.route.id){let{loaderData:X,errors:ne}=a,ie=H.route.loader&&X[H.route.id]===void 0&&(!ne||ne[H.route.id]===void 0);if(H.route.lazy||ie){L=!0,F>=0?p=p.slice(0,F+1):p=[p[0]];break}}}return p.reduceRight((G,H,X)=>{let ne,ie=!1,se=null,Te=null;a&&(ne=s&&H.route.id?s[H.route.id]:void 0,se=H.route.errorElement||T9,L&&(F<0&&X===0?(D9("route-fallback",!1),ie=!0,Te=null):F===X&&(ie=!0,Te=H.route.hydrateFallbackElement||null)));let ue=n.concat(p.slice(0,X+1)),ce=()=>{let de;return ne?de=se:ie?de=Te:H.route.Component?de=fe.createElement(H.route.Component,null):H.route.element?de=H.route.element:de=G,fe.createElement(I9,{match:H,routeContext:{outlet:G,matches:ue,isDataRoute:a!=null},children:de})};return a&&(H.route.ErrorBoundary||H.route.errorElement||X===0)?fe.createElement(E9,{location:a.location,revalidation:a.revalidation,component:se,error:ne,children:ce(),routeContext:{outlet:null,matches:ue,isDataRoute:!0}}):ce()},null)}var Aj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Aj||{}),J2=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(J2||{});function A9(e){let n=fe.useContext(BS);return n||ol(!1),n}function P9(e){let n=fe.useContext(Ej);return n||ol(!1),n}function M9(e){let n=fe.useContext(y_);return n||ol(!1),n}function Pj(e){let n=M9(),a=n.matches[n.matches.length-1];return a.route.id||ol(!1),a.route.id}function k9(){var e;let n=fe.useContext(Ij),a=P9(J2.UseRouteError),u=Pj(J2.UseRouteError);return n!==void 0?n:(e=a.errors)==null?void 0:e[u]}function R9(){let{router:e}=A9(Aj.UseNavigateStable),n=Pj(J2.UseNavigateStable),a=fe.useRef(!1);return Cj(()=>{a.current=!0}),fe.useCallback(function(f,w){w===void 0&&(w={}),a.current&&(typeof f=="number"?e.navigate(f):e.navigate(f,F1({fromRouteId:n},w)))},[e,n])}const dD={};function D9(e,n,a){!n&&!dD[e]&&(dD[e]=!0)}function Di(e){ol(!1)}function O9(e){let{basename:n="/",children:a=null,location:u,navigationType:f=Ug.Pop,navigator:w,static:p=!1,future:s}=e;cb()&&ol(!1);let L=n.replace(/^\/*/,"/"),F=fe.useMemo(()=>({basename:L,navigator:w,static:p,future:F1({v7_relativeSplatPath:!1},s)}),[L,s,w,p]);typeof u=="string"&&(u=C0(u));let{pathname:G="/",search:H="",hash:X="",state:ne=null,key:ie="default"}=u,se=fe.useMemo(()=>{let Te=c0(G,L);return Te==null?null:{location:{pathname:Te,search:H,hash:X,state:ne,key:ie},navigationType:f}},[L,G,H,X,ne,ie,f]);return se==null?null:fe.createElement(__.Provider,{value:F},fe.createElement(FS.Provider,{children:a,value:se}))}function Mj(e){let{children:n,location:a}=e;return b9(IC(n),a)}new Promise(()=>{});function IC(e,n){n===void 0&&(n=[]);let a=[];return fe.Children.forEach(e,(u,f)=>{if(!fe.isValidElement(u))return;let w=[...n,f];if(u.type===fe.Fragment){a.push.apply(a,IC(u.props.children,w));return}u.type!==Di&&ol(!1),!u.props.index||!u.props.children||ol(!1);let p={id:u.props.id||w.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(p.children=IC(u.props.children,w)),a.push(p)}),a}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Q2(){return Q2=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},Q2.apply(this,arguments)}function kj(e,n){if(e==null)return{};var a={},u=Object.keys(e),f,w;for(w=0;w<u.length;w++)f=u[w],!(n.indexOf(f)>=0)&&(a[f]=e[f]);return a}function L9(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function z9(e,n){return e.button===0&&(!n||n==="_self")&&!L9(e)}const N9=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],j9=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],B9=fe.createContext({isTransitioning:!1}),F9="startTransition",pD=I2[F9];function V9(e){let{basename:n,children:a,future:u,window:f}=e,w=fe.useRef();w.current==null&&(w.current=Z8({window:f,v5Compat:!0}));let p=w.current,[s,L]=fe.useState({action:p.action,location:p.location}),{v7_startTransition:F}=u||{},G=fe.useCallback(H=>{F&&pD?pD(()=>L(H)):L(H)},[L,F]);return fe.useLayoutEffect(()=>p.listen(G),[p,G]),fe.createElement(O9,{basename:n,children:a,location:s.location,navigationType:s.action,navigator:p,future:u})}const U9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,a_=fe.forwardRef(function(n,a){let{onClick:u,relative:f,reloadDocument:w,replace:p,state:s,target:L,to:F,preventScrollReset:G,unstable_viewTransition:H}=n,X=kj(n,N9),{basename:ne}=fe.useContext(__),ie,se=!1;if(typeof F=="string"&&$9.test(F)&&(ie=F,U9))try{let de=new URL(window.location.href),Ee=F.startsWith("//")?new URL(de.protocol+F):new URL(F),Ne=c0(Ee.pathname,ne);Ee.origin===de.origin&&Ne!=null?F=Ne+Ee.search+Ee.hash:se=!0}catch{}let Te=v9(F,{relative:f}),ue=q9(F,{replace:p,state:s,target:L,preventScrollReset:G,relative:f,unstable_viewTransition:H});function ce(de){u&&u(de),de.defaultPrevented||ue(de)}return fe.createElement("a",Q2({},X,{href:ie||Te,onClick:se||w?u:ce,ref:a,target:L}))}),Iu=fe.forwardRef(function(n,a){let{"aria-current":u="page",caseSensitive:f=!1,className:w="",end:p=!1,style:s,to:L,unstable_viewTransition:F,children:G}=n,H=kj(n,j9),X=VS(L,{relative:H.relative}),ne=Vp(),ie=fe.useContext(Ej),{navigator:se,basename:Te}=fe.useContext(__),ue=ie!=null&&W9(X)&&F===!0,ce=se.encodeLocation?se.encodeLocation(X).pathname:X.pathname,de=ne.pathname,Ee=ie&&ie.navigation&&ie.navigation.location?ie.navigation.location.pathname:null;f||(de=de.toLowerCase(),Ee=Ee?Ee.toLowerCase():null,ce=ce.toLowerCase()),Ee&&Te&&(Ee=c0(Ee,Te)||Ee);const Ne=ce!=="/"&&ce.endsWith("/")?ce.length-1:ce.length;let rt=de===ce||!p&&de.startsWith(ce)&&de.charAt(Ne)==="/",tt=Ee!=null&&(Ee===ce||!p&&Ee.startsWith(ce)&&Ee.charAt(ce.length)==="/"),Ge={isActive:rt,isPending:tt,isTransitioning:ue},_t=rt?u:void 0,yt;typeof w=="function"?yt=w(Ge):yt=[w,rt?"active":null,tt?"pending":null,ue?"transitioning":null].filter(Boolean).join(" ");let Et=typeof s=="function"?s(Ge):s;return fe.createElement(a_,Q2({},H,{"aria-current":_t,className:yt,ref:a,style:Et,to:L,unstable_viewTransition:F}),typeof G=="function"?G(Ge):G)});var CC;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(CC||(CC={}));var fD;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(fD||(fD={}));function G9(e){let n=fe.useContext(BS);return n||ol(!1),n}function q9(e,n){let{target:a,replace:u,state:f,preventScrollReset:w,relative:p,unstable_viewTransition:s}=n===void 0?{}:n,L=ql(),F=Vp(),G=VS(e,{relative:p});return fe.useCallback(H=>{if(z9(H,a)){H.preventDefault();let X=u!==void 0?u:K2(F)===K2(G);L(e,{replace:X,state:f,preventScrollReset:w,relative:p,unstable_viewTransition:s})}},[F,L,G,u,f,a,e,w,p,s])}function W9(e,n){n===void 0&&(n={});let a=fe.useContext(B9);a==null&&ol(!1);let{basename:u}=G9(CC.useViewTransitionState),f=VS(e,{relative:n.relative});if(!a.isTransitioning)return!1;let w=c0(a.currentLocation.pathname,u)||a.currentLocation.pathname,p=c0(a.nextLocation.pathname,u)||a.nextLocation.pathname;return EC(f.pathname,p)!=null||EC(f.pathname,w)!=null}var Rj={exports:{}},Dj={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u0=fe;function H9(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Z9=typeof Object.is=="function"?Object.is:H9,X9=u0.useState,Y9=u0.useEffect,K9=u0.useLayoutEffect,J9=u0.useDebugValue;function Q9(e,n){var a=n(),u=X9({inst:{value:a,getSnapshot:n}}),f=u[0].inst,w=u[1];return K9(function(){f.value=a,f.getSnapshot=n,rI(f)&&w({inst:f})},[e,a,n]),Y9(function(){return rI(f)&&w({inst:f}),e(function(){rI(f)&&w({inst:f})})},[e]),J9(a),a}function rI(e){var n=e.getSnapshot;e=e.value;try{var a=n();return!Z9(e,a)}catch{return!0}}function e7(e,n){return n()}var t7=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?e7:Q9;Dj.useSyncExternalStore=u0.useSyncExternalStore!==void 0?u0.useSyncExternalStore:t7;Rj.exports=Dj;var r7=Rj.exports,Oj={exports:{}},Lj={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var US=fe,n7=r7;function i7(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var o7=typeof Object.is=="function"?Object.is:i7,a7=n7.useSyncExternalStore,s7=US.useRef,l7=US.useEffect,c7=US.useMemo,u7=US.useDebugValue;Lj.useSyncExternalStoreWithSelector=function(e,n,a,u,f){var w=s7(null);if(w.current===null){var p={hasValue:!1,value:null};w.current=p}else p=w.current;w=c7(function(){function L(ne){if(!F){if(F=!0,G=ne,ne=u(ne),f!==void 0&&p.hasValue){var ie=p.value;if(f(ie,ne))return H=ie}return H=ne}if(ie=H,o7(G,ne))return ie;var se=u(ne);return f!==void 0&&f(ie,se)?ie:(G=ne,H=se)}var F=!1,G,H,X=a===void 0?null:a;return[function(){return L(n())},X===null?void 0:function(){return L(X())}]},[n,a,u,f]);var s=a7(e,w[0],w[1]);return l7(function(){p.hasValue=!0,p.value=s},[s]),u7(s),s};Oj.exports=Lj;var h7=Oj.exports;function d7(e){e()}let zj=d7;const p7=e=>zj=e,f7=()=>zj,mD=Symbol.for("react-redux-context"),gD=typeof globalThis<"u"?globalThis:{};function m7(){var e;if(!fe.createContext)return{};const n=(e=gD[mD])!=null?e:gD[mD]=new Map;let a=n.get(fe.createContext);return a||(a=fe.createContext(null),n.set(fe.createContext,a)),a}const s_=m7();function bP(e=s_){return function(){return fe.useContext(e)}}const Nj=bP(),g7=()=>{throw new Error("uSES not initialized!")};let jj=g7;const _7=e=>{jj=e},y7=(e,n)=>e===n;function v7(e=s_){const n=e===s_?Nj:bP(e);return function(u,f={}){const{equalityFn:w=y7,stabilityCheck:p=void 0,noopCheck:s=void 0}=typeof f=="function"?{equalityFn:f}:f,{store:L,subscription:F,getServerState:G,stabilityCheck:H,noopCheck:X}=n();fe.useRef(!0);const ne=fe.useCallback({[u.name](se){return u(se)}}[u.name],[u,H,p]),ie=jj(F.addNestedSub,L.getState,G||L.getState,ne,w);return fe.useDebugValue(ie),ie}}const ma=v7();function pn(){return pn=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},pn.apply(this,arguments)}function cc(e,n){if(e==null)return{};var a={},u=Object.keys(e),f,w;for(w=0;w<u.length;w++)f=u[w],!(n.indexOf(f)>=0)&&(a[f]=e[f]);return a}var Bj={exports:{}},Fa={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uc=typeof Symbol=="function"&&Symbol.for,wP=uc?Symbol.for("react.element"):60103,SP=uc?Symbol.for("react.portal"):60106,$S=uc?Symbol.for("react.fragment"):60107,GS=uc?Symbol.for("react.strict_mode"):60108,qS=uc?Symbol.for("react.profiler"):60114,WS=uc?Symbol.for("react.provider"):60109,HS=uc?Symbol.for("react.context"):60110,TP=uc?Symbol.for("react.async_mode"):60111,ZS=uc?Symbol.for("react.concurrent_mode"):60111,XS=uc?Symbol.for("react.forward_ref"):60112,YS=uc?Symbol.for("react.suspense"):60113,x7=uc?Symbol.for("react.suspense_list"):60120,KS=uc?Symbol.for("react.memo"):60115,JS=uc?Symbol.for("react.lazy"):60116,b7=uc?Symbol.for("react.block"):60121,w7=uc?Symbol.for("react.fundamental"):60117,S7=uc?Symbol.for("react.responder"):60118,T7=uc?Symbol.for("react.scope"):60119;function Jh(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case wP:switch(e=e.type,e){case TP:case ZS:case $S:case qS:case GS:case YS:return e;default:switch(e=e&&e.$$typeof,e){case HS:case XS:case JS:case KS:case WS:return e;default:return n}}case SP:return n}}}function Fj(e){return Jh(e)===ZS}Fa.AsyncMode=TP;Fa.ConcurrentMode=ZS;Fa.ContextConsumer=HS;Fa.ContextProvider=WS;Fa.Element=wP;Fa.ForwardRef=XS;Fa.Fragment=$S;Fa.Lazy=JS;Fa.Memo=KS;Fa.Portal=SP;Fa.Profiler=qS;Fa.StrictMode=GS;Fa.Suspense=YS;Fa.isAsyncMode=function(e){return Fj(e)||Jh(e)===TP};Fa.isConcurrentMode=Fj;Fa.isContextConsumer=function(e){return Jh(e)===HS};Fa.isContextProvider=function(e){return Jh(e)===WS};Fa.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===wP};Fa.isForwardRef=function(e){return Jh(e)===XS};Fa.isFragment=function(e){return Jh(e)===$S};Fa.isLazy=function(e){return Jh(e)===JS};Fa.isMemo=function(e){return Jh(e)===KS};Fa.isPortal=function(e){return Jh(e)===SP};Fa.isProfiler=function(e){return Jh(e)===qS};Fa.isStrictMode=function(e){return Jh(e)===GS};Fa.isSuspense=function(e){return Jh(e)===YS};Fa.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$S||e===ZS||e===qS||e===GS||e===YS||e===x7||typeof e=="object"&&e!==null&&(e.$$typeof===JS||e.$$typeof===KS||e.$$typeof===WS||e.$$typeof===HS||e.$$typeof===XS||e.$$typeof===w7||e.$$typeof===S7||e.$$typeof===T7||e.$$typeof===b7)};Fa.typeOf=Jh;Bj.exports=Fa;var E7=Bj.exports,Vj=E7,I7={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},C7={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Uj={};Uj[Vj.ForwardRef]=I7;Uj[Vj.Memo]=C7;var Xa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EP=Symbol.for("react.element"),IP=Symbol.for("react.portal"),QS=Symbol.for("react.fragment"),eT=Symbol.for("react.strict_mode"),tT=Symbol.for("react.profiler"),rT=Symbol.for("react.provider"),nT=Symbol.for("react.context"),A7=Symbol.for("react.server_context"),iT=Symbol.for("react.forward_ref"),oT=Symbol.for("react.suspense"),aT=Symbol.for("react.suspense_list"),sT=Symbol.for("react.memo"),lT=Symbol.for("react.lazy"),P7=Symbol.for("react.offscreen"),$j;$j=Symbol.for("react.module.reference");function ep(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case EP:switch(e=e.type,e){case QS:case tT:case eT:case oT:case aT:return e;default:switch(e=e&&e.$$typeof,e){case A7:case nT:case iT:case lT:case sT:case rT:return e;default:return n}}case IP:return n}}}Xa.ContextConsumer=nT;Xa.ContextProvider=rT;Xa.Element=EP;Xa.ForwardRef=iT;Xa.Fragment=QS;Xa.Lazy=lT;Xa.Memo=sT;Xa.Portal=IP;Xa.Profiler=tT;Xa.StrictMode=eT;Xa.Suspense=oT;Xa.SuspenseList=aT;Xa.isAsyncMode=function(){return!1};Xa.isConcurrentMode=function(){return!1};Xa.isContextConsumer=function(e){return ep(e)===nT};Xa.isContextProvider=function(e){return ep(e)===rT};Xa.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===EP};Xa.isForwardRef=function(e){return ep(e)===iT};Xa.isFragment=function(e){return ep(e)===QS};Xa.isLazy=function(e){return ep(e)===lT};Xa.isMemo=function(e){return ep(e)===sT};Xa.isPortal=function(e){return ep(e)===IP};Xa.isProfiler=function(e){return ep(e)===tT};Xa.isStrictMode=function(e){return ep(e)===eT};Xa.isSuspense=function(e){return ep(e)===oT};Xa.isSuspenseList=function(e){return ep(e)===aT};Xa.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===QS||e===tT||e===eT||e===oT||e===aT||e===P7||typeof e=="object"&&e!==null&&(e.$$typeof===lT||e.$$typeof===sT||e.$$typeof===rT||e.$$typeof===nT||e.$$typeof===iT||e.$$typeof===$j||e.getModuleId!==void 0)};Xa.typeOf=ep;function M7(){const e=f7();let n=null,a=null;return{clear(){n=null,a=null},notify(){e(()=>{let u=n;for(;u;)u.callback(),u=u.next})},get(){let u=[],f=n;for(;f;)u.push(f),f=f.next;return u},subscribe(u){let f=!0,w=a={callback:u,next:null,prev:a};return w.prev?w.prev.next=w:n=w,function(){!f||n===null||(f=!1,w.next?w.next.prev=w.prev:a=w.prev,w.prev?w.prev.next=w.next:n=w.next)}}}}const _D={notify(){},get:()=>[]};function k7(e,n){let a,u=_D,f=0,w=!1;function p(se){G();const Te=u.subscribe(se);let ue=!1;return()=>{ue||(ue=!0,Te(),H())}}function s(){u.notify()}function L(){ie.onStateChange&&ie.onStateChange()}function F(){return w}function G(){f++,a||(a=n?n.addNestedSub(L):e.subscribe(L),u=M7())}function H(){f--,a&&f===0&&(a(),a=void 0,u.clear(),u=_D)}function X(){w||(w=!0,G())}function ne(){w&&(w=!1,H())}const ie={addNestedSub:p,notifyNestedSubs:s,handleChangeWrapper:L,isSubscribed:F,trySubscribe:X,tryUnsubscribe:ne,getListeners:()=>u};return ie}const R7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",D7=R7?fe.useLayoutEffect:fe.useEffect;function O7({store:e,context:n,children:a,serverState:u,stabilityCheck:f="once",noopCheck:w="once"}){const p=fe.useMemo(()=>{const F=k7(e);return{store:e,subscription:F,getServerState:u?()=>u:void 0,stabilityCheck:f,noopCheck:w}},[e,u,f,w]),s=fe.useMemo(()=>e.getState(),[e]);D7(()=>{const{subscription:F}=p;return F.onStateChange=F.notifyNestedSubs,F.trySubscribe(),s!==e.getState()&&F.notifyNestedSubs(),()=>{F.tryUnsubscribe(),F.onStateChange=void 0}},[p,s]);const L=n||s_;return fe.createElement(L.Provider,{value:p},a)}function Gj(e=s_){const n=e===s_?Nj:bP(e);return function(){const{store:u}=n();return u}}const L7=Gj();function z7(e=s_){const n=e===s_?L7:Gj(e);return function(){return n().dispatch}}const eu=z7();_7(h7.useSyncExternalStoreWithSelector);p7(jS.unstable_batchedUpdates);function ub({children:e}){return y.jsx("div",{className:"feedBackground",children:e})}function Op(e){for(var n=arguments.length,a=Array(n>1?n-1:0),u=1;u<n;u++)a[u-1]=arguments[u];throw Error("[Immer] minified error nr: "+e+(a.length?" "+a.map(function(f){return"'"+f+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function l_(e){return!!e&&!!e[Rs]}function km(e){var n;return!!e&&(function(a){if(!a||typeof a!="object")return!1;var u=Object.getPrototypeOf(a);if(u===null)return!0;var f=Object.hasOwnProperty.call(u,"constructor")&&u.constructor;return f===Object||typeof f=="function"&&Function.toString.call(f)===q7}(e)||Array.isArray(e)||!!e[TD]||!!(!((n=e.constructor)===null||n===void 0)&&n[TD])||CP(e)||AP(e))}function by(e,n,a){a===void 0&&(a=!1),A0(e)===0?(a?Object.keys:Yv)(e).forEach(function(u){a&&typeof u=="symbol"||n(u,e[u],e)}):e.forEach(function(u,f){return n(f,u,e)})}function A0(e){var n=e[Rs];return n?n.i>3?n.i-4:n.i:Array.isArray(e)?1:CP(e)?2:AP(e)?3:0}function Xv(e,n){return A0(e)===2?e.has(n):Object.prototype.hasOwnProperty.call(e,n)}function N7(e,n){return A0(e)===2?e.get(n):e[n]}function qj(e,n,a){var u=A0(e);u===2?e.set(n,a):u===3?e.add(a):e[n]=a}function Wj(e,n){return e===n?e!==0||1/e==1/n:e!=e&&n!=n}function CP(e){return $7&&e instanceof Map}function AP(e){return G7&&e instanceof Set}function ny(e){return e.o||e.t}function PP(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var n=Zj(e);delete n[Rs];for(var a=Yv(n),u=0;u<a.length;u++){var f=a[u],w=n[f];w.writable===!1&&(w.writable=!0,w.configurable=!0),(w.get||w.set)&&(n[f]={configurable:!0,writable:!0,enumerable:w.enumerable,value:e[f]})}return Object.create(Object.getPrototypeOf(e),n)}function MP(e,n){return n===void 0&&(n=!1),kP(e)||l_(e)||!km(e)||(A0(e)>1&&(e.set=e.add=e.clear=e.delete=j7),Object.freeze(e),n&&by(e,function(a,u){return MP(u,!0)},!0)),e}function j7(){Op(2)}function kP(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function Cf(e){var n=kC[e];return n||Op(18,e),n}function B7(e,n){kC[e]||(kC[e]=n)}function AC(){return V1}function nI(e,n){n&&(Cf("Patches"),e.u=[],e.s=[],e.v=n)}function eS(e){PC(e),e.p.forEach(F7),e.p=null}function PC(e){e===V1&&(V1=e.l)}function yD(e){return V1={p:[],l:V1,h:e,m:!0,_:0}}function F7(e){var n=e[Rs];n.i===0||n.i===1?n.j():n.g=!0}function iI(e,n){n._=n.p.length;var a=n.p[0],u=e!==void 0&&e!==a;return n.h.O||Cf("ES5").S(n,e,u),u?(a[Rs].P&&(eS(n),Op(4)),km(e)&&(e=tS(n,e),n.l||rS(n,e)),n.u&&Cf("Patches").M(a[Rs].t,e,n.u,n.s)):e=tS(n,a,[]),eS(n),n.u&&n.v(n.u,n.s),e!==Hj?e:void 0}function tS(e,n,a){if(kP(n))return n;var u=n[Rs];if(!u)return by(n,function(s,L){return vD(e,u,n,s,L,a)},!0),n;if(u.A!==e)return n;if(!u.P)return rS(e,u.t,!0),u.t;if(!u.I){u.I=!0,u.A._--;var f=u.i===4||u.i===5?u.o=PP(u.k):u.o,w=f,p=!1;u.i===3&&(w=new Set(f),f.clear(),p=!0),by(w,function(s,L){return vD(e,u,f,s,L,a,p)}),rS(e,f,!1),a&&e.u&&Cf("Patches").N(u,a,e.u,e.s)}return u.o}function vD(e,n,a,u,f,w,p){if(l_(f)){var s=tS(e,f,w&&n&&n.i!==3&&!Xv(n.R,u)?w.concat(u):void 0);if(qj(a,u,s),!l_(s))return;e.m=!1}else p&&a.add(f);if(km(f)&&!kP(f)){if(!e.h.D&&e._<1)return;tS(e,f),n&&n.A.l||rS(e,f)}}function rS(e,n,a){a===void 0&&(a=!1),!e.l&&e.h.D&&e.m&&MP(n,a)}function oI(e,n){var a=e[Rs];return(a?ny(a):e)[n]}function xD(e,n){if(n in e)for(var a=Object.getPrototypeOf(e);a;){var u=Object.getOwnPropertyDescriptor(a,n);if(u)return u;a=Object.getPrototypeOf(a)}}function Ng(e){e.P||(e.P=!0,e.l&&Ng(e.l))}function aI(e){e.o||(e.o=PP(e.t))}function MC(e,n,a){var u=CP(n)?Cf("MapSet").F(n,a):AP(n)?Cf("MapSet").T(n,a):e.O?function(f,w){var p=Array.isArray(f),s={i:p?1:0,A:w?w.A:AC(),P:!1,I:!1,R:{},l:w,t:f,k:null,o:null,j:null,C:!1},L=s,F=U1;p&&(L=[s],F=i1);var G=Proxy.revocable(L,F),H=G.revoke,X=G.proxy;return s.k=X,s.j=H,X}(n,a):Cf("ES5").J(n,a);return(a?a.A:AC()).p.push(u),u}function V7(e){return l_(e)||Op(22,e),function n(a){if(!km(a))return a;var u,f=a[Rs],w=A0(a);if(f){if(!f.P&&(f.i<4||!Cf("ES5").K(f)))return f.t;f.I=!0,u=bD(a,w),f.I=!1}else u=bD(a,w);return by(u,function(p,s){f&&N7(f.t,p)===s||qj(u,p,n(s))}),w===3?new Set(u):u}(e)}function bD(e,n){switch(n){case 2:return new Map(e);case 3:return Array.from(e)}return PP(e)}function U7(){function e(w,p){var s=f[w];return s?s.enumerable=p:f[w]=s={configurable:!0,enumerable:p,get:function(){var L=this[Rs];return U1.get(L,w)},set:function(L){var F=this[Rs];U1.set(F,w,L)}},s}function n(w){for(var p=w.length-1;p>=0;p--){var s=w[p][Rs];if(!s.P)switch(s.i){case 5:u(s)&&Ng(s);break;case 4:a(s)&&Ng(s)}}}function a(w){for(var p=w.t,s=w.k,L=Yv(s),F=L.length-1;F>=0;F--){var G=L[F];if(G!==Rs){var H=p[G];if(H===void 0&&!Xv(p,G))return!0;var X=s[G],ne=X&&X[Rs];if(ne?ne.t!==H:!Wj(X,H))return!0}}var ie=!!p[Rs];return L.length!==Yv(p).length+(ie?0:1)}function u(w){var p=w.k;if(p.length!==w.t.length)return!0;var s=Object.getOwnPropertyDescriptor(p,p.length-1);if(s&&!s.get)return!0;for(var L=0;L<p.length;L++)if(!p.hasOwnProperty(L))return!0;return!1}var f={};B7("ES5",{J:function(w,p){var s=Array.isArray(w),L=function(G,H){if(G){for(var X=Array(H.length),ne=0;ne<H.length;ne++)Object.defineProperty(X,""+ne,e(ne,!0));return X}var ie=Zj(H);delete ie[Rs];for(var se=Yv(ie),Te=0;Te<se.length;Te++){var ue=se[Te];ie[ue]=e(ue,G||!!ie[ue].enumerable)}return Object.create(Object.getPrototypeOf(H),ie)}(s,w),F={i:s?5:4,A:p?p.A:AC(),P:!1,I:!1,R:{},l:p,t:w,k:L,o:null,g:!1,C:!1};return Object.defineProperty(L,Rs,{value:F,writable:!0}),L},S:function(w,p,s){s?l_(p)&&p[Rs].A===w&&n(w.p):(w.u&&function L(F){if(F&&typeof F=="object"){var G=F[Rs];if(G){var H=G.t,X=G.k,ne=G.R,ie=G.i;if(ie===4)by(X,function(de){de!==Rs&&(H[de]!==void 0||Xv(H,de)?ne[de]||L(X[de]):(ne[de]=!0,Ng(G)))}),by(H,function(de){X[de]!==void 0||Xv(X,de)||(ne[de]=!1,Ng(G))});else if(ie===5){if(u(G)&&(Ng(G),ne.length=!0),X.length<H.length)for(var se=X.length;se<H.length;se++)ne[se]=!1;else for(var Te=H.length;Te<X.length;Te++)ne[Te]=!0;for(var ue=Math.min(X.length,H.length),ce=0;ce<ue;ce++)X.hasOwnProperty(ce)||(ne[ce]=!0),ne[ce]===void 0&&L(X[ce])}}}}(w.p[0]),n(w.p))},K:function(w){return w.i===4?a(w):u(w)}})}var wD,V1,RP=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",$7=typeof Map<"u",G7=typeof Set<"u",SD=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",Hj=RP?Symbol.for("immer-nothing"):((wD={})["immer-nothing"]=!0,wD),TD=RP?Symbol.for("immer-draftable"):"__$immer_draftable",Rs=RP?Symbol.for("immer-state"):"__$immer_state",q7=""+Object.prototype.constructor,Yv=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Zj=Object.getOwnPropertyDescriptors||function(e){var n={};return Yv(e).forEach(function(a){n[a]=Object.getOwnPropertyDescriptor(e,a)}),n},kC={},U1={get:function(e,n){if(n===Rs)return e;var a=ny(e);if(!Xv(a,n))return function(f,w,p){var s,L=xD(w,p);return L?"value"in L?L.value:(s=L.get)===null||s===void 0?void 0:s.call(f.k):void 0}(e,a,n);var u=a[n];return e.I||!km(u)?u:u===oI(e.t,n)?(aI(e),e.o[n]=MC(e.A.h,u,e)):u},has:function(e,n){return n in ny(e)},ownKeys:function(e){return Reflect.ownKeys(ny(e))},set:function(e,n,a){var u=xD(ny(e),n);if(u!=null&&u.set)return u.set.call(e.k,a),!0;if(!e.P){var f=oI(ny(e),n),w=f==null?void 0:f[Rs];if(w&&w.t===a)return e.o[n]=a,e.R[n]=!1,!0;if(Wj(a,f)&&(a!==void 0||Xv(e.t,n)))return!0;aI(e),Ng(e)}return e.o[n]===a&&(a!==void 0||n in e.o)||Number.isNaN(a)&&Number.isNaN(e.o[n])||(e.o[n]=a,e.R[n]=!0),!0},deleteProperty:function(e,n){return oI(e.t,n)!==void 0||n in e.t?(e.R[n]=!1,aI(e),Ng(e)):delete e.R[n],e.o&&delete e.o[n],!0},getOwnPropertyDescriptor:function(e,n){var a=ny(e),u=Reflect.getOwnPropertyDescriptor(a,n);return u&&{writable:!0,configurable:e.i!==1||n!=="length",enumerable:u.enumerable,value:a[n]}},defineProperty:function(){Op(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Op(12)}},i1={};by(U1,function(e,n){i1[e]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}}),i1.deleteProperty=function(e,n){return i1.set.call(this,e,n,void 0)},i1.set=function(e,n,a){return U1.set.call(this,e[0],n,a,e[0])};var W7=function(){function e(a){var u=this;this.O=SD,this.D=!0,this.produce=function(f,w,p){if(typeof f=="function"&&typeof w!="function"){var s=w;w=f;var L=u;return function(se){var Te=this;se===void 0&&(se=s);for(var ue=arguments.length,ce=Array(ue>1?ue-1:0),de=1;de<ue;de++)ce[de-1]=arguments[de];return L.produce(se,function(Ee){var Ne;return(Ne=w).call.apply(Ne,[Te,Ee].concat(ce))})}}var F;if(typeof w!="function"&&Op(6),p!==void 0&&typeof p!="function"&&Op(7),km(f)){var G=yD(u),H=MC(u,f,void 0),X=!0;try{F=w(H),X=!1}finally{X?eS(G):PC(G)}return typeof Promise<"u"&&F instanceof Promise?F.then(function(se){return nI(G,p),iI(se,G)},function(se){throw eS(G),se}):(nI(G,p),iI(F,G))}if(!f||typeof f!="object"){if((F=w(f))===void 0&&(F=f),F===Hj&&(F=void 0),u.D&&MP(F,!0),p){var ne=[],ie=[];Cf("Patches").M(f,F,ne,ie),p(ne,ie)}return F}Op(21,f)},this.produceWithPatches=function(f,w){if(typeof f=="function")return function(F){for(var G=arguments.length,H=Array(G>1?G-1:0),X=1;X<G;X++)H[X-1]=arguments[X];return u.produceWithPatches(F,function(ne){return f.apply(void 0,[ne].concat(H))})};var p,s,L=u.produce(f,w,function(F,G){p=F,s=G});return typeof Promise<"u"&&L instanceof Promise?L.then(function(F){return[F,p,s]}):[L,p,s]},typeof(a==null?void 0:a.useProxies)=="boolean"&&this.setUseProxies(a.useProxies),typeof(a==null?void 0:a.autoFreeze)=="boolean"&&this.setAutoFreeze(a.autoFreeze)}var n=e.prototype;return n.createDraft=function(a){km(a)||Op(8),l_(a)&&(a=V7(a));var u=yD(this),f=MC(this,a,void 0);return f[Rs].C=!0,PC(u),f},n.finishDraft=function(a,u){var f=a&&a[Rs],w=f.A;return nI(w,u),iI(void 0,w)},n.setAutoFreeze=function(a){this.D=a},n.setUseProxies=function(a){a&&!SD&&Op(20),this.O=a},n.applyPatches=function(a,u){var f;for(f=u.length-1;f>=0;f--){var w=u[f];if(w.path.length===0&&w.op==="replace"){a=w.value;break}}f>-1&&(u=u.slice(f+1));var p=Cf("Patches").$;return l_(a)?p(a,u):this.produce(a,function(s){return p(s,u)})},e}(),Zh=new W7,Xj=Zh.produce;Zh.produceWithPatches.bind(Zh);Zh.setAutoFreeze.bind(Zh);Zh.setUseProxies.bind(Zh);Zh.applyPatches.bind(Zh);Zh.createDraft.bind(Zh);Zh.finishDraft.bind(Zh);function c_(e){"@babel/helpers - typeof";return c_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},c_(e)}function H7(e,n){if(c_(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var u=a.call(e,n||"default");if(c_(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Yj(e){var n=H7(e,"string");return c_(n)=="symbol"?n:String(n)}function pr(e,n,a){return n=Yj(n),n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function ED(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function ID(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?ED(Object(a),!0).forEach(function(u){pr(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ED(Object(a)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function Kc(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var CD=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),sI=function(){return Math.random().toString(36).substring(7).split("").join(".")},nS={INIT:"@@redux/INIT"+sI(),REPLACE:"@@redux/REPLACE"+sI(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+sI()}};function Z7(e){if(typeof e!="object"||e===null)return!1;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function DP(e,n,a){var u;if(typeof n=="function"&&typeof a=="function"||typeof a=="function"&&typeof arguments[3]=="function")throw new Error(Kc(0));if(typeof n=="function"&&typeof a>"u"&&(a=n,n=void 0),typeof a<"u"){if(typeof a!="function")throw new Error(Kc(1));return a(DP)(e,n)}if(typeof e!="function")throw new Error(Kc(2));var f=e,w=n,p=[],s=p,L=!1;function F(){s===p&&(s=p.slice())}function G(){if(L)throw new Error(Kc(3));return w}function H(se){if(typeof se!="function")throw new Error(Kc(4));if(L)throw new Error(Kc(5));var Te=!0;return F(),s.push(se),function(){if(Te){if(L)throw new Error(Kc(6));Te=!1,F();var ce=s.indexOf(se);s.splice(ce,1),p=null}}}function X(se){if(!Z7(se))throw new Error(Kc(7));if(typeof se.type>"u")throw new Error(Kc(8));if(L)throw new Error(Kc(9));try{L=!0,w=f(w,se)}finally{L=!1}for(var Te=p=s,ue=0;ue<Te.length;ue++){var ce=Te[ue];ce()}return se}function ne(se){if(typeof se!="function")throw new Error(Kc(10));f=se,X({type:nS.REPLACE})}function ie(){var se,Te=H;return se={subscribe:function(ce){if(typeof ce!="object"||ce===null)throw new Error(Kc(11));function de(){ce.next&&ce.next(G())}de();var Ee=Te(de);return{unsubscribe:Ee}}},se[CD]=function(){return this},se}return X({type:nS.INIT}),u={dispatch:X,subscribe:H,getState:G,replaceReducer:ne},u[CD]=ie,u}function X7(e){Object.keys(e).forEach(function(n){var a=e[n],u=a(void 0,{type:nS.INIT});if(typeof u>"u")throw new Error(Kc(12));if(typeof a(void 0,{type:nS.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Kc(13))})}function Kj(e){for(var n=Object.keys(e),a={},u=0;u<n.length;u++){var f=n[u];typeof e[f]=="function"&&(a[f]=e[f])}var w=Object.keys(a),p;try{X7(a)}catch(s){p=s}return function(L,F){if(L===void 0&&(L={}),p)throw p;for(var G=!1,H={},X=0;X<w.length;X++){var ne=w[X],ie=a[ne],se=L[ne],Te=ie(se,F);if(typeof Te>"u")throw F&&F.type,new Error(Kc(14));H[ne]=Te,G=G||Te!==se}return G=G||w.length!==Object.keys(L).length,G?H:L}}function iS(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return n.length===0?function(u){return u}:n.length===1?n[0]:n.reduce(function(u,f){return function(){return u(f.apply(void 0,arguments))}})}function Y7(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return function(u){return function(){var f=u.apply(void 0,arguments),w=function(){throw new Error(Kc(15))},p={getState:f.getState,dispatch:function(){return w.apply(void 0,arguments)}},s=n.map(function(L){return L(p)});return w=iS.apply(void 0,s)(f.dispatch),ID(ID({},f),{},{dispatch:w})}}}function Jj(e){var n=function(u){var f=u.dispatch,w=u.getState;return function(p){return function(s){return typeof s=="function"?s(f,w,e):p(s)}}};return n}var Qj=Jj();Qj.withExtraArgument=Jj;const AD=Qj;var e5=globalThis&&globalThis.__extends||function(){var e=function(n,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var w in f)Object.prototype.hasOwnProperty.call(f,w)&&(u[w]=f[w])},e(n,a)};return function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");e(n,a);function u(){this.constructor=n}n.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}}(),K7=globalThis&&globalThis.__generator||function(e,n){var a={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},u,f,w,p;return p={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function s(F){return function(G){return L([F,G])}}function L(F){if(u)throw new TypeError("Generator is already executing.");for(;a;)try{if(u=1,f&&(w=F[0]&2?f.return:F[0]?f.throw||((w=f.return)&&w.call(f),0):f.next)&&!(w=w.call(f,F[1])).done)return w;switch(f=0,w&&(F=[F[0]&2,w.value]),F[0]){case 0:case 1:w=F;break;case 4:return a.label++,{value:F[1],done:!1};case 5:a.label++,f=F[1],F=[0];continue;case 7:F=a.ops.pop(),a.trys.pop();continue;default:if(w=a.trys,!(w=w.length>0&&w[w.length-1])&&(F[0]===6||F[0]===2)){a=0;continue}if(F[0]===3&&(!w||F[1]>w[0]&&F[1]<w[3])){a.label=F[1];break}if(F[0]===6&&a.label<w[1]){a.label=w[1],w=F;break}if(w&&a.label<w[2]){a.label=w[2],a.ops.push(F);break}w[2]&&a.ops.pop(),a.trys.pop();continue}F=n.call(e,a)}catch(G){F=[6,G],f=0}finally{u=w=0}if(F[0]&5)throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}},h0=globalThis&&globalThis.__spreadArray||function(e,n){for(var a=0,u=n.length,f=e.length;a<u;a++,f++)e[f]=n[a];return e},J7=Object.defineProperty,Q7=Object.defineProperties,e$=Object.getOwnPropertyDescriptors,PD=Object.getOwnPropertySymbols,t$=Object.prototype.hasOwnProperty,r$=Object.prototype.propertyIsEnumerable,MD=function(e,n,a){return n in e?J7(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a},e_=function(e,n){for(var a in n||(n={}))t$.call(n,a)&&MD(e,a,n[a]);if(PD)for(var u=0,f=PD(n);u<f.length;u++){var a=f[u];r$.call(n,a)&&MD(e,a,n[a])}return e},lI=function(e,n){return Q7(e,e$(n))},n$=function(e,n,a){return new Promise(function(u,f){var w=function(L){try{s(a.next(L))}catch(F){f(F)}},p=function(L){try{s(a.throw(L))}catch(F){f(F)}},s=function(L){return L.done?u(L.value):Promise.resolve(L.value).then(w,p)};s((a=a.apply(e,n)).next())})},i$=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?iS:iS.apply(null,arguments)};function o$(e){if(typeof e!="object"||e===null)return!1;var n=Object.getPrototypeOf(e);if(n===null)return!0;for(var a=n;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return n===a}function t_(e,n){function a(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];if(n){var w=n.apply(void 0,u);if(!w)throw new Error("prepareAction did not return an object");return e_(e_({type:e,payload:w.payload},"meta"in w&&{meta:w.meta}),"error"in w&&{error:w.error})}return{type:e,payload:u[0]}}return a.toString=function(){return""+e},a.type=e,a.match=function(u){return u.type===e},a}var a$=function(e){e5(n,e);function n(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];var f=e.apply(this,a)||this;return Object.setPrototypeOf(f,n.prototype),f}return Object.defineProperty(n,Symbol.species,{get:function(){return n},enumerable:!1,configurable:!0}),n.prototype.concat=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return e.prototype.concat.apply(this,a)},n.prototype.prepend=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return a.length===1&&Array.isArray(a[0])?new(n.bind.apply(n,h0([void 0],a[0].concat(this)))):new(n.bind.apply(n,h0([void 0],a.concat(this))))},n}(Array),s$=function(e){e5(n,e);function n(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];var f=e.apply(this,a)||this;return Object.setPrototypeOf(f,n.prototype),f}return Object.defineProperty(n,Symbol.species,{get:function(){return n},enumerable:!1,configurable:!0}),n.prototype.concat=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return e.prototype.concat.apply(this,a)},n.prototype.prepend=function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return a.length===1&&Array.isArray(a[0])?new(n.bind.apply(n,h0([void 0],a[0].concat(this)))):new(n.bind.apply(n,h0([void 0],a.concat(this))))},n}(Array);function RC(e){return km(e)?Xj(e,function(){}):e}function l$(e){return typeof e=="boolean"}function c$(){return function(n){return u$(n)}}function u$(e){e===void 0&&(e={});var n=e.thunk,a=n===void 0?!0:n;e.immutableCheck,e.serializableCheck,e.actionCreatorCheck;var u=new a$;return a&&(l$(a)?u.push(AD):u.push(AD.withExtraArgument(a.extraArgument))),u}var h$=!0;function d$(e){var n=c$(),a=e||{},u=a.reducer,f=u===void 0?void 0:u,w=a.middleware,p=w===void 0?n():w,s=a.devTools,L=s===void 0?!0:s,F=a.preloadedState,G=F===void 0?void 0:F,H=a.enhancers,X=H===void 0?void 0:H,ne;if(typeof f=="function")ne=f;else if(o$(f))ne=Kj(f);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var ie=p;typeof ie=="function"&&(ie=ie(n));var se=Y7.apply(void 0,ie),Te=iS;L&&(Te=i$(e_({trace:!h$},typeof L=="object"&&L)));var ue=new s$(se),ce=ue;Array.isArray(X)?ce=h0([se],X):typeof X=="function"&&(ce=X(ue));var de=Te.apply(void 0,ce);return DP(ne,G,de)}function t5(e){var n={},a=[],u,f={addCase:function(w,p){var s=typeof w=="string"?w:w.type;if(!s)throw new Error("`builder.addCase` cannot be called with an empty action type");if(s in n)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return n[s]=p,f},addMatcher:function(w,p){return a.push({matcher:w,reducer:p}),f},addDefaultCase:function(w){return u=w,f}};return e(f),[n,a,u]}function p$(e){return typeof e=="function"}function f$(e,n,a,u){a===void 0&&(a=[]);var f=typeof n=="function"?t5(n):[n,a,u],w=f[0],p=f[1],s=f[2],L;if(p$(e))L=function(){return RC(e())};else{var F=RC(e);L=function(){return F}}function G(H,X){H===void 0&&(H=L());var ne=h0([w[X.type]],p.filter(function(ie){var se=ie.matcher;return se(X)}).map(function(ie){var se=ie.reducer;return se}));return ne.filter(function(ie){return!!ie}).length===0&&(ne=[s]),ne.reduce(function(ie,se){if(se)if(l_(ie)){var Te=ie,ue=se(Te,X);return ue===void 0?ie:ue}else{if(km(ie))return Xj(ie,function(ce){return se(ce,X)});var ue=se(ie,X);if(ue===void 0){if(ie===null)return ie;throw Error("A case reducer on a non-draftable value must not return undefined")}return ue}return ie},H)}return G.getInitialState=L,G}function m$(e,n){return e+"/"+n}function OP(e){var n=e.name;if(!n)throw new Error("`name` is a required option for createSlice");typeof process<"u";var a=typeof e.initialState=="function"?e.initialState:RC(e.initialState),u=e.reducers||{},f=Object.keys(u),w={},p={},s={};f.forEach(function(G){var H=u[G],X=m$(n,G),ne,ie;"reducer"in H?(ne=H.reducer,ie=H.prepare):ne=H,w[G]=ne,p[X]=ne,s[G]=ie?t_(X,ie):t_(X)});function L(){var G=typeof e.extraReducers=="function"?t5(e.extraReducers):[e.extraReducers],H=G[0],X=H===void 0?{}:H,ne=G[1],ie=ne===void 0?[]:ne,se=G[2],Te=se===void 0?void 0:se,ue=e_(e_({},X),p);return f$(a,function(ce){for(var de in ue)ce.addCase(de,ue[de]);for(var Ee=0,Ne=ie;Ee<Ne.length;Ee++){var rt=Ne[Ee];ce.addMatcher(rt.matcher,rt.reducer)}Te&&ce.addDefaultCase(Te)})}var F;return{name:n,reducer:function(G,H){return F||(F=L()),F(G,H)},actions:s,caseReducers:w,getInitialState:function(){return F||(F=L()),F.getInitialState()}}}var g$="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_$=function(e){e===void 0&&(e=21);for(var n="",a=e;a--;)n+=g$[Math.random()*64|0];return n},y$=["name","message","stack","code"],cI=function(){function e(n,a){this.payload=n,this.meta=a}return e}(),kD=function(){function e(n,a){this.payload=n,this.meta=a}return e}(),v$=function(e){if(typeof e=="object"&&e!==null){for(var n={},a=0,u=y$;a<u.length;a++){var f=u[a];typeof e[f]=="string"&&(n[f]=e[f])}return n}return{message:String(e)}};(function(){function e(n,a,u){var f=t_(n+"/fulfilled",function(F,G,H,X){return{payload:F,meta:lI(e_({},X||{}),{arg:H,requestId:G,requestStatus:"fulfilled"})}}),w=t_(n+"/pending",function(F,G,H){return{payload:void 0,meta:lI(e_({},H||{}),{arg:G,requestId:F,requestStatus:"pending"})}}),p=t_(n+"/rejected",function(F,G,H,X,ne){return{payload:X,error:(u&&u.serializeError||v$)(F||"Rejected"),meta:lI(e_({},ne||{}),{arg:H,requestId:G,rejectedWithValue:!!X,requestStatus:"rejected",aborted:(F==null?void 0:F.name)==="AbortError",condition:(F==null?void 0:F.name)==="ConditionError"})}}),s=typeof AbortController<"u"?AbortController:function(){function F(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return F.prototype.abort=function(){},F}();function L(F){return function(G,H,X){var ne=u!=null&&u.idGenerator?u.idGenerator(F):_$(),ie=new s,se;function Te(ce){se=ce,ie.abort()}var ue=function(){return n$(this,null,function(){var ce,de,Ee,Ne,rt,tt,Ge;return K7(this,function(_t){switch(_t.label){case 0:return _t.trys.push([0,4,,5]),Ne=(ce=u==null?void 0:u.condition)==null?void 0:ce.call(u,F,{getState:H,extra:X}),b$(Ne)?[4,Ne]:[3,2];case 1:Ne=_t.sent(),_t.label=2;case 2:if(Ne===!1||ie.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return rt=new Promise(function(yt,Et){return ie.signal.addEventListener("abort",function(){return Et({name:"AbortError",message:se||"Aborted"})})}),G(w(ne,F,(de=u==null?void 0:u.getPendingMeta)==null?void 0:de.call(u,{requestId:ne,arg:F},{getState:H,extra:X}))),[4,Promise.race([rt,Promise.resolve(a(F,{dispatch:G,getState:H,extra:X,requestId:ne,signal:ie.signal,abort:Te,rejectWithValue:function(yt,Et){return new cI(yt,Et)},fulfillWithValue:function(yt,Et){return new kD(yt,Et)}})).then(function(yt){if(yt instanceof cI)throw yt;return yt instanceof kD?f(yt.payload,ne,F,yt.meta):f(yt,ne,F)})])];case 3:return Ee=_t.sent(),[3,5];case 4:return tt=_t.sent(),Ee=tt instanceof cI?p(null,ne,F,tt.payload,tt.meta):p(tt,ne,F),[3,5];case 5:return Ge=u&&!u.dispatchConditionRejection&&p.match(Ee)&&Ee.meta.condition,Ge||G(Ee),[2,Ee]}})})}();return Object.assign(ue,{abort:Te,requestId:ne,arg:F,unwrap:function(){return ue.then(x$)}})}}return Object.assign(L,{pending:w,rejected:p,fulfilled:f,typePrefix:n})}return e.withTypes=function(){return e},e})();function x$(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function b$(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var LP="listenerMiddleware";t_(LP+"/add");t_(LP+"/removeAll");t_(LP+"/remove");var RD;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);U7();var zP="persist:",NP="persist/FLUSH",cT="persist/REHYDRATE",jP="persist/PAUSE",BP="persist/PERSIST",P0="persist/PURGE",FP="persist/REGISTER",w$=-1;function l2(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?l2=function(a){return typeof a}:l2=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},l2(e)}function DD(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function S$(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?DD(a,!0).forEach(function(u){T$(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):DD(a).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function T$(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function E$(e,n,a,u){u.debug;var f=S$({},a);return e&&l2(e)==="object"&&Object.keys(e).forEach(function(w){w!=="_persist"&&n[w]===a[w]&&(f[w]=e[w])}),f}function I$(e){var n=e.blacklist||null,a=e.whitelist||null,u=e.transforms||[],f=e.throttle||0,w="".concat(e.keyPrefix!==void 0?e.keyPrefix:zP).concat(e.key),p=e.storage,s;e.serialize===!1?s=function(Ne){return Ne}:typeof e.serialize=="function"?s=e.serialize:s=C$;var L=e.writeFailHandler||null,F={},G={},H=[],X=null,ne=null,ie=function(Ne){Object.keys(Ne).forEach(function(rt){ue(rt)&&F[rt]!==Ne[rt]&&H.indexOf(rt)===-1&&H.push(rt)}),Object.keys(F).forEach(function(rt){Ne[rt]===void 0&&ue(rt)&&H.indexOf(rt)===-1&&F[rt]!==void 0&&H.push(rt)}),X===null&&(X=setInterval(se,f)),F=Ne};function se(){if(H.length===0){X&&clearInterval(X),X=null;return}var Ee=H.shift(),Ne=u.reduce(function(rt,tt){return tt.in(rt,Ee,F)},F[Ee]);if(Ne!==void 0)try{G[Ee]=s(Ne)}catch(rt){console.error("redux-persist/createPersistoid: error serializing state",rt)}else delete G[Ee];H.length===0&&Te()}function Te(){Object.keys(G).forEach(function(Ee){F[Ee]===void 0&&delete G[Ee]}),ne=p.setItem(w,s(G)).catch(ce)}function ue(Ee){return!(a&&a.indexOf(Ee)===-1&&Ee!=="_persist"||n&&n.indexOf(Ee)!==-1)}function ce(Ee){L&&L(Ee)}var de=function(){for(;H.length!==0;)se();return ne||Promise.resolve()};return{update:ie,flush:de}}function C$(e){return JSON.stringify(e)}function A$(e){var n=e.transforms||[],a="".concat(e.keyPrefix!==void 0?e.keyPrefix:zP).concat(e.key),u=e.storage;e.debug;var f;return e.deserialize===!1?f=function(p){return p}:typeof e.deserialize=="function"?f=e.deserialize:f=P$,u.getItem(a).then(function(w){if(w)try{var p={},s=f(w);return Object.keys(s).forEach(function(L){p[L]=n.reduceRight(function(F,G){return G.out(F,L,s)},f(s[L]))}),p}catch(L){throw L}else return})}function P$(e){return JSON.parse(e)}function M$(e){var n=e.storage,a="".concat(e.keyPrefix!==void 0?e.keyPrefix:zP).concat(e.key);return n.removeItem(a,k$)}function k$(e){}function OD(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function vm(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?OD(a,!0).forEach(function(u){R$(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):OD(a).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function R$(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function D$(e,n){if(e==null)return{};var a=O$(e,n),u,f;if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(e);for(f=0;f<w.length;f++)u=w[f],!(n.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(e,u)&&(a[u]=e[u])}return a}function O$(e,n){if(e==null)return{};var a={},u=Object.keys(e),f,w;for(w=0;w<u.length;w++)f=u[w],!(n.indexOf(f)>=0)&&(a[f]=e[f]);return a}var L$=5e3;function z$(e,n){var a=e.version!==void 0?e.version:w$;e.debug;var u=e.stateReconciler===void 0?E$:e.stateReconciler,f=e.getStoredState||A$,w=e.timeout!==void 0?e.timeout:L$,p=null,s=!1,L=!0,F=function(H){return H._persist.rehydrated&&p&&!L&&p.update(H),H};return function(G,H){var X=G||{},ne=X._persist,ie=D$(X,["_persist"]),se=ie;if(H.type===BP){var Te=!1,ue=function(Ge,_t){Te||(H.rehydrate(e.key,Ge,_t),Te=!0)};if(w&&setTimeout(function(){!Te&&ue(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(e.key,'"')))},w),L=!1,p||(p=I$(e)),ne)return vm({},n(se,H),{_persist:ne});if(typeof H.rehydrate!="function"||typeof H.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return H.register(e.key),f(e).then(function(tt){var Ge=e.migrate||function(_t,yt){return Promise.resolve(_t)};Ge(tt,a).then(function(_t){ue(_t)},function(_t){ue(void 0,_t)})},function(tt){ue(void 0,tt)}),vm({},n(se,H),{_persist:{version:a,rehydrated:!1}})}else{if(H.type===P0)return s=!0,H.result(M$(e)),vm({},n(se,H),{_persist:ne});if(H.type===NP)return H.result(p&&p.flush()),vm({},n(se,H),{_persist:ne});if(H.type===jP)L=!0;else if(H.type===cT){if(s)return vm({},se,{_persist:vm({},ne,{rehydrated:!0})});if(H.key===e.key){var ce=n(se,H),de=H.payload,Ee=u!==!1&&de!==void 0?u(de,G,ce,e):ce,Ne=vm({},Ee,{_persist:vm({},ne,{rehydrated:!0})});return F(Ne)}}}if(!ne)return n(G,H);var rt=n(se,H);return rt===se?G:F(vm({},rt,{_persist:ne}))}}function LD(e){return B$(e)||j$(e)||N$()}function N$(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function j$(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function B$(e){if(Array.isArray(e)){for(var n=0,a=new Array(e.length);n<e.length;n++)a[n]=e[n];return a}}function zD(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function DC(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?zD(a,!0).forEach(function(u){F$(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zD(a).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function F$(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}var r5={registry:[],bootstrapped:!1},V$=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r5,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case FP:return DC({},n,{registry:[].concat(LD(n.registry),[a.key])});case cT:var u=n.registry.indexOf(a.key),f=LD(n.registry);return f.splice(u,1),DC({},n,{registry:f,bootstrapped:f.length===0});default:return n}};function U$(e,n,a){var u=a||!1,f=DP(V$,r5,n&&n.enhancer?n.enhancer:void 0),w=function(F){f.dispatch({type:FP,key:F})},p=function(F,G,H){var X={type:cT,payload:G,err:H,key:F};e.dispatch(X),f.dispatch(X),u&&s.getState().bootstrapped&&(u(),u=!1)},s=DC({},f,{purge:function(){var F=[];return e.dispatch({type:P0,result:function(H){F.push(H)}}),Promise.all(F)},flush:function(){var F=[];return e.dispatch({type:NP,result:function(H){F.push(H)}}),Promise.all(F)},pause:function(){e.dispatch({type:jP})},persist:function(){e.dispatch({type:BP,register:w,rehydrate:p})}});return n&&n.manualPersist||s.persist(),s}const ND={theme:"system",officeData:{active:!1,type:"current",data:[],listArray:[],startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),endDate:new Date().toISOString().slice(0,10),searchQuery:null,searchResult:[],searchData:[],sort:"",scroll:0}},n5=OP({name:"app",initialState:ND,reducers:{setTheme:(e,n)=>{e.theme=n.payload},setOfficeData:(e,n)=>{e.officeData=n.payload},resetOfficeData:e=>{e.officeData={active:!1,type:"current",data:[],listArray:[],startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10),endDate:new Date().toISOString().slice(0,10),searchQuery:null,searchResult:[],searchData:[],sort:"",scroll:0}}},extraReducers:e=>{e.addCase(P0,n=>ND)}}),{setTheme:uI,setOfficeData:i5,resetOfficeData:r_}=n5.actions,$$=n5.reducer;function OC({count:e=!1,priText:n=!1,secText:a=!1,route:u,data:f}){const w=ql(),p=eu();return y.jsxs("div",{className:"feedCard",onClick:()=>{p(r_()),w(u,{state:f})},children:[e&&y.jsx("span",{className:"feedCardBadge",children:e}),y.jsxs("div",{className:"feedCardWrapper",children:[n&&y.jsx("span",{className:"feedCardText",children:n}),a&&y.jsxs("span",{className:"feedCardOffice",children:["(",a,")"]})]})]})}function jg(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function o5(e){if(!jg(e))return e;const n={};return Object.keys(e).forEach(a=>{n[a]=o5(e[a])}),n}function Bp(e,n,a={clone:!0}){const u=a.clone?pn({},e):e;return jg(e)&&jg(n)&&Object.keys(n).forEach(f=>{f!=="__proto__"&&(jg(n[f])&&f in e&&jg(e[f])?u[f]=Bp(e[f],n[f],a):a.clone?u[f]=jg(n[f])?o5(n[f]):n[f]:u[f]=n[f])}),u}var a5={exports:{}},G$="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",q$=G$,W$=q$;function s5(){}function l5(){}l5.resetWarningCache=s5;var H$=function(){function e(u,f,w,p,s,L){if(L!==W$){var F=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw F.name="Invariant Violation",F}}e.isRequired=e;function n(){return e}var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:l5,resetWarningCache:s5};return a.PropTypes=a,a};a5.exports=H$();var Z$=a5.exports;const Or=S0(Z$);function d0(e){let n="https://mui.com/production-error/?code="+e;for(let a=1;a<arguments.length;a+=1)n+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+e+"; visit "+n+" for the full message."}function il(e){if(typeof e!="string")throw new Error(d0(7));return e.charAt(0).toUpperCase()+e.slice(1)}function m1(e){return e&&e.ownerDocument||document}function LC(e,n){typeof e=="function"?e(n):e&&(e.current=n)}const X$=typeof window<"u"?fe.useLayoutEffect:fe.useEffect,wy=X$;let jD=0;function Y$(e){const[n,a]=fe.useState(e),u=e||n;return fe.useEffect(()=>{n==null&&(jD+=1,a(`mui-${jD}`))},[n]),u}const BD=I2["useId".toString()];function VP(e){if(BD!==void 0){const n=BD();return e??n}return Y$(e)}function K$(e){const n=fe.useRef(e);return wy(()=>{n.current=e}),fe.useRef((...a)=>(0,n.current)(...a)).current}function kf(...e){return fe.useMemo(()=>e.every(n=>n==null)?null:n=>{e.forEach(a=>{LC(a,n)})},e)}let uT=!0,zC=!1,FD;const J$={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Q$(e){const{type:n,tagName:a}=e;return!!(a==="INPUT"&&J$[n]&&!e.readOnly||a==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function eG(e){e.metaKey||e.altKey||e.ctrlKey||(uT=!0)}function hI(){uT=!1}function tG(){this.visibilityState==="hidden"&&zC&&(uT=!0)}function rG(e){e.addEventListener("keydown",eG,!0),e.addEventListener("mousedown",hI,!0),e.addEventListener("pointerdown",hI,!0),e.addEventListener("touchstart",hI,!0),e.addEventListener("visibilitychange",tG,!0)}function nG(e){const{target:n}=e;try{return n.matches(":focus-visible")}catch{}return uT||Q$(n)}function iG(){const e=fe.useCallback(f=>{f!=null&&rG(f.ownerDocument)},[]),n=fe.useRef(!1);function a(){return n.current?(zC=!0,window.clearTimeout(FD),FD=window.setTimeout(()=>{zC=!1},100),n.current=!1,!0):!1}function u(f){return nG(f)?(n.current=!0,!0):!1}return{isFocusVisibleRef:n,onFocus:u,onBlur:a,ref:e}}function c5(e,n){const a=pn({},n);return Object.keys(e).forEach(u=>{if(u.toString().match(/^(components|slots)$/))a[u]=pn({},e[u],a[u]);else if(u.toString().match(/^(componentsProps|slotProps)$/)){const f=e[u]||{},w=n[u];a[u]={},!w||!Object.keys(w)?a[u]=f:!f||!Object.keys(f)?a[u]=w:(a[u]=pn({},w),Object.keys(f).forEach(p=>{a[u][p]=c5(f[p],w[p])}))}else a[u]===void 0&&(a[u]=e[u])}),a}function Py(e,n,a=void 0){const u={};return Object.keys(e).forEach(f=>{u[f]=e[f].reduce((w,p)=>{if(p){const s=n(p);s!==""&&w.push(s),a&&a[p]&&w.push(a[p])}return w},[]).join(" ")}),u}const VD=e=>e,oG=()=>{let e=VD;return{configure(n){e=n},generate(n){return e(n)},reset(){e=VD}}},aG=oG(),sG=aG,u5={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function hT(e,n,a="Mui"){const u=u5[n];return u?`${a}-${u}`:`${sG.generate(e)}-${n}`}function UP(e,n,a="Mui"){const u={};return n.forEach(f=>{u[f]=hT(e,f,a)}),u}function lG(e,n=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(n,Math.min(e,a))}function h5(e){var n,a,u="";if(typeof e=="string"||typeof e=="number")u+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(n=0;n<f;n++)e[n]&&(a=h5(e[n]))&&(u&&(u+=" "),u+=a)}else for(a in e)e[a]&&(u&&(u+=" "),u+=a);return u}function $1(){for(var e,n,a=0,u="",f=arguments.length;a<f;a++)(e=arguments[a])&&(n=h5(e))&&(u&&(u+=" "),u+=n);return u}function d5(e){var n=Object.create(null);return function(a){return n[a]===void 0&&(n[a]=e(a)),n[a]}}var cG=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,uG=d5(function(e){return cG.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91});function hG(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function dG(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var pG=function(){function e(a){var u=this;this._insertTag=function(f){var w;u.tags.length===0?u.insertionPoint?w=u.insertionPoint.nextSibling:u.prepend?w=u.container.firstChild:w=u.before:w=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(f,w),u.tags.push(f)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(u){u.forEach(this._insertTag)},n.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(dG(this));var f=this.tags[this.tags.length-1];if(this.isSpeedy){var w=hG(f);try{w.insertRule(u,w.cssRules.length)}catch{}}else f.appendChild(document.createTextNode(u));this.ctr++},n.flush=function(){this.tags.forEach(function(u){return u.parentNode&&u.parentNode.removeChild(u)}),this.tags=[],this.ctr=0},e}(),Yc="-ms-",oS="-moz-",Ta="-webkit-",p5="comm",$P="rule",GP="decl",fG="@import",f5="@keyframes",mG="@layer",gG=Math.abs,dT=String.fromCharCode,_G=Object.assign;function yG(e,n){return Ic(e,0)^45?(((n<<2^Ic(e,0))<<2^Ic(e,1))<<2^Ic(e,2))<<2^Ic(e,3):0}function m5(e){return e.trim()}function vG(e,n){return(e=n.exec(e))?e[0]:e}function Ea(e,n,a){return e.replace(n,a)}function NC(e,n){return e.indexOf(n)}function Ic(e,n){return e.charCodeAt(n)|0}function G1(e,n,a){return e.slice(n,a)}function xf(e){return e.length}function qP(e){return e.length}function Bw(e,n){return n.push(e),e}function xG(e,n){return e.map(n).join("")}var pT=1,p0=1,g5=0,yh=0,Al=0,M0="";function fT(e,n,a,u,f,w,p){return{value:e,root:n,parent:a,type:u,props:f,children:w,line:pT,column:p0,length:p,return:""}}function Vx(e,n){return _G(fT("",null,null,"",null,null,0),e,{length:-e.length},n)}function bG(){return Al}function wG(){return Al=yh>0?Ic(M0,--yh):0,p0--,Al===10&&(p0=1,pT--),Al}function Wh(){return Al=yh<g5?Ic(M0,yh++):0,p0++,Al===10&&(p0=1,pT++),Al}function Af(){return Ic(M0,yh)}function c2(){return yh}function hb(e,n){return G1(M0,e,n)}function q1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function _5(e){return pT=p0=1,g5=xf(M0=e),yh=0,[]}function y5(e){return M0="",e}function u2(e){return m5(hb(yh-1,jC(e===91?e+2:e===40?e+1:e)))}function SG(e){for(;(Al=Af())&&Al<33;)Wh();return q1(e)>2||q1(Al)>3?"":" "}function TG(e,n){for(;--n&&Wh()&&!(Al<48||Al>102||Al>57&&Al<65||Al>70&&Al<97););return hb(e,c2()+(n<6&&Af()==32&&Wh()==32))}function jC(e){for(;Wh();)switch(Al){case e:return yh;case 34:case 39:e!==34&&e!==39&&jC(Al);break;case 40:e===41&&jC(e);break;case 92:Wh();break}return yh}function EG(e,n){for(;Wh()&&e+Al!==47+10;)if(e+Al===42+42&&Af()===47)break;return"/*"+hb(n,yh-1)+"*"+dT(e===47?e:Wh())}function IG(e){for(;!q1(Af());)Wh();return hb(e,yh)}function CG(e){return y5(h2("",null,null,null,[""],e=_5(e),0,[0],e))}function h2(e,n,a,u,f,w,p,s,L){for(var F=0,G=0,H=p,X=0,ne=0,ie=0,se=1,Te=1,ue=1,ce=0,de="",Ee=f,Ne=w,rt=u,tt=de;Te;)switch(ie=ce,ce=Wh()){case 40:if(ie!=108&&Ic(tt,H-1)==58){NC(tt+=Ea(u2(ce),"&","&\f"),"&\f")!=-1&&(ue=-1);break}case 34:case 39:case 91:tt+=u2(ce);break;case 9:case 10:case 13:case 32:tt+=SG(ie);break;case 92:tt+=TG(c2()-1,7);continue;case 47:switch(Af()){case 42:case 47:Bw(AG(EG(Wh(),c2()),n,a),L);break;default:tt+="/"}break;case 123*se:s[F++]=xf(tt)*ue;case 125*se:case 59:case 0:switch(ce){case 0:case 125:Te=0;case 59+G:ue==-1&&(tt=Ea(tt,/\f/g,"")),ne>0&&xf(tt)-H&&Bw(ne>32?$D(tt+";",u,a,H-1):$D(Ea(tt," ","")+";",u,a,H-2),L);break;case 59:tt+=";";default:if(Bw(rt=UD(tt,n,a,F,G,f,s,de,Ee=[],Ne=[],H),w),ce===123)if(G===0)h2(tt,n,rt,rt,Ee,w,H,s,Ne);else switch(X===99&&Ic(tt,3)===110?100:X){case 100:case 108:case 109:case 115:h2(e,rt,rt,u&&Bw(UD(e,rt,rt,0,0,f,s,de,f,Ee=[],H),Ne),f,Ne,H,s,u?Ee:Ne);break;default:h2(tt,rt,rt,rt,[""],Ne,0,s,Ne)}}F=G=ne=0,se=ue=1,de=tt="",H=p;break;case 58:H=1+xf(tt),ne=ie;default:if(se<1){if(ce==123)--se;else if(ce==125&&se++==0&&wG()==125)continue}switch(tt+=dT(ce),ce*se){case 38:ue=G>0?1:(tt+="\f",-1);break;case 44:s[F++]=(xf(tt)-1)*ue,ue=1;break;case 64:Af()===45&&(tt+=u2(Wh())),X=Af(),G=H=xf(de=tt+=IG(c2())),ce++;break;case 45:ie===45&&xf(tt)==2&&(se=0)}}return w}function UD(e,n,a,u,f,w,p,s,L,F,G){for(var H=f-1,X=f===0?w:[""],ne=qP(X),ie=0,se=0,Te=0;ie<u;++ie)for(var ue=0,ce=G1(e,H+1,H=gG(se=p[ie])),de=e;ue<ne;++ue)(de=m5(se>0?X[ue]+" "+ce:Ea(ce,/&\f/g,X[ue])))&&(L[Te++]=de);return fT(e,n,a,f===0?$P:s,L,F,G)}function AG(e,n,a){return fT(e,n,a,p5,dT(bG()),G1(e,2,-2),0)}function $D(e,n,a,u){return fT(e,n,a,GP,G1(e,0,u),G1(e,u+1,-1),u)}function Kv(e,n){for(var a="",u=qP(e),f=0;f<u;f++)a+=n(e[f],f,e,n)||"";return a}function PG(e,n,a,u){switch(e.type){case mG:if(e.children.length)break;case fG:case GP:return e.return=e.return||e.value;case p5:return"";case f5:return e.return=e.value+"{"+Kv(e.children,u)+"}";case $P:e.value=e.props.join(",")}return xf(a=Kv(e.children,u))?e.return=e.value+"{"+a+"}":""}function MG(e){var n=qP(e);return function(a,u,f,w){for(var p="",s=0;s<n;s++)p+=e[s](a,u,f,w)||"";return p}}function kG(e){return function(n){n.root||(n=n.return)&&e(n)}}var RG=function(n,a,u){for(var f=0,w=0;f=w,w=Af(),f===38&&w===12&&(a[u]=1),!q1(w);)Wh();return hb(n,yh)},DG=function(n,a){var u=-1,f=44;do switch(q1(f)){case 0:f===38&&Af()===12&&(a[u]=1),n[u]+=RG(yh-1,a,u);break;case 2:n[u]+=u2(f);break;case 4:if(f===44){n[++u]=Af()===58?"&\f":"",a[u]=n[u].length;break}default:n[u]+=dT(f)}while(f=Wh());return n},OG=function(n,a){return y5(DG(_5(n),a))},GD=new WeakMap,LG=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var a=n.value,u=n.parent,f=n.column===u.column&&n.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(n.props.length===1&&a.charCodeAt(0)!==58&&!GD.get(u))&&!f){GD.set(n,!0);for(var w=[],p=OG(a,w),s=u.props,L=0,F=0;L<p.length;L++)for(var G=0;G<s.length;G++,F++)n.props[F]=w[L]?p[L].replace(/&\f/g,s[G]):s[G]+" "+p[L]}}},zG=function(n){if(n.type==="decl"){var a=n.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(n.return="",n.value="")}};function v5(e,n){switch(yG(e,n)){case 5103:return Ta+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ta+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Ta+e+oS+e+Yc+e+e;case 6828:case 4268:return Ta+e+Yc+e+e;case 6165:return Ta+e+Yc+"flex-"+e+e;case 5187:return Ta+e+Ea(e,/(\w+).+(:[^]+)/,Ta+"box-$1$2"+Yc+"flex-$1$2")+e;case 5443:return Ta+e+Yc+"flex-item-"+Ea(e,/flex-|-self/,"")+e;case 4675:return Ta+e+Yc+"flex-line-pack"+Ea(e,/align-content|flex-|-self/,"")+e;case 5548:return Ta+e+Yc+Ea(e,"shrink","negative")+e;case 5292:return Ta+e+Yc+Ea(e,"basis","preferred-size")+e;case 6060:return Ta+"box-"+Ea(e,"-grow","")+Ta+e+Yc+Ea(e,"grow","positive")+e;case 4554:return Ta+Ea(e,/([^-])(transform)/g,"$1"+Ta+"$2")+e;case 6187:return Ea(Ea(Ea(e,/(zoom-|grab)/,Ta+"$1"),/(image-set)/,Ta+"$1"),e,"")+e;case 5495:case 3959:return Ea(e,/(image-set\([^]*)/,Ta+"$1$`$1");case 4968:return Ea(Ea(e,/(.+:)(flex-)?(.*)/,Ta+"box-pack:$3"+Yc+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ta+e+e;case 4095:case 3583:case 4068:case 2532:return Ea(e,/(.+)-inline(.+)/,Ta+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xf(e)-1-n>6)switch(Ic(e,n+1)){case 109:if(Ic(e,n+4)!==45)break;case 102:return Ea(e,/(.+:)(.+)-([^]+)/,"$1"+Ta+"$2-$3$1"+oS+(Ic(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~NC(e,"stretch")?v5(Ea(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(Ic(e,n+1)!==115)break;case 6444:switch(Ic(e,xf(e)-3-(~NC(e,"!important")&&10))){case 107:return Ea(e,":",":"+Ta)+e;case 101:return Ea(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ta+(Ic(e,14)===45?"inline-":"")+"box$3$1"+Ta+"$2$3$1"+Yc+"$2box$3")+e}break;case 5936:switch(Ic(e,n+11)){case 114:return Ta+e+Yc+Ea(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Ta+e+Yc+Ea(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Ta+e+Yc+Ea(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Ta+e+Yc+e+e}return e}var NG=function(n,a,u,f){if(n.length>-1&&!n.return)switch(n.type){case GP:n.return=v5(n.value,n.length);break;case f5:return Kv([Vx(n,{value:Ea(n.value,"@","@"+Ta)})],f);case $P:if(n.length)return xG(n.props,function(w){switch(vG(w,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Kv([Vx(n,{props:[Ea(w,/:(read-\w+)/,":"+oS+"$1")]})],f);case"::placeholder":return Kv([Vx(n,{props:[Ea(w,/:(plac\w+)/,":"+Ta+"input-$1")]}),Vx(n,{props:[Ea(w,/:(plac\w+)/,":"+oS+"$1")]}),Vx(n,{props:[Ea(w,/:(plac\w+)/,Yc+"input-$1")]})],f)}return""})}},jG=[NG],BG=function(n){var a=n.key;if(a==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(se){var Te=se.getAttribute("data-emotion");Te.indexOf(" ")!==-1&&(document.head.appendChild(se),se.setAttribute("data-s",""))})}var f=n.stylisPlugins||jG,w={},p,s=[];p=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(se){for(var Te=se.getAttribute("data-emotion").split(" "),ue=1;ue<Te.length;ue++)w[Te[ue]]=!0;s.push(se)});var L,F=[LG,zG];{var G,H=[PG,kG(function(se){G.insert(se)})],X=MG(F.concat(f,H)),ne=function(Te){return Kv(CG(Te),X)};L=function(Te,ue,ce,de){G=ce,ne(Te?Te+"{"+ue.styles+"}":ue.styles),de&&(ie.inserted[ue.name]=!0)}}var ie={key:a,sheet:new pG({key:a,container:p,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:w,registered:{},insert:L};return ie.sheet.hydrate(s),ie},FG=!0;function VG(e,n,a){var u="";return a.split(" ").forEach(function(f){e[f]!==void 0?n.push(e[f]+";"):u+=f+" "}),u}var x5=function(n,a,u){var f=n.key+"-"+a.name;(u===!1||FG===!1)&&n.registered[f]===void 0&&(n.registered[f]=a.styles)},UG=function(n,a,u){x5(n,a,u);var f=n.key+"-"+a.name;if(n.inserted[a.name]===void 0){var w=a;do n.insert(a===w?"."+f:"",w,n.sheet,!0),w=w.next;while(w!==void 0)}};function $G(e){for(var n=0,a,u=0,f=e.length;f>=4;++u,f-=4)a=e.charCodeAt(u)&255|(e.charCodeAt(++u)&255)<<8|(e.charCodeAt(++u)&255)<<16|(e.charCodeAt(++u)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,n=(a&65535)*1540483477+((a>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(f){case 3:n^=(e.charCodeAt(u+2)&255)<<16;case 2:n^=(e.charCodeAt(u+1)&255)<<8;case 1:n^=e.charCodeAt(u)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var GG={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},qG=/[A-Z]|^ms/g,WG=/_EMO_([^_]+?)_([^]*?)_EMO_/g,b5=function(n){return n.charCodeAt(1)===45},qD=function(n){return n!=null&&typeof n!="boolean"},dI=d5(function(e){return b5(e)?e:e.replace(qG,"-$&").toLowerCase()}),WD=function(n,a){switch(n){case"animation":case"animationName":if(typeof a=="string")return a.replace(WG,function(u,f,w){return bf={name:f,styles:w,next:bf},f})}return GG[n]!==1&&!b5(n)&&typeof a=="number"&&a!==0?a+"px":a};function W1(e,n,a){if(a==null)return"";if(a.__emotion_styles!==void 0)return a;switch(typeof a){case"boolean":return"";case"object":{if(a.anim===1)return bf={name:a.name,styles:a.styles,next:bf},a.name;if(a.styles!==void 0){var u=a.next;if(u!==void 0)for(;u!==void 0;)bf={name:u.name,styles:u.styles,next:bf},u=u.next;var f=a.styles+";";return f}return HG(e,n,a)}case"function":{if(e!==void 0){var w=bf,p=a(e);return bf=w,W1(e,n,p)}break}}if(n==null)return a;var s=n[a];return s!==void 0?s:a}function HG(e,n,a){var u="";if(Array.isArray(a))for(var f=0;f<a.length;f++)u+=W1(e,n,a[f])+";";else for(var w in a){var p=a[w];if(typeof p!="object")n!=null&&n[p]!==void 0?u+=w+"{"+n[p]+"}":qD(p)&&(u+=dI(w)+":"+WD(w,p)+";");else if(Array.isArray(p)&&typeof p[0]=="string"&&(n==null||n[p[0]]===void 0))for(var s=0;s<p.length;s++)qD(p[s])&&(u+=dI(w)+":"+WD(w,p[s])+";");else{var L=W1(e,n,p);switch(w){case"animation":case"animationName":{u+=dI(w)+":"+L+";";break}default:u+=w+"{"+L+"}"}}}return u}var HD=/label:\s*([^\s;\n{]+)\s*(;|$)/g,bf,w5=function(n,a,u){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var f=!0,w="";bf=void 0;var p=n[0];p==null||p.raw===void 0?(f=!1,w+=W1(u,a,p)):w+=p[0];for(var s=1;s<n.length;s++)w+=W1(u,a,n[s]),f&&(w+=p[s]);HD.lastIndex=0;for(var L="",F;(F=HD.exec(w))!==null;)L+="-"+F[1];var G=$G(w)+L;return{name:G,styles:w,next:bf}},ZG=function(n){return n()},XG=I2["useInsertionEffect"]?I2["useInsertionEffect"]:!1,YG=XG||ZG,S5=fe.createContext(typeof HTMLElement<"u"?BG({key:"css"}):null);S5.Provider;var KG=function(n){return fe.forwardRef(function(a,u){var f=fe.useContext(S5);return n(a,f,u)})},T5=fe.createContext({});function k0(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return w5(n)}var db=function(){var n=k0.apply(void 0,arguments),a="animation-"+n.name;return{name:a,styles:"@keyframes "+a+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},JG=uG,QG=function(n){return n!=="theme"},ZD=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?JG:QG},XD=function(n,a,u){var f;if(a){var w=a.shouldForwardProp;f=n.__emotion_forwardProp&&w?function(p){return n.__emotion_forwardProp(p)&&w(p)}:w}return typeof f!="function"&&u&&(f=n.__emotion_forwardProp),f},eq=function(n){var a=n.cache,u=n.serialized,f=n.isStringTag;return x5(a,u,f),YG(function(){return UG(a,u,f)}),null},tq=function e(n,a){var u=n.__emotion_real===n,f=u&&n.__emotion_base||n,w,p;a!==void 0&&(w=a.label,p=a.target);var s=XD(n,a,u),L=s||ZD(f),F=!L("as");return function(){var G=arguments,H=u&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(w!==void 0&&H.push("label:"+w+";"),G[0]==null||G[0].raw===void 0)H.push.apply(H,G);else{H.push(G[0][0]);for(var X=G.length,ne=1;ne<X;ne++)H.push(G[ne],G[0][ne])}var ie=KG(function(se,Te,ue){var ce=F&&se.as||f,de="",Ee=[],Ne=se;if(se.theme==null){Ne={};for(var rt in se)Ne[rt]=se[rt];Ne.theme=fe.useContext(T5)}typeof se.className=="string"?de=VG(Te.registered,Ee,se.className):se.className!=null&&(de=se.className+" ");var tt=w5(H.concat(Ee),Te.registered,Ne);de+=Te.key+"-"+tt.name,p!==void 0&&(de+=" "+p);var Ge=F&&s===void 0?ZD(ce):L,_t={};for(var yt in se)F&&yt==="as"||Ge(yt)&&(_t[yt]=se[yt]);return _t.className=de,_t.ref=ue,fe.createElement(fe.Fragment,null,fe.createElement(eq,{cache:Te,serialized:tt,isStringTag:typeof ce=="string"}),fe.createElement(ce,_t))});return ie.displayName=w!==void 0?w:"Styled("+(typeof f=="string"?f:f.displayName||f.name||"Component")+")",ie.defaultProps=n.defaultProps,ie.__emotion_real=ie,ie.__emotion_base=f,ie.__emotion_styles=H,ie.__emotion_forwardProp=s,Object.defineProperty(ie,"toString",{value:function(){return"."+p}}),ie.withComponent=function(se,Te){return e(se,pn({},a,Te,{shouldForwardProp:XD(ie,Te,!0)})).apply(void 0,H)},ie}},rq=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],BC=tq.bind();rq.forEach(function(e){BC[e]=BC(e)});/**
 * @mui/styled-engine v5.15.6
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function nq(e,n){return BC(e,n)}const iq=(e,n)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=n(e.__emotion_styles))},oq=["values","unit","step"],aq=e=>{const n=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return n.sort((a,u)=>a.val-u.val),n.reduce((a,u)=>pn({},a,{[u.key]:u.val}),{})};function sq(e){const{values:n={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:u=5}=e,f=cc(e,oq),w=aq(n),p=Object.keys(w);function s(X){return`@media (min-width:${typeof n[X]=="number"?n[X]:X}${a})`}function L(X){return`@media (max-width:${(typeof n[X]=="number"?n[X]:X)-u/100}${a})`}function F(X,ne){const ie=p.indexOf(ne);return`@media (min-width:${typeof n[X]=="number"?n[X]:X}${a}) and (max-width:${(ie!==-1&&typeof n[p[ie]]=="number"?n[p[ie]]:ne)-u/100}${a})`}function G(X){return p.indexOf(X)+1<p.length?F(X,p[p.indexOf(X)+1]):s(X)}function H(X){const ne=p.indexOf(X);return ne===0?s(p[1]):ne===p.length-1?L(p[ne]):F(X,p[p.indexOf(X)+1]).replace("@media","@media not all and")}return pn({keys:p,values:w,up:s,down:L,between:F,only:G,not:H,unit:a},f)}const lq={borderRadius:4},cq=lq;function g1(e,n){return n?Bp(e,n,{clone:!1}):e}const WP={xs:0,sm:600,md:900,lg:1200,xl:1536},YD={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${WP[e]}px)`};function Rm(e,n,a){const u=e.theme||{};if(Array.isArray(n)){const w=u.breakpoints||YD;return n.reduce((p,s,L)=>(p[w.up(w.keys[L])]=a(n[L]),p),{})}if(typeof n=="object"){const w=u.breakpoints||YD;return Object.keys(n).reduce((p,s)=>{if(Object.keys(w.values||WP).indexOf(s)!==-1){const L=w.up(s);p[L]=a(n[s],s)}else{const L=s;p[L]=n[L]}return p},{})}return a(n)}function uq(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((u,f)=>{const w=e.up(f);return u[w]={},u},{}))||{}}function hq(e,n){return e.reduce((a,u)=>{const f=a[u];return(!f||Object.keys(f).length===0)&&delete a[u],a},n)}function mT(e,n,a=!0){if(!n||typeof n!="string")return null;if(e&&e.vars&&a){const u=`vars.${n}`.split(".").reduce((f,w)=>f&&f[w]?f[w]:null,e);if(u!=null)return u}return n.split(".").reduce((u,f)=>u&&u[f]!=null?u[f]:null,e)}function aS(e,n,a,u=a){let f;return typeof e=="function"?f=e(a):Array.isArray(e)?f=e[a]||u:f=mT(e,a)||u,n&&(f=n(f,u,e)),f}function gl(e){const{prop:n,cssProperty:a=e.prop,themeKey:u,transform:f}=e,w=p=>{if(p[n]==null)return null;const s=p[n],L=p.theme,F=mT(L,u)||{};return Rm(p,s,H=>{let X=aS(F,f,H);return H===X&&typeof H=="string"&&(X=aS(F,f,`${n}${H==="default"?"":il(H)}`,H)),a===!1?X:{[a]:X}})};return w.propTypes={},w.filterProps=[n],w}function dq(e){const n={};return a=>(n[a]===void 0&&(n[a]=e(a)),n[a])}const pq={m:"margin",p:"padding"},fq={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},KD={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},mq=dq(e=>{if(e.length>2)if(KD[e])e=KD[e];else return[e];const[n,a]=e.split(""),u=pq[n],f=fq[a]||"";return Array.isArray(f)?f.map(w=>u+w):[u+f]}),HP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],ZP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...HP,...ZP];function pb(e,n,a,u){var f;const w=(f=mT(e,n,!1))!=null?f:a;return typeof w=="number"?p=>typeof p=="string"?p:w*p:Array.isArray(w)?p=>typeof p=="string"?p:w[p]:typeof w=="function"?w:()=>{}}function E5(e){return pb(e,"spacing",8)}function fb(e,n){if(typeof n=="string"||n==null)return n;const a=Math.abs(n),u=e(a);return n>=0?u:typeof u=="number"?-u:`-${u}`}function gq(e,n){return a=>e.reduce((u,f)=>(u[f]=fb(n,a),u),{})}function _q(e,n,a,u){if(n.indexOf(a)===-1)return null;const f=mq(a),w=gq(f,u),p=e[a];return Rm(e,p,w)}function I5(e,n){const a=E5(e.theme);return Object.keys(e).map(u=>_q(e,n,u,a)).reduce(g1,{})}function tl(e){return I5(e,HP)}tl.propTypes={};tl.filterProps=HP;function rl(e){return I5(e,ZP)}rl.propTypes={};rl.filterProps=ZP;function yq(e=8){if(e.mui)return e;const n=E5({spacing:e}),a=(...u)=>(u.length===0?[1]:u).map(w=>{const p=n(w);return typeof p=="number"?`${p}px`:p}).join(" ");return a.mui=!0,a}function gT(...e){const n=e.reduce((u,f)=>(f.filterProps.forEach(w=>{u[w]=f}),u),{}),a=u=>Object.keys(u).reduce((f,w)=>n[w]?g1(f,n[w](u)):f,{});return a.propTypes={},a.filterProps=e.reduce((u,f)=>u.concat(f.filterProps),[]),a}function $d(e){return typeof e!="number"?e:`${e}px solid`}function tp(e,n){return gl({prop:e,themeKey:"borders",transform:n})}const vq=tp("border",$d),xq=tp("borderTop",$d),bq=tp("borderRight",$d),wq=tp("borderBottom",$d),Sq=tp("borderLeft",$d),Tq=tp("borderColor"),Eq=tp("borderTopColor"),Iq=tp("borderRightColor"),Cq=tp("borderBottomColor"),Aq=tp("borderLeftColor"),Pq=tp("outline",$d),Mq=tp("outlineColor"),_T=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const n=pb(e.theme,"shape.borderRadius",4),a=u=>({borderRadius:fb(n,u)});return Rm(e,e.borderRadius,a)}return null};_T.propTypes={};_T.filterProps=["borderRadius"];gT(vq,xq,bq,wq,Sq,Tq,Eq,Iq,Cq,Aq,_T,Pq,Mq);const yT=e=>{if(e.gap!==void 0&&e.gap!==null){const n=pb(e.theme,"spacing",8),a=u=>({gap:fb(n,u)});return Rm(e,e.gap,a)}return null};yT.propTypes={};yT.filterProps=["gap"];const vT=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const n=pb(e.theme,"spacing",8),a=u=>({columnGap:fb(n,u)});return Rm(e,e.columnGap,a)}return null};vT.propTypes={};vT.filterProps=["columnGap"];const xT=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const n=pb(e.theme,"spacing",8),a=u=>({rowGap:fb(n,u)});return Rm(e,e.rowGap,a)}return null};xT.propTypes={};xT.filterProps=["rowGap"];const kq=gl({prop:"gridColumn"}),Rq=gl({prop:"gridRow"}),Dq=gl({prop:"gridAutoFlow"}),Oq=gl({prop:"gridAutoColumns"}),Lq=gl({prop:"gridAutoRows"}),zq=gl({prop:"gridTemplateColumns"}),Nq=gl({prop:"gridTemplateRows"}),jq=gl({prop:"gridTemplateAreas"}),Bq=gl({prop:"gridArea"});gT(yT,vT,xT,kq,Rq,Dq,Oq,Lq,zq,Nq,jq,Bq);function Jv(e,n){return n==="grey"?n:e}const Fq=gl({prop:"color",themeKey:"palette",transform:Jv}),Vq=gl({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Jv}),Uq=gl({prop:"backgroundColor",themeKey:"palette",transform:Jv});gT(Fq,Vq,Uq);function $h(e){return e<=1&&e!==0?`${e*100}%`:e}const $q=gl({prop:"width",transform:$h}),XP=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const n=a=>{var u,f;const w=((u=e.theme)==null||(u=u.breakpoints)==null||(u=u.values)==null?void 0:u[a])||WP[a];return w?((f=e.theme)==null||(f=f.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${w}${e.theme.breakpoints.unit}`}:{maxWidth:w}:{maxWidth:$h(a)}};return Rm(e,e.maxWidth,n)}return null};XP.filterProps=["maxWidth"];const Gq=gl({prop:"minWidth",transform:$h}),qq=gl({prop:"height",transform:$h}),Wq=gl({prop:"maxHeight",transform:$h}),Hq=gl({prop:"minHeight",transform:$h});gl({prop:"size",cssProperty:"width",transform:$h});gl({prop:"size",cssProperty:"height",transform:$h});const Zq=gl({prop:"boxSizing"});gT($q,XP,Gq,qq,Wq,Hq,Zq);const Xq={border:{themeKey:"borders",transform:$d},borderTop:{themeKey:"borders",transform:$d},borderRight:{themeKey:"borders",transform:$d},borderBottom:{themeKey:"borders",transform:$d},borderLeft:{themeKey:"borders",transform:$d},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:$d},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:_T},color:{themeKey:"palette",transform:Jv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Jv},backgroundColor:{themeKey:"palette",transform:Jv},p:{style:rl},pt:{style:rl},pr:{style:rl},pb:{style:rl},pl:{style:rl},px:{style:rl},py:{style:rl},padding:{style:rl},paddingTop:{style:rl},paddingRight:{style:rl},paddingBottom:{style:rl},paddingLeft:{style:rl},paddingX:{style:rl},paddingY:{style:rl},paddingInline:{style:rl},paddingInlineStart:{style:rl},paddingInlineEnd:{style:rl},paddingBlock:{style:rl},paddingBlockStart:{style:rl},paddingBlockEnd:{style:rl},m:{style:tl},mt:{style:tl},mr:{style:tl},mb:{style:tl},ml:{style:tl},mx:{style:tl},my:{style:tl},margin:{style:tl},marginTop:{style:tl},marginRight:{style:tl},marginBottom:{style:tl},marginLeft:{style:tl},marginX:{style:tl},marginY:{style:tl},marginInline:{style:tl},marginInlineStart:{style:tl},marginInlineEnd:{style:tl},marginBlock:{style:tl},marginBlockStart:{style:tl},marginBlockEnd:{style:tl},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:yT},rowGap:{style:xT},columnGap:{style:vT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:$h},maxWidth:{style:XP},minWidth:{transform:$h},height:{transform:$h},maxHeight:{transform:$h},minHeight:{transform:$h},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},YP=Xq;function Yq(...e){const n=e.reduce((u,f)=>u.concat(Object.keys(f)),[]),a=new Set(n);return e.every(u=>a.size===Object.keys(u).length)}function Kq(e,n){return typeof e=="function"?e(n):e}function Jq(){function e(a,u,f,w){const p={[a]:u,theme:f},s=w[a];if(!s)return{[a]:u};const{cssProperty:L=a,themeKey:F,transform:G,style:H}=s;if(u==null)return null;if(F==="typography"&&u==="inherit")return{[a]:u};const X=mT(f,F)||{};return H?H(p):Rm(p,u,ie=>{let se=aS(X,G,ie);return ie===se&&typeof ie=="string"&&(se=aS(X,G,`${a}${ie==="default"?"":il(ie)}`,ie)),L===!1?se:{[L]:se}})}function n(a){var u;const{sx:f,theme:w={}}=a||{};if(!f)return null;const p=(u=w.unstable_sxConfig)!=null?u:YP;function s(L){let F=L;if(typeof L=="function")F=L(w);else if(typeof L!="object")return L;if(!F)return null;const G=uq(w.breakpoints),H=Object.keys(G);let X=G;return Object.keys(F).forEach(ne=>{const ie=Kq(F[ne],w);if(ie!=null)if(typeof ie=="object")if(p[ne])X=g1(X,e(ne,ie,w,p));else{const se=Rm({theme:w},ie,Te=>({[ne]:Te}));Yq(se,ie)?X[ne]=n({sx:ie,theme:w}):X=g1(X,se)}else X=g1(X,e(ne,ie,w,p))}),hq(H,X)}return Array.isArray(f)?f.map(s):s(f)}return n}const C5=Jq();C5.filterProps=["sx"];const KP=C5,Qq=["breakpoints","palette","spacing","shape"];function JP(e={},...n){const{breakpoints:a={},palette:u={},spacing:f,shape:w={}}=e,p=cc(e,Qq),s=sq(a),L=yq(f);let F=Bp({breakpoints:s,direction:"ltr",components:{},palette:pn({mode:"light"},u),spacing:L,shape:pn({},cq,w)},p);return F=n.reduce((G,H)=>Bp(G,H),F),F.unstable_sxConfig=pn({},YP,p==null?void 0:p.unstable_sxConfig),F.unstable_sx=function(H){return KP({sx:H,theme:this})},F}function eW(e){return Object.keys(e).length===0}function tW(e=null){const n=fe.useContext(T5);return!n||eW(n)?e:n}const rW=JP();function A5(e=rW){return tW(e)}const nW=["variant"];function JD(e){return e.length===0}function P5(e){const{variant:n}=e,a=cc(e,nW);let u=n||"";return Object.keys(a).sort().forEach(f=>{f==="color"?u+=JD(u)?e[f]:il(e[f]):u+=`${JD(u)?f:il(f)}${il(e[f].toString())}`}),u}const iW=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function oW(e){return Object.keys(e).length===0}function aW(e){return typeof e=="string"&&e.charCodeAt(0)>96}const sW=(e,n)=>n.components&&n.components[e]&&n.components[e].styleOverrides?n.components[e].styleOverrides:null,sS=e=>{let n=0;const a={};return e&&e.forEach(u=>{let f="";typeof u.props=="function"?(f=`callback${n}`,n+=1):f=P5(u.props),a[f]=u.style}),a},lW=(e,n)=>{let a=[];return n&&n.components&&n.components[e]&&n.components[e].variants&&(a=n.components[e].variants),sS(a)},lS=(e,n,a)=>{const{ownerState:u={}}=e,f=[];let w=0;return a&&a.forEach(p=>{let s=!0;if(typeof p.props=="function"){const L=pn({},e,u);s=p.props(L)}else Object.keys(p.props).forEach(L=>{u[L]!==p.props[L]&&e[L]!==p.props[L]&&(s=!1)});s&&(typeof p.props=="function"?f.push(n[`callback${w}`]):f.push(n[P5(p.props)])),typeof p.props=="function"&&(w+=1)}),f},cW=(e,n,a,u)=>{var f;const w=a==null||(f=a.components)==null||(f=f[u])==null?void 0:f.variants;return lS(e,n,w)};function d2(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const uW=JP(),hW=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function p2({defaultTheme:e,theme:n,themeId:a}){return oW(n)?e:n[a]||n}function dW(e){return e?(n,a)=>a[e]:null}const QD=({styledArg:e,props:n,defaultTheme:a,themeId:u})=>{const f=e(pn({},n,{theme:p2(pn({},n,{defaultTheme:a,themeId:u}))}));let w;if(f&&f.variants&&(w=f.variants,delete f.variants),w){const p=lS(n,sS(w),w);return[f,...p]}return f};function pW(e={}){const{themeId:n,defaultTheme:a=uW,rootShouldForwardProp:u=d2,slotShouldForwardProp:f=d2}=e,w=p=>KP(pn({},p,{theme:p2(pn({},p,{defaultTheme:a,themeId:n}))}));return w.__mui_systemSx=!0,(p,s={})=>{iq(p,Ee=>Ee.filter(Ne=>!(Ne!=null&&Ne.__mui_systemSx)));const{name:L,slot:F,skipVariantsResolver:G,skipSx:H,overridesResolver:X=dW(hW(F))}=s,ne=cc(s,iW),ie=G!==void 0?G:F&&F!=="Root"&&F!=="root"||!1,se=H||!1;let Te,ue=d2;F==="Root"||F==="root"?ue=u:F?ue=f:aW(p)&&(ue=void 0);const ce=nq(p,pn({shouldForwardProp:ue,label:Te},ne)),de=(Ee,...Ne)=>{const rt=Ne?Ne.map(yt=>{if(typeof yt=="function"&&yt.__emotion_real!==yt)return Et=>QD({styledArg:yt,props:Et,defaultTheme:a,themeId:n});if(jg(yt)){let Et=yt,Wt;return yt&&yt.variants&&(Wt=yt.variants,delete Et.variants,Et=Ar=>{let mt=yt;return lS(Ar,sS(Wt),Wt).forEach(Xt=>{mt=Bp(mt,Xt)}),mt}),Et}return yt}):[];let tt=Ee;if(jg(Ee)){let yt;Ee&&Ee.variants&&(yt=Ee.variants,delete tt.variants,tt=Et=>{let Wt=Ee;return lS(Et,sS(yt),yt).forEach(mt=>{Wt=Bp(Wt,mt)}),Wt})}else typeof Ee=="function"&&Ee.__emotion_real!==Ee&&(tt=yt=>QD({styledArg:Ee,props:yt,defaultTheme:a,themeId:n}));L&&X&&rt.push(yt=>{const Et=p2(pn({},yt,{defaultTheme:a,themeId:n})),Wt=sW(L,Et);if(Wt){const Ar={};return Object.entries(Wt).forEach(([mt,nr])=>{Ar[mt]=typeof nr=="function"?nr(pn({},yt,{theme:Et})):nr}),X(yt,Ar)}return null}),L&&!ie&&rt.push(yt=>{const Et=p2(pn({},yt,{defaultTheme:a,themeId:n}));return cW(yt,lW(L,Et),Et,L)}),se||rt.push(w);const Ge=rt.length-Ne.length;if(Array.isArray(Ee)&&Ge>0){const yt=new Array(Ge).fill("");tt=[...Ee,...yt],tt.raw=[...Ee.raw,...yt]}const _t=ce(tt,...rt);return p.muiName&&(_t.muiName=p.muiName),_t};return ce.withConfig&&(de.withConfig=ce.withConfig),de}}function fW(e){const{theme:n,name:a,props:u}=e;return!n||!n.components||!n.components[a]||!n.components[a].defaultProps?u:c5(n.components[a].defaultProps,u)}function mW({props:e,name:n,defaultTheme:a,themeId:u}){let f=A5(a);return u&&(f=f[u]||f),fW({theme:f,name:n,props:e})}function M5(e,n=0,a=1){return lG(e,n,a)}function gW(e){e=e.slice(1);const n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(n);return a&&a[0].length===1&&(a=a.map(u=>u+u)),a?`rgb${a.length===4?"a":""}(${a.map((u,f)=>f<3?parseInt(u,16):Math.round(parseInt(u,16)/255*1e3)/1e3).join(", ")})`:""}function f0(e){if(e.type)return e;if(e.charAt(0)==="#")return f0(gW(e));const n=e.indexOf("("),a=e.substring(0,n);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error(d0(9,e));let u=e.substring(n+1,e.length-1),f;if(a==="color"){if(u=u.split(" "),f=u.shift(),u.length===4&&u[3].charAt(0)==="/"&&(u[3]=u[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(f)===-1)throw new Error(d0(10,f))}else u=u.split(",");return u=u.map(w=>parseFloat(w)),{type:a,values:u,colorSpace:f}}function QP(e){const{type:n,colorSpace:a}=e;let{values:u}=e;return n.indexOf("rgb")!==-1?u=u.map((f,w)=>w<3?parseInt(f,10):f):n.indexOf("hsl")!==-1&&(u[1]=`${u[1]}%`,u[2]=`${u[2]}%`),n.indexOf("color")!==-1?u=`${a} ${u.join(" ")}`:u=`${u.join(", ")}`,`${n}(${u})`}function _W(e){e=f0(e);const{values:n}=e,a=n[0],u=n[1]/100,f=n[2]/100,w=u*Math.min(f,1-f),p=(F,G=(F+a/30)%12)=>f-w*Math.max(Math.min(G-3,9-G,1),-1);let s="rgb";const L=[Math.round(p(0)*255),Math.round(p(8)*255),Math.round(p(4)*255)];return e.type==="hsla"&&(s+="a",L.push(n[3])),QP({type:s,values:L})}function eO(e){e=f0(e);let n=e.type==="hsl"||e.type==="hsla"?f0(_W(e)).values:e.values;return n=n.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*n[0]+.7152*n[1]+.0722*n[2]).toFixed(3))}function yW(e,n){const a=eO(e),u=eO(n);return(Math.max(a,u)+.05)/(Math.min(a,u)+.05)}function k5(e,n){if(e=f0(e),n=M5(n),e.type.indexOf("hsl")!==-1)e.values[2]*=1-n;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)e.values[a]*=1-n;return QP(e)}function R5(e,n){if(e=f0(e),n=M5(n),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*n;else if(e.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*n;else if(e.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*n;return QP(e)}function vW(e,n){return pn({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},n)}const xW={black:"#000",white:"#fff"},H1=xW,bW={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},wW=bW,SW={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},bv=SW,TW={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},wv=TW,EW={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ux=EW,IW={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Sv=IW,CW={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Tv=CW,AW={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ev=AW,PW=["mode","contrastThreshold","tonalOffset"],tO={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:H1.white,default:H1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},pI={text:{primary:H1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:H1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function rO(e,n,a,u){const f=u.light||u,w=u.dark||u*1.5;e[n]||(e.hasOwnProperty(a)?e[n]=e[a]:n==="light"?e.light=R5(e.main,f):n==="dark"&&(e.dark=k5(e.main,w)))}function MW(e="light"){return e==="dark"?{main:Sv[200],light:Sv[50],dark:Sv[400]}:{main:Sv[700],light:Sv[400],dark:Sv[800]}}function kW(e="light"){return e==="dark"?{main:bv[200],light:bv[50],dark:bv[400]}:{main:bv[500],light:bv[300],dark:bv[700]}}function RW(e="light"){return e==="dark"?{main:wv[500],light:wv[300],dark:wv[700]}:{main:wv[700],light:wv[400],dark:wv[800]}}function DW(e="light"){return e==="dark"?{main:Tv[400],light:Tv[300],dark:Tv[700]}:{main:Tv[700],light:Tv[500],dark:Tv[900]}}function OW(e="light"){return e==="dark"?{main:Ev[400],light:Ev[300],dark:Ev[700]}:{main:Ev[800],light:Ev[500],dark:Ev[900]}}function LW(e="light"){return e==="dark"?{main:Ux[400],light:Ux[300],dark:Ux[700]}:{main:"#ed6c02",light:Ux[500],dark:Ux[900]}}function zW(e){const{mode:n="light",contrastThreshold:a=3,tonalOffset:u=.2}=e,f=cc(e,PW),w=e.primary||MW(n),p=e.secondary||kW(n),s=e.error||RW(n),L=e.info||DW(n),F=e.success||OW(n),G=e.warning||LW(n);function H(se){return yW(se,pI.text.primary)>=a?pI.text.primary:tO.text.primary}const X=({color:se,name:Te,mainShade:ue=500,lightShade:ce=300,darkShade:de=700})=>{if(se=pn({},se),!se.main&&se[ue]&&(se.main=se[ue]),!se.hasOwnProperty("main"))throw new Error(d0(11,Te?` (${Te})`:"",ue));if(typeof se.main!="string")throw new Error(d0(12,Te?` (${Te})`:"",JSON.stringify(se.main)));return rO(se,"light",ce,u),rO(se,"dark",de,u),se.contrastText||(se.contrastText=H(se.main)),se},ne={dark:pI,light:tO};return Bp(pn({common:pn({},H1),mode:n,primary:X({color:w,name:"primary"}),secondary:X({color:p,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:X({color:s,name:"error"}),warning:X({color:G,name:"warning"}),info:X({color:L,name:"info"}),success:X({color:F,name:"success"}),grey:wW,contrastThreshold:a,getContrastText:H,augmentColor:X,tonalOffset:u},ne[n]),f)}const NW=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function jW(e){return Math.round(e*1e5)/1e5}const nO={textTransform:"uppercase"},iO='"Roboto", "Helvetica", "Arial", sans-serif';function BW(e,n){const a=typeof n=="function"?n(e):n,{fontFamily:u=iO,fontSize:f=14,fontWeightLight:w=300,fontWeightRegular:p=400,fontWeightMedium:s=500,fontWeightBold:L=700,htmlFontSize:F=16,allVariants:G,pxToRem:H}=a,X=cc(a,NW),ne=f/14,ie=H||(ue=>`${ue/F*ne}rem`),se=(ue,ce,de,Ee,Ne)=>pn({fontFamily:u,fontWeight:ue,fontSize:ie(ce),lineHeight:de},u===iO?{letterSpacing:`${jW(Ee/ce)}em`}:{},Ne,G),Te={h1:se(w,96,1.167,-1.5),h2:se(w,60,1.2,-.5),h3:se(p,48,1.167,0),h4:se(p,34,1.235,.25),h5:se(p,24,1.334,0),h6:se(s,20,1.6,.15),subtitle1:se(p,16,1.75,.15),subtitle2:se(s,14,1.57,.1),body1:se(p,16,1.5,.15),body2:se(p,14,1.43,.15),button:se(s,14,1.75,.4,nO),caption:se(p,12,1.66,.4),overline:se(p,12,2.66,1,nO),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Bp(pn({htmlFontSize:F,pxToRem:ie,fontFamily:u,fontSize:f,fontWeightLight:w,fontWeightRegular:p,fontWeightMedium:s,fontWeightBold:L},Te),X,{clone:!1})}const FW=.2,VW=.14,UW=.12;function ks(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${FW})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${VW})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${UW})`].join(",")}const $W=["none",ks(0,2,1,-1,0,1,1,0,0,1,3,0),ks(0,3,1,-2,0,2,2,0,0,1,5,0),ks(0,3,3,-2,0,3,4,0,0,1,8,0),ks(0,2,4,-1,0,4,5,0,0,1,10,0),ks(0,3,5,-1,0,5,8,0,0,1,14,0),ks(0,3,5,-1,0,6,10,0,0,1,18,0),ks(0,4,5,-2,0,7,10,1,0,2,16,1),ks(0,5,5,-3,0,8,10,1,0,3,14,2),ks(0,5,6,-3,0,9,12,1,0,3,16,2),ks(0,6,6,-3,0,10,14,1,0,4,18,3),ks(0,6,7,-4,0,11,15,1,0,4,20,3),ks(0,7,8,-4,0,12,17,2,0,5,22,4),ks(0,7,8,-4,0,13,19,2,0,5,24,4),ks(0,7,9,-4,0,14,21,2,0,5,26,4),ks(0,8,9,-5,0,15,22,2,0,6,28,5),ks(0,8,10,-5,0,16,24,2,0,6,30,5),ks(0,8,11,-5,0,17,26,2,0,6,32,5),ks(0,9,11,-5,0,18,28,2,0,7,34,6),ks(0,9,12,-6,0,19,29,2,0,7,36,6),ks(0,10,13,-6,0,20,31,3,0,8,38,7),ks(0,10,13,-6,0,21,33,3,0,8,40,7),ks(0,10,14,-6,0,22,35,3,0,8,42,7),ks(0,11,14,-7,0,23,36,3,0,9,44,8),ks(0,11,15,-7,0,24,38,3,0,9,46,8)],GW=$W,qW=["duration","easing","delay"],WW={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},HW={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function oO(e){return`${Math.round(e)}ms`}function ZW(e){if(!e)return 0;const n=e/36;return Math.round((4+15*n**.25+n/5)*10)}function XW(e){const n=pn({},WW,e.easing),a=pn({},HW,e.duration);return pn({getAutoHeightDuration:ZW,create:(f=["all"],w={})=>{const{duration:p=a.standard,easing:s=n.easeInOut,delay:L=0}=w;return cc(w,qW),(Array.isArray(f)?f:[f]).map(F=>`${F} ${typeof p=="string"?p:oO(p)} ${s} ${typeof L=="string"?L:oO(L)}`).join(",")}},e,{easing:n,duration:a})}const YW={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},KW=YW,JW=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function QW(e={},...n){const{mixins:a={},palette:u={},transitions:f={},typography:w={}}=e,p=cc(e,JW);if(e.vars)throw new Error(d0(18));const s=zW(u),L=JP(e);let F=Bp(L,{mixins:vW(L.breakpoints,a),palette:s,shadows:GW.slice(),typography:BW(s,w),transitions:XW(f),zIndex:pn({},KW),applyDarkStyles(G){return this.vars?{[this.getColorSchemeSelector("dark").replace(/(\[[^\]]+\])/,":where($1)")]:G}:this.palette.mode==="dark"?G:{}}});return F=Bp(F,p),F=n.reduce((G,H)=>Bp(G,H),F),F.unstable_sxConfig=pn({},YP,p==null?void 0:p.unstable_sxConfig),F.unstable_sx=function(H){return KP({sx:H,theme:this})},F}const eH=QW(),eM=eH,tM="$$material";function rM({props:e,name:n}){return mW({props:e,name:n,defaultTheme:eM,themeId:tM})}const tH=e=>d2(e)&&e!=="classes",rH=pW({themeId:tM,defaultTheme:eM,rootShouldForwardProp:tH}),v_=rH;function nH(e){return hT("MuiSvgIcon",e)}UP("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const iH=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],oH=e=>{const{color:n,fontSize:a,classes:u}=e,f={root:["root",n!=="inherit"&&`color${il(n)}`,`fontSize${il(a)}`]};return Py(f,nH,u)},aH=v_("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,a.color!=="inherit"&&n[`color${il(a.color)}`],n[`fontSize${il(a.fontSize)}`]]}})(({theme:e,ownerState:n})=>{var a,u,f,w,p,s,L,F,G,H,X,ne,ie;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=e.transitions)==null||(u=a.create)==null?void 0:u.call(a,"fill",{duration:(f=e.transitions)==null||(f=f.duration)==null?void 0:f.shorter}),fontSize:{inherit:"inherit",small:((w=e.typography)==null||(p=w.pxToRem)==null?void 0:p.call(w,20))||"1.25rem",medium:((s=e.typography)==null||(L=s.pxToRem)==null?void 0:L.call(s,24))||"1.5rem",large:((F=e.typography)==null||(G=F.pxToRem)==null?void 0:G.call(F,35))||"2.1875rem"}[n.fontSize],color:(H=(X=(e.vars||e).palette)==null||(X=X[n.color])==null?void 0:X.main)!=null?H:{action:(ne=(e.vars||e).palette)==null||(ne=ne.action)==null?void 0:ne.active,disabled:(ie=(e.vars||e).palette)==null||(ie=ie.action)==null?void 0:ie.disabled,inherit:void 0}[n.color]}}),D5=fe.forwardRef(function(n,a){const u=rM({props:n,name:"MuiSvgIcon"}),{children:f,className:w,color:p="inherit",component:s="svg",fontSize:L="medium",htmlColor:F,inheritViewBox:G=!1,titleAccess:H,viewBox:X="0 0 24 24"}=u,ne=cc(u,iH),ie=fe.isValidElement(f)&&f.type==="svg",se=pn({},u,{color:p,component:s,fontSize:L,instanceFontSize:n.fontSize,inheritViewBox:G,viewBox:X,hasSvgAsChild:ie}),Te={};G||(Te.viewBox=X);const ue=oH(se);return y.jsxs(aH,pn({as:s,className:$1(ue.root,w),focusable:"false",color:F,"aria-hidden":H?void 0:!0,role:H?"img":void 0,ref:a},Te,ne,ie&&f.props,{ownerState:se,children:[ie?f.props.children:f,H?y.jsx("title",{children:H}):null]}))});D5.muiName="SvgIcon";const aO=D5;function Io(e,n){function a(u,f){return y.jsx(aO,pn({"data-testid":`${n}Icon`,ref:f},u,{children:e}))}return a.muiName=aO.muiName,fe.memo(fe.forwardRef(a))}const $x=Io(y.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),sH=Io(y.jsx("path",{d:"M21.02 5H19V2.98c0-.54-.44-.98-.98-.98h-.03c-.55 0-.99.44-.99.98V5h-2.01c-.54 0-.98.44-.99.98v.03c0 .55.44.99.99.99H17v2.01c0 .54.44.99.99.98h.03c.54 0 .98-.44.98-.98V7h2.02c.54 0 .98-.44.98-.98v-.04c0-.54-.44-.98-.98-.98M16 9.01V8h-1.01c-.53 0-1.03-.21-1.41-.58-.37-.38-.58-.88-.58-1.44 0-.36.1-.69.27-.98H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-8.28c-.3.17-.64.28-1.02.28-1.09-.01-1.98-.9-1.98-1.99M15.96 19H6c-.41 0-.65-.47-.4-.8l1.98-2.63c.21-.28.62-.26.82.02L10 18l2.61-3.48c.2-.26.59-.27.79-.01l2.95 3.68c.26.33.03.81-.39.81"}),"AddPhotoAlternateRounded"),lH=Io(y.jsx("path",{d:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1"}),"AddRounded"),cH=Io(y.jsx("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.9959.9959 0 0 0-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"}),"ArrowBackRounded"),uH=Io(y.jsx("path",{d:"M11 5v11.17l-4.88-4.88c-.39-.39-1.03-.39-1.42 0-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L13 16.17V5c0-.55-.45-1-1-1s-1 .45-1 1"}),"ArrowDownwardRounded"),Iv=Io(y.jsx("path",{d:"m8.71 11.71 2.59 2.59c.39.39 1.02.39 1.41 0l2.59-2.59c.63-.63.18-1.71-.71-1.71H9.41c-.89 0-1.33 1.08-.7 1.71"}),"ArrowDropDownRounded"),hH=Io(y.jsx("path",{d:"M13 19V7.83l4.88 4.88c.39.39 1.03.39 1.42 0 .39-.39.39-1.02 0-1.41l-6.59-6.59a.9959.9959 0 0 0-1.41 0l-6.6 6.58c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L11 7.83V19c0 .55.45 1 1 1s1-.45 1-1"}),"ArrowUpwardRounded"),O5=Io(y.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M8 17c-.55 0-1-.45-1-1v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 .55-.45 1-1 1m4 0c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v8c0 .55-.45 1-1 1m4 0c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1s1 .45 1 1v2c0 .55-.45 1-1 1"}),"AssessmentRounded"),dH=Io(y.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7-.25c.41 0 .75.34.75.75s-.34.75-.75.75-.75-.34-.75-.75.34-.75.75-.75M12 13c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1m1 3c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1"}),"AssignmentLateRounded"),sO=Io(y.jsx("path",{d:"m20 15.31 1.9-1.9c.78-.78.78-2.05 0-2.83L20 8.69V6c0-1.1-.9-2-2-2h-2.69l-1.9-1.9c-.78-.78-2.05-.78-2.83 0L8.69 4H6c-1.1 0-2 .9-2 2v2.69l-1.9 1.9c-.78.78-.78 2.05 0 2.83l1.9 1.9V18c0 1.1.9 2 2 2h2.69l1.9 1.9c.78.78 2.05.78 2.83 0l1.9-1.9H18c1.1 0 2-.9 2-2zm-8 1.59V7.1c0-.61.55-1.11 1.15-.99C15.91 6.65 18 9.08 18 12s-2.09 5.35-4.85 5.89c-.6.12-1.15-.38-1.15-.99"}),"BrightnessMediumRounded"),pH=Io(y.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M9.29 16.29 5.7 12.7a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0L10 14.17l6.88-6.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-7.59 7.59c-.38.39-1.02.39-1.41 0"}),"CheckCircleRounded"),Mc=Io(y.jsx("path",{d:"M18.3 5.71a.9959.9959 0 0 0-1.41 0L12 10.59 7.11 5.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"}),"CloseRounded"),L5=Io(y.jsx("path",{d:"M12 7V5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm-2 12H4v-2h6zm0-4H4v-2h6zm0-4H4V9h6zm0-4H4V5h6zm10 12h-8V9h8zm-2-8h-4v2h4zm0 4h-4v2h4z"}),"CorporateFareRounded"),lO=Io(y.jsx("path",{d:"M11.01 3.05C6.51 3.54 3 7.36 3 12c0 4.97 4.03 9 9 9 4.63 0 8.45-3.5 8.95-8 .09-.79-.78-1.42-1.54-.95-.84.54-1.84.85-2.91.85-2.98 0-5.4-2.42-5.4-5.4 0-1.06.31-2.06.84-2.89.45-.67-.04-1.63-.93-1.56"}),"DarkModeRounded"),z5=Io(y.jsx("path",{d:"M4 13h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1m0 8h6c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1m10 0h6c.55 0 1-.45 1-1v-8c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1M13 4v4c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1h-6c-.55 0-1 .45-1 1"}),"DashboardRounded"),fH=Io(y.jsx("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1c-.1.1-.15.22-.15.36M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"EditRounded"),N5=Io(y.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email"),mH=Io(y.jsx("path",{d:"M9 15c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4M4.74 9h8.53c.27 0 .49-.22.49-.49v-.02c0-.27-.22-.49-.49-.49H13c0-1.48-.81-2.75-2-3.45v.95c0 .28-.22.5-.5.5s-.5-.22-.5-.5V4.14C9.68 4.06 9.35 4 9 4s-.68.06-1 .14V5.5c0 .28-.22.5-.5.5S7 5.78 7 5.5v-.95C5.81 5.25 5 6.52 5 8h-.26c-.27 0-.49.22-.49.49v.03c0 .26.22.48.49.48M9 13c1.86 0 3.41-1.28 3.86-3H5.14c.45 1.72 2 3 3.86 3m12.98-6.77.93-.83-.75-1.3-1.19.39c-.14-.11-.3-.2-.47-.27L20.25 3h-1.5l-.25 1.22c-.17.07-.33.16-.48.27l-1.18-.39-.75 1.3.93.83c-.02.17-.02.35 0 .52l-.93.85.75 1.3 1.2-.38c.13.1.28.18.43.25l.28 1.23h1.5l.27-1.22c.16-.07.3-.15.44-.25l1.19.38.75-1.3-.93-.85c.03-.19.02-.36.01-.53M19.5 7.75c-.69 0-1.25-.56-1.25-1.25s.56-1.25 1.25-1.25 1.25.56 1.25 1.25-.56 1.25-1.25 1.25m-.1 3.04-.85.28c-.1-.08-.21-.14-.33-.19l-.18-.88h-1.07l-.18.87c-.12.05-.24.12-.34.19l-.84-.28-.54.93.66.59c-.01.13-.01.25 0 .37l-.66.61.54.93.86-.27c.1.07.2.13.31.18l.18.88h1.07l.19-.87c.11-.05.22-.11.32-.18l.85.27.54-.93-.66-.61c.01-.13.01-.25 0-.37l.66-.59zm-1.9 2.6c-.49 0-.89-.4-.89-.89s.4-.89.89-.89.89.4.89.89-.4.89-.89.89"}),"EngineeringRounded"),FC=Io(y.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 11c-.55 0-1-.45-1-1V8c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1m1 4h-2v-2h2z"}),"ErrorRounded"),nM=Io(y.jsx("path",{d:"M11.29 8.71 6.7 13.3c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.38-.39-1.02-.39-1.41 0"}),"ExpandLessRounded"),My=Io(y.jsx("path",{d:"M15.88 9.29 12 13.17 8.12 9.29a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0"}),"ExpandMoreRounded"),j5=Io(y.jsx("path",{d:"M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m13 2h-2.5A3.5 3.5 0 0 0 12 8.5V11h-2v3h2v7h3v-7h3v-3h-3V9a1 1 0 0 1 1-1h2V5z"}),"Facebook"),uy=Io(y.jsx("path",{d:"M7.4 10h1.59v5c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-5h1.59c.89 0 1.34-1.08.71-1.71L12.7 3.7a.9959.9959 0 0 0-1.41 0L6.7 8.29c-.63.63-.19 1.71.7 1.71M5 19c0 .55.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1"}),"FileUploadRounded"),gH=Io(y.jsx("path",{fillRule:"evenodd",d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1"}),"HorizontalRuleRounded"),B5=Io(y.jsx("path",{d:"M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"}),"Instagram"),_H=Io(y.jsx("path",{d:"M18 19H6c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h5c.55 0 1-.45 1-1s-.45-1-1-1H5c-1.11 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-.55-.45-1-1-1s-1 .45-1 1v5c0 .55-.45 1-1 1M14 4c0 .55.45 1 1 1h2.59l-9.13 9.13c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L19 6.41V9c0 .55.45 1 1 1s1-.45 1-1V3h-6c-.55 0-1 .45-1 1"}),"LaunchRounded"),cO=Io(y.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5M2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1m18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1M11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1m0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1M5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0z"}),"LightModeRounded"),yH=Io(y.jsx("path",{d:"M15 11V5.83c0-.53-.21-1.04-.59-1.41L12.7 2.71a.9959.9959 0 0 0-1.41 0l-1.7 1.7C9.21 4.79 9 5.3 9 5.83V7H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-6c0-1.1-.9-2-2-2zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"}),"LocationCityRounded"),cS=Io(y.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2M9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 14H6V10h12zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2"}),"LockOutlined"),F5=Io([y.jsx("path",{d:"M5 5h6c.55 0 1-.45 1-1s-.45-1-1-1H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h6c.55 0 1-.45 1-1s-.45-1-1-1H5z"},"0"),y.jsx("path",{d:"m20.65 11.65-2.79-2.79c-.32-.32-.86-.1-.86.35V11h-7c-.55 0-1 .45-1 1s.45 1 1 1h7v1.79c0 .45.54.67.85.35l2.79-2.79c.2-.19.2-.51.01-.7"},"1")],"LogoutRounded"),iM=Io(y.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m-1 14H5c-.55 0-1-.45-1-1V8l6.94 4.34c.65.41 1.47.41 2.12 0L20 8v9c0 .55-.45 1-1 1m-7-7L4 6h16z"}),"MailOutlineRounded"),V5=Io(y.jsx("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),vH=Io(y.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V18c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-1.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05.02.01.03.03.04.04 1.14.83 1.93 1.94 1.93 3.41V18c0 .35-.07.69-.18 1H22c.55 0 1-.45 1-1v-1.5c0-2.33-4.67-3.5-7-3.5"}),"PeopleRounded"),oM=Io(y.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V8c0-.55-.45-1-1-1s-1 .45-1 1v2H2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1zm9 4c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4"}),"PersonAddRounded"),xH=Io([y.jsx("path",{d:"M21 6.3c0-.79-.47-1.51-1.19-1.83l-7-3.11c-.52-.23-1.11-.23-1.62 0l-7 3.11C3.47 4.79 3 5.51 3 6.3V11c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07 1.95-1.95 5.12-1.95 7.07 0 1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),y.jsx("circle",{cx:"12",cy:"12",r:"3"},"1")],"PolicyRounded"),U5=Io(y.jsx("path",{d:"M19.88 18.47c.48-.77.75-1.67.69-2.66-.13-2.15-1.84-3.97-3.97-4.2-2.72-.3-5.02 1.81-5.02 4.47 0 2.49 2.01 4.5 4.49 4.5.88 0 1.7-.26 2.39-.7l2.41 2.41c.39.39 1.03.39 1.42 0 .39-.39.39-1.03 0-1.42zm-3.8.11c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5m-.36-8.5c-.74.02-1.45.18-2.1.45l-.55-.83-3.08 5.01c-.36.58-1.17.64-1.61.13l-2.12-2.47-3.06 4.9c-.31.49-.97.62-1.44.28-.42-.31-.54-.89-.26-1.34l3.78-6.05c.36-.57 1.17-.63 1.61-.12L9 12.5l3.18-5.17c.38-.62 1.28-.64 1.68-.03zm2.59.5c-.64-.28-1.33-.45-2.05-.49L20.8 2.9c.31-.49.97-.61 1.43-.27.43.31.54.9.26 1.34z"}),"QueryStatsRounded"),Gx=Io(y.jsx("path",{d:"M18 13H6c-.55 0-1-.45-1-1s.45-1 1-1h12c.55 0 1 .45 1 1s-.45 1-1 1"}),"RemoveRounded"),$5=Io(y.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search"),G5=Io(y.jsx("path",{d:"m19.41 7.41-4.83-4.83c-.37-.37-.88-.58-1.41-.58H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8.83c0-.53-.21-1.04-.59-1.42m-9.18 9.88-2.12-2.12a.9959.9959 0 0 1 0-1.41c.39-.39 1.02-.39 1.41 0l1.41 1.41 3.54-3.54c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.24 4.24c-.38.4-1.02.4-1.41.01M14 9c-.55 0-1-.45-1-1V3.5L18.5 9z"}),"TaskRounded"),q5=Io(y.jsx("path",{d:"M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"}),"Twitter"),bH=Io(y.jsx("path",{d:"M14.67 6v4.5c0 .55-.45 1-1 1h-3.33c-.55 0-1-.45-1-1V6c0-.55.45-1 1-1h3.33c.55 0 1 .45 1 1m2 5.5H20c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1h-3.33c-.55 0-1 .45-1 1v4.5c0 .55.44 1 1 1m-2 6.5v-4.5c0-.55-.45-1-1-1h-3.33c-.55 0-1 .45-1 1V18c0 .55.45 1 1 1h3.33c.55 0 1-.45 1-1m1-4.5V18c0 .55.45 1 1 1H20c.55 0 1-.45 1-1v-4.5c0-.55-.45-1-1-1h-3.33c-.56 0-1 .45-1 1m-8.34-1H4c-.55 0-1 .45-1 1V18c0 .55.45 1 1 1h3.33c.55 0 1-.45 1-1v-4.5c0-.55-.44-1-1-1m1-2V6c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v4.5c0 .55.45 1 1 1h3.33c.56 0 1-.45 1-1"}),"ViewModuleRounded"),uS=Io(y.jsx("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6m-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14M2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45zm7.5 7.5 2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13m-3.4-3.4 1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53"}),"VisibilityOffOutlined"),hS=Io(y.jsx("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7"}),"VisibilityOutlined"),wH=Io(y.jsx("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.78 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.26 4.25c.41.41 1.07.41 1.48 0l.01-.01c.41-.41.41-1.07 0-1.48zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14m0-7c-.28 0-.5.22-.5.5V9H7.5c-.28 0-.5.22-.5.5s.22.5.5.5H9v1.5c0 .28.22.5.5.5s.5-.22.5-.5V10h1.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5H10V7.5c0-.28-.22-.5-.5-.5"}),"ZoomInRounded"),SH=Io(y.jsx("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.26 4.25c.41.41 1.07.41 1.48 0l.01-.01c.41-.41.41-1.07 0-1.48zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14m-2-5h4c.28 0 .5.22.5.5s-.22.5-.5.5h-4c-.28 0-.5-.22-.5-.5s.22-.5.5-.5"}),"ZoomOutRounded");const bT=fe.createContext(null);function TH(e,n){return e===n}const fI={},uO=()=>{};function VC(e,n){const a=pn({},e);return Object.keys(n).forEach(u=>{n[u]!==void 0&&(a[u]=n[u])}),a}function EH(e){const{nextState:n,initialState:a,stateComparers:u,onStateChange:f,controlledProps:w,lastActionRef:p}=e,s=fe.useRef(a);fe.useEffect(()=>{if(p.current===null)return;const L=VC(s.current,w);Object.keys(n).forEach(F=>{var G;const H=(G=u[F])!=null?G:TH,X=n[F],ne=L[F];if(ne==null&&X!=null||ne!=null&&X==null||ne!=null&&X!=null&&!H(X,ne)){var ie,se;f==null||f((ie=p.current.event)!=null?ie:null,F,X,(se=p.current.type)!=null?se:"",n)}}),s.current=n,p.current=null},[s,n,p,f,u,w])}function W5(e){const n=fe.useRef(null),{reducer:a,initialState:u,controlledProps:f=fI,stateComparers:w=fI,onStateChange:p=uO,actionContext:s,componentName:L=""}=e;fe.useRef(f);const F=fe.useCallback((ne,ie)=>{n.current=ie;const se=VC(ne,f);return a(se,ie)},[f,a]),[G,H]=fe.useReducer(F,u),X=fe.useCallback(ne=>{H(pn({},ne,{context:s}))},[s]);return EH({nextState:G,initialState:u,stateComparers:w??fI,onStateChange:p??uO,controlledProps:f,lastActionRef:n}),[VC(G,f),X]}const Lp={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function IH(e,n){switch(n.type){case Lp.blur:return{open:!1};case Lp.escapeKeyDown:return{open:!1};case Lp.toggle:return{open:!e.open};case Lp.open:return{open:!0};case Lp.close:return{open:!1};default:throw new Error("Unhandled action")}}function CH(e={}){const{defaultOpen:n,onOpenChange:a,open:u,componentName:f="useDropdown"}=e,[w,p]=fe.useState(""),[s,L]=fe.useState(null),F=fe.useRef(null),G=fe.useCallback((se,Te,ue,ce)=>{Te==="open"&&(a==null||a(se,ue)),F.current=ce},[a]),H=fe.useMemo(()=>u!==void 0?{open:u}:{},[u]),[X,ne]=W5({controlledProps:H,initialState:n?{open:!0}:{open:!1},onStateChange:G,reducer:IH,componentName:f});return fe.useEffect(()=>{!X.open&&F.current!==null&&F.current!==Lp.blur&&(s==null||s.focus())},[X.open,s]),{contextValue:{state:X,dispatch:ne,popupId:w,registerPopup:p,registerTrigger:L,triggerElement:s},open:X.open}}function H5(e){const{children:n,open:a,defaultOpen:u,onOpenChange:f}=e,{contextValue:w}=CH({defaultOpen:u,onOpenChange:f,open:a});return y.jsx(bT.Provider,{value:w,children:n})}function AH(e){return typeof e=="string"}function PH(e,n,a){return e===void 0||AH(e)?n:pn({},n,{ownerState:pn({},n.ownerState,a)})}function hO(e,n,a=(u,f)=>u===f){return e.length===n.length&&e.every((u,f)=>a(u,n[f]))}const MH={disableDefaultClasses:!1},kH=fe.createContext(MH);function wT(e){const{disableDefaultClasses:n}=fe.useContext(kH);return a=>n?"":e(a)}function u_(e,n=[]){if(e===void 0)return{};const a={};return Object.keys(e).filter(u=>u.match(/^on[A-Z]/)&&typeof e[u]=="function"&&!n.includes(u)).forEach(u=>{a[u]=e[u]}),a}function RH(e,n,a){return typeof e=="function"?e(n,a):e}function dO(e){if(e===void 0)return{};const n={};return Object.keys(e).filter(a=>!(a.match(/^on[A-Z]/)&&typeof e[a]=="function")).forEach(a=>{n[a]=e[a]}),n}function DH(e){const{getSlotProps:n,additionalProps:a,externalSlotProps:u,externalForwardedProps:f,className:w}=e;if(!n){const ne=$1(a==null?void 0:a.className,w,f==null?void 0:f.className,u==null?void 0:u.className),ie=pn({},a==null?void 0:a.style,f==null?void 0:f.style,u==null?void 0:u.style),se=pn({},a,f,u);return ne.length>0&&(se.className=ne),Object.keys(ie).length>0&&(se.style=ie),{props:se,internalRef:void 0}}const p=u_(pn({},f,u)),s=dO(u),L=dO(f),F=n(p),G=$1(F==null?void 0:F.className,a==null?void 0:a.className,w,f==null?void 0:f.className,u==null?void 0:u.className),H=pn({},F==null?void 0:F.style,a==null?void 0:a.style,f==null?void 0:f.style,u==null?void 0:u.style),X=pn({},F,a,L,s);return G.length>0&&(X.className=G),Object.keys(H).length>0&&(X.style=H),{props:X,internalRef:F.ref}}const OH=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Z1(e){var n;const{elementType:a,externalSlotProps:u,ownerState:f,skipResolvingSlotProps:w=!1}=e,p=cc(e,OH),s=w?{}:RH(u,f),{props:L,internalRef:F}=DH(pn({},p,{externalSlotProps:s})),G=kf(F,s==null?void 0:s.ref,(n=e.additionalProps)==null?void 0:n.ref);return PH(a,pn({},L,{ref:G}),f)}function Z5(e={}){const{disabled:n=!1,focusableWhenDisabled:a,href:u,rootRef:f,tabIndex:w,to:p,type:s}=e,L=fe.useRef(),[F,G]=fe.useState(!1),{isFocusVisibleRef:H,onFocus:X,onBlur:ne,ref:ie}=iG(),[se,Te]=fe.useState(!1);n&&!a&&se&&Te(!1),fe.useEffect(()=>{H.current=se},[se,H]);const[ue,ce]=fe.useState(""),de=nr=>Xt=>{var Ht;se&&Xt.preventDefault(),(Ht=nr.onMouseLeave)==null||Ht.call(nr,Xt)},Ee=nr=>Xt=>{var Ht;ne(Xt),H.current===!1&&Te(!1),(Ht=nr.onBlur)==null||Ht.call(nr,Xt)},Ne=nr=>Xt=>{var Ht;if(L.current||(L.current=Xt.currentTarget),X(Xt),H.current===!0){var Qt;Te(!0),(Qt=nr.onFocusVisible)==null||Qt.call(nr,Xt)}(Ht=nr.onFocus)==null||Ht.call(nr,Xt)},rt=()=>{const nr=L.current;return ue==="BUTTON"||ue==="INPUT"&&["button","submit","reset"].includes(nr==null?void 0:nr.type)||ue==="A"&&(nr==null?void 0:nr.href)},tt=nr=>Xt=>{if(!n){var Ht;(Ht=nr.onClick)==null||Ht.call(nr,Xt)}},Ge=nr=>Xt=>{var Ht;n||(G(!0),document.addEventListener("mouseup",()=>{G(!1)},{once:!0})),(Ht=nr.onMouseDown)==null||Ht.call(nr,Xt)},_t=nr=>Xt=>{var Ht;if((Ht=nr.onKeyDown)==null||Ht.call(nr,Xt),!Xt.defaultMuiPrevented&&(Xt.target===Xt.currentTarget&&!rt()&&Xt.key===" "&&Xt.preventDefault(),Xt.target===Xt.currentTarget&&Xt.key===" "&&!n&&G(!0),Xt.target===Xt.currentTarget&&!rt()&&Xt.key==="Enter"&&!n)){var Qt;(Qt=nr.onClick)==null||Qt.call(nr,Xt),Xt.preventDefault()}},yt=nr=>Xt=>{var Ht;if(Xt.target===Xt.currentTarget&&G(!1),(Ht=nr.onKeyUp)==null||Ht.call(nr,Xt),Xt.target===Xt.currentTarget&&!rt()&&!n&&Xt.key===" "&&!Xt.defaultMuiPrevented){var Qt;(Qt=nr.onClick)==null||Qt.call(nr,Xt)}},Et=fe.useCallback(nr=>{var Xt;ce((Xt=nr==null?void 0:nr.tagName)!=null?Xt:"")},[]),Wt=kf(Et,f,ie,L),Ar={};return w!==void 0&&(Ar.tabIndex=w),ue==="BUTTON"?(Ar.type=s??"button",a?Ar["aria-disabled"]=n:Ar.disabled=n):ue!==""&&(!u&&!p&&(Ar.role="button",Ar.tabIndex=w??0),n&&(Ar["aria-disabled"]=n,Ar.tabIndex=a?w??0:-1)),{getRootProps:(nr={})=>{const Xt=pn({},u_(e),u_(nr)),Ht=pn({type:s},Xt,Ar,nr,{onBlur:Ee(Xt),onClick:tt(Xt),onFocus:Ne(Xt),onKeyDown:_t(Xt),onKeyUp:yt(Xt),onMouseDown:Ge(Xt),onMouseLeave:de(Xt),ref:Wt});return delete Ht.onFocusVisible,Ht},focusVisible:se,setFocusVisible:Te,active:F,rootRef:Wt}}function dS(e,n){return function(u={}){const f=pn({},u,e(u));return pn({},f,n(f))}}function LH(e={}){const{disabled:n=!1,focusableWhenDisabled:a,rootRef:u}=e,f=fe.useContext(bT);if(f===null)throw new Error("useMenuButton: no menu context available.");const{state:w,dispatch:p,registerTrigger:s,popupId:L}=f,{getRootProps:F,rootRef:G,active:H}=Z5({disabled:n,focusableWhenDisabled:a,rootRef:u}),X=kf(G,s),ne=ue=>ce=>{var de;(de=ue.onClick)==null||de.call(ue,ce),!ce.defaultMuiPrevented&&p({type:Lp.toggle,event:ce})},ie=ue=>ce=>{var de;(de=ue.onKeyDown)==null||de.call(ue,ce),!ce.defaultMuiPrevented&&(ce.key==="ArrowDown"||ce.key==="ArrowUp")&&(ce.preventDefault(),p({type:Lp.open,event:ce}))},se=(ue={})=>({onClick:ne(ue),onKeyDown:ie(ue)});return{active:H,getRootProps:(ue={})=>{const ce=u_(ue),de=dS(se,F);return pn({"aria-haspopup":"menu","aria-expanded":w.open,"aria-controls":L},ue,ce,de(ce),{tabIndex:0,ref:X})},open:w.open,rootRef:X}}const X5="base";function zH(e){return`${X5}--${e}`}function NH(e,n){return`${X5}-${e}-${n}`}function mb(e,n){const a=u5[n];return a?zH(a):NH(e,n)}function ST(e,n){const a={};return n.forEach(u=>{a[u]=mb(e,u)}),a}const Y5="MenuButton";function jH(e){return mb(Y5,e)}ST(Y5,["root","active","disabled","expanded"]);const BH=["children","disabled","label","slots","slotProps","focusableWhenDisabled"],FH=e=>{const{active:n,disabled:a,open:u}=e;return Py({root:["root",a&&"disabled",n&&"active",u&&"expanded"]},wT(jH))},K5=fe.forwardRef(function(n,a){const{children:u,disabled:f=!1,slots:w={},slotProps:p={},focusableWhenDisabled:s=!1}=n,L=cc(n,BH),{getRootProps:F,open:G,active:H}=LH({disabled:f,focusableWhenDisabled:s,rootRef:a}),X=pn({},n,{open:G,active:H,disabled:f,focusableWhenDisabled:s}),ne=FH(X),ie=w.root||"button",se=Z1({elementType:ie,getSlotProps:F,externalForwardedProps:L,externalSlotProps:p.root,additionalProps:{ref:a,type:"button"},ownerState:X,className:ne.root});return y.jsx(ie,pn({},se,{children:u}))}),J5="Menu";function VH(e){return mb(J5,e)}ST(J5,["root","listbox","expanded"]);const Cl={blur:"list:blur",focus:"list:focus",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function UH(e,n,a,u,f,w){if(a.length===0||!u&&a.every((s,L)=>f(s,L)))return-1;let p=e;for(;;){if(!w&&n==="next"&&p===a.length||!w&&n==="previous"&&p===-1)return-1;if(u?!1:f(a[p],p))p+=n==="next"?1:-1,w&&(p=(p+a.length)%a.length);else return p}}function Vh(e,n,a){var u;const{items:f,isItemDisabled:w,disableListWrap:p,disabledItemsFocusable:s,itemComparer:L,focusManagement:F}=a,G=F==="DOM"?0:-1,H=f.length-1,X=e==null?-1:f.findIndex(ue=>L(ue,e));let ne,ie,se=!p;switch(n){case"reset":if(G===-1)return null;ne=0,ie="next",se=!1;break;case"start":ne=0,ie="next",se=!1;break;case"end":ne=H,ie="previous",se=!1;break;default:{const ue=X+n;ue<0?!se&&X!==-1||Math.abs(n)>1?(ne=0,ie="next"):(ne=H,ie="previous"):ue>H?!se||Math.abs(n)>1?(ne=H,ie="previous"):(ne=0,ie="next"):(ne=ue,ie=n>=0?"next":"previous")}}const Te=UH(ne,ie,f,s,w,se);return Te===-1&&e!==null&&!w(e,X)?e:(u=f[Te])!=null?u:null}function $H(e,n,a,u){return a==="none"?[]:a==="single"?u(n[0],e)?n:[e]:n.some(f=>u(f,e))?n.filter(f=>!u(f,e)):[...n,e]}function Q5(e,n,a){const{itemComparer:u,isItemDisabled:f,selectionMode:w,items:p}=a,{selectedValues:s}=n,L=p.findIndex(G=>u(e,G));if(f(e,L))return n;const F=$H(e,s,w,u);return pn({},n,{selectedValues:F,highlightedValue:e})}function GH(e,n,a){const u=n.highlightedValue,{orientation:f,pageSize:w}=a;switch(e){case"Home":return pn({},n,{highlightedValue:Vh(u,"start",a)});case"End":return pn({},n,{highlightedValue:Vh(u,"end",a)});case"PageUp":return pn({},n,{highlightedValue:Vh(u,-w,a)});case"PageDown":return pn({},n,{highlightedValue:Vh(u,w,a)});case"ArrowUp":if(f!=="vertical")break;return pn({},n,{highlightedValue:Vh(u,-1,a)});case"ArrowDown":if(f!=="vertical")break;return pn({},n,{highlightedValue:Vh(u,1,a)});case"ArrowLeft":{if(f==="vertical")break;return pn({},n,{highlightedValue:Vh(u,f==="horizontal-ltr"?-1:1,a)})}case"ArrowRight":{if(f==="vertical")break;return pn({},n,{highlightedValue:Vh(u,f==="horizontal-ltr"?1:-1,a)})}case"Enter":case" ":return n.highlightedValue===null?n:Q5(n.highlightedValue,n,a)}return n}function qH(e,n){return n.focusManagement==="DOM"?e:pn({},e,{highlightedValue:null})}function WH(e,n,a){var u;const f=(u=a(e))==null?void 0:u.trim().toLowerCase();return!f||f.length===0?!1:f.indexOf(n)===0}function HH(e,n,a){const{items:u,isItemDisabled:f,disabledItemsFocusable:w,getItemAsString:p}=a,s=n.length>1;let L=s?e.highlightedValue:Vh(e.highlightedValue,1,a);for(let F=0;F<u.length;F+=1){if(!L||!s&&e.highlightedValue===L)return e;if(WH(L,n,p)&&(!f(L,u.indexOf(L))||w))return pn({},e,{highlightedValue:L});L=Vh(L,1,a)}return e}function ZH(e,n,a,u){var f;const{itemComparer:w,focusManagement:p}=u;let s=null;if(a.highlightedValue!=null){var L;s=(L=e.find(H=>w(H,a.highlightedValue)))!=null?L:null}else p==="DOM"&&n.length===0&&(s=Vh(null,"reset",u));const G=((f=a.selectedValues)!=null?f:[]).filter(H=>e.some(X=>w(X,H)));return pn({},a,{highlightedValue:s,selectedValues:G})}function XH(e,n){return pn({},e,{highlightedValue:Vh(null,"reset",n)})}function YH(e,n){return pn({},e,{selectedValues:[],highlightedValue:Vh(null,"reset",n)})}function e4(e,n){const{type:a,context:u}=n;switch(a){case Cl.keyDown:return GH(n.key,e,u);case Cl.itemClick:return Q5(n.item,e,u);case Cl.blur:return qH(e,u);case Cl.textNavigation:return HH(e,n.searchString,u);case Cl.itemsChange:return ZH(n.items,n.previousItems,e,u);case Cl.resetHighlight:return XH(e,u);case Cl.clearSelection:return YH(e,u);default:return e}}const KH=500;function JH(e){const n=fe.useRef({searchString:"",lastTime:null});return fe.useCallback(a=>{if(a.key.length===1&&a.key!==" "){const u=n.current,f=a.key.toLowerCase(),w=performance.now();u.searchString.length>0&&u.lastTime&&w-u.lastTime>KH?u.searchString=f:(u.searchString.length!==1||f!==u.searchString)&&(u.searchString+=f),u.lastTime=w,e(u.searchString,a)}},[e])}const pO={},QH=()=>{},eZ=(e,n)=>e===n,tZ=()=>!1,rZ=e=>typeof e=="string"?e:String(e),nZ=()=>({highlightedValue:null,selectedValues:[]});function iZ(e){const{controlledProps:n=pO,disabledItemsFocusable:a=!1,disableListWrap:u=!1,focusManagement:f="activeDescendant",getInitialState:w=nZ,getItemDomElement:p,getItemId:s,isItemDisabled:L=tZ,rootRef:F,onStateChange:G=QH,items:H,itemComparer:X=eZ,getItemAsString:ne=rZ,onChange:ie,onHighlightChange:se,onItemsChange:Te,orientation:ue="vertical",pageSize:ce=5,reducerActionContext:de=pO,selectionMode:Ee="single",stateReducer:Ne,componentName:rt="useList"}=e,tt=fe.useRef(null),Ge=kf(F,tt),_t=fe.useCallback((fn,Nn,Pt)=>{if(se==null||se(fn,Nn,Pt),f==="DOM"&&Nn!=null&&(Pt===Cl.itemClick||Pt===Cl.keyDown||Pt===Cl.textNavigation)){var Dt;p==null||(Dt=p(Nn))==null||Dt.focus()}},[p,se,f]),yt=fe.useMemo(()=>({highlightedValue:X,selectedValues:(fn,Nn)=>hO(fn,Nn,X)}),[X]),Et=fe.useCallback((fn,Nn,Pt,Dt,Ir)=>{switch(G==null||G(fn,Nn,Pt,Dt,Ir),Nn){case"highlightedValue":_t(fn,Pt,Dt);break;case"selectedValues":ie==null||ie(fn,Pt,Dt);break}},[_t,ie,G]),Wt=fe.useMemo(()=>({disabledItemsFocusable:a,disableListWrap:u,focusManagement:f,isItemDisabled:L,itemComparer:X,items:H,getItemAsString:ne,onHighlightChange:_t,orientation:ue,pageSize:ce,selectionMode:Ee,stateComparers:yt}),[a,u,f,L,X,H,ne,_t,ue,ce,Ee,yt]),Ar=w(),mt=Ne??e4,nr=fe.useMemo(()=>pn({},de,Wt),[de,Wt]),[Xt,Ht]=W5({reducer:mt,actionContext:nr,initialState:Ar,controlledProps:n,stateComparers:yt,onStateChange:Et,componentName:rt}),{highlightedValue:Qt,selectedValues:sr}=Xt,Tr=JH((fn,Nn)=>Ht({type:Cl.textNavigation,event:Nn,searchString:fn})),ln=fe.useRef([]);fe.useEffect(()=>{hO(ln.current,H,X)||(Ht({type:Cl.itemsChange,event:null,items:H,previousItems:ln.current}),ln.current=H,Te==null||Te(H))},[H,X,Ht,Te]);const vn=fn=>Nn=>{var Pt;if((Pt=fn.onKeyDown)==null||Pt.call(fn,Nn),Nn.defaultMuiPrevented)return;const Dt=["Home","End","PageUp","PageDown"];ue==="vertical"?Dt.push("ArrowUp","ArrowDown"):Dt.push("ArrowLeft","ArrowRight"),f==="activeDescendant"&&Dt.push(" ","Enter"),Dt.includes(Nn.key)&&Nn.preventDefault(),Ht({type:Cl.keyDown,key:Nn.key,event:Nn}),Tr(Nn)},wi=fn=>Nn=>{var Pt,Dt;(Pt=fn.onBlur)==null||Pt.call(fn,Nn),!Nn.defaultMuiPrevented&&((Dt=tt.current)!=null&&Dt.contains(Nn.relatedTarget)||Ht({type:Cl.blur,event:Nn}))},hi=(fn={})=>{const Nn=u_(fn);return pn({},fn,{"aria-activedescendant":f==="activeDescendant"&&Qt!=null?s(Qt):void 0,tabIndex:f==="DOM"?-1:0,ref:Ge},Nn,{onBlur:wi(Nn),onKeyDown:vn(Nn)})},Vn=fe.useCallback(fn=>{const Nn=(sr??[]).some(Ir=>Ir!=null&&X(fn,Ir)),Pt=Qt!=null&&X(fn,Qt);return{focusable:f==="DOM",highlighted:Pt,selected:Nn}},[X,sr,Qt,f]),Oi=fe.useMemo(()=>({dispatch:Ht,getItemState:Vn}),[Ht,Vn]);return fe.useDebugValue({state:Xt}),{contextValue:Oi,dispatch:Ht,getRootProps:hi,rootRef:Ge,state:Xt}}const TT=fe.createContext(null);function oZ(e){const{handlePointerOverEvents:n=!1,item:a}=e,u=fe.useContext(TT);if(!u)throw new Error("useListItem must be used within a ListProvider");const{dispatch:f,getItemState:w}=u,{highlighted:p,selected:s,focusable:L}=w(a),F=fe.useCallback(ne=>ie=>{var se;(se=ne.onClick)==null||se.call(ne,ie),!ie.defaultPrevented&&f({type:Cl.itemClick,item:a,event:ie})},[f,a]),G=fe.useCallback(ne=>ie=>{var se;(se=ne.onMouseOver)==null||se.call(ne,ie),!ie.defaultPrevented&&f({type:Cl.itemHover,item:a,event:ie})},[f,a]);let H;return L&&(H=p?0:-1),{getRootProps:(ne={})=>{const ie=u_(ne);return pn({},ne,{onClick:F(ie),onPointerOver:n?G(ie):void 0,tabIndex:H})},highlighted:p,selected:s}}function aZ(e,n){if(n.type===Cl.itemHover)return e;const a=e4(e,n);if(a.highlightedValue===null&&n.context.items.length>0)return pn({},a,{highlightedValue:n.context.items[0]});if(n.type===Cl.keyDown&&n.event.key==="Escape")return pn({},a,{open:!1});if(n.type===Cl.blur){var u;if(!((u=n.context.listboxRef.current)!=null&&u.contains(n.event.relatedTarget))){var f,w;const p=(f=n.context.listboxRef.current)==null?void 0:f.getAttribute("id"),s=(w=n.event.relatedTarget)==null?void 0:w.getAttribute("aria-controls");return p&&s&&p===s?a:pn({},a,{open:!1,highlightedValue:n.context.items[0]})}}return a}const aM=fe.createContext(null);aM.displayName="CompoundComponentContext";function sZ(e){const n=Array.from(e.keys()).map(a=>{const u=e.get(a);return{key:a,subitem:u}});return n.sort((a,u)=>{const f=a.subitem.ref.current,w=u.subitem.ref.current;return f===null||w===null||f===w?0:f.compareDocumentPosition(w)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(n.map(a=>[a.key,a.subitem]))}function lZ(){const[e,n]=fe.useState(new Map),a=fe.useRef(new Set),u=fe.useCallback(function(F){a.current.delete(F),n(G=>{const H=new Map(G);return H.delete(F),H})},[]),f=fe.useCallback(function(F,G){let H;return typeof F=="function"?H=F(a.current):H=F,a.current.add(H),n(X=>{const ne=new Map(X);return ne.set(H,G),ne}),{id:H,deregister:()=>u(H)}},[u]),w=fe.useMemo(()=>sZ(e),[e]),p=fe.useCallback(function(F){return Array.from(w.keys()).indexOf(F)},[w]);return{contextValue:fe.useMemo(()=>({getItemIndex:p,registerItem:f,totalSubitemCount:e.size}),[p,f,e.size]),subitems:w}}function cZ(e,n){const a=fe.useContext(aM);if(a===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:u}=a,[f,w]=fe.useState(typeof e=="function"?void 0:e);return wy(()=>{const{id:p,deregister:s}=u(e,n);return w(p),s},[u,n,e]),{id:f,index:f!==void 0?a.getItemIndex(f):-1,totalItemCount:a.totalSubitemCount}}const uZ={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0},triggerElement:null};function hZ(e={}){var n,a;const{listboxRef:u,onItemsChange:f,id:w,disabledItemsFocusable:p=!0,disableListWrap:s=!1,autoFocus:L=!0,componentName:F="useMenu"}=e,G=fe.useRef(null),H=kf(G,u),X=(n=VP(w))!=null?n:"",{state:{open:ne},dispatch:ie,triggerElement:se,registerPopup:Te}=(a=fe.useContext(bT))!=null?a:uZ,ue=fe.useRef(ne),{subitems:ce,contextValue:de}=lZ(),Ee=fe.useMemo(()=>Array.from(ce.keys()),[ce]),Ne=fe.useCallback(Qt=>{var sr,Tr;return Qt==null?null:(sr=(Tr=ce.get(Qt))==null?void 0:Tr.ref.current)!=null?sr:null},[ce]),rt=fe.useCallback(Qt=>{var sr;return(ce==null||(sr=ce.get(Qt))==null?void 0:sr.disabled)||!1},[ce]),tt=fe.useCallback(Qt=>{var sr,Tr;return((sr=ce.get(Qt))==null?void 0:sr.label)||((Tr=ce.get(Qt))==null||(Tr=Tr.ref.current)==null?void 0:Tr.innerText)},[ce]),Ge=fe.useMemo(()=>({listboxRef:G}),[G]),{dispatch:_t,getRootProps:yt,contextValue:Et,state:{highlightedValue:Wt},rootRef:Ar}=iZ({disabledItemsFocusable:p,disableListWrap:s,focusManagement:"DOM",getItemDomElement:Ne,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:rt,items:Ee,getItemAsString:tt,rootRef:H,onItemsChange:f,reducerActionContext:Ge,selectionMode:"none",stateReducer:aZ,componentName:F});wy(()=>{Te(X)},[X,Te]),fe.useEffect(()=>{if(ne&&L&&Wt&&!ue.current){var Qt;(Qt=ce.get(Wt))==null||(Qt=Qt.ref)==null||(Qt=Qt.current)==null||Qt.focus()}},[ne,L,Wt,ce,Ee]),fe.useEffect(()=>{var Qt;if((Qt=G.current)!=null&&Qt.contains(document.activeElement)&&Wt!==null){var sr;ce==null||(sr=ce.get(Wt))==null||(sr=sr.ref.current)==null||sr.focus()}},[Wt,ce]);const mt=Qt=>sr=>{var Tr,ln;(Tr=Qt.onBlur)==null||Tr.call(Qt,sr),!sr.defaultMuiPrevented&&((ln=G.current)!=null&&ln.contains(sr.relatedTarget)||sr.relatedTarget===se||ie({type:Lp.blur,event:sr}))},nr=Qt=>sr=>{var Tr;(Tr=Qt.onKeyDown)==null||Tr.call(Qt,sr),!sr.defaultMuiPrevented&&sr.key==="Escape"&&ie({type:Lp.escapeKeyDown,event:sr})},Xt=(Qt={})=>({onBlur:mt(Qt),onKeyDown:nr(Qt)}),Ht=(Qt={})=>{const sr=dS(Xt,yt),Tr=u_(Qt);return pn({},Qt,Tr,sr(Tr),{id:X,role:"menu"})};return fe.useDebugValue({subitems:ce,highlightedValue:Wt}),{contextValue:pn({},de,Et),dispatch:_t,getListboxProps:Ht,highlightedValue:Wt,listboxRef:Ar,menuItems:ce,open:ne,triggerElement:se}}function fO(e){const{value:n,children:a}=e,{dispatch:u,getItemIndex:f,getItemState:w,registerItem:p,totalSubitemCount:s}=n,L=fe.useMemo(()=>({dispatch:u,getItemState:w,getItemIndex:f}),[u,f,w]),F=fe.useMemo(()=>({getItemIndex:f,registerItem:p,totalSubitemCount:s}),[p,f,s]);return y.jsx(aM.Provider,{value:F,children:y.jsx(TT.Provider,{value:L,children:a})})}var gh="top",Jd="bottom",Qd="right",_h="left",sM="auto",gb=[gh,Jd,Qd,_h],m0="start",X1="end",dZ="clippingParents",t4="viewport",qx="popper",pZ="reference",mO=gb.reduce(function(e,n){return e.concat([n+"-"+m0,n+"-"+X1])},[]),r4=[].concat(gb,[sM]).reduce(function(e,n){return e.concat([n,n+"-"+m0,n+"-"+X1])},[]),fZ="beforeRead",mZ="read",gZ="afterRead",_Z="beforeMain",yZ="main",vZ="afterMain",xZ="beforeWrite",bZ="write",wZ="afterWrite",SZ=[fZ,mZ,gZ,_Z,yZ,vZ,xZ,bZ,wZ];function Rf(e){return e?(e.nodeName||"").toLowerCase():null}function Xh(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var n=e.ownerDocument;return n&&n.defaultView||window}return e}function Sy(e){var n=Xh(e).Element;return e instanceof n||e instanceof Element}function Wd(e){var n=Xh(e).HTMLElement;return e instanceof n||e instanceof HTMLElement}function lM(e){if(typeof ShadowRoot>"u")return!1;var n=Xh(e).ShadowRoot;return e instanceof n||e instanceof ShadowRoot}function TZ(e){var n=e.state;Object.keys(n.elements).forEach(function(a){var u=n.styles[a]||{},f=n.attributes[a]||{},w=n.elements[a];!Wd(w)||!Rf(w)||(Object.assign(w.style,u),Object.keys(f).forEach(function(p){var s=f[p];s===!1?w.removeAttribute(p):w.setAttribute(p,s===!0?"":s)}))})}function EZ(e){var n=e.state,a={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,a.popper),n.styles=a,n.elements.arrow&&Object.assign(n.elements.arrow.style,a.arrow),function(){Object.keys(n.elements).forEach(function(u){var f=n.elements[u],w=n.attributes[u]||{},p=Object.keys(n.styles.hasOwnProperty(u)?n.styles[u]:a[u]),s=p.reduce(function(L,F){return L[F]="",L},{});!Wd(f)||!Rf(f)||(Object.assign(f.style,s),Object.keys(w).forEach(function(L){f.removeAttribute(L)}))})}}const IZ={name:"applyStyles",enabled:!0,phase:"write",fn:TZ,effect:EZ,requires:["computeStyles"]};function Pf(e){return e.split("-")[0]}var my=Math.max,pS=Math.min,g0=Math.round;function UC(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function n4(){return!/^((?!chrome|android).)*safari/i.test(UC())}function _0(e,n,a){n===void 0&&(n=!1),a===void 0&&(a=!1);var u=e.getBoundingClientRect(),f=1,w=1;n&&Wd(e)&&(f=e.offsetWidth>0&&g0(u.width)/e.offsetWidth||1,w=e.offsetHeight>0&&g0(u.height)/e.offsetHeight||1);var p=Sy(e)?Xh(e):window,s=p.visualViewport,L=!n4()&&a,F=(u.left+(L&&s?s.offsetLeft:0))/f,G=(u.top+(L&&s?s.offsetTop:0))/w,H=u.width/f,X=u.height/w;return{width:H,height:X,top:G,right:F+H,bottom:G+X,left:F,x:F,y:G}}function cM(e){var n=_0(e),a=e.offsetWidth,u=e.offsetHeight;return Math.abs(n.width-a)<=1&&(a=n.width),Math.abs(n.height-u)<=1&&(u=n.height),{x:e.offsetLeft,y:e.offsetTop,width:a,height:u}}function i4(e,n){var a=n.getRootNode&&n.getRootNode();if(e.contains(n))return!0;if(a&&lM(a)){var u=n;do{if(u&&e.isSameNode(u))return!0;u=u.parentNode||u.host}while(u)}return!1}function Dm(e){return Xh(e).getComputedStyle(e)}function CZ(e){return["table","td","th"].indexOf(Rf(e))>=0}function x_(e){return((Sy(e)?e.ownerDocument:e.document)||window.document).documentElement}function ET(e){return Rf(e)==="html"?e:e.assignedSlot||e.parentNode||(lM(e)?e.host:null)||x_(e)}function gO(e){return!Wd(e)||Dm(e).position==="fixed"?null:e.offsetParent}function AZ(e){var n=/firefox/i.test(UC()),a=/Trident/i.test(UC());if(a&&Wd(e)){var u=Dm(e);if(u.position==="fixed")return null}var f=ET(e);for(lM(f)&&(f=f.host);Wd(f)&&["html","body"].indexOf(Rf(f))<0;){var w=Dm(f);if(w.transform!=="none"||w.perspective!=="none"||w.contain==="paint"||["transform","perspective"].indexOf(w.willChange)!==-1||n&&w.willChange==="filter"||n&&w.filter&&w.filter!=="none")return f;f=f.parentNode}return null}function _b(e){for(var n=Xh(e),a=gO(e);a&&CZ(a)&&Dm(a).position==="static";)a=gO(a);return a&&(Rf(a)==="html"||Rf(a)==="body"&&Dm(a).position==="static")?n:a||AZ(e)||n}function uM(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function _1(e,n,a){return my(e,pS(n,a))}function PZ(e,n,a){var u=_1(e,n,a);return u>a?a:u}function o4(){return{top:0,right:0,bottom:0,left:0}}function a4(e){return Object.assign({},o4(),e)}function s4(e,n){return n.reduce(function(a,u){return a[u]=e,a},{})}var MZ=function(n,a){return n=typeof n=="function"?n(Object.assign({},a.rects,{placement:a.placement})):n,a4(typeof n!="number"?n:s4(n,gb))};function kZ(e){var n,a=e.state,u=e.name,f=e.options,w=a.elements.arrow,p=a.modifiersData.popperOffsets,s=Pf(a.placement),L=uM(s),F=[_h,Qd].indexOf(s)>=0,G=F?"height":"width";if(!(!w||!p)){var H=MZ(f.padding,a),X=cM(w),ne=L==="y"?gh:_h,ie=L==="y"?Jd:Qd,se=a.rects.reference[G]+a.rects.reference[L]-p[L]-a.rects.popper[G],Te=p[L]-a.rects.reference[L],ue=_b(w),ce=ue?L==="y"?ue.clientHeight||0:ue.clientWidth||0:0,de=se/2-Te/2,Ee=H[ne],Ne=ce-X[G]-H[ie],rt=ce/2-X[G]/2+de,tt=_1(Ee,rt,Ne),Ge=L;a.modifiersData[u]=(n={},n[Ge]=tt,n.centerOffset=tt-rt,n)}}function RZ(e){var n=e.state,a=e.options,u=a.element,f=u===void 0?"[data-popper-arrow]":u;f!=null&&(typeof f=="string"&&(f=n.elements.popper.querySelector(f),!f)||i4(n.elements.popper,f)&&(n.elements.arrow=f))}const DZ={name:"arrow",enabled:!0,phase:"main",fn:kZ,effect:RZ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function y0(e){return e.split("-")[1]}var OZ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function LZ(e,n){var a=e.x,u=e.y,f=n.devicePixelRatio||1;return{x:g0(a*f)/f||0,y:g0(u*f)/f||0}}function _O(e){var n,a=e.popper,u=e.popperRect,f=e.placement,w=e.variation,p=e.offsets,s=e.position,L=e.gpuAcceleration,F=e.adaptive,G=e.roundOffsets,H=e.isFixed,X=p.x,ne=X===void 0?0:X,ie=p.y,se=ie===void 0?0:ie,Te=typeof G=="function"?G({x:ne,y:se}):{x:ne,y:se};ne=Te.x,se=Te.y;var ue=p.hasOwnProperty("x"),ce=p.hasOwnProperty("y"),de=_h,Ee=gh,Ne=window;if(F){var rt=_b(a),tt="clientHeight",Ge="clientWidth";if(rt===Xh(a)&&(rt=x_(a),Dm(rt).position!=="static"&&s==="absolute"&&(tt="scrollHeight",Ge="scrollWidth")),rt=rt,f===gh||(f===_h||f===Qd)&&w===X1){Ee=Jd;var _t=H&&rt===Ne&&Ne.visualViewport?Ne.visualViewport.height:rt[tt];se-=_t-u.height,se*=L?1:-1}if(f===_h||(f===gh||f===Jd)&&w===X1){de=Qd;var yt=H&&rt===Ne&&Ne.visualViewport?Ne.visualViewport.width:rt[Ge];ne-=yt-u.width,ne*=L?1:-1}}var Et=Object.assign({position:s},F&&OZ),Wt=G===!0?LZ({x:ne,y:se},Xh(a)):{x:ne,y:se};if(ne=Wt.x,se=Wt.y,L){var Ar;return Object.assign({},Et,(Ar={},Ar[Ee]=ce?"0":"",Ar[de]=ue?"0":"",Ar.transform=(Ne.devicePixelRatio||1)<=1?"translate("+ne+"px, "+se+"px)":"translate3d("+ne+"px, "+se+"px, 0)",Ar))}return Object.assign({},Et,(n={},n[Ee]=ce?se+"px":"",n[de]=ue?ne+"px":"",n.transform="",n))}function zZ(e){var n=e.state,a=e.options,u=a.gpuAcceleration,f=u===void 0?!0:u,w=a.adaptive,p=w===void 0?!0:w,s=a.roundOffsets,L=s===void 0?!0:s,F={placement:Pf(n.placement),variation:y0(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:f,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,_O(Object.assign({},F,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:p,roundOffsets:L})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,_O(Object.assign({},F,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:L})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const NZ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:zZ,data:{}};var Fw={passive:!0};function jZ(e){var n=e.state,a=e.instance,u=e.options,f=u.scroll,w=f===void 0?!0:f,p=u.resize,s=p===void 0?!0:p,L=Xh(n.elements.popper),F=[].concat(n.scrollParents.reference,n.scrollParents.popper);return w&&F.forEach(function(G){G.addEventListener("scroll",a.update,Fw)}),s&&L.addEventListener("resize",a.update,Fw),function(){w&&F.forEach(function(G){G.removeEventListener("scroll",a.update,Fw)}),s&&L.removeEventListener("resize",a.update,Fw)}}const BZ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:jZ,data:{}};var FZ={left:"right",right:"left",bottom:"top",top:"bottom"};function f2(e){return e.replace(/left|right|bottom|top/g,function(n){return FZ[n]})}var VZ={start:"end",end:"start"};function yO(e){return e.replace(/start|end/g,function(n){return VZ[n]})}function hM(e){var n=Xh(e),a=n.pageXOffset,u=n.pageYOffset;return{scrollLeft:a,scrollTop:u}}function dM(e){return _0(x_(e)).left+hM(e).scrollLeft}function UZ(e,n){var a=Xh(e),u=x_(e),f=a.visualViewport,w=u.clientWidth,p=u.clientHeight,s=0,L=0;if(f){w=f.width,p=f.height;var F=n4();(F||!F&&n==="fixed")&&(s=f.offsetLeft,L=f.offsetTop)}return{width:w,height:p,x:s+dM(e),y:L}}function $Z(e){var n,a=x_(e),u=hM(e),f=(n=e.ownerDocument)==null?void 0:n.body,w=my(a.scrollWidth,a.clientWidth,f?f.scrollWidth:0,f?f.clientWidth:0),p=my(a.scrollHeight,a.clientHeight,f?f.scrollHeight:0,f?f.clientHeight:0),s=-u.scrollLeft+dM(e),L=-u.scrollTop;return Dm(f||a).direction==="rtl"&&(s+=my(a.clientWidth,f?f.clientWidth:0)-w),{width:w,height:p,x:s,y:L}}function pM(e){var n=Dm(e),a=n.overflow,u=n.overflowX,f=n.overflowY;return/auto|scroll|overlay|hidden/.test(a+f+u)}function l4(e){return["html","body","#document"].indexOf(Rf(e))>=0?e.ownerDocument.body:Wd(e)&&pM(e)?e:l4(ET(e))}function y1(e,n){var a;n===void 0&&(n=[]);var u=l4(e),f=u===((a=e.ownerDocument)==null?void 0:a.body),w=Xh(u),p=f?[w].concat(w.visualViewport||[],pM(u)?u:[]):u,s=n.concat(p);return f?s:s.concat(y1(ET(p)))}function $C(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function GZ(e,n){var a=_0(e,!1,n==="fixed");return a.top=a.top+e.clientTop,a.left=a.left+e.clientLeft,a.bottom=a.top+e.clientHeight,a.right=a.left+e.clientWidth,a.width=e.clientWidth,a.height=e.clientHeight,a.x=a.left,a.y=a.top,a}function vO(e,n,a){return n===t4?$C(UZ(e,a)):Sy(n)?GZ(n,a):$C($Z(x_(e)))}function qZ(e){var n=y1(ET(e)),a=["absolute","fixed"].indexOf(Dm(e).position)>=0,u=a&&Wd(e)?_b(e):e;return Sy(u)?n.filter(function(f){return Sy(f)&&i4(f,u)&&Rf(f)!=="body"}):[]}function WZ(e,n,a,u){var f=n==="clippingParents"?qZ(e):[].concat(n),w=[].concat(f,[a]),p=w[0],s=w.reduce(function(L,F){var G=vO(e,F,u);return L.top=my(G.top,L.top),L.right=pS(G.right,L.right),L.bottom=pS(G.bottom,L.bottom),L.left=my(G.left,L.left),L},vO(e,p,u));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function c4(e){var n=e.reference,a=e.element,u=e.placement,f=u?Pf(u):null,w=u?y0(u):null,p=n.x+n.width/2-a.width/2,s=n.y+n.height/2-a.height/2,L;switch(f){case gh:L={x:p,y:n.y-a.height};break;case Jd:L={x:p,y:n.y+n.height};break;case Qd:L={x:n.x+n.width,y:s};break;case _h:L={x:n.x-a.width,y:s};break;default:L={x:n.x,y:n.y}}var F=f?uM(f):null;if(F!=null){var G=F==="y"?"height":"width";switch(w){case m0:L[F]=L[F]-(n[G]/2-a[G]/2);break;case X1:L[F]=L[F]+(n[G]/2-a[G]/2);break}}return L}function Y1(e,n){n===void 0&&(n={});var a=n,u=a.placement,f=u===void 0?e.placement:u,w=a.strategy,p=w===void 0?e.strategy:w,s=a.boundary,L=s===void 0?dZ:s,F=a.rootBoundary,G=F===void 0?t4:F,H=a.elementContext,X=H===void 0?qx:H,ne=a.altBoundary,ie=ne===void 0?!1:ne,se=a.padding,Te=se===void 0?0:se,ue=a4(typeof Te!="number"?Te:s4(Te,gb)),ce=X===qx?pZ:qx,de=e.rects.popper,Ee=e.elements[ie?ce:X],Ne=WZ(Sy(Ee)?Ee:Ee.contextElement||x_(e.elements.popper),L,G,p),rt=_0(e.elements.reference),tt=c4({reference:rt,element:de,strategy:"absolute",placement:f}),Ge=$C(Object.assign({},de,tt)),_t=X===qx?Ge:rt,yt={top:Ne.top-_t.top+ue.top,bottom:_t.bottom-Ne.bottom+ue.bottom,left:Ne.left-_t.left+ue.left,right:_t.right-Ne.right+ue.right},Et=e.modifiersData.offset;if(X===qx&&Et){var Wt=Et[f];Object.keys(yt).forEach(function(Ar){var mt=[Qd,Jd].indexOf(Ar)>=0?1:-1,nr=[gh,Jd].indexOf(Ar)>=0?"y":"x";yt[Ar]+=Wt[nr]*mt})}return yt}function HZ(e,n){n===void 0&&(n={});var a=n,u=a.placement,f=a.boundary,w=a.rootBoundary,p=a.padding,s=a.flipVariations,L=a.allowedAutoPlacements,F=L===void 0?r4:L,G=y0(u),H=G?s?mO:mO.filter(function(ie){return y0(ie)===G}):gb,X=H.filter(function(ie){return F.indexOf(ie)>=0});X.length===0&&(X=H);var ne=X.reduce(function(ie,se){return ie[se]=Y1(e,{placement:se,boundary:f,rootBoundary:w,padding:p})[Pf(se)],ie},{});return Object.keys(ne).sort(function(ie,se){return ne[ie]-ne[se]})}function ZZ(e){if(Pf(e)===sM)return[];var n=f2(e);return[yO(e),n,yO(n)]}function XZ(e){var n=e.state,a=e.options,u=e.name;if(!n.modifiersData[u]._skip){for(var f=a.mainAxis,w=f===void 0?!0:f,p=a.altAxis,s=p===void 0?!0:p,L=a.fallbackPlacements,F=a.padding,G=a.boundary,H=a.rootBoundary,X=a.altBoundary,ne=a.flipVariations,ie=ne===void 0?!0:ne,se=a.allowedAutoPlacements,Te=n.options.placement,ue=Pf(Te),ce=ue===Te,de=L||(ce||!ie?[f2(Te)]:ZZ(Te)),Ee=[Te].concat(de).reduce(function(hi,Vn){return hi.concat(Pf(Vn)===sM?HZ(n,{placement:Vn,boundary:G,rootBoundary:H,padding:F,flipVariations:ie,allowedAutoPlacements:se}):Vn)},[]),Ne=n.rects.reference,rt=n.rects.popper,tt=new Map,Ge=!0,_t=Ee[0],yt=0;yt<Ee.length;yt++){var Et=Ee[yt],Wt=Pf(Et),Ar=y0(Et)===m0,mt=[gh,Jd].indexOf(Wt)>=0,nr=mt?"width":"height",Xt=Y1(n,{placement:Et,boundary:G,rootBoundary:H,altBoundary:X,padding:F}),Ht=mt?Ar?Qd:_h:Ar?Jd:gh;Ne[nr]>rt[nr]&&(Ht=f2(Ht));var Qt=f2(Ht),sr=[];if(w&&sr.push(Xt[Wt]<=0),s&&sr.push(Xt[Ht]<=0,Xt[Qt]<=0),sr.every(function(hi){return hi})){_t=Et,Ge=!1;break}tt.set(Et,sr)}if(Ge)for(var Tr=ie?3:1,ln=function(Vn){var Oi=Ee.find(function(fn){var Nn=tt.get(fn);if(Nn)return Nn.slice(0,Vn).every(function(Pt){return Pt})});if(Oi)return _t=Oi,"break"},vn=Tr;vn>0;vn--){var wi=ln(vn);if(wi==="break")break}n.placement!==_t&&(n.modifiersData[u]._skip=!0,n.placement=_t,n.reset=!0)}}const YZ={name:"flip",enabled:!0,phase:"main",fn:XZ,requiresIfExists:["offset"],data:{_skip:!1}};function xO(e,n,a){return a===void 0&&(a={x:0,y:0}),{top:e.top-n.height-a.y,right:e.right-n.width+a.x,bottom:e.bottom-n.height+a.y,left:e.left-n.width-a.x}}function bO(e){return[gh,Qd,Jd,_h].some(function(n){return e[n]>=0})}function KZ(e){var n=e.state,a=e.name,u=n.rects.reference,f=n.rects.popper,w=n.modifiersData.preventOverflow,p=Y1(n,{elementContext:"reference"}),s=Y1(n,{altBoundary:!0}),L=xO(p,u),F=xO(s,f,w),G=bO(L),H=bO(F);n.modifiersData[a]={referenceClippingOffsets:L,popperEscapeOffsets:F,isReferenceHidden:G,hasPopperEscaped:H},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":G,"data-popper-escaped":H})}const JZ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:KZ};function QZ(e,n,a){var u=Pf(e),f=[_h,gh].indexOf(u)>=0?-1:1,w=typeof a=="function"?a(Object.assign({},n,{placement:e})):a,p=w[0],s=w[1];return p=p||0,s=(s||0)*f,[_h,Qd].indexOf(u)>=0?{x:s,y:p}:{x:p,y:s}}function eX(e){var n=e.state,a=e.options,u=e.name,f=a.offset,w=f===void 0?[0,0]:f,p=r4.reduce(function(G,H){return G[H]=QZ(H,n.rects,w),G},{}),s=p[n.placement],L=s.x,F=s.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=L,n.modifiersData.popperOffsets.y+=F),n.modifiersData[u]=p}const tX={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:eX};function rX(e){var n=e.state,a=e.name;n.modifiersData[a]=c4({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}const nX={name:"popperOffsets",enabled:!0,phase:"read",fn:rX,data:{}};function iX(e){return e==="x"?"y":"x"}function oX(e){var n=e.state,a=e.options,u=e.name,f=a.mainAxis,w=f===void 0?!0:f,p=a.altAxis,s=p===void 0?!1:p,L=a.boundary,F=a.rootBoundary,G=a.altBoundary,H=a.padding,X=a.tether,ne=X===void 0?!0:X,ie=a.tetherOffset,se=ie===void 0?0:ie,Te=Y1(n,{boundary:L,rootBoundary:F,padding:H,altBoundary:G}),ue=Pf(n.placement),ce=y0(n.placement),de=!ce,Ee=uM(ue),Ne=iX(Ee),rt=n.modifiersData.popperOffsets,tt=n.rects.reference,Ge=n.rects.popper,_t=typeof se=="function"?se(Object.assign({},n.rects,{placement:n.placement})):se,yt=typeof _t=="number"?{mainAxis:_t,altAxis:_t}:Object.assign({mainAxis:0,altAxis:0},_t),Et=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Wt={x:0,y:0};if(rt){if(w){var Ar,mt=Ee==="y"?gh:_h,nr=Ee==="y"?Jd:Qd,Xt=Ee==="y"?"height":"width",Ht=rt[Ee],Qt=Ht+Te[mt],sr=Ht-Te[nr],Tr=ne?-Ge[Xt]/2:0,ln=ce===m0?tt[Xt]:Ge[Xt],vn=ce===m0?-Ge[Xt]:-tt[Xt],wi=n.elements.arrow,hi=ne&&wi?cM(wi):{width:0,height:0},Vn=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:o4(),Oi=Vn[mt],fn=Vn[nr],Nn=_1(0,tt[Xt],hi[Xt]),Pt=de?tt[Xt]/2-Tr-Nn-Oi-yt.mainAxis:ln-Nn-Oi-yt.mainAxis,Dt=de?-tt[Xt]/2+Tr+Nn+fn+yt.mainAxis:vn+Nn+fn+yt.mainAxis,Ir=n.elements.arrow&&_b(n.elements.arrow),xr=Ir?Ee==="y"?Ir.clientTop||0:Ir.clientLeft||0:0,Kt=(Ar=Et==null?void 0:Et[Ee])!=null?Ar:0,Cn=Ht+Pt-Kt-xr,gn=Ht+Dt-Kt,fr=_1(ne?pS(Qt,Cn):Qt,Ht,ne?my(sr,gn):sr);rt[Ee]=fr,Wt[Ee]=fr-Ht}if(s){var Zr,qr=Ee==="x"?gh:_h,sn=Ee==="x"?Jd:Qd,qn=rt[Ne],Li=Ne==="y"?"height":"width",_i=qn+Te[qr],zi=qn-Te[sn],Pi=[gh,_h].indexOf(ue)!==-1,rr=(Zr=Et==null?void 0:Et[Ne])!=null?Zr:0,Me=Pi?_i:qn-tt[Li]-Ge[Li]-rr+yt.altAxis,qe=Pi?qn+tt[Li]+Ge[Li]-rr-yt.altAxis:zi,at=ne&&Pi?PZ(Me,qn,qe):_1(ne?Me:_i,qn,ne?qe:zi);rt[Ne]=at,Wt[Ne]=at-qn}n.modifiersData[u]=Wt}}const aX={name:"preventOverflow",enabled:!0,phase:"main",fn:oX,requiresIfExists:["offset"]};function sX(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function lX(e){return e===Xh(e)||!Wd(e)?hM(e):sX(e)}function cX(e){var n=e.getBoundingClientRect(),a=g0(n.width)/e.offsetWidth||1,u=g0(n.height)/e.offsetHeight||1;return a!==1||u!==1}function uX(e,n,a){a===void 0&&(a=!1);var u=Wd(n),f=Wd(n)&&cX(n),w=x_(n),p=_0(e,f,a),s={scrollLeft:0,scrollTop:0},L={x:0,y:0};return(u||!u&&!a)&&((Rf(n)!=="body"||pM(w))&&(s=lX(n)),Wd(n)?(L=_0(n,!0),L.x+=n.clientLeft,L.y+=n.clientTop):w&&(L.x=dM(w))),{x:p.left+s.scrollLeft-L.x,y:p.top+s.scrollTop-L.y,width:p.width,height:p.height}}function hX(e){var n=new Map,a=new Set,u=[];e.forEach(function(w){n.set(w.name,w)});function f(w){a.add(w.name);var p=[].concat(w.requires||[],w.requiresIfExists||[]);p.forEach(function(s){if(!a.has(s)){var L=n.get(s);L&&f(L)}}),u.push(w)}return e.forEach(function(w){a.has(w.name)||f(w)}),u}function dX(e){var n=hX(e);return SZ.reduce(function(a,u){return a.concat(n.filter(function(f){return f.phase===u}))},[])}function pX(e){var n;return function(){return n||(n=new Promise(function(a){Promise.resolve().then(function(){n=void 0,a(e())})})),n}}function fX(e){var n=e.reduce(function(a,u){var f=a[u.name];return a[u.name]=f?Object.assign({},f,u,{options:Object.assign({},f.options,u.options),data:Object.assign({},f.data,u.data)}):u,a},{});return Object.keys(n).map(function(a){return n[a]})}var wO={placement:"bottom",modifiers:[],strategy:"absolute"};function SO(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return!n.some(function(u){return!(u&&typeof u.getBoundingClientRect=="function")})}function mX(e){e===void 0&&(e={});var n=e,a=n.defaultModifiers,u=a===void 0?[]:a,f=n.defaultOptions,w=f===void 0?wO:f;return function(s,L,F){F===void 0&&(F=w);var G={placement:"bottom",orderedModifiers:[],options:Object.assign({},wO,w),modifiersData:{},elements:{reference:s,popper:L},attributes:{},styles:{}},H=[],X=!1,ne={state:G,setOptions:function(ue){var ce=typeof ue=="function"?ue(G.options):ue;se(),G.options=Object.assign({},w,G.options,ce),G.scrollParents={reference:Sy(s)?y1(s):s.contextElement?y1(s.contextElement):[],popper:y1(L)};var de=dX(fX([].concat(u,G.options.modifiers)));return G.orderedModifiers=de.filter(function(Ee){return Ee.enabled}),ie(),ne.update()},forceUpdate:function(){if(!X){var ue=G.elements,ce=ue.reference,de=ue.popper;if(SO(ce,de)){G.rects={reference:uX(ce,_b(de),G.options.strategy==="fixed"),popper:cM(de)},G.reset=!1,G.placement=G.options.placement,G.orderedModifiers.forEach(function(yt){return G.modifiersData[yt.name]=Object.assign({},yt.data)});for(var Ee=0;Ee<G.orderedModifiers.length;Ee++){if(G.reset===!0){G.reset=!1,Ee=-1;continue}var Ne=G.orderedModifiers[Ee],rt=Ne.fn,tt=Ne.options,Ge=tt===void 0?{}:tt,_t=Ne.name;typeof rt=="function"&&(G=rt({state:G,options:Ge,name:_t,instance:ne})||G)}}}},update:pX(function(){return new Promise(function(Te){ne.forceUpdate(),Te(G)})}),destroy:function(){se(),X=!0}};if(!SO(s,L))return ne;ne.setOptions(F).then(function(Te){!X&&F.onFirstUpdate&&F.onFirstUpdate(Te)});function ie(){G.orderedModifiers.forEach(function(Te){var ue=Te.name,ce=Te.options,de=ce===void 0?{}:ce,Ee=Te.effect;if(typeof Ee=="function"){var Ne=Ee({state:G,name:ue,instance:ne,options:de}),rt=function(){};H.push(Ne||rt)}})}function se(){H.forEach(function(Te){return Te()}),H=[]}return ne}}var gX=[BZ,nX,NZ,IZ,tX,YZ,aX,DZ,JZ],_X=mX({defaultModifiers:gX});function yX(e){return typeof e=="function"?e():e}const vX=fe.forwardRef(function(n,a){const{children:u,container:f,disablePortal:w=!1}=n,[p,s]=fe.useState(null),L=kf(fe.isValidElement(u)?u.ref:null,a);if(wy(()=>{w||s(yX(f)||document.body)},[f,w]),wy(()=>{if(p&&!w)return LC(a,p),()=>{LC(a,null)}},[a,p,w]),w){if(fe.isValidElement(u)){const F={ref:L};return fe.cloneElement(u,F)}return y.jsx(fe.Fragment,{children:u})}return y.jsx(fe.Fragment,{children:p&&jS.createPortal(u,p)})}),u4="Popper";function xX(e){return mb(u4,e)}ST(u4,["root"]);const bX=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],wX=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function SX(e,n){if(n==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function GC(e){return typeof e=="function"?e():e}function TX(e){return e.nodeType!==void 0}const EX=()=>Py({root:["root"]},wT(xX)),IX={},CX=fe.forwardRef(function(n,a){var u;const{anchorEl:f,children:w,direction:p,disablePortal:s,modifiers:L,open:F,placement:G,popperOptions:H,popperRef:X,slotProps:ne={},slots:ie={},TransitionProps:se}=n,Te=cc(n,bX),ue=fe.useRef(null),ce=kf(ue,a),de=fe.useRef(null),Ee=kf(de,X),Ne=fe.useRef(Ee);wy(()=>{Ne.current=Ee},[Ee]),fe.useImperativeHandle(X,()=>de.current,[]);const rt=SX(G,p),[tt,Ge]=fe.useState(rt),[_t,yt]=fe.useState(GC(f));fe.useEffect(()=>{de.current&&de.current.forceUpdate()}),fe.useEffect(()=>{f&&yt(GC(f))},[f]),wy(()=>{if(!_t||!F)return;const nr=Qt=>{Ge(Qt.placement)};let Xt=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Qt})=>{nr(Qt)}}];L!=null&&(Xt=Xt.concat(L)),H&&H.modifiers!=null&&(Xt=Xt.concat(H.modifiers));const Ht=_X(_t,ue.current,pn({placement:rt},H,{modifiers:Xt}));return Ne.current(Ht),()=>{Ht.destroy(),Ne.current(null)}},[_t,s,L,F,H,rt]);const Et={placement:tt};se!==null&&(Et.TransitionProps=se);const Wt=EX(),Ar=(u=ie.root)!=null?u:"div",mt=Z1({elementType:Ar,externalSlotProps:ne.root,externalForwardedProps:Te,additionalProps:{role:"tooltip",ref:ce},ownerState:n,className:Wt.root});return y.jsx(Ar,pn({},mt,{children:typeof w=="function"?w(Et):w}))}),AX=fe.forwardRef(function(n,a){const{anchorEl:u,children:f,container:w,direction:p="ltr",disablePortal:s=!1,keepMounted:L=!1,modifiers:F,open:G,placement:H="bottom",popperOptions:X=IX,popperRef:ne,style:ie,transition:se=!1,slotProps:Te={},slots:ue={}}=n,ce=cc(n,wX),[de,Ee]=fe.useState(!0),Ne=()=>{Ee(!1)},rt=()=>{Ee(!0)};if(!L&&!G&&(!se||de))return null;let tt;if(w)tt=w;else if(u){const yt=GC(u);tt=yt&&TX(yt)?m1(yt).body:m1(null).body}const Ge=!G&&L&&(!se||de)?"none":void 0,_t=se?{in:G,onEnter:Ne,onExited:rt}:void 0;return y.jsx(vX,{disablePortal:s,container:tt,children:y.jsx(CX,pn({anchorEl:u,direction:p,disablePortal:s,modifiers:F,ref:a,open:se?!de:G,placement:H,popperOptions:X,popperRef:ne,slotProps:Te,slots:ue},ce,{style:pn({position:"fixed",top:0,left:0,display:Ge},ie),TransitionProps:_t,children:f}))})}),PX=["actions","anchor","children","onItemsChange","slotProps","slots"];function MX(e){const{open:n}=e;return Py({root:["root",n&&"expanded"],listbox:["listbox",n&&"expanded"]},wT(VH))}const h4=fe.forwardRef(function(n,a){var u,f;const{actions:w,anchor:p,children:s,onItemsChange:L,slotProps:F={},slots:G={}}=n,H=cc(n,PX),{contextValue:X,getListboxProps:ne,dispatch:ie,open:se,triggerElement:Te}=hZ({onItemsChange:L,componentName:"Menu"}),ue=p??Te;fe.useImperativeHandle(w,()=>({dispatch:ie,resetHighlight:()=>ie({type:Cl.resetHighlight,event:null})}),[ie]);const ce=pn({},n,{open:se}),de=MX(ce),Ee=(u=G.root)!=null?u:"div",Ne=Z1({elementType:Ee,externalSlotProps:F.root,externalForwardedProps:H,additionalProps:{ref:a,role:void 0},className:de.root,ownerState:ce}),rt=(f=G.listbox)!=null?f:"ul",tt=Z1({elementType:rt,getSlotProps:ne,externalSlotProps:F.listbox,className:de.listbox,ownerState:ce});return se===!0&&ue==null?y.jsx(Ee,pn({},Ne,{children:y.jsx(rt,pn({},tt,{children:y.jsx(fO,{value:X,children:s})}))})):y.jsx(AX,pn({},Ne,{open:se,anchorEl:ue,slots:{root:Ee},children:y.jsx(rt,pn({},tt,{children:y.jsx(fO,{value:X,children:s})}))}))}),d4="MenuItem";function kX(e){return mb(d4,e)}ST(d4,["root","disabled","focusVisible"]);function RX(e){return`menu-item-${e.size}`}const DX={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0},triggerElement:null};function OX(e){var n;const{disabled:a=!1,id:u,rootRef:f,label:w}=e,p=VP(u),s=fe.useRef(null),L=fe.useMemo(()=>({disabled:a,id:p??"",label:w,ref:s}),[a,p,w]),{dispatch:F}=(n=fe.useContext(bT))!=null?n:DX,{getRootProps:G,highlighted:H}=oZ({item:p}),{index:X,totalItemCount:ne}=cZ(p??RX,L),{getRootProps:ie,focusVisible:se,rootRef:Te}=Z5({disabled:a,focusableWhenDisabled:!0}),ue=kf(Te,f,s);fe.useDebugValue({id:p,highlighted:H,disabled:a,label:w});const ce=Ne=>rt=>{var tt;(tt=Ne.onClick)==null||tt.call(Ne,rt),!rt.defaultMuiPrevented&&F({type:Lp.close,event:rt})},de=(Ne={})=>pn({},Ne,{onClick:ce(Ne)});function Ee(Ne={}){const rt=u_(Ne),tt=dS(de,dS(ie,G));return pn({},Ne,rt,tt(rt),{id:p,ref:ue,role:"menuitem"})}return p===void 0?{getRootProps:Ee,disabled:!1,focusVisible:se,highlighted:!1,index:-1,totalItemCount:0,rootRef:ue}:{getRootProps:Ee,disabled:a,focusVisible:se,highlighted:H,index:X,totalItemCount:ne,rootRef:ue}}function LX(e){const n=fe.useContext(TT);if(!n)throw new Error("MenuItem: ListContext was not found.");const a=VP(e),{getItemState:u,dispatch:f}=n;let w;a!=null?w=u(a):w={focusable:!0,highlighted:!1,selected:!1};const{highlighted:p,selected:s,focusable:L}=w,F=fe.useCallback(H=>{if(H!==a)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${H} | id: ${a}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:p,selected:s,focusable:L}},[p,s,L,a]);return{contextValue:fe.useMemo(()=>({dispatch:f,getItemState:F}),[f,F]),id:a}}const zX=["children","disabled","label","id","slotProps","slots"];function NX(e){const{disabled:n,focusVisible:a}=e;return Py({root:["root",n&&"disabled",a&&"focusVisible"]},wT(kX))}const jX=fe.memo(fe.forwardRef(function(n,a){var u;const{children:f,disabled:w=!1,label:p,id:s,slotProps:L={},slots:F={}}=n,G=cc(n,zX),{getRootProps:H,disabled:X,focusVisible:ne,highlighted:ie}=OX({id:s,disabled:w,rootRef:a,label:p}),se=pn({},n,{disabled:X,focusVisible:ne,highlighted:ie}),Te=NX(se),ue=(u=F.root)!=null?u:"li",ce=Z1({elementType:ue,getSlotProps:H,externalSlotProps:L.root,externalForwardedProps:G,className:Te.root,ownerState:se});return y.jsx(ue,pn({},ce,{children:f}))})),m2=fe.forwardRef(function(n,a){const{id:u}=n,{contextValue:f,id:w}=LX(u);return y.jsx(TT.Provider,{value:f,children:y.jsx(jX,pn({},n,{id:w,ref:a}))})});function p4({client:e}){const{theme:n}=ma(u=>u.app),a=eu();return y.jsxs(H5,{children:[y.jsxs(K5,{className:"dropdown-button",children:[n==="light"?y.jsx(cO,{className:"theme-icon"}):n==="dark"?y.jsx(lO,{className:"theme-icon"}):y.jsx(sO,{className:"theme-icon"}),y.jsx("span",{children:"Theme"})]}),y.jsxs(h4,{className:"dropdown",slotProps:{listbox:{className:"dropdown-listbox"}},children:[y.jsxs(m2,{className:"dropdown-item",onClick:()=>a(uI("light")),children:[y.jsx(cO,{className:"theme-icon"}),y.jsx("span",{children:"Light"})]}),y.jsxs(m2,{className:"dropdown-item",onClick:()=>a(uI("dark")),children:[y.jsx(lO,{className:"theme-icon"}),y.jsx("span",{children:"Dark"})]}),y.jsxs(m2,{className:"dropdown-item",onClick:()=>a(uI("system")),children:[y.jsx(sO,{className:"theme-icon"}),y.jsx("span",{children:"System"})]})]})]})}function TO(e){return e.substring(2).toLowerCase()}function BX(e,n){return n.documentElement.clientWidth<e.clientX||n.documentElement.clientHeight<e.clientY}function f4(e){const{children:n,disableReactTree:a=!1,mouseEvent:u="onClick",onClickAway:f,touchEvent:w="onTouchEnd"}=e,p=fe.useRef(!1),s=fe.useRef(null),L=fe.useRef(!1),F=fe.useRef(!1);fe.useEffect(()=>(setTimeout(()=>{L.current=!0},0),()=>{L.current=!1}),[]);const G=kf(n.ref,s),H=K$(ie=>{const se=F.current;F.current=!1;const Te=m1(s.current);if(!L.current||!s.current||"clientX"in ie&&BX(ie,Te))return;if(p.current){p.current=!1;return}let ue;ie.composedPath?ue=ie.composedPath().indexOf(s.current)>-1:ue=!Te.documentElement.contains(ie.target)||s.current.contains(ie.target),!ue&&(a||!se)&&f(ie)}),X=ie=>se=>{F.current=!0;const Te=n.props[ie];Te&&Te(se)},ne={ref:G};return w!==!1&&(ne[w]=X(w)),fe.useEffect(()=>{if(w!==!1){const ie=TO(w),se=m1(s.current),Te=()=>{p.current=!0};return se.addEventListener(ie,H),se.addEventListener("touchmove",Te),()=>{se.removeEventListener(ie,H),se.removeEventListener("touchmove",Te)}}},[H,w]),u!==!1&&(ne[u]=X(u)),fe.useEffect(()=>{if(u!==!1){const ie=TO(u),se=m1(s.current);return se.addEventListener(ie,H),()=>{se.removeEventListener(ie,H)}}},[H,u]),y.jsx(fe.Fragment,{children:fe.cloneElement(n,ne)})}function m4({data:e,changeOpen:n}){var u,f,w,p,s,L,F,G,H,X,ne,ie,se;const a=ql();return y.jsxs("div",{className:"searchResultCard",onClick:()=>{n(!1),a(`/permit/${e==null?void 0:e._id}`,{state:e})},children:[y.jsx("span",{children:((u=e==null?void 0:e.planNumber)==null?void 0:u.fullValue)||(e==null?void 0:e.uniqueId)}),y.jsxs("span",{children:[(w=(f=e.applicant)==null?void 0:f.name)==null?void 0:w.toLowerCase(),((p=e.dev)==null?void 0:p.name)&&` (${(L=(s=e.dev)==null?void 0:s.name)==null?void 0:L.toLowerCase()})`]}),y.jsxs("span",{children:[((F=e.dev)==null?void 0:F.plotNo)&&((G=e.dev)==null?void 0:G.plotNo)+","," ",((H=e.dev)==null?void 0:H.address)&&((ne=(X=e.dev)==null?void 0:X.address)==null?void 0:ne.toLowerCase())]}),y.jsxs("span",{children:["Zone ",(ie=e.dev)==null?void 0:ie.zone]}),y.jsx("span",{children:(se=e.dev)==null?void 0:se.type})]})}function g4(e,n){return function(){return e.apply(n,arguments)}}const{toString:FX}=Object.prototype,{getPrototypeOf:fM}=Object,IT=(e=>n=>{const a=FX.call(n);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Df=e=>(e=e.toLowerCase(),n=>IT(n)===e),CT=e=>n=>typeof n===e,{isArray:R0}=Array,K1=CT("undefined");function VX(e){return e!==null&&!K1(e)&&e.constructor!==null&&!K1(e.constructor)&&Hd(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const _4=Df("ArrayBuffer");function UX(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&_4(e.buffer),n}const $X=CT("string"),Hd=CT("function"),y4=CT("number"),AT=e=>e!==null&&typeof e=="object",GX=e=>e===!0||e===!1,g2=e=>{if(IT(e)!=="object")return!1;const n=fM(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},qX=Df("Date"),WX=Df("File"),HX=Df("Blob"),ZX=Df("FileList"),XX=e=>AT(e)&&Hd(e.pipe),YX=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Hd(e.append)&&((n=IT(e))==="formdata"||n==="object"&&Hd(e.toString)&&e.toString()==="[object FormData]"))},KX=Df("URLSearchParams"),JX=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function yb(e,n,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let u,f;if(typeof e!="object"&&(e=[e]),R0(e))for(u=0,f=e.length;u<f;u++)n.call(null,e[u],u,e);else{const w=a?Object.getOwnPropertyNames(e):Object.keys(e),p=w.length;let s;for(u=0;u<p;u++)s=w[u],n.call(null,e[s],s,e)}}function v4(e,n){n=n.toLowerCase();const a=Object.keys(e);let u=a.length,f;for(;u-- >0;)if(f=a[u],n===f.toLowerCase())return f;return null}const x4=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),b4=e=>!K1(e)&&e!==x4;function qC(){const{caseless:e}=b4(this)&&this||{},n={},a=(u,f)=>{const w=e&&v4(n,f)||f;g2(n[w])&&g2(u)?n[w]=qC(n[w],u):g2(u)?n[w]=qC({},u):R0(u)?n[w]=u.slice():n[w]=u};for(let u=0,f=arguments.length;u<f;u++)arguments[u]&&yb(arguments[u],a);return n}const QX=(e,n,a,{allOwnKeys:u}={})=>(yb(n,(f,w)=>{a&&Hd(f)?e[w]=g4(f,a):e[w]=f},{allOwnKeys:u}),e),eY=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),tY=(e,n,a,u)=>{e.prototype=Object.create(n.prototype,u),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),a&&Object.assign(e.prototype,a)},rY=(e,n,a,u)=>{let f,w,p;const s={};if(n=n||{},e==null)return n;do{for(f=Object.getOwnPropertyNames(e),w=f.length;w-- >0;)p=f[w],(!u||u(p,e,n))&&!s[p]&&(n[p]=e[p],s[p]=!0);e=a!==!1&&fM(e)}while(e&&(!a||a(e,n))&&e!==Object.prototype);return n},nY=(e,n,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=n.length;const u=e.indexOf(n,a);return u!==-1&&u===a},iY=e=>{if(!e)return null;if(R0(e))return e;let n=e.length;if(!y4(n))return null;const a=new Array(n);for(;n-- >0;)a[n]=e[n];return a},oY=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&fM(Uint8Array)),aY=(e,n)=>{const u=(e&&e[Symbol.iterator]).call(e);let f;for(;(f=u.next())&&!f.done;){const w=f.value;n.call(e,w[0],w[1])}},sY=(e,n)=>{let a;const u=[];for(;(a=e.exec(n))!==null;)u.push(a);return u},lY=Df("HTMLFormElement"),cY=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,u,f){return u.toUpperCase()+f}),EO=(({hasOwnProperty:e})=>(n,a)=>e.call(n,a))(Object.prototype),uY=Df("RegExp"),w4=(e,n)=>{const a=Object.getOwnPropertyDescriptors(e),u={};yb(a,(f,w)=>{let p;(p=n(f,w,e))!==!1&&(u[w]=p||f)}),Object.defineProperties(e,u)},hY=e=>{w4(e,(n,a)=>{if(Hd(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const u=e[a];if(Hd(u)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},dY=(e,n)=>{const a={},u=f=>{f.forEach(w=>{a[w]=!0})};return R0(e)?u(e):u(String(e).split(n)),a},pY=()=>{},fY=(e,n)=>(e=+e,Number.isFinite(e)?e:n),mI="abcdefghijklmnopqrstuvwxyz",IO="0123456789",S4={DIGIT:IO,ALPHA:mI,ALPHA_DIGIT:mI+mI.toUpperCase()+IO},mY=(e=16,n=S4.ALPHA_DIGIT)=>{let a="";const{length:u}=n;for(;e--;)a+=n[Math.random()*u|0];return a};function gY(e){return!!(e&&Hd(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const _Y=e=>{const n=new Array(10),a=(u,f)=>{if(AT(u)){if(n.indexOf(u)>=0)return;if(!("toJSON"in u)){n[f]=u;const w=R0(u)?[]:{};return yb(u,(p,s)=>{const L=a(p,f+1);!K1(L)&&(w[s]=L)}),n[f]=void 0,w}}return u};return a(e,0)},yY=Df("AsyncFunction"),vY=e=>e&&(AT(e)||Hd(e))&&Hd(e.then)&&Hd(e.catch),rn={isArray:R0,isArrayBuffer:_4,isBuffer:VX,isFormData:YX,isArrayBufferView:UX,isString:$X,isNumber:y4,isBoolean:GX,isObject:AT,isPlainObject:g2,isUndefined:K1,isDate:qX,isFile:WX,isBlob:HX,isRegExp:uY,isFunction:Hd,isStream:XX,isURLSearchParams:KX,isTypedArray:oY,isFileList:ZX,forEach:yb,merge:qC,extend:QX,trim:JX,stripBOM:eY,inherits:tY,toFlatObject:rY,kindOf:IT,kindOfTest:Df,endsWith:nY,toArray:iY,forEachEntry:aY,matchAll:sY,isHTMLForm:lY,hasOwnProperty:EO,hasOwnProp:EO,reduceDescriptors:w4,freezeMethods:hY,toObjectSet:dY,toCamelCase:cY,noop:pY,toFiniteNumber:fY,findKey:v4,global:x4,isContextDefined:b4,ALPHABET:S4,generateString:mY,isSpecCompliantForm:gY,toJSONObject:_Y,isAsyncFn:yY,isThenable:vY};function sa(e,n,a,u,f){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),a&&(this.config=a),u&&(this.request=u),f&&(this.response=f)}rn.inherits(sa,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rn.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const T4=sa.prototype,E4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{E4[e]={value:e}});Object.defineProperties(sa,E4);Object.defineProperty(T4,"isAxiosError",{value:!0});sa.from=(e,n,a,u,f,w)=>{const p=Object.create(T4);return rn.toFlatObject(e,p,function(L){return L!==Error.prototype},s=>s!=="isAxiosError"),sa.call(p,e.message,n,a,u,f),p.cause=e,p.name=e.name,w&&Object.assign(p,w),p};const xY=null;function WC(e){return rn.isPlainObject(e)||rn.isArray(e)}function I4(e){return rn.endsWith(e,"[]")?e.slice(0,-2):e}function CO(e,n,a){return e?e.concat(n).map(function(f,w){return f=I4(f),!a&&w?"["+f+"]":f}).join(a?".":""):n}function bY(e){return rn.isArray(e)&&!e.some(WC)}const wY=rn.toFlatObject(rn,{},null,function(n){return/^is[A-Z]/.test(n)});function PT(e,n,a){if(!rn.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,a=rn.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(se,Te){return!rn.isUndefined(Te[se])});const u=a.metaTokens,f=a.visitor||G,w=a.dots,p=a.indexes,L=(a.Blob||typeof Blob<"u"&&Blob)&&rn.isSpecCompliantForm(n);if(!rn.isFunction(f))throw new TypeError("visitor must be a function");function F(ie){if(ie===null)return"";if(rn.isDate(ie))return ie.toISOString();if(!L&&rn.isBlob(ie))throw new sa("Blob is not supported. Use a Buffer instead.");return rn.isArrayBuffer(ie)||rn.isTypedArray(ie)?L&&typeof Blob=="function"?new Blob([ie]):Buffer.from(ie):ie}function G(ie,se,Te){let ue=ie;if(ie&&!Te&&typeof ie=="object"){if(rn.endsWith(se,"{}"))se=u?se:se.slice(0,-2),ie=JSON.stringify(ie);else if(rn.isArray(ie)&&bY(ie)||(rn.isFileList(ie)||rn.endsWith(se,"[]"))&&(ue=rn.toArray(ie)))return se=I4(se),ue.forEach(function(de,Ee){!(rn.isUndefined(de)||de===null)&&n.append(p===!0?CO([se],Ee,w):p===null?se:se+"[]",F(de))}),!1}return WC(ie)?!0:(n.append(CO(Te,se,w),F(ie)),!1)}const H=[],X=Object.assign(wY,{defaultVisitor:G,convertValue:F,isVisitable:WC});function ne(ie,se){if(!rn.isUndefined(ie)){if(H.indexOf(ie)!==-1)throw Error("Circular reference detected in "+se.join("."));H.push(ie),rn.forEach(ie,function(ue,ce){(!(rn.isUndefined(ue)||ue===null)&&f.call(n,ue,rn.isString(ce)?ce.trim():ce,se,X))===!0&&ne(ue,se?se.concat(ce):[ce])}),H.pop()}}if(!rn.isObject(e))throw new TypeError("data must be an object");return ne(e),n}function AO(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(u){return n[u]})}function mM(e,n){this._pairs=[],e&&PT(e,this,n)}const C4=mM.prototype;C4.append=function(n,a){this._pairs.push([n,a])};C4.toString=function(n){const a=n?function(u){return n.call(this,u,AO)}:AO;return this._pairs.map(function(f){return a(f[0])+"="+a(f[1])},"").join("&")};function SY(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function A4(e,n,a){if(!n)return e;const u=a&&a.encode||SY,f=a&&a.serialize;let w;if(f?w=f(n,a):w=rn.isURLSearchParams(n)?n.toString():new mM(n,a).toString(u),w){const p=e.indexOf("#");p!==-1&&(e=e.slice(0,p)),e+=(e.indexOf("?")===-1?"?":"&")+w}return e}class TY{constructor(){this.handlers=[]}use(n,a,u){return this.handlers.push({fulfilled:n,rejected:a,synchronous:u?u.synchronous:!1,runWhen:u?u.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){rn.forEach(this.handlers,function(u){u!==null&&n(u)})}}const PO=TY,P4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},EY=typeof URLSearchParams<"u"?URLSearchParams:mM,IY=typeof FormData<"u"?FormData:null,CY=typeof Blob<"u"?Blob:null,AY={isBrowser:!0,classes:{URLSearchParams:EY,FormData:IY,Blob:CY},protocols:["http","https","file","blob","url","data"]},M4=typeof window<"u"&&typeof document<"u",PY=(e=>M4&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),MY=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),kY=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:M4,hasStandardBrowserEnv:PY,hasStandardBrowserWebWorkerEnv:MY},Symbol.toStringTag,{value:"Module"})),Sf={...kY,...AY};function RY(e,n){return PT(e,new Sf.classes.URLSearchParams,Object.assign({visitor:function(a,u,f,w){return Sf.isNode&&rn.isBuffer(a)?(this.append(u,a.toString("base64")),!1):w.defaultVisitor.apply(this,arguments)}},n))}function DY(e){return rn.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function OY(e){const n={},a=Object.keys(e);let u;const f=a.length;let w;for(u=0;u<f;u++)w=a[u],n[w]=e[w];return n}function k4(e){function n(a,u,f,w){let p=a[w++];if(p==="__proto__")return!0;const s=Number.isFinite(+p),L=w>=a.length;return p=!p&&rn.isArray(f)?f.length:p,L?(rn.hasOwnProp(f,p)?f[p]=[f[p],u]:f[p]=u,!s):((!f[p]||!rn.isObject(f[p]))&&(f[p]=[]),n(a,u,f[p],w)&&rn.isArray(f[p])&&(f[p]=OY(f[p])),!s)}if(rn.isFormData(e)&&rn.isFunction(e.entries)){const a={};return rn.forEachEntry(e,(u,f)=>{n(DY(u),f,a,0)}),a}return null}function LY(e,n,a){if(rn.isString(e))try{return(n||JSON.parse)(e),rn.trim(e)}catch(u){if(u.name!=="SyntaxError")throw u}return(a||JSON.stringify)(e)}const gM={transitional:P4,adapter:["xhr","http"],transformRequest:[function(n,a){const u=a.getContentType()||"",f=u.indexOf("application/json")>-1,w=rn.isObject(n);if(w&&rn.isHTMLForm(n)&&(n=new FormData(n)),rn.isFormData(n))return f?JSON.stringify(k4(n)):n;if(rn.isArrayBuffer(n)||rn.isBuffer(n)||rn.isStream(n)||rn.isFile(n)||rn.isBlob(n))return n;if(rn.isArrayBufferView(n))return n.buffer;if(rn.isURLSearchParams(n))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let s;if(w){if(u.indexOf("application/x-www-form-urlencoded")>-1)return RY(n,this.formSerializer).toString();if((s=rn.isFileList(n))||u.indexOf("multipart/form-data")>-1){const L=this.env&&this.env.FormData;return PT(s?{"files[]":n}:n,L&&new L,this.formSerializer)}}return w||f?(a.setContentType("application/json",!1),LY(n)):n}],transformResponse:[function(n){const a=this.transitional||gM.transitional,u=a&&a.forcedJSONParsing,f=this.responseType==="json";if(n&&rn.isString(n)&&(u&&!this.responseType||f)){const p=!(a&&a.silentJSONParsing)&&f;try{return JSON.parse(n)}catch(s){if(p)throw s.name==="SyntaxError"?sa.from(s,sa.ERR_BAD_RESPONSE,this,null,this.response):s}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Sf.classes.FormData,Blob:Sf.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rn.forEach(["delete","get","head","post","put","patch"],e=>{gM.headers[e]={}});const _M=gM,zY=rn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NY=e=>{const n={};let a,u,f;return e&&e.split(`
`).forEach(function(p){f=p.indexOf(":"),a=p.substring(0,f).trim().toLowerCase(),u=p.substring(f+1).trim(),!(!a||n[a]&&zY[a])&&(a==="set-cookie"?n[a]?n[a].push(u):n[a]=[u]:n[a]=n[a]?n[a]+", "+u:u)}),n},MO=Symbol("internals");function Wx(e){return e&&String(e).trim().toLowerCase()}function _2(e){return e===!1||e==null?e:rn.isArray(e)?e.map(_2):String(e)}function jY(e){const n=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let u;for(;u=a.exec(e);)n[u[1]]=u[2];return n}const BY=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function gI(e,n,a,u,f){if(rn.isFunction(u))return u.call(this,n,a);if(f&&(n=a),!!rn.isString(n)){if(rn.isString(u))return n.indexOf(u)!==-1;if(rn.isRegExp(u))return u.test(n)}}function FY(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,a,u)=>a.toUpperCase()+u)}function VY(e,n){const a=rn.toCamelCase(" "+n);["get","set","has"].forEach(u=>{Object.defineProperty(e,u+a,{value:function(f,w,p){return this[u].call(this,n,f,w,p)},configurable:!0})})}class MT{constructor(n){n&&this.set(n)}set(n,a,u){const f=this;function w(s,L,F){const G=Wx(L);if(!G)throw new Error("header name must be a non-empty string");const H=rn.findKey(f,G);(!H||f[H]===void 0||F===!0||F===void 0&&f[H]!==!1)&&(f[H||L]=_2(s))}const p=(s,L)=>rn.forEach(s,(F,G)=>w(F,G,L));return rn.isPlainObject(n)||n instanceof this.constructor?p(n,a):rn.isString(n)&&(n=n.trim())&&!BY(n)?p(NY(n),a):n!=null&&w(a,n,u),this}get(n,a){if(n=Wx(n),n){const u=rn.findKey(this,n);if(u){const f=this[u];if(!a)return f;if(a===!0)return jY(f);if(rn.isFunction(a))return a.call(this,f,u);if(rn.isRegExp(a))return a.exec(f);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,a){if(n=Wx(n),n){const u=rn.findKey(this,n);return!!(u&&this[u]!==void 0&&(!a||gI(this,this[u],u,a)))}return!1}delete(n,a){const u=this;let f=!1;function w(p){if(p=Wx(p),p){const s=rn.findKey(u,p);s&&(!a||gI(u,u[s],s,a))&&(delete u[s],f=!0)}}return rn.isArray(n)?n.forEach(w):w(n),f}clear(n){const a=Object.keys(this);let u=a.length,f=!1;for(;u--;){const w=a[u];(!n||gI(this,this[w],w,n,!0))&&(delete this[w],f=!0)}return f}normalize(n){const a=this,u={};return rn.forEach(this,(f,w)=>{const p=rn.findKey(u,w);if(p){a[p]=_2(f),delete a[w];return}const s=n?FY(w):String(w).trim();s!==w&&delete a[w],a[s]=_2(f),u[s]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const a=Object.create(null);return rn.forEach(this,(u,f)=>{u!=null&&u!==!1&&(a[f]=n&&rn.isArray(u)?u.join(", "):u)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,a])=>n+": "+a).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...a){const u=new this(n);return a.forEach(f=>u.set(f)),u}static accessor(n){const u=(this[MO]=this[MO]={accessors:{}}).accessors,f=this.prototype;function w(p){const s=Wx(p);u[s]||(VY(f,p),u[s]=!0)}return rn.isArray(n)?n.forEach(w):w(n),this}}MT.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);rn.reduceDescriptors(MT.prototype,({value:e},n)=>{let a=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(u){this[a]=u}}});rn.freezeMethods(MT);const Em=MT;function _I(e,n){const a=this||_M,u=n||a,f=Em.from(u.headers);let w=u.data;return rn.forEach(e,function(s){w=s.call(a,w,f.normalize(),n?n.status:void 0)}),f.normalize(),w}function R4(e){return!!(e&&e.__CANCEL__)}function vb(e,n,a){sa.call(this,e??"canceled",sa.ERR_CANCELED,n,a),this.name="CanceledError"}rn.inherits(vb,sa,{__CANCEL__:!0});function UY(e,n,a){const u=a.config.validateStatus;!a.status||!u||u(a.status)?e(a):n(new sa("Request failed with status code "+a.status,[sa.ERR_BAD_REQUEST,sa.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}const $Y=Sf.hasStandardBrowserEnv?{write(e,n,a,u,f,w){const p=[e+"="+encodeURIComponent(n)];rn.isNumber(a)&&p.push("expires="+new Date(a).toGMTString()),rn.isString(u)&&p.push("path="+u),rn.isString(f)&&p.push("domain="+f),w===!0&&p.push("secure"),document.cookie=p.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function GY(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function qY(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function D4(e,n){return e&&!GY(n)?qY(e,n):n}const WY=Sf.hasStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),a=document.createElement("a");let u;function f(w){let p=w;return n&&(a.setAttribute("href",p),p=a.href),a.setAttribute("href",p),{href:a.href,protocol:a.protocol?a.protocol.replace(/:$/,""):"",host:a.host,search:a.search?a.search.replace(/^\?/,""):"",hash:a.hash?a.hash.replace(/^#/,""):"",hostname:a.hostname,port:a.port,pathname:a.pathname.charAt(0)==="/"?a.pathname:"/"+a.pathname}}return u=f(window.location.href),function(p){const s=rn.isString(p)?f(p):p;return s.protocol===u.protocol&&s.host===u.host}}():function(){return function(){return!0}}();function HY(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function ZY(e,n){e=e||10;const a=new Array(e),u=new Array(e);let f=0,w=0,p;return n=n!==void 0?n:1e3,function(L){const F=Date.now(),G=u[w];p||(p=F),a[f]=L,u[f]=F;let H=w,X=0;for(;H!==f;)X+=a[H++],H=H%e;if(f=(f+1)%e,f===w&&(w=(w+1)%e),F-p<n)return;const ne=G&&F-G;return ne?Math.round(X*1e3/ne):void 0}}function kO(e,n){let a=0;const u=ZY(50,250);return f=>{const w=f.loaded,p=f.lengthComputable?f.total:void 0,s=w-a,L=u(s),F=w<=p;a=w;const G={loaded:w,total:p,progress:p?w/p:void 0,bytes:s,rate:L||void 0,estimated:L&&p&&F?(p-w)/L:void 0,event:f};G[n?"download":"upload"]=!0,e(G)}}const XY=typeof XMLHttpRequest<"u",YY=XY&&function(e){return new Promise(function(a,u){let f=e.data;const w=Em.from(e.headers).normalize();let{responseType:p,withXSRFToken:s}=e,L;function F(){e.cancelToken&&e.cancelToken.unsubscribe(L),e.signal&&e.signal.removeEventListener("abort",L)}let G;if(rn.isFormData(f)){if(Sf.hasStandardBrowserEnv||Sf.hasStandardBrowserWebWorkerEnv)w.setContentType(!1);else if((G=w.getContentType())!==!1){const[se,...Te]=G?G.split(";").map(ue=>ue.trim()).filter(Boolean):[];w.setContentType([se||"multipart/form-data",...Te].join("; "))}}let H=new XMLHttpRequest;if(e.auth){const se=e.auth.username||"",Te=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";w.set("Authorization","Basic "+btoa(se+":"+Te))}const X=D4(e.baseURL,e.url);H.open(e.method.toUpperCase(),A4(X,e.params,e.paramsSerializer),!0),H.timeout=e.timeout;function ne(){if(!H)return;const se=Em.from("getAllResponseHeaders"in H&&H.getAllResponseHeaders()),ue={data:!p||p==="text"||p==="json"?H.responseText:H.response,status:H.status,statusText:H.statusText,headers:se,config:e,request:H};UY(function(de){a(de),F()},function(de){u(de),F()},ue),H=null}if("onloadend"in H?H.onloadend=ne:H.onreadystatechange=function(){!H||H.readyState!==4||H.status===0&&!(H.responseURL&&H.responseURL.indexOf("file:")===0)||setTimeout(ne)},H.onabort=function(){H&&(u(new sa("Request aborted",sa.ECONNABORTED,e,H)),H=null)},H.onerror=function(){u(new sa("Network Error",sa.ERR_NETWORK,e,H)),H=null},H.ontimeout=function(){let Te=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const ue=e.transitional||P4;e.timeoutErrorMessage&&(Te=e.timeoutErrorMessage),u(new sa(Te,ue.clarifyTimeoutError?sa.ETIMEDOUT:sa.ECONNABORTED,e,H)),H=null},Sf.hasStandardBrowserEnv&&(s&&rn.isFunction(s)&&(s=s(e)),s||s!==!1&&WY(X))){const se=e.xsrfHeaderName&&e.xsrfCookieName&&$Y.read(e.xsrfCookieName);se&&w.set(e.xsrfHeaderName,se)}f===void 0&&w.setContentType(null),"setRequestHeader"in H&&rn.forEach(w.toJSON(),function(Te,ue){H.setRequestHeader(ue,Te)}),rn.isUndefined(e.withCredentials)||(H.withCredentials=!!e.withCredentials),p&&p!=="json"&&(H.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&H.addEventListener("progress",kO(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&H.upload&&H.upload.addEventListener("progress",kO(e.onUploadProgress)),(e.cancelToken||e.signal)&&(L=se=>{H&&(u(!se||se.type?new vb(null,e,H):se),H.abort(),H=null)},e.cancelToken&&e.cancelToken.subscribe(L),e.signal&&(e.signal.aborted?L():e.signal.addEventListener("abort",L)));const ie=HY(X);if(ie&&Sf.protocols.indexOf(ie)===-1){u(new sa("Unsupported protocol "+ie+":",sa.ERR_BAD_REQUEST,e));return}H.send(f||null)})},HC={http:xY,xhr:YY};rn.forEach(HC,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const RO=e=>`- ${e}`,KY=e=>rn.isFunction(e)||e===null||e===!1,O4={getAdapter:e=>{e=rn.isArray(e)?e:[e];const{length:n}=e;let a,u;const f={};for(let w=0;w<n;w++){a=e[w];let p;if(u=a,!KY(a)&&(u=HC[(p=String(a)).toLowerCase()],u===void 0))throw new sa(`Unknown adapter '${p}'`);if(u)break;f[p||"#"+w]=u}if(!u){const w=Object.entries(f).map(([s,L])=>`adapter ${s} `+(L===!1?"is not supported by the environment":"is not available in the build"));let p=n?w.length>1?`since :
`+w.map(RO).join(`
`):" "+RO(w[0]):"as no adapter specified";throw new sa("There is no suitable adapter to dispatch the request "+p,"ERR_NOT_SUPPORT")}return u},adapters:HC};function yI(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new vb(null,e)}function DO(e){return yI(e),e.headers=Em.from(e.headers),e.data=_I.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),O4.getAdapter(e.adapter||_M.adapter)(e).then(function(u){return yI(e),u.data=_I.call(e,e.transformResponse,u),u.headers=Em.from(u.headers),u},function(u){return R4(u)||(yI(e),u&&u.response&&(u.response.data=_I.call(e,e.transformResponse,u.response),u.response.headers=Em.from(u.response.headers))),Promise.reject(u)})}const OO=e=>e instanceof Em?e.toJSON():e;function v0(e,n){n=n||{};const a={};function u(F,G,H){return rn.isPlainObject(F)&&rn.isPlainObject(G)?rn.merge.call({caseless:H},F,G):rn.isPlainObject(G)?rn.merge({},G):rn.isArray(G)?G.slice():G}function f(F,G,H){if(rn.isUndefined(G)){if(!rn.isUndefined(F))return u(void 0,F,H)}else return u(F,G,H)}function w(F,G){if(!rn.isUndefined(G))return u(void 0,G)}function p(F,G){if(rn.isUndefined(G)){if(!rn.isUndefined(F))return u(void 0,F)}else return u(void 0,G)}function s(F,G,H){if(H in n)return u(F,G);if(H in e)return u(void 0,F)}const L={url:w,method:w,data:w,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:s,headers:(F,G)=>f(OO(F),OO(G),!0)};return rn.forEach(Object.keys(Object.assign({},e,n)),function(G){const H=L[G]||f,X=H(e[G],n[G],G);rn.isUndefined(X)&&H!==s||(a[G]=X)}),a}const L4="1.6.7",yM={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{yM[e]=function(u){return typeof u===e||"a"+(n<1?"n ":" ")+e}});const LO={};yM.transitional=function(n,a,u){function f(w,p){return"[Axios v"+L4+"] Transitional option '"+w+"'"+p+(u?". "+u:"")}return(w,p,s)=>{if(n===!1)throw new sa(f(p," has been removed"+(a?" in "+a:"")),sa.ERR_DEPRECATED);return a&&!LO[p]&&(LO[p]=!0,console.warn(f(p," has been deprecated since v"+a+" and will be removed in the near future"))),n?n(w,p,s):!0}};function JY(e,n,a){if(typeof e!="object")throw new sa("options must be an object",sa.ERR_BAD_OPTION_VALUE);const u=Object.keys(e);let f=u.length;for(;f-- >0;){const w=u[f],p=n[w];if(p){const s=e[w],L=s===void 0||p(s,w,e);if(L!==!0)throw new sa("option "+w+" must be "+L,sa.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new sa("Unknown option "+w,sa.ERR_BAD_OPTION)}}const ZC={assertOptions:JY,validators:yM},Mg=ZC.validators;class fS{constructor(n){this.defaults=n,this.interceptors={request:new PO,response:new PO}}async request(n,a){try{return await this._request(n,a)}catch(u){if(u instanceof Error){let f;Error.captureStackTrace?Error.captureStackTrace(f={}):f=new Error;const w=f.stack?f.stack.replace(/^.+\n/,""):"";u.stack?w&&!String(u.stack).endsWith(w.replace(/^.+\n.+\n/,""))&&(u.stack+=`
`+w):u.stack=w}throw u}}_request(n,a){typeof n=="string"?(a=a||{},a.url=n):a=n||{},a=v0(this.defaults,a);const{transitional:u,paramsSerializer:f,headers:w}=a;u!==void 0&&ZC.assertOptions(u,{silentJSONParsing:Mg.transitional(Mg.boolean),forcedJSONParsing:Mg.transitional(Mg.boolean),clarifyTimeoutError:Mg.transitional(Mg.boolean)},!1),f!=null&&(rn.isFunction(f)?a.paramsSerializer={serialize:f}:ZC.assertOptions(f,{encode:Mg.function,serialize:Mg.function},!0)),a.method=(a.method||this.defaults.method||"get").toLowerCase();let p=w&&rn.merge(w.common,w[a.method]);w&&rn.forEach(["delete","get","head","post","put","patch","common"],ie=>{delete w[ie]}),a.headers=Em.concat(p,w);const s=[];let L=!0;this.interceptors.request.forEach(function(se){typeof se.runWhen=="function"&&se.runWhen(a)===!1||(L=L&&se.synchronous,s.unshift(se.fulfilled,se.rejected))});const F=[];this.interceptors.response.forEach(function(se){F.push(se.fulfilled,se.rejected)});let G,H=0,X;if(!L){const ie=[DO.bind(this),void 0];for(ie.unshift.apply(ie,s),ie.push.apply(ie,F),X=ie.length,G=Promise.resolve(a);H<X;)G=G.then(ie[H++],ie[H++]);return G}X=s.length;let ne=a;for(H=0;H<X;){const ie=s[H++],se=s[H++];try{ne=ie(ne)}catch(Te){se.call(this,Te);break}}try{G=DO.call(this,ne)}catch(ie){return Promise.reject(ie)}for(H=0,X=F.length;H<X;)G=G.then(F[H++],F[H++]);return G}getUri(n){n=v0(this.defaults,n);const a=D4(n.baseURL,n.url);return A4(a,n.params,n.paramsSerializer)}}rn.forEach(["delete","get","head","options"],function(n){fS.prototype[n]=function(a,u){return this.request(v0(u||{},{method:n,url:a,data:(u||{}).data}))}});rn.forEach(["post","put","patch"],function(n){function a(u){return function(w,p,s){return this.request(v0(s||{},{method:n,headers:u?{"Content-Type":"multipart/form-data"}:{},url:w,data:p}))}}fS.prototype[n]=a(),fS.prototype[n+"Form"]=a(!0)});const y2=fS;class vM{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(w){a=w});const u=this;this.promise.then(f=>{if(!u._listeners)return;let w=u._listeners.length;for(;w-- >0;)u._listeners[w](f);u._listeners=null}),this.promise.then=f=>{let w;const p=new Promise(s=>{u.subscribe(s),w=s}).then(f);return p.cancel=function(){u.unsubscribe(w)},p},n(function(w,p,s){u.reason||(u.reason=new vb(w,p,s),a(u.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const a=this._listeners.indexOf(n);a!==-1&&this._listeners.splice(a,1)}static source(){let n;return{token:new vM(function(f){n=f}),cancel:n}}}const QY=vM;function eK(e){return function(a){return e.apply(null,a)}}function tK(e){return rn.isObject(e)&&e.isAxiosError===!0}const XC={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(XC).forEach(([e,n])=>{XC[n]=e});const rK=XC;function z4(e){const n=new y2(e),a=g4(y2.prototype.request,n);return rn.extend(a,y2.prototype,n,{allOwnKeys:!0}),rn.extend(a,n,null,{allOwnKeys:!0}),a.create=function(f){return z4(v0(e,f))},a}const Ml=z4(_M);Ml.Axios=y2;Ml.CanceledError=vb;Ml.CancelToken=QY;Ml.isCancel=R4;Ml.VERSION=L4;Ml.toFormData=PT;Ml.AxiosError=sa;Ml.Cancel=Ml.CanceledError;Ml.all=function(n){return Promise.all(n)};Ml.spread=eK;Ml.isAxiosError=tK;Ml.mergeConfig=v0;Ml.AxiosHeaders=Em;Ml.formToJSON=e=>k4(rn.isHTMLForm(e)?new FormData(e):e);Ml.getAdapter=O4.getAdapter;Ml.HttpStatusCode=rK;Ml.default=Ml;const Zi=Ml;function nK(){const e=A5(eM);return e[tM]||e}function YC(e,n){return YC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,f){return u.__proto__=f,u},YC(e,n)}function On(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iK(e){return hT("MuiCircularProgress",e)}UP("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const oK=["className","color","disableShrink","size","style","thickness","value","variant"];let kT=e=>e,zO,NO,jO,BO;const kg=44,aK=db(zO||(zO=kT`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),sK=db(NO||(NO=kT`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),lK=e=>{const{classes:n,variant:a,color:u,disableShrink:f}=e,w={root:["root",a,`color${il(u)}`],svg:["svg"],circle:["circle",`circle${il(a)}`,f&&"circleDisableShrink"]};return Py(w,iK,n)},cK=v_("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[a.variant],n[`color${il(a.color)}`]]}})(({ownerState:e,theme:n})=>pn({display:"inline-block"},e.variant==="determinate"&&{transition:n.transitions.create("transform")},e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&k0(jO||(jO=kT`
      animation: ${0} 1.4s linear infinite;
    `),aK)),uK=v_("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,n)=>n.svg})({display:"block"}),hK=v_("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.circle,n[`circle${il(a.variant)}`],a.disableShrink&&n.circleDisableShrink]}})(({ownerState:e,theme:n})=>pn({stroke:"currentColor"},e.variant==="determinate"&&{transition:n.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&k0(BO||(BO=kT`
      animation: ${0} 1.4s ease-in-out infinite;
    `),sK)),dK=fe.forwardRef(function(n,a){const u=rM({props:n,name:"MuiCircularProgress"}),{className:f,color:w="primary",disableShrink:p=!1,size:s=40,style:L,thickness:F=3.6,value:G=0,variant:H="indeterminate"}=u,X=cc(u,oK),ne=pn({},u,{color:w,disableShrink:p,size:s,thickness:F,value:G,variant:H}),ie=lK(ne),se={},Te={},ue={};if(H==="determinate"){const ce=2*Math.PI*((kg-F)/2);se.strokeDasharray=ce.toFixed(3),ue["aria-valuenow"]=Math.round(G),se.strokeDashoffset=`${((100-G)/100*ce).toFixed(3)}px`,Te.transform="rotate(-90deg)"}return y.jsx(cK,pn({className:$1(ie.root,f),style:pn({width:s,height:s},Te,L),ownerState:ne,ref:a,role:"progressbar"},ue,X,{children:y.jsx(uK,{className:ie.svg,ownerState:ne,viewBox:`${kg/2} ${kg/2} ${kg} ${kg}`,children:y.jsx(hK,{className:ie.circle,style:se,ownerState:ne,cx:kg,cy:kg,r:(kg-F)/2,fill:"none",strokeWidth:F})})}))}),kc=dK;function pK(e){return hT("MuiLinearProgress",e)}UP("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const fK=["className","color","value","valueBuffer","variant"];let D0=e=>e,FO,VO,UO,$O,GO,qO;const KC=4,mK=db(FO||(FO=D0`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),gK=db(VO||(VO=D0`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),_K=db(UO||(UO=D0`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),yK=e=>{const{classes:n,variant:a,color:u}=e,f={root:["root",`color${il(u)}`,a],dashed:["dashed",`dashedColor${il(u)}`],bar1:["bar",`barColor${il(u)}`,(a==="indeterminate"||a==="query")&&"bar1Indeterminate",a==="determinate"&&"bar1Determinate",a==="buffer"&&"bar1Buffer"],bar2:["bar",a!=="buffer"&&`barColor${il(u)}`,a==="buffer"&&`color${il(u)}`,(a==="indeterminate"||a==="query")&&"bar2Indeterminate",a==="buffer"&&"bar2Buffer"]};return Py(f,pK,n)},xM=(e,n)=>n==="inherit"?"currentColor":e.vars?e.vars.palette.LinearProgress[`${n}Bg`]:e.palette.mode==="light"?R5(e.palette[n].main,.62):k5(e.palette[n].main,.5),vK=v_("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.root,n[`color${il(a.color)}`],n[a.variant]]}})(({ownerState:e,theme:n})=>pn({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:xM(n,e.color)},e.color==="inherit"&&e.variant!=="buffer"&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},e.variant==="buffer"&&{backgroundColor:"transparent"},e.variant==="query"&&{transform:"rotate(180deg)"})),xK=v_("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.dashed,n[`dashedColor${il(a.color)}`]]}})(({ownerState:e,theme:n})=>{const a=xM(n,e.color);return pn({position:"absolute",marginTop:0,height:"100%",width:"100%"},e.color==="inherit"&&{opacity:.3},{backgroundImage:`radial-gradient(${a} 0%, ${a} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},k0($O||($O=D0`
    animation: ${0} 3s infinite linear;
  `),_K)),bK=v_("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.bar,n[`barColor${il(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&n.bar1Indeterminate,a.variant==="determinate"&&n.bar1Determinate,a.variant==="buffer"&&n.bar1Buffer]}})(({ownerState:e,theme:n})=>pn({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:e.color==="inherit"?"currentColor":(n.vars||n).palette[e.color].main},e.variant==="determinate"&&{transition:`transform .${KC}s linear`},e.variant==="buffer"&&{zIndex:1,transition:`transform .${KC}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&k0(GO||(GO=D0`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),mK)),wK=v_("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,n)=>{const{ownerState:a}=e;return[n.bar,n[`barColor${il(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&n.bar2Indeterminate,a.variant==="buffer"&&n.bar2Buffer]}})(({ownerState:e,theme:n})=>pn({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},e.variant!=="buffer"&&{backgroundColor:e.color==="inherit"?"currentColor":(n.vars||n).palette[e.color].main},e.color==="inherit"&&{opacity:.3},e.variant==="buffer"&&{backgroundColor:xM(n,e.color),transition:`transform .${KC}s linear`}),({ownerState:e})=>(e.variant==="indeterminate"||e.variant==="query")&&k0(qO||(qO=D0`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),gK)),SK=fe.forwardRef(function(n,a){const u=rM({props:n,name:"MuiLinearProgress"}),{className:f,color:w="primary",value:p,valueBuffer:s,variant:L="indeterminate"}=u,F=cc(u,fK),G=pn({},u,{color:w,variant:L}),H=yK(G),X=nK(),ne={},ie={bar1:{},bar2:{}};if((L==="determinate"||L==="buffer")&&p!==void 0){ne["aria-valuenow"]=Math.round(p),ne["aria-valuemin"]=0,ne["aria-valuemax"]=100;let se=p-100;X.direction==="rtl"&&(se=-se),ie.bar1.transform=`translateX(${se}%)`}if(L==="buffer"&&s!==void 0){let se=(s||0)-100;X.direction==="rtl"&&(se=-se),ie.bar2.transform=`translateX(${se}%)`}return y.jsxs(vK,pn({className:$1(H.root,f),ownerState:G,role:"progressbar"},ne,{ref:a},F,{children:[L==="buffer"?y.jsx(xK,{className:H.dashed,ownerState:G}):null,y.jsx(bK,{className:H.bar1,ownerState:G,style:ie.bar1}),L==="determinate"?null:y.jsx(wK,{className:H.bar2,ownerState:G,style:ie.bar2})]}))}),N4=SK;function j4(e){var n,a,u="";if(typeof e=="string"||typeof e=="number")u+=e;else if(typeof e=="object")if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(a=j4(e[n]))&&(u&&(u+=" "),u+=a);else for(n in e)e[n]&&(u&&(u+=" "),u+=n);return u}function $g(){for(var e,n,a=0,u="";a<arguments.length;)(e=arguments[a++])&&(n=j4(e))&&(u&&(u+=" "),u+=n);return u}const v1=e=>typeof e=="number"&&!isNaN(e),Ty=e=>typeof e=="string",dh=e=>typeof e=="function",v2=e=>Ty(e)||dh(e)?e:null,vI=e=>fe.isValidElement(e)||Ty(e)||dh(e)||v1(e);function TK(e,n,a){a===void 0&&(a=300);const{scrollHeight:u,style:f}=e;requestAnimationFrame(()=>{f.minHeight="initial",f.height=u+"px",f.transition=`all ${a}ms`,requestAnimationFrame(()=>{f.height="0",f.padding="0",f.margin="0",setTimeout(n,a)})})}function RT(e){let{enter:n,exit:a,appendPosition:u=!1,collapse:f=!0,collapseDuration:w=300}=e;return function(p){let{children:s,position:L,preventExitTransition:F,done:G,nodeRef:H,isIn:X}=p;const ne=u?`${n}--${L}`:n,ie=u?`${a}--${L}`:a,se=fe.useRef(0);return fe.useLayoutEffect(()=>{const Te=H.current,ue=ne.split(" "),ce=de=>{de.target===H.current&&(Te.dispatchEvent(new Event("d")),Te.removeEventListener("animationend",ce),Te.removeEventListener("animationcancel",ce),se.current===0&&de.type!=="animationcancel"&&Te.classList.remove(...ue))};Te.classList.add(...ue),Te.addEventListener("animationend",ce),Te.addEventListener("animationcancel",ce)},[]),fe.useEffect(()=>{const Te=H.current,ue=()=>{Te.removeEventListener("animationend",ue),f?TK(Te,G,w):G()};X||(F?ue():(se.current=1,Te.className+=` ${ie}`,Te.addEventListener("animationend",ue)))},[X]),ts.createElement(ts.Fragment,null,s)}}function WO(e,n){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:n}:{}}const Fd={list:new Map,emitQueue:new Map,on(e,n){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(n),this},off(e,n){if(n){const a=this.list.get(e).filter(u=>u!==n);return this.list.set(e,a),this}return this.list.delete(e),this},cancelEmit(e){const n=this.emitQueue.get(e);return n&&(n.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach(n=>{const a=setTimeout(()=>{n(...[].slice.call(arguments,1))},0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(a)})}},Vw=e=>{let{theme:n,type:a,...u}=e;return ts.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:n==="colored"?"currentColor":`var(--toastify-icon-color-${a})`,...u})},xI={info:function(e){return ts.createElement(Vw,{...e},ts.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return ts.createElement(Vw,{...e},ts.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return ts.createElement(Vw,{...e},ts.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return ts.createElement(Vw,{...e},ts.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return ts.createElement("div",{className:"Toastify__spinner"})}};function EK(e){const[,n]=fe.useReducer(ne=>ne+1,0),[a,u]=fe.useState([]),f=fe.useRef(null),w=fe.useRef(new Map).current,p=ne=>a.indexOf(ne)!==-1,s=fe.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:e,containerId:null,isToastActive:p,getToast:ne=>w.get(ne)}).current;function L(ne){let{containerId:ie}=ne;const{limit:se}=s.props;!se||ie&&s.containerId!==ie||(s.count-=s.queue.length,s.queue=[])}function F(ne){u(ie=>ne==null?[]:ie.filter(se=>se!==ne))}function G(){const{toastContent:ne,toastProps:ie,staleId:se}=s.queue.shift();X(ne,ie,se)}function H(ne,ie){let{delay:se,staleId:Te,...ue}=ie;if(!vI(ne)||function(Wt){return!f.current||s.props.enableMultiContainer&&Wt.containerId!==s.props.containerId||w.has(Wt.toastId)&&Wt.updateId==null}(ue))return;const{toastId:ce,updateId:de,data:Ee}=ue,{props:Ne}=s,rt=()=>F(ce),tt=de==null;tt&&s.count++;const Ge={...Ne,style:Ne.toastStyle,key:s.toastKey++,...Object.fromEntries(Object.entries(ue).filter(Wt=>{let[Ar,mt]=Wt;return mt!=null})),toastId:ce,updateId:de,data:Ee,closeToast:rt,isIn:!1,className:v2(ue.className||Ne.toastClassName),bodyClassName:v2(ue.bodyClassName||Ne.bodyClassName),progressClassName:v2(ue.progressClassName||Ne.progressClassName),autoClose:!ue.isLoading&&(_t=ue.autoClose,yt=Ne.autoClose,_t===!1||v1(_t)&&_t>0?_t:yt),deleteToast(){const Wt=WO(w.get(ce),"removed");w.delete(ce),Fd.emit(4,Wt);const Ar=s.queue.length;if(s.count=ce==null?s.count-s.displayedToast:s.count-1,s.count<0&&(s.count=0),Ar>0){const mt=ce==null?s.props.limit:1;if(Ar===1||mt===1)s.displayedToast++,G();else{const nr=mt>Ar?Ar:mt;s.displayedToast=nr;for(let Xt=0;Xt<nr;Xt++)G()}}else n()}};var _t,yt;Ge.iconOut=function(Wt){let{theme:Ar,type:mt,isLoading:nr,icon:Xt}=Wt,Ht=null;const Qt={theme:Ar,type:mt};return Xt===!1||(dh(Xt)?Ht=Xt(Qt):fe.isValidElement(Xt)?Ht=fe.cloneElement(Xt,Qt):Ty(Xt)||v1(Xt)?Ht=Xt:nr?Ht=xI.spinner():(sr=>sr in xI)(mt)&&(Ht=xI[mt](Qt))),Ht}(Ge),dh(ue.onOpen)&&(Ge.onOpen=ue.onOpen),dh(ue.onClose)&&(Ge.onClose=ue.onClose),Ge.closeButton=Ne.closeButton,ue.closeButton===!1||vI(ue.closeButton)?Ge.closeButton=ue.closeButton:ue.closeButton===!0&&(Ge.closeButton=!vI(Ne.closeButton)||Ne.closeButton);let Et=ne;fe.isValidElement(ne)&&!Ty(ne.type)?Et=fe.cloneElement(ne,{closeToast:rt,toastProps:Ge,data:Ee}):dh(ne)&&(Et=ne({closeToast:rt,toastProps:Ge,data:Ee})),Ne.limit&&Ne.limit>0&&s.count>Ne.limit&&tt?s.queue.push({toastContent:Et,toastProps:Ge,staleId:Te}):v1(se)?setTimeout(()=>{X(Et,Ge,Te)},se):X(Et,Ge,Te)}function X(ne,ie,se){const{toastId:Te}=ie;se&&w.delete(se);const ue={content:ne,props:ie};w.set(Te,ue),u(ce=>[...ce,Te].filter(de=>de!==se)),Fd.emit(4,WO(ue,ue.props.updateId==null?"added":"updated"))}return fe.useEffect(()=>(s.containerId=e.containerId,Fd.cancelEmit(3).on(0,H).on(1,ne=>f.current&&F(ne)).on(5,L).emit(2,s),()=>{w.clear(),Fd.emit(3,s)}),[]),fe.useEffect(()=>{s.props=e,s.isToastActive=p,s.displayedToast=a.length}),{getToastToRender:function(ne){const ie=new Map,se=Array.from(w.values());return e.newestOnTop&&se.reverse(),se.forEach(Te=>{const{position:ue}=Te.props;ie.has(ue)||ie.set(ue,[]),ie.get(ue).push(Te)}),Array.from(ie,Te=>ne(Te[0],Te[1]))},containerRef:f,isToastActive:p}}function HO(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function ZO(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function IK(e){const[n,a]=fe.useState(!1),[u,f]=fe.useState(!1),w=fe.useRef(null),p=fe.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,s=fe.useRef(e),{autoClose:L,pauseOnHover:F,closeToast:G,onClick:H,closeOnClick:X}=e;function ne(Ee){if(e.draggable){Ee.nativeEvent.type==="touchstart"&&Ee.nativeEvent.preventDefault(),p.didMove=!1,document.addEventListener("mousemove",ue),document.addEventListener("mouseup",ce),document.addEventListener("touchmove",ue),document.addEventListener("touchend",ce);const Ne=w.current;p.canCloseOnClick=!0,p.canDrag=!0,p.boundingRect=Ne.getBoundingClientRect(),Ne.style.transition="",p.x=HO(Ee.nativeEvent),p.y=ZO(Ee.nativeEvent),e.draggableDirection==="x"?(p.start=p.x,p.removalDistance=Ne.offsetWidth*(e.draggablePercent/100)):(p.start=p.y,p.removalDistance=Ne.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent/100))}}function ie(Ee){if(p.boundingRect){const{top:Ne,bottom:rt,left:tt,right:Ge}=p.boundingRect;Ee.nativeEvent.type!=="touchend"&&e.pauseOnHover&&p.x>=tt&&p.x<=Ge&&p.y>=Ne&&p.y<=rt?Te():se()}}function se(){a(!0)}function Te(){a(!1)}function ue(Ee){const Ne=w.current;p.canDrag&&Ne&&(p.didMove=!0,n&&Te(),p.x=HO(Ee),p.y=ZO(Ee),p.delta=e.draggableDirection==="x"?p.x-p.start:p.y-p.start,p.start!==p.x&&(p.canCloseOnClick=!1),Ne.style.transform=`translate${e.draggableDirection}(${p.delta}px)`,Ne.style.opacity=""+(1-Math.abs(p.delta/p.removalDistance)))}function ce(){document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",ce),document.removeEventListener("touchmove",ue),document.removeEventListener("touchend",ce);const Ee=w.current;if(p.canDrag&&p.didMove&&Ee){if(p.canDrag=!1,Math.abs(p.delta)>p.removalDistance)return f(!0),void e.closeToast();Ee.style.transition="transform 0.2s, opacity 0.2s",Ee.style.transform=`translate${e.draggableDirection}(0)`,Ee.style.opacity="1"}}fe.useEffect(()=>{s.current=e}),fe.useEffect(()=>(w.current&&w.current.addEventListener("d",se,{once:!0}),dh(e.onOpen)&&e.onOpen(fe.isValidElement(e.children)&&e.children.props),()=>{const Ee=s.current;dh(Ee.onClose)&&Ee.onClose(fe.isValidElement(Ee.children)&&Ee.children.props)}),[]),fe.useEffect(()=>(e.pauseOnFocusLoss&&(document.hasFocus()||Te(),window.addEventListener("focus",se),window.addEventListener("blur",Te)),()=>{e.pauseOnFocusLoss&&(window.removeEventListener("focus",se),window.removeEventListener("blur",Te))}),[e.pauseOnFocusLoss]);const de={onMouseDown:ne,onTouchStart:ne,onMouseUp:ie,onTouchEnd:ie};return L&&F&&(de.onMouseEnter=Te,de.onMouseLeave=se),X&&(de.onClick=Ee=>{H&&H(Ee),p.canCloseOnClick&&G()}),{playToast:se,pauseToast:Te,isRunning:n,preventExitTransition:u,toastRef:w,eventHandlers:de}}function B4(e){let{closeToast:n,theme:a,ariaLabel:u="close"}=e;return ts.createElement("button",{className:`Toastify__close-button Toastify__close-button--${a}`,type:"button",onClick:f=>{f.stopPropagation(),n(f)},"aria-label":u},ts.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ts.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function CK(e){let{delay:n,isRunning:a,closeToast:u,type:f="default",hide:w,className:p,style:s,controlledProgress:L,progress:F,rtl:G,isIn:H,theme:X}=e;const ne=w||L&&F===0,ie={...s,animationDuration:`${n}ms`,animationPlayState:a?"running":"paused",opacity:ne?0:1};L&&(ie.transform=`scaleX(${F})`);const se=$g("Toastify__progress-bar",L?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${X}`,`Toastify__progress-bar--${f}`,{"Toastify__progress-bar--rtl":G}),Te=dh(p)?p({rtl:G,type:f,defaultClassName:se}):$g(se,p);return ts.createElement("div",{role:"progressbar","aria-hidden":ne?"true":"false","aria-label":"notification timer",className:Te,style:ie,[L&&F>=1?"onTransitionEnd":"onAnimationEnd"]:L&&F<1?null:()=>{H&&u()}})}const AK=e=>{const{isRunning:n,preventExitTransition:a,toastRef:u,eventHandlers:f}=IK(e),{closeButton:w,children:p,autoClose:s,onClick:L,type:F,hideProgressBar:G,closeToast:H,transition:X,position:ne,className:ie,style:se,bodyClassName:Te,bodyStyle:ue,progressClassName:ce,progressStyle:de,updateId:Ee,role:Ne,progress:rt,rtl:tt,toastId:Ge,deleteToast:_t,isIn:yt,isLoading:Et,iconOut:Wt,closeOnClick:Ar,theme:mt}=e,nr=$g("Toastify__toast",`Toastify__toast-theme--${mt}`,`Toastify__toast--${F}`,{"Toastify__toast--rtl":tt},{"Toastify__toast--close-on-click":Ar}),Xt=dh(ie)?ie({rtl:tt,position:ne,type:F,defaultClassName:nr}):$g(nr,ie),Ht=!!rt||!s,Qt={closeToast:H,type:F,theme:mt};let sr=null;return w===!1||(sr=dh(w)?w(Qt):fe.isValidElement(w)?fe.cloneElement(w,Qt):B4(Qt)),ts.createElement(X,{isIn:yt,done:_t,position:ne,preventExitTransition:a,nodeRef:u},ts.createElement("div",{id:Ge,onClick:L,className:Xt,...f,style:se,ref:u},ts.createElement("div",{...yt&&{role:Ne},className:dh(Te)?Te({type:F}):$g("Toastify__toast-body",Te),style:ue},Wt!=null&&ts.createElement("div",{className:$g("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!Et})},Wt),ts.createElement("div",null,p)),sr,ts.createElement(CK,{...Ee&&!Ht?{key:`pb-${Ee}`}:{},rtl:tt,theme:mt,delay:s,isRunning:n,isIn:yt,closeToast:H,hide:G,type:F,style:de,className:ce,controlledProgress:Ht,progress:rt||0})))},DT=function(e,n){return n===void 0&&(n=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:n}},PK=RT(DT("bounce",!0));RT(DT("slide",!0));RT(DT("zoom"));RT(DT("flip"));const Pu=fe.forwardRef((e,n)=>{const{getToastToRender:a,containerRef:u,isToastActive:f}=EK(e),{className:w,style:p,rtl:s,containerId:L}=e;function F(G){const H=$g("Toastify__toast-container",`Toastify__toast-container--${G}`,{"Toastify__toast-container--rtl":s});return dh(w)?w({position:G,rtl:s,defaultClassName:H}):$g(H,v2(w))}return fe.useEffect(()=>{n&&(n.current=u.current)},[]),ts.createElement("div",{ref:u,className:"Toastify",id:L},a((G,H)=>{const X=H.length?{...p}:{...p,pointerEvents:"none"};return ts.createElement("div",{className:F(G),style:X,key:`container-${G}`},H.map((ne,ie)=>{let{content:se,props:Te}=ne;return ts.createElement(AK,{...Te,isIn:f(Te.toastId),style:{...Te.style,"--nth":ie+1,"--len":H.length},key:`toast-${Te.key}`},se)}))}))});Pu.displayName="ToastContainer",Pu.defaultProps={position:"top-right",transition:PK,autoClose:5e3,closeButton:B4,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let bI,iy=new Map,o1=[],MK=1;function F4(){return""+MK++}function kK(e){return e&&(Ty(e.toastId)||v1(e.toastId))?e.toastId:F4()}function x1(e,n){return iy.size>0?Fd.emit(0,e,n):o1.push({content:e,options:n}),n.toastId}function mS(e,n){return{...n,type:n&&n.type||e,toastId:kK(n)}}function Uw(e){return(n,a)=>x1(n,mS(e,a))}function ai(e,n){return x1(e,mS("default",n))}ai.loading=(e,n)=>x1(e,mS("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...n})),ai.promise=function(e,n,a){let u,{pending:f,error:w,success:p}=n;f&&(u=Ty(f)?ai.loading(f,a):ai.loading(f.render,{...a,...f}));const s={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},L=(G,H,X)=>{if(H==null)return void ai.dismiss(u);const ne={type:G,...s,...a,data:X},ie=Ty(H)?{render:H}:H;return u?ai.update(u,{...ne,...ie}):ai(ie.render,{...ne,...ie}),X},F=dh(e)?e():e;return F.then(G=>L("success",p,G)).catch(G=>L("error",w,G)),F},ai.success=Uw("success"),ai.info=Uw("info"),ai.error=Uw("error"),ai.warning=Uw("warning"),ai.warn=ai.warning,ai.dark=(e,n)=>x1(e,mS("default",{theme:"dark",...n})),ai.dismiss=e=>{iy.size>0?Fd.emit(1,e):o1=o1.filter(n=>e!=null&&n.options.toastId!==e)},ai.clearWaitingQueue=function(e){return e===void 0&&(e={}),Fd.emit(5,e)},ai.isActive=e=>{let n=!1;return iy.forEach(a=>{a.isToastActive&&a.isToastActive(e)&&(n=!0)}),n},ai.update=function(e,n){n===void 0&&(n={}),setTimeout(()=>{const a=function(u,f){let{containerId:w}=f;const p=iy.get(w||bI);return p&&p.getToast(u)}(e,n);if(a){const{props:u,content:f}=a,w={delay:100,...u,...n,toastId:n.toastId||e,updateId:F4()};w.toastId!==e&&(w.staleId=e);const p=w.render||f;delete w.render,x1(p,w)}},0)},ai.done=e=>{ai.update(e,{progress:1})},ai.onChange=e=>(Fd.on(4,e),()=>{Fd.off(4,e)}),ai.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},ai.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Fd.on(2,e=>{bI=e.containerId||e,iy.set(bI,e),o1.forEach(n=>{Fd.emit(0,n.content,n.options)}),o1=[]}).on(3,e=>{iy.delete(e.containerId||e),iy.size===0&&Fd.off(0).off(1).off(5)});const Ia=()=>{const{theme:e}=ma(a=>a.app),n=window.matchMedia("(prefers-color-scheme: dark)");return e==="light"?"light":e==="dark"?"dark":n?"light":"dark"},V4=e=>{const n=window.matchMedia("(prefers-color-scheme: dark)"),a=document.querySelector("html");e==="light"?a.dataset.theme="light":e==="dark"?a.dataset.theme="dark":n?a.dataset.theme="light":a.dataset.theme="dark"};function Of(){const[e,n]=fe.useState(""),[a,u]=fe.useState([]),[f,w]=fe.useState(!1),[p,s]=fe.useState(!1),{currentUser:L,loading:F}=ma(ie=>ie.user),G=L;eu();const H=Ia();fe.useState(!0),fe.useState(null),fe.useState(),fe.useState(!1);const X=ie=>{s(!0),n(ie.target.value)},ne=()=>{w(!1)};return fe.useEffect(()=>{s(!0);const ie=async()=>{try{let Te={}.VITE_SERVER;const ue=await Zi.get(`${Te}/staffs/plan?search=${e}`,{withCredentials:!0});u(ue.data),s(!1)}catch(Te){s(!1);let ue=Te.response?Te.response.data.message:Te.message;ai.error(ue,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})}};let se=setTimeout(()=>{e&&ie()},1500);return()=>clearTimeout(se)},[e]),y.jsxs("div",{className:"headerContainer",children:[y.jsx("div",{className:"headerLeft",children:y.jsx(a_,{to:"/",children:y.jsxs("span",{className:"headerLogo",children:[y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:""}),y.jsx("div",{}),y.jsx("p",{children:"MPPHURD"})]})})}),y.jsx("div",{className:"headerSearch headerMiddle",children:y.jsx(f4,{onClickAway:ne,children:y.jsxs("div",{className:"searchBar",children:[y.jsx("label",{htmlFor:"headerSearchInput",children:y.jsx($5,{className:"searchIcon"})}),y.jsx("input",{id:"headerSearchInput",type:"text",placeholder:"Start typing to search",className:"searchInput",onChange:ie=>X(ie),onFocus:()=>w(!0),value:e}),e&&y.jsxs("div",{className:"searchBarCloseButton",onClick:()=>n(""),children:[" ",y.jsx(Mc,{})]}),e&&f&&y.jsxs("div",{className:"searchResult",children:[y.jsxs("header",{children:[p&&y.jsx(N4,{}),y.jsxs("div",{className:"searchResultTitle",children:[y.jsx("h2",{children:"Search Results"}),y.jsxs("div",{children:[y.jsx("span",{children:a.length||0}),y.jsx("span",{children:"Found"})]})]})]}),y.jsxs("section",{children:[a==null?void 0:a.map(ie=>y.jsx(m4,{data:ie,changeOpen:w},ie._id)),a.length<1&&y.jsx("div",{children:"No Result Found"})]})]})]})})}),y.jsxs("div",{className:"headerRight",children:[y.jsx("div",{className:"headerLinks",children:y.jsx(p4,{})}),y.jsxs("div",{className:"headerIcons",children:[y.jsxs("div",{className:"headerIconItem",children:[y.jsx(V5,{className:"notificationIcon"}),y.jsx("span",{className:"headerIconBadge",children:"3"})]}),y.jsxs("div",{className:"headerIconItem",children:[y.jsx(N5,{className:"emailIcon"}),y.jsx("span",{className:"headerIconBadge",children:"5"})]})]}),y.jsxs("div",{className:"headerUser",children:[y.jsxs("div",{className:"headerDetails",children:[y.jsx("span",{className:"headerName",children:`${G.firstName} ${G.lastName}`}),y.jsx("span",{className:"headerOffice",children:`${G.position}`})]}),y.jsx("img",{src:G.profilePicture||"/assets/persons/no_avatar.png",alt:"",className:"headerImg"})]})]})]})}const XO={currentUser:null,loading:null,error:null},U4=OP({name:"user",initialState:XO,reducers:{loginStart:e=>{e.loading=!0,e.error=null,e.currentUser=null},loginSuccess:(e,n)=>{e.currentUser=n.payload,e.loading=null,e.error=null},loginFailure:e=>{e.currentUser=null,e.loading=null,e.error=!0},logout:e=>{e.currentUser=null,e.loading=null,e.error=null}},extraReducers:e=>{e.addCase(P0,n=>XO)}}),{loginStart:RK,loginSuccess:$4,loginFailure:YO,logout:G4}=U4.actions,DK=U4.reducer;var bM={},wM={};wM.__esModule=!0;wM.default=zK;function x2(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?x2=function(a){return typeof a}:x2=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},x2(e)}function wI(){}var OK={getItem:wI,setItem:wI,removeItem:wI};function LK(e){if((typeof self>"u"?"undefined":x2(self))!=="object"||!(e in self))return!1;try{var n=self[e],a="redux-persist ".concat(e," test");n.setItem(a,"test"),n.getItem(a),n.removeItem(a)}catch{return!1}return!0}function zK(e){var n="".concat(e,"Storage");return LK(n)?self[n]:OK}bM.__esModule=!0;bM.default=BK;var NK=jK(wM);function jK(e){return e&&e.__esModule?e:{default:e}}function BK(e){var n=(0,NK.default)(e);return{getItem:function(u){return new Promise(function(f,w){f(n.getItem(u))})},setItem:function(u,f){return new Promise(function(w,p){w(n.setItem(u,f))})},removeItem:function(u){return new Promise(function(f,w){f(n.removeItem(u))})}}}var q4=void 0,FK=VK(bM);function VK(e){return e&&e.__esModule?e:{default:e}}var UK=(0,FK.default)("local");q4=UK;const KO={currentAdmin:null,loading:null,error:null},W4=OP({name:"admin",initialState:KO,reducers:{adminLoginStart:e=>{e.loading=!0,e.error=null,e.currentAdmin=null},adminLoginSuccess:(e,n)=>{e.currentAdmin=n.payload,e.loading=null,e.error=null},adminLoginFailure:e=>{e.currentAdmin=null,e.loading=null,e.error=!0},adminLogout:e=>{e.currentAdmin=null,e.loading=null,e.error=null}},extraReducers:e=>{e.addCase(P0,n=>KO)}}),{adminLoginStart:$K,adminLoginSuccess:GK,adminLoginFailure:qK,adminLogout:H4}=W4.actions,WK=W4.reducer,HK={key:"root",version:1,storage:q4},ZK=Kj({user:DK,admin:WK,app:$$}),XK=z$(HK,ZK),Z4=d$({reducer:XK,middleware:e=>e({serializableCheck:{ignoredActions:[NP,cT,jP,BP,P0,FP]}})}),YK=U$(Z4);const KK=["Stack A1","Stack A2","Stack A3","Stack A4","Stack A5","Stack A6","Stack A7","Stack A8","Stack A9","Stack A10","Stack B1","Stack B2","Stack B3","Stack B4","Stack B5","Stack B6","Stack B7","Stack B8","Stack B9","Stack B10","Stack C1","Stack C2","Stack C3","Stack C4","Stack C5","Stack C6","Stack C7","Stack C8","Stack C9","Stack C10","Stack D1","Stack D2","Stack D3","Stack D4","Stack D5","Stack D6","Stack D7","Stack D8","Stack D9","Stack D10"],X4=["Akoko-Edo","Egor","Esan Central","Esan North-East","Esan South-East","Esan West","Etsako Central","Etsako East","Etsako West","Igueben","Ikpoba-Okha","Oredo","Orhionmwon","Ovia North-East","Ovia South-West","Owan East","Owan West","Uhunmwonde"],Y4=["Proposed","Under Construction","Built"],K4=["Commercial","Residential","Mixed","Religious","Educational","Industrial","Recreational"],JK=["MINUTE PLAN","UPDATE PLAN","COMMENT ON PLAN","GENERATE PLAN NUMBER","CREATE PLAN","CREATE BILL","VET PLAN","EXPORT DATA"],QK=["Action Taken","Observation","Issue Raised","Pending Action"],J4=["Process Further","Plan In Order","Issue Raised","Recommended for Approval","Recommended for Rejection","Issuance of Conveyance"],eJ=["Cleared","Issue Raised","Process Further"],tJ=["Architect","Civil Engineer","Mechanical Engineer","Electrical Engineer","Town Planning Officer","Estate Surveyor","Quantity Surveyor","ICTA"],rJ=["Hon. Commissioner","Perm. Secretary","Director","APO","STPO","TPO","TA","ICTA","ESV","QS","Staff"],nJ=["Product Feedback","Feature Requests","Bug / Issue Reports","Complaints & Questions","Praise & Appreciation"];function iJ({classList:e}){const[n,a]=fe.useState(!1),[u,f]=fe.useState(!1),{currentUser:w}=ma(ne=>ne.user);ma(ne=>ne.admin);const p=Ia(),s=()=>a(!0),L=()=>{f(!1),a(!1)},F="Escape",G="keyup";H(L);function H(ne){const ie=fe.useCallback(se=>{se.key===F&&ne()},[ne]);fe.useEffect(()=>(document.addEventListener(G,ie,!1),()=>{document.removeEventListener(G,ie,!1)}),[ie])}const X=async ne=>{ne.preventDefault(),f(!0);const ie=new FormData(ne.target),se={category:ie.get("minuteStatus"),comment:ie.get("minuteText")};try{let Te={}.VITE_SERVER;const ue=await Zi.post(`${Te}/staffs/staff/${w._id}/feedback`,se);L(),setTimeout(()=>{ai.success(ue.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:p})},200)}catch(Te){let ue=Te.response?Te.response.data.message:Te.message;f(!1),ai.error(ue,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:p})}};return fe.useEffect(()=>{const ne=document.querySelector(".modalView");ne&&(n?ne.showModal():ne.close())},[n]),y.jsxs("div",{children:[y.jsx("div",{children:y.jsx("span",{className:`${e} modalTrigger feedBackModalButton`,onClick:s,children:"Send Feedback"})}),n&&y.jsxs("dialog",{className:"modalView",children:[y.jsxs("header",{children:[y.jsx("span",{children:"Feedback"}),y.jsx("div",{className:"modalViewCloseButton",onClick:L,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:X,children:[y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Add Feedback Comment"})}),y.jsx("div",{children:y.jsxs("div",{className:"minuteItems",children:[y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteStatus",children:"Category:"}),y.jsxs("select",{required:!0,name:"minuteStatus",id:"minuteStatus",children:[y.jsx("option",{value:"",children:"..."}),nJ.map(ne=>y.jsx("option",{value:ne,children:ne}))]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteText",children:"Comment:"}),y.jsx("textarea",{required:!0,name:"minuteText",id:"minuteText",cols:"30",rows:"8"})]})]})})]}),y.jsx("footer",{children:y.jsx("button",{type:"submit",className:"primary",disabled:u,children:u?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Send"})})]})]})]})}function Lf({selected:e}){ql();const n=eu();ma(f=>f.app);const a=Ia(),u=()=>{n(G4()),n(r_()),setTimeout(()=>{ai.success("Logout Successful",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a})},0)};return y.jsx("div",{className:"sideBar",children:y.jsxs("div",{className:"sideBarWrapper",children:[y.jsxs("ul",{className:"sideBarList",children:[y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/",children:[y.jsx(z5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText ",children:"Dashboard"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/permit",children:[y.jsx(G5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Approval"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/petition",children:[y.jsx(dH,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Petition"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/b_control",children:[y.jsx(xH,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"B.Control"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/d_control",children:[y.jsx(L5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"D.Control"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/activities",children:[y.jsx(O5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Activities"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/analysis",children:[y.jsx(U5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Analysis"})]})})]}),y.jsxs("div",{className:"sideBarLogout",onClick:u,children:[y.jsx(F5,{className:"sideBarIcon"}),y.jsx("span",{children:"Log Out"})]}),y.jsx("div",{className:"sidebarFeedBackButton",children:y.jsx(iJ,{})}),y.jsx(Pu,{})]})})}function oJ({action:e,planNumber:n,options:a,lastPlanNo:u}){const f=ql();return y.jsxs("div",{className:"topBar",children:[y.jsxs("div",{className:"topBarLeft",children:[y.jsx(cH,{className:"topBarArrowIcon",onClick:()=>f(-1)}),y.jsxs("div",{className:"topBarAction",children:[y.jsx("span",{className:"topBarName",children:e}),n&&y.jsx("span",{className:"topBarDivider",children:y.jsx(gH,{})}),n&&y.jsx("span",{className:"topBarPlanNumber",children:n})]})]}),y.jsxs("div",{className:"topBarRight",children:[u&&y.jsxs("span",{className:"topBarRight-planText",children:["Last Plan Number: ",y.jsx("span",{children:u})]}),y.jsx("span",{className:"topBarOptions",children:a})]})]})}function Qv({type:e,AD2:n,R:a,BD:u,data:f}){const w=L=>y.jsxs("div",{className:"planInfoCard",children:[y.jsxs("div",{className:"planInfoDetails",children:[y.jsx("h2",{className:"planInfoCardTitle",children:L}),y.jsxs("div",{className:"planInfoItems",children:[y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Name:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.name})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Gender:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.gender})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Address:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.address})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Phone:"}),y.jsxs("span",{className:"planInfoText",children:[f==null?void 0:f.phone,(f==null?void 0:f.phone1)&&", "+(f==null?void 0:f.phone1)]})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Email:"}),y.jsxs("span",{className:"planInfoText",children:[f==null?void 0:f.email,(f==null?void 0:f.email1)&&", "+(f==null?void 0:f.email1)]})]})]})]}),u&&y.jsx("img",{className:"planInfoImg",src:(f==null?void 0:f.photo)||"/assets/persons/no_avatar.png",alt:"Passport"})]}),p=()=>y.jsx("div",{className:"planInfoCard",children:y.jsxs("div",{className:"planInfoDetails",children:[y.jsx("h2",{className:"planInfoCardTitle",children:"Organization Information"}),y.jsxs("div",{className:"planInfoItems",children:[y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Name:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.name})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Address:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.address})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Phone:"}),y.jsxs("span",{className:"planInfoText",children:[f==null?void 0:f.phone,(f==null?void 0:f.phone1)&&", "+(f==null?void 0:f.phone1)]})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Email:"}),y.jsxs("span",{className:"planInfoText",children:[f==null?void 0:f.email,(f==null?void 0:f.email1)&&", "+(f==null?void 0:f.email1)]})]})]})]})}),s=()=>y.jsx("div",{className:"planInfoCard",children:y.jsxs("div",{className:"planInfoDetails",children:[y.jsx("h2",{className:"planInfoCardTitle",children:"Development/Building Details"}),y.jsxs("div",{className:"planInfoItems",children:[y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Name:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.name})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Location:"}),y.jsxs("span",{className:"planInfoText",children:[(f==null?void 0:f.plotNo)&&(f==null?void 0:f.plotNo)+","," ",(f==null?void 0:f.address)&&(f==null?void 0:f.address)]})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Region:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.region})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"LGA:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.lga})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Zone:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.zone})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Area:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.area})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"No of Floor:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.noOfFloors})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Status:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.status})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Building Type:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.type})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Building Use:"}),y.jsx("span",{className:"planInfoText",children:f==null?void 0:f.use})]}),y.jsxs("div",{className:"planInfoItem",children:[y.jsx("span",{className:"planInfoTitle",children:"Assessment:"}),y.jsx("span",{className:"planInfoText",children:Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format((f==null?void 0:f.assessedAmount)||0)})]})]})]})});return y.jsx(y.Fragment,{children:e==="individual"?w("Applicant Details"):e==="rep"?w("Representative Details"):e==="organization"?p():e==="building"?s():""})}var Q4={exports:{}};(function(e,n){(function(a,u){e.exports=u(fe,jS)})(typeof self<"u"?self:EA,function(a,u){return function(){var f={156:function(L){L.exports=a},111:function(L){L.exports=u},582:function(L,F,G){G.r(F),G.d(F,{__addDisposableResource:function(){return Oi},__assign:function(){return ne},__asyncDelegator:function(){return Ht},__asyncGenerator:function(){return Xt},__asyncValues:function(){return Qt},__await:function(){return nr},__awaiter:function(){return rt},__classPrivateFieldGet:function(){return wi},__classPrivateFieldIn:function(){return Vn},__classPrivateFieldSet:function(){return hi},__createBinding:function(){return Ge},__decorate:function(){return se},__disposeResources:function(){return Nn},__esDecorate:function(){return ue},__exportStar:function(){return _t},__extends:function(){return X},__generator:function(){return tt},__importDefault:function(){return vn},__importStar:function(){return ln},__makeTemplateObject:function(){return sr},__metadata:function(){return Ne},__param:function(){return Te},__propKey:function(){return de},__read:function(){return Et},__rest:function(){return ie},__runInitializers:function(){return ce},__setFunctionName:function(){return Ee},__spread:function(){return Wt},__spreadArray:function(){return mt},__spreadArrays:function(){return Ar},__values:function(){return yt}});var H=function(Pt,Dt){return H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ir,xr){Ir.__proto__=xr}||function(Ir,xr){for(var Kt in xr)Object.prototype.hasOwnProperty.call(xr,Kt)&&(Ir[Kt]=xr[Kt])},H(Pt,Dt)};function X(Pt,Dt){if(typeof Dt!="function"&&Dt!==null)throw new TypeError("Class extends value "+String(Dt)+" is not a constructor or null");function Ir(){this.constructor=Pt}H(Pt,Dt),Pt.prototype=Dt===null?Object.create(Dt):(Ir.prototype=Dt.prototype,new Ir)}var ne=function(){return ne=Object.assign||function(Pt){for(var Dt,Ir=1,xr=arguments.length;Ir<xr;Ir++)for(var Kt in Dt=arguments[Ir])Object.prototype.hasOwnProperty.call(Dt,Kt)&&(Pt[Kt]=Dt[Kt]);return Pt},ne.apply(this,arguments)};function ie(Pt,Dt){var Ir={};for(var xr in Pt)Object.prototype.hasOwnProperty.call(Pt,xr)&&Dt.indexOf(xr)<0&&(Ir[xr]=Pt[xr]);if(Pt!=null&&typeof Object.getOwnPropertySymbols=="function"){var Kt=0;for(xr=Object.getOwnPropertySymbols(Pt);Kt<xr.length;Kt++)Dt.indexOf(xr[Kt])<0&&Object.prototype.propertyIsEnumerable.call(Pt,xr[Kt])&&(Ir[xr[Kt]]=Pt[xr[Kt]])}return Ir}function se(Pt,Dt,Ir,xr){var Kt,Cn=arguments.length,gn=Cn<3?Dt:xr===null?xr=Object.getOwnPropertyDescriptor(Dt,Ir):xr;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")gn=Reflect.decorate(Pt,Dt,Ir,xr);else for(var fr=Pt.length-1;fr>=0;fr--)(Kt=Pt[fr])&&(gn=(Cn<3?Kt(gn):Cn>3?Kt(Dt,Ir,gn):Kt(Dt,Ir))||gn);return Cn>3&&gn&&Object.defineProperty(Dt,Ir,gn),gn}function Te(Pt,Dt){return function(Ir,xr){Dt(Ir,xr,Pt)}}function ue(Pt,Dt,Ir,xr,Kt,Cn){function gn(Me){if(Me!==void 0&&typeof Me!="function")throw new TypeError("Function expected");return Me}for(var fr,Zr=xr.kind,qr=Zr==="getter"?"get":Zr==="setter"?"set":"value",sn=!Dt&&Pt?xr.static?Pt:Pt.prototype:null,qn=Dt||(sn?Object.getOwnPropertyDescriptor(sn,xr.name):{}),Li=!1,_i=Ir.length-1;_i>=0;_i--){var zi={};for(var Pi in xr)zi[Pi]=Pi==="access"?{}:xr[Pi];for(var Pi in xr.access)zi.access[Pi]=xr.access[Pi];zi.addInitializer=function(Me){if(Li)throw new TypeError("Cannot add initializers after decoration has completed");Cn.push(gn(Me||null))};var rr=(0,Ir[_i])(Zr==="accessor"?{get:qn.get,set:qn.set}:qn[qr],zi);if(Zr==="accessor"){if(rr===void 0)continue;if(rr===null||typeof rr!="object")throw new TypeError("Object expected");(fr=gn(rr.get))&&(qn.get=fr),(fr=gn(rr.set))&&(qn.set=fr),(fr=gn(rr.init))&&Kt.unshift(fr)}else(fr=gn(rr))&&(Zr==="field"?Kt.unshift(fr):qn[qr]=fr)}sn&&Object.defineProperty(sn,xr.name,qn),Li=!0}function ce(Pt,Dt,Ir){for(var xr=arguments.length>2,Kt=0;Kt<Dt.length;Kt++)Ir=xr?Dt[Kt].call(Pt,Ir):Dt[Kt].call(Pt);return xr?Ir:void 0}function de(Pt){return typeof Pt=="symbol"?Pt:"".concat(Pt)}function Ee(Pt,Dt,Ir){return typeof Dt=="symbol"&&(Dt=Dt.description?"[".concat(Dt.description,"]"):""),Object.defineProperty(Pt,"name",{configurable:!0,value:Ir?"".concat(Ir," ",Dt):Dt})}function Ne(Pt,Dt){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Pt,Dt)}function rt(Pt,Dt,Ir,xr){return new(Ir||(Ir=Promise))(function(Kt,Cn){function gn(qr){try{Zr(xr.next(qr))}catch(sn){Cn(sn)}}function fr(qr){try{Zr(xr.throw(qr))}catch(sn){Cn(sn)}}function Zr(qr){var sn;qr.done?Kt(qr.value):(sn=qr.value,sn instanceof Ir?sn:new Ir(function(qn){qn(sn)})).then(gn,fr)}Zr((xr=xr.apply(Pt,Dt||[])).next())})}function tt(Pt,Dt){var Ir,xr,Kt,Cn,gn={label:0,sent:function(){if(1&Kt[0])throw Kt[1];return Kt[1]},trys:[],ops:[]};return Cn={next:fr(0),throw:fr(1),return:fr(2)},typeof Symbol=="function"&&(Cn[Symbol.iterator]=function(){return this}),Cn;function fr(Zr){return function(qr){return function(sn){if(Ir)throw new TypeError("Generator is already executing.");for(;Cn&&(Cn=0,sn[0]&&(gn=0)),gn;)try{if(Ir=1,xr&&(Kt=2&sn[0]?xr.return:sn[0]?xr.throw||((Kt=xr.return)&&Kt.call(xr),0):xr.next)&&!(Kt=Kt.call(xr,sn[1])).done)return Kt;switch(xr=0,Kt&&(sn=[2&sn[0],Kt.value]),sn[0]){case 0:case 1:Kt=sn;break;case 4:return gn.label++,{value:sn[1],done:!1};case 5:gn.label++,xr=sn[1],sn=[0];continue;case 7:sn=gn.ops.pop(),gn.trys.pop();continue;default:if(!((Kt=(Kt=gn.trys).length>0&&Kt[Kt.length-1])||sn[0]!==6&&sn[0]!==2)){gn=0;continue}if(sn[0]===3&&(!Kt||sn[1]>Kt[0]&&sn[1]<Kt[3])){gn.label=sn[1];break}if(sn[0]===6&&gn.label<Kt[1]){gn.label=Kt[1],Kt=sn;break}if(Kt&&gn.label<Kt[2]){gn.label=Kt[2],gn.ops.push(sn);break}Kt[2]&&gn.ops.pop(),gn.trys.pop();continue}sn=Dt.call(Pt,gn)}catch(qn){sn=[6,qn],xr=0}finally{Ir=Kt=0}if(5&sn[0])throw sn[1];return{value:sn[0]?sn[1]:void 0,done:!0}}([Zr,qr])}}}var Ge=Object.create?function(Pt,Dt,Ir,xr){xr===void 0&&(xr=Ir);var Kt=Object.getOwnPropertyDescriptor(Dt,Ir);Kt&&!("get"in Kt?!Dt.__esModule:Kt.writable||Kt.configurable)||(Kt={enumerable:!0,get:function(){return Dt[Ir]}}),Object.defineProperty(Pt,xr,Kt)}:function(Pt,Dt,Ir,xr){xr===void 0&&(xr=Ir),Pt[xr]=Dt[Ir]};function _t(Pt,Dt){for(var Ir in Pt)Ir==="default"||Object.prototype.hasOwnProperty.call(Dt,Ir)||Ge(Dt,Pt,Ir)}function yt(Pt){var Dt=typeof Symbol=="function"&&Symbol.iterator,Ir=Dt&&Pt[Dt],xr=0;if(Ir)return Ir.call(Pt);if(Pt&&typeof Pt.length=="number")return{next:function(){return Pt&&xr>=Pt.length&&(Pt=void 0),{value:Pt&&Pt[xr++],done:!Pt}}};throw new TypeError(Dt?"Object is not iterable.":"Symbol.iterator is not defined.")}function Et(Pt,Dt){var Ir=typeof Symbol=="function"&&Pt[Symbol.iterator];if(!Ir)return Pt;var xr,Kt,Cn=Ir.call(Pt),gn=[];try{for(;(Dt===void 0||Dt-- >0)&&!(xr=Cn.next()).done;)gn.push(xr.value)}catch(fr){Kt={error:fr}}finally{try{xr&&!xr.done&&(Ir=Cn.return)&&Ir.call(Cn)}finally{if(Kt)throw Kt.error}}return gn}function Wt(){for(var Pt=[],Dt=0;Dt<arguments.length;Dt++)Pt=Pt.concat(Et(arguments[Dt]));return Pt}function Ar(){for(var Pt=0,Dt=0,Ir=arguments.length;Dt<Ir;Dt++)Pt+=arguments[Dt].length;var xr=Array(Pt),Kt=0;for(Dt=0;Dt<Ir;Dt++)for(var Cn=arguments[Dt],gn=0,fr=Cn.length;gn<fr;gn++,Kt++)xr[Kt]=Cn[gn];return xr}function mt(Pt,Dt,Ir){if(Ir||arguments.length===2)for(var xr,Kt=0,Cn=Dt.length;Kt<Cn;Kt++)!xr&&Kt in Dt||(xr||(xr=Array.prototype.slice.call(Dt,0,Kt)),xr[Kt]=Dt[Kt]);return Pt.concat(xr||Array.prototype.slice.call(Dt))}function nr(Pt){return this instanceof nr?(this.v=Pt,this):new nr(Pt)}function Xt(Pt,Dt,Ir){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var xr,Kt=Ir.apply(Pt,Dt||[]),Cn=[];return xr={},gn("next"),gn("throw"),gn("return"),xr[Symbol.asyncIterator]=function(){return this},xr;function gn(qn){Kt[qn]&&(xr[qn]=function(Li){return new Promise(function(_i,zi){Cn.push([qn,Li,_i,zi])>1||fr(qn,Li)})})}function fr(qn,Li){try{(_i=Kt[qn](Li)).value instanceof nr?Promise.resolve(_i.value.v).then(Zr,qr):sn(Cn[0][2],_i)}catch(zi){sn(Cn[0][3],zi)}var _i}function Zr(qn){fr("next",qn)}function qr(qn){fr("throw",qn)}function sn(qn,Li){qn(Li),Cn.shift(),Cn.length&&fr(Cn[0][0],Cn[0][1])}}function Ht(Pt){var Dt,Ir;return Dt={},xr("next"),xr("throw",function(Kt){throw Kt}),xr("return"),Dt[Symbol.iterator]=function(){return this},Dt;function xr(Kt,Cn){Dt[Kt]=Pt[Kt]?function(gn){return(Ir=!Ir)?{value:nr(Pt[Kt](gn)),done:!1}:Cn?Cn(gn):gn}:Cn}}function Qt(Pt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Dt,Ir=Pt[Symbol.asyncIterator];return Ir?Ir.call(Pt):(Pt=yt(Pt),Dt={},xr("next"),xr("throw"),xr("return"),Dt[Symbol.asyncIterator]=function(){return this},Dt);function xr(Kt){Dt[Kt]=Pt[Kt]&&function(Cn){return new Promise(function(gn,fr){(function(Zr,qr,sn,qn){Promise.resolve(qn).then(function(Li){Zr({value:Li,done:sn})},qr)})(gn,fr,(Cn=Pt[Kt](Cn)).done,Cn.value)})}}}function sr(Pt,Dt){return Object.defineProperty?Object.defineProperty(Pt,"raw",{value:Dt}):Pt.raw=Dt,Pt}var Tr=Object.create?function(Pt,Dt){Object.defineProperty(Pt,"default",{enumerable:!0,value:Dt})}:function(Pt,Dt){Pt.default=Dt};function ln(Pt){if(Pt&&Pt.__esModule)return Pt;var Dt={};if(Pt!=null)for(var Ir in Pt)Ir!=="default"&&Object.prototype.hasOwnProperty.call(Pt,Ir)&&Ge(Dt,Pt,Ir);return Tr(Dt,Pt),Dt}function vn(Pt){return Pt&&Pt.__esModule?Pt:{default:Pt}}function wi(Pt,Dt,Ir,xr){if(Ir==="a"&&!xr)throw new TypeError("Private accessor was defined without a getter");if(typeof Dt=="function"?Pt!==Dt||!xr:!Dt.has(Pt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Ir==="m"?xr:Ir==="a"?xr.call(Pt):xr?xr.value:Dt.get(Pt)}function hi(Pt,Dt,Ir,xr,Kt){if(xr==="m")throw new TypeError("Private method is not writable");if(xr==="a"&&!Kt)throw new TypeError("Private accessor was defined without a setter");if(typeof Dt=="function"?Pt!==Dt||!Kt:!Dt.has(Pt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return xr==="a"?Kt.call(Pt,Ir):Kt?Kt.value=Ir:Dt.set(Pt,Ir),Ir}function Vn(Pt,Dt){if(Dt===null||typeof Dt!="object"&&typeof Dt!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof Pt=="function"?Dt===Pt:Pt.has(Dt)}function Oi(Pt,Dt,Ir){if(Dt!=null){if(typeof Dt!="object"&&typeof Dt!="function")throw new TypeError("Object expected.");var xr;if(Ir){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");xr=Dt[Symbol.asyncDispose]}if(xr===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");xr=Dt[Symbol.dispose]}if(typeof xr!="function")throw new TypeError("Object not disposable.");Pt.stack.push({value:Dt,dispose:xr,async:Ir})}else Ir&&Pt.stack.push({async:!0});return Dt}var fn=typeof SuppressedError=="function"?SuppressedError:function(Pt,Dt,Ir){var xr=new Error(Ir);return xr.name="SuppressedError",xr.error=Pt,xr.suppressed=Dt,xr};function Nn(Pt){function Dt(Ir){Pt.error=Pt.hasError?new fn(Ir,Pt.error,"An error was suppressed during disposal."):Ir,Pt.hasError=!0}return function Ir(){for(;Pt.stack.length;){var xr=Pt.stack.pop();try{var Kt=xr.dispose&&xr.dispose.call(xr.value);if(xr.async)return Promise.resolve(Kt).then(Ir,function(Cn){return Dt(Cn),Ir()})}catch(Cn){Dt(Cn)}}if(Pt.hasError)throw Pt.error}()}F.default={__extends:X,__assign:ne,__rest:ie,__decorate:se,__param:Te,__metadata:Ne,__awaiter:rt,__generator:tt,__createBinding:Ge,__exportStar:_t,__values:yt,__read:Et,__spread:Wt,__spreadArrays:Ar,__spreadArray:mt,__await:nr,__asyncGenerator:Xt,__asyncDelegator:Ht,__asyncValues:Qt,__makeTemplateObject:sr,__importStar:ln,__importDefault:vn,__classPrivateFieldGet:wi,__classPrivateFieldSet:hi,__classPrivateFieldIn:Vn,__addDisposableResource:Oi,__disposeResources:Nn}}},w={};function p(L){var F=w[L];if(F!==void 0)return F.exports;var G=w[L]={exports:{}};return f[L](G,G.exports,p),G.exports}p.d=function(L,F){for(var G in F)p.o(F,G)&&!p.o(L,G)&&Object.defineProperty(L,G,{enumerable:!0,get:F[G]})},p.o=function(L,F){return Object.prototype.hasOwnProperty.call(L,F)},p.r=function(L){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(L,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(L,"__esModule",{value:!0})};var s={};return function(){var L=s;Object.defineProperty(L,"__esModule",{value:!0}),L.useReactToPrint=L.PrintContextConsumer=void 0;var F=p(582),G=p(156),H=p(111),X=Object.prototype.hasOwnProperty.call(G,"createContext"),ne=Object.prototype.hasOwnProperty.call(G,"useMemo")&&Object.prototype.hasOwnProperty.call(G,"useCallback"),ie=X?G.createContext({}):null;L.PrintContextConsumer=ie?ie.Consumer:function(){return null};var se={copyStyles:!0,pageStyle:`
        @page {
            /* Remove browser default header (title) and footer (url) */
            margin: 0;
        }
        @media print {
            body {
                /* Tell browsers to print background colors */
                -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
                color-adjust: exact; /* Firefox */
            }
        }
    `,removeAfterPrint:!1,suppressErrors:!1},Te=function(ue){function ce(){var de=ue!==null&&ue.apply(this,arguments)||this;return de.startPrint=function(Ee){var Ne=de.props,rt=Ne.onAfterPrint,tt=Ne.onPrintError,Ge=Ne.print,_t=Ne.documentTitle;setTimeout(function(){var yt,Et;if(Ee.contentWindow)if(Ee.contentWindow.focus(),Ge)Ge(Ee).then(function(){return rt==null?void 0:rt()}).then(function(){return de.handleRemoveIframe()}).catch(function(mt){tt?tt("print",mt):de.logMessages(["An error was thrown by the specified `print` function"])});else{if(Ee.contentWindow.print){var Wt=(Et=(yt=Ee.contentDocument)===null||yt===void 0?void 0:yt.title)!==null&&Et!==void 0?Et:"",Ar=Ee.ownerDocument.title;_t&&(Ee.ownerDocument.title=_t,Ee.contentDocument&&(Ee.contentDocument.title=_t)),Ee.contentWindow.print(),_t&&(Ee.ownerDocument.title=Ar,Ee.contentDocument&&(Ee.contentDocument.title=Wt))}else de.logMessages(["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."]);rt==null||rt(),de.handleRemoveIframe()}else de.logMessages(["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/gregnb/react-to-print/issues/"])},500)},de.triggerPrint=function(Ee){var Ne=de.props,rt=Ne.onBeforePrint,tt=Ne.onPrintError;if(rt){var Ge=rt();Ge&&typeof Ge.then=="function"?Ge.then(function(){de.startPrint(Ee)}).catch(function(_t){tt&&tt("onBeforePrint",_t)}):de.startPrint(Ee)}else de.startPrint(Ee)},de.handleClick=function(){var Ee=de.props,Ne=Ee.onBeforeGetContent,rt=Ee.onPrintError;if(Ne){var tt=Ne();tt&&typeof tt.then=="function"?tt.then(de.handlePrint).catch(function(Ge){rt&&rt("onBeforeGetContent",Ge)}):de.handlePrint()}else de.handlePrint()},de.handlePrint=function(){var Ee=de.props,Ne=Ee.bodyClass,rt=Ee.content,tt=Ee.copyStyles,Ge=Ee.fonts,_t=Ee.pageStyle,yt=Ee.nonce,Et=rt();if(Et!==void 0)if(Et!==null){var Wt=document.createElement("iframe");Wt.width="".concat(document.documentElement.clientWidth,"px"),Wt.height="".concat(document.documentElement.clientHeight,"px"),Wt.style.position="absolute",Wt.style.top="-".concat(document.documentElement.clientHeight+100,"px"),Wt.style.left="-".concat(document.documentElement.clientWidth+100,"px"),Wt.id="printWindow",Wt.srcdoc="<!DOCTYPE html>";var Ar=(0,H.findDOMNode)(Et);if(Ar){var mt=Ar.cloneNode(!0),nr=mt instanceof Text,Xt=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),Ht=nr?[]:mt.querySelectorAll("img"),Qt=nr?[]:mt.querySelectorAll("video"),sr=Ge?Ge.length:0;de.numResourcesToLoad=Xt.length+Ht.length+Qt.length+sr,de.resourcesLoaded=[],de.resourcesErrored=[];var Tr=function(ln,vn){de.resourcesLoaded.includes(ln)?de.logMessages(["Tried to mark a resource that has already been handled",ln],"debug"):(vn?(de.logMessages(F.__spreadArray(['"react-to-print" was unable to load a resource but will continue attempting to print the page'],F.__read(vn),!1)),de.resourcesErrored.push(ln)):de.resourcesLoaded.push(ln),de.resourcesLoaded.length+de.resourcesErrored.length===de.numResourcesToLoad&&de.triggerPrint(Wt))};Wt.onload=function(){var ln,vn,wi,hi;Wt.onload=null;var Vn=Wt.contentDocument||((vn=Wt.contentWindow)===null||vn===void 0?void 0:vn.document);if(Vn){Vn.body.appendChild(mt),Ge&&(!((wi=Wt.contentDocument)===null||wi===void 0)&&wi.fonts&&(!((hi=Wt.contentWindow)===null||hi===void 0)&&hi.FontFace)?Ge.forEach(function(qe){var at=new FontFace(qe.family,qe.source,{weight:qe.weight,style:qe.style});Wt.contentDocument.fonts.add(at),at.loaded.then(function(){Tr(at)}).catch(function($t){Tr(at,["Failed loading the font:",at,"Load error:",$t])})}):(Ge.forEach(function(qe){return Tr(qe)}),de.logMessages(['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'])));var Oi=typeof _t=="function"?_t():_t;if(typeof Oi!="string")de.logMessages(['"react-to-print" expected a "string" from `pageStyle` but received "'.concat(typeof Oi,'". Styles from `pageStyle` will not be applied.')]);else{var fn=Vn.createElement("style");yt&&(fn.setAttribute("nonce",yt),Vn.head.setAttribute("nonce",yt)),fn.appendChild(Vn.createTextNode(Oi)),Vn.head.appendChild(fn)}if(Ne&&(ln=Vn.body.classList).add.apply(ln,F.__spreadArray([],F.__read(Ne.split(" ")),!1)),!nr){for(var Nn=nr?[]:Ar.querySelectorAll("canvas"),Pt=Vn.querySelectorAll("canvas"),Dt=0;Dt<Nn.length;++Dt){var Ir=Nn[Dt],xr=Pt[Dt].getContext("2d");xr&&xr.drawImage(Ir,0,0)}var Kt=function(qe){var at=Ht[qe],$t=at.getAttribute("src");if($t){var cr=new Image;cr.onload=function(){return Tr(at)},cr.onerror=function(br,en,ur,Kr,Vr){return Tr(at,["Error loading <img>",at,"Error",Vr])},cr.src=$t}else Tr(at,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it. The <img> is:',at])};for(Dt=0;Dt<Ht.length;Dt++)Kt(Dt);var Cn=function(qe){var at=Qt[qe];at.preload="auto";var $t=at.getAttribute("poster");if($t){var cr=new Image;cr.onload=function(){return Tr(at)},cr.onerror=function(br,en,ur,Kr,Vr){return Tr(at,["Error loading video poster",$t,"for video",at,"Error:",Vr])},cr.src=$t}else at.readyState>=2?Tr(at):(at.onloadeddata=function(){return Tr(at)},at.onerror=function(br,en,ur,Kr,Vr){return Tr(at,["Error loading video",at,"Error",Vr])},at.onstalled=function(){return Tr(at,["Loading video stalled, skipping",at])})};for(Dt=0;Dt<Qt.length;Dt++)Cn(Dt);var gn="input",fr=Ar.querySelectorAll(gn),Zr=Vn.querySelectorAll(gn);for(Dt=0;Dt<fr.length;Dt++)Zr[Dt].value=fr[Dt].value;var qr="input[type=checkbox],input[type=radio]",sn=Ar.querySelectorAll(qr),qn=Vn.querySelectorAll(qr);for(Dt=0;Dt<sn.length;Dt++)qn[Dt].checked=sn[Dt].checked;var Li="select",_i=Ar.querySelectorAll(Li),zi=Vn.querySelectorAll(Li);for(Dt=0;Dt<_i.length;Dt++)zi[Dt].value=_i[Dt].value}if(tt)for(var Pi=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']"),rr=function(qe,at){var $t=Pi[qe];if($t.tagName.toLowerCase()==="style"){var cr=Vn.createElement($t.tagName),br=$t.sheet;if(br){var en="";try{for(var ur=br.cssRules.length,Kr=0;Kr<ur;++Kr)typeof br.cssRules[Kr].cssText=="string"&&(en+="".concat(br.cssRules[Kr].cssText,`\r
`))}catch{de.logMessages(["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/gregnb/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",$t],"warning")}cr.setAttribute("id","react-to-print-".concat(qe)),yt&&cr.setAttribute("nonce",yt),cr.appendChild(Vn.createTextNode(en)),Vn.head.appendChild(cr)}}else if($t.getAttribute("href"))if($t.hasAttribute("disabled"))de.logMessages(["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",$t],"warning"),Tr($t);else{for(var Vr=Vn.createElement($t.tagName),cn=(Kr=0,$t.attributes.length);Kr<cn;++Kr){var Xn=$t.attributes[Kr];Xn&&Vr.setAttribute(Xn.nodeName,Xn.nodeValue||"")}Vr.onload=function(){return Tr(Vr)},Vr.onerror=function(Mr,Fr,ri,mi,gi){return Tr(Vr,["Failed to load",Vr,"Error:",gi])},yt&&Vr.setAttribute("nonce",yt),Vn.head.appendChild(Vr)}else de.logMessages(["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",$t],"warning"),Tr($t)},Me=(Dt=0,Pi.length);Dt<Me;++Dt)rr(Dt)}de.numResourcesToLoad!==0&&tt||de.triggerPrint(Wt)},de.handleRemoveIframe(!0),document.body.appendChild(Wt)}else de.logMessages(['"react-to-print" could not locate the DOM node corresponding with the `content` prop'])}else de.logMessages(['There is nothing to print because the "content" prop returned "null". Please ensure "content" is renderable before allowing "react-to-print" to be called.']);else de.logMessages(["To print a functional component ensure it is wrapped with `React.forwardRef`, and ensure the forwarded ref is used. See the README for an example: https://github.com/gregnb/react-to-print#examples"])},de.handleRemoveIframe=function(Ee){var Ne=de.props.removeAfterPrint;if(Ee||Ne){var rt=document.getElementById("printWindow");rt&&document.body.removeChild(rt)}},de.logMessages=function(Ee,Ne){Ne===void 0&&(Ne="error"),de.props.suppressErrors||(Ne==="error"?console.error(Ee):Ne==="warning"?console.warn(Ee):Ne==="debug"&&console.debug(Ee))},de}return F.__extends(ce,ue),ce.prototype.render=function(){var de=this.props,Ee=de.children,Ne=de.trigger;if(Ne)return G.cloneElement(Ne(),{onClick:this.handleClick});if(!ie)return this.logMessages(['"react-to-print" requires React ^16.3.0 to be able to use "PrintContext"']),null;var rt={handlePrint:this.handleClick};return G.createElement(ie.Provider,{value:rt},Ee)},ce.defaultProps=se,ce}(G.Component);L.default=Te,L.useReactToPrint=function(ue){if(!ne)return ue.suppressErrors||console.error('"react-to-print" requires React ^16.8.0 to be able to use "useReactToPrint"'),function(){throw new Error('"react-to-print" requires React ^16.8.0 to be able to use "useReactToPrint"')};var ce=G.useMemo(function(){return new Te(F.__assign(F.__assign({},se),ue))},[ue]);return G.useCallback(function(){return ce.handleClick()},[ce])}}(),s}()})})(Q4);var eB=Q4.exports;const aJ=S0(eB);function JC({title:e,label:n,classes:a,content:u,error:f}){let w=fe.useRef(null);const p=()=>y.jsxs("div",{className:"header-text",children:[y.jsx("span",{className:"header-text-state",children:"EDO STATE GOVERNMENT"}),y.jsx("span",{className:"header-text-ministry",children:"Ministry of Physical Planning,"}),y.jsx("span",{className:"header-text-ministry",children:"Housing, Urban and Regional Development"})]}),s=()=>y.jsxs("div",{children:[y.jsx("p",{children:'2nd Floor, Block "C" Secretariat Complex, Sapele Road, Benin City, Edo State.'}),y.jsx("p",{children:"Email: info.mppud@edostate.gov.ng"}),y.jsx("p",{children:"Tel: +234 810 466 3697"})]});return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"printWrapper",ref:L=>w=L,children:[y.jsx("img",{alt:"",src:"/assets/logos/Logo-Mpphurd.png",className:"watermark"}),y.jsxs("table",{className:"report-container",children:[y.jsx("thead",{className:"report-header",children:y.jsx("tr",{children:y.jsx("th",{className:"report-header-cell",children:y.jsxs("div",{className:"header",children:[y.jsxs("div",{className:"header-info",children:[y.jsx("img",{className:"header-logo-left",src:"/assets/logos/Logo-Edo State.png",alt:""}),p(),y.jsx("img",{className:"header-logo-right",src:"/assets/logos/Logo-Mpphurd.png",alt:""})]}),y.jsx("div",{className:"header-rule"})]})})})}),y.jsx("tfoot",{className:"report-footer",children:y.jsx("tr",{children:y.jsx("td",{className:"report-footer-cell",children:y.jsx("div",{className:"footer-info",children:y.jsxs("div",{className:"page-footer",children:[y.jsx("div",{className:"footer-rule"}),s()]})})})})}),y.jsx("tbody",{className:"report-content",children:y.jsx("tr",{children:y.jsx("td",{className:"report-content-cell",children:y.jsx("div",{className:"main",children:u})})})})]})]}),y.jsx(aJ,{documentTitle:e,trigger:()=>y.jsx("button",{disabled:f,className:a,children:n}),content:()=>w,removeAfterPrint:!0})]})}function tB(){fe.useRef(null);const e=()=>y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"billTitle",children:"Development Permit Assessment Form"}),y.jsxs("div",{className:"billDetails",children:[y.jsx("div",{className:"billDetailsTitle",children:"Details of Application"}),y.jsxs("div",{className:"billDetailsTopItems",children:[y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"File No"}),y.jsx("div",{className:"billDetailsTopItemText",children:"BC/3522/2023"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Applicant Name"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Mr. Osaretin Emmanuel Josh"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Telephone:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"0808358343, 0908273423"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Site Location:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"No. 3b Ekenwan barracks, off Etete Crescent"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Applicant Name"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Mr. Osaretin Emmanuel Josh"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Building Description:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Built Building"})]})]}),y.jsx("div",{className:"billAnalysisTitle",children:"Fees Analysis"}),y.jsxs("div",{className:"billAnalysisItems",children:[y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Registration Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"34,900"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Development Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"34,900"})]})}),y.jsxs("div",{className:"billAnalysisItem",children:[y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Volume of Building:"}),y.jsx("span",{className:"billAnalysisValue",children:"111,124"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"a."}),y.jsxs("div",{className:"billAnalysisBreakdownCal",children:[y.jsx("span",{children:"12.00m x 11.40m x 5.20m = 711.2313"}),y.jsx("span",{children:"711.2313 x 25 (psm) = 55,562"})]}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"55,562"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"b."}),y.jsxs("div",{className:"billAnalysisBreakdownCal",children:[y.jsx("span",{children:"12.00m x 11.40m x 5.20m = 711.2313"}),y.jsx("span",{children:"711.2313 x 25 (psm) = 55,562"})]}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"55,562"})]})]}),y.jsxs("div",{className:"billAnalysisItem",children:[y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Land Area:"}),y.jsx("span",{className:"billAnalysisValue",children:"32,250"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"a."}),y.jsx("div",{className:"billAnalysisBreakdownCal",children:y.jsx("span",{children:"1370sm x 25 (psm) = 32,250"})}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"32,250"})]})]}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Building Facilities:"}),y.jsx("span",{className:"billAnalysisValue",children:"23,500"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Other Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"23,500"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"TOTAL"}),y.jsx("span",{className:"billAnalysisValue",children:"453545"})]})})]}),y.jsxs("div",{className:"billAnalysisPrev",children:[y.jsx("span",{children:"Previous Assessment(1) = 3224"}),y.jsx("span",{children:"Previous Assessment(1) = 3224"}),y.jsx("span",{children:"TPA = 5625 - 3224 = 2342"}),y.jsx("span",{children:"New Total Assessment = 3224 + 2342 = 44,232"})]}),y.jsxs("div",{className:"billAnalysisTotalPay",children:[y.jsx("span",{children:"Total Payable Amount:"}),y.jsx("span",{children:"N393,452"})]}),y.jsxs("div",{className:"planBillViewFooter",children:[y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:"Aigbe F.O"}),y.jsx("span",{children:"Assessment Officer"})]}),y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:"Aigbe F.O"}),y.jsx("span",{children:"Sign"})]}),y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:Date.now().toLocaleString()}),y.jsx("span",{children:"Assessment Date"})]})]})]})]});return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"planBill",children:[y.jsxs("div",{className:"planBillOptions",children:[y.jsx("button",{className:"secondary selected",children:"Assessment"}),y.jsx("button",{className:"secondary",children:"Assessment2"}),y.jsx("button",{className:"secondary",children:"FastTrack"}),y.jsx("button",{className:"secondary",children:"Contravention"})]}),y.jsxs("div",{className:"planBillViewWrapper",children:[y.jsx("div",{className:"billTitle",children:"Development Permit Assessment Form"}),y.jsxs("div",{className:"billDetails",children:[y.jsx("div",{className:"billDetailsTitle",children:"Details of Application"}),y.jsxs("div",{className:"billDetailsTopItems",children:[y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"File No"}),y.jsx("div",{className:"billDetailsTopItemText",children:"BC/3522/2023"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Applicant Name"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Mr. Osaretin Emmanuel Josh"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Telephone:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"0808358343, 0908273423"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Site Location:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"No. 3b Ekenwan barracks, off Etete Crescent"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Applicant Name"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Mr. Osaretin Emmanuel Josh"})]}),y.jsxs("div",{className:"billDetailsTopItem",children:[y.jsx("div",{className:"billDetailsTopItemTitle",children:"Building Description:"}),y.jsx("div",{className:"billDetailsTopItemText",children:"Built Building"})]})]}),y.jsx("div",{className:"billAnalysisTitle",children:"Fees Analysis"}),y.jsxs("div",{className:"billAnalysisItems",children:[y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Registration Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"34,900"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Development Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"34,900"})]})}),y.jsxs("div",{className:"billAnalysisItem",children:[y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Volume of Building:"}),y.jsx("span",{className:"billAnalysisValue",children:"111,124"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"a."}),y.jsxs("div",{className:"billAnalysisBreakdownCal",children:[y.jsx("span",{children:"12.00m x 11.40m x 5.20m = 711.2313"}),y.jsx("span",{children:"711.2313 x 25 (psm) = 55,562"})]}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"55,562"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"b."}),y.jsxs("div",{className:"billAnalysisBreakdownCal",children:[y.jsx("span",{children:"12.00m x 11.40m x 5.20m = 711.2313"}),y.jsx("span",{children:"711.2313 x 25 (psm) = 55,562"})]}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"55,562"})]})]}),y.jsxs("div",{className:"billAnalysisItem",children:[y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Land Area:"}),y.jsx("span",{className:"billAnalysisValue",children:"32,250"})]}),y.jsxs("div",{className:"billAnalysisBreakdown",children:[y.jsx("div",{className:"billAnalysisBreakdownNum",children:"a."}),y.jsx("div",{className:"billAnalysisBreakdownCal",children:y.jsx("span",{children:"1370sm x 25 (psm) = 32,250"})}),y.jsx("div",{className:"billAnalysisBreakdownSum",children:"32,250"})]})]}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Building Facilities:"}),y.jsx("span",{className:"billAnalysisValue",children:"23,500"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"Other Fees:"}),y.jsx("span",{className:"billAnalysisValue",children:"23,500"})]})}),y.jsx("div",{className:"billAnalysisItem",children:y.jsxs("div",{className:"billAnalysisItemSum",children:[y.jsx("span",{className:"billAnalysisName",children:"TOTAL"}),y.jsx("span",{className:"billAnalysisValue",children:"453545"})]})})]}),y.jsxs("div",{className:"billAnalysisPrev",children:[y.jsx("span",{children:"Previous Assessment(1) = 3224"}),y.jsx("span",{children:"Previous Assessment(1) = 3224"}),y.jsx("span",{children:"TPA = 5625 - 3224 = 2342"}),y.jsx("span",{children:"New Total Assessment = 3224 + 2342 = 44,232"})]}),y.jsxs("div",{className:"billAnalysisTotalPay",children:[y.jsx("span",{children:"Total Payable Amount:"}),y.jsx("span",{children:"N393,452"})]}),y.jsxs("div",{className:"planBillViewFooter",children:[y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:"Aigbe F.O"}),y.jsx("span",{children:"Assessment Officer"})]}),y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:"Aigbe F.O"}),y.jsx("span",{children:"Sign"})]}),y.jsxs("div",{className:"planBillViewFooterItem",children:[y.jsx("span",{children:Date.now().toLocaleString()}),y.jsx("span",{children:"Assessment Date"})]})]})]})]}),y.jsx(JC,{title:"Assessment_Sheet",classes:"planBillPrint primary",label:"Print this out!",content:e()})]})})}function sJ(){const e=["a","b","c","d","e","f","0","1","2","3","4","5","6","7","8","9"];let n=[];for(let a=0;a<36;a++)a===8||a===13||a===18||a===23?n[a]="-":n[a]=e[Math.ceil(Math.random()*e.length-1)];return n.join("")}var lJ=sJ;const Cc=S0(lJ);function Qh(e){const n=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&n==="[object Date]"?new e.constructor(+e):typeof e=="number"||n==="[object Number]"||typeof e=="string"||n==="[object String]"?new Date(e):new Date(NaN)}function h_(e,n){return e instanceof Date?new e.constructor(n):new Date(n)}function cJ(e,n){const a=Qh(e);return isNaN(n)?h_(e,NaN):(n&&a.setDate(a.getDate()+n),a)}const rB=6048e5,uJ=864e5;let hJ={};function OT(){return hJ}function J1(e,n){var s,L,F,G;const a=OT(),u=(n==null?void 0:n.weekStartsOn)??((L=(s=n==null?void 0:n.locale)==null?void 0:s.options)==null?void 0:L.weekStartsOn)??a.weekStartsOn??((G=(F=a.locale)==null?void 0:F.options)==null?void 0:G.weekStartsOn)??0,f=Qh(e),w=f.getDay(),p=(w<u?7:0)+w-u;return f.setDate(f.getDate()-p),f.setHours(0,0,0,0),f}function gS(e){return J1(e,{weekStartsOn:1})}function nB(e){const n=Qh(e),a=n.getFullYear(),u=h_(e,0);u.setFullYear(a+1,0,4),u.setHours(0,0,0,0);const f=gS(u),w=h_(e,0);w.setFullYear(a,0,4),w.setHours(0,0,0,0);const p=gS(w);return n.getTime()>=f.getTime()?a+1:n.getTime()>=p.getTime()?a:a-1}function _S(e){const n=Qh(e);return n.setHours(0,0,0,0),n}function JO(e){const n=Qh(e),a=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return a.setUTCFullYear(n.getFullYear()),+e-+a}function dJ(e,n){const a=_S(e),u=_S(n),f=+a-JO(a),w=+u-JO(u);return Math.round((f-w)/uJ)}function pJ(e){const n=nB(e),a=h_(e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),gS(a)}function iB(e,n){const a=_S(e),u=_S(n);return+a==+u}function fJ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function mJ(e){if(!fJ(e)&&typeof e!="number")return!1;const n=Qh(e);return!isNaN(Number(n))}function gJ(e){const n=Qh(e),a=h_(e,0);return a.setFullYear(n.getFullYear(),0,1),a.setHours(0,0,0,0),a}const _J={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yJ=(e,n,a)=>{let u;const f=_J[e];return typeof f=="string"?u=f:n===1?u=f.one:u=f.other.replace("{{count}}",n.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+u:u+" ago":u};function SI(e){return(n={})=>{const a=n.width?String(n.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const vJ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xJ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},bJ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},wJ={date:SI({formats:vJ,defaultWidth:"full"}),time:SI({formats:xJ,defaultWidth:"full"}),dateTime:SI({formats:bJ,defaultWidth:"full"})},SJ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},TJ=(e,n,a,u)=>SJ[e];function Hx(e){return(n,a)=>{const u=a!=null&&a.context?String(a.context):"standalone";let f;if(u==="formatting"&&e.formattingValues){const p=e.defaultFormattingWidth||e.defaultWidth,s=a!=null&&a.width?String(a.width):p;f=e.formattingValues[s]||e.formattingValues[p]}else{const p=e.defaultWidth,s=a!=null&&a.width?String(a.width):e.defaultWidth;f=e.values[s]||e.values[p]}const w=e.argumentCallback?e.argumentCallback(n):n;return f[w]}}const EJ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},IJ={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},CJ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},AJ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},PJ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},MJ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kJ=(e,n)=>{const a=Number(e),u=a%100;if(u>20||u<10)switch(u%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},RJ={ordinalNumber:kJ,era:Hx({values:EJ,defaultWidth:"wide"}),quarter:Hx({values:IJ,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Hx({values:CJ,defaultWidth:"wide"}),day:Hx({values:AJ,defaultWidth:"wide"}),dayPeriod:Hx({values:PJ,defaultWidth:"wide",formattingValues:MJ,defaultFormattingWidth:"wide"})};function Zx(e){return(n,a={})=>{const u=a.width,f=u&&e.matchPatterns[u]||e.matchPatterns[e.defaultMatchWidth],w=n.match(f);if(!w)return null;const p=w[0],s=u&&e.parsePatterns[u]||e.parsePatterns[e.defaultParseWidth],L=Array.isArray(s)?OJ(s,H=>H.test(p)):DJ(s,H=>H.test(p));let F;F=e.valueCallback?e.valueCallback(L):L,F=a.valueCallback?a.valueCallback(F):F;const G=n.slice(p.length);return{value:F,rest:G}}}function DJ(e,n){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&n(e[a]))return a}function OJ(e,n){for(let a=0;a<e.length;a++)if(n(e[a]))return a}function LJ(e){return(n,a={})=>{const u=n.match(e.matchPattern);if(!u)return null;const f=u[0],w=n.match(e.parsePattern);if(!w)return null;let p=e.valueCallback?e.valueCallback(w[0]):w[0];p=a.valueCallback?a.valueCallback(p):p;const s=n.slice(f.length);return{value:p,rest:s}}}const zJ=/^(\d+)(th|st|nd|rd)?/i,NJ=/\d+/i,jJ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},BJ={any:[/^b/i,/^(a|c)/i]},FJ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},VJ={any:[/1/i,/2/i,/3/i,/4/i]},UJ={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$J={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},GJ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qJ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},WJ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HJ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ZJ={ordinalNumber:LJ({matchPattern:zJ,parsePattern:NJ,valueCallback:e=>parseInt(e,10)}),era:Zx({matchPatterns:jJ,defaultMatchWidth:"wide",parsePatterns:BJ,defaultParseWidth:"any"}),quarter:Zx({matchPatterns:FJ,defaultMatchWidth:"wide",parsePatterns:VJ,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zx({matchPatterns:UJ,defaultMatchWidth:"wide",parsePatterns:$J,defaultParseWidth:"any"}),day:Zx({matchPatterns:GJ,defaultMatchWidth:"wide",parsePatterns:qJ,defaultParseWidth:"any"}),dayPeriod:Zx({matchPatterns:WJ,defaultMatchWidth:"any",parsePatterns:HJ,defaultParseWidth:"any"})},XJ={code:"en-US",formatDistance:yJ,formatLong:wJ,formatRelative:TJ,localize:RJ,match:ZJ,options:{weekStartsOn:0,firstWeekContainsDate:1}};function YJ(e){const n=Qh(e);return dJ(n,gJ(n))+1}function KJ(e){const n=Qh(e),a=+gS(n)-+pJ(n);return Math.round(a/rB)+1}function oB(e,n){var G,H,X,ne;const a=Qh(e),u=a.getFullYear(),f=OT(),w=(n==null?void 0:n.firstWeekContainsDate)??((H=(G=n==null?void 0:n.locale)==null?void 0:G.options)==null?void 0:H.firstWeekContainsDate)??f.firstWeekContainsDate??((ne=(X=f.locale)==null?void 0:X.options)==null?void 0:ne.firstWeekContainsDate)??1,p=h_(e,0);p.setFullYear(u+1,0,w),p.setHours(0,0,0,0);const s=J1(p,n),L=h_(e,0);L.setFullYear(u,0,w),L.setHours(0,0,0,0);const F=J1(L,n);return a.getTime()>=s.getTime()?u+1:a.getTime()>=F.getTime()?u:u-1}function JJ(e,n){var s,L,F,G;const a=OT(),u=(n==null?void 0:n.firstWeekContainsDate)??((L=(s=n==null?void 0:n.locale)==null?void 0:s.options)==null?void 0:L.firstWeekContainsDate)??a.firstWeekContainsDate??((G=(F=a.locale)==null?void 0:F.options)==null?void 0:G.firstWeekContainsDate)??1,f=oB(e,n),w=h_(e,0);return w.setFullYear(f,0,u),w.setHours(0,0,0,0),J1(w,n)}function QJ(e,n){const a=Qh(e),u=+J1(a,n)-+JJ(a,n);return Math.round(u/rB)+1}function ja(e,n){const a=e<0?"-":"",u=Math.abs(e).toString().padStart(n,"0");return a+u}const Rg={y(e,n){const a=e.getFullYear(),u=a>0?a:1-a;return ja(n==="yy"?u%100:u,n.length)},M(e,n){const a=e.getMonth();return n==="M"?String(a+1):ja(a+1,2)},d(e,n){return ja(e.getDate(),n.length)},a(e,n){const a=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(e,n){return ja(e.getHours()%12||12,n.length)},H(e,n){return ja(e.getHours(),n.length)},m(e,n){return ja(e.getMinutes(),n.length)},s(e,n){return ja(e.getSeconds(),n.length)},S(e,n){const a=n.length,u=e.getMilliseconds(),f=Math.trunc(u*Math.pow(10,a-3));return ja(f,n.length)}},Cv={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},QO={G:function(e,n,a){const u=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return a.era(u,{width:"abbreviated"});case"GGGGG":return a.era(u,{width:"narrow"});case"GGGG":default:return a.era(u,{width:"wide"})}},y:function(e,n,a){if(n==="yo"){const u=e.getFullYear(),f=u>0?u:1-u;return a.ordinalNumber(f,{unit:"year"})}return Rg.y(e,n)},Y:function(e,n,a,u){const f=oB(e,u),w=f>0?f:1-f;if(n==="YY"){const p=w%100;return ja(p,2)}return n==="Yo"?a.ordinalNumber(w,{unit:"year"}):ja(w,n.length)},R:function(e,n){const a=nB(e);return ja(a,n.length)},u:function(e,n){const a=e.getFullYear();return ja(a,n.length)},Q:function(e,n,a){const u=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(u);case"QQ":return ja(u,2);case"Qo":return a.ordinalNumber(u,{unit:"quarter"});case"QQQ":return a.quarter(u,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(u,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(u,{width:"wide",context:"formatting"})}},q:function(e,n,a){const u=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(u);case"qq":return ja(u,2);case"qo":return a.ordinalNumber(u,{unit:"quarter"});case"qqq":return a.quarter(u,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(u,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(u,{width:"wide",context:"standalone"})}},M:function(e,n,a){const u=e.getMonth();switch(n){case"M":case"MM":return Rg.M(e,n);case"Mo":return a.ordinalNumber(u+1,{unit:"month"});case"MMM":return a.month(u,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(u,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(u,{width:"wide",context:"formatting"})}},L:function(e,n,a){const u=e.getMonth();switch(n){case"L":return String(u+1);case"LL":return ja(u+1,2);case"Lo":return a.ordinalNumber(u+1,{unit:"month"});case"LLL":return a.month(u,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(u,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(u,{width:"wide",context:"standalone"})}},w:function(e,n,a,u){const f=QJ(e,u);return n==="wo"?a.ordinalNumber(f,{unit:"week"}):ja(f,n.length)},I:function(e,n,a){const u=KJ(e);return n==="Io"?a.ordinalNumber(u,{unit:"week"}):ja(u,n.length)},d:function(e,n,a){return n==="do"?a.ordinalNumber(e.getDate(),{unit:"date"}):Rg.d(e,n)},D:function(e,n,a){const u=YJ(e);return n==="Do"?a.ordinalNumber(u,{unit:"dayOfYear"}):ja(u,n.length)},E:function(e,n,a){const u=e.getDay();switch(n){case"E":case"EE":case"EEE":return a.day(u,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(u,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(u,{width:"short",context:"formatting"});case"EEEE":default:return a.day(u,{width:"wide",context:"formatting"})}},e:function(e,n,a,u){const f=e.getDay(),w=(f-u.weekStartsOn+8)%7||7;switch(n){case"e":return String(w);case"ee":return ja(w,2);case"eo":return a.ordinalNumber(w,{unit:"day"});case"eee":return a.day(f,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(f,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(f,{width:"short",context:"formatting"});case"eeee":default:return a.day(f,{width:"wide",context:"formatting"})}},c:function(e,n,a,u){const f=e.getDay(),w=(f-u.weekStartsOn+8)%7||7;switch(n){case"c":return String(w);case"cc":return ja(w,n.length);case"co":return a.ordinalNumber(w,{unit:"day"});case"ccc":return a.day(f,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(f,{width:"narrow",context:"standalone"});case"cccccc":return a.day(f,{width:"short",context:"standalone"});case"cccc":default:return a.day(f,{width:"wide",context:"standalone"})}},i:function(e,n,a){const u=e.getDay(),f=u===0?7:u;switch(n){case"i":return String(f);case"ii":return ja(f,n.length);case"io":return a.ordinalNumber(f,{unit:"day"});case"iii":return a.day(u,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(u,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(u,{width:"short",context:"formatting"});case"iiii":default:return a.day(u,{width:"wide",context:"formatting"})}},a:function(e,n,a){const f=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return a.dayPeriod(f,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(f,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(f,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(f,{width:"wide",context:"formatting"})}},b:function(e,n,a){const u=e.getHours();let f;switch(u===12?f=Cv.noon:u===0?f=Cv.midnight:f=u/12>=1?"pm":"am",n){case"b":case"bb":return a.dayPeriod(f,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(f,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(f,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(f,{width:"wide",context:"formatting"})}},B:function(e,n,a){const u=e.getHours();let f;switch(u>=17?f=Cv.evening:u>=12?f=Cv.afternoon:u>=4?f=Cv.morning:f=Cv.night,n){case"B":case"BB":case"BBB":return a.dayPeriod(f,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(f,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(f,{width:"wide",context:"formatting"})}},h:function(e,n,a){if(n==="ho"){let u=e.getHours()%12;return u===0&&(u=12),a.ordinalNumber(u,{unit:"hour"})}return Rg.h(e,n)},H:function(e,n,a){return n==="Ho"?a.ordinalNumber(e.getHours(),{unit:"hour"}):Rg.H(e,n)},K:function(e,n,a){const u=e.getHours()%12;return n==="Ko"?a.ordinalNumber(u,{unit:"hour"}):ja(u,n.length)},k:function(e,n,a){let u=e.getHours();return u===0&&(u=24),n==="ko"?a.ordinalNumber(u,{unit:"hour"}):ja(u,n.length)},m:function(e,n,a){return n==="mo"?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):Rg.m(e,n)},s:function(e,n,a){return n==="so"?a.ordinalNumber(e.getSeconds(),{unit:"second"}):Rg.s(e,n)},S:function(e,n){return Rg.S(e,n)},X:function(e,n,a){const u=e.getTimezoneOffset();if(u===0)return"Z";switch(n){case"X":return tL(u);case"XXXX":case"XX":return oy(u);case"XXXXX":case"XXX":default:return oy(u,":")}},x:function(e,n,a){const u=e.getTimezoneOffset();switch(n){case"x":return tL(u);case"xxxx":case"xx":return oy(u);case"xxxxx":case"xxx":default:return oy(u,":")}},O:function(e,n,a){const u=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+eL(u,":");case"OOOO":default:return"GMT"+oy(u,":")}},z:function(e,n,a){const u=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+eL(u,":");case"zzzz":default:return"GMT"+oy(u,":")}},t:function(e,n,a){const u=Math.trunc(e.getTime()/1e3);return ja(u,n.length)},T:function(e,n,a){const u=e.getTime();return ja(u,n.length)}};function eL(e,n=""){const a=e>0?"-":"+",u=Math.abs(e),f=Math.trunc(u/60),w=u%60;return w===0?a+String(f):a+String(f)+n+ja(w,2)}function tL(e,n){return e%60===0?(e>0?"-":"+")+ja(Math.abs(e)/60,2):oy(e,n)}function oy(e,n=""){const a=e>0?"-":"+",u=Math.abs(e),f=ja(Math.trunc(u/60),2),w=ja(u%60,2);return a+f+n+w}const rL=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},aB=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},eQ=(e,n)=>{const a=e.match(/(P+)(p+)?/)||[],u=a[1],f=a[2];if(!f)return rL(e,n);let w;switch(u){case"P":w=n.dateTime({width:"short"});break;case"PP":w=n.dateTime({width:"medium"});break;case"PPP":w=n.dateTime({width:"long"});break;case"PPPP":default:w=n.dateTime({width:"full"});break}return w.replace("{{date}}",rL(u,n)).replace("{{time}}",aB(f,n))},tQ={p:aB,P:eQ},rQ=/^D+$/,nQ=/^Y+$/,iQ=["D","DD","YY","YYYY"];function oQ(e){return rQ.test(e)}function aQ(e){return nQ.test(e)}function sQ(e,n,a){const u=lQ(e,n,a);if(console.warn(u),iQ.includes(e))throw new RangeError(u)}function lQ(e,n,a){const u=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${u} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,uQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hQ=/^'([^]*?)'?$/,dQ=/''/g,pQ=/[a-zA-Z]/;function $l(e,n,a){var G,H,X,ne,ie,se,Te,ue;const u=OT(),f=(a==null?void 0:a.locale)??u.locale??XJ,w=(a==null?void 0:a.firstWeekContainsDate)??((H=(G=a==null?void 0:a.locale)==null?void 0:G.options)==null?void 0:H.firstWeekContainsDate)??u.firstWeekContainsDate??((ne=(X=u.locale)==null?void 0:X.options)==null?void 0:ne.firstWeekContainsDate)??1,p=(a==null?void 0:a.weekStartsOn)??((se=(ie=a==null?void 0:a.locale)==null?void 0:ie.options)==null?void 0:se.weekStartsOn)??u.weekStartsOn??((ue=(Te=u.locale)==null?void 0:Te.options)==null?void 0:ue.weekStartsOn)??0,s=Qh(e);if(!mJ(s))throw new RangeError("Invalid time value");let L=n.match(uQ).map(ce=>{const de=ce[0];if(de==="p"||de==="P"){const Ee=tQ[de];return Ee(ce,f.formatLong)}return ce}).join("").match(cQ).map(ce=>{if(ce==="''")return{isToken:!1,value:"'"};const de=ce[0];if(de==="'")return{isToken:!1,value:fQ(ce)};if(QO[de])return{isToken:!0,value:ce};if(de.match(pQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+de+"`");return{isToken:!1,value:ce}});f.localize.preprocessor&&(L=f.localize.preprocessor(s,L));const F={firstWeekContainsDate:w,weekStartsOn:p,locale:f};return L.map(ce=>{if(!ce.isToken)return ce.value;const de=ce.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&aQ(de)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&oQ(de))&&sQ(de,n,String(e));const Ee=QO[de[0]];return Ee(s,de,f.localize,F)}).join("")}function fQ(e){const n=e.match(hQ);return n?n[1].replace(dQ,"'"):e}function sB(e){return Qh(e).getHours()}function lB(e){return iB(e,Date.now())}function mQ(e,n){return cJ(e,-n)}function cB(e){return iB(e,mQ(Date.now(),1))}function gQ({buttonIcon:e,buttonText:n,children:a,state:u,reload:f}){var fr,Zr,qr,sn,qn,Li,_i,zi,Pi,rr,Me,qe,at,$t,cr,br,en,ur,Kr,Vr,cn,Xn;const[w,p]=fe.useState(!1),[s,L]=fe.useState(!1),[F,G]=fe.useState(u),H=fe.useRef(),X=fe.useRef(),ne=fe.useRef(),[ie,se]=fe.useState({stack:u.stack,type:u.dev.type,lga:u.dev.lga,zone:u.dev.zone,status:u.dev.status}),[Te,ue]=fe.useState((Zr=(fr=u==null?void 0:u.currentOffice)==null?void 0:fr.id)==null?void 0:Zr.name.includes("ASSESSMENT")),[ce,de]=fe.useState((sn=(qr=u==null?void 0:u.currentOffice)==null?void 0:qr.id)==null?void 0:sn.name.includes("CLEARING HOUSE")),[Ee,Ne]=fe.useState((Li=(qn=u==null?void 0:u.currentOffice)==null?void 0:qn.id)==null?void 0:Li.name.includes("ARCHIVE")),[rt,tt]=fe.useState((zi=(_i=u==null?void 0:u.currentOffice)==null?void 0:_i.id)==null?void 0:zi.name.includes("COMMISSIONER")),[Ge,_t]=fe.useState(u.applicant.type==="company");let[yt,Et]=fe.useState(!1);const[Wt,Ar]=fe.useState(Number(u.dev.assessedAmount)),[mt,nr]=fe.useState(Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(u.dev.assessedAmount||0)),[Xt,Ht]=fe.useState(u.approval.isCollected),[Qt,sr]=fe.useState(u.approval.status||"processing"),[Tr,ln]=fe.useState(!1),[vn,wi]=fe.useState(!1),[hi,Vn]=fe.useState(!1),{currentUser:Oi,loading:fn}=ma(Mr=>Mr.user),Nn=Ia(),Pt=()=>L(!0),Dt=()=>{Ar(Number(F.dev.assessedAmount)),nr(Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(F.dev.assessedAmount||0)),p(!1),sr(F.approval.status||"processing"),Ht(F.approval.isCollected),ln(!1),wi(!1),Vn(!1),L(!1)},Ir=async Mr=>{Mr.preventDefault(),p(!0);const Fr=new FormData(Mr.target);let ri;ce?ri={"applicant.type":Fr.get("applicantType"),"applicant.name":Fr.get("applicantName"),"applicant.gender":Fr.get("applicantGender"),"applicant.address":Fr.get("applicantAddress"),"applicant.email":Fr.get("applicantEmail"),"applicant.phone":Fr.get("applicantPhone"),"applicant.phone1":Fr.get("applicantPhone1")||"","applicant.photo":Fr.get("applicantPassport")||"","rep.name":Fr.get("repName"),"rep.gender":Fr.get("repGender"),"rep.address":Fr.get("repAddress"),"rep.email":Fr.get("repEmail"),"rep.phone":Fr.get("repPhone"),"rep.phone1":Fr.get("repPhone1")||"","dev.name":Fr.get("planBuildingName")||"","dev.plotNo":Fr.get("planPlotNo"),"dev.address":Fr.get("planAddress"),"dev.region":Fr.get("planRegion")||"","dev.lga":Fr.get("planLga")||"","dev.zone":Fr.get("planZone")||"","dev.type":Fr.get("planBuildingType")||"","dev.use":Fr.get("planBuildingUse")||"","dev.status":Fr.get("planBuildingStatus")||"","dev.noOfFloor":Fr.get("planFloors")||"","dev.coordinates":Fr.get("planCoordinates")||""}:Te?(ri={stack:Fr.get("planStack")||"",isFastTrack:H.current.checked,isOldFile:X.current.checked,isFileOfInterest:ne.current.checked,"dev.name":Fr.get("planBuildingName")||"","dev.plotNo":Fr.get("planPlotNo"),"dev.address":Fr.get("planAddress"),"dev.region":Fr.get("planRegion")||"","dev.lga":Fr.get("planLga")||"","dev.zone":Fr.get("planZone")||"","dev.type":Fr.get("planBuildingType")||"","dev.use":Fr.get("planBuildingUse")||"","dev.status":Fr.get("planBuildingStatus")||"","dev.noOfFloor":Fr.get("planFloors")||"","dev.coordinates":Fr.get("planCoordinates")||"","dev.assessedAmount":Wt},hi&&(ri["dev.description"]=Fr.get("devDescription")||"")):Ee?(ri={stack:Fr.get("planStack")||"",hasTax:Fr.get("planHasTax")==="yes"},hi&&(ri["dev.description"]=Fr.get("devDescription")||""),Tr&&(ri["approval.status"]=Fr.get("planApprovalStatus"),ri["approval.statusDate"]=Fr.get("planApprovalStatusDate")||new Date),vn&&(ri["approval.isCollected"]=Fr.get("collectedApproval")==="yes",ri["approval.isCollectedDate"]=Fr.get("collectedApprovalDate")||new Date)):rt?(ri={stack:Fr.get("planStack")||"",hasTax:Fr.get("planHasTax")==="yes"},hi&&(ri["dev.description"]=Fr.get("devDescription")||""),Tr&&(ri["approval.status"]=Fr.get("planApprovalStatus"),ri["approval.statusDate"]=Fr.get("planApprovalStatusDate")||new Date)):(ri={stack:Fr.get("planStack")||""},hi&&(ri["dev.description"]=Fr.get("devDescription")||"")),Zi.defaults.withCredentials=!0;try{let mi={}.VITE_SERVER;const gi=await Zi.put(`${mi}/staffs/plan/${F._id}`,ri,{withCredentials:!0});f(()=>[]),Dt(),setTimeout(()=>{ai.success(gi.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:Nn})},200)}catch(mi){let gi=mi.response?mi.response.data.message:mi.message;p(!1),ai.error(gi,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:Nn})}},xr=(Mr,Fr)=>y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:Mr==="applicant"?"Applicant Information":"Representative Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{children:[y.jsx("label",{htmlFor:Mr+"Name",children:Ge&&Mr!=="rep"?"Company Name:":"Full Name:"}),y.jsx("input",{defaultValue:Fr.name,type:"text",name:Mr+"Name",id:Mr+"Name",required:!0})]})}),(!Ge||Mr==="rep")&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"Gender",children:"Gender:"}),y.jsxs("div",{className:"radioBoxWrapper",children:[y.jsxs("label",{htmlFor:Mr+"Gender1",children:[y.jsx("span",{children:"Female"}),y.jsx("input",{defaultChecked:(Fr==null?void 0:Fr.gender)==="female",type:"radio",name:Mr+"Gender",value:"female",id:Mr+"Gender1",required:!0})]}),y.jsxs("label",{htmlFor:Mr+"Gender2",children:[y.jsx("span",{children:"Male"}),y.jsx("input",{defaultChecked:(Fr==null?void 0:Fr.gender)==="male",type:"radio",name:Mr+"Gender",value:"male",id:Mr+"Gender2",required:!0})]})]})]}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"Address",children:Ge&&Mr!=="rep"?"Company Address:":"Address:"}),y.jsx("input",{defaultValue:Fr==null?void 0:Fr.address,type:"text",name:Mr+"Address",id:Mr+"Address",required:!0})]}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemPhone",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:Mr+"Phone1",children:"Phone 1:"}),y.jsx("input",{defaultValue:Fr==null?void 0:Fr.phone,type:"tel",name:Mr+"Phone1",id:Mr+"Phone1"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:Mr+"Phone2",children:"Phone 2:"}),y.jsx("input",{defaultValue:Fr==null?void 0:Fr.phone1,type:"tel",name:Mr+"Phone1",id:Mr+"Phone2"})]})]})}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"Email",children:"Email:"}),y.jsx("input",{defaultValue:Fr==null?void 0:Fr.email,type:Mr+"Email",id:Mr+"Email"})]}),(!Ge||Mr==="rep")&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"IdCard",children:"Select Means of identification:"}),y.jsxs("label",{htmlFor:Mr+"IdCard",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:Mr+"IdCard",id:Mr+"IdCard",accept:"image/png, image/jpeg, image/jpg"})]})]}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"Passport",children:!Ge||Mr==="rep"?"Select passport:":"Select Logo"}),y.jsxs("label",{htmlFor:Mr+"Passport",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:Mr+"Passport",id:Mr+"Passport",accept:"image/png, image/jpeg, image/jpg"})]})]}),Ge&&Mr!=="rep"&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:Mr+"CacCertificate",children:"Select CAC Certificate:"}),y.jsxs("label",{htmlFor:Mr+"CacCertificate",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:Mr+"CacCertificate",id:Mr+"CacCertificate",accept:"image/png, image/jpeg, image/jpg"})]})]})]})]}),Kt="Escape",Cn="keyup";gn(Dt);function gn(Mr){const Fr=fe.useCallback(ri=>{ri.key===Kt&&Mr()},[Mr]);fe.useEffect(()=>(document.addEventListener(Cn,Fr,!1),()=>{document.removeEventListener(Cn,Fr,!1)}),[Fr])}return fe.useEffect(()=>{const Mr=document.querySelector(".modalView");Mr&&(s?Mr.showModal():Mr.close())},[s]),y.jsxs("div",{children:[y.jsxs("button",{className:"modalTrigger",onClick:Pt,children:[y.jsx(fH,{className:"editIcon"}),Ee?"Update":"Edit"]}),s&&y.jsxs("dialog",{className:"modalView",children:[y.jsxs("header",{children:[y.jsxs("span",{children:["Edit Plan Info - ",((Pi=F==null?void 0:F.planNumber)==null?void 0:Pi.fullValue)||(F==null?void 0:F.uniqueId)]}),y.jsx("div",{className:"modalViewCloseButton",onClick:Dt,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:Ir,children:[!ce&&y.jsxs("div",{className:"currentStackEdit",children:[y.jsx("label",{htmlFor:"planStack",children:"Current Stack:"}),y.jsxs("select",{onChange:Mr=>{let Fr={...ie,stack:Mr.target.value};se(Fr)},name:"planStack",id:"planStack",value:ie.stack,children:[y.jsx("option",{value:"Not Stacked"}),KK.map(Mr=>y.jsx("option",{value:Mr,children:Mr},Cc()))]})]}),(rt||Ee)&&y.jsxs("div",{className:"applicationItems",children:[y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"planHasTax",children:"Has Tax:"}),y.jsxs("select",{name:"planHasTax",id:"planHasTax",defaultValue:F!=null&&F.hasTax?"yes":"no",children:[y.jsx("option",{value:"no",children:"No"}),y.jsx("option",{value:"yes",children:"Yes"})]})]}),y.jsxs("div",{className:"applicationItem ",children:[y.jsxs("div",{className:"planApprovalStatus",children:[y.jsx("label",{htmlFor:"planApprovalStatus",children:"Plan Approval Status:"}),y.jsx("div",{className:"editBtn",onClick:()=>{var Mr;ln(!Tr),sr((Mr=F.approval)==null?void 0:Mr.status)},children:y.jsx("span",{children:Tr?"Cancel Update":"Update"})})]}),!Tr&&y.jsxs("div",{className:"approvalStatusDisplay",children:[y.jsx("span",{className:"status",children:(rr=F==null?void 0:F.approval)==null?void 0:rr.status}),"||",y.jsx("span",{className:"date",children:(Me=F==null?void 0:F.approval)!=null&&Me.statusDate?$l(new Date((qe=F==null?void 0:F.approval)==null?void 0:qe.statusDate),"EEEE, MMMM do, yyyy"):"Pending"})]}),Tr&&y.jsxs("select",{defaultValue:(at=F==null?void 0:F.approval)==null?void 0:at.status,name:"planApprovalStatus",id:"planApprovalStatus",onChange:Mr=>{sr(Mr.target.value)},children:[y.jsx("option",{value:"processing",children:"Processing"}),y.jsx("option",{value:"rejected",children:"Rejected"}),y.jsx("option",{value:"kiv",children:"KIV"}),y.jsx("option",{value:"approved",children:"Approved"})]})]}),Qt!=="processing"&&Tr?y.jsxs("div",{className:"applicationItem",children:[y.jsxs("label",{htmlFor:"planApprovalStatusDate",children:["Approval Status Date:"," ",y.jsx("span",{className:"optionIssueTag",children:"Do not select a date except for backlog"})]}),y.jsx("input",{defaultValue:F.approval.statusDate?new Date(($t=F==null?void 0:F.approval)==null?void 0:$t.statusDate).toISOString().slice(0,19):"",type:"datetime-local",name:"planApprovalStatusDate",id:"planApprovalStatusDate"})]}):"",y.jsx("br",{})]}),Ee&&y.jsxs("div",{className:"applicationItems",children:[y.jsxs("div",{className:"applicationItem",children:[y.jsxs("div",{className:"planApprovalStatus",children:[y.jsx("label",{htmlFor:"collectedApproval",children:"Collected Approval:"}),y.jsx("div",{className:"editBtn",onClick:()=>{var Mr;wi(!vn),Ht((Mr=F.approval)==null?void 0:Mr.isCollected)},children:y.jsx("span",{children:vn?"Cancel Update":"Update"})})]}),!vn&&y.jsxs("div",{className:"approvalStatusDisplay",children:[y.jsx("span",{className:"status",children:(cr=F==null?void 0:F.approval)!=null&&cr.isCollected?"Yes":"No"}),"||",y.jsx("span",{className:"date",children:(br=F==null?void 0:F.approval)!=null&&br.isCollectedDate?$l(new Date((en=F==null?void 0:F.approval)==null?void 0:en.isCollectedDate),"EEEE, MMMM do, yyyy"):"Pending"})]}),vn&&y.jsxs("select",{defaultValue:(ur=F==null?void 0:F.approval)!=null&&ur.isCollected?"yes":"no",name:"collectedApproval",id:"collectedApproval",onChange:Mr=>{Ht(Mr.target.value=="yes")},children:[y.jsx("option",{value:"no",children:"No"}),y.jsx("option",{value:"yes",children:"Yes"})]})]}),Xt&&vn&&y.jsxs("div",{className:"applicationItem",children:[y.jsxs("label",{htmlFor:"collectedApprovalDate",children:["Collection Date:",y.jsx("span",{className:"optionIssueTag",children:"Do not select a date except for backlog"})]}),y.jsx("input",{defaultValue:(Kr=F==null?void 0:F.approval)!=null&&Kr.isCollectedDate?new Date((Vr=F==null?void 0:F.approval)==null?void 0:Vr.isCollectedDate).toISOString().slice(0,23):"",type:"datetime-local",name:"collectedApprovalDate",id:"collectedApprovalDate"})]}),y.jsx("br",{})]}),Te&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"planEditInfoTags",children:[y.jsx("h4",{children:"Tags:"}),y.jsxs("div",{className:"planEditInfoTagsOptions",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"fastTrack",children:"Fast Track"}),y.jsx("input",{defaultChecked:F.isFastTrack,type:"checkbox",name:"fastTrack",id:"fastTrack",ref:H})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"oldFile",children:"Old File"}),y.jsx("input",{defaultChecked:F.isOldFile,type:"checkbox",name:"oldFile",id:"oldFile",ref:X})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"fileOfInterest",children:"File Of Interest"}),y.jsx("input",{defaultChecked:F.isFileOfInterest,type:"checkbox",name:"fileOfInterest",id:"fileOfInterest",ref:ne})]})]})]}),y.jsx("br",{}),y.jsxs("div",{className:"modalAssessedAmount",children:[y.jsx("label",{htmlFor:"assessedAmount",children:"Assessed Amount:"}),y.jsx("input",{onFocus:()=>{Et(!0)},onBlur:()=>{Et(!1)},onChange:Mr=>{const Fr=Mr.target.value;Ar(Number(Fr)),nr(Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(Fr))},type:yt?"number":"text",value:yt?Wt:mt,name:"assessedAmount",id:"assessedAmount"})]})]}),ce&&xr("applicant",F.applicant),ce&&xr("rep",F.rep),ce||Te?y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Development Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingName",children:"Building Name:"}),y.jsx("input",{defaultValue:F.dev.name,type:"text",name:"planBuildingName",id:"planBuildingName"})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemAddressModal",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planPlotNo",children:"Plot No:"}),y.jsx("input",{defaultValue:F.dev.plotNo,type:"text",name:"planPlotNo",required:!0,id:"planPlotNo"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planAddress",children:"Address:"}),y.jsx("input",{defaultValue:F.dev.address,type:"text",name:"planAddress",id:"planAddress",required:!0})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemLocation",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planRegion",children:"Region:"}),y.jsx("input",{type:"text",readOnly:!0,name:"planRegion",value:F.dev.region,id:"planRegion"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planLga",children:"LGA:"}),y.jsxs("select",{onChange:Mr=>{let Fr={...ie,lga:Mr.target.value};se(Fr)},name:"planLga",id:"planLga",value:ie.lga,children:[y.jsx("option",{value:""}),X4.map(Mr=>y.jsx("option",{value:Mr,children:Mr},Cc()))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planZone",children:"Zone:"}),y.jsxs("select",{onChange:Mr=>{let Fr={...ie,zone:Mr.target.value};se(Fr)},name:"planZone",id:"planZone",value:ie.zone,children:[y.jsx("option",{value:""}),Oi.region.zones.map(Mr=>y.jsx("option",{value:Mr,children:Mr},Cc()))]})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemType",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingType",children:"Building Type:"}),y.jsxs("select",{onChange:Mr=>{let Fr={...ie,type:Mr.target.value};se(Fr)},name:"planBuildingType",id:"planBuildingType",value:ie.type,children:[y.jsx("option",{value:""}),K4.map(Mr=>y.jsx("option",{value:Mr,children:Mr},Cc()))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingUse",children:"Building Use:"}),y.jsx("input",{type:"text",name:"planBuildingUse",id:"planBuildingUse",defaultValue:F.dev.use})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingStatus",children:"Building Status:"}),y.jsxs("select",{onChange:Mr=>{let Fr={...ie,status:Mr.target.value};se(Fr)},name:"planBuildingStatus",id:"planBuildingStatus",value:ie.status,children:[y.jsx("option",{value:""}),Y4.map(Mr=>y.jsx("option",{value:Mr,children:Mr},Cc()))]})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemType",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planFloors",children:"No of Floors:"}),y.jsx("input",{type:"text",name:"planFloors",id:"planFloors",defaultValue:F.dev.noOfFloors})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planCoordinates",children:"Survey Coordinates:"}),y.jsx("input",{defaultValue:F.dev.coordinates,type:"text",name:"planCoordinates",id:"planCoordinates"})]})]})})]})]}):"",!ce&&y.jsxs("div",{className:"minuteItem",children:[y.jsxs("div",{className:"planApprovalStatus",children:[y.jsx("label",{htmlFor:"devDescription",children:"Development Description:"}),y.jsx("div",{className:"editBtn",onClick:()=>{Vn(!hi)},children:y.jsx("span",{children:hi?"Cancel Update":"Update"})})]}),hi?y.jsx("textarea",{defaultValue:(cn=F==null?void 0:F.dev)==null?void 0:cn.description,name:"devDescription",id:"devDescription",cols:"30",rows:"7"}):y.jsx("div",{className:"devDescriptionText",children:y.jsx("p",{children:(Xn=F==null?void 0:F.dev)==null?void 0:Xn.description})})]}),y.jsx("br",{}),y.jsxs("footer",{children:[" ",y.jsx("button",{type:"submit",className:"primary",disabled:w,children:w?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Save"})]})]})]})]})}function _Q({buttonIcon:e,buttonText:n,children:a,data:u,reload:f}){var Te;const[w,p]=fe.useState(!1),[s,L]=fe.useState(!1),F=Ia(),G=()=>p(!0),H=()=>p(!1),X="Escape",ne="keyup";ie(H);function ie(ue){const ce=fe.useCallback(de=>{de.key===X&&ue()},[ue]);fe.useEffect(()=>(document.addEventListener(ne,ce,!1),()=>{document.removeEventListener(ne,ce,!1)}),[ce])}const se=async ue=>{ue.preventDefault(),L(!0);const ce=new FormData(ue.target),de={status:ce.get("minuteStatus"),text:ce.get("minuteText")};try{let Ee={}.VITE_SERVER;const Ne=await Zi.post(`${Ee}/staffs/plan/${u._id}/comment`,de);f(()=>[]),H(),setTimeout(()=>{ai.success(Ne.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:F})},200)}catch(Ee){let Ne=Ee.response?Ee.response.data.message:Ee.message;L(!1),ai.error(Ne,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:F})}};return fe.useEffect(()=>{const ue=document.querySelector(".modalView");ue&&(w?ue.showModal():ue.close())},[w]),y.jsxs("div",{children:[y.jsx("div",{children:y.jsx("button",{className:"modalTrigger secondary",onClick:G,children:"Add Comment"})}),w&&y.jsxs("dialog",{className:"modalView",children:[y.jsxs("header",{children:[y.jsxs("span",{children:["Plan - ",((Te=u==null?void 0:u.planNumber)==null?void 0:Te.fullValue)||(u==null?void 0:u.uniqueId)]}),y.jsx("div",{className:"modalViewCloseButton",onClick:H,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:se,children:[y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Add Comment"})}),y.jsx("div",{children:y.jsxs("div",{className:"minuteItems",children:[y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteStatus",children:"Status:"}),y.jsxs("select",{name:"minuteStatus",id:"minuteStatus",children:[y.jsx("option",{value:"",children:"..."}),QK.map(ue=>y.jsx("option",{value:ue,children:ue}))]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteText",children:"Comment:"}),y.jsx("textarea",{name:"minuteText",id:"minuteText",cols:"30",rows:"8"})]})]})})]}),y.jsx("footer",{children:y.jsx("button",{type:"submit",className:"primary",disabled:s,children:s?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Save"})})]})]})]})}function yQ({buttonIcon:e,buttonText:n,headerText:a,title:u,body:f,reload:w}){const[p,s]=fe.useState(!1),[L,F]=fe.useState(!1),G=()=>s(!0),H=()=>s(!1),X=Ay();ql();const ne=eu(),ie=Ia(),se=async()=>{F(!0);try{let de={}.VITE_SERVER;const Ee=await Zi.get(`${de}/staffs/plan/${X.id}/generate_id`,{withCredentials:!0});w(()=>[]),ne(r_()),setTimeout(()=>{ai.success(Ee.data,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ie})},0)}catch(de){let Ee=de.response?de.response.data.message:de.message;setTimeout(()=>{ai.error(Ee,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ie})},0)}F(!1),s(!1)},Te="Escape",ue="keyup";ce(H);function ce(de){const Ee=fe.useCallback(Ne=>{Ne.key===Te&&de()},[de]);fe.useEffect(()=>(document.addEventListener(ue,Ee,!1),()=>{document.removeEventListener(ue,Ee,!1)}),[Ee])}return fe.useEffect(()=>{const de=document.querySelector(".modalView");de&&(p?de.showModal():de.close())},[p]),y.jsxs("div",{children:[y.jsx("button",{className:"modalTrigger",onClick:G,children:n}),p&&y.jsxs("dialog",{className:"modalView confirmationModal",children:[y.jsxs("header",{children:[y.jsx("span",{children:a}),y.jsx("div",{className:"modalViewCloseButton",onClick:H,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:u})}),y.jsx("p",{children:f}),y.jsxs("footer",{children:[y.jsx("button",{disabled:L,onClick:se,className:"primary",children:L?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Okay"}),y.jsx("button",{disabled:L,className:"secondary",onClick:H,children:"Cancel"})]})]}),y.jsx(Pu,{})]})}var vQ={exports:{}};(function(e,n){(function(a,u){e.exports=u()})(EA,function(){var a,u,f;function w(s,L){if(!a)a=L;else if(!u)u=L;else{var F="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",G={};a(G),f=L(G),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([F],{type:"text/javascript"})))}}w(["exports"],function(s){var L="3.3.0";let F;const G={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(F==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{F={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{F=r}}return F},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!G.API_URL)return null;try{const r=new URL(G.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"};function H(r){return G.API_URL_REGEX.test(r)}function X(r){return r.indexOf("mapbox:")===0}function ne(r){return G.API_CDN_URL_REGEX.test(r)}function ie(r){return G.API_SPRITE_REGEX.test(r)}function se(r){return G.API_STYLE_REGEX.test(r)&&!ie(r)}const Te={create:"create",load:"load",fullLoad:"fullLoad"};function ue(r){const t=r.name.split("?")[0];return ne(t)&&t.includes("mapbox-gl.js")?"javascript":ne(t)&&t.includes("mapbox-gl.css")?"css":function(i){return G.API_FONTS_REGEX.test(i)}(t)?"fontRange":ie(t)?"sprite":se(t)?"style":function(i){return G.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}function ce(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var de=Ee;function Ee(r,t,i,c){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=i,this.p2y=c}Ee.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var i=r,c=0;c<8;c++){var m=this.sampleCurveX(i)-r;if(Math.abs(m)<t)return i;var g=this.sampleCurveDerivativeX(i);if(Math.abs(g)<1e-6)break;i-=m/g}var b=0,C=1;for(i=r,c=0;c<20&&(m=this.sampleCurveX(i),!(Math.abs(m-r)<t));c++)r>m?b=i:C=i,i=.5*(C-b)+b;return i},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var Ne=ce(de),rt=tt;function tt(r,t){this.x=r,this.y=t}tt.prototype={clone:function(){return new tt(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,i=r.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),i=Math.sin(r),c=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=c,this},_rotateAround:function(r,t){var i=Math.cos(r),c=Math.sin(r),m=t.y+c*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-c*(this.y-t.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},tt.convert=function(r){return r instanceof tt?r:Array.isArray(r)?new tt(r[0],r[1]):r};var Ge=ce(rt);const _t=Math.PI/180,yt=180/Math.PI;function Et(r){return r*_t}function Wt(r){return r*yt}const Ar=[[0,0],[1,0],[1,1],[0,1]];function mt(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,i=t*r;return 4*(r<.5?i:3*(r-t)+i-.75)}function nr(r,t,i,c){const m=new Ne(r,t,i,c);return function(g){return m.solve(g)}}const Xt=nr(.25,.1,.25,1);function Ht(r,t,i){return Math.min(i,Math.max(t,r))}function Qt(r,t,i){return(i=Ht((i-r)/(t-r),0,1))*i*(3-2*i)}function sr(r,t,i){const c=i-t,m=((r-t)%c+c)%c+t;return m===t?i:m}function Tr(r,t,i){if(!r.length)return i(null,[]);let c=r.length;const m=new Array(r.length);let g=null;r.forEach((b,C)=>{t(b,(k,R)=>{k&&(g=k),m[C]=R,--c==0&&i(g,m)})})}function ln(r,...t){for(const i of t)for(const c in i)r[c]=i[c];return r}let vn=1;function wi(){return vn++}function hi(){return function r(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Vn(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Oi(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function fn(r,t){r.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Nn(r,t){return r.indexOf(t,r.length-t.length)!==-1}function Pt(r,t,i){const c={};for(const m in r)c[m]=t.call(i||this,r[m],m,r);return c}function Dt(r,t,i){const c={};for(const m in r)t.call(i||this,r[m],m,r)&&(c[m]=r[m]);return c}function Ir(r){return Array.isArray(r)?r.map(Ir):typeof r=="object"&&r?Pt(r,Ir):r}const xr={};function Kt(r){xr[r]||(typeof console<"u"&&console.warn(r),xr[r]=!0)}function Cn(r,t,i){return(i.y-r.y)*(t.x-r.x)>(t.y-r.y)*(i.x-r.x)}function gn(r){let t=0;for(let i,c,m=0,g=r.length,b=g-1;m<g;b=m++)i=r[m],c=r[b],t+=(c.x-i.x)*(i.y+c.y);return t}function fr([r,t,i]){const c=Et(t+90),m=Et(i);return{x:r*Math.cos(c)*Math.sin(m),y:r*Math.sin(c)*Math.sin(m),z:r*Math.cos(m),azimuthal:t,polar:i}}function Zr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function qr(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,c,m,g)=>{const b=m||g;return t[c]=!b||b.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let sn,qn,Li,_i,zi,Pi,rr=null;function Me(r){try{const t=self[r];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function qe(r,t){return[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]]}function at(r,t,i,c){for(;t<i;){const m=t+i>>1;r[m]<c?t=m+1:i=m}return t}function $t(r,t,i,c){for(;t<i;){const m=t+i>>1;r[m]<=c?t=m+1:i=m}return t}function cr(){return sn==null&&(sn=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),sn}const br={now:()=>_i!==void 0?_i:performance.now(),setNow(r){_i=r},restoreNow(){_i=void 0},frame(r){const t=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(r,t=0){const{width:i,height:c}=r;zi||(zi=document.createElement("canvas"));const m=zi.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(i>zi.width||c>zi.height)&&(zi.width=i,zi.height=c),m.clearRect(-t,-t,i+2*t,c+2*t),m.drawImage(r,0,0,i,c),m.getImageData(-t,-t,i+2*t,c+2*t)},resolveURL:r=>(qn||(qn=document.createElement("a")),qn.href=r,qn.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Li==null&&(Li=window.matchMedia("(prefers-reduced-motion: reduce)")),Li.matches)},hasCanvasFingerprintNoise(){if(Pi!==void 0)return Pi;if(!cr())return Pi=!1,!1;const r=new OffscreenCanvas(85,1),t=r.getContext("2d",{willReadFrequently:!0});let i=0;for(let m=0;m<r.width;++m)t.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,t.fillRect(m,0,1,1);const c=t.getImageData(0,0,r.width,r.height);i=0;for(let m=0;m<c.data.length;++m)if(m%4!=3&&i++!==c.data[m])return Pi=!0,!0;return Pi=!1,!1}},en="mapbox-tiles";let ur=500,Kr=50,Vr,cn;function Xn(){try{return caches}catch{}}function Mr(){const r=Xn();r&&!Vr&&(Vr=r.open(en))}function Fr(r){const t=r.indexOf("?");if(t<0)return r;const i=["language","worldview"],c=new URLSearchParams,m=new URLSearchParams(r.slice(t));for(const g of i){const b=m.get(g);b&&c.set(g,b)}return`${r.slice(0,t)}?${c.toString()}`}function ri(r,t){const i=r.indexOf("?");if(i<0)return`${r}?${new URLSearchParams(t).toString()}`;const c=new URLSearchParams(r.slice(i));for(const m in t)c.set(m,t[m]);return`${r.slice(0,i)}?${c.toString()}`}let mi=1/0;const gi={supported:!1,testSupport:function(r){!eo&&mo&&(Se?Fe(r):Xi=r)}};let Xi,mo,eo=!1,Se=!1;const Re=typeof self<"u"?self:{};function Fe(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,mo),r.isContextLost())return;gi.supported=!0}catch{}r.deleteTexture(t),eo=!0}Re.document&&(mo=Re.document.createElement("img"),mo.onload=function(){Xi&&Fe(Xi),Xi=null,Se=!0},mo.onerror=function(){eo=!0,Xi=null},mo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const et={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(et);class it extends Error{constructor(t,i,c){i===401&&H(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const wt=Zr()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,$e=function(r,t){if(!(/^file:/.test(i=r.url)||/^file:/.test(wt())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,m){const g=new AbortController,b=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:wt(),referrerPolicy:c.referrerPolicy,signal:g.signal});let C=!1,k=!1;const R=(z=b.url).indexOf("sku=")>0&&H(z);var z;c.type==="json"&&b.headers.set("Accept","application/json");const V=(Q,te,oe)=>{if(k)return;if(Q&&Q.message!=="SecurityError"&&Kt(Q.toString()),te&&oe)return q(te);const pe=Date.now();fetch(b).then(_e=>{if(_e.ok){const ze=R?_e.clone():null;return q(_e,ze,pe)}return m(new it(_e.statusText,_e.status,c.url))}).catch(_e=>{_e.name!=="AbortError"&&m(new Error(`${_e.message} ${c.url}`))})},q=(Q,te,oe)=>{(c.type==="arrayBuffer"?Q.arrayBuffer():c.type==="json"?Q.json():Q.text()).then(pe=>{k||(te&&oe&&function(_e,ze,Ue){if(Mr(),!Vr)return;const Ve=qr(ze.headers.get("Cache-Control")||"");if(Ve["no-store"])return;const nt={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((At,Bt)=>nt.headers.set(Bt,At)),Ve["max-age"]&&nt.headers.set("Expires",new Date(Ue+1e3*Ve["max-age"]).toUTCString());const Qe=nt.headers.get("Expires");if(!Qe||new Date(Qe).getTime()-Ue<42e4)return;let gt=Fr(_e.url);if(ze.status===206){const At=_e.headers.get("Range");if(!At)return;nt.status=200,gt=ri(gt,{range:At})}(function(At,Bt){if(cn===void 0)try{new Response(new ReadableStream),cn=!0}catch{cn=!1}cn?Bt(At.body):At.blob().then(Bt)})(ze,At=>{const Bt=new Response(At,nt);Mr(),Vr&&Vr.then(Yt=>Yt.put(gt,Bt)).catch(Yt=>Kt(Yt.message))})}(b,te,oe),C=!0,m(null,pe,Q.headers.get("Cache-Control"),Q.headers.get("Expires")))}).catch(pe=>{k||m(new Error(pe.message))})};return R?function(Q,te){if(Mr(),!Vr)return te(null);Vr.then(oe=>{let pe=Fr(Q.url);const _e=Q.headers.get("Range");_e&&(pe=ri(pe,{range:_e})),oe.match(pe).then(ze=>{const Ue=function(Ve){if(!Ve)return!1;const nt=new Date(Ve.headers.get("Expires")||0),Qe=qr(Ve.headers.get("Cache-Control")||"");return nt>Date.now()&&!Qe["no-cache"]}(ze);oe.delete(pe),Ue&&oe.put(pe,ze.clone()),te(null,ze,Ue)}).catch(te)}).catch(te)}(b,V):V(null,null),{cancel:()=>{k=!0,C||g.abort()}}}(r,t);if(Zr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var i;return function(c,m){const g=new XMLHttpRequest;g.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const b in c.headers)g.setRequestHeader(b,c.headers[b]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=()=>{m(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let b=g.response;if(c.type==="json")try{b=JSON.parse(g.response)}catch(C){return m(C)}m(null,b,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else m(new it(g.statusText,g.status,c.url))},g.send(c.body),{cancel:()=>g.abort()}}(r,t)},ve=function(r,t){return $e(ln(r,{type:"arrayBuffer"}),t)};function Le(r){const t=document.createElement("a");return t.href=r,t.protocol===location.protocol&&t.host===location.host}const ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Mt,Ot;Mt=[],Ot=0;const bt=function(r,t){if(gi.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),Ot>=G.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Mt.push(g),g}Ot++;let i=!1;const c=()=>{if(!i)for(i=!0,Ot--;Mt.length&&Ot<G.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Mt.shift(),{requestParameters:b,callback:C,cancelled:k}=g;k||(g.cancel=bt(b,C).cancel)}},m=ve(r,(g,b,C,k)=>{c(),g?t(g):b&&(self.createImageBitmap?function(R,z){const V=new Blob([new Uint8Array(R)],{type:"image/png"});createImageBitmap(V).then(q=>{z(null,q)}).catch(q=>{z(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(R,z)=>t(R,z,C,k)):function(R,z){const V=new Image;V.onload=()=>{z(null,V),URL.revokeObjectURL(V.src),V.onload=null,requestAnimationFrame(()=>{V.src=ot})},V.onerror=()=>z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(R)],{type:"image/png"});V.src=R.byteLength?URL.createObjectURL(q):ot}(b,(R,z)=>t(R,z,C,k)))});return{cancel:()=>{m.cancel(),c()}}},Rt="01",ar="NO_ACCESS_TOKEN",qt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Nt(r){const t=r.match(qt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Rr(r){const t=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${t}`}const er="mapbox.eventData";function Nr(r){if(!r)return null;const t=r.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ln{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=Nr(G.ACCESS_TOKEN);let c="";return c=i&&i.u?btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(m,g)=>String.fromCharCode(+("0x"+g)))):G.ACCESS_TOKEN||"",t?`${er}.${t}:${c}`:`${er}:${c}`}fetchEventData(){const t=Me("localStorage"),i=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{const m=localStorage.getItem(i);m&&(this.eventData=JSON.parse(m));const g=localStorage.getItem(c);g&&(this.anonId=g)}catch{Kt("Unable to read from LocalStorage")}}saveEventData(){const t=Me("localStorage"),i=this.getStorageKey(),c=this.getStorageKey("uuid"),m=this.anonId;if(t&&m)try{localStorage.setItem(c,m),Object.keys(this.eventData).length>=1&&localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Kt("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,c,m){if(!G.EVENTS_URL)return;const g=Nt(G.EVENTS_URL);g.params.push(`access_token=${m||G.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(t).toISOString()},C=i?ln(b,i):b,k={url:Rr(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(R,z){return $e(ln(R,{method:"POST"}),z)}(k,R=>{this.pendingRequest=null,c(R),this.saveEventData(),this.processRequests(m)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const $r=new class extends Ln{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,t){G.EVENTS_URL&&G.ACCESS_TOKEN&&Array.isArray(r)&&r.some(i=>X(i)||H(i))&&this.queueRequest(Date.now(),t)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Nr(G.ACCESS_TOKEN),i=t?t.u:G.ACCESS_TOKEN;let c=i!==this.eventData.tokenU;Oi(this.anonId)||(this.anonId=hi(),c=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),b=new Date(m),C=(m-this.eventData.lastSuccess)/864e5;c=c||C>=1||C<-1||g.getDate()!==b.getDate()}else c=!0;c?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Rt,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=m,this.eventData.tokenU=i)},r):this.processRequests()}},si=$r.postTurnstileEvent.bind($r),Yi=new class extends Ln{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,t,i,c){this.skuToken=t,this.errorCb=c,G.EVENTS_URL&&(i||G.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(ar)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Oi(this.anonId)||(this.anonId=hi()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Rt,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r))}remove(){this.errorCb=null}},xn=Yi.postMapLoadEvent.bind(Yi),$i=new class extends Ln{constructor(){super("gljs.performance")}postPerformanceEvent(r,t){G.EVENTS_URL&&(r||G.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),c=function(m){const g=performance.getEntriesByType("resource"),b=performance.getEntriesByType("mark"),C=function(Q){const te={};if(Q){for(const oe in Q)if(oe!=="other")for(const pe of Q[oe]){const _e=`${oe}ResolveRangeMin`,ze=`${oe}ResolveRangeMax`,Ue=`${oe}RequestCount`,Ve=`${oe}RequestCachedCount`;te[_e]=Math.min(te[_e]||1/0,pe.startTime),te[ze]=Math.max(te[ze]||-1/0,pe.responseEnd);const nt=Qe=>{te[Qe]===void 0&&(te[Qe]=0),++te[Qe]};pe.transferSize!==void 0&&pe.transferSize===0&&nt(Ve),nt(Ue)}}return te}(function(Q,te){const oe={};if(Q)for(const pe of Q){const _e=te(pe);oe[_e]===void 0&&(oe[_e]=[]),oe[_e].push(pe)}return oe}(g,ue)),k=window.devicePixelRatio,R=navigator.connection||navigator.mozConnection||navigator.webkitConnection,z=R?R.effectiveType:void 0,V={counters:[],metadata:[],attributes:[]},q=(Q,te,oe)=>{oe!=null&&Q.push({name:te,value:oe.toString()})};for(const Q in C)q(V.counters,Q,C[Q]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(q(V.counters,"interactionRangeMin",m.interactionRange[0]),q(V.counters,"interactionRangeMax",m.interactionRange[1])),b)for(const Q of Object.keys(Te)){const te=Te[Q],oe=b.find(pe=>pe.name===te);oe&&q(V.counters,te,oe.startTime)}return q(V.counters,"visibilityHidden",m.visibilityHidden),q(V.attributes,"style",function(Q){if(Q)for(const te of Q){const oe=te.name.split("?")[0];if(se(oe)){const pe=oe.split("/").slice(-2);if(pe.length===2)return`mapbox://styles/${pe[0]}/${pe[1]}`}}}(g)),q(V.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),q(V.attributes,"fogEnabled",m.fogEnabled?"true":"false"),q(V.attributes,"projection",m.projection),q(V.attributes,"zoom",m.zoom),q(V.metadata,"devicePixelRatio",k),q(V.metadata,"connectionEffectiveType",z),q(V.metadata,"navigatorUserAgent",navigator.userAgent),q(V.metadata,"screenWidth",window.screen.width),q(V.metadata,"screenHeight",window.screen.height),q(V.metadata,"windowWidth",window.innerWidth),q(V.metadata,"windowHeight",window.innerHeight),q(V.metadata,"mapWidth",m.width/k),q(V.metadata,"mapHeight",m.height/k),q(V.metadata,"webglRenderer",m.renderer),q(V.metadata,"webglVendor",m.vendor),q(V.metadata,"sdkVersion",L),q(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(i);for(const m of c.metadata);for(const m of c.counters);for(const m of c.attributes);this.postEvent(t,c,()=>{},r)}},di=$i.postPerformanceEvent.bind($i),vo=new class extends Ln{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,t,i,c){if(!G.API_URL||!G.SESSION_PATH)return;const m=Nt(G.API_URL+G.SESSION_PATH);m.params.push(`sku=${t||""}`),m.params.push(`access_token=${c||G.ACCESS_TOKEN||""}`);const g={url:Rr(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(b,C){return $e(ln(b,{method:"GET"}),C)}(g,b=>{this.pendingRequest=null,i(b),this.saveEventData(),this.processRequests(c)})}getSessionAPI(r,t,i,c){this.skuToken=t,this.errorCb=c,G.SESSION_PATH&&G.API_URL&&(i||G.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},i):this.errorCb(new Error(ar)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r)}remove(){this.errorCb=null}},to=vo.getSessionAPI.bind(vo),xo=new Set;function so(r,t,i){i[r]&&i[r].indexOf(t)!==-1||(i[r]=i[r]||[],i[r].push(t))}function Ni(r,t,i){if(i&&i[r]){const c=i[r].indexOf(t);c!==-1&&i[r].splice(c,1)}}class qi{constructor(t,i={}){ln(this,i),this.type=t}}class rs extends qi{constructor(t,i={}){super("error",ln({error:t},i))}}class kl{on(t,i){return this._listeners=this._listeners||{},so(t,i,this._listeners),this}off(t,i){return Ni(t,i,this._listeners),Ni(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},so(t,i,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,i){typeof t=="string"&&(t=new qi(t,i||{}));const c=t.type;if(this.listens(c)){t.target=this;const m=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const C of m)C.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const C of g)Ni(c,C,this._oneTimeListeners),C.call(this,t);const b=this._eventedParent;b&&(ln(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(t))}else t instanceof rs&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}s.y=void 0;var ga={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ho(r){return(r=Math.round(r))<0?0:r>255?255:r}function Oc(r){return Ho(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function Wl(r){return(t=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:t>1?1:t;var t}function Qo(r,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(t-r)*i*6:2*i<1?t:3*i<2?r+(t-r)*(2/3-i)*6:r}try{s.y={}.parseCSSColor=function(r){var t,i=r.replace(/ /g,"").toLowerCase();if(i in ga)return ga[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var c=i.indexOf("("),m=i.indexOf(")");if(c!==-1&&m+1===i.length){var g=i.substr(0,c),b=i.substr(c+1,m-(c+1)).split(","),C=1;switch(g){case"rgba":if(b.length!==4)return null;C=Wl(b.pop());case"rgb":return b.length!==3?null:[Oc(b[0]),Oc(b[1]),Oc(b[2]),C];case"hsla":if(b.length!==4)return null;C=Wl(b.pop());case"hsl":if(b.length!==3)return null;var k=(parseFloat(b[0])%360+360)%360/360,R=Wl(b[1]),z=Wl(b[2]),V=z<=.5?z*(R+1):z+R-z*R,q=2*z-V;return[Ho(255*Qo(q,V,k+1/3)),Ho(255*Qo(q,V,k)),Ho(255*Qo(q,V,k-1/3)),C];default:return null}}return null}}catch{}class Va{constructor(t,i,c,m=1){this.r=t,this.g=i,this.b=c,this.a=m}static parse(t){if(!t)return;if(t instanceof Va)return t;if(typeof t!="string")return;const i=s.y(t);return i?new Va(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,c,m]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(c)},${m})`}toArray(){const{r:t,g:i,b:c,a:m}=this;return m===0?[0,0,0,0]:[255*t/m,255*i/m,255*c/m,m]}toArray01(){const{r:t,g:i,b:c,a:m}=this;return m===0?[0,0,0,0]:[t/m,i/m,c/m,m]}toArray01Scaled(t){const{r:i,g:c,b:m,a:g}=this;return g===0?[0,0,0]:[i/g*t,c/g*t,m/g*t]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:c,a:m}=this;return[t,i,c,m]}toArray01Linear(){const{r:t,g:i,b:c,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(t/m,2.2),Math.pow(i/m,2.2),Math.pow(c/m,2.2),m]}}Va.black=new Va(0,0,0,1),Va.white=new Va(1,1,1,1),Va.transparent=new Va(0,0,0,0),Va.red=new Va(1,0,0,1),Va.blue=new Va(0,0,1,1);var po=Va;function Hn(r,t,i){return r*(1-i)+t*i}function Ra(r,t,i){return r.map((c,m)=>Hn(c,t[m],i))}var Uo=Object.freeze({__proto__:null,array:Ra,color:function(r,t,i){return new po(Hn(r.r,t.r,i),Hn(r.g,t.g,i),Hn(r.b,t.b,i),Hn(r.a,t.a,i))},number:Hn});function Gs(r,...t){for(const i of t)for(const c in i)r[c]=i[c];return r}class Os extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var _l=Os;class qs{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[c,m]of i)this.bindings[c]=m}concat(t){return new qs(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var zf=qs;const He={kind:"null"},Oe={kind:"number"},ft={kind:"string"},Vt={kind:"boolean"},Xr={kind:"color"},Gn={kind:"object"},kn={kind:"value"},_a={kind:"collator"},Ca={kind:"formatted"},Ua={kind:"resolvedImage"};function ya(r,t){return{kind:"array",itemType:r,N:t}}function va(r){if(r.kind==="array"){const t=va(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Un=[He,Oe,ft,Vt,Xr,Ca,Gn,ya(kn),Ua];function Hl(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Hl(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const i of Un)if(!Hl(i,t))return null}}return`Expected ${va(r)} but found ${va(t)} instead.`}function ui(r,t){return t.some(i=>i.kind===r.kind)}function Zl(r,t){return t.some(i=>i==="null"?r===null:i==="array"?Array.isArray(r):i==="object"?r&&!Array.isArray(r)&&typeof r=="object":i===typeof r)}class Fi{constructor(t,i,c){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class tu{constructor(t,i,c,m,g){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=c,this.fontStack=m,this.textColor=g}}class ea{constructor(t){this.sections=t}static fromString(t){return new ea([new tu(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof ea?t:ea.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.namePrimary]);continue}t.push(i.text);const c={};i.fontStack&&(c["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(c["font-scale"]=i.scale),i.textColor&&(c["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(c)}return t}}class Dn{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,i){return t?new Dn({namePrimary:t,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function ru(r,t,i,c){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[r,t,i,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[r,t,i,c]:[r,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Rl(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof po||r instanceof Fi||r instanceof ea||r instanceof Dn)return!0;if(Array.isArray(r)){for(const t of r)if(!Rl(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Rl(r[t]))return!1;return!0}return!1}function ta(r){if(r===null)return He;if(typeof r=="string")return ft;if(typeof r=="boolean")return Vt;if(typeof r=="number")return Oe;if(r instanceof po)return Xr;if(r instanceof Fi)return _a;if(r instanceof ea)return Ca;if(r instanceof Dn)return Ua;if(Array.isArray(r)){const t=r.length;let i;for(const c of r){const m=ta(c);if(i){if(i===m)continue;i=kn;break}i=m}return ya(i||kn,t)}return Gn}function ms(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof po||r instanceof ea||r instanceof Dn?r.toString():JSON.stringify(r)}class hc{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Rl(t[1]))return i.error("invalid value");const c=t[1];let m=ta(c);const g=i.expectedType;return m.kind!=="array"||m.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(m=g),new hc(m,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof po?["rgba"].concat(this.value.toArray()):this.value instanceof ea?this.value.serialize():this.value}}var $a=hc,lo=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Ru={string:ft,number:Oe,boolean:Vt,object:Gn};class Up{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let c,m=1;const g=t[0];if(g==="array"){let C,k;if(t.length>2){const R=t[1];if(typeof R!="string"||!(R in Ru)||R==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);C=Ru[R],m++}else C=kn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);k=t[2],m++}c=ya(C,k)}else c=Ru[g];const b=[];for(;m<t.length;m++){const C=i.parse(t[m],m,kn);if(!C)return null;b.push(C)}return new Up(c,b)}evaluate(t){for(let i=0;i<this.args.length;i++){const c=this.args[i].evaluate(t);if(!Hl(this.type,ta(c)))return c;if(i===this.args.length-1)throw new lo(`Expected value to be of type ${va(this.type)}, but found ${va(ta(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){i.push(c.kind);const m=t.N;(typeof m=="number"||this.args.length>1)&&i.push(m)}}return i.concat(this.args.map(c=>c.serialize()))}}var nu=Up;class ed{constructor(t){this.type=Ca,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return i.error("First argument must be an image or text section.");const m=[];let g=!1;for(let b=1;b<=t.length-1;++b){const C=t[b];if(g&&typeof C=="object"&&!Array.isArray(C)){g=!1;let k=null;if(C["font-scale"]&&(k=i.parse(C["font-scale"],1,Oe),!k))return null;let R=null;if(C["text-font"]&&(R=i.parse(C["text-font"],1,ya(ft)),!R))return null;let z=null;if(C["text-color"]&&(z=i.parse(C["text-color"],1,Xr),!z))return null;const V=m[m.length-1];V.scale=k,V.font=R,V.textColor=z}else{const k=i.parse(t[b],1,kn);if(!k)return null;const R=k.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,m.push({content:k,scale:null,font:null,textColor:null})}}return new ed(m)}evaluate(t){return new ea(this.sections.map(i=>{const c=i.content.evaluate(t);return ta(c)===Ua?new tu("",c,null,null,null):new tu(ms(c),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const c={};i.scale&&(c["font-scale"]=i.scale.serialize()),i.font&&(c["text-font"]=i.font.serialize()),i.textColor&&(c["text-color"]=i.textColor.serialize()),t.push(c)}return t}}class iu{constructor(t,i){this.type=Ua,this.inputPrimary=t,this.inputSecondary=i}static parse(t,i){if(t.length<2)return i.error("Expected two or more arguments.");const c=i.parse(t[1],1,ft);if(!c)return i.error("No image name provided.");if(t.length===2)return new iu(c);const m=i.parse(t[2],1,ft);return m?new iu(c,m):i.error("Secondary image variant is not a string.")}evaluate(t){const i=Dn.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&t.availableImages&&(i.available=t.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Du(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}const Dl={"to-boolean":Vt,"to-color":Xr,"to-number":Oe,"to-string":ft};class td{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const c=t[0],m=[];let g=He;if(c==="to-array"){if(!Array.isArray(t[1]))return null;const b=t[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);g=ya(i.expectedType.itemType,b)}else{if(!(b>0&&Rl(t[1][0])))return null;g=ya(ta(t[1][0]),b)}for(let C=0;C<b;C++){const k=t[1][C];let R;if(Du(k)==="array")R=i.parse(k,void 0,g.itemType);else{const z=Du(k);if(z!==g.itemType.kind)return i.error(`Expected ${g.itemType.kind} but found ${z}.`);R=i.registry.literal.parse(["literal",k===void 0?null:k],i)}if(!R)return null;m.push(R)}}else{if((c==="to-boolean"||c==="to-string")&&t.length!==2)return i.error("Expected one argument.");g=Dl[c];for(let b=1;b<t.length;b++){const C=i.parse(t[b],b,kn);if(!C)return null;m.push(C)}}return new td(g,m)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let i,c;for(const m of this.args){if(i=m.evaluate(t),c=null,i instanceof po)return i;if(typeof i=="string"){const g=t.parseColor(i);if(g)return g}else if(Array.isArray(i)&&(c=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ru(i[0],i[1],i[2],i[3]),!c))return new po(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new lo(c||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const c of this.args){if(i=c.evaluate(t),i===null)return 0;const m=Number(i);if(!isNaN(m))return m}throw new lo(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?ea.fromString(ms(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Dn.fromString(ms(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(i=>i.evaluate(t)):ms(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ed([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new iu(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Lc=td;const rd=["Unknown","Point","LineString","Polygon"];var jm=class{constructor(r,t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=t}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?rd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-r[0])+this.featureDistanceData.bearing[1]*(c*t-r[1])}return 0}parseColor(r){let t=this._parseColorCache[r];return t||(t=this._parseColorCache[r]=po.parse(r)),t}getConfig(r){return this.options?this.options.get(r):null}};class dc{constructor(t,i,c,m,g){this.name=t,this.type=i,this._evaluate=c,this.args=m,this._overloadIndex=g}evaluate(t){if(!this._evaluate){const i=dc.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const c=t[0],m=dc.definitions[c];if(!m)return i.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(m)?m[0]:m.type,b=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,C=[];let k=null,R=-1;for(const[z,V]of b){if(Array.isArray(z)&&z.length!==t.length-1)continue;C.push(z),R++,k=new pu(i.registry,i.path,null,i.scope,void 0,i._scope,i.options);const q=[];let Q=!1;for(let te=1;te<t.length;te++){const oe=t[te],pe=Array.isArray(z)?z[te-1]:z.type,_e=k.parse(oe,1+q.length,pe);if(!_e){Q=!0;break}q.push(_e)}if(!Q)if(Array.isArray(z)&&z.length!==q.length)k.error(`Expected ${z.length} arguments, but found ${q.length} instead.`);else{for(let te=0;te<q.length;te++){const oe=Array.isArray(z)?z[te]:z.type,pe=q[te];k.concat(te+1).checkSubtype(oe,pe.type)}if(k.errors.length===0)return new dc(c,g,V,q,R)}}if(C.length===1)i.errors.push(...k.errors);else{const z=(C.length?C:b.map(([q])=>q)).map(nd).join(" | "),V=[];for(let q=1;q<t.length;q++){const Q=i.parse(t[q],1+V.length);if(!Q)return null;V.push(va(Q.type))}i.error(`Expected arguments of type ${z}, but found (${V.join(", ")}) instead.`)}return null}static register(t,i){dc.definitions=i;for(const c in i)t[c]=dc}}function nd(r){return Array.isArray(r)?`(${r.map(va).join(", ")})`:`(${va(r.type)}...)`}var Ki=dc;class Ga{constructor(t,i,c){this.type=_a,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return i.error("Collator options argument must be an object.");const m=i.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Vt);if(!m)return null;const g=i.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Vt);if(!g)return null;let b=null;return c.locale&&(b=i.parse(c.locale,1,ft),!b)?null:new Ga(m,g,b)}evaluate(t){return new Fi(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var rp={exports:{}};rp.exports=function(){function r(c,m,g,b,C){for(;b>g;){if(b-g>600){var k=b-g+1,R=m-g+1,z=Math.log(k),V=.5*Math.exp(2*z/3),q=.5*Math.sqrt(z*V*(k-V)/k)*(R-k/2<0?-1:1);r(c,m,Math.max(g,Math.floor(m-R*V/k+q)),Math.min(b,Math.floor(m+(k-R)*V/k+q)),C)}var Q=c[m],te=g,oe=b;for(t(c,g,m),C(c[b],Q)>0&&t(c,g,b);te<oe;){for(t(c,te,oe),te++,oe--;C(c[te],Q)<0;)te++;for(;C(c[oe],Q)>0;)oe--}C(c[g],Q)===0?t(c,g,oe):t(c,++oe,b),oe<=m&&(g=oe+1),m<=oe&&(b=oe-1)}}function t(c,m,g){var b=c[m];c[m]=c[g],c[g]=b}function i(c,m){return c<m?-1:c>m?1:0}return function(c,m,g,b,C){r(c,m,g||0,b||c.length-1,C||i)}}();var Ou=ce(rp.exports);function Lu(r){let t=0;for(let i,c,m=0,g=r.length,b=g-1;m<g;b=m++)i=r[m],c=r[b],t+=(c.x-i.x)*(i.y+c.y);return t}function yl(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function vl(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function pc(r,t,i){const c=r[0]-t[0],m=r[1]-t[1],g=r[0]-i[0],b=r[1]-i[1];return c*b-g*m==0&&c*g<=0&&m*b<=0}function Xl(r,t,i=!1){let c=!1;for(let C=0,k=t.length;C<k;C++){const R=t[C];for(let z=0,V=R.length,q=V-1;z<V;q=z++){const Q=R[q],te=R[z];if(pc(r,Q,te))return i;(g=Q)[1]>(m=r)[1]!=(b=te)[1]>m[1]&&m[0]<(b[0]-g[0])*(m[1]-g[1])/(b[1]-g[1])+g[0]&&(c=!c)}}var m,g,b;return c}function ou(r,t,i,c){const m=c[0]-i[0],g=c[1]-i[1],b=(r[0]-i[0])*g-m*(r[1]-i[1]),C=(t[0]-i[0])*g-m*(t[1]-i[1]);return b>0&&C<0||b<0&&C>0}function Ws(r,t,i,c){return(m=[c[0]-i[0],c[1]-i[1]])[0]*(g=[t[0]-r[0],t[1]-r[1]])[1]-m[1]*g[0]!=0&&!(!ou(r,t,i,c)||!ou(i,c,r,t));var m,g}const au=8192;function id(r,t){const i=(180+r[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,m=Math.pow(2,t.z);return[Math.round(i*m*au),Math.round(c*m*au)]}function No(r,t){for(let i=0;i<t.length;i++)if(Xl(r,t[i]))return!0;return!1}function Nf(r,t,i){for(const c of i)for(let m=0,g=c.length,b=g-1;m<g;b=m++)if(Ws(r,t,c[b],c[m]))return!0;return!1}function sl(r,t){for(let i=0;i<r.length;++i)if(!Xl(r[i],t))return!1;for(let i=0;i<r.length-1;++i)if(Nf(r[i],r[i+1],t))return!1;return!0}function jf(r,t){for(let i=0;i<t.length;i++)if(sl(r,t[i]))return!0;return!1}function $p(r,t,i){const c=[];for(let m=0;m<r.length;m++){const g=[];for(let b=0;b<r[m].length;b++){const C=id(r[m][b],i);yl(t,C),g.push(C)}c.push(g)}return c}function Gp(r,t,i){const c=[];for(let m=0;m<r.length;m++){const g=$p(r[m],t,i);c.push(g)}return c}function qp(r,t,i,c){if(r[0]<i[0]||r[0]>i[2]){const m=.5*c;let g=r[0]-i[0]>m?-c:i[0]-r[0]>m?c:0;g===0&&(g=r[0]-i[2]>m?-c:i[2]-r[0]>m?c:0),r[0]+=g}yl(t,r)}function su(r,t,i,c){const m=Math.pow(2,c.z)*au,g=[c.x*au,c.y*au],b=[];if(!r)return b;for(const C of r)for(const k of C){const R=[k.x+g[0],k.y+g[1]];qp(R,t,i,m),b.push(R)}return b}function zc(r,t,i,c){const m=Math.pow(2,c.z)*au,g=[c.x*au,c.y*au],b=[];if(!r)return b;for(const k of r){const R=[];for(const z of k){const V=[z.x+g[0],z.y+g[1]];yl(t,V),R.push(V)}b.push(R)}if(t[2]-t[0]<=m/2){(C=t)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const k of b)for(const R of k)qp(R,t,i,m)}var C;return b}class Yl{constructor(t,i){this.type=Vt,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Rl(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let m=0;m<c.features.length;++m){const g=c.features[m].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Yl(c,c.features[m].geometry)}else if(c.type==="Feature"){const m=c.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Yl(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Yl(c,c)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,c){const m=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=i.canonicalID();if(!b)return!1;if(c.type==="Polygon"){const C=$p(c.coordinates,g,b),k=su(i.geometry(),m,g,b);if(!vl(m,g))return!1;for(const R of k)if(!Xl(R,C))return!1}if(c.type==="MultiPolygon"){const C=Gp(c.coordinates,g,b),k=su(i.geometry(),m,g,b);if(!vl(m,g))return!1;for(const R of k)if(!No(R,C))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,c){const m=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=i.canonicalID();if(!b)return!1;if(c.type==="Polygon"){const C=$p(c.coordinates,g,b),k=zc(i.geometry(),m,g,b);if(!vl(m,g))return!1;for(const R of k)if(!sl(R,C))return!1}if(c.type==="MultiPolygon"){const C=Gp(c.coordinates,g,b),k=zc(i.geometry(),m,g,b);if(!vl(m,g))return!1;for(const R of k)if(!jf(R,C))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var np=Yl,od={exports:{}};od.exports=function(){var r={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,i=t*(2-t),c=Math.PI/180,m=function(R,z){if(R===void 0)throw new Error("No latitude given.");if(z&&!r[z])throw new Error("Unknown unit "+z+". Use one of: "+Object.keys(r).join(", "));var V=6378.137*c*(z?r[z]:1),q=Math.cos(R*c),Q=1/(1-i*(1-q*q)),te=Math.sqrt(Q);this.kx=V*te*q,this.ky=V*te*Q*(1-i)},g={units:{configurable:!0}};function b(R,z){return R[0]===z[0]&&R[1]===z[1]}function C(R,z,V){var q=k(z[0]-R[0]);return[R[0]+q*V,R[1]+(z[1]-R[1])*V]}function k(R){for(;R<-180;)R+=360;for(;R>180;)R-=360;return R}return m.fromTile=function(R,z,V){var q=Math.PI*(1-2*(R+.5)/Math.pow(2,z)),Q=Math.atan(.5*(Math.exp(q)-Math.exp(-q)))/c;return new m(Q,V)},g.units.get=function(){return r},m.prototype.distance=function(R,z){var V=k(R[0]-z[0])*this.kx,q=(R[1]-z[1])*this.ky;return Math.sqrt(V*V+q*q)},m.prototype.bearing=function(R,z){var V=k(z[0]-R[0])*this.kx;return Math.atan2(V,(z[1]-R[1])*this.ky)/c},m.prototype.destination=function(R,z,V){var q=V*c;return this.offset(R,Math.sin(q)*z,Math.cos(q)*z)},m.prototype.offset=function(R,z,V){return[R[0]+z/this.kx,R[1]+V/this.ky]},m.prototype.lineDistance=function(R){for(var z=0,V=0;V<R.length-1;V++)z+=this.distance(R[V],R[V+1]);return z},m.prototype.area=function(R){for(var z=0,V=0;V<R.length;V++)for(var q=R[V],Q=0,te=q.length,oe=te-1;Q<te;oe=Q++)z+=k(q[Q][0]-q[oe][0])*(q[Q][1]+q[oe][1])*(V?-1:1);return Math.abs(z)/2*this.kx*this.ky},m.prototype.along=function(R,z){var V=0;if(z<=0)return R[0];for(var q=0;q<R.length-1;q++){var Q=R[q],te=R[q+1],oe=this.distance(Q,te);if((V+=oe)>z)return C(Q,te,(z-(V-oe))/oe)}return R[R.length-1]},m.prototype.pointToSegmentDistance=function(R,z,V){var q=z[0],Q=z[1],te=k(V[0]-q)*this.kx,oe=(V[1]-Q)*this.ky,pe=0;return te===0&&oe===0||((pe=(k(R[0]-q)*this.kx*te+(R[1]-Q)*this.ky*oe)/(te*te+oe*oe))>1?(q=V[0],Q=V[1]):pe>0&&(q+=te/this.kx*pe,Q+=oe/this.ky*pe)),te=k(R[0]-q)*this.kx,oe=(R[1]-Q)*this.ky,Math.sqrt(te*te+oe*oe)},m.prototype.pointOnLine=function(R,z){for(var V,q,Q,te,oe=1/0,pe=0;pe<R.length-1;pe++){var _e=R[pe][0],ze=R[pe][1],Ue=k(R[pe+1][0]-_e)*this.kx,Ve=(R[pe+1][1]-ze)*this.ky,nt=0;Ue===0&&Ve===0||((nt=(k(z[0]-_e)*this.kx*Ue+(z[1]-ze)*this.ky*Ve)/(Ue*Ue+Ve*Ve))>1?(_e=R[pe+1][0],ze=R[pe+1][1]):nt>0&&(_e+=Ue/this.kx*nt,ze+=Ve/this.ky*nt));var Qe=(Ue=k(z[0]-_e)*this.kx)*Ue+(Ve=(z[1]-ze)*this.ky)*Ve;Qe<oe&&(oe=Qe,V=_e,q=ze,Q=pe,te=nt)}return{point:[V,q],index:Q,t:Math.max(0,Math.min(1,te))}},m.prototype.lineSlice=function(R,z,V){var q=this.pointOnLine(V,R),Q=this.pointOnLine(V,z);if(q.index>Q.index||q.index===Q.index&&q.t>Q.t){var te=q;q=Q,Q=te}var oe=[q.point],pe=q.index+1,_e=Q.index;!b(V[pe],oe[0])&&pe<=_e&&oe.push(V[pe]);for(var ze=pe+1;ze<=_e;ze++)oe.push(V[ze]);return b(V[_e],Q.point)||oe.push(Q.point),oe},m.prototype.lineSliceAlong=function(R,z,V){for(var q=0,Q=[],te=0;te<V.length-1;te++){var oe=V[te],pe=V[te+1],_e=this.distance(oe,pe);if((q+=_e)>R&&Q.length===0&&Q.push(C(oe,pe,(R-(q-_e))/_e)),q>=z)return Q.push(C(oe,pe,(z-(q-_e))/_e)),Q;q>R&&Q.push(pe)}return Q},m.prototype.bufferPoint=function(R,z){var V=z/this.ky,q=z/this.kx;return[R[0]-q,R[1]-V,R[0]+q,R[1]+V]},m.prototype.bufferBBox=function(R,z){var V=z/this.ky,q=z/this.kx;return[R[0]-q,R[1]-V,R[2]+q,R[3]+V]},m.prototype.insideBBox=function(R,z){return k(R[0]-z[0])>=0&&k(R[0]-z[2])<=0&&R[1]>=z[1]&&R[1]<=z[3]},Object.defineProperties(m,g),m}();var Nc=ce(od.exports),lu={exports:{}};lu.exports=function(){var r=function(i,c){if(i===void 0&&(i=[]),c===void 0&&(c=t),this.data=i,this.length=this.data.length,this.compare=c,this.length>0)for(var m=(this.length>>1)-1;m>=0;m--)this._down(m)};function t(i,c){return i<c?-1:i>c?1:0}return r.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var i=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),i}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(i){for(var c=this.data,m=this.compare,g=c[i];i>0;){var b=i-1>>1,C=c[b];if(m(g,C)>=0)break;c[i]=C,i=b}c[i]=g},r.prototype._down=function(i){for(var c=this.data,m=this.compare,g=this.length>>1,b=c[i];i<g;){var C=1+(i<<1),k=c[C],R=C+1;if(R<this.length&&m(c[R],k)<0&&(C=R,k=c[R]),m(k,b)>=0)break;c[i]=k,i=C}c[i]=b},r}();var Ol=ce(lu.exports),Jr=8192;function jc(r,t){return t.dist-r.dist}const Wp=100,cu=50;function Go(r){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==r[i])return!1;return!0}function fc(r){return r[1]-r[0]+1}function mc(r,t){const i=r[1]>=r[0]&&r[1]<t;return i||console.warn("Distance Expression: Index is out of range"),i}function zu(r,t){if(r[0]>r[1])return[null,null];const i=fc(r);if(t){if(i===2)return[r,null];const c=Math.floor(i/2);return[[r[0],r[0]+c],[r[0]+c,r[1]]]}{if(i===1)return[r,null];const c=Math.floor(i/2)-1;return[[r[0],r[0]+c],[r[0]+c+1,r[1]]]}}function Nu(r,t){const i=[1/0,1/0,-1/0,-1/0];if(!mc(t,r.length))return i;for(let c=t[0];c<=t[1];++c)yl(i,r[c]);return i}function Hp(r){const t=[1/0,1/0,-1/0,-1/0];for(let i=0;i<r.length;++i)for(let c=0;c<r[i].length;++c)yl(t,r[i][c]);return t}function ju(r,t,i){if(Go(r)||Go(t))return NaN;let c=0,m=0;return r[2]<t[0]&&(c=t[0]-r[2]),r[0]>t[2]&&(c=r[0]-t[2]),r[1]>t[3]&&(m=r[1]-t[3]),r[3]<t[1]&&(m=t[1]-r[3]),i.distance([0,0],[c,m])}function ad(r){return 360*r-180}function sd(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Bc(r,t){const i=Math.pow(2,t.z),c=(r.y/Jr+t.y)/i;return[ad((r.x/Jr+t.x)/i),sd(c)]}function Zp(r,t){const i=[];for(let c=0;c<r.length;++c)i.push(Bc(r[c],t));return i}function ld(r,t,i){const c=i.pointOnLine(t,r).point;return i.distance(r,c)}function xh(r,t,i,c,m){const g=i.slice(c[0],c[1]+1);let b=1/0;for(let C=t[0];C<=t[1];++C)if((b=Math.min(b,ld(r[C],g,m)))===0)return 0;return b}function Xp(r,t,i,c,m){const g=Math.min(m.pointToSegmentDistance(r,i,c),m.pointToSegmentDistance(t,i,c)),b=Math.min(m.pointToSegmentDistance(i,r,t),m.pointToSegmentDistance(c,r,t));return Math.min(g,b)}function cd(r,t,i,c,m){if(!mc(t,r.length)||!mc(c,i.length))return NaN;let g=1/0;for(let b=t[0];b<t[1];++b)for(let C=c[0];C<c[1];++C){if(Ws(r[b],r[b+1],i[C],i[C+1]))return 0;g=Math.min(g,Xp(r[b],r[b+1],i[C],i[C+1],m))}return g}function gc(r,t,i,c,m){if(!mc(t,r.length)||!mc(c,i.length))return NaN;let g=1/0;for(let b=t[0];b<=t[1];++b)for(let C=c[0];C<=c[1];++C)if((g=Math.min(g,m.distance(r[b],i[C])))===0)return g;return g}function Bm(r,t,i){if(Xl(r,t,!0))return 0;let c=1/0;for(const m of t){const g=m.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[g-1]&&(c=Math.min(c,i.pointToSegmentDistance(r,m[g-1],m[0])))===0||(c=Math.min(c,ld(r,m,i)))===0)return c}return c}function Bf(r,t,i,c){if(!mc(t,r.length))return NaN;for(let g=t[0];g<=t[1];++g)if(Xl(r[g],i,!0))return 0;let m=1/0;for(let g=t[0];g<t[1];++g)for(const b of i)for(let C=0,k=b.length,R=k-1;C<k;R=C++){if(Ws(r[g],r[g+1],b[R],b[C]))return 0;m=Math.min(m,Xp(r[g],r[g+1],b[R],b[C],c))}return m}function ud(r,t){for(const i of r)for(let c=0;c<=i.length-1;++c)if(Xl(i[c],t,!0))return!0;return!1}function bh(r,t,i,c=1/0){const m=Hp(r),g=Hp(t);if(c!==1/0&&ju(m,g,i)>=c)return c;if(vl(m,g)){if(ud(r,t))return 0}else if(ud(t,r))return 0;let b=c;for(const C of r)for(let k=0,R=C.length,z=R-1;k<R;z=k++)for(const V of t)for(let q=0,Q=V.length,te=Q-1;q<Q;te=q++){if(Ws(C[z],C[k],V[te],V[q]))return 0;b=Math.min(b,Xp(C[z],C[k],V[te],V[q],i))}return b}function Bu(r,t,i,c,m,g,b){if(g===null||b===null)return;const C=ju(Nu(c,g),Nu(m,b),i);C<t&&r.push({dist:C,range1:g,range2:b})}function hd(r,t,i,c,m=1/0){let g=Math.min(c.distance(r[0],i[0][0]),m);if(g===0)return g;const b=new Ol([{dist:0,range1:[0,r.length-1],range2:[0,0]}],jc),C=t?cu:Wp,k=Hp(i);for(;b.length;){const R=b.pop();if(R.dist>=g)continue;const z=R.range1;if(fc(z)<=C){if(!mc(z,r.length))return NaN;if(t){const V=Bf(r,z,i,c);if((g=Math.min(g,V))===0)return g}else for(let V=z[0];V<=z[1];++V){const q=Bm(r[V],i,c);if((g=Math.min(g,q))===0)return g}}else{const V=zu(z,t);if(V[0]!==null){const q=ju(Nu(r,V[0]),k,c);q<g&&b.push({dist:q,range1:V[0],range2:[0,0]})}if(V[1]!==null){const q=ju(Nu(r,V[1]),k,c);q<g&&b.push({dist:q,range1:V[1],range2:[0,0]})}}}return g}function Yp(r,t,i,c,m,g=1/0){let b=Math.min(g,m.distance(r[0],i[0]));if(b===0)return b;const C=new Ol([{dist:0,range1:[0,r.length-1],range2:[0,i.length-1]}],jc),k=t?cu:Wp,R=c?cu:Wp;for(;C.length;){const z=C.pop();if(z.dist>=b)continue;const V=z.range1,q=z.range2;if(fc(V)<=k&&fc(q)<=R){if(!mc(V,r.length)||!mc(q,i.length))return NaN;if(t&&c?b=Math.min(b,cd(r,V,i,q,m)):t||c?t&&!c?b=Math.min(b,xh(i,q,r,V,m)):!t&&c&&(b=Math.min(b,xh(r,V,i,q,m))):b=Math.min(b,gc(r,V,i,q,m)),b===0)return b}else{const Q=zu(V,t),te=zu(q,c);Bu(C,b,m,r,i,Q[0],te[0]),Bu(C,b,m,r,i,Q[0],te[1]),Bu(C,b,m,r,i,Q[1],te[0]),Bu(C,b,m,r,i,Q[1],te[1])}}return b}function dd(r,t,i,c,m=1/0){let g=m;const b=Nu(r,[0,r.length-1]);for(const C of i)if(!(g!==1/0&&ju(b,Nu(C,[0,C.length-1]),c)>=g)&&(g=Math.min(g,Yp(r,t,C,!0,c,g)),g===0))return g;return g}function Kp(r,t,i,c,m=1/0){let g=m;const b=Nu(r,[0,r.length-1]);for(const C of i){if(g!==1/0&&ju(b,Hp(C),c)>=g)continue;const k=hd(r,t,C,c,g);if(isNaN(k))return k;if((g=Math.min(g,k))===0)return g}return g}function pd(r){return r==="Point"||r==="MultiPoint"||r==="LineString"||r==="MultiLineString"||r==="Polygon"||r==="MultiPolygon"}class uu{constructor(t,i){this.type=Oe,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Rl(t[1])){const c=t[1];if(c.type==="FeatureCollection"){for(let m=0;m<c.features.length;++m)if(pd(c.features[m].geometry.type))return new uu(c,c.features[m].geometry)}else if(c.type==="Feature"){if(pd(c.geometry.type))return new uu(c,c.geometry)}else if(pd(c.type))return new uu(c,c)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const i=t.geometry(),c=t.canonicalID();if(i!=null&&c!=null){if(t.geometryType()==="Point")return function(m,g,b){const C=[];for(const R of m)for(const z of R)C.push(Bc(z,g));const k=new Nc(C[0][1],"meters");return b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString"?Yp(C,!1,b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",k):b.type==="MultiLineString"?dd(C,!1,b.coordinates,k):b.type==="Polygon"||b.type==="MultiPolygon"?Kp(C,!1,b.type==="Polygon"?[b.coordinates]:b.coordinates,k):null}(i,c,this.geometries);if(t.geometryType()==="LineString")return function(m,g,b){const C=[];for(const R of m){const z=[];for(const V of R)z.push(Bc(V,g));C.push(z)}const k=new Nc(C[0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return dd(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",C,k);if(b.type==="MultiLineString"){let R=1/0;for(let z=0;z<b.coordinates.length;z++){const V=dd(b.coordinates[z],!0,C,k,R);if(isNaN(V))return V;if((R=Math.min(R,V))===0)return R}return R}if(b.type==="Polygon"||b.type==="MultiPolygon"){let R=1/0;for(let z=0;z<C.length;z++){const V=Kp(C[z],!0,b.type==="Polygon"?[b.coordinates]:b.coordinates,k,R);if(isNaN(V))return V;if((R=Math.min(R,V))===0)return R}return R}return null}(i,c,this.geometries);if(t.geometryType()==="Polygon")return function(m,g,b){const C=[];for(const R of function(z,V){const q=z.length;if(q<=1)return[z];const Q=[];let te,oe;for(let pe=0;pe<q;pe++){const _e=Lu(z[pe]);_e!==0&&(z[pe].area=Math.abs(_e),oe===void 0&&(oe=_e<0),oe===_e<0?(te&&Q.push(te),te=[z[pe]]):te.push(z[pe]))}return te&&Q.push(te),Q}(m)){const z=[];for(let V=0;V<R.length;++V)z.push(Zp(R[V],g));C.push(z)}const k=new Nc(C[0][0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return Kp(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",C,k);if(b.type==="MultiLineString"){let R=1/0;for(let z=0;z<b.coordinates.length;z++){const V=Kp(b.coordinates[z],!0,C,k,R);if(isNaN(V))return V;if((R=Math.min(R,V))===0)return R}return R}return b.type==="Polygon"||b.type==="MultiPolygon"?function(R,z,V){let q=1/0;for(const Q of R)for(const te of z){const oe=bh(Q,te,V,q);if(isNaN(oe))return oe;if((q=Math.min(q,oe))===0)return q}return q}(b.type==="Polygon"?[b.coordinates]:b.coordinates,C,k):null}(i,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var ip=uu;function fd(r,t){switch(r){case"string":return ms(t);case"number":return+t;case"boolean":return!!t;case"color":return po.parse(t);case"formatted":return ea.fromString(ms(t));case"resolvedImage":return Dn.fromString(ms(t))}return t}function md(r,t,i,c){return c!==void 0&&(r=c*Math.round(r/c)),t!==void 0&&r<t&&(r=t),i!==void 0&&r>i&&(r=i),r}class wh{constructor(t,i,c){this.type=t,this.key=i,this.scope=c}static parse(t,i){let c=i.expectedType;if(c==null&&(c=kn),t.length<2||t.length>3)return i.error("Invalid number of arguments for 'config' expression.");const m=i.parse(t[1],1);if(!(m instanceof $a))return i.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const g=i.parse(t[2],2);return g instanceof $a?new wh(c,ms(m.value),ms(g.value)):i.error("Scope of 'config' expression must be a string literal.")}return new wh(c,ms(m.value))}evaluate(t){const i=[this.key,this.scope,t.scope].filter(Boolean).join(""),c=t.getConfig(i);if(!c)return null;const{type:m,value:g,values:b,minValue:C,maxValue:k,stepValue:R}=c,z=c.default.evaluate(t);let V=z;if(g){const q=t.scope;t.scope=(q||"").split("").slice(1).join(""),V=g.evaluate(t),t.scope=q}return m&&(V=fd(m,V)),V===void 0||C===void 0&&k===void 0&&R===void 0||(typeof V=="number"?V=md(V,C,k,R):Array.isArray(V)&&(V=V.map(q=>typeof q=="number"?md(q,C,k,R):q))),g!==void 0&&V!==void 0&&b&&!b.includes(V)&&(V=z,m&&(V=fd(m,V))),(m&&m!==this.type||V!==void 0&&ta(V)!==this.type)&&(V=fd(this.type.kind,V)),V}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}var Fu=wh;function Vu(r){if(r instanceof Ki&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof np||r instanceof ip)return!1;let t=!0;return r.eachChild(i=>{t&&!Vu(i)&&(t=!1)}),t}function hu(r){if(r instanceof Ki&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(i=>{t&&!hu(i)&&(t=!1)}),t}function gd(r){if(r instanceof Fu)return!1;let t=!0;return r.eachChild(i=>{t&&!gd(i)&&(t=!1)}),t}function Aa(r,t){if(r instanceof Ki&&t.indexOf(r.name)>=0)return!1;let i=!0;return r.eachChild(c=>{i&&!Aa(c,t)&&(i=!1)}),i}class Oo{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const c=t[1];return i.scope.has(c)?new Oo(c,i.scope.get(c)):i.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Is=Oo;class du{constructor(t,i=[],c,m=new zf,g=[],b,C){this.registry=t,this.path=i,this.key=i.map(k=>`[${k}]`).join(""),this.scope=m,this.errors=g,this.expectedType=c,this._scope=b,this.options=C}parse(t,i,c,m,g={}){return i||c?this.concat(i,c,m)._parse(t,g):this._parse(t,g)}_parse(t,i){function c(m,g,b){return b==="assert"?new nu(g,[m]):b==="coerce"?new Lc(g,[m]):m}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(m){let g=m.parse(t,this);if(!g)return null;if(this.expectedType){const b=this.expectedType,C=g.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||C.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(b,C))return null}else g=c(g,b,i.typeAnnotation||"coerce");else g=c(g,b,i.typeAnnotation||"assert")}if(!(g instanceof $a)&&g.type.kind!=="resolvedImage"&&co(g)){const b=new jm(this._scope,this.options);try{g=new $a(g.type,g.evaluate(b))}catch(C){return this.error(C.message),null}}return g}return Lc.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,c){const m=typeof t=="number"?this.path.concat(t):this.path,g=c?this.scope.concat(c):this.scope;return new du(this.registry,m,i||null,g,this.errors,this._scope,this.options)}error(t,...i){const c=`${this.key}${i.map(m=>`[${m}]`).join("")}`;this.errors.push(new _l(c,t))}checkSubtype(t,i){const c=Hl(t,i);return c&&this.error(c),c}}var pu=du;function co(r){if(r instanceof Is)return co(r.boundExpression);if(r instanceof Ki&&r.name==="error"||r instanceof Ga||r instanceof np||r instanceof ip||r instanceof Fu)return!1;const t=r instanceof Lc||r instanceof nu;let i=!0;return r.eachChild(c=>{i=t?i&&co(c):i&&c instanceof $a}),!!i&&Vu(r)&&Aa(r,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function ko(r,t){const i=r.length-1;let c,m,g=0,b=i,C=0;for(;g<=b;)if(C=Math.floor((g+b)/2),c=r[C],m=r[C+1],c<=t){if(C===i||t<m)return C;g=C+1}else{if(!(c>t))throw new lo("Input is not a number.");b=C-1}return 0}class Hs{constructor(t,i,c){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[m,g]of c)this.labels.push(m),this.outputs.push(g)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const c=i.parse(t[1],1,Oe);if(!c)return null;const m=[];let g=null;i.expectedType&&i.expectedType.kind!=="value"&&(g=i.expectedType);for(let b=1;b<t.length;b+=2){const C=b===1?-1/0:t[b],k=t[b+1],R=b,z=b+1;if(typeof C!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(m.length&&m[m.length-1][0]>=C)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const V=i.parse(k,z,g);if(!V)return null;g=g||V.type,m.push([C,V])}return new Hs(g,c,m)}evaluate(t){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(t);const m=this.input.evaluate(t);if(m<=i[0])return c[0].evaluate(t);const g=i.length;return m>=i[g-1]?c[g-1].evaluate(t):c[ko(i,m)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var fu=Hs;const Sh=.95047,Kl=1.08883,Fm=4/29,_d=6/29,Th=3*_d*_d,yd=_d*_d*_d,mu=Math.PI/180,qo=180/Math.PI;function Uu(r){return r>yd?Math.pow(r,1/3):r/Th+Fm}function op(r){return r>_d?r*r*r:Th*(r-Fm)}function xa(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Rn(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Zs(r){const t=Rn(r.r),i=Rn(r.g),c=Rn(r.b),m=Uu((.4124564*t+.3575761*i+.1804375*c)/Sh),g=Uu((.2126729*t+.7151522*i+.072175*c)/1);return{l:116*g-16,a:500*(m-g),b:200*(g-Uu((.0193339*t+.119192*i+.9503041*c)/Kl)),alpha:r.a}}function vd(r){let t=(r.l+16)/116,i=isNaN(r.a)?t:t+r.a/500,c=isNaN(r.b)?t:t-r.b/200;return t=1*op(t),i=Sh*op(i),c=Kl*op(c),new po(xa(3.2404542*i-1.5371385*t-.4985314*c),xa(-.969266*i+1.8760108*t+.041556*c),xa(.0556434*i-.2040259*t+1.0572252*c),r.alpha)}function Eh(r,t,i){const c=t-r;return r+i*(c>180||c<-180?c-360*Math.round(c/360):c)}const Xs={forward:Zs,reverse:vd,interpolate:function(r,t,i){return{l:Hn(r.l,t.l,i),a:Hn(r.a,t.a,i),b:Hn(r.b,t.b,i),alpha:Hn(r.alpha,t.alpha,i)}}},gs={forward:function(r){const{l:t,a:i,b:c}=Zs(r),m=Math.atan2(c,i)*qo;return{h:m<0?m+360:m,c:Math.sqrt(i*i+c*c),l:t,alpha:r.a}},reverse:function(r){const t=r.h*mu,i=r.c;return vd({l:r.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:r.alpha})},interpolate:function(r,t,i){return{h:Eh(r.h,t.h,i),c:Hn(r.c,t.c,i),l:Hn(r.l,t.l,i),alpha:Hn(r.alpha,t.alpha,i)}}};var ap=Object.freeze({__proto__:null,hcl:gs,lab:Xs});class un{constructor(t,i,c,m,g){this.type=t,this.operator=i,this.interpolation=c,this.input=m,this.labels=[],this.outputs=[];for(const[b,C]of g)this.labels.push(b),this.outputs.push(C)}static interpolationFactor(t,i,c,m){let g=0;if(t.name==="exponential")g=$u(i,t.base,c,m);else if(t.name==="linear")g=$u(i,1,c,m);else if(t.name==="cubic-bezier"){const b=t.controlPoints;g=new Ne(b[0],b[1],b[2],b[3]).solve($u(i,1,c,m))}return g}static parse(t,i){let[c,m,g,...b]=t;if(!Array.isArray(m)||m.length===0)return i.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const R=m[1];if(typeof R!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:R}}else{if(m[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const R=m.slice(1);if(R.length!==4||R.some(z=>typeof z!="number"||z<0||z>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:R}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(g=i.parse(g,2,Oe),!g)return null;const C=[];let k=null;c==="interpolate-hcl"||c==="interpolate-lab"?k=Xr:i.expectedType&&i.expectedType.kind!=="value"&&(k=i.expectedType);for(let R=0;R<b.length;R+=2){const z=b[R],V=b[R+1],q=R+3,Q=R+4;if(typeof z!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(C.length&&C[C.length-1][0]>=z)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const te=i.parse(V,Q,k);if(!te)return null;k=k||te.type,C.push([z,te])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new un(k,c,m,g,C):i.error(`Type ${va(k)} is not interpolatable.`)}evaluate(t){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(t);const m=this.input.evaluate(t);if(m<=i[0])return c[0].evaluate(t);const g=i.length;if(m>=i[g-1])return c[g-1].evaluate(t);const b=ko(i,m),C=un.interpolationFactor(this.interpolation,m,i[b],i[b+1]),k=c[b].evaluate(t),R=c[b+1].evaluate(t);return this.operator==="interpolate"?Uo[this.type.kind.toLowerCase()](k,R,C):this.operator==="interpolate-hcl"?gs.reverse(gs.interpolate(gs.forward(k),gs.forward(R),C)):Xs.reverse(Xs.interpolate(Xs.forward(k),Xs.forward(R),C))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)i.push(this.labels[c],this.outputs[c].serialize());return i}}function $u(r,t,i,c){const m=c-i,g=r-i;return m===0?0:t===1?g/m:(Math.pow(t,g)-1)/(Math.pow(t,m)-1)}var Ys=un;class Gu{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let c=null;const m=i.expectedType;m&&m.kind!=="value"&&(c=m);const g=[];for(const C of t.slice(1)){const k=i.parse(C,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!k)return null;c=c||k.type,g.push(k)}const b=m&&g.some(C=>Hl(m,C.type));return new Gu(b?kn:c,g)}evaluate(t){let i,c=null,m=0;for(const g of this.args){if(m++,c=g.evaluate(t),c&&c instanceof Dn&&!c.available&&(i||(i=c),c=null,m===this.args.length))return i;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var xl=Gu;class Ls{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let g=1;g<t.length-1;g+=2){const b=t[g];if(typeof b!="string")return i.error(`Expected string, but found ${typeof b} instead.`,g);if(/[^a-zA-Z0-9_]/.test(b))return i.error("Variable names must contain only alphanumeric characters or '_'.",g);const C=i.parse(t[g+1],g+1);if(!C)return null;c.push([b,C])}const m=i.parse(t[t.length-1],t.length-1,i.expectedType,c);return m?new Ls(c,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,c]of this.bindings)t.push(i,c.serialize());return t.push(this.result.serialize()),t}}var xd=Ls;class _c{constructor(t,i,c){this.type=t,this.index=i,this.input=c}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,Oe),m=i.parse(t[2],2,ya(i.expectedType||kn));return c&&m?new _c(m.type.itemType,c,m):null}evaluate(t){const i=this.index.evaluate(t),c=this.input.evaluate(t);if(i<0)throw new lo(`Array index out of bounds: ${i} < 0.`);if(i>=c.length)throw new lo(`Array index out of bounds: ${i} > ${c.length-1}.`);if(i!==Math.floor(i))throw new lo(`Array index must be an integer, but found ${i} instead.`);return c[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Si=_c;class yc{constructor(t,i){this.type=Vt,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,kn),m=i.parse(t[2],2,kn);return c&&m?ui(c.type,[Vt,ft,Oe,He,kn])?new yc(c,m):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${va(c.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!Zl(i,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${va(ta(i))} instead.`);if(!Zl(c,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${va(ta(c))} instead.`);return c.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Vm=yc;class qu{constructor(t,i,c){this.type=Oe,this.needle=t,this.haystack=i,this.fromIndex=c}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,kn),m=i.parse(t[2],2,kn);if(!c||!m)return null;if(!ui(c.type,[Vt,ft,Oe,He,kn]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${va(c.type)} instead`);if(t.length===4){const g=i.parse(t[3],3,Oe);return g?new qu(c,m,g):null}return new qu(c,m)}evaluate(t){const i=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!Zl(i,["boolean","string","number","null"]))throw new lo(`Expected first argument to be of type boolean, string, number or null, but found ${va(ta(i))} instead.`);if(!Zl(c,["string","array"]))throw new lo(`Expected second argument to be of type array or string, but found ${va(ta(c))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(t);return c.indexOf(i,m)}return c.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Jp=qu;class sp{constructor(t,i,c,m,g,b){this.inputType=t,this.type=i,this.input=c,this.cases=m,this.outputs=g,this.otherwise=b}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let c,m;i.expectedType&&i.expectedType.kind!=="value"&&(m=i.expectedType);const g={},b=[];for(let R=2;R<t.length-1;R+=2){let z=t[R];const V=t[R+1];Array.isArray(z)||(z=[z]);const q=i.concat(R);if(z.length===0)return q.error("Expected at least one branch label.");for(const te of z){if(typeof te!="number"&&typeof te!="string")return q.error("Branch labels must be numbers or strings.");if(typeof te=="number"&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof te=="number"&&Math.floor(te)!==te)return q.error("Numeric branch labels must be integer values.");if(c){if(q.checkSubtype(c,ta(te)))return null}else c=ta(te);if(g[String(te)]!==void 0)return q.error("Branch labels must be unique.");g[String(te)]=b.length}const Q=i.parse(V,R,m);if(!Q)return null;m=m||Q.type,b.push(Q)}const C=i.parse(t[1],1,kn);if(!C)return null;const k=i.parse(t[t.length-1],t.length-1,m);return k?C.type.kind!=="value"&&i.concat(1).checkSubtype(c,C.type)?null:new sp(c,m,C,g,b,k):null}evaluate(t){const i=this.input.evaluate(t);return(ta(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),c=[],m={};for(const b of i){const C=m[this.cases[b]];C===void 0?(m[this.cases[b]]=c.length,c.push([this.cases[b],[b]])):c[C][1].push(b)}const g=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,C]of c)t.push(C.length===1?g(C[0]):C.map(g)),t.push(this.outputs[b].serialize());return t.push(this.otherwise.serialize()),t}}var Jl=sp;class Ks{constructor(t,i,c){this.type=t,this.branches=i,this.otherwise=c}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const m=[];for(let b=1;b<t.length-1;b+=2){const C=i.parse(t[b],b,Vt);if(!C)return null;const k=i.parse(t[b+1],b+1,c);if(!k)return null;m.push([C,k]),c=c||k.type}const g=i.parse(t[t.length-1],t.length-1,c);return g?new Ks(c,m,g):null}evaluate(t){for(const[i,c]of this.branches)if(i.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,c]of this.branches)t(i),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var oo=Ks;class bl{constructor(t,i,c,m){this.type=t,this.input=i,this.beginIndex=c,this.endIndex=m}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=i.parse(t[1],1,kn),m=i.parse(t[2],2,Oe);if(!c||!m)return null;if(!ui(c.type,[ya(kn),ft,kn]))return i.error(`Expected first argument to be of type array or string, but found ${va(c.type)} instead`);if(t.length===4){const g=i.parse(t[3],3,Oe);return g?new bl(c.type,c,m,g):null}return new bl(c.type,c,m)}evaluate(t){const i=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!Zl(i,["string","array"]))throw new lo(`Expected first argument to be of type array or string, but found ${va(ta(i))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(t);return i.slice(c,m)}return i.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var zs=bl;function ns(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function gu(r,t,i,c){return c.compare(t,i)===0}function Ll(r,t,i){const c=r!=="=="&&r!=="!=";return class uB{constructor(g,b,C){this.type=Vt,this.lhs=g,this.rhs=b,this.collator=C,this.hasUntypedArgument=g.type.kind==="value"||b.type.kind==="value"}static parse(g,b){if(g.length!==3&&g.length!==4)return b.error("Expected two or three arguments.");const C=g[0];let k=b.parse(g[1],1,kn);if(!k)return null;if(!ns(C,k.type))return b.concat(1).error(`"${C}" comparisons are not supported for type '${va(k.type)}'.`);let R=b.parse(g[2],2,kn);if(!R)return null;if(!ns(C,R.type))return b.concat(2).error(`"${C}" comparisons are not supported for type '${va(R.type)}'.`);if(k.type.kind!==R.type.kind&&k.type.kind!=="value"&&R.type.kind!=="value")return b.error(`Cannot compare types '${va(k.type)}' and '${va(R.type)}'.`);c&&(k.type.kind==="value"&&R.type.kind!=="value"?k=new nu(R.type,[k]):k.type.kind!=="value"&&R.type.kind==="value"&&(R=new nu(k.type,[R])));let z=null;if(g.length===4){if(k.type.kind!=="string"&&R.type.kind!=="string"&&k.type.kind!=="value"&&R.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(z=b.parse(g[3],3,_a),!z)return null}return new uB(k,R,z)}evaluate(g){const b=this.lhs.evaluate(g),C=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){const k=ta(b),R=ta(C);if(k.kind!==R.kind||k.kind!=="string"&&k.kind!=="number")throw new lo(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${k.kind}, ${R.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const k=ta(b),R=ta(C);if(k.kind!=="string"||R.kind!=="string")return t(g,b,C)}return this.collator?i(g,b,C,this.collator.evaluate(g)):t(g,b,C)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[r];return this.eachChild(b=>{g.push(b.serialize())}),g}}}const zl=Ll("==",function(r,t,i){return t===i},gu),Cs=Ll("!=",function(r,t,i){return t!==i},function(r,t,i,c){return!gu(0,t,i,c)}),lp=Ll("<",function(r,t,i){return t<i},function(r,t,i,c){return c.compare(t,i)<0}),Kn=Ll(">",function(r,t,i){return t>i},function(r,t,i,c){return c.compare(t,i)>0}),Bn=Ll("<=",function(r,t,i){return t<=i},function(r,t,i,c){return c.compare(t,i)<=0}),Qp=Ll(">=",function(r,t,i){return t>=i},function(r,t,i,c){return c.compare(t,i)>=0});class As{constructor(t,i,c,m,g,b){this.type=ft,this.number=t,this.locale=i,this.currency=c,this.unit=m,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const c=i.parse(t[1],1,Oe);if(!c)return null;const m=t[2];if(typeof m!="object"||Array.isArray(m))return i.error("NumberFormat options argument must be an object.");let g=null;if(m.locale&&(g=i.parse(m.locale,1,ft),!g))return null;let b=null;if(m.currency&&(b=i.parse(m.currency,1,ft),!b))return null;let C=null;if(m.unit&&(C=i.parse(m.unit,1,ft),!C))return null;let k=null;if(m["min-fraction-digits"]&&(k=i.parse(m["min-fraction-digits"],1,Oe),!k))return null;let R=null;return m["max-fraction-digits"]&&(R=i.parse(m["max-fraction-digits"],1,Oe),!R)?null:new As(c,g,b,C,k,R)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Nl{constructor(t){this.type=Oe,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=i.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${va(c.type)} instead.`):new Nl(c):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new lo(`Expected value to be of type string or array, but found ${va(ta(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}function _s(r){return function(){r=1831565813+(r|=0)|0;let t=Math.imul(r^r>>>15,1|r);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Ql={"==":zl,"!=":Cs,">":Kn,"<":lp,">=":Qp,"<=":Bn,array:nu,at:Si,boolean:nu,case:oo,coalesce:xl,collator:Ga,format:ed,image:iu,in:Vm,"index-of":Jp,interpolate:Ys,"interpolate-hcl":Ys,"interpolate-lab":Ys,length:Nl,let:xd,literal:$a,match:Jl,number:nu,"number-format":As,object:nu,slice:zs,step:fu,string:nu,"to-boolean":Lc,"to-color":Lc,"to-number":Lc,"to-string":Lc,var:Is,within:np,distance:ip,config:Fu};function cp(r,[t,i,c,m]){t=t.evaluate(r),i=i.evaluate(r),c=c.evaluate(r);const g=m?m.evaluate(r):1,b=ru(t,i,c,g);if(b)throw new lo(b);return new po(t/255*g,i/255*g,c/255*g,g)}function up(r,[t,i,c,m]){t=t.evaluate(r),i=i.evaluate(r),c=c.evaluate(r);const g=m?m.evaluate(r):1,b=function(R,z,V,q){return typeof R=="number"&&R>=0&&R<=360?typeof z=="number"&&z>=0&&z<=100&&typeof V=="number"&&V>=0&&V<=100?q===void 0||typeof q=="number"&&q>=0&&q<=1?null:`Invalid hsla value [${[R,z,V,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof q=="number"?[R,z,V,q]:[R,z,V]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof q=="number"?[R,z,V,q]:[R,z,V]).join(", ")}]: 'h' must be between 0 and 360.`}(t,i,c,g);if(b)throw new lo(b);const C=`hsla(${t}, ${i}%, ${c}%, ${g})`,k=po.parse(C);if(!k)throw new lo(`Failed to parse HSLA color: ${C}`);return k}function Mo(r,t){return r in t}function Ya(r,t){const i=t[r];return i===void 0?null:i}function Wu(r){return{type:r}}Ki.register(Ql,{error:[{kind:"error"},[ft],(r,[t])=>{throw new lo(t.evaluate(r))}],typeof:[ft,[kn],(r,[t])=>va(ta(t.evaluate(r)))],"to-rgba":[ya(Oe,4),[Xr],(r,[t])=>t.evaluate(r).toArray()],rgb:[Xr,[Oe,Oe,Oe],cp],rgba:[Xr,[Oe,Oe,Oe,Oe],cp],hsl:[Xr,[Oe,Oe,Oe],up],hsla:[Xr,[Oe,Oe,Oe,Oe],up],has:{type:Vt,overloads:[[[ft],(r,[t])=>Mo(t.evaluate(r),r.properties())],[[ft,Gn],(r,[t,i])=>Mo(t.evaluate(r),i.evaluate(r))]]},get:{type:kn,overloads:[[[ft],(r,[t])=>Ya(t.evaluate(r),r.properties())],[[ft,Gn],(r,[t,i])=>Ya(t.evaluate(r),i.evaluate(r))]]},"feature-state":[kn,[ft],(r,[t])=>Ya(t.evaluate(r),r.featureState||{})],properties:[Gn,[],r=>r.properties()],"geometry-type":[ft,[],r=>r.geometryType()],id:[kn,[],r=>r.id()],zoom:[Oe,[],r=>r.globals.zoom],pitch:[Oe,[],r=>r.globals.pitch||0],"distance-from-center":[Oe,[],r=>r.distanceFromCenter()],"measure-light":[Oe,[ft],(r,[t])=>r.measureLight(t.evaluate(r))],"heatmap-density":[Oe,[],r=>r.globals.heatmapDensity||0],"line-progress":[Oe,[],r=>r.globals.lineProgress||0],"raster-value":[Oe,[],r=>r.globals.rasterValue||0],"raster-particle-speed":[Oe,[],r=>r.globals.rasterParticleSpeed||0],"sky-radial-progress":[Oe,[],r=>r.globals.skyRadialProgress||0],accumulated:[kn,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Oe,Wu(Oe),(r,t)=>{let i=0;for(const c of t)i+=c.evaluate(r);return i}],"*":[Oe,Wu(Oe),(r,t)=>{let i=1;for(const c of t)i*=c.evaluate(r);return i}],"-":{type:Oe,overloads:[[[Oe,Oe],(r,[t,i])=>t.evaluate(r)-i.evaluate(r)],[[Oe],(r,[t])=>-t.evaluate(r)]]},"/":[Oe,[Oe,Oe],(r,[t,i])=>t.evaluate(r)/i.evaluate(r)],"%":[Oe,[Oe,Oe],(r,[t,i])=>t.evaluate(r)%i.evaluate(r)],ln2:[Oe,[],()=>Math.LN2],pi:[Oe,[],()=>Math.PI],e:[Oe,[],()=>Math.E],"^":[Oe,[Oe,Oe],(r,[t,i])=>Math.pow(t.evaluate(r),i.evaluate(r))],sqrt:[Oe,[Oe],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Oe,[Oe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Oe,[Oe],(r,[t])=>Math.log(t.evaluate(r))],log2:[Oe,[Oe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Oe,[Oe],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Oe,[Oe],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Oe,[Oe],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Oe,[Oe],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Oe,[Oe],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Oe,[Oe],(r,[t])=>Math.atan(t.evaluate(r))],min:[Oe,Wu(Oe),(r,t)=>Math.min(...t.map(i=>i.evaluate(r)))],max:[Oe,Wu(Oe),(r,t)=>Math.max(...t.map(i=>i.evaluate(r)))],abs:[Oe,[Oe],(r,[t])=>Math.abs(t.evaluate(r))],round:[Oe,[Oe],(r,[t])=>{const i=t.evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[Oe,[Oe],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Oe,[Oe],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Vt,[ft,kn],(r,[t,i])=>r.properties()[t.value]===i.value],"filter-id-==":[Vt,[kn],(r,[t])=>r.id()===t.value],"filter-type-==":[Vt,[ft],(r,[t])=>r.geometryType()===t.value],"filter-<":[Vt,[ft,kn],(r,[t,i])=>{const c=r.properties()[t.value],m=i.value;return typeof c==typeof m&&c<m}],"filter-id-<":[Vt,[kn],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i<c}],"filter->":[Vt,[ft,kn],(r,[t,i])=>{const c=r.properties()[t.value],m=i.value;return typeof c==typeof m&&c>m}],"filter-id->":[Vt,[kn],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i>c}],"filter-<=":[Vt,[ft,kn],(r,[t,i])=>{const c=r.properties()[t.value],m=i.value;return typeof c==typeof m&&c<=m}],"filter-id-<=":[Vt,[kn],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i<=c}],"filter->=":[Vt,[ft,kn],(r,[t,i])=>{const c=r.properties()[t.value],m=i.value;return typeof c==typeof m&&c>=m}],"filter-id->=":[Vt,[kn],(r,[t])=>{const i=r.id(),c=t.value;return typeof i==typeof c&&i>=c}],"filter-has":[Vt,[kn],(r,[t])=>t.value in r.properties()],"filter-has-id":[Vt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Vt,[ya(ft)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Vt,[ya(kn)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Vt,[ft,ya(kn)],(r,[t,i])=>i.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Vt,[ft,ya(kn)],(r,[t,i])=>function(c,m,g,b){for(;g<=b;){const C=g+b>>1;if(m[C]===c)return!0;m[C]>c?b=C-1:g=C+1}return!1}(r.properties()[t.value],i.value,0,i.value.length-1)],all:{type:Vt,overloads:[[[Vt,Vt],(r,[t,i])=>t.evaluate(r)&&i.evaluate(r)],[Wu(Vt),(r,t)=>{for(const i of t)if(!i.evaluate(r))return!1;return!0}]]},any:{type:Vt,overloads:[[[Vt,Vt],(r,[t,i])=>t.evaluate(r)||i.evaluate(r)],[Wu(Vt),(r,t)=>{for(const i of t)if(i.evaluate(r))return!0;return!1}]]},"!":[Vt,[Vt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Vt,[ft],(r,[t])=>{const i=r.globals&&r.globals.isSupportedScript;return!i||i(t.evaluate(r))}],upcase:[ft,[ft],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[ft,[ft],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[ft,Wu(kn),(r,t)=>t.map(i=>ms(i.evaluate(r))).join("")],"resolved-locale":[ft,[_a],(r,[t])=>t.evaluate(r).resolvedLocale()],random:[Oe,[Oe,Oe,kn],(r,t)=>{const[i,c,m]=t.map(b=>b.evaluate(r));if(i>c||i===c)return i;let g;if(typeof m=="string")g=function(b){let C=0;if(b.length===0)return C;for(let k=0;k<b.length;k++)C=(C<<5)-C+b.charCodeAt(k),C|=0;return C}(m);else{if(typeof m!="number")throw new lo(`Invalid seed input: ${m}`);g=m}return i+_s(g)()*(c-i)}]});var ec=Ql;function hp(r){return{result:"success",value:r}}function ll(r){return{result:"error",value:r}}function cl(r,t){return!!r&&!!r.parameters&&r.parameters.indexOf(t)>-1}function _u(r){return r["property-type"]==="data-driven"}function tc(r){return cl(r.expression,"measure-light")}function dp(r){return cl(r.expression,"zoom")}function Hu(r){return!!r.expression&&r.expression.interpolated}function Zu(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function ef(r){return r}function Xu(r,t){const i=t.type==="color",c=r.stops&&typeof r.stops[0][0]=="object",m=c||!(c||r.property!==void 0),g=r.type||(Hu(t)?"exponential":"interval");if(i&&((r=Gs({},r)).stops&&(r.stops=r.stops.map(R=>[R[0],po.parse(R[1])])),r.default=po.parse(r.default?r.default:t.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!ap[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let b,C,k;if(g==="exponential")b=yu;else if(g==="interval")b=Yu;else if(g==="categorical"){b=Ff,C=Object.create(null);for(const R of r.stops)C[R[0]]=R[1];k=typeof r.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);b=pp}if(c){const R={},z=[];for(let Q=0;Q<r.stops.length;Q++){const te=r.stops[Q],oe=te[0].zoom;R[oe]===void 0&&(R[oe]={zoom:oe,type:r.type,property:r.property,default:r.default,stops:[]},z.push(oe)),R[oe].stops.push([te[0].value,te[1]])}const V=[];for(const Q of z)V.push([R[Q].zoom,Xu(R[Q],t)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Ys.interpolationFactor.bind(void 0,q),zoomStops:V.map(Q=>Q[0]),evaluate:({zoom:Q},te)=>yu({stops:V,base:r.base},t,Q).evaluate(Q,te)}}if(m){const R=g==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Ys.interpolationFactor.bind(void 0,R),zoomStops:r.stops.map(z=>z[0]),evaluate:({zoom:z})=>b(r,t,z,C,k)}}return{kind:"source",evaluate(R,z){const V=z&&z.properties?z.properties[r.property]:void 0;return V===void 0?vc(r.default,t.default):b(r,t,V,C,k)}}}function vc(r,t,i){return r!==void 0?r:t!==void 0?t:i!==void 0?i:void 0}function Ff(r,t,i,c,m){return vc(typeof i===m?c[i]:void 0,r.default,t.default)}function Yu(r,t,i){if(Du(i)!=="number")return vc(r.default,t.default);const c=r.stops.length;if(c===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[c-1][0])return r.stops[c-1][1];const m=ko(r.stops.map(g=>g[0]),i);return r.stops[m][1]}function yu(r,t,i){const c=r.base!==void 0?r.base:1;if(Du(i)!=="number")return vc(r.default,t.default);const m=r.stops.length;if(m===1||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[m-1][0])return r.stops[m-1][1];const g=ko(r.stops.map(z=>z[0]),i),b=function(z,V,q,Q){const te=Q-q,oe=z-q;return te===0?0:V===1?oe/te:(Math.pow(V,oe)-1)/(Math.pow(V,te)-1)}(i,c,r.stops[g][0],r.stops[g+1][0]),C=r.stops[g][1],k=r.stops[g+1][1];let R=Uo[t.type]||ef;if(r.colorSpace&&r.colorSpace!=="rgb"){const z=ap[r.colorSpace];R=(V,q)=>z.reverse(z.interpolate(z.forward(V),z.forward(q),b))}return typeof C.evaluate=="function"?{evaluate(...z){const V=C.evaluate.apply(void 0,z),q=k.evaluate.apply(void 0,z);if(V!==void 0&&q!==void 0)return R(V,q,b)}}:R(C,k,b)}function pp(r,t,i){return t.type==="color"?i=po.parse(i):t.type==="formatted"?i=ea.fromString(i.toString()):t.type==="resolvedImage"?i=Dn.fromString(i.toString()):Du(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),vc(i,r.default,t.default)}class xc{constructor(t,i,c,m){this.expression=t,this._warningHistory={},this._evaluator=new jm(c,m),this._defaultValue=i?function(g){return g.type==="color"&&(Zu(g.default)||Array.isArray(g.default))?new po(0,0,0,0):g.type==="color"?po.parse(g.default)||null:g.default===void 0?null:g.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,c,m,g,b,C,k){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=c,this._evaluator.canonical=m||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,c,m,g,b,C,k){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=c||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=k||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new lo(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function Js(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in ec}function bd(r,t,i,c){const m=new pu(ec,[],t?function(b){const C={color:Xr,string:ft,number:Oe,enum:ft,boolean:Vt,formatted:Ca,resolvedImage:Ua};return b.type==="array"?ya(C[b.value]||kn,b.length):C[b.type]}(t):void 0,void 0,void 0,i,c),g=m.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?hp(new xc(g,t,i,c)):ll(m.errors)}class Ih{constructor(t,i,c){this.kind=t,this._styleExpression=i,this.isLightConstant=c,this.isStateDependent=t!=="constant"&&!hu(i.expression),this.isConfigDependent=!gd(i.expression)}evaluateWithoutErrorHandling(t,i,c,m,g,b){return this._styleExpression.evaluateWithoutErrorHandling(t,i,c,m,g,b)}evaluate(t,i,c,m,g,b){return this._styleExpression.evaluate(t,i,c,m,g,b)}}class Ch{constructor(t,i,c,m,g){this.kind=t,this.zoomStops=c,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!hu(i.expression),this.isLightConstant=g,this.isConfigDependent=!gd(i.expression),this.interpolationType=m}evaluateWithoutErrorHandling(t,i,c,m,g,b){return this._styleExpression.evaluateWithoutErrorHandling(t,i,c,m,g,b)}evaluate(t,i,c,m,g,b){return this._styleExpression.evaluate(t,i,c,m,g,b)}interpolationFactor(t,i,c){return this.interpolationType?Ys.interpolationFactor(this.interpolationType,t,i,c):0}}function Ah(r,t,i,c){if((r=bd(r,t,i,c)).result==="error")return r;const m=r.value.expression,g=Vu(m);if(!g&&!_u(t))return ll([new _l("","data expressions not supported")]);const b=Aa(m,["zoom","pitch","distance-from-center"]);if(!b&&!dp(t))return ll([new _l("","zoom expressions not supported")]);const C=Aa(m,["measure-light"]);if(!C&&!tc(t))return ll([new _l("","measure-light expression not supported")]);const k=t.expression&&t.expression.relaxZoomRestriction,R=E(m);return R||b||k?R instanceof _l?ll([R]):R instanceof Ys&&!Hu(t)?ll([new _l("",'"interpolate" expressions cannot be used with this property')]):hp(R?new Ch(g?"camera":"composite",r.value,R.labels,R instanceof Ys?R.interpolation:void 0,C):new Ih(g?"constant":"source",r.value,C)):ll([new _l("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class S{constructor(t,i){this._parameters=t,this._specification=i,Gs(this,Xu(this._parameters,this._specification))}static deserialize(t){return new S(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function E(r){let t=null;if(r instanceof xd)t=E(r.result);else if(r instanceof xl){for(const i of r.args)if(t=E(i),t)break}else(r instanceof fu||r instanceof Ys)&&r.input instanceof Ki&&r.input.name==="zoom"&&(t=r);return t instanceof _l||r.eachChild(i=>{const c=E(i);c instanceof _l?t=c:t&&c&&t!==c&&(t=new _l("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}var T=B,M=3;function B(r,t,i){var c=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var m=new Int32Array(this.arrayBuffer);r=m[0],this.d=(t=m[1])+2*(i=m[2]);for(var g=0;g<this.d*this.d;g++){var b=m[M+g],C=m[M+g+1];c.push(b===C?null:m.subarray(b,C))}var k=m[M+c.length+1];this.keys=m.subarray(m[M+c.length],k),this.bboxes=m.subarray(k),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var R=0;R<this.d*this.d;R++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=r,this.padding=i,this.scale=t/r,this.uid=0;var z=i/t*r;this.min=-z,this.max=r+z}B.prototype.insert=function(r,t,i,c,m){this._forEachCell(t,i,c,m,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(c),this.bboxes.push(m)},B.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},B.prototype._insertCell=function(r,t,i,c,m,g){this.cells[m].push(g)},B.prototype.query=function(r,t,i,c,m){var g=this.min,b=this.max;if(r<=g&&t<=g&&b<=i&&b<=c&&!m)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(r,t,i,c,this._queryCell,C,{},m),C},B.prototype._queryCell=function(r,t,i,c,m,g,b,C){var k=this.cells[m];if(k!==null)for(var R=this.keys,z=this.bboxes,V=0;V<k.length;V++){var q=k[V];if(b[q]===void 0){var Q=4*q;(C?C(z[Q+0],z[Q+1],z[Q+2],z[Q+3]):r<=z[Q+2]&&t<=z[Q+3]&&i>=z[Q+0]&&c>=z[Q+1])?(b[q]=!0,g.push(R[q])):b[q]=!1}}},B.prototype._forEachCell=function(r,t,i,c,m,g,b,C){for(var k=this._convertToCellCoord(r),R=this._convertToCellCoord(t),z=this._convertToCellCoord(i),V=this._convertToCellCoord(c),q=k;q<=z;q++)for(var Q=R;Q<=V;Q++){var te=this.d*Q+q;if((!C||C(this._convertFromCellCoord(q),this._convertFromCellCoord(Q),this._convertFromCellCoord(q+1),this._convertFromCellCoord(Q+1)))&&m.call(this,r,t,i,c,te,g,b,C))return}},B.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},B.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},B.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,t=M+this.cells.length+1+1,i=0,c=0;c<this.cells.length;c++)i+=this.cells[c].length;var m=new Int32Array(t+i+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var g=t,b=0;b<r.length;b++){var C=r[b];m[M+b]=g,m.set(C,g),g+=C.length}return m[M+r.length]=g,m.set(this.keys,g),m[M+r.length+1]=g+=this.keys.length,m.set(this.bboxes,g),g+=this.bboxes.length,m.buffer};var W=ce(T);const Y={};function re(r,t,i={}){Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),Y[t]={klass:r,omit:i.omit||[]}}re(Object,"Object"),W.serialize=function(r,t){const i=r.toArrayBuffer();return t&&t.add(i),{buffer:i}},W.deserialize=function(r){return new W(r.buffer)},Object.defineProperty(W,"name",{value:"Grid"}),re(W,"Grid"),re(po,"Color"),re(Error,"Error"),re(ea,"Formatted"),re(tu,"FormattedSection"),re(it,"AJAXError"),re(Dn,"ResolvedImage"),re(S,"StylePropertyFunction"),re(xc,"StyleExpression",{omit:["_evaluator"]}),re(Ch,"ZoomDependentExpression"),re(Ih,"ZoomConstantExpression"),re(Ki,"CompoundExpression",{omit:["_evaluate"]});for(const r in ec)Y[ec[r]._classRegistryKey]||re(ec[r],`Expression${r}`);function ye(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Ae(r){return self.ImageBitmap&&r instanceof ImageBitmap}function Ze(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(ye(r)||Ae(r))return t&&t.add(r),r;if(ArrayBuffer.isView(r)){const i=r;return t&&t.add(i.buffer),i}if(r instanceof ImageData)return t&&t.add(r.data.buffer),r;if(Array.isArray(r)){const i=[];for(const c of r)i.push(Ze(c,t));return i}if(r instanceof Map){const i={$name:"Map"};for(const[c,m]of r.entries())i[c]=Ze(m);return i}if(typeof r=="object"){const i=r.constructor,c=i._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const m=i.serialize?i.serialize(r,t):{};if(!i.serialize){for(const g in r)r.hasOwnProperty(g)&&(Y[c].omit.indexOf(g)>=0||(m[g]=Ze(r[g],t)));r instanceof Error&&(m.message=r.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(m.$name=c),m}throw new Error("can't serialize object of type "+typeof r)}function Je(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||ye(r)||Ae(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(Je);if(typeof r=="object"){const t=r.$name||"Object";if(t==="Map"){const m=new Map;for(const g of Object.keys(r))g!=="$name"&&m.set(g,Je(r[g]));return m}const{klass:i}=Y[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(r);const c=Object.create(i.prototype);for(const m of Object.keys(r))m!=="$name"&&(c[m]=Je(r[m]));return c}throw new Error("can't deserialize object of type "+typeof r)}const ke={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519,"CJK Unified Ideographs Extension B":r=>r>=131072&&r<=173791};function ut(r){for(const t of r)if(lt(t.charCodeAt(0)))return!0;return!1}function ht(r){for(const t of r)if(!Ct(t.charCodeAt(0)))return!1;return!0}function Ct(r){return!(ke.Arabic(r)||ke["Arabic Supplement"](r)||ke["Arabic Extended-A"](r)||ke["Arabic Presentation Forms-A"](r)||ke["Arabic Presentation Forms-B"](r))}function lt(r){return!(r!==746&&r!==747&&(r<4352||!(ke["Bopomofo Extended"](r)||ke.Bopomofo(r)||ke["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||ke["CJK Compatibility Ideographs"](r)||ke["CJK Compatibility"](r)||ke["CJK Radicals Supplement"](r)||ke["CJK Strokes"](r)||!(!ke["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||ke["CJK Unified Ideographs Extension A"](r)||ke["CJK Unified Ideographs"](r)||ke["Enclosed CJK Letters and Months"](r)||ke["Hangul Compatibility Jamo"](r)||ke["Hangul Jamo Extended-A"](r)||ke["Hangul Jamo Extended-B"](r)||ke["Hangul Jamo"](r)||ke["Hangul Syllables"](r)||ke.Hiragana(r)||ke["Ideographic Description Characters"](r)||ke.Kanbun(r)||ke["Kangxi Radicals"](r)||ke["Katakana Phonetic Extensions"](r)||ke.Katakana(r)&&r!==12540||!(!ke["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!ke["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||ke["Unified Canadian Aboriginal Syllabics"](r)||ke["Unified Canadian Aboriginal Syllabics Extended"](r)||ke["Vertical Forms"](r)||ke["Yijing Hexagram Symbols"](r)||ke["Yi Syllables"](r)||ke["Yi Radicals"](r))))}function It(r){return!(lt(r)||function(t){return!!(ke["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ke["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ke["Letterlike Symbols"](t)||ke["Number Forms"](t)||ke["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ke["Control Pictures"](t)&&t!==9251||ke["Optical Character Recognition"](t)||ke["Enclosed Alphanumerics"](t)||ke["Geometric Shapes"](t)||ke["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ke["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ke["CJK Symbols and Punctuation"](t)||ke.Katakana(t)||ke["Private Use Area"](t)||ke["CJK Compatibility Forms"](t)||ke["Small Form Variants"](t)||ke["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function Lt(r){return r>=1424&&r<=2303||ke["Arabic Presentation Forms-A"](r)||ke["Arabic Presentation Forms-B"](r)}function Jt(r,t){return!(!t&&Lt(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||ke.Khmer(r))}function vr(r){for(const t of r)if(Lt(t.charCodeAt(0)))return!0;return!1}const mr="deferred",wr="loading",Ur="loaded";let on=null,Hr="unavailable",mn=null;const Yn=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(Hr="error"),on&&on(r)};function ni(){Jn.fire(new qi("pluginStateChange",{pluginStatus:Hr,pluginURL:mn}))}const Jn=new kl,io=function(){return Hr},An=function(){if(Hr!==mr||!mn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Hr=wr,ni(),mn&&ve({url:mn},r=>{r?Yn(r):(Hr=Ur,ni())})},Qn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Hr===Ur||Qn.applyArabicShaping!=null,isLoading:()=>Hr===wr,setState(r){Hr=r.pluginStatus,mn=r.pluginURL},isParsed:()=>Qn.applyArabicShaping!=null&&Qn.processBidirectionalText!=null&&Qn.processStyledBidirectionalText!=null,getPluginURL:()=>mn};class $n{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(i,c){for(const m of i)if(!Jt(m.charCodeAt(0),c))return!1;return!0}(t,Qn.isLoaded())}}class vi{constructor(t,i,c,m){this.property=t,this.value=i,this.expression=function(g,b,C,k){if(Zu(g))return new S(g,b);if(Js(g)||Array.isArray(g)&&g.length>0){const R=Ah(g,b,C,k);if(R.result==="error")throw new Error(R.value.map(z=>`${z.key}: ${z.message}`).join(", "));return R.value}{let R=g;return typeof g=="string"&&b.type==="color"&&(R=po.parse(g)),{kind:"constant",isConfigDependent:!1,evaluate:()=>R}}}(i===void 0?t.specification.default:i,t.specification,c,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,c){return this.property.possiblyEvaluate(this,t,i,c)}}class xi{constructor(t,i,c){this.property=t,this.value=new vi(t,void 0,i,c)}transitioned(t,i){return new yi(this.property,this.value,i,ln({},t.transition,this.transition),t.now)}untransitioned(){return new yi(this.property,this.value,null,{},0)}}class Ii{constructor(t,i,c){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=i,this._options=c,this.isConfigDependent=!1}getValue(t){return Ir(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new xi(this._values[t].property,this._scope,this._options)),this._values[t].value=new vi(this._values[t].property,i===null?void 0:Ir(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,i){i&&(this._options=i);const c=this._properties.properties;if(t)for(const m in t){const g=t[m];if(Nn(m,"-transition")){const b=m.slice(0,-11);c[b]&&this.setTransition(b,g)}else c[m]&&this.setValue(m,g)}}getTransition(t){return Ir(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new xi(this._values[t].property)),this._values[t].transition=Ir(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(t[i]=c);const m=this.getTransition(i);m!==void 0&&(t[`${i}-transition`]=m)}return t}transitioned(t,i){const c=new ii(this._properties);for(const m of Object.keys(this._values))c._values[m]=this._values[m].transitioned(t,i._values[m]);return c}untransitioned(){const t=new ii(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class yi{constructor(t,i,c,m,g){const b=m.delay||0,C=m.duration||0;g=g||0,this.property=t,this.value=i,this.begin=g+b,this.end=this.begin+C,t.specification.transition&&(m.delay||m.duration)&&(this.prior=c)}possiblyEvaluate(t,i,c){const m=t.now||0,g=this.value.possiblyEvaluate(t,i,c),b=this.prior;if(b){if(m>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(m<this.begin)return b.possiblyEvaluate(t,i,c);{const C=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(t,i,c),g,mt(C))}}return g}}class ii{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,c){const m=new Ka(this._properties);for(const g of Object.keys(this._values))m._values[g]=this._values[g].possiblyEvaluate(t,i,c);return m}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class is{constructor(t,i,c){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=i,this._options=c,this.isConfigDependent=!1}getValue(t){return Ir(this._values[t].value)}setValue(t,i){this._values[t]=new vi(this._values[t].property,i===null?void 0:Ir(i),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(t[i]=c)}return t}possiblyEvaluate(t,i,c){const m=new Ka(this._properties);for(const g of Object.keys(this._values))m._values[g]=this._values[g].possiblyEvaluate(t,i,c);return m}}class ra{constructor(t,i,c){this.property=t,this.value=i,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,c,m){return this.property.evaluate(this.value,this.parameters,t,i,c,m)}}class Ka{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Dr{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,c){const m=Uo[this.specification.type];return m?m(t,i,c):t}}class an{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,c,m){return new ra(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},c,m)}:t.expression,i)}interpolate(t,i,c){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new ra(this,{kind:"constant",value:void 0},t.parameters);const m=Uo[this.specification.type];return m?new ra(this,{kind:"constant",value:m(t.value.value,i.value.value,c)},t.parameters):t}evaluate(t,i,c,m,g,b){return t.kind==="constant"?t.value:t.evaluate(i,c,m,g,b)}}class na{constructor(t){this.specification=t}possiblyEvaluate(t,i,c,m){return!!t.expression.evaluate(i,null,{},c,m)}interpolate(){return!1}}class go{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new $n(0,{});for(const c in t){const m=t[c];m.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new vi(m,void 0),b=this.defaultTransitionablePropertyValues[c]=new xi(m);this.defaultTransitioningPropertyValues[c]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate(i)}}}function os(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function rc(r){if(Array.isArray(r))return r.map(rc);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const i in r)t[i]=rc(r[i]);return t}return os(r)}re(an,"DataDrivenProperty"),re(Dr,"DataConstantProperty"),re(na,"ColorRampProperty");var jt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function jl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!jl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Pa(r,t="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};jl(r)||(r=vu(r));const i=r;let c=!0;try{c=function(R){if(!Bl(R))return R;let z=rc(R);return Ku(z),z=wd(z),z}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const m=jt[`filter_${t}`],g=bd(c,m);let b=null;if(g.result==="error")throw new Error(g.value.map(R=>`${R.key}: ${R.message}`).join(", "));b=(R,z,V)=>g.value.evaluate(R,z,{},V);let C=null,k=null;if(c!==i){const R=bd(i,m);if(R.result==="error")throw new Error(R.value.map(z=>`${z.key}: ${z.message}`).join(", "));C=(z,V,q,Q,te)=>R.value.evaluate(z,V,{},q,void 0,void 0,Q,te),k=!Vu(R.value.expression)}return{filter:b,dynamicFilter:C||void 0,needGeometry:bc(c),needFeature:!!k}}function wd(r){if(!Array.isArray(r))return r;const t=function(i){if(Sd.has(i[0])){for(let c=1;c<i.length;c++)if(Bl(i[c]))return!0}return i}(r);return t===!0?t:t.map(i=>wd(i))}function Ku(r){let t=!1;const i=[];if(r[0]==="case"){for(let c=1;c<r.length-1;c+=2)t=t||Bl(r[c]),i.push(r[c+1]);i.push(r[r.length-1])}else if(r[0]==="match"){t=t||Bl(r[1]);for(let c=2;c<r.length-1;c+=2)i.push(r[c+1]);i.push(r[r.length-1])}else if(r[0]==="step"){t=t||Bl(r[1]);for(let c=1;c<r.length-1;c+=2)i.push(r[c+1])}t&&(r.length=0,r.push("any",...i));for(let c=1;c<r.length;c++)Ku(r[c])}function Bl(r){if(!Array.isArray(r))return!1;if((t=r[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<r.length;i++)if(Bl(r[i]))return!0;return!1}const Sd=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function fp(r,t){return r<t?-1:r>t?1:0}function bc(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(bc(r[t]))return!0;return!1}function vu(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?wl(r[1],r[2],"=="):t==="!="?nc(wl(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?wl(r[1],r[2],t):t==="any"?(i=r.slice(1),["any"].concat(i.map(vu))):t==="all"?["all"].concat(r.slice(1).map(vu)):t==="none"?["all"].concat(r.slice(1).map(vu).map(nc)):t==="in"?qa(r[1],r.slice(2)):t==="!in"?nc(qa(r[1],r.slice(2))):t==="has"?Fc(r[1]):t!=="!has"||nc(Fc(r[1]));var i}function wl(r,t,i){switch(r){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,r,t]}}function qa(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",r,["literal",t.sort(fp)]]:["filter-in-small",r,["literal",t]]}}function Fc(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function nc(r){return["!",r]}const Vc="";function Co(r,t){return t?`${r}${Vc}${t}`:r}const Ns="-transition";class ia extends kl{constructor(t,i,c,m){if(super(),this.id=t.id,this.fqid=Co(this.id,c),this.type=t.type,this.scope=c,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),t.slot&&(this.slot=t.slot),i.layout&&(this._unevaluatedLayout=new is(i.layout,this.scope,m),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),i.paint)){this._transitionablePaint=new Ii(i.paint,this.scope,m);for(const g in t.paint)this.setPaintProperty(g,t.paint[g]);for(const g in t.layout)this.setLayoutProperty(g,t.layout[g]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ka(i.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i){if(this.type==="custom"&&t==="visibility")return void(this.visibility=i);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,i),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return Nn(t,Ns)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i){const c=this._transitionablePaint,m=c._properties.properties;if(Nn(t,Ns)){const V=t.slice(0,-11);return m[V]&&c.setTransition(V,i||void 0),!1}if(!m[t])return!1;const g=c._values[t],b=g.value.isDataDriven(),C=g.value;c.setValue(t,i),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const k=c._values[t].value,R=k.isDataDriven(),z=Nn(t,"pattern")||t==="line-dasharray";return R||b||z||this._handleOverridablePaintPropertyUpdate(t,C,k)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,i){return null}_handleOverridablePaintPropertyUpdate(t,i,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){return Dt({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,i)=>!(t===void 0||i==="layout"&&!Object.keys(t).length||i==="paint"&&!Object.keys(t).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof ra&&_u(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Pa(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}}const Ph={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class tf{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class jo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bo(r,t=1){let i=0,c=0;return{members:r.map(m=>{const g=Ph[m.type].BYTES_PER_ELEMENT,b=i=xu(i,Math.max(t,g)),C=m.components||1;return c=Math.max(c,g),i+=g*C,{name:m.name,type:m.type,components:C,offset:b}}),size:xu(i,Math.max(c,t)),alignment:t}}function xu(r,t){return Math.ceil(r/t)*t}class ic extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const m=2*t;return this.int16[m+0]=i,this.int16[m+1]=c,t}}ic.prototype.bytesPerElement=4,re(ic,"StructArrayLayout2i4");class as extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,c)}emplace(t,i,c,m){const g=3*t;return this.int16[g+0]=i,this.int16[g+1]=c,this.int16[g+2]=m,t}}as.prototype.bytesPerElement=6,re(as,"StructArrayLayout3i6");class oc extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,c,m)}emplace(t,i,c,m,g){const b=4*t;return this.int16[b+0]=i,this.int16[b+1]=c,this.int16[b+2]=m,this.int16[b+3]=g,t}}oc.prototype.bytesPerElement=8,re(oc,"StructArrayLayout4i8");class Vf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,m,g)}emplace(t,i,c,m,g,b){const C=5*t;return this.int16[C+0]=i,this.int16[C+1]=c,this.int16[C+2]=m,this.int16[C+3]=g,this.int16[C+4]=b,t}}Vf.prototype.bytesPerElement=10,re(Vf,"StructArrayLayout5i10");class Mh extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,c,m,g,b,C)}emplace(t,i,c,m,g,b,C,k){const R=6*t,z=12*t,V=3*t;return this.int16[R+0]=i,this.int16[R+1]=c,this.uint8[z+4]=m,this.uint8[z+5]=g,this.uint8[z+6]=b,this.uint8[z+7]=C,this.float32[V+2]=k,t}}Mh.prototype.bytesPerElement=12,re(Mh,"StructArrayLayout2i4ub1f12");class Ja extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,c,m)}emplace(t,i,c,m,g){const b=4*t;return this.float32[b+0]=i,this.float32[b+1]=c,this.float32[b+2]=m,this.float32[b+3]=g,t}}Ja.prototype.bytesPerElement=16,re(Ja,"StructArrayLayout4f16");class Td extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,m,g)}emplace(t,i,c,m,g,b){const C=6*t,k=3*t;return this.uint16[C+0]=i,this.uint16[C+1]=c,this.uint16[C+2]=m,this.uint16[C+3]=g,this.float32[k+2]=b,t}}Td.prototype.bytesPerElement=12,re(Td,"StructArrayLayout4ui1f12");class mp extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,c,m)}emplace(t,i,c,m,g){const b=4*t;return this.uint16[b+0]=i,this.uint16[b+1]=c,this.uint16[b+2]=m,this.uint16[b+3]=g,t}}mp.prototype.bytesPerElement=8,re(mp,"StructArrayLayout4ui8");class Um extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,i,c,m,g,b)}emplace(t,i,c,m,g,b,C){const k=6*t;return this.int16[k+0]=i,this.int16[k+1]=c,this.int16[k+2]=m,this.int16[k+3]=g,this.int16[k+4]=b,this.int16[k+5]=C,t}}Um.prototype.bytesPerElement=12,re(Um,"StructArrayLayout6i12");class Uf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C,k,R,z,V,q){const Q=this.length;return this.resize(Q+1),this.emplace(Q,t,i,c,m,g,b,C,k,R,z,V,q)}emplace(t,i,c,m,g,b,C,k,R,z,V,q,Q){const te=12*t;return this.int16[te+0]=i,this.int16[te+1]=c,this.int16[te+2]=m,this.int16[te+3]=g,this.uint16[te+4]=b,this.uint16[te+5]=C,this.uint16[te+6]=k,this.uint16[te+7]=R,this.int16[te+8]=z,this.int16[te+9]=V,this.int16[te+10]=q,this.int16[te+11]=Q,t}}Uf.prototype.bytesPerElement=24,re(Uf,"StructArrayLayout4i4ui4i24");class S_ extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,i,c,m,g,b)}emplace(t,i,c,m,g,b,C){const k=10*t,R=5*t;return this.int16[k+0]=i,this.int16[k+1]=c,this.int16[k+2]=m,this.float32[R+2]=g,this.float32[R+3]=b,this.float32[R+4]=C,t}}S_.prototype.bytesPerElement=20,re(S_,"StructArrayLayout3i3f20");class T_ extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}T_.prototype.bytesPerElement=4,re(T_,"StructArrayLayout1ul4");class Uc extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const m=2*t;return this.uint16[m+0]=i,this.uint16[m+1]=c,t}}Uc.prototype.bytesPerElement=4,re(Uc,"StructArrayLayout2ui4");class E_ extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C,k,R,z,V,q,Q){const te=this.length;return this.resize(te+1),this.emplace(te,t,i,c,m,g,b,C,k,R,z,V,q,Q)}emplace(t,i,c,m,g,b,C,k,R,z,V,q,Q,te){const oe=20*t,pe=10*t;return this.int16[oe+0]=i,this.int16[oe+1]=c,this.int16[oe+2]=m,this.int16[oe+3]=g,this.int16[oe+4]=b,this.float32[pe+3]=C,this.float32[pe+4]=k,this.float32[pe+5]=R,this.float32[pe+6]=z,this.int16[oe+14]=V,this.uint32[pe+8]=q,this.uint16[oe+18]=Q,this.uint16[oe+19]=te,t}}E_.prototype.bytesPerElement=40,re(E_,"StructArrayLayout5i4f1i1ul2ui40");class Ed extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,c,m,g,b,C)}emplace(t,i,c,m,g,b,C,k){const R=8*t;return this.int16[R+0]=i,this.int16[R+1]=c,this.int16[R+2]=m,this.int16[R+4]=g,this.int16[R+5]=b,this.int16[R+6]=C,this.int16[R+7]=k,t}}Ed.prototype.bytesPerElement=16,re(Ed,"StructArrayLayout3i2i2i16");class $f extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,m,g)}emplace(t,i,c,m,g,b){const C=4*t,k=8*t;return this.float32[C+0]=i,this.float32[C+1]=c,this.float32[C+2]=m,this.int16[k+6]=g,this.int16[k+7]=b,t}}$f.prototype.bytesPerElement=16,re($f,"StructArrayLayout2f1f2i16");class Ju extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,c,m)}emplace(t,i,c,m,g){const b=12*t,C=3*t;return this.uint8[b+0]=i,this.uint8[b+1]=c,this.float32[C+1]=m,this.float32[C+2]=g,t}}Ju.prototype.bytesPerElement=12,re(Ju,"StructArrayLayout2ub2f12");class Wa extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,c)}emplace(t,i,c,m){const g=3*t;return this.uint16[g+0]=i,this.uint16[g+1]=c,this.uint16[g+2]=m,t}}Wa.prototype.bytesPerElement=6,re(Wa,"StructArrayLayout3ui6");class rf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt)}emplace(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt,Qe){const gt=30*t,At=15*t,Bt=60*t;return this.int16[gt+0]=i,this.int16[gt+1]=c,this.int16[gt+2]=m,this.float32[At+2]=g,this.float32[At+3]=b,this.uint16[gt+8]=C,this.uint16[gt+9]=k,this.uint32[At+5]=R,this.uint32[At+6]=z,this.uint32[At+7]=V,this.uint16[gt+16]=q,this.uint16[gt+17]=Q,this.uint16[gt+18]=te,this.float32[At+10]=oe,this.float32[At+11]=pe,this.uint8[Bt+48]=_e,this.uint8[Bt+49]=ze,this.uint8[Bt+50]=Ue,this.uint32[At+13]=Ve,this.int16[gt+28]=nt,this.uint8[Bt+58]=Qe,t}}rf.prototype.bytesPerElement=60,re(rf,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class $m extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr,Er,lr){const Sr=this.length;return this.resize(Sr+1),this.emplace(Sr,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr,Er,lr)}emplace(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr,Er,lr,Sr){const Yr=20*t,kr=40*t,bn=80*t;return this.float32[Yr+0]=i,this.float32[Yr+1]=c,this.int16[kr+4]=m,this.int16[kr+5]=g,this.int16[kr+6]=b,this.int16[kr+7]=C,this.int16[kr+8]=k,this.int16[kr+9]=R,this.int16[kr+10]=z,this.int16[kr+11]=V,this.int16[kr+12]=q,this.uint16[kr+13]=Q,this.uint16[kr+14]=te,this.uint16[kr+15]=oe,this.uint16[kr+16]=pe,this.uint16[kr+17]=_e,this.uint16[kr+18]=ze,this.uint16[kr+19]=Ue,this.uint16[kr+20]=Ve,this.uint16[kr+21]=nt,this.uint16[kr+22]=Qe,this.uint16[kr+23]=gt,this.uint16[kr+24]=At,this.uint16[kr+25]=Bt,this.uint16[kr+26]=Yt,this.uint16[kr+27]=Ft,this.uint32[Yr+14]=_r,this.float32[Yr+15]=Pr,this.float32[Yr+16]=dr,this.float32[Yr+17]=Er,this.float32[Yr+18]=lr,this.uint8[bn+76]=Sr,t}}$m.prototype.bytesPerElement=80,re($m,"StructArrayLayout2f9i15ui1ul4f1ub80");class Gf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Gf.prototype.bytesPerElement=4,re(Gf,"StructArrayLayout1f4");class Id extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,i,c,m,g)}emplace(t,i,c,m,g,b){const C=5*t;return this.float32[C+0]=i,this.float32[C+1]=c,this.float32[C+2]=m,this.float32[C+3]=g,this.float32[C+4]=b,t}}Id.prototype.bytesPerElement=20,re(Id,"StructArrayLayout5f20");class I_ extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,c,m,g,b,C)}emplace(t,i,c,m,g,b,C,k){const R=7*t;return this.float32[R+0]=i,this.float32[R+1]=c,this.float32[R+2]=m,this.float32[R+3]=g,this.float32[R+4]=b,this.float32[R+5]=C,this.float32[R+6]=k,t}}I_.prototype.bytesPerElement=28,re(I_,"StructArrayLayout7f28");class qf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,c,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,c,m)}emplace(t,i,c,m,g){const b=6*t;return this.uint32[3*t+0]=i,this.uint16[b+2]=c,this.uint16[b+3]=m,this.uint16[b+4]=g,t}}qf.prototype.bytesPerElement=12,re(qf,"StructArrayLayout1ul3ui12");class C_ extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}C_.prototype.bytesPerElement=2,re(C_,"StructArrayLayout1ui2");class kh extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c){const m=this.length;return this.resize(m+1),this.emplace(m,t,i,c)}emplace(t,i,c,m){const g=3*t;return this.float32[g+0]=i,this.float32[g+1]=c,this.float32[g+2]=m,t}}kh.prototype.bytesPerElement=12,re(kh,"StructArrayLayout3f12");class Wf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const c=this.length;return this.resize(c+1),this.emplace(c,t,i)}emplace(t,i,c){const m=2*t;return this.float32[m+0]=i,this.float32[m+1]=c,t}}Wf.prototype.bytesPerElement=8,re(Wf,"StructArrayLayout2f8");class Cd extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe){const _e=this.length;return this.resize(_e+1),this.emplace(_e,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe)}emplace(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e){const ze=16*t;return this.float32[ze+0]=i,this.float32[ze+1]=c,this.float32[ze+2]=m,this.float32[ze+3]=g,this.float32[ze+4]=b,this.float32[ze+5]=C,this.float32[ze+6]=k,this.float32[ze+7]=R,this.float32[ze+8]=z,this.float32[ze+9]=V,this.float32[ze+10]=q,this.float32[ze+11]=Q,this.float32[ze+12]=te,this.float32[ze+13]=oe,this.float32[ze+14]=pe,this.float32[ze+15]=_e,t}}Cd.prototype.bytesPerElement=64,re(Cd,"StructArrayLayout16f64");class Hf extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,c,m,g,b,C){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,c,m,g,b,C)}emplace(t,i,c,m,g,b,C,k){const R=10*t,z=5*t;return this.uint16[R+0]=i,this.uint16[R+1]=c,this.uint16[R+2]=m,this.uint16[R+3]=g,this.float32[z+2]=b,this.float32[z+3]=C,this.float32[z+4]=k,t}}Hf.prototype.bytesPerElement=20,re(Hf,"StructArrayLayout4ui3f20");class Da extends jo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint8[1*t+0]=i,t}}Da.prototype.bytesPerElement=1,re(Da,"StructArrayLayout1ub1");class Zf extends tf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Zf.prototype.size=40;class A_ extends E_{get(t){return new Zf(this,t)}}re(A_,"CollisionBoxArray");class Xf extends tf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Xf.prototype.size=60;class Yf extends rf{get(t){return new Xf(this,t)}}re(Yf,"PlacedSymbolArray");class nf extends tf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}nf.prototype.size=80;class P_ extends $m{get(t){return new nf(this,t)}}re(P_,"SymbolInstanceArray");class M_ extends Gf{getoffsetX(t){return this.float32[1*t+0]}}re(M_,"GlyphOffsetArray");class Rh extends ic{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}re(Rh,"SymbolLineVertexArray");class Gm extends tf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Gm.prototype.size=12;class qm extends qf{get(t){return new Gm(this,t)}}re(qm,"FeatureIndexArray");class Kf extends Uc{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}re(Kf,"FillExtrusionCentroidArray");const Jf=bo([{name:"a_pos",components:2,type:"Int16"}],4),Ly=bo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ua{constructor(t=[]){this.segments=t}_prepareSegment(t,i,c,m){let g=this.segments[this.segments.length-1];return t>ua.MAX_VERTEX_ARRAY_LENGTH&&Kt(`Max vertices per segment is ${ua.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!g||g.vertexLength+t>ua.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==m)&&(g={vertexOffset:i,primitiveOffset:c,vertexLength:0,primitiveLength:0},m!==void 0&&(g.sortKey=m),this.segments.push(g)),g}prepareSegment(t,i,c,m){return this._prepareSegment(t,i.length,c.length,m)}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,c,m){return new ua([{vertexOffset:t,primitiveOffset:i,vertexLength:c,primitiveLength:m,vaos:{},sortKey:0}])}}function k_(r,t){return 256*(r=Ht(Math.floor(r),0,255))+Ht(Math.floor(t),0,255)}ua.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,re(ua,"SegmentVector");const Wm=bo([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Hm=bo([{name:"a_dash",components:4,type:"Uint16"}]);var Fl={exports:{}},Zm={exports:{}};(function(r){r.exports=function(t,i){var c,m,g,b,C,k,R,z;for(m=t.length-(c=3&t.length),g=i,C=3432918353,k=461845907,z=0;z<m;)R=255&t.charCodeAt(z)|(255&t.charCodeAt(++z))<<8|(255&t.charCodeAt(++z))<<16|(255&t.charCodeAt(++z))<<24,++z,g=27492+(65535&(b=5*(65535&(g=(g^=R=(65535&(R=(R=(65535&R)*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(R=0,c){case 3:R^=(255&t.charCodeAt(z+2))<<16;case 2:R^=(255&t.charCodeAt(z+1))<<8;case 1:g^=R=(65535&(R=(R=(65535&(R^=255&t.charCodeAt(z)))*C+(((R>>>16)*C&65535)<<16)&4294967295)<<15|R>>>17))*k+(((R>>>16)*k&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}})(Zm);var R_=Zm.exports,zy={exports:{}};(function(r){r.exports=function(t,i){for(var c,m=t.length,g=i^m,b=0;m>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(b)|(255&t.charCodeAt(++b))<<8|(255&t.charCodeAt(++b))<<16|(255&t.charCodeAt(++b))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),m-=4,++b;switch(m){case 3:g^=(255&t.charCodeAt(b+2))<<16;case 2:g^=(255&t.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}})(zy);var Ny=R_,D_=zy.exports;Fl.exports=Ny,Fl.exports.murmur3=Ny,Fl.exports.murmur2=D_;var Ad=ce(Fl.exports);class Qf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,i,c,m){this.ids.push(jy(t)),this.positions.push(i,c,m)}eachPosition(t,i){const c=jy(t);let m=0,g=this.ids.length-1;for(;m<g;){const b=m+g>>1;this.ids[b]>=c?g=b:m=b+1}for(;this.ids[m]===c;)i(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(t,i){const c=new Float64Array(t.ids),m=new Uint32Array(t.positions);return Xm(c,m,0,c.length-1),i&&(i.add(c.buffer),i.add(m.buffer)),{ids:c,positions:m}}static deserialize(t){const i=new Qf;let c;i.ids=t.ids,i.positions=t.positions;for(const m of i.ids)m!==c&&i.uniqueIds.push(m),c=m;return i.indexed=!0,i}}function jy(r){const t=+r;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Ad(String(r))}function Xm(r,t,i,c){for(;i<c;){const m=r[i+c>>1];let g=i-1,b=c+1;for(;;){do g++;while(r[g]<m);do b--;while(r[b]>m);if(g>=b)break;em(r,g,b),em(t,3*g,3*b),em(t,3*g+1,3*b+1),em(t,3*g+2,3*b+2)}b-i<c-b?(Xm(r,t,i,b),i=b+1):(Xm(r,t,b+1,c),c=b)}}function em(r,t,i){const c=r[t];r[t]=r[i],r[i]=c}re(Qf,"FeaturePositionMap");class Dh{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class Ym extends Dh{constructor(t){super(t),this.current=0}set(t,i,c){this.fetchUniformLocation(t,i)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class ys extends Dh{constructor(t){super(t),this.current=0}set(t,i,c){this.fetchUniformLocation(t,i)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Pd extends Dh{constructor(t){super(t),this.current=[0,0]}set(t,i,c){this.fetchUniformLocation(t,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Km extends Dh{constructor(t){super(t),this.current=[0,0,0]}set(t,i,c){this.fetchUniformLocation(t,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class _ extends Dh{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,c){this.fetchUniformLocation(t,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class o extends Dh{constructor(t){super(t),this.current=po.transparent}set(t,i,c){this.fetchUniformLocation(t,i)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const h=new Float32Array(16);class x extends Dh{constructor(t){super(t),this.current=h}set(t,i,c){if(this.fetchUniformLocation(t,i)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let m=1;m<16;m++)if(c[m]!==this.current[m]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const I=new Float32Array(9),A=new Float32Array(4);class D extends Dh{constructor(t){super(t),this.current=A}set(t,i,c){if(this.fetchUniformLocation(t,i)){for(let m=0;m<4;m++)if(c[m]!==this.current[m]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function N(r){return[k_(255*r.r,255*r.g),k_(255*r.b,255*r.a)]}class U{constructor(t,i,c){this.value=t,this.uniformNames=i.map(m=>`u_${m}`),this.type=c}setUniform(t,i,c,m,g){i.set(t,g,m.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new o(t):new ys(t)}}class Z{constructor(t,i){this.uniformNames=i.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,c,m,g){const b=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;b&&i.set(t,g,b)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new _(t):new ys(t)}}class J{constructor(t,i,c,m){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=i.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,i,c,m,g,b,C){const k=this.paintVertexArray.length,R=this.expression.evaluate(new $n(0,{brightness:b}),i,{},g,m,C);this.paintVertexArray.resize(t),this._setPaintValue(k,t,R)}updatePaintArray(t,i,c,m,g,b,C){const k=this.expression.evaluate({zoom:0,brightness:C},c,m,void 0,g);this._setPaintValue(t,i,k)}_setPaintValue(t,i,c){if(this.type==="color"){const m=N(c);for(let g=t;g<i;g++)this.paintVertexArray.emplace(g,m[0],m[1])}else{for(let m=t;m<i;m++)this.paintVertexArray.emplace(m,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ee{constructor(t,i,c,m,g,b){this.expression=t,this.uniformNames=i.map(C=>`u_${C}_t`),this.type=c,this.useIntegerZoom=m,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=i.map(C=>({name:`a_${C}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(t,i,c,m,g,b,C){const k=this.expression.evaluate(new $n(this.zoom,{brightness:b}),i,{},g,m,C),R=this.expression.evaluate(new $n(this.zoom+1,{brightness:b}),i,{},g,m,C),z=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(z,t,k,R)}updatePaintArray(t,i,c,m,g,b,C){const k=this.expression.evaluate({zoom:this.zoom,brightness:C},c,m,void 0,g),R=this.expression.evaluate({zoom:this.zoom+1,brightness:C},c,m,void 0,g);this._setPaintValue(t,i,k,R)}_setPaintValue(t,i,c,m){if(this.type==="color"){const g=N(c),b=N(m);for(let C=t;C<i;C++)this.paintVertexArray.emplace(C,g[0],g[1],b[0],b[1])}else{for(let g=t;g<i;g++)this.paintVertexArray.emplace(g,c,m);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(m))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,c,m,g){const b=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,C=Ht(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);i.set(t,g,C)}getBinding(t,i){return new ys(t)}}class ae{constructor(t,i,c,m,g){this.expression=t,this.layerId=g,this.paintVertexAttributes=(c==="array"?Hm:Wm).members;for(let b=0;b<i.length;++b);this.paintVertexArray=new m}populatePaintArray(t,i,c){const m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(m,t,i.patterns&&i.patterns[this.layerId],c)}updatePaintArray(t,i,c,m,g,b,C){this._setPaintValues(t,i,c.patterns&&c.patterns[this.layerId],b)}_setPaintValues(t,i,c,m){if(!m||!c)return;const g=m[c];if(!g)return;const{tl:b,br:C,pixelRatio:k}=g;for(let R=t;R<i;R++)this.paintVertexArray.emplace(R,b[0],b[1],C[0],C[1],k)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class he{constructor(t,i,c=()=>!0){this.binders={},this._buffers=[];const m=[];for(const g in t.paint._values){const b=t.paint.get(g);if(!c(g)||!(b instanceof ra&&_u(b.property.specification)))continue;const C=Ce(g,t.type),k=b.value,R=b.property.specification.type,z=!!b.property.useIntegerZoom,V=g==="line-dasharray"||g.endsWith("pattern"),q=g==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(k.kind!=="constant"||q)if(k.kind==="source"||q||V){const Q=Xe(g,R,"source");this.binders[g]=V?new ae(k,C,R,Q,t.id):new J(k,C,R,Q),m.push(`/a_${g}`)}else{const Q=Xe(g,R,"composite");this.binders[g]=new ee(k,C,R,z,i,Q),m.push(`/z_${g}`)}else this.binders[g]=V?new Z(k.value,C):new U(k.value,C,R),m.push(`/u_${g}`)}this.cacheKey=m.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof J||i instanceof ee?i.maxValue:0}populatePaintArrays(t,i,c,m,g,b,C){for(const k in this.binders){const R=this.binders[k];(R instanceof J||R instanceof ee||R instanceof ae)&&R.populatePaintArray(t,i,c,m,g,b,C)}}setConstantPatternPositions(t){for(const i in this.binders){const c=this.binders[i];c instanceof Z&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,i,c,m,g,b,C,k){let R=!1;const z=Object.keys(t),V=z.length!==0,q=V?z:i.uniqueIds;for(const Q in this.binders){const te=this.binders[Q];if((te instanceof J||te instanceof ee||te instanceof ae)&&(te.expression.isStateDependent===!0||te.expression.isLightConstant===!1)){const oe=g.paint.get(Q);te.expression=oe.value;for(const pe of q){const _e=t[pe.toString()];i.eachPosition(pe,(ze,Ue,Ve)=>{const nt=m.feature(ze);te.updatePaintArray(Ue,Ve,nt,_e,b,C,k)})}if(!V)for(const pe of c.uniqueIds){const _e=t[pe.toString()];c.eachPosition(pe,(ze,Ue,Ve)=>{const nt=m.feature(ze);te.updatePaintArray(Ue,Ve,nt,_e,b,C,k)})}R=!0}}return R}defines(){const t=[];for(const i in this.binders){const c=this.binders[i];(c instanceof U||c instanceof Z)&&t.push(...c.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof J||c instanceof ee||c instanceof ae)for(let m=0;m<c.paintVertexAttributes.length;m++)t.push(c.paintVertexAttributes[m].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const c=this.binders[i];if(c instanceof U||c instanceof Z||c instanceof ee)for(const m of c.uniformNames)t.push(m)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const c in this.binders){const m=this.binders[c];if(m instanceof U||m instanceof Z||m instanceof ee)for(const g of m.uniformNames)i.push({name:g,property:c,binding:m.getBinding(t,g)})}return i}setUniforms(t,i,c,m,g){for(const{name:b,property:C,binding:k}of c)this.binders[C].setUniform(t,k,g,m.get(C),b)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof J||i instanceof ee||i instanceof ae)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const c=this.binders[i];(c instanceof J||c instanceof ee||c instanceof ae)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof J||i instanceof ee||i instanceof ae)&&i.destroy()}}}class we{constructor(t,i,c=()=>!0){this.programConfigurations={};for(const m of t)this.programConfigurations[m.id]=new he(m,i,c);this.needsUpload=!1,this._featureMap=new Qf,this._featureMapWithoutIds=new Qf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,i,c,m,g,b,C,k){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(t,i,m,g,b,C,k);i.id!==void 0?this._featureMap.add(i.id,c,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,c,m,g,b){for(const C of c)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,i,C,m,g,b||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const xe={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ce(r,t){return xe[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}const ge={"line-pattern":{source:Td,composite:Td},"fill-pattern":{source:Td,composite:Td},"fill-extrusion-pattern":{source:Td,composite:Td},"line-dasharray":{source:mp,composite:mp}},De={color:{source:Wf,composite:Ja},number:{source:Gf,composite:Wf}};function Xe(r,t,i){const c=ge[r];return c&&c[i]||De[t][i]}re(U,"ConstantBinder"),re(Z,"PatternConstantBinder"),re(J,"SourceExpressionBinder"),re(ae,"PatternCompositeBinder"),re(ee,"CompositeExpressionBinder"),re(he,"ProgramConfiguration",{omit:["_buffers"]}),re(we,"ProgramConfigurationSet");const Be=Jr/Math.PI/2,We=5,Pe=6,Ke=16383,st=64,pt=[st,32,16],Tt=-Be,Zt=Be;function xt(r,t,i,c=Be){return i=Et(i),[r*Math.sin(i)*c,-t*c,r*Math.cos(i)*c]}function hr(r,t,i){return xt(Math.cos(Et(r)),Math.sin(Et(r)),t,i)}const tr=63710088e-1,Cr=2*Math.PI*tr;class zt{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zt(sr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,c=this.lat*i,m=t.lat*i,g=Math.sin(c)*Math.sin(m)+Math.cos(c)*Math.cos(m)*Math.cos((t.lng-this.lng)*i);return tr*Math.acos(Math.min(g,1))}toBounds(t=0){const i=360*t/40075017,c=i/Math.cos(Math.PI/180*this.lat);return new ir({lng:this.lng-c,lat:this.lat-i},{lng:this.lng+c,lat:this.lat+i})}toEcef(t){return hr(this.lat,this.lng,Be+t*Be/tr)}static convert(t){if(t instanceof zt)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new zt(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new zt(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ir{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof zt?new zt(t.lng,t.lat):zt.convert(t),this}setSouthWest(t){return this._sw=t instanceof zt?new zt(t.lng,t.lat):zt.convert(t),this}extend(t){const i=this._sw,c=this._ne;let m,g;if(t instanceof zt)m=t,g=t;else{if(!(t instanceof ir))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(ir.convert(t)):this.extend(zt.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(zt.convert(t)):this;if(m=t._sw,g=t._ne,!m||!g)return this}return i||c?(i.lng=Math.min(m.lng,i.lng),i.lat=Math.min(m.lat,i.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new zt(m.lng,m.lat),this._ne=new zt(g.lng,g.lat)),this}getCenter(){return new zt((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new zt(this.getWest(),this.getNorth())}getSouthEast(){return new zt(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:c}=zt.convert(t);let m=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&m}static convert(t){return!t||t instanceof ir?t:new ir(t)}}var vt={};(function(r,t){(function(i){function c(g,b,C){var k=m(256*g,256*(b=Math.pow(2,C)-b-1),C),R=m(256*(g+1),256*(b+1),C);return k[0]+","+k[1]+","+R[0]+","+R[1]}function m(g,b,C){var k=2*Math.PI*6378137/256/Math.pow(2,C);return[g*k-2*Math.PI*6378137/2,b*k-2*Math.PI*6378137/2]}i.getURL=function(g,b,C,k,R,z){return z=z||{},g+"?"+["bbox="+c(C,k,R),"format="+(z.format||"image/png"),"service="+(z.service||"WMS"),"version="+(z.version||"1.1.1"),"request="+(z.request||"GetMap"),"srs="+(z.srs||"EPSG:3857"),"width="+(z.width||256),"height="+(z.height||256),"layers="+b].join("&")},i.getTileBBox=c,i.getMercCoords=m,Object.defineProperty(i,"__esModule",{value:!0})})(t)})(0,vt);var Ut=vt;class Lr{constructor(t,i,c){this.z=t,this.x=i,this.y=c,this.key=tn(0,t,t,i,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const c=Ut.getTileBBox(this.x,this.y,this.z),m=function(g,b,C){let k,R="";for(let z=g;z>0;z--)k=1<<z-1,R+=(b&k?1:0)+(C&k?2:0);return R}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Wr{constructor(t,i){this.wrap=t,this.canonical=i,this.key=tn(t,i.z,i.z,i.x,i.y)}}class Gr{constructor(t,i,c,m,g){this.overscaledZ=t,this.wrap=i,this.canonical=new Lr(c,+m,+g),this.key=i===0&&t===c?this.canonical.key:tn(i,t,c,m,g)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Gr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gr(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return tn(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return tn(this.wrap*+i,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Gr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,c=2*this.canonical.x,m=2*this.canonical.y;return[new Gr(i,this.wrap,i,c,m),new Gr(i,this.wrap,i,c+1,m),new Gr(i,this.wrap,i,c,m+1),new Gr(i,this.wrap,i,c+1,m+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Gr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Gr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Wr(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function tn(r,t,i,c,m){const g=1<<Math.min(i,22);let b=g*(m%g)+c%g;return r&&i<22&&(b+=g*g*((r<0?-2*r-1:2*r)%(1<<2*(22-i)))),16*(32*b+i)+(t-i)}const _n=[r=>{let t=r.canonical.x-1,i=r.wrap;return t<0&&(t=(1<<r.canonical.z)-1,i--),new Gr(r.overscaledZ,i,r.canonical.z,t,r.canonical.y)},r=>{let t=r.canonical.x+1,i=r.wrap;return t===1<<r.canonical.z&&(t=0,i++),new Gr(r.overscaledZ,i,r.canonical.z,t,r.canonical.y)},r=>new Gr(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,(r.canonical.y===0?1<<r.canonical.z:r.canonical.y)-1),r=>new Gr(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y===(1<<r.canonical.z)-1?0:r.canonical.y+1)];re(Lr,"CanonicalTileID"),re(Gr,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Fn=0,wn=25.5;function Sn(r){return Cr*Math.cos(r*Math.PI/180)}function Mi(r){return(180+r)/360}function pi(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Ci(r,t){return r/Sn(t)}function Ti(r){return 360*r-180}function ro(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function Ro(r,t){return r*Sn(ro(t))}const Vi=85.051129;function Zo(r){return Math.cos(Et(Ht(r,-Vi,Vi)))}function fi(r,t){const i=Ht(t,Fn,wn),c=Math.pow(2,i);return Zo(r)*Cr/(512*c)}function Ji(r){return 1/Math.cos(r*Math.PI/180)}function oi(r,t=0){const i=Math.exp(Math.PI*(1-(r.y+t/Jr)/(1<<r.z)*2));return 80150034*i/(i*i+1)/Jr/(1<<r.z)}class no{constructor(t,i,c=0){this.x=+t,this.y=+i,this.z=+c}static fromLngLat(t,i=0){const c=zt.convert(t);return new no(Mi(c.lng),pi(c.lat),Ci(i,c.lat))}toLngLat(){return new zt(Ti(this.x),ro(this.y))}toAltitude(){return Ro(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Cr*Ji(ro(this.y))}}function Bo(r,t,i,c,m,g,b,C,k){const R=(t+c)/2,z=(i+m)/2,V=new Ge(R,z);C(V),function(q,Q,te,oe,pe,_e){const ze=te-pe,Ue=oe-_e;return Math.abs((oe-Q)*ze-(te-q)*Ue)/Math.hypot(ze,Ue)}(V.x,V.y,g.x,g.y,b.x,b.y)>=k?(Bo(r,t,i,R,z,g,V,C,k),Bo(r,R,z,c,m,V,b,C,k)):r.push(b)}function ji(r,t,i){let c=r[0],m=c.x,g=c.y;t(c);const b=[c];for(let C=1;C<r.length;C++){const k=r[C],{x:R,y:z}=k;t(k),Bo(b,m,g,R,z,c,k,t,i),m=R,g=z,c=k}return b}function vs(r,t,i,c){if(c(t,i)){const m=t.add(i)._mult(.5);vs(r,t,m,c),vs(r,m,i,c)}else r.push(i)}function js(r,t){let i=r[0];const c=[i];for(let m=1;m<r.length;m++){const g=r[m];vs(c,i,g,t),i=g}return c}const ac=Math.pow(2,14)-1,bu=-ac-1;function Sl(r,t){const i=Math.round(r.x*t),c=Math.round(r.y*t);return r.x=Ht(i,bu,ac),r.y=Ht(c,bu,ac),(i<r.x||i>r.x+1||c<r.y||c>r.y+1)&&Kt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function ss(r,t,i){const c=r.loadGeometry(),m=r.extent,g=Jr/m;if(t&&i&&i.projection.isReprojectedInTileSpace){const b=1<<t.z,{scale:C,x:k,y:R,projection:z}=i,V=q=>{const Q=Ti((t.x+q.x/m)/b),te=ro((t.y+q.y/m)/b),oe=z.project(Q,te);q.x=(oe.x*C-k)*m,q.y=(oe.y*C-R)*m};for(let q=0;q<c.length;q++)if(r.type!==1)c[q]=ji(c[q],V,1);else{const Q=[];for(const te of c[q])te.x<0||te.x>=m||te.y<0||te.y>=m||(V(te),Q.push(te));c[q]=Q}}for(const b of c)for(const C of b)Sl(C,g);return c}function ls(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?ss(r):[]}}function ul(r,t,i,c,m){r.emplaceBack(2*t+(c+1)/2,2*i+(m+1)/2)}function Ps(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class Tl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new ic,this.indexArray=new Wa,this.segments=new ua,this.programConfigurations=new we(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,c,m){const g=this.layers[0],b=[];let C=null;g.type==="circle"&&(C=g.layout.get("circle-sort-key"));for(const{feature:R,id:z,index:V,sourceLayerIndex:q}of t){const Q=this.layers[0]._featureFilter.needGeometry,te=ls(R,Q);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),te,c))continue;const oe=C?C.evaluate(te,{},c):void 0,pe={id:z,properties:R.properties,type:R.type,sourceLayerIndex:q,index:V,geometry:Q?te.geometry:ss(R,c,m),patterns:{},sortKey:oe};b.push(pe)}C&&b.sort((R,z)=>R.sortKey-z.sortKey);let k=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Um,k=m.projection);for(const R of b){const{geometry:z,index:V,sourceLayerIndex:q}=R,Q=t[V].feature;this.addFeature(R,z,V,i.availableImages,c,k,i.brightness),i.featureIndex.insert(Q,z,V,q,this.index)}}update(t,i,c,m,g){const b=Object.keys(t).length!==0;b&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,b?this.stateDependentLayers:this.layers,c,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Ly.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,c,m,g,b,C){for(const k of i)for(const R of k){const z=R.x,V=R.y;if(z<0||z>=Jr||V<0||V>=Jr)continue;if(b){const te=b.projectTilePoint(z,V,g),oe=b.upVector(g,z,V),pe=this.globeExtVertexArray;Ps(pe,te,oe),Ps(pe,te,oe),Ps(pe,te,oe),Ps(pe,te,oe)}const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),Q=q.vertexLength;ul(this.layoutVertexArray,z,V,-1,-1),ul(this.layoutVertexArray,z,V,1,-1),ul(this.layoutVertexArray,z,V,1,1),ul(this.layoutVertexArray,z,V,-1,1),this.indexArray.emplaceBack(Q,Q+1,Q+2),this.indexArray.emplaceBack(Q,Q+2,Q+3),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},m,g,C)}}function wu(r,t){for(let i=0;i<r.length;i++)if(Qu(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(Qu(r,t[i]))return!0;return!!af(r,t)}function Oh(r,t,i){return!!Qu(r,t)||!!sf(t,r,i)}function gp(r,t){if(r.length===1)return Qm(t,r[0]);for(let i=0;i<t.length;i++){const c=t[i];for(let m=0;m<c.length;m++)if(Qu(r,c[m]))return!0}for(let i=0;i<r.length;i++)if(Qm(t,r[i]))return!0;for(let i=0;i<t.length;i++)if(af(r,t[i]))return!0;return!1}function of(r,t,i){if(r.length>1){if(af(r,t))return!0;for(let c=0;c<t.length;c++)if(sf(t[c],r,i))return!0}for(let c=0;c<r.length;c++)if(sf(r[c],t,i))return!0;return!1}function af(r,t){if(r.length===0||t.length===0)return!1;for(let i=0;i<r.length-1;i++){const c=r[i],m=r[i+1];for(let g=0;g<t.length-1;g++)if(Jm(c,m,t[g],t[g+1]))return!0}return!1}function Jm(r,t,i,c){return Cn(r,i,c)!==Cn(t,i,c)&&Cn(r,t,i)!==Cn(r,t,c)}function sf(r,t,i){const c=i*i;if(t.length===1)return r.distSqr(t[0])<c;for(let m=1;m<t.length;m++)if(lf(r,t[m-1],t[m])<c)return!0;return!1}function lf(r,t,i){const c=t.distSqr(i);if(c===0)return r.distSqr(t);const m=((r.x-t.x)*(i.x-t.x)+(r.y-t.y)*(i.y-t.y))/c;return r.distSqr(m<0?t:m>1?i:i.sub(t)._mult(m)._add(t))}function Qm(r,t){let i,c,m,g=!1;for(let b=0;b<r.length;b++){i=r[b];for(let C=0,k=i.length-1;C<i.length;k=C++)c=i[C],m=i[k],c.y>t.y!=m.y>t.y&&t.x<(m.x-c.x)*(t.y-c.y)/(m.y-c.y)+c.x&&(g=!g)}return g}function Qu(r,t){let i=!1;for(let c=0,m=r.length-1;c<r.length;m=c++){const g=r[c],b=r[m];g.y>t.y!=b.y>t.y&&t.x<(b.x-g.x)*(t.y-g.y)/(b.y-g.y)+g.x&&(i=!i)}return i}function L0(r,t,i,c,m){for(const b of r)if(t<=b.x&&i<=b.y&&c>=b.x&&m>=b.y)return!0;const g=[new Ge(t,i),new Ge(t,m),new Ge(c,m),new Ge(c,i)];if(r.length>2){for(const b of g)if(Qu(r,b))return!0}for(let b=0;b<r.length-1;b++)if(By(r[b],r[b+1],g))return!0;return!1}function By(r,t,i){const c=i[0],m=i[2];if(r.x<c.x&&t.x<c.x||r.x>m.x&&t.x>m.x||r.y<c.y&&t.y<c.y||r.y>m.y&&t.y>m.y)return!1;const g=Cn(r,t,i[0]);return g!==Cn(r,t,i[1])||g!==Cn(r,t,i[2])||g!==Cn(r,t,i[3])}function tm(r,t,i,c,m,g){let b=t.y-r.y,C=r.x-t.x;if(g=g||0){const k=b*b+C*C;if(k===0)return!0;const R=Math.sqrt(k);b/=R,C/=R}return!((i.x-r.x)*b+(i.y-r.y)*C-g<0||(c.x-r.x)*b+(c.y-r.y)*C-g<0||(m.x-r.x)*b+(m.y-r.y)*C-g<0)}function eg(r,t,i,c,m,g,b){return!(tm(r,t,c,m,g,b)||tm(t,i,c,m,g,b)||tm(i,r,c,m,g,b)||tm(c,m,r,t,i,b)||tm(m,g,r,t,i,b)||tm(g,c,r,t,i,b))}function _p(r,t,i){const c=t.paint.get(r).value;return c.kind==="constant"?c.value:i.programConfigurations.get(t.id).getMaxValue(r)}function rm(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function nm(r,t,i,c,m){if(!t[0]&&!t[1])return r;const g=Ge.convert(t)._mult(m);i==="viewport"&&g._rotate(-c);const b=[];for(let C=0;C<r.length;C++)b.push(r[C].sub(g));return b}function wb(r,t,i,c){const m=Ge.convert(r)._mult(c);return t==="viewport"&&m._rotate(-i),m}re(Tl,"CircleBucket",{omit:["layers"]});const jT=new go({"circle-sort-key":new an(jt.layout_circle["circle-sort-key"]),visibility:new Dr(jt.layout_circle.visibility)});var BT={paint:new go({"circle-radius":new an(jt.paint_circle["circle-radius"]),"circle-color":new an(jt.paint_circle["circle-color"]),"circle-blur":new an(jt.paint_circle["circle-blur"]),"circle-opacity":new an(jt.paint_circle["circle-opacity"]),"circle-translate":new Dr(jt.paint_circle["circle-translate"]),"circle-translate-anchor":new Dr(jt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Dr(jt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Dr(jt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new an(jt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new an(jt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new an(jt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Dr(jt.paint_circle["circle-emissive-strength"])}),layout:jT},Ha={},xs={};Object.defineProperty(xs,"__esModule",{value:!0}),xs.setMatrixArrayType=function(r){xs.ARRAY_TYPE=Fy=r},xs.toRadian=function(r){return r*Tb},xs.equals=function(r,t){return Math.abs(r-t)<=z0*Math.max(1,Math.abs(r),Math.abs(t))},xs.RANDOM=xs.ARRAY_TYPE=xs.EPSILON=void 0;var z0=1e-6;xs.EPSILON=z0;var Fy=typeof Float32Array<"u"?Float32Array:Array;xs.ARRAY_TYPE=Fy;var Sb=Math.random;xs.RANDOM=Sb;var Tb=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var ha={};function N0(r){return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N0(r)}Object.defineProperty(ha,"__esModule",{value:!0}),ha.create=function(){var r=new cf.ARRAY_TYPE(4);return cf.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},ha.clone=function(r){var t=new cf.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},ha.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},ha.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r},ha.fromValues=function(r,t,i,c){var m=new cf.ARRAY_TYPE(4);return m[0]=r,m[1]=t,m[2]=i,m[3]=c,m},ha.set=function(r,t,i,c,m){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r},ha.transpose=function(r,t){if(r===t){var i=t[1];r[1]=t[2],r[2]=i}else r[0]=t[0],r[1]=t[2],r[2]=t[1],r[3]=t[3];return r},ha.invert=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=i*g-m*c;return b?(r[0]=g*(b=1/b),r[1]=-c*b,r[2]=-m*b,r[3]=i*b,r):null},ha.adjoint=function(r,t){var i=t[0];return r[0]=t[3],r[1]=-t[1],r[2]=-t[2],r[3]=i,r},ha.determinant=function(r){return r[0]*r[3]-r[2]*r[1]},ha.multiply=Vy,ha.rotate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=Math.sin(i),k=Math.cos(i);return r[0]=c*k+g*C,r[1]=m*k+b*C,r[2]=c*-C+g*k,r[3]=m*-C+b*k,r},ha.scale=function(r,t,i){var c=t[1],m=t[2],g=t[3],b=i[0],C=i[1];return r[0]=t[0]*b,r[1]=c*b,r[2]=m*C,r[3]=g*C,r},ha.fromRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=i,r[2]=-i,r[3]=c,r},ha.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r},ha.str=function(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},ha.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},ha.LDU=function(r,t,i,c){return r[2]=c[2]/c[0],i[0]=c[0],i[1]=c[1],i[3]=c[3]-r[2]*i[1],[r,t,i]},ha.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r},ha.subtract=Eb,ha.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},ha.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=t[0],C=t[1],k=t[2],R=t[3];return Math.abs(i-b)<=cf.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-C)<=cf.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(m-k)<=cf.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(g-R)<=cf.EPSILON*Math.max(1,Math.abs(g),Math.abs(R))},ha.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r},ha.multiplyScalarAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r[3]=t[3]+i[3]*c,r},ha.sub=ha.mul=void 0;var cf=function(r,t){if(r&&r.__esModule)return r;if(r===null||N0(r)!=="object"&&typeof r!="function")return{default:r};var i=O_(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function O_(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(O_=function(c){return c?i:t})(r)}function Vy(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=i[0],k=i[1],R=i[2],z=i[3];return r[0]=c*C+g*k,r[1]=m*C+b*k,r[2]=c*R+g*z,r[3]=m*R+b*z,r}function Eb(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r}ha.mul=Vy,ha.sub=Eb;var Xo={};function im(r){return im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},im(r)}Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.create=function(){var r=new To.ARRAY_TYPE(6);return To.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r},Xo.clone=function(r){var t=new To.ARRAY_TYPE(6);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},Xo.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},Xo.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r},Xo.fromValues=function(r,t,i,c,m,g){var b=new To.ARRAY_TYPE(6);return b[0]=r,b[1]=t,b[2]=i,b[3]=c,b[4]=m,b[5]=g,b},Xo.set=function(r,t,i,c,m,g,b){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r[4]=g,r[5]=b,r},Xo.invert=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=i*g-c*m;return k?(r[0]=g*(k=1/k),r[1]=-c*k,r[2]=-m*k,r[3]=i*k,r[4]=(m*C-g*b)*k,r[5]=(c*b-i*C)*k,r):null},Xo.determinant=function(r){return r[0]*r[3]-r[1]*r[2]},Xo.multiply=Uy,Xo.rotate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=Math.sin(i),z=Math.cos(i);return r[0]=c*z+g*R,r[1]=m*z+b*R,r[2]=c*-R+g*z,r[3]=m*-R+b*z,r[4]=C,r[5]=k,r},Xo.scale=function(r,t,i){var c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=i[0],R=i[1];return r[0]=t[0]*k,r[1]=c*k,r[2]=m*R,r[3]=g*R,r[4]=b,r[5]=C,r},Xo.translate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=i[0],z=i[1];return r[0]=c,r[1]=m,r[2]=g,r[3]=b,r[4]=c*R+g*z+C,r[5]=m*R+b*z+k,r},Xo.fromRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=i,r[2]=-i,r[3]=c,r[4]=0,r[5]=0,r},Xo.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r[4]=0,r[5]=0,r},Xo.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=t[0],r[5]=t[1],r},Xo.str=function(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"},Xo.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)},Xo.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r},Xo.subtract=om,Xo.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r},Xo.multiplyScalarAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r[3]=t[3]+i[3]*c,r[4]=t[4]+i[4]*c,r[5]=t[5]+i[5]*c,r},Xo.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]},Xo.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=r[4],C=r[5],k=t[0],R=t[1],z=t[2],V=t[3],q=t[4],Q=t[5];return Math.abs(i-k)<=To.EPSILON*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(c-R)<=To.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(m-z)<=To.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(g-V)<=To.EPSILON*Math.max(1,Math.abs(g),Math.abs(V))&&Math.abs(b-q)<=To.EPSILON*Math.max(1,Math.abs(b),Math.abs(q))&&Math.abs(C-Q)<=To.EPSILON*Math.max(1,Math.abs(C),Math.abs(Q))},Xo.sub=Xo.mul=void 0;var To=function(r,t){if(r&&r.__esModule)return r;if(r===null||im(r)!=="object"&&typeof r!="function")return{default:r};var i=Ib(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function Ib(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Ib=function(c){return c?i:t})(r)}function Uy(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=i[0],z=i[1],V=i[2],q=i[3],Q=i[4],te=i[5];return r[0]=c*R+g*z,r[1]=m*R+b*z,r[2]=c*V+g*q,r[3]=m*V+b*q,r[4]=c*Q+g*te+C,r[5]=m*Q+b*te+k,r}function om(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r}Xo.mul=Uy,Xo.sub=om;var Fo={};function j0(r){return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j0(r)}Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.create=function(){var r=new Su.ARRAY_TYPE(9);return Su.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},Fo.fromMat4=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r},Fo.clone=function(r){var t=new Su.ARRAY_TYPE(9);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},Fo.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Fo.fromValues=function(r,t,i,c,m,g,b,C,k){var R=new Su.ARRAY_TYPE(9);return R[0]=r,R[1]=t,R[2]=i,R[3]=c,R[4]=m,R[5]=g,R[6]=b,R[7]=C,R[8]=k,R},Fo.set=function(r,t,i,c,m,g,b,C,k,R){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r[4]=g,r[5]=b,r[6]=C,r[7]=k,r[8]=R,r},Fo.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Fo.transpose=function(r,t){if(r===t){var i=t[1],c=t[2],m=t[5];r[1]=t[3],r[2]=t[6],r[3]=i,r[5]=t[7],r[6]=c,r[7]=m}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r},Fo.invert=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=t[6],R=t[7],z=t[8],V=z*b-C*R,q=-z*g+C*k,Q=R*g-b*k,te=i*V+c*q+m*Q;return te?(r[0]=V*(te=1/te),r[1]=(-z*c+m*R)*te,r[2]=(C*c-m*b)*te,r[3]=q*te,r[4]=(z*i-m*k)*te,r[5]=(-C*i+m*g)*te,r[6]=Q*te,r[7]=(-R*i+c*k)*te,r[8]=(b*i-c*g)*te,r):null},Fo.adjoint=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=t[6],R=t[7],z=t[8];return r[0]=b*z-C*R,r[1]=m*R-c*z,r[2]=c*C-m*b,r[3]=C*k-g*z,r[4]=i*z-m*k,r[5]=m*g-i*C,r[6]=g*R-b*k,r[7]=c*k-i*R,r[8]=i*b-c*g,r},Fo.determinant=function(r){var t=r[3],i=r[4],c=r[5],m=r[6],g=r[7],b=r[8];return r[0]*(b*i-c*g)+r[1]*(-b*t+c*m)+r[2]*(g*t-i*m)},Fo.multiply=Ab,Fo.translate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=t[8],q=i[0],Q=i[1];return r[0]=c,r[1]=m,r[2]=g,r[3]=b,r[4]=C,r[5]=k,r[6]=q*c+Q*b+R,r[7]=q*m+Q*C+z,r[8]=q*g+Q*k+V,r},Fo.rotate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=t[8],q=Math.sin(i),Q=Math.cos(i);return r[0]=Q*c+q*b,r[1]=Q*m+q*C,r[2]=Q*g+q*k,r[3]=Q*b-q*c,r[4]=Q*C-q*m,r[5]=Q*k-q*g,r[6]=R,r[7]=z,r[8]=V,r},Fo.scale=function(r,t,i){var c=i[0],m=i[1];return r[0]=c*t[0],r[1]=c*t[1],r[2]=c*t[2],r[3]=m*t[3],r[4]=m*t[4],r[5]=m*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Fo.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=t[0],r[7]=t[1],r[8]=1,r},Fo.fromRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=i,r[2]=0,r[3]=-i,r[4]=c,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Fo.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=t[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Fo.fromMat2d=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=0,r[3]=t[2],r[4]=t[3],r[5]=0,r[6]=t[4],r[7]=t[5],r[8]=1,r},Fo.fromQuat=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=i+i,C=c+c,k=m+m,R=i*b,z=c*b,V=c*C,q=m*b,Q=m*C,te=m*k,oe=g*b,pe=g*C,_e=g*k;return r[0]=1-V-te,r[3]=z-_e,r[6]=q+pe,r[1]=z+_e,r[4]=1-R-te,r[7]=Q-oe,r[2]=q-pe,r[5]=Q+oe,r[8]=1-R-V,r},Fo.normalFromMat4=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=t[6],R=t[7],z=t[8],V=t[9],q=t[10],Q=t[11],te=t[12],oe=t[13],pe=t[14],_e=t[15],ze=i*C-c*b,Ue=i*k-m*b,Ve=i*R-g*b,nt=c*k-m*C,Qe=c*R-g*C,gt=m*R-g*k,At=z*oe-V*te,Bt=z*pe-q*te,Yt=z*_e-Q*te,Ft=V*pe-q*oe,_r=V*_e-Q*oe,Pr=q*_e-Q*pe,dr=ze*Pr-Ue*_r+Ve*Ft+nt*Yt-Qe*Bt+gt*At;return dr?(r[0]=(C*Pr-k*_r+R*Ft)*(dr=1/dr),r[1]=(k*Yt-b*Pr-R*Bt)*dr,r[2]=(b*_r-C*Yt+R*At)*dr,r[3]=(m*_r-c*Pr-g*Ft)*dr,r[4]=(i*Pr-m*Yt+g*Bt)*dr,r[5]=(c*Yt-i*_r-g*At)*dr,r[6]=(oe*gt-pe*Qe+_e*nt)*dr,r[7]=(pe*Ve-te*gt-_e*Ue)*dr,r[8]=(te*Qe-oe*Ve+_e*ze)*dr,r):null},Fo.projection=function(r,t,i){return r[0]=2/t,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/i,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r},Fo.str=function(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"},Fo.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},Fo.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r[8]=t[8]+i[8],r},Fo.subtract=Pb,Fo.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*i,r},Fo.multiplyScalarAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r[3]=t[3]+i[3]*c,r[4]=t[4]+i[4]*c,r[5]=t[5]+i[5]*c,r[6]=t[6]+i[6]*c,r[7]=t[7]+i[7]*c,r[8]=t[8]+i[8]*c,r},Fo.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]},Fo.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=r[4],C=r[5],k=r[6],R=r[7],z=r[8],V=t[0],q=t[1],Q=t[2],te=t[3],oe=t[4],pe=t[5],_e=t[6],ze=t[7],Ue=t[8];return Math.abs(i-V)<=Su.EPSILON*Math.max(1,Math.abs(i),Math.abs(V))&&Math.abs(c-q)<=Su.EPSILON*Math.max(1,Math.abs(c),Math.abs(q))&&Math.abs(m-Q)<=Su.EPSILON*Math.max(1,Math.abs(m),Math.abs(Q))&&Math.abs(g-te)<=Su.EPSILON*Math.max(1,Math.abs(g),Math.abs(te))&&Math.abs(b-oe)<=Su.EPSILON*Math.max(1,Math.abs(b),Math.abs(oe))&&Math.abs(C-pe)<=Su.EPSILON*Math.max(1,Math.abs(C),Math.abs(pe))&&Math.abs(k-_e)<=Su.EPSILON*Math.max(1,Math.abs(k),Math.abs(_e))&&Math.abs(R-ze)<=Su.EPSILON*Math.max(1,Math.abs(R),Math.abs(ze))&&Math.abs(z-Ue)<=Su.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ue))},Fo.sub=Fo.mul=void 0;var Su=function(r,t){if(r&&r.__esModule)return r;if(r===null||j0(r)!=="object"&&typeof r!="function")return{default:r};var i=Cb(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function Cb(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Cb=function(c){return c?i:t})(r)}function Ab(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=t[8],q=i[0],Q=i[1],te=i[2],oe=i[3],pe=i[4],_e=i[5],ze=i[6],Ue=i[7],Ve=i[8];return r[0]=q*c+Q*b+te*R,r[1]=q*m+Q*C+te*z,r[2]=q*g+Q*k+te*V,r[3]=oe*c+pe*b+_e*R,r[4]=oe*m+pe*C+_e*z,r[5]=oe*g+pe*k+_e*V,r[6]=ze*c+Ue*b+Ve*R,r[7]=ze*m+Ue*C+Ve*z,r[8]=ze*g+Ue*k+Ve*V,r}function Pb(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r[6]=t[6]-i[6],r[7]=t[7]-i[7],r[8]=t[8]-i[8],r}Fo.mul=Ab,Fo.sub=Pb;var Ui={};function $y(r){return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$y(r)}Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.create=function(){var r=new Ma.ARRAY_TYPE(16);return Ma.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},Ui.clone=function(r){var t=new Ma.ARRAY_TYPE(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},Ui.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},Ui.fromValues=function(r,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe){var pe=new Ma.ARRAY_TYPE(16);return pe[0]=r,pe[1]=t,pe[2]=i,pe[3]=c,pe[4]=m,pe[5]=g,pe[6]=b,pe[7]=C,pe[8]=k,pe[9]=R,pe[10]=z,pe[11]=V,pe[12]=q,pe[13]=Q,pe[14]=te,pe[15]=oe,pe},Ui.set=function(r,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r[4]=g,r[5]=b,r[6]=C,r[7]=k,r[8]=R,r[9]=z,r[10]=V,r[11]=q,r[12]=Q,r[13]=te,r[14]=oe,r[15]=pe,r},Ui.identity=F0,Ui.transpose=function(r,t){if(r===t){var i=t[1],c=t[2],m=t[3],g=t[6],b=t[7],C=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=i,r[6]=t[9],r[7]=t[13],r[8]=c,r[9]=g,r[11]=t[14],r[12]=m,r[13]=b,r[14]=C}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r},Ui.invert=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=t[6],R=t[7],z=t[8],V=t[9],q=t[10],Q=t[11],te=t[12],oe=t[13],pe=t[14],_e=t[15],ze=i*C-c*b,Ue=i*k-m*b,Ve=i*R-g*b,nt=c*k-m*C,Qe=c*R-g*C,gt=m*R-g*k,At=z*oe-V*te,Bt=z*pe-q*te,Yt=z*_e-Q*te,Ft=V*pe-q*oe,_r=V*_e-Q*oe,Pr=q*_e-Q*pe,dr=ze*Pr-Ue*_r+Ve*Ft+nt*Yt-Qe*Bt+gt*At;return dr?(r[0]=(C*Pr-k*_r+R*Ft)*(dr=1/dr),r[1]=(m*_r-c*Pr-g*Ft)*dr,r[2]=(oe*gt-pe*Qe+_e*nt)*dr,r[3]=(q*Qe-V*gt-Q*nt)*dr,r[4]=(k*Yt-b*Pr-R*Bt)*dr,r[5]=(i*Pr-m*Yt+g*Bt)*dr,r[6]=(pe*Ve-te*gt-_e*Ue)*dr,r[7]=(z*gt-q*Ve+Q*Ue)*dr,r[8]=(b*_r-C*Yt+R*At)*dr,r[9]=(c*Yt-i*_r-g*At)*dr,r[10]=(te*Qe-oe*Ve+_e*ze)*dr,r[11]=(V*Ve-z*Qe-Q*ze)*dr,r[12]=(C*Bt-b*Ft-k*At)*dr,r[13]=(i*Ft-c*Bt+m*At)*dr,r[14]=(oe*Ue-te*nt-pe*ze)*dr,r[15]=(z*nt-V*Ue+q*ze)*dr,r):null},Ui.adjoint=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=t[4],C=t[5],k=t[6],R=t[7],z=t[8],V=t[9],q=t[10],Q=t[11],te=t[12],oe=t[13],pe=t[14],_e=t[15];return r[0]=C*(q*_e-Q*pe)-V*(k*_e-R*pe)+oe*(k*Q-R*q),r[1]=-(c*(q*_e-Q*pe)-V*(m*_e-g*pe)+oe*(m*Q-g*q)),r[2]=c*(k*_e-R*pe)-C*(m*_e-g*pe)+oe*(m*R-g*k),r[3]=-(c*(k*Q-R*q)-C*(m*Q-g*q)+V*(m*R-g*k)),r[4]=-(b*(q*_e-Q*pe)-z*(k*_e-R*pe)+te*(k*Q-R*q)),r[5]=i*(q*_e-Q*pe)-z*(m*_e-g*pe)+te*(m*Q-g*q),r[6]=-(i*(k*_e-R*pe)-b*(m*_e-g*pe)+te*(m*R-g*k)),r[7]=i*(k*Q-R*q)-b*(m*Q-g*q)+z*(m*R-g*k),r[8]=b*(V*_e-Q*oe)-z*(C*_e-R*oe)+te*(C*Q-R*V),r[9]=-(i*(V*_e-Q*oe)-z*(c*_e-g*oe)+te*(c*Q-g*V)),r[10]=i*(C*_e-R*oe)-b*(c*_e-g*oe)+te*(c*R-g*C),r[11]=-(i*(C*Q-R*V)-b*(c*Q-g*V)+z*(c*R-g*C)),r[12]=-(b*(V*pe-q*oe)-z*(C*pe-k*oe)+te*(C*q-k*V)),r[13]=i*(V*pe-q*oe)-z*(c*pe-m*oe)+te*(c*q-m*V),r[14]=-(i*(C*pe-k*oe)-b*(c*pe-m*oe)+te*(c*k-m*C)),r[15]=i*(C*q-k*V)-b*(c*q-m*V)+z*(c*k-m*C),r},Ui.determinant=function(r){var t=r[0],i=r[1],c=r[2],m=r[3],g=r[4],b=r[5],C=r[6],k=r[7],R=r[8],z=r[9],V=r[10],q=r[11],Q=r[12],te=r[13],oe=r[14],pe=r[15];return(t*b-i*g)*(V*pe-q*oe)-(t*C-c*g)*(z*pe-q*te)+(t*k-m*g)*(z*oe-V*te)+(i*C-c*b)*(R*pe-q*Q)-(i*k-m*b)*(R*oe-V*Q)+(c*k-m*C)*(R*te-z*Q)},Ui.multiply=L_,Ui.translate=function(r,t,i){var c,m,g,b,C,k,R,z,V,q,Q,te,oe=i[0],pe=i[1],_e=i[2];return t===r?(r[12]=t[0]*oe+t[4]*pe+t[8]*_e+t[12],r[13]=t[1]*oe+t[5]*pe+t[9]*_e+t[13],r[14]=t[2]*oe+t[6]*pe+t[10]*_e+t[14],r[15]=t[3]*oe+t[7]*pe+t[11]*_e+t[15]):(m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=t[8],q=t[9],Q=t[10],te=t[11],r[0]=c=t[0],r[1]=m,r[2]=g,r[3]=b,r[4]=C,r[5]=k,r[6]=R,r[7]=z,r[8]=V,r[9]=q,r[10]=Q,r[11]=te,r[12]=c*oe+C*pe+V*_e+t[12],r[13]=m*oe+k*pe+q*_e+t[13],r[14]=g*oe+R*pe+Q*_e+t[14],r[15]=b*oe+z*pe+te*_e+t[15]),r},Ui.scale=function(r,t,i){var c=i[0],m=i[1],g=i[2];return r[0]=t[0]*c,r[1]=t[1]*c,r[2]=t[2]*c,r[3]=t[3]*c,r[4]=t[4]*m,r[5]=t[5]*m,r[6]=t[6]*m,r[7]=t[7]*m,r[8]=t[8]*g,r[9]=t[9]*g,r[10]=t[10]*g,r[11]=t[11]*g,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},Ui.rotate=function(r,t,i,c){var m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e,ze,Ue,Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r=c[0],Pr=c[1],dr=c[2],Er=Math.hypot(_r,Pr,dr);return Er<Ma.EPSILON?null:(_r*=Er=1/Er,Pr*=Er,dr*=Er,m=Math.sin(i),g=Math.cos(i),k=t[1],R=t[2],z=t[3],q=t[5],Q=t[6],te=t[7],pe=t[9],_e=t[10],ze=t[11],Ue=_r*_r*(b=1-g)+g,Qe=_r*Pr*b-dr*m,gt=Pr*Pr*b+g,At=dr*Pr*b+_r*m,Bt=_r*dr*b+Pr*m,Yt=Pr*dr*b-_r*m,Ft=dr*dr*b+g,r[0]=(C=t[0])*Ue+(V=t[4])*(Ve=Pr*_r*b+dr*m)+(oe=t[8])*(nt=dr*_r*b-Pr*m),r[1]=k*Ue+q*Ve+pe*nt,r[2]=R*Ue+Q*Ve+_e*nt,r[3]=z*Ue+te*Ve+ze*nt,r[4]=C*Qe+V*gt+oe*At,r[5]=k*Qe+q*gt+pe*At,r[6]=R*Qe+Q*gt+_e*At,r[7]=z*Qe+te*gt+ze*At,r[8]=C*Bt+V*Yt+oe*Ft,r[9]=k*Bt+q*Yt+pe*Ft,r[10]=R*Bt+Q*Yt+_e*Ft,r[11]=z*Bt+te*Yt+ze*Ft,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)},Ui.rotateX=function(r,t,i){var c=Math.sin(i),m=Math.cos(i),g=t[4],b=t[5],C=t[6],k=t[7],R=t[8],z=t[9],V=t[10],q=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=g*m+R*c,r[5]=b*m+z*c,r[6]=C*m+V*c,r[7]=k*m+q*c,r[8]=R*m-g*c,r[9]=z*m-b*c,r[10]=V*m-C*c,r[11]=q*m-k*c,r},Ui.rotateY=function(r,t,i){var c=Math.sin(i),m=Math.cos(i),g=t[0],b=t[1],C=t[2],k=t[3],R=t[8],z=t[9],V=t[10],q=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*m-R*c,r[1]=b*m-z*c,r[2]=C*m-V*c,r[3]=k*m-q*c,r[8]=g*c+R*m,r[9]=b*c+z*m,r[10]=C*c+V*m,r[11]=k*c+q*m,r},Ui.rotateZ=function(r,t,i){var c=Math.sin(i),m=Math.cos(i),g=t[0],b=t[1],C=t[2],k=t[3],R=t[4],z=t[5],V=t[6],q=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*m+R*c,r[1]=b*m+z*c,r[2]=C*m+V*c,r[3]=k*m+q*c,r[4]=R*m-g*c,r[5]=z*m-b*c,r[6]=V*m-C*c,r[7]=q*m-k*c,r},Ui.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},Ui.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Ui.fromRotation=function(r,t,i){var c,m,g,b=i[0],C=i[1],k=i[2],R=Math.hypot(b,C,k);return R<Ma.EPSILON?null:(b*=R=1/R,C*=R,k*=R,c=Math.sin(t),m=Math.cos(t),r[0]=b*b*(g=1-m)+m,r[1]=C*b*g+k*c,r[2]=k*b*g-C*c,r[3]=0,r[4]=b*C*g-k*c,r[5]=C*C*g+m,r[6]=k*C*g+b*c,r[7]=0,r[8]=b*k*g+C*c,r[9]=C*k*g-b*c,r[10]=k*k*g+m,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)},Ui.fromXRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=c,r[6]=i,r[7]=0,r[8]=0,r[9]=-i,r[10]=c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Ui.fromYRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=0,r[2]=-i,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=0,r[10]=c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Ui.fromZRotation=function(r,t){var i=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=i,r[2]=0,r[3]=0,r[4]=-i,r[5]=c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Ui.fromRotationTranslation=uf,Ui.fromQuat2=function(r,t){var i=new Ma.ARRAY_TYPE(3),c=-t[0],m=-t[1],g=-t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=c*c+m*m+g*g+b*b;return V>0?(i[0]=2*(C*b+z*c+k*g-R*m)/V,i[1]=2*(k*b+z*m+R*c-C*g)/V,i[2]=2*(R*b+z*g+C*m-k*c)/V):(i[0]=2*(C*b+z*c+k*g-R*m),i[1]=2*(k*b+z*m+R*c-C*g),i[2]=2*(R*b+z*g+C*m-k*c)),uf(r,t,i),r},Ui.getTranslation=function(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r},Ui.getScaling=Gy,Ui.getRotation=function(r,t){var i=new Ma.ARRAY_TYPE(3);Gy(i,t);var c=1/i[0],m=1/i[1],g=1/i[2],b=t[0]*c,C=t[1]*m,k=t[2]*g,R=t[4]*c,z=t[5]*m,V=t[6]*g,q=t[8]*c,Q=t[9]*m,te=t[10]*g,oe=b+z+te,pe=0;return oe>0?(pe=2*Math.sqrt(oe+1),r[3]=.25*pe,r[0]=(V-Q)/pe,r[1]=(q-k)/pe,r[2]=(C-R)/pe):b>z&&b>te?(pe=2*Math.sqrt(1+b-z-te),r[3]=(V-Q)/pe,r[0]=.25*pe,r[1]=(C+R)/pe,r[2]=(q+k)/pe):z>te?(pe=2*Math.sqrt(1+z-b-te),r[3]=(q-k)/pe,r[0]=(C+R)/pe,r[1]=.25*pe,r[2]=(V+Q)/pe):(pe=2*Math.sqrt(1+te-b-z),r[3]=(C-R)/pe,r[0]=(q+k)/pe,r[1]=(V+Q)/pe,r[2]=.25*pe),r},Ui.fromRotationTranslationScale=function(r,t,i,c){var m=t[0],g=t[1],b=t[2],C=t[3],k=m+m,R=g+g,z=b+b,V=m*k,q=m*R,Q=m*z,te=g*R,oe=g*z,pe=b*z,_e=C*k,ze=C*R,Ue=C*z,Ve=c[0],nt=c[1],Qe=c[2];return r[0]=(1-(te+pe))*Ve,r[1]=(q+Ue)*Ve,r[2]=(Q-ze)*Ve,r[3]=0,r[4]=(q-Ue)*nt,r[5]=(1-(V+pe))*nt,r[6]=(oe+_e)*nt,r[7]=0,r[8]=(Q+ze)*Qe,r[9]=(oe-_e)*Qe,r[10]=(1-(V+te))*Qe,r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r},Ui.fromRotationTranslationScaleOrigin=function(r,t,i,c,m){var g=t[0],b=t[1],C=t[2],k=t[3],R=g+g,z=b+b,V=C+C,q=g*R,Q=g*z,te=g*V,oe=b*z,pe=b*V,_e=C*V,ze=k*R,Ue=k*z,Ve=k*V,nt=c[0],Qe=c[1],gt=c[2],At=m[0],Bt=m[1],Yt=m[2],Ft=(1-(oe+_e))*nt,_r=(Q+Ve)*nt,Pr=(te-Ue)*nt,dr=(Q-Ve)*Qe,Er=(1-(q+_e))*Qe,lr=(pe+ze)*Qe,Sr=(te+Ue)*gt,Yr=(pe-ze)*gt,kr=(1-(q+oe))*gt;return r[0]=Ft,r[1]=_r,r[2]=Pr,r[3]=0,r[4]=dr,r[5]=Er,r[6]=lr,r[7]=0,r[8]=Sr,r[9]=Yr,r[10]=kr,r[11]=0,r[12]=i[0]+At-(Ft*At+dr*Bt+Sr*Yt),r[13]=i[1]+Bt-(_r*At+Er*Bt+Yr*Yt),r[14]=i[2]+Yt-(Pr*At+lr*Bt+kr*Yt),r[15]=1,r},Ui.fromQuat=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=i+i,C=c+c,k=m+m,R=i*b,z=c*b,V=c*C,q=m*b,Q=m*C,te=m*k,oe=g*b,pe=g*C,_e=g*k;return r[0]=1-V-te,r[1]=z+_e,r[2]=q-pe,r[3]=0,r[4]=z-_e,r[5]=1-R-te,r[6]=Q+oe,r[7]=0,r[8]=q+pe,r[9]=Q-oe,r[10]=1-R-V,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Ui.frustum=function(r,t,i,c,m,g,b){var C=1/(i-t),k=1/(m-c),R=1/(g-b);return r[0]=2*g*C,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*g*k,r[6]=0,r[7]=0,r[8]=(i+t)*C,r[9]=(m+c)*k,r[10]=(b+g)*R,r[11]=-1,r[12]=0,r[13]=0,r[14]=b*g*2*R,r[15]=0,r},Ui.perspectiveNO=am,Ui.perspectiveZO=function(r,t,i,c,m){var g,b=1/Math.tan(t/2);return r[0]=b/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,m!=null&&m!==1/0?(r[10]=m*(g=1/(c-m)),r[14]=m*c*g):(r[10]=-1,r[14]=-c),r},Ui.perspectiveFromFieldOfView=function(r,t,i,c){var m=Math.tan(t.upDegrees*Math.PI/180),g=Math.tan(t.downDegrees*Math.PI/180),b=Math.tan(t.leftDegrees*Math.PI/180),C=Math.tan(t.rightDegrees*Math.PI/180),k=2/(b+C),R=2/(m+g);return r[0]=k,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=R,r[6]=0,r[7]=0,r[8]=-(b-C)*k*.5,r[9]=(m-g)*R*.5,r[10]=c/(i-c),r[11]=-1,r[12]=0,r[13]=0,r[14]=c*i/(i-c),r[15]=0,r},Ui.orthoNO=V0,Ui.orthoZO=function(r,t,i,c,m,g,b){var C=1/(t-i),k=1/(c-m),R=1/(g-b);return r[0]=-2*C,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*k,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=R,r[11]=0,r[12]=(t+i)*C,r[13]=(m+c)*k,r[14]=g*R,r[15]=1,r},Ui.lookAt=function(r,t,i,c){var m,g,b,C,k,R,z,V,q,Q,te=t[0],oe=t[1],pe=t[2],_e=c[0],ze=c[1],Ue=c[2],Ve=i[0],nt=i[1],Qe=i[2];return Math.abs(te-Ve)<Ma.EPSILON&&Math.abs(oe-nt)<Ma.EPSILON&&Math.abs(pe-Qe)<Ma.EPSILON?F0(r):(z=te-Ve,V=oe-nt,q=pe-Qe,m=ze*(q*=Q=1/Math.hypot(z,V,q))-Ue*(V*=Q),g=Ue*(z*=Q)-_e*q,b=_e*V-ze*z,(Q=Math.hypot(m,g,b))?(m*=Q=1/Q,g*=Q,b*=Q):(m=0,g=0,b=0),C=V*b-q*g,k=q*m-z*b,R=z*g-V*m,(Q=Math.hypot(C,k,R))?(C*=Q=1/Q,k*=Q,R*=Q):(C=0,k=0,R=0),r[0]=m,r[1]=C,r[2]=z,r[3]=0,r[4]=g,r[5]=k,r[6]=V,r[7]=0,r[8]=b,r[9]=R,r[10]=q,r[11]=0,r[12]=-(m*te+g*oe+b*pe),r[13]=-(C*te+k*oe+R*pe),r[14]=-(z*te+V*oe+q*pe),r[15]=1,r)},Ui.targetTo=function(r,t,i,c){var m=t[0],g=t[1],b=t[2],C=c[0],k=c[1],R=c[2],z=m-i[0],V=g-i[1],q=b-i[2],Q=z*z+V*V+q*q;Q>0&&(z*=Q=1/Math.sqrt(Q),V*=Q,q*=Q);var te=k*q-R*V,oe=R*z-C*q,pe=C*V-k*z;return(Q=te*te+oe*oe+pe*pe)>0&&(te*=Q=1/Math.sqrt(Q),oe*=Q,pe*=Q),r[0]=te,r[1]=oe,r[2]=pe,r[3]=0,r[4]=V*pe-q*oe,r[5]=q*te-z*pe,r[6]=z*oe-V*te,r[7]=0,r[8]=z,r[9]=V,r[10]=q,r[11]=0,r[12]=m,r[13]=g,r[14]=b,r[15]=1,r},Ui.str=function(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"},Ui.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])},Ui.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r[8]=t[8]+i[8],r[9]=t[9]+i[9],r[10]=t[10]+i[10],r[11]=t[11]+i[11],r[12]=t[12]+i[12],r[13]=t[13]+i[13],r[14]=t[14]+i[14],r[15]=t[15]+i[15],r},Ui.subtract=cs,Ui.multiplyScalar=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r[8]=t[8]*i,r[9]=t[9]*i,r[10]=t[10]*i,r[11]=t[11]*i,r[12]=t[12]*i,r[13]=t[13]*i,r[14]=t[14]*i,r[15]=t[15]*i,r},Ui.multiplyScalarAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r[3]=t[3]+i[3]*c,r[4]=t[4]+i[4]*c,r[5]=t[5]+i[5]*c,r[6]=t[6]+i[6]*c,r[7]=t[7]+i[7]*c,r[8]=t[8]+i[8]*c,r[9]=t[9]+i[9]*c,r[10]=t[10]+i[10]*c,r[11]=t[11]+i[11]*c,r[12]=t[12]+i[12]*c,r[13]=t[13]+i[13]*c,r[14]=t[14]+i[14]*c,r[15]=t[15]+i[15]*c,r},Ui.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},Ui.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=r[4],C=r[5],k=r[6],R=r[7],z=r[8],V=r[9],q=r[10],Q=r[11],te=r[12],oe=r[13],pe=r[14],_e=r[15],ze=t[0],Ue=t[1],Ve=t[2],nt=t[3],Qe=t[4],gt=t[5],At=t[6],Bt=t[7],Yt=t[8],Ft=t[9],_r=t[10],Pr=t[11],dr=t[12],Er=t[13],lr=t[14],Sr=t[15];return Math.abs(i-ze)<=Ma.EPSILON*Math.max(1,Math.abs(i),Math.abs(ze))&&Math.abs(c-Ue)<=Ma.EPSILON*Math.max(1,Math.abs(c),Math.abs(Ue))&&Math.abs(m-Ve)<=Ma.EPSILON*Math.max(1,Math.abs(m),Math.abs(Ve))&&Math.abs(g-nt)<=Ma.EPSILON*Math.max(1,Math.abs(g),Math.abs(nt))&&Math.abs(b-Qe)<=Ma.EPSILON*Math.max(1,Math.abs(b),Math.abs(Qe))&&Math.abs(C-gt)<=Ma.EPSILON*Math.max(1,Math.abs(C),Math.abs(gt))&&Math.abs(k-At)<=Ma.EPSILON*Math.max(1,Math.abs(k),Math.abs(At))&&Math.abs(R-Bt)<=Ma.EPSILON*Math.max(1,Math.abs(R),Math.abs(Bt))&&Math.abs(z-Yt)<=Ma.EPSILON*Math.max(1,Math.abs(z),Math.abs(Yt))&&Math.abs(V-Ft)<=Ma.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ft))&&Math.abs(q-_r)<=Ma.EPSILON*Math.max(1,Math.abs(q),Math.abs(_r))&&Math.abs(Q-Pr)<=Ma.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Pr))&&Math.abs(te-dr)<=Ma.EPSILON*Math.max(1,Math.abs(te),Math.abs(dr))&&Math.abs(oe-Er)<=Ma.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Er))&&Math.abs(pe-lr)<=Ma.EPSILON*Math.max(1,Math.abs(pe),Math.abs(lr))&&Math.abs(_e-Sr)<=Ma.EPSILON*Math.max(1,Math.abs(_e),Math.abs(Sr))},Ui.sub=Ui.mul=Ui.ortho=Ui.perspective=void 0;var Ma=function(r,t){if(r&&r.__esModule)return r;if(r===null||$y(r)!=="object"&&typeof r!="function")return{default:r};var i=B0(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function B0(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(B0=function(c){return c?i:t})(r)}function F0(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function L_(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=t[8],q=t[9],Q=t[10],te=t[11],oe=t[12],pe=t[13],_e=t[14],ze=t[15],Ue=i[0],Ve=i[1],nt=i[2],Qe=i[3];return r[0]=Ue*c+Ve*C+nt*V+Qe*oe,r[1]=Ue*m+Ve*k+nt*q+Qe*pe,r[2]=Ue*g+Ve*R+nt*Q+Qe*_e,r[3]=Ue*b+Ve*z+nt*te+Qe*ze,r[4]=(Ue=i[4])*c+(Ve=i[5])*C+(nt=i[6])*V+(Qe=i[7])*oe,r[5]=Ue*m+Ve*k+nt*q+Qe*pe,r[6]=Ue*g+Ve*R+nt*Q+Qe*_e,r[7]=Ue*b+Ve*z+nt*te+Qe*ze,r[8]=(Ue=i[8])*c+(Ve=i[9])*C+(nt=i[10])*V+(Qe=i[11])*oe,r[9]=Ue*m+Ve*k+nt*q+Qe*pe,r[10]=Ue*g+Ve*R+nt*Q+Qe*_e,r[11]=Ue*b+Ve*z+nt*te+Qe*ze,r[12]=(Ue=i[12])*c+(Ve=i[13])*C+(nt=i[14])*V+(Qe=i[15])*oe,r[13]=Ue*m+Ve*k+nt*q+Qe*pe,r[14]=Ue*g+Ve*R+nt*Q+Qe*_e,r[15]=Ue*b+Ve*z+nt*te+Qe*ze,r}function uf(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=c+c,k=m+m,R=g+g,z=c*C,V=c*k,q=c*R,Q=m*k,te=m*R,oe=g*R,pe=b*C,_e=b*k,ze=b*R;return r[0]=1-(Q+oe),r[1]=V+ze,r[2]=q-_e,r[3]=0,r[4]=V-ze,r[5]=1-(z+oe),r[6]=te+pe,r[7]=0,r[8]=q+_e,r[9]=te-pe,r[10]=1-(z+Q),r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function Gy(r,t){var i=t[4],c=t[5],m=t[6],g=t[8],b=t[9],C=t[10];return r[0]=Math.hypot(t[0],t[1],t[2]),r[1]=Math.hypot(i,c,m),r[2]=Math.hypot(g,b,C),r}function am(r,t,i,c,m){var g,b=1/Math.tan(t/2);return r[0]=b/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,m!=null&&m!==1/0?(r[10]=(m+c)*(g=1/(c-m)),r[14]=2*m*c*g):(r[10]=-1,r[14]=-2*c),r}function V0(r,t,i,c,m,g,b){var C=1/(t-i),k=1/(c-m),R=1/(g-b);return r[0]=-2*C,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*k,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*R,r[11]=0,r[12]=(t+i)*C,r[13]=(m+c)*k,r[14]=(b+g)*R,r[15]=1,r}function cs(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r[4]=t[4]-i[4],r[5]=t[5]-i[5],r[6]=t[6]-i[6],r[7]=t[7]-i[7],r[8]=t[8]-i[8],r[9]=t[9]-i[9],r[10]=t[10]-i[10],r[11]=t[11]-i[11],r[12]=t[12]-i[12],r[13]=t[13]-i[13],r[14]=t[14]-i[14],r[15]=t[15]-i[15],r}Ui.perspective=am,Ui.ortho=V0,Ui.mul=L_,Ui.sub=cs;var Pn={},ki={};function qy(r){return qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qy(r)}Object.defineProperty(ki,"__esModule",{value:!0}),ki.create=$0,ki.clone=function(r){var t=new Md.ARRAY_TYPE(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},ki.length=Wy,ki.fromValues=function(r,t,i){var c=new Md.ARRAY_TYPE(3);return c[0]=r,c[1]=t,c[2]=i,c},ki.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},ki.set=function(r,t,i,c){return r[0]=t,r[1]=i,r[2]=c,r},ki.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r},ki.subtract=hf,ki.multiply=df,ki.divide=G0,ki.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r},ki.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r},ki.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r},ki.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.max(t[2],i[2]),r},ki.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r},ki.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r},ki.scaleAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r},ki.distance=us,ki.squaredDistance=tg,ki.squaredLength=kd,ki.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r},ki.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r},ki.normalize=function(r,t){var i=t[0],c=t[1],m=t[2],g=i*i+c*c+m*m;return g>0&&(g=1/Math.sqrt(g)),r[0]=t[0]*g,r[1]=t[1]*g,r[2]=t[2]*g,r},ki.dot=z_,ki.cross=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=i[0],C=i[1],k=i[2];return r[0]=m*k-g*C,r[1]=g*b-c*k,r[2]=c*C-m*b,r},ki.lerp=function(r,t,i,c){var m=t[0],g=t[1],b=t[2];return r[0]=m+c*(i[0]-m),r[1]=g+c*(i[1]-g),r[2]=b+c*(i[2]-b),r},ki.hermite=function(r,t,i,c,m,g){var b=g*g,C=b*(2*g-3)+1,k=b*(g-2)+g,R=b*(g-1),z=b*(3-2*g);return r[0]=t[0]*C+i[0]*k+c[0]*R+m[0]*z,r[1]=t[1]*C+i[1]*k+c[1]*R+m[1]*z,r[2]=t[2]*C+i[2]*k+c[2]*R+m[2]*z,r},ki.bezier=function(r,t,i,c,m,g){var b=1-g,C=b*b,k=g*g,R=C*b,z=3*g*C,V=3*k*b,q=k*g;return r[0]=t[0]*R+i[0]*z+c[0]*V+m[0]*q,r[1]=t[1]*R+i[1]*z+c[1]*V+m[1]*q,r[2]=t[2]*R+i[2]*z+c[2]*V+m[2]*q,r},ki.random=function(r,t){t=t||1;var i=2*Md.RANDOM()*Math.PI,c=2*Md.RANDOM()-1,m=Math.sqrt(1-c*c)*t;return r[0]=Math.cos(i)*m,r[1]=Math.sin(i)*m,r[2]=c*t,r},ki.transformMat4=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=i[3]*c+i[7]*m+i[11]*g+i[15];return r[0]=(i[0]*c+i[4]*m+i[8]*g+i[12])/(b=b||1),r[1]=(i[1]*c+i[5]*m+i[9]*g+i[13])/b,r[2]=(i[2]*c+i[6]*m+i[10]*g+i[14])/b,r},ki.transformMat3=function(r,t,i){var c=t[0],m=t[1],g=t[2];return r[0]=c*i[0]+m*i[3]+g*i[6],r[1]=c*i[1]+m*i[4]+g*i[7],r[2]=c*i[2]+m*i[5]+g*i[8],r},ki.transformQuat=function(r,t,i){var c=i[0],m=i[1],g=i[2],b=t[0],C=t[1],k=t[2],R=m*k-g*C,z=g*b-c*k,V=c*C-m*b,q=m*V-g*z,Q=g*R-c*V,te=c*z-m*R,oe=2*i[3];return z*=oe,V*=oe,Q*=2,te*=2,r[0]=b+(R*=oe)+(q*=2),r[1]=C+z+Q,r[2]=k+V+te,r},ki.rotateX=function(r,t,i,c){var m=[],g=[];return m[0]=t[0]-i[0],m[1]=t[1]-i[1],m[2]=t[2]-i[2],g[0]=m[0],g[1]=m[1]*Math.cos(c)-m[2]*Math.sin(c),g[2]=m[1]*Math.sin(c)+m[2]*Math.cos(c),r[0]=g[0]+i[0],r[1]=g[1]+i[1],r[2]=g[2]+i[2],r},ki.rotateY=function(r,t,i,c){var m=[],g=[];return m[0]=t[0]-i[0],m[1]=t[1]-i[1],m[2]=t[2]-i[2],g[0]=m[2]*Math.sin(c)+m[0]*Math.cos(c),g[1]=m[1],g[2]=m[2]*Math.cos(c)-m[0]*Math.sin(c),r[0]=g[0]+i[0],r[1]=g[1]+i[1],r[2]=g[2]+i[2],r},ki.rotateZ=function(r,t,i,c){var m=[],g=[];return m[0]=t[0]-i[0],m[1]=t[1]-i[1],m[2]=t[2]-i[2],g[0]=m[0]*Math.cos(c)-m[1]*Math.sin(c),g[1]=m[0]*Math.sin(c)+m[1]*Math.cos(c),g[2]=m[2],r[0]=g[0]+i[0],r[1]=g[1]+i[1],r[2]=g[2]+i[2],r},ki.angle=function(r,t){var i=r[0],c=r[1],m=r[2],g=t[0],b=t[1],C=t[2],k=Math.sqrt(i*i+c*c+m*m)*Math.sqrt(g*g+b*b+C*C),R=k&&z_(r,t)/k;return Math.acos(Math.min(Math.max(R,-1),1))},ki.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r},ki.str=function(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"},ki.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]},ki.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=t[0],b=t[1],C=t[2];return Math.abs(i-g)<=Md.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(c-b)<=Md.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(m-C)<=Md.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))},ki.forEach=ki.sqrLen=ki.len=ki.sqrDist=ki.dist=ki.div=ki.mul=ki.sub=void 0;var Md=function(r,t){if(r&&r.__esModule)return r;if(r===null||qy(r)!=="object"&&typeof r!="function")return{default:r};var i=U0(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function U0(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(U0=function(c){return c?i:t})(r)}function $0(){var r=new Md.ARRAY_TYPE(3);return Md.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Wy(r){return Math.hypot(r[0],r[1],r[2])}function hf(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r}function df(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r}function G0(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r[2]=t[2]/i[2],r}function us(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2])}function tg(r,t){var i=t[0]-r[0],c=t[1]-r[1],m=t[2]-r[2];return i*i+c*c+m*m}function kd(r){var t=r[0],i=r[1],c=r[2];return t*t+i*i+c*c}function z_(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}ki.sub=hf,ki.mul=df,ki.div=G0,ki.dist=us,ki.sqrDist=tg,ki.len=Wy,ki.sqrLen=kd;var eh,q0=(eh=$0(),function(r,t,i,c,m,g){var b,C;for(t||(t=3),i||(i=0),C=c?Math.min(c*t+i,r.length):r.length,b=i;b<C;b+=t)eh[0]=r[b],eh[1]=r[b+1],eh[2]=r[b+2],m(eh,eh,g),r[b]=eh[0],r[b+1]=eh[1],r[b+2]=eh[2];return r});ki.forEach=q0;var Gi={};function Lh(r){return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lh(r)}Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.create=Mb,Gi.clone=function(r){var t=new Tu.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},Gi.fromValues=function(r,t,i,c){var m=new Tu.ARRAY_TYPE(4);return m[0]=r,m[1]=t,m[2]=i,m[3]=c,m},Gi.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},Gi.set=function(r,t,i,c,m){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r},Gi.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r},Gi.subtract=Ms,Gi.multiply=yp,Gi.divide=H0,Gi.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r[3]=Math.ceil(t[3]),r},Gi.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r[3]=Math.floor(t[3]),r},Gi.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r[3]=Math.min(t[3],i[3]),r},Gi.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.max(t[2],i[2]),r[3]=Math.max(t[3],i[3]),r},Gi.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r[3]=Math.round(t[3]),r},Gi.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r},Gi.scaleAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r[2]=t[2]+i[2]*c,r[3]=t[3]+i[3]*c,r},Gi.distance=l,Gi.squaredDistance=d,Gi.length=v,Gi.squaredLength=P,Gi.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r},Gi.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r[3]=1/t[3],r},Gi.normalize=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=i*i+c*c+m*m+g*g;return b>0&&(b=1/Math.sqrt(b)),r[0]=i*b,r[1]=c*b,r[2]=m*b,r[3]=g*b,r},Gi.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},Gi.cross=function(r,t,i,c){var m=i[0]*c[1]-i[1]*c[0],g=i[0]*c[2]-i[2]*c[0],b=i[0]*c[3]-i[3]*c[0],C=i[1]*c[2]-i[2]*c[1],k=i[1]*c[3]-i[3]*c[1],R=i[2]*c[3]-i[3]*c[2],z=t[0],V=t[1],q=t[2],Q=t[3];return r[0]=V*R-q*k+Q*C,r[1]=-z*R+q*b-Q*g,r[2]=z*k-V*b+Q*m,r[3]=-z*C+V*g-q*m,r},Gi.lerp=function(r,t,i,c){var m=t[0],g=t[1],b=t[2],C=t[3];return r[0]=m+c*(i[0]-m),r[1]=g+c*(i[1]-g),r[2]=b+c*(i[2]-b),r[3]=C+c*(i[3]-C),r},Gi.random=function(r,t){var i,c,m,g,b,C;t=t||1;do b=(i=2*Tu.RANDOM()-1)*i+(c=2*Tu.RANDOM()-1)*c;while(b>=1);do C=(m=2*Tu.RANDOM()-1)*m+(g=2*Tu.RANDOM()-1)*g;while(C>=1);var k=Math.sqrt((1-b)/C);return r[0]=t*i,r[1]=t*c,r[2]=t*m*k,r[3]=t*g*k,r},Gi.transformMat4=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3];return r[0]=i[0]*c+i[4]*m+i[8]*g+i[12]*b,r[1]=i[1]*c+i[5]*m+i[9]*g+i[13]*b,r[2]=i[2]*c+i[6]*m+i[10]*g+i[14]*b,r[3]=i[3]*c+i[7]*m+i[11]*g+i[15]*b,r},Gi.transformQuat=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=i[0],C=i[1],k=i[2],R=i[3],z=R*c+C*g-k*m,V=R*m+k*c-b*g,q=R*g+b*m-C*c,Q=-b*c-C*m-k*g;return r[0]=z*R+Q*-b+V*-k-q*-C,r[1]=V*R+Q*-C+q*-b-z*-k,r[2]=q*R+Q*-k+z*-C-V*-b,r[3]=t[3],r},Gi.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r},Gi.str=function(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Gi.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},Gi.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=t[0],C=t[1],k=t[2],R=t[3];return Math.abs(i-b)<=Tu.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-C)<=Tu.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(m-k)<=Tu.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(g-R)<=Tu.EPSILON*Math.max(1,Math.abs(g),Math.abs(R))},Gi.forEach=Gi.sqrLen=Gi.len=Gi.sqrDist=Gi.dist=Gi.div=Gi.mul=Gi.sub=void 0;var Tu=function(r,t){if(r&&r.__esModule)return r;if(r===null||Lh(r)!=="object"&&typeof r!="function")return{default:r};var i=W0(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function W0(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(W0=function(c){return c?i:t})(r)}function Mb(){var r=new Tu.ARRAY_TYPE(4);return Tu.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Ms(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r[2]=t[2]-i[2],r[3]=t[3]-i[3],r}function yp(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r[2]=t[2]*i[2],r[3]=t[3]*i[3],r}function H0(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r[2]=t[2]/i[2],r[3]=t[3]/i[3],r}function l(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2],t[3]-r[3])}function d(r,t){var i=t[0]-r[0],c=t[1]-r[1],m=t[2]-r[2],g=t[3]-r[3];return i*i+c*c+m*m+g*g}function v(r){return Math.hypot(r[0],r[1],r[2],r[3])}function P(r){var t=r[0],i=r[1],c=r[2],m=r[3];return t*t+i*i+c*c+m*m}Gi.sub=Ms,Gi.mul=yp,Gi.div=H0,Gi.dist=l,Gi.sqrDist=d,Gi.len=v,Gi.sqrLen=P;var O=function(){var r=Mb();return function(t,i,c,m,g,b){var C,k;for(i||(i=4),c||(c=0),k=m?Math.min(m*i+c,t.length):t.length,C=c;C<k;C+=i)r[0]=t[C],r[1]=t[C+1],r[2]=t[C+2],r[3]=t[C+3],g(r,r,b),t[C]=r[0],t[C+1]=r[1],t[C+2]=r[2],t[C+3]=r[3];return t}}();function j(r){return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(r)}Gi.forEach=O,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.create=je,Pn.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r},Pn.setAxisAngle=Ye,Pn.getAxisAngle=function(r,t){var i=2*Math.acos(t[3]),c=Math.sin(i/2);return c>$.EPSILON?(r[0]=t[0]/c,r[1]=t[1]/c,r[2]=t[2]/c):(r[0]=1,r[1]=0,r[2]=0),i},Pn.getAngle=function(r,t){var i=gr(r,t);return Math.acos(2*i*i-1)},Pn.multiply=ct,Pn.rotateX=function(r,t,i){i*=.5;var c=t[0],m=t[1],g=t[2],b=t[3],C=Math.sin(i),k=Math.cos(i);return r[0]=c*k+b*C,r[1]=m*k+g*C,r[2]=g*k-m*C,r[3]=b*k-c*C,r},Pn.rotateY=function(r,t,i){i*=.5;var c=t[0],m=t[1],g=t[2],b=t[3],C=Math.sin(i),k=Math.cos(i);return r[0]=c*k-g*C,r[1]=m*k+b*C,r[2]=g*k+c*C,r[3]=b*k-m*C,r},Pn.rotateZ=function(r,t,i){i*=.5;var c=t[0],m=t[1],g=t[2],b=t[3],C=Math.sin(i),k=Math.cos(i);return r[0]=c*k+m*C,r[1]=m*k-c*C,r[2]=g*k+b*C,r[3]=b*k-g*C,r},Pn.calculateW=function(r,t){var i=t[0],c=t[1],m=t[2];return r[0]=i,r[1]=c,r[2]=m,r[3]=Math.sqrt(Math.abs(1-i*i-c*c-m*m)),r},Pn.exp=dt,Pn.ln=kt,Pn.pow=function(r,t,i){return kt(r,t),or(r,r,i),dt(r,r),r},Pn.slerp=St,Pn.random=function(r){var t=$.RANDOM(),i=$.RANDOM(),c=$.RANDOM(),m=Math.sqrt(1-t),g=Math.sqrt(t);return r[0]=m*Math.sin(2*Math.PI*i),r[1]=m*Math.cos(2*Math.PI*i),r[2]=g*Math.sin(2*Math.PI*c),r[3]=g*Math.cos(2*Math.PI*c),r},Pn.invert=function(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=i*i+c*c+m*m+g*g,C=b?1/b:0;return r[0]=-i*C,r[1]=-c*C,r[2]=-m*C,r[3]=g*C,r},Pn.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},Pn.fromMat3=Gt,Pn.fromEuler=function(r,t,i,c){var m=.5*Math.PI/180;t*=m,i*=m,c*=m;var g=Math.sin(t),b=Math.cos(t),C=Math.sin(i),k=Math.cos(i),R=Math.sin(c),z=Math.cos(c);return r[0]=g*k*z-b*C*R,r[1]=b*C*z+g*k*R,r[2]=b*k*R-g*C*z,r[3]=b*k*z+g*C*R,r},Pn.str=function(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Pn.setAxes=Pn.sqlerp=Pn.rotationTo=Pn.equals=Pn.exactEquals=Pn.normalize=Pn.sqrLen=Pn.squaredLength=Pn.len=Pn.length=Pn.lerp=Pn.dot=Pn.scale=Pn.mul=Pn.add=Pn.set=Pn.copy=Pn.fromValues=Pn.clone=void 0;var $=Ie(xs),K=Ie(Fo),le=Ie(ki),me=Ie(Gi);function be(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(be=function(c){return c?i:t})(r)}function Ie(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||j(r)!=="object"&&typeof r!="function")return{default:r};var i=be(t);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}function je(){var r=new $.ARRAY_TYPE(4);return $.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Ye(r,t,i){i*=.5;var c=Math.sin(i);return r[0]=c*t[0],r[1]=c*t[1],r[2]=c*t[2],r[3]=Math.cos(i),r}function ct(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=i[0],k=i[1],R=i[2],z=i[3];return r[0]=c*z+b*C+m*R-g*k,r[1]=m*z+b*k+g*C-c*R,r[2]=g*z+b*R+c*k-m*C,r[3]=b*z-c*C-m*k-g*R,r}function dt(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=Math.sqrt(i*i+c*c+m*m),C=Math.exp(g),k=b>0?C*Math.sin(b)/b:0;return r[0]=i*k,r[1]=c*k,r[2]=m*k,r[3]=C*Math.cos(b),r}function kt(r,t){var i=t[0],c=t[1],m=t[2],g=t[3],b=Math.sqrt(i*i+c*c+m*m),C=b>0?Math.atan2(b,g)/b:0;return r[0]=i*C,r[1]=c*C,r[2]=m*C,r[3]=.5*Math.log(i*i+c*c+m*m+g*g),r}function St(r,t,i,c){var m,g,b,C,k,R=t[0],z=t[1],V=t[2],q=t[3],Q=i[0],te=i[1],oe=i[2],pe=i[3];return(g=R*Q+z*te+V*oe+q*pe)<0&&(g=-g,Q=-Q,te=-te,oe=-oe,pe=-pe),1-g>$.EPSILON?(m=Math.acos(g),b=Math.sin(m),C=Math.sin((1-c)*m)/b,k=Math.sin(c*m)/b):(C=1-c,k=c),r[0]=C*R+k*Q,r[1]=C*z+k*te,r[2]=C*V+k*oe,r[3]=C*q+k*pe,r}function Gt(r,t){var i,c=t[0]+t[4]+t[8];if(c>0)i=Math.sqrt(c+1),r[3]=.5*i,r[0]=(t[5]-t[7])*(i=.5/i),r[1]=(t[6]-t[2])*i,r[2]=(t[1]-t[3])*i;else{var m=0;t[4]>t[0]&&(m=1),t[8]>t[3*m+m]&&(m=2);var g=(m+1)%3,b=(m+2)%3;i=Math.sqrt(t[3*m+m]-t[3*g+g]-t[3*b+b]+1),r[m]=.5*i,r[3]=(t[3*g+b]-t[3*b+g])*(i=.5/i),r[g]=(t[3*g+m]+t[3*m+g])*i,r[b]=(t[3*b+m]+t[3*m+b])*i}return r}Pn.clone=me.clone,Pn.fromValues=me.fromValues,Pn.copy=me.copy,Pn.set=me.set,Pn.add=me.add,Pn.mul=ct;var or=me.scale;Pn.scale=or;var gr=me.dot;Pn.dot=gr,Pn.lerp=me.lerp;var yr=me.length;Pn.length=yr,Pn.len=yr;var zr=me.squaredLength;Pn.squaredLength=zr,Pn.sqrLen=zr;var Qr=me.normalize;Pn.normalize=Qr,Pn.exactEquals=me.exactEquals,Pn.equals=me.equals;var nn,Zn,Tn,li=(nn=le.create(),Zn=le.fromValues(1,0,0),Tn=le.fromValues(0,1,0),function(r,t,i){var c=le.dot(t,i);return c<-.999999?(le.cross(nn,Zn,t),le.len(nn)<1e-6&&le.cross(nn,Tn,t),le.normalize(nn,nn),Ye(r,nn,Math.PI),r):c>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(le.cross(nn,t,i),r[0]=nn[0],r[1]=nn[1],r[2]=nn[2],r[3]=1+c,Qr(r,r))});Pn.rotationTo=li;var En,Qi,Ai=(En=je(),Qi=je(),function(r,t,i,c,m,g){return St(En,t,m,g),St(Qi,i,c,g),St(r,En,Qi,2*g*(1-g)),r});Pn.sqlerp=Ai;var Mn,uo=(Mn=K.create(),function(r,t,i,c){return Mn[0]=i[0],Mn[3]=i[1],Mn[6]=i[2],Mn[1]=c[0],Mn[4]=c[1],Mn[7]=c[2],Mn[2]=-t[0],Mn[5]=-t[1],Mn[8]=-t[2],Qr(r,Gt(r,Mn))});Pn.setAxes=uo;var hn={};function wo(r){return wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(r)}Object.defineProperty(hn,"__esModule",{value:!0}),hn.create=function(){var r=new jn.ARRAY_TYPE(8);return jn.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r},hn.clone=function(r){var t=new jn.ARRAY_TYPE(8);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t},hn.fromValues=function(r,t,i,c,m,g,b,C){var k=new jn.ARRAY_TYPE(8);return k[0]=r,k[1]=t,k[2]=i,k[3]=c,k[4]=m,k[5]=g,k[6]=b,k[7]=C,k},hn.fromRotationTranslationValues=function(r,t,i,c,m,g,b){var C=new jn.ARRAY_TYPE(8);C[0]=r,C[1]=t,C[2]=i,C[3]=c;var k=.5*m,R=.5*g,z=.5*b;return C[4]=k*c+R*i-z*t,C[5]=R*c+z*r-k*i,C[6]=z*c+k*t-R*r,C[7]=-k*r-R*t-z*i,C},hn.fromRotationTranslation=pa,hn.fromTranslation=function(r,t){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=.5*t[0],r[5]=.5*t[1],r[6]=.5*t[2],r[7]=0,r},hn.fromRotation=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},hn.fromMat4=function(r,t){var i=ho.create();da.getRotation(i,t);var c=new jn.ARRAY_TYPE(3);return da.getTranslation(c,t),pa(r,i,c),r},hn.copy=La,hn.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},hn.set=function(r,t,i,c,m,g,b,C,k){return r[0]=t,r[1]=i,r[2]=c,r[3]=m,r[4]=g,r[5]=b,r[6]=C,r[7]=k,r},hn.getDual=function(r,t){return r[0]=t[4],r[1]=t[5],r[2]=t[6],r[3]=t[7],r},hn.setDual=function(r,t){return r[4]=t[0],r[5]=t[1],r[6]=t[2],r[7]=t[3],r},hn.getTranslation=function(r,t){var i=t[4],c=t[5],m=t[6],g=t[7],b=-t[0],C=-t[1],k=-t[2],R=t[3];return r[0]=2*(i*R+g*b+c*k-m*C),r[1]=2*(c*R+g*C+m*b-i*k),r[2]=2*(m*R+g*k+i*C-c*b),r},hn.translate=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=.5*i[0],k=.5*i[1],R=.5*i[2],z=t[4],V=t[5],q=t[6],Q=t[7];return r[0]=c,r[1]=m,r[2]=g,r[3]=b,r[4]=b*C+m*R-g*k+z,r[5]=b*k+g*C-c*R+V,r[6]=b*R+c*k-m*C+q,r[7]=-c*C-m*k-g*R+Q,r},hn.rotateX=function(r,t,i){var c=-t[0],m=-t[1],g=-t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=C*b+z*c+k*g-R*m,q=k*b+z*m+R*c-C*g,Q=R*b+z*g+C*m-k*c,te=z*b-C*c-k*m-R*g;return ho.rotateX(r,t,i),r[4]=V*(b=r[3])+te*(c=r[0])+q*(g=r[2])-Q*(m=r[1]),r[5]=q*b+te*m+Q*c-V*g,r[6]=Q*b+te*g+V*m-q*c,r[7]=te*b-V*c-q*m-Q*g,r},hn.rotateY=function(r,t,i){var c=-t[0],m=-t[1],g=-t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=C*b+z*c+k*g-R*m,q=k*b+z*m+R*c-C*g,Q=R*b+z*g+C*m-k*c,te=z*b-C*c-k*m-R*g;return ho.rotateY(r,t,i),r[4]=V*(b=r[3])+te*(c=r[0])+q*(g=r[2])-Q*(m=r[1]),r[5]=q*b+te*m+Q*c-V*g,r[6]=Q*b+te*g+V*m-q*c,r[7]=te*b-V*c-q*m-Q*g,r},hn.rotateZ=function(r,t,i){var c=-t[0],m=-t[1],g=-t[2],b=t[3],C=t[4],k=t[5],R=t[6],z=t[7],V=C*b+z*c+k*g-R*m,q=k*b+z*m+R*c-C*g,Q=R*b+z*g+C*m-k*c,te=z*b-C*c-k*m-R*g;return ho.rotateZ(r,t,i),r[4]=V*(b=r[3])+te*(c=r[0])+q*(g=r[2])-Q*(m=r[1]),r[5]=q*b+te*m+Q*c-V*g,r[6]=Q*b+te*g+V*m-q*c,r[7]=te*b-V*c-q*m-Q*g,r},hn.rotateByQuatAppend=function(r,t,i){var c=i[0],m=i[1],g=i[2],b=i[3],C=t[0],k=t[1],R=t[2],z=t[3];return r[0]=C*b+z*c+k*g-R*m,r[1]=k*b+z*m+R*c-C*g,r[2]=R*b+z*g+C*m-k*c,r[3]=z*b-C*c-k*m-R*g,r[4]=(C=t[4])*b+(z=t[7])*c+(k=t[5])*g-(R=t[6])*m,r[5]=k*b+z*m+R*c-C*g,r[6]=R*b+z*g+C*m-k*c,r[7]=z*b-C*c-k*m-R*g,r},hn.rotateByQuatPrepend=function(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=i[0],k=i[1],R=i[2],z=i[3];return r[0]=c*z+b*C+m*R-g*k,r[1]=m*z+b*k+g*C-c*R,r[2]=g*z+b*R+c*k-m*C,r[3]=b*z-c*C-m*k-g*R,r[4]=c*(z=i[7])+b*(C=i[4])+m*(R=i[6])-g*(k=i[5]),r[5]=m*z+b*k+g*C-c*R,r[6]=g*z+b*R+c*k-m*C,r[7]=b*z-c*C-m*k-g*R,r},hn.rotateAroundAxis=function(r,t,i,c){if(Math.abs(c)<jn.EPSILON)return La(r,t);var m=Math.hypot(i[0],i[1],i[2]);c*=.5;var g=Math.sin(c),b=g*i[0]/m,C=g*i[1]/m,k=g*i[2]/m,R=Math.cos(c),z=t[0],V=t[1],q=t[2],Q=t[3];r[0]=z*R+Q*b+V*k-q*C,r[1]=V*R+Q*C+q*b-z*k,r[2]=q*R+Q*k+z*C-V*b,r[3]=Q*R-z*b-V*C-q*k;var te=t[4],oe=t[5],pe=t[6],_e=t[7];return r[4]=te*R+_e*b+oe*k-pe*C,r[5]=oe*R+_e*C+pe*b-te*k,r[6]=pe*R+_e*k+te*C-oe*b,r[7]=_e*R-te*b-oe*C-pe*k,r},hn.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r[2]=t[2]+i[2],r[3]=t[3]+i[3],r[4]=t[4]+i[4],r[5]=t[5]+i[5],r[6]=t[6]+i[6],r[7]=t[7]+i[7],r},hn.multiply=bs,hn.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r[2]=t[2]*i,r[3]=t[3]*i,r[4]=t[4]*i,r[5]=t[5]*i,r[6]=t[6]*i,r[7]=t[7]*i,r},hn.lerp=function(r,t,i,c){var m=1-c;return ws(t,i)<0&&(c=-c),r[0]=t[0]*m+i[0]*c,r[1]=t[1]*m+i[1]*c,r[2]=t[2]*m+i[2]*c,r[3]=t[3]*m+i[3]*c,r[4]=t[4]*m+i[4]*c,r[5]=t[5]*m+i[5]*c,r[6]=t[6]*m+i[6]*c,r[7]=t[7]*m+i[7]*c,r},hn.invert=function(r,t){var i=hs(t);return r[0]=-t[0]/i,r[1]=-t[1]/i,r[2]=-t[2]/i,r[3]=t[3]/i,r[4]=-t[4]/i,r[5]=-t[5]/i,r[6]=-t[6]/i,r[7]=t[7]/i,r},hn.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r[4]=-t[4],r[5]=-t[5],r[6]=-t[6],r[7]=t[7],r},hn.normalize=function(r,t){var i=hs(t);if(i>0){i=Math.sqrt(i);var c=t[0]/i,m=t[1]/i,g=t[2]/i,b=t[3]/i,C=t[4],k=t[5],R=t[6],z=t[7],V=c*C+m*k+g*R+b*z;r[0]=c,r[1]=m,r[2]=g,r[3]=b,r[4]=(C-c*V)/i,r[5]=(k-m*V)/i,r[6]=(R-g*V)/i,r[7]=(z-b*V)/i}return r},hn.str=function(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"},hn.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]},hn.equals=function(r,t){var i=r[0],c=r[1],m=r[2],g=r[3],b=r[4],C=r[5],k=r[6],R=r[7],z=t[0],V=t[1],q=t[2],Q=t[3],te=t[4],oe=t[5],pe=t[6],_e=t[7];return Math.abs(i-z)<=jn.EPSILON*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(c-V)<=jn.EPSILON*Math.max(1,Math.abs(c),Math.abs(V))&&Math.abs(m-q)<=jn.EPSILON*Math.max(1,Math.abs(m),Math.abs(q))&&Math.abs(g-Q)<=jn.EPSILON*Math.max(1,Math.abs(g),Math.abs(Q))&&Math.abs(b-te)<=jn.EPSILON*Math.max(1,Math.abs(b),Math.abs(te))&&Math.abs(C-oe)<=jn.EPSILON*Math.max(1,Math.abs(C),Math.abs(oe))&&Math.abs(k-pe)<=jn.EPSILON*Math.max(1,Math.abs(k),Math.abs(pe))&&Math.abs(R-_e)<=jn.EPSILON*Math.max(1,Math.abs(R),Math.abs(_e))},hn.sqrLen=hn.squaredLength=hn.len=hn.length=hn.dot=hn.mul=hn.setReal=hn.getReal=void 0;var jn=ba(xs),ho=ba(Pn),da=ba(Ui);function Oa(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Oa=function(c){return c?i:t})(r)}function ba(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||wo(r)!=="object"&&typeof r!="function")return{default:r};var i=Oa(t);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}function pa(r,t,i){var c=.5*i[0],m=.5*i[1],g=.5*i[2],b=t[0],C=t[1],k=t[2],R=t[3];return r[0]=b,r[1]=C,r[2]=k,r[3]=R,r[4]=c*R+m*k-g*C,r[5]=m*R+g*b-c*k,r[6]=g*R+c*C-m*b,r[7]=-c*b-m*C-g*k,r}function La(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r}function bs(r,t,i){var c=t[0],m=t[1],g=t[2],b=t[3],C=i[4],k=i[5],R=i[6],z=i[7],V=t[4],q=t[5],Q=t[6],te=t[7],oe=i[0],pe=i[1],_e=i[2],ze=i[3];return r[0]=c*ze+b*oe+m*_e-g*pe,r[1]=m*ze+b*pe+g*oe-c*_e,r[2]=g*ze+b*_e+c*pe-m*oe,r[3]=b*ze-c*oe-m*pe-g*_e,r[4]=c*z+b*C+m*R-g*k+V*ze+te*oe+q*_e-Q*pe,r[5]=m*z+b*k+g*C-c*R+q*ze+te*pe+Q*oe-V*_e,r[6]=g*z+b*R+c*k-m*C+Q*ze+te*_e+V*pe-q*oe,r[7]=b*z-c*C-m*k-g*R+te*ze-V*oe-q*pe-Q*_e,r}hn.getReal=ho.copy,hn.setReal=ho.copy,hn.mul=bs;var ws=ho.dot;hn.dot=ws;var hl=ho.length;hn.length=hl,hn.len=hl;var hs=ho.squaredLength;hn.squaredLength=hs,hn.sqrLen=hs;var ei={};function za(r){return za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(r)}Object.defineProperty(ei,"__esModule",{value:!0}),ei.create=Yo,ei.clone=function(r){var t=new Na.ARRAY_TYPE(2);return t[0]=r[0],t[1]=r[1],t},ei.fromValues=function(r,t){var i=new Na.ARRAY_TYPE(2);return i[0]=r,i[1]=t,i},ei.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r},ei.set=function(r,t,i){return r[0]=t,r[1]=i,r},ei.add=function(r,t,i){return r[0]=t[0]+i[0],r[1]=t[1]+i[1],r},ei.subtract=$o,ei.multiply=Ao,ei.divide=El,ei.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r},ei.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r},ei.min=function(r,t,i){return r[0]=Math.min(t[0],i[0]),r[1]=Math.min(t[1],i[1]),r},ei.max=function(r,t,i){return r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r},ei.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r},ei.scale=function(r,t,i){return r[0]=t[0]*i,r[1]=t[1]*i,r},ei.scaleAndAdd=function(r,t,i,c){return r[0]=t[0]+i[0]*c,r[1]=t[1]+i[1]*c,r},ei.distance=Qs,ei.squaredDistance=la,ei.length=Qa,ei.squaredLength=el,ei.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r},ei.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r},ei.normalize=function(r,t){var i=t[0],c=t[1],m=i*i+c*c;return m>0&&(m=1/Math.sqrt(m)),r[0]=t[0]*m,r[1]=t[1]*m,r},ei.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]},ei.cross=function(r,t,i){var c=t[0]*i[1]-t[1]*i[0];return r[0]=r[1]=0,r[2]=c,r},ei.lerp=function(r,t,i,c){var m=t[0],g=t[1];return r[0]=m+c*(i[0]-m),r[1]=g+c*(i[1]-g),r},ei.random=function(r,t){t=t||1;var i=2*Na.RANDOM()*Math.PI;return r[0]=Math.cos(i)*t,r[1]=Math.sin(i)*t,r},ei.transformMat2=function(r,t,i){var c=t[0],m=t[1];return r[0]=i[0]*c+i[2]*m,r[1]=i[1]*c+i[3]*m,r},ei.transformMat2d=function(r,t,i){var c=t[0],m=t[1];return r[0]=i[0]*c+i[2]*m+i[4],r[1]=i[1]*c+i[3]*m+i[5],r},ei.transformMat3=function(r,t,i){var c=t[0],m=t[1];return r[0]=i[0]*c+i[3]*m+i[6],r[1]=i[1]*c+i[4]*m+i[7],r},ei.transformMat4=function(r,t,i){var c=t[0],m=t[1];return r[0]=i[0]*c+i[4]*m+i[12],r[1]=i[1]*c+i[5]*m+i[13],r},ei.rotate=function(r,t,i,c){var m=t[0]-i[0],g=t[1]-i[1],b=Math.sin(c),C=Math.cos(c);return r[0]=m*C-g*b+i[0],r[1]=m*b+g*C+i[1],r},ei.angle=function(r,t){var i=r[0],c=r[1],m=t[0],g=t[1],b=Math.sqrt(i*i+c*c)*Math.sqrt(m*m+g*g);return Math.acos(Math.min(Math.max(b&&(i*m+c*g)/b,-1),1))},ei.zero=function(r){return r[0]=0,r[1]=0,r},ei.str=function(r){return"vec2("+r[0]+", "+r[1]+")"},ei.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]},ei.equals=function(r,t){var i=r[0],c=r[1],m=t[0],g=t[1];return Math.abs(i-m)<=Na.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-g)<=Na.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},ei.forEach=ei.sqrLen=ei.sqrDist=ei.dist=ei.div=ei.mul=ei.sub=ei.len=void 0;var Na=function(r,t){if(r&&r.__esModule)return r;if(r===null||za(r)!=="object"&&typeof r!="function")return{default:r};var i=fo(void 0);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}(xs);function fo(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(fo=function(c){return c?i:t})(r)}function Yo(){var r=new Na.ARRAY_TYPE(2);return Na.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function $o(r,t,i){return r[0]=t[0]-i[0],r[1]=t[1]-i[1],r}function Ao(r,t,i){return r[0]=t[0]*i[0],r[1]=t[1]*i[1],r}function El(r,t,i){return r[0]=t[0]/i[0],r[1]=t[1]/i[1],r}function Qs(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1])}function la(r,t){var i=t[0]-r[0],c=t[1]-r[1];return i*i+c*c}function Qa(r){return Math.hypot(r[0],r[1])}function el(r){var t=r[0],i=r[1];return t*t+i*i}ei.len=Qa,ei.sub=$o,ei.mul=Ao,ei.div=El,ei.dist=Qs,ei.sqrDist=la,ei.sqrLen=el;var Do=function(){var r=Yo();return function(t,i,c,m,g,b){var C,k;for(i||(i=2),c||(c=0),k=m?Math.min(m*i+c,t.length):t.length,C=c;C<k;C+=i)r[0]=t[C],r[1]=t[C+1],g(r,r,b),t[C]=r[0],t[C+1]=r[1];return t}}();function th(r){return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},th(r)}ei.forEach=Do,Object.defineProperty(Ha,"__esModule",{value:!0}),s.a7=Ha.vec4=s.N=Ha.vec3=Ha.vec2=Ha.quat2=s.bi=Ha.quat=s.a6=Ha.mat4=s.co=Ha.mat3=Ha.mat2d=s.b4=Ha.mat2=Ha.glMatrix=void 0;var $c=wc(xs);Ha.glMatrix=$c;var Rd=wc(ha);s.b4=Ha.mat2=Rd;var es=wc(Xo);Ha.mat2d=es;var Dd=wc(Fo);s.co=Ha.mat3=Dd;var rh=wc(Ui);s.a6=Ha.mat4=rh;var rg=wc(Pn);s.bi=Ha.quat=rg;var sm=wc(hn);Ha.quat2=sm;var ng=wc(ei);Ha.vec2=ng;var vp=wc(ki);s.N=Ha.vec3=vp;var ig=wc(Gi);function N_(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(N_=function(c){return c?i:t})(r)}function wc(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||th(r)!=="object"&&typeof r!="function")return{default:r};var i=N_(t);if(i&&i.has(r))return i.get(r);var c={},m=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in r)if(g!=="default"&&Object.prototype.hasOwnProperty.call(r,g)){var b=m?Object.getOwnPropertyDescriptor(r,g):null;b&&(b.get||b.set)?Object.defineProperty(c,g,b):c[g]=r[g]}return c.default=r,i&&i.set(r,c),c}s.a7=Ha.vec4=ig;class lm{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,c){const m=s.N.dot(i,this.dir);if(Math.abs(m)<1e-6)return!1;const g=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/m;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,c[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(t,i,c){if(s.N.equals(this.pos,t)||i===0)return c[0]=c[1]=c[2]=0,!1;const[m,g,b]=this.dir,C=this.pos[0]-t[0],k=this.pos[1]-t[1],R=this.pos[2]-t[2],z=m*m+g*g+b*b,V=2*(C*m+k*g+R*b),q=V*V-4*z*(C*C+k*k+R*R-i*i);if(q<0){const Q=Math.max(-V/2,0),te=C+m*Q,oe=k+g*Q,pe=R+b*Q,_e=Math.hypot(te,oe,pe);return c[0]=te*i/_e,c[1]=oe*i/_e,c[2]=pe*i/_e,!1}{const Q=(-V-Math.sqrt(q))/(2*z);if(Q<0){const te=Math.hypot(C,k,R);return c[0]=C*i/te,c[1]=k*i/te,c[2]=R*i/te,!1}return c[0]=C+m*Q,c[1]=k+g*Q,c[2]=R+b*Q,!0}}}class og{constructor(t,i,c,m,g){this.TL=t,this.TR=i,this.BR=c,this.BL=m,this.horizon=g}static fromInvProjectionMatrix(t,i,c){const m=[-1,1,1],g=[1,1,1],b=[1,-1,1],C=[-1,-1,1],k=s.N.transformMat4(m,m,t),R=s.N.transformMat4(g,g,t),z=s.N.transformMat4(b,b,t),V=s.N.transformMat4(C,C,t);return new og(k,R,z,V,i/c)}}function pf(r,t,i){let c=1/0,m=-1/0;const g=[];for(const b of r){s.N.sub(g,b,t);const C=s.N.dot(g,i);c=Math.min(c,C),m=Math.max(m,C)}return[c,m]}function Od(r,t){let i=!0;for(let c=0;c<r.planes.length;c++){const m=r.planes[c];let g=0;for(let b=0;b<t.length;b++)g+=s.N.dot(m,t[b])+m[3]>=0;if(g===0)return 0;g!==t.length&&(i=!1)}return i?2:1}function ag(r,t){for(const i of r.projections){const c=pf(t,r.points[0],i.axis);if(i.projection[1]<c[0]||i.projection[0]>c[1])return 0}return 1}function cm(r,t){let i=0;const c=[0,0,0,0];for(let m=0;m<r.length;m++)c[0]=r[m][0],c[1]=r[m][1],c[2]=r[m][2],c[3]=1,s.a7.dot(c,t)>=0&&i++;return i}class Ld{constructor(t,i){this.points=t||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=Ko.fromPoints(this.points),this.projections=[],this.frustumEdges=[s.N.sub([],this.points[2],this.points[3]),s.N.sub([],this.points[0],this.points[3]),s.N.sub([],this.points[4],this.points[0]),s.N.sub([],this.points[5],this.points[1]),s.N.sub([],this.points[6],this.points[2]),s.N.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const m=[0,-c[2],c[1]],g=[c[2],0,-c[0]];this.projections.push({axis:m,projection:pf(this.points,this.points[0],m)}),this.projections.push({axis:g,projection:pf(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(t,i,c,m){const g=Math.pow(2,c),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const z=s.a7.transformMat4([],R,t),V=1/z[3]/i*g;return s.a7.mul(z,z,[V,V,m?1/z[3]:V,V])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const z=s.N.sub([],b[R[0]],b[R[1]]),V=s.N.sub([],b[R[2]],b[R[1]]),q=s.N.normalize([],s.N.cross([],z,V)),Q=-s.N.dot(q,b[R[1]]);return q.concat(Q)}),k=[];for(let R=0;R<b.length;R++)k.push([b[R][0],b[R][1],b[R][2]]);return new Ld(k,C)}intersectsPrecise(t,i,c){for(let m=0;m<i.length;m++)if(!cm(t,i[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!cm(t,this.planes[m]))return 0;for(const m of c)for(const g of this.frustumEdges){const b=s.N.cross([],m,g),C=s.N.length(b);if(C===0)continue;s.N.scale(b,b,1/C);const k=pf(this.points,this.points[0],b),R=pf(t,this.points[0],b);if(k[0]>R[1]||R[0]>k[1])return 0}return 1}}class Ko{static fromPoints(t){const i=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const m of t)s.N.min(i,i,m),s.N.max(c,c,m);return new Ko(i,c)}static fromTileIdAndHeight(t,i,c){const m=1<<t.canonical.z,g=t.canonical.x,b=t.canonical.y;return new Ko([g/m,b/m,i],[(g+1)/m,(b+1)/m,c])}static applyTransform(t,i){const c=t.getCorners();for(let m=0;m<c.length;++m)s.N.transformMat4(c[m],c[m],i);return Ko.fromPoints(c)}static projectAabbCorners(t,i){const c=t.getCorners();for(let m=0;m<c.length;++m)s.N.transformMat4(c[m],c[m],i);return c}constructor(t,i){this.min=t,this.max=i,this.center=s.N.scale([],s.N.add([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],c=s.N.clone(this.min),m=s.N.clone(this.max);for(let g=0;g<i.length;g++)c[g]=i[g]?this.min[g]:this.center[g],m[g]=i[g]?this.center[g]:this.max[g];return m[2]=this.max[2],new Ko(c,m)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Od(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Od(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,i){return i||this.intersects(t)?ag(t,this.getCorners()):0}intersectsPreciseFlat(t,i){return i||this.intersectsFlat(t)?ag(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let i=0;i<3;++i)if(this.min[i]>t.max[i]||t.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t.min[i]),this.max[i]=Math.max(this.max[i],t.max[i])}encapsulatePoint(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t[i]),this.max[i]=Math.max(this.max[i],t[i])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}re(Ko,"Aabb");const Hy=bo([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:um}=Hy,j_=bo([{name:"a_pos_3",components:3,type:"Int16"}]);var sg=bo([{name:"a_pos",type:"Int16",components:2}]);function hm(r){return r*Be/tr}const B_=[new Ko([Tt,Tt,Tt],[Zt,Zt,Zt]),new Ko([Tt,Tt,Tt],[0,0,Zt]),new Ko([0,Tt,Tt],[Zt,0,Zt]),new Ko([Tt,0,Tt],[0,Zt,Zt]),new Ko([0,0,Tt],[Zt,Zt,Zt])];function lg(r,t,i,c=!0){const m=s.N.scale([],r._camera.position,r.worldSize),g=[t,i,1,1];s.a7.transformMat4(g,g,r.pixelMatrixInverse),s.a7.scale(g,g,1/g[3]);const b=s.N.sub([],g,m),C=s.N.normalize([],b),k=r.globeMatrix,R=[k[12],k[13],k[14]],z=s.N.sub([],R,m),V=s.N.length(z),q=s.N.normalize([],z),Q=r.worldSize/(2*Math.PI),te=s.N.dot(q,C),oe=Math.asin(Q/V);if(oe<Math.acos(te)){if(!c)return null;const Ft=[],_r=[];s.N.scale(Ft,C,V/te),s.N.normalize(_r,s.N.sub(_r,Ft,z)),s.N.normalize(C,s.N.add(C,z,s.N.scale(C,_r,Math.tan(oe)*V)))}const pe=[];new lm(m,C).closestPointOnSphere(R,Q,pe);const _e=s.N.normalize([],qe(k,0)),ze=s.N.normalize([],qe(k,1)),Ue=s.N.normalize([],qe(k,2)),Ve=s.N.dot(_e,pe),nt=s.N.dot(ze,pe),Qe=s.N.dot(Ue,pe),gt=Wt(Math.asin(-nt/Q));let At=Wt(Math.atan2(Ve,Qe));At=r.center.lng+function(Ft,_r){const Pr=(_r-Ft+180)%360-180;return Pr<-180?Pr+360:Pr}(r.center.lng,At);const Bt=Mi(At),Yt=Ht(pi(gt),0,1);return new no(Bt,Yt)}class F_{constructor(t,i,c){this.a=s.N.sub([],t,c),this.b=s.N.sub([],i,c),this.center=c;const m=s.N.normalize([],this.a),g=s.N.normalize([],this.b);this.angle=Math.acos(s.N.dot(m,g))}}function cg(r,t){if(r.angle===0)return null;let i;return i=r.a[t]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[t]/r.a[t]/Math.sin(r.angle)-1/Math.tan(r.angle)),i<0||i>1?null:function(c,m,g,b){const C=Math.sin(g);return c*(Math.sin((1-b)*g)/C)+m*(Math.sin(b*g)/C)}(r.a[t],r.b[t],r.angle,Ht(i,0,1))+r.center[t]}function Sc(r){if(r.z<=1)return B_[r.z+2*r.y+r.x];const t=pm(zd(r));return Ko.fromPoints(t)}function nh(r,t,i){return s.N.scale(r,r,1-i),s.N.scaleAndAdd(r,r,t,i)}function dm(r,t,i){for(const c of r)s.N.transformMat4(c,c,t),s.N.scale(c,c,i)}function ug(r,t,i,c){const m=t/r.worldSize,g=r.globeMatrix;if(i.z<=1){const Bt=Sc(i).getCorners();return dm(Bt,g,m),Ko.fromPoints(Bt)}const b=zd(i,c),C=pm(b,Be+hm(r._tileCoverLift));dm(C,g,m);const k=Number.MAX_VALUE,R=[-k,-k,-k],z=[k,k,k];if(b.contains(r.center)){for(const Ft of C)s.N.min(z,z,Ft),s.N.max(R,R,Ft);R[2]=0;const Bt=r.point,Yt=[Bt.x*m,Bt.y*m,0];return s.N.min(z,z,Yt),s.N.max(R,R,Yt),new Ko(z,R)}if(r._tileCoverLift>0){for(const Bt of C)s.N.min(z,z,Bt),s.N.max(R,R,Bt);return new Ko(z,R)}const V=[g[12]*m,g[13]*m,g[14]*m],q=b.getCenter(),Q=Ht(r.center.lat,-Vi,Vi),te=Ht(q.lat,-Vi,Vi),oe=Mi(r.center.lng),pe=pi(Q);let _e=oe-Mi(q.lng);const ze=pe-pi(te);_e>.5?_e-=1:_e<-.5&&(_e+=1);let Ue=0;if(Math.abs(_e)>Math.abs(ze))Ue=_e>=0?1:3;else{Ue=ze>=0?0:2;const Bt=[g[4]*m,g[5]*m,g[6]*m],Yt=-Math.sin(Et(ze>=0?b.getSouth():b.getNorth()))*Be;s.N.scaleAndAdd(V,V,Bt,Yt)}const Ve=C[Ue],nt=C[(Ue+1)%4],Qe=new F_(Ve,nt,V),gt=[cg(Qe,0)||Ve[0],cg(Qe,1)||Ve[1],cg(Qe,2)||Ve[2]],At=oa(r.zoom);if(At>0){const Bt=function({x:Ft,y:_r,z:Pr},dr,Er,lr,Sr){const Yr=1/(1<<Pr);let kr=Ft*Yr,bn=kr+Yr,dn=_r*Yr,jr=dn+Yr,ti=0;const zn=(kr+bn)/2-lr;return zn>.5?ti=-1:zn<-.5&&(ti=1),kr=((kr+ti)*dr-(lr*=dr))*Er+lr,bn=((bn+ti)*dr-lr)*Er+lr,dn=(dn*dr-(Sr*=dr))*Er+Sr,jr=(jr*dr-Sr)*Er+Sr,[[kr,jr,0],[bn,jr,0],[bn,dn,0],[kr,dn,0]]}(i,t,r._pixelsPerMercatorPixel,oe,pe);for(let Ft=0;Ft<C.length;Ft++)nh(C[Ft],Bt[Ft],At);const Yt=s.N.add([],Bt[Ue],Bt[(Ue+1)%4]);s.N.scale(Yt,Yt,.5),nh(gt,Yt,At)}for(const Bt of C)s.N.min(z,z,Bt),s.N.max(R,R,Bt);return z[2]=Math.min(Ve[2],nt[2]),s.N.min(z,z,gt),s.N.max(R,R,gt),new Ko(z,R)}function zd({x:r,y:t,z:i},c=!1){const m=1/(1<<i),g=new zt(Ti(r*m),t===(1<<i)-1&&c?-90:ro((t+1)*m)),b=new zt(Ti((r+1)*m),t===0&&c?90:ro(t*m));return new ir(g,b)}function pm(r,t=Be){const i=Et(r.getNorth()),c=Et(r.getSouth()),m=Math.cos(i),g=Math.cos(c),b=Math.sin(i),C=Math.sin(c),k=r.getWest(),R=r.getEast();return[xt(g,C,k,t),xt(g,C,R,t),xt(m,b,R,t),xt(m,b,k,t)]}function Nd(r,t,i,c){const m=1<<i.z,g=(r/Jr+i.x)/m;return hr(ro((t/Jr+i.y)/m),Ti(g),c)}function hg({min:r,max:t}){return Ke/Math.max(t[0]-r[0],t[1]-r[1],t[2]-r[2])}const Z0=new Float64Array(16);function dg(r){const t=hg(r),i=s.a6.fromScaling(Z0,[t,t,t]);return s.a6.translate(i,i,s.N.negate([],r.min))}function Zy(r){const t=s.a6.fromTranslation(Z0,r.min),i=1/hg(r);return s.a6.scale(t,t,[i,i,i])}function V_(r){const t=Jr/(2*Math.PI);return r/(2*Math.PI)/t}function kb(r,t){return Jr/(512*Math.pow(2,r))*hg(Sc(t))}function pg(r,t,i,c,m){const g=V_(i),b=[r,t,-i/(2*Math.PI)],C=s.a6.identity(new Float64Array(16));return s.a6.translate(C,C,b),s.a6.scale(C,C,[g,g,g]),s.a6.rotateX(C,C,Et(-m)),s.a6.rotateY(C,C,Et(-c)),C}function oa(r){return Qt(We,Pe,r)}function ih(r,t){const i=hr(t.lat,t.lng),c=function(g){const b=hr(g._center.lat,g._center.lng),C=s.N.fromValues(0,1,0);let k=s.N.cross([],C,b);const R=s.a6.fromRotation([],-g.angle,b);k=s.N.transformMat4(k,k,R),s.a6.fromRotation(R,-g._pitch,k);const z=s.N.normalize([],b);return s.N.scale(z,z,hm(g.cameraToCenterDistance/g.pixelsPerMeter)),s.N.transformMat4(z,z,R),s.N.add([],b,z)}(r),m=s.N.subtract([],c,i);return s.N.angle(m,i)}function X0(r,t){return ih(r,t)>Math.PI/2*1.01}const xp=Et(85),Y0=Math.cos(xp),Rb=Math.sin(xp),Xy=s.a6.create(),zh=r=>{const t=[];return r.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),r.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function U_(r,t,i,c,m,g,b,C,k){if(g&&r.queryGeometry.isAboveHorizon)return!1;g&&(k*=r.pixelToTileUnitsFactor);const R=r.tileID.canonical,z=i.projection.upVectorScale(R,i.center.lat,i.worldSize).metersToTile;for(const V of t)for(const q of V){const Q=q.add(C),te=m&&i.elevation?i.elevation.exaggeration()*m.getElevationAt(Q.x,Q.y,!0):0,oe=i.projection.projectTilePoint(Q.x,Q.y,R);if(te>0){const Ue=i.projection.upVector(R,Q.x,Q.y);oe.x+=Ue[0]*z*te,oe.y+=Ue[1]*z*te,oe.z+=Ue[2]*z*te}const pe=g?Q:$_(oe.x,oe.y,oe.z,c),_e=g?r.tilespaceRays.map(Ue=>K0(Ue,te)):r.queryGeometry.screenGeometry,ze=s.a7.transformMat4([],[oe.x,oe.y,oe.z,1],c);if(!b&&g?k*=ze[3]/i.cameraToCenterDistance:b&&!g&&(k*=i.cameraToCenterDistance/ze[3]),g){const Ue=ro((q.y/Jr+R.y)/(1<<R.z));k/=i.projection.pixelsPerMeter(Ue,1)/Ci(1,Ue)}if(Oh(_e,pe,k))return!0}return!1}function $_(r,t,i,c){const m=s.a7.transformMat4([],[r,t,i,1],c);return new Ge(m[0]/m[3],m[1]/m[3])}const G_=s.N.fromValues(0,0,0),Yy=s.N.fromValues(0,0,1);function K0(r,t){const i=s.N.create();return G_[2]=t,r.intersectsPlane(G_,Yy,i),new Ge(i[0],i[1])}class J0 extends Tl{}function fg(r,{width:t,height:i},c,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==t*i*c)throw new RangeError("mismatched image size")}else m=new Uint8Array(t*i*c);return r.width=t,r.height=i,r.data=m,r}function Q0(r,t,i){const{width:c,height:m}=t;c===r.width&&m===r.height||(Ky(r,t,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,c),height:Math.min(r.height,m)},i),r.width=c,r.height=m,r.data=t.data)}function Ky(r,t,i,c,m,g,b){if(m.width===0||m.height===0)return t;if(m.width>r.width||m.height>r.height||i.x>r.width-m.width||i.y>r.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>t.width||m.height>t.height||c.x>t.width-m.width||c.y>t.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const C=r.data,k=t.data,R=g===4&&b;for(let z=0;z<m.height;z++){const V=((i.y+z)*r.width+i.x)*g,q=((c.y+z)*t.width+c.x)*g;if(R)for(let Q=0;Q<m.width;Q++){const te=V+Q*g+3,oe=q+Q*g;k[oe+0]=255,k[oe+1]=255,k[oe+2]=255,k[oe+3]=C[te]}else for(let Q=0;Q<m.width*g;Q++)k[q+Q]=C[V+Q]}return t}re(J0,"HeatmapBucket",{omit:["layers"]});class bp{constructor(t,i){fg(this,t,1,i)}resize(t){Q0(this,new bp(t),1)}clone(){return new bp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,c,m,g){Ky(t,i,c,m,g,1)}}class Gc{constructor(t,i){fg(this,t,4,i)}resize(t){Q0(this,new Gc(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Gc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,c,m,g,b){Ky(t,i,c,m,g,4,b)}}class ex{constructor(t,i){this.width=t.width,this.height=t.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}re(bp,"AlphaImage"),re(Gc,"RGBAImage");const qc=new go({visibility:new Dr(jt.layout_heatmap.visibility)});var Jy={paint:new go({"heatmap-radius":new an(jt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new an(jt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Dr(jt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new na(jt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Dr(jt.paint_heatmap["heatmap-opacity"])}),layout:qc};function mg(r){const t={},i=r.resolution||256,c=r.clips?r.clips.length:1,m=r.image||new Gc({width:i,height:c}),g=(b,C,k)=>{t[r.evaluationKey]=k;const R=r.expression.evaluate(t);R&&(m.data[b+C+0]=Math.floor(255*R.r/R.a),m.data[b+C+1]=Math.floor(255*R.g/R.a),m.data[b+C+2]=Math.floor(255*R.b/R.a),m.data[b+C+3]=Math.floor(255*R.a))};if(r.clips)for(let b=0,C=0;b<c;++b,C+=4*i)for(let k=0,R=0;k<i;k++,R+=4){const z=k/(i-1),{start:V,end:q}=r.clips[b];g(C,R,V*(1-z)+q*z)}else for(let b=0,C=0;b<i;b++,C+=4)g(0,C,b/(i-1));return m}const jd=new go({visibility:new Dr(jt.layout_hillshade.visibility)});var FT={paint:new go({"hillshade-illumination-direction":new Dr(jt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Dr(jt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Dr(jt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Dr(jt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Dr(jt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Dr(jt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Dr(jt.paint_hillshade["hillshade-emissive-strength"])}),layout:jd};const Db=bo([{name:"a_pos",components:2,type:"Int16"}],4),{members:fm}=Db;var ff={exports:{}};function wp(r,t,i){i=i||2;var c,m,g,b,C,k,R,z=t&&t.length,V=z?t[0]*i:r.length,q=mm(r,0,V,i,!0),Q=[];if(!q||q.next===q.prev)return Q;if(z&&(q=function(oe,pe,_e,ze){var Ue,Ve,nt,Qe=[];for(Ue=0,Ve=pe.length;Ue<Ve;Ue++)(nt=mm(oe,pe[Ue]*ze,Ue<Ve-1?pe[Ue+1]*ze:oe.length,ze,!1))===nt.next&&(nt.steiner=!0),Qe.push(nx(nt));for(Qe.sort(rx),Ue=0;Ue<Qe.length;Ue++)_e=Sp(Qe[Ue],_e);return _e}(r,t,q,i)),r.length>80*i){c=g=r[0],m=b=r[1];for(var te=i;te<V;te+=i)(C=r[te])<c&&(c=C),(k=r[te+1])<m&&(m=k),C>g&&(g=C),k>b&&(b=k);R=(R=Math.max(g-c,b-m))!==0?32767/R:0}return gg(q,Q,i,c,m,R,0),Q}function mm(r,t,i,c,m){var g,b;if(m===ax(r,t,i,c)>0)for(g=t;g<i;g+=c)b=jb(g,r[g],r[g+1],b);else for(g=i-c;g>=t;g-=c)b=jb(g,r[g],r[g+1],b);return b&&W_(b,b.next)&&(yg(b),b=b.next),b}function oh(r,t){if(!r)return r;t||(t=r);var i,c=r;do if(i=!1,c.steiner||!W_(c,c.next)&&ds(c.prev,c,c.next)!==0)c=c.next;else{if(yg(c),(c=t=c.prev)===c.next)break;i=!0}while(i||c!==t);return t}function gg(r,t,i,c,m,g,b){if(r){!b&&g&&function(z,V,q,Q){var te=z;do te.z===0&&(te.z=q_(te.x,te.y,V,q,Q)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next;while(te!==z);te.prevZ.nextZ=null,te.prevZ=null,function(oe){var pe,_e,ze,Ue,Ve,nt,Qe,gt,At=1;do{for(_e=oe,oe=null,Ve=null,nt=0;_e;){for(nt++,ze=_e,Qe=0,pe=0;pe<At&&(Qe++,ze=ze.nextZ);pe++);for(gt=At;Qe>0||gt>0&&ze;)Qe!==0&&(gt===0||!ze||_e.z<=ze.z)?(Ue=_e,_e=_e.nextZ,Qe--):(Ue=ze,ze=ze.nextZ,gt--),Ve?Ve.nextZ=Ue:oe=Ue,Ue.prevZ=Ve,Ve=Ue;_e=ze}Ve.nextZ=null,At*=2}while(nt>1)}(te)}(r,c,m,g);for(var C,k,R=r;r.prev!==r.next;)if(C=r.prev,k=r.next,g?Lb(r,c,m,g):Ob(r))t.push(C.i/i|0),t.push(r.i/i|0),t.push(k.i/i|0),yg(r),r=k.next,R=k.next;else if((r=k)===R){b?b===1?gg(r=zb(oh(r),t,i),t,i,c,m,g,2):b===2&&tx(r,t,i,c,m,g):gg(oh(r),t,i,c,m,g,1);break}}}function Ob(r){var t=r.prev,i=r,c=r.next;if(ds(t,i,c)>=0)return!1;for(var m=t.x,g=i.x,b=c.x,C=t.y,k=i.y,R=c.y,z=m<g?m<b?m:b:g<b?g:b,V=C<k?C<R?C:R:k<R?k:R,q=m>g?m>b?m:b:g>b?g:b,Q=C>k?C>R?C:R:k>R?k:R,te=c.next;te!==t;){if(te.x>=z&&te.x<=q&&te.y>=V&&te.y<=Q&&gm(m,C,g,k,b,R,te.x,te.y)&&ds(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function Lb(r,t,i,c){var m=r.prev,g=r,b=r.next;if(ds(m,g,b)>=0)return!1;for(var C=m.x,k=g.x,R=b.x,z=m.y,V=g.y,q=b.y,Q=C<k?C<R?C:R:k<R?k:R,te=z<V?z<q?z:q:V<q?V:q,oe=C>k?C>R?C:R:k>R?k:R,pe=z>V?z>q?z:q:V>q?V:q,_e=q_(Q,te,t,i,c),ze=q_(oe,pe,t,i,c),Ue=r.prevZ,Ve=r.nextZ;Ue&&Ue.z>=_e&&Ve&&Ve.z<=ze;){if(Ue.x>=Q&&Ue.x<=oe&&Ue.y>=te&&Ue.y<=pe&&Ue!==m&&Ue!==b&&gm(C,z,k,V,R,q,Ue.x,Ue.y)&&ds(Ue.prev,Ue,Ue.next)>=0||(Ue=Ue.prevZ,Ve.x>=Q&&Ve.x<=oe&&Ve.y>=te&&Ve.y<=pe&&Ve!==m&&Ve!==b&&gm(C,z,k,V,R,q,Ve.x,Ve.y)&&ds(Ve.prev,Ve,Ve.next)>=0))return!1;Ve=Ve.nextZ}for(;Ue&&Ue.z>=_e;){if(Ue.x>=Q&&Ue.x<=oe&&Ue.y>=te&&Ue.y<=pe&&Ue!==m&&Ue!==b&&gm(C,z,k,V,R,q,Ue.x,Ue.y)&&ds(Ue.prev,Ue,Ue.next)>=0)return!1;Ue=Ue.prevZ}for(;Ve&&Ve.z<=ze;){if(Ve.x>=Q&&Ve.x<=oe&&Ve.y>=te&&Ve.y<=pe&&Ve!==m&&Ve!==b&&gm(C,z,k,V,R,q,Ve.x,Ve.y)&&ds(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.nextZ}return!0}function zb(r,t,i){var c=r;do{var m=c.prev,g=c.next.next;!W_(m,g)&&Qy(m,c,c.next,g)&&_g(m,g)&&_g(g,m)&&(t.push(m.i/i|0),t.push(c.i/i|0),t.push(g.i/i|0),yg(c),yg(c.next),c=r=g),c=c.next}while(c!==r);return oh(c)}function tx(r,t,i,c,m,g){var b=r;do{for(var C=b.next.next;C!==b.prev;){if(b.i!==C.i&&ix(b,C)){var k=Z_(b,C);return b=oh(b,b.next),k=oh(k,k.next),gg(b,t,i,c,m,g,0),void gg(k,t,i,c,m,g,0)}C=C.next}b=b.next}while(b!==r)}function rx(r,t){return r.x-t.x}function Sp(r,t){var i=function(m,g){var b,C=g,k=m.x,R=m.y,z=-1/0;do{if(R<=C.y&&R>=C.next.y&&C.next.y!==C.y){var V=C.x+(R-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(V<=k&&V>z&&(z=V,b=C.x<C.next.x?C:C.next,V===k))return b}C=C.next}while(C!==g);if(!b)return null;var q,Q=b,te=b.x,oe=b.y,pe=1/0;C=b;do k>=C.x&&C.x>=te&&k!==C.x&&gm(R<oe?k:z,R,te,oe,R<oe?z:k,R,C.x,C.y)&&(q=Math.abs(R-C.y)/(k-C.x),_g(C,m)&&(q<pe||q===pe&&(C.x>b.x||C.x===b.x&&Nb(b,C)))&&(b=C,pe=q)),C=C.next;while(C!==Q);return b}(r,t);if(!i)return t;var c=Z_(i,r);return oh(c,c.next),oh(i,i.next)}function Nb(r,t){return ds(r.prev,r,t.prev)<0&&ds(t.next,r,r.next)<0}function q_(r,t,i,c,m){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-i)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*m|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function nx(r){var t=r,i=r;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==r);return i}function gm(r,t,i,c,m,g,b,C){return(m-b)*(t-C)>=(r-b)*(g-C)&&(r-b)*(c-C)>=(i-b)*(t-C)&&(i-b)*(g-C)>=(m-b)*(c-C)}function ix(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(i,c){var m=i;do{if(m.i!==i.i&&m.next.i!==i.i&&m.i!==c.i&&m.next.i!==c.i&&Qy(m,m.next,i,c))return!0;m=m.next}while(m!==i);return!1}(r,t)&&(_g(r,t)&&_g(t,r)&&function(i,c){var m=i,g=!1,b=(i.x+c.x)/2,C=(i.y+c.y)/2;do m.y>C!=m.next.y>C&&m.next.y!==m.y&&b<(m.next.x-m.x)*(C-m.y)/(m.next.y-m.y)+m.x&&(g=!g),m=m.next;while(m!==i);return g}(r,t)&&(ds(r.prev,r,t.prev)||ds(r,t.prev,t))||W_(r,t)&&ds(r.prev,r,r.next)>0&&ds(t.prev,t,t.next)>0)}function ds(r,t,i){return(t.y-r.y)*(i.x-t.x)-(t.x-r.x)*(i.y-t.y)}function W_(r,t){return r.x===t.x&&r.y===t.y}function Qy(r,t,i,c){var m=mf(ds(r,t,i)),g=mf(ds(r,t,c)),b=mf(ds(i,c,r)),C=mf(ds(i,c,t));return m!==g&&b!==C||!(m!==0||!H_(r,i,t))||!(g!==0||!H_(r,c,t))||!(b!==0||!H_(i,r,c))||!(C!==0||!H_(i,t,c))}function H_(r,t,i){return t.x<=Math.max(r.x,i.x)&&t.x>=Math.min(r.x,i.x)&&t.y<=Math.max(r.y,i.y)&&t.y>=Math.min(r.y,i.y)}function mf(r){return r>0?1:r<0?-1:0}function _g(r,t){return ds(r.prev,r,r.next)<0?ds(r,t,r.next)>=0&&ds(r,r.prev,t)>=0:ds(r,t,r.prev)<0||ds(r,r.next,t)<0}function Z_(r,t){var i=new ox(r.i,r.x,r.y),c=new ox(t.i,t.x,t.y),m=r.next,g=t.prev;return r.next=t,t.prev=r,i.next=m,m.prev=i,c.next=i,i.prev=c,g.next=c,c.prev=g,c}function jb(r,t,i,c){var m=new ox(r,t,i);return c?(m.next=c.next,m.prev=c,c.next.prev=m,c.next=m):(m.prev=m,m.next=m),m}function yg(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ox(r,t,i){this.i=r,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ax(r,t,i,c){for(var m=0,g=t,b=i-c;g<i;g+=c)m+=(r[b]-r[g])*(r[g+1]+r[b+1]),b=g;return m}ff.exports=wp,ff.exports.default=wp,wp.deviation=function(r,t,i,c){var m=t&&t.length,g=Math.abs(ax(r,0,m?t[0]*i:r.length,i));if(m)for(var b=0,C=t.length;b<C;b++)g-=Math.abs(ax(r,t[b]*i,b<C-1?t[b+1]*i:r.length,i));var k=0;for(b=0;b<c.length;b+=3){var R=c[b]*i,z=c[b+1]*i,V=c[b+2]*i;k+=Math.abs((r[R]-r[V])*(r[z+1]-r[R+1])-(r[R]-r[z])*(r[V+1]-r[R+1]))}return g===0&&k===0?0:Math.abs((k-g)/g)},wp.flatten=function(r){for(var t=r[0][0].length,i={vertices:[],holes:[],dimensions:t},c=0,m=0;m<r.length;m++){for(var g=0;g<r[m].length;g++)for(var b=0;b<t;b++)i.vertices.push(r[m][g][b]);m>0&&i.holes.push(c+=r[m-1].length)}return i};var ev=ce(ff.exports);function sx(r,t){const i=r.length;if(i<=1)return[r];const c=[];let m,g;for(let b=0;b<i;b++){const C=gn(r[b]);C!==0&&(r[b].area=Math.abs(C),g===void 0&&(g=C<0),g===C<0?(m&&c.push(m),m=[r[b]]):m.push(r[b]))}if(m&&c.push(m),t>1)for(let b=0;b<c.length;b++)c[b].length<=t||(Ou(c[b],t,1,c[b].length-1,VT),c[b]=c[b].slice(0,t));return c}function VT(r,t){return t.area-r.area}function lx(r,t,i){const c=i.patternDependencies;let m=!1;for(const g of t){const b=g.paint.get(`${r}-pattern`);b.isConstant()||(m=!0);const C=b.constantOr(null);C&&(m=!0,c[C]=!0)}return m}function cx(r,t,i,c,m){const g=m.patternDependencies;for(const b of t){const C=b.paint.get(`${r}-pattern`).value;if(C.kind!=="constant"){let k=C.evaluate({zoom:c},i,{},m.availableImages);k=k&&k.name?k.name:k,g[k]=!0,i.patterns[b.id]=k}}return i}class ux{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ic,this.indexArray=new Wa,this.indexArray2=new Uc,this.programConfigurations=new we(t.layers,t.zoom),this.segments=new ua,this.segments2=new ua,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,c,m){this.hasPattern=lx("fill",this.layers,i);const g=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:C,id:k,index:R,sourceLayerIndex:z}of t){const V=this.layers[0]._featureFilter.needGeometry,q=ls(C,V);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),q,c))continue;const Q=g?g.evaluate(q,{},c,i.availableImages):void 0,te={id:k,properties:C.properties,type:C.type,sourceLayerIndex:z,index:R,geometry:V?q.geometry:ss(C,c,m),patterns:{},sortKey:Q};b.push(te)}g&&b.sort((C,k)=>C.sortKey-k.sortKey);for(const C of b){const{geometry:k,index:R,sourceLayerIndex:z}=C;if(this.hasPattern){const V=cx("fill",this.layers,C,this.zoom,i);this.patternFeatures.push(V)}else this.addFeature(C,k,R,c,{},i.availableImages,i.brightness);i.featureIndex.insert(t[R].feature,k,R,z,this.index)}}update(t,i,c,m,g){const b=Object.keys(t).length!==0;b&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,b?this.stateDependentLayers:this.layers,c,m,g)}addFeatures(t,i,c,m,g,b){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,i,c,m,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,c,m,g,b=[],C){for(const k of sx(i,500)){let R=0;for(const oe of k)R+=oe.length;const z=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),V=z.vertexLength,q=[],Q=[];for(const oe of k){if(oe.length===0)continue;oe!==k[0]&&Q.push(q.length/2);const pe=this.segments2.prepareSegment(oe.length,this.layoutVertexArray,this.indexArray2),_e=pe.vertexLength;this.layoutVertexArray.emplaceBack(oe[0].x,oe[0].y),this.indexArray2.emplaceBack(_e+oe.length-1,_e),q.push(oe[0].x),q.push(oe[0].y);for(let ze=1;ze<oe.length;ze++)this.layoutVertexArray.emplaceBack(oe[ze].x,oe[ze].y),this.indexArray2.emplaceBack(_e+ze-1,_e+ze),q.push(oe[ze].x),q.push(oe[ze].y);pe.vertexLength+=oe.length,pe.primitiveLength+=oe.length}const te=ev(q,Q);for(let oe=0;oe<te.length;oe+=3)this.indexArray.emplaceBack(V+te[oe],V+te[oe+1],V+te[oe+2]);z.vertexLength+=R,z.primitiveLength+=te.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,b,m,C)}}re(ux,"FillBucket",{omit:["layers","patternFeatures"]});const Bd=new go({"fill-sort-key":new an(jt.layout_fill["fill-sort-key"]),visibility:new Dr(jt.layout_fill.visibility)});var tv={paint:new go({"fill-antialias":new Dr(jt.paint_fill["fill-antialias"]),"fill-opacity":new an(jt.paint_fill["fill-opacity"]),"fill-color":new an(jt.paint_fill["fill-color"]),"fill-outline-color":new an(jt.paint_fill["fill-outline-color"]),"fill-translate":new Dr(jt.paint_fill["fill-translate"]),"fill-translate-anchor":new Dr(jt.paint_fill["fill-translate-anchor"]),"fill-pattern":new an(jt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Dr(jt.paint_fill["fill-emissive-strength"])}),layout:Bd};const Bb=bo([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),X_=bo([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Fb=bo([{name:"a_centroid_pos",components:2,type:"Uint16"}]),HB=bo([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),ZB=bo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:XB}=Bb;var Vb={},YB=rt,RM=rv;function rv(r,t,i,c,m){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=c,this._values=m,r.readFields(KB,this,t)}function KB(r,t,i){r==1?t.id=i.readVarint():r==2?function(c,m){for(var g=c.readVarint()+c.pos;c.pos<g;){var b=m._keys[c.readVarint()],C=m._values[c.readVarint()];m.properties[b]=C}}(i,t):r==3?t.type=i.readVarint():r==4&&(t._geometry=i.pos)}function JB(r){for(var t,i,c=0,m=0,g=r.length,b=g-1;m<g;b=m++)c+=((i=r[b]).x-(t=r[m]).x)*(t.y+i.y);return c}rv.types=["Unknown","Point","LineString","Polygon"],rv.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,i=r.readVarint()+r.pos,c=1,m=0,g=0,b=0,C=[];r.pos<i;){if(m<=0){var k=r.readVarint();c=7&k,m=k>>3}if(m--,c===1||c===2)g+=r.readSVarint(),b+=r.readSVarint(),c===1&&(t&&C.push(t),t=[]),t.push(new YB(g,b));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&C.push(t),C},rv.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,i=1,c=0,m=0,g=0,b=1/0,C=-1/0,k=1/0,R=-1/0;r.pos<t;){if(c<=0){var z=r.readVarint();i=7&z,c=z>>3}if(c--,i===1||i===2)(m+=r.readSVarint())<b&&(b=m),m>C&&(C=m),(g+=r.readSVarint())<k&&(k=g),g>R&&(R=g);else if(i!==7)throw new Error("unknown command "+i)}return[b,k,C,R]},rv.prototype.toGeoJSON=function(r,t,i){var c,m,g=this.extent*Math.pow(2,i),b=this.extent*r,C=this.extent*t,k=this.loadGeometry(),R=rv.types[this.type];function z(Q){for(var te=0;te<Q.length;te++){var oe=Q[te];Q[te]=[360*(oe.x+b)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+C)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(c=0;c<k.length;c++)V[c]=k[c][0];z(k=V);break;case 2:for(c=0;c<k.length;c++)z(k[c]);break;case 3:for(k=function(Q){var te=Q.length;if(te<=1)return[Q];for(var oe,pe,_e=[],ze=0;ze<te;ze++){var Ue=JB(Q[ze]);Ue!==0&&(pe===void 0&&(pe=Ue<0),pe===Ue<0?(oe&&_e.push(oe),oe=[Q[ze]]):oe.push(Q[ze]))}return oe&&_e.push(oe),_e}(k),c=0;c<k.length;c++)for(m=0;m<k[c].length;m++)z(k[c][m])}k.length===1?k=k[0]:R="Multi"+R;var q={type:"Feature",geometry:{type:R,coordinates:k},properties:this.properties};return"id"in this&&(q.id=this.id),q};var QB=RM,DM=OM;function OM(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(eF,this,t),this.length=this._features.length}function eF(r,t,i){r===15?t.version=i.readVarint():r===1?t.name=i.readString():r===5?t.extent=i.readVarint():r===2?t._features.push(i.pos):r===3?t._keys.push(i.readString()):r===4&&t._values.push(function(c){for(var m=null,g=c.readVarint()+c.pos;c.pos<g;){var b=c.readVarint()>>3;m=b===1?c.readString():b===2?c.readFloat():b===3?c.readDouble():b===4?c.readVarint64():b===5?c.readVarint():b===6?c.readSVarint():b===7?c.readBoolean():null}return m}(i))}OM.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new QB(this._pbf,t,this.extent,this._keys,this._values)};var tF=DM;function rF(r,t,i){if(r===3){var c=new tF(i,i.readVarint()+i.pos);c.length&&(t[c.name]=c)}}var UT=Vb.VectorTile=function(r,t){this.layers=r.readFields(rF,{},t)},Ub=Vb.VectorTileFeature=RM;function $b(r,t,i,c){const m=[],g=c===0?(b,C,k,R,z,V)=>{b.push(new Ge(V,k+(V-C)/(R-C)*(z-k)))}:(b,C,k,R,z,V)=>{b.push(new Ge(C+(V-k)/(z-k)*(R-C),V))};for(const b of r){const C=[];for(const k of b){if(k.length<=2)continue;const R=[];for(let q=0;q<k.length-1;q++){const Q=k[q].x,te=k[q].y,oe=k[q+1].x,pe=k[q+1].y,_e=c===0?Q:te,ze=c===0?oe:pe;_e<t?ze>t&&g(R,Q,te,oe,pe,t):_e>i?ze<i&&g(R,Q,te,oe,pe,i):R.push(k[q]),ze<t&&_e>=t&&g(R,Q,te,oe,pe,t),ze>i&&_e<=i&&g(R,Q,te,oe,pe,i)}let z=k[k.length-1];const V=c===0?z.x:z.y;V>=t&&V<=i&&R.push(z),R.length&&(z=R[R.length-1],R[0].x===z.x&&R[0].y===z.y||R.push(R[0]),C.push(R))}C.length&&m.push(C)}return m}function Gb(r,t){return r.x-t.x||r.y-t.y}function LM(r,t){return Gb(r.min,t.min)===0&&Gb(r.max,t.max)===0}function zM(r,t){return!(r.min.x>t.max.x||r.max.x<t.min.x||r.min.y>t.max.y||r.max.y<t.min.y)}function NM(r,t,i){const c=1/Jr,m=1/(1<<i.canonical.z),g=(t.x*c+i.canonical.x)*m+i.wrap,b=(t.y*c+i.canonical.y)*m;return{min:new Ge((r.x*c+i.canonical.x)*m+i.wrap,(r.y*c+i.canonical.y)*m),max:new Ge(g,b)}}function nF(r,t,i){const c=1<<i.canonical.z,m=((t.x-i.wrap)*c-i.canonical.x)*Jr,g=(t.y*c-i.canonical.y)*Jr;return{min:new Ge(((r.x-i.wrap)*c-i.canonical.x)*Jr,(r.y*c-i.canonical.y)*Jr),max:new Ge(m,g)}}function jM(r,t,i,c,m,g,b){const C=r.indices,k=r.vertices,R=[];for(let z=c;z<c+m;z+=3){const V=t[i[z+0]+g],q=t[i[z+1]+g],Q=t[i[z+2]+g],te=Math.min(V.x,q.x,Q.x),oe=Math.max(V.x,q.x,Q.x),pe=Math.min(V.y,q.y,Q.y),_e=Math.max(V.y,q.y,Q.y);R.length=0,r.grid.query(new Ge(te,pe),new Ge(oe,_e),R);for(let ze=0;ze<R.length;ze++){const Ue=R[ze];if(eg(k[C[3*Ue+0]],k[C[3*Ue+1]],k[C[3*Ue+2]],V,q,Q,b))return!0}}return!1}function BM(r,t,i,c){if(!r||!i)return!1;let m=r.vertices;if(!t.canonical.equals(c.canonical)||t.wrap!==c.wrap){if(i.vertices.length<r.vertices.length)return BM(i,c,r,t);const g=t.canonical,b=c.canonical,C=Math.pow(2,b.z-g.z);m=r.vertices.map(k=>new Ge(k.x*g.x*Jr*C-b.x*Jr,k.y*g.y*Jr*C-b.y*Jr))}return jM(i,m,r.indices,0,r.indices.length,0,0)}Vb.VectorTileLayer=DM;class FM{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const c=this.toIdx(t,i);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function VM(r,t,i,c){let m=0,g=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(c[b])<1e-15){if(i[b]<r[b]||i[b]>t[b])return null}else{const C=1/c[b];let k=(r[b]-i[b])*C,R=(t[b]-i[b])*C;if(k>R){const z=k;k=R,R=z}if(k>m&&(m=k),R<g&&(g=R),m>g)return null}return m}function UM(r,t,i,c,m,g,b,C,k,R,z){const V=c-r,q=m-t,Q=g-i,te=b-r,oe=C-t,pe=k-i,_e=z[1]*pe-z[2]*oe,ze=z[2]*te-z[0]*pe,Ue=z[0]*oe-z[1]*te,Ve=V*_e+q*ze+Q*Ue;if(Math.abs(Ve)<1e-15)return null;const nt=1/Ve,Qe=R[0]-r,gt=R[1]-t,At=R[2]-i,Bt=(Qe*_e+gt*ze+At*Ue)*nt;if(Bt<0||Bt>1)return null;const Yt=gt*Q-At*q,Ft=At*V-Qe*Q,_r=Qe*q-gt*V,Pr=(z[0]*Yt+z[1]*Ft+z[2]*_r)*nt;return Pr<0||Bt+Pr>1?null:(te*Yt+oe*Ft+pe*_r)*nt}function $M(r,t,i){return(r-t)/(i-t)}function GM(r,t,i,c,m,g,b,C,k){const R=1<<i,z=g-c,V=b-m,q=(r+1)/R*z+c,Q=(t+0)/R*V+m,te=(t+1)/R*V+m;C[0]=(r+0)/R*z+c,C[1]=Q,k[0]=q,k[1]=te}class qM{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(g){const b=Math.ceil(Math.log2(g.dim/8)),C=[];let k=Math.ceil(Math.pow(2,b));const R=1/k,z=(Q,te,oe,pe,_e)=>{const ze=pe?1:0,Ue=(Q+1)*oe-ze,Ve=te*oe,nt=(te+1)*oe-ze;_e[0]=Q*oe,_e[1]=Ve,_e[2]=Ue,_e[3]=nt};let V=new FM(k);const q=[];for(let Q=0;Q<k*k;Q++){z(Q%k,Math.floor(Q/k),R,!1,q);const te=vg(q[0],q[1],g),oe=vg(q[2],q[1],g),pe=vg(q[2],q[3],g),_e=vg(q[0],q[3],g);V.minimums.push(Math.min(te,oe,pe,_e)),V.maximums.push(Math.max(te,oe,pe,_e)),V.leaves.push(1)}for(C.push(V),k/=2;k>=1;k/=2){const Q=C[C.length-1];V=new FM(k);for(let te=0;te<k*k;te++){z(te%k,Math.floor(te/k),2,!0,q);const oe=Q.getElevation(q[0],q[1]),pe=Q.getElevation(q[2],q[1]),_e=Q.getElevation(q[2],q[3]),ze=Q.getElevation(q[0],q[3]),Ue=Q.isLeaf(q[0],q[1]),Ve=Q.isLeaf(q[2],q[1]),nt=Q.isLeaf(q[2],q[3]),Qe=Q.isLeaf(q[0],q[3]),gt=Math.min(oe.min,pe.min,_e.min,ze.min),At=Math.max(oe.max,pe.max,_e.max,ze.max),Bt=Ue&&Ve&&nt&&Qe;V.maximums.push(At),V.minimums.push(gt),V.leaves.push(At-gt<=5&&Bt?1:0)}C.push(V)}return C}(this.dem),c=i.length-1,m=i[c];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(i,0,0,c,0)}raycastRoot(t,i,c,m,g,b,C=1){return VM([t,i,-100],[c,m,this.maximums[0]*C],g,b)}raycast(t,i,c,m,g,b,C=1){if(!this.nodeCount)return null;const k=this.raycastRoot(t,i,c,m,g,b,C);if(k==null)return null;const R=[],z=[],V=[],q=[],Q=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;Q.length>0;){const{idx:te,t:oe,nodex:pe,nodey:_e,depth:ze}=Q.pop();if(this.leaves[te]){GM(pe,_e,ze,t,i,c,m,V,q);const Ve=1<<ze,nt=(pe+0)/Ve,Qe=(pe+1)/Ve,gt=(_e+0)/Ve,At=(_e+1)/Ve,Bt=vg(nt,gt,this.dem)*C,Yt=vg(Qe,gt,this.dem)*C,Ft=vg(Qe,At,this.dem)*C,_r=vg(nt,At,this.dem)*C,Pr=UM(V[0],V[1],Bt,q[0],V[1],Yt,q[0],q[1],Ft,g,b),dr=UM(q[0],q[1],Ft,V[0],q[1],_r,V[0],V[1],Bt,g,b),Er=Math.min(Pr!==null?Pr:Number.MAX_VALUE,dr!==null?dr:Number.MAX_VALUE);if(Er!==Number.MAX_VALUE)return Er;{const lr=s.N.scaleAndAdd([],g,b,oe);if(WM(Bt,Yt,_r,Ft,$M(lr[0],V[0],q[0]),$M(lr[1],V[1],q[1]))>=lr[2])return oe}continue}let Ue=0;for(let Ve=0;Ve<this._siblingOffset.length;Ve++){GM((pe<<1)+this._siblingOffset[Ve][0],(_e<<1)+this._siblingOffset[Ve][1],ze+1,t,i,c,m,V,q),V[2]=-100,q[2]=this.maximums[this.childOffsets[te]+Ve]*C;const nt=VM(V,q,g,b);if(nt!=null){const Qe=nt;R[Ve]=Qe;let gt=!1;for(let At=0;At<Ue&&!gt;At++)Qe>=R[z[At]]&&(z.splice(At,0,Ve),gt=!0);gt||(z[Ue]=Ve),Ue++}}for(let Ve=0;Ve<Ue;Ve++){const nt=z[Ve];Q.push({idx:this.childOffsets[te]+nt,t:R[nt],nodex:(pe<<1)+this._siblingOffset[nt][0],nodey:(_e<<1)+this._siblingOffset[nt][1],depth:ze+1})}}return null}_addNode(t,i,c){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,c,m,g){if(t[m].isLeaf(i,c)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const b=m-1,C=t[b];let k=0,R=0;for(let z=0;z<this._siblingOffset.length;z++){const V=2*i+this._siblingOffset[z][0],q=2*c+this._siblingOffset[z][1],Q=C.getElevation(V,q),te=C.isLeaf(V,q),oe=this._addNode(Q.min,Q.max,te);te&&(k|=1<<z),R||(R=oe)}for(let z=0;z<this._siblingOffset.length;z++)k&1<<z||this._construct(t,2*i+this._siblingOffset[z][0],2*c+this._siblingOffset[z][1],b,R+z)}}function WM(r,t,i,c,m,g){return Hn(Hn(r,i,g),Hn(t,c,g),m)}function vg(r,t,i){const c=i.dim,m=Ht(r*c-.5,0,c-1),g=Ht(t*c-.5,0,c-1),b=Math.floor(m),C=Math.floor(g),k=Math.min(b+1,c-1),R=Math.min(C+1,c-1);return WM(i.get(b,C),i.get(k,C),i.get(b,R),i.get(k,R),m-b,g-C)}const iF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function oF(r,t,i){return(256*r*256+256*t+i)/10-1e4}function aF(r,t,i){return 256*r+t+i/256-32768}class qb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,c,m=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Kt(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const g=this.dim=i.height-2,b=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let k=0;k<g;k++)b[this._idx(-1,k)]=b[this._idx(0,k)],b[this._idx(g,k)]=b[this._idx(g-1,k)],b[this._idx(k,-1)]=b[this._idx(k,0)],b[this._idx(k,g)]=b[this._idx(k,g-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(g,-1)]=b[this._idx(g-1,0)],b[this._idx(-1,g)]=b[this._idx(0,g-1)],b[this._idx(g,g)]=b[this._idx(g-1,g-1)]}const C=c==="terrarium"?aF:oF;for(let k=0;k<b.length;++k){const R=4*k;this.floatView[k]=C(this.pixels[R],this.pixels[R+1],this.pixels[R+2])}this._timestamp=br.now()}_buildQuadTree(){this._tree=new qM(this)}get(t,i,c=!1){c&&(t=Ht(t,-1,this.dim),i=Ht(i,-1,this.dim));const m=this._idx(t,i);return this.floatView[m]}set(t,i,c){const m=this._idx(t,i),g=this.floatView[m];return this.floatView[m]=c,c-g}static getUnpackVector(t){return iF[t]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}static pack(t,i){const c=[0,0,0,0],m=qb.getUnpackVector(i);let g=Math.floor((t+m[3])/m[2]);return c[2]=g%256,g=Math.floor(g/256),c[1]=g%256,g=Math.floor(g/256),c[0]=g,c}getPixels(){return new ex({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let m=i*this.dim,g=i*this.dim+this.dim,b=c*this.dim,C=c*this.dim+this.dim;switch(i){case-1:m=g-1;break;case 1:g=m+1}switch(c){case-1:b=C-1;break;case 1:C=b+1}const k=-i*this.dim,R=-c*this.dim;for(let z=b;z<C;z++)for(let V=m;V<g;V++){const q=4*this._idx(V,z),Q=4*this._idx(V+k,z+R);this.pixels[q+0]=t.pixels[Q+0],this.pixels[q+1]=t.pixels[Q+1],this.pixels[q+2]=t.pixels[Q+2],this.pixels[q+3]=t.pixels[Q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}re(qb,"DEMData"),re(qM,"DemMinMaxQuadTree",{omit:["dem"]});class nv{constructor(t,i,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=c}static create(t,i,c){const m=c||t.findDEMTileFor(i);if(!m||!m.dem)return;const g=m.dem,b=m.tileID,C=1<<i.canonical.z-b.canonical.z;return new nv(m,g.dim/Jr/C,[(i.canonical.x/C-b.canonical.x)*g.dim,(i.canonical.y/C-b.canonical.y)*g.dim])}tileCoordToPixel(t,i){const c=i*this._scale+this._offset[1],m=Math.floor(t*this._scale+this._offset[0]),g=Math.floor(c);return new Ge(m,g)}getElevationAt(t,i,c,m){const g=t*this._scale+this._offset[0],b=i*this._scale+this._offset[1],C=Math.floor(g),k=Math.floor(b),R=this._dem;return m=!!m,c?Hn(Hn(R.get(C,k,m),R.get(C,k+1,m),b-k),Hn(R.get(C+1,k,m),R.get(C+1,k+1,m),b-k),g-C):R.get(C,k,m)}getElevationAtPixel(t,i,c){return this._dem.get(t,i,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Ci(1,t)*this._dem.stride}}const sF=Ub.types,lF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],cF=["fill-extrusion-flood-light-ground-radius"],uF=Math.pow(2,13),hF=Math.pow(2,15)-1,HM=new Ge(0,1),xg=2147483648;function hx(r,t,i,c,m,g,b,C){r.emplaceBack((t<<1)+b,(i<<1)+g,(Math.floor(c*uF)<<1)+m,Math.round(C))}function Wb(r,t,i,c,m,g){r.emplaceBack(t.x,t.y,(i.x<<1)+c,(i.y<<1)+m,g)}function dx(r,t,i){r.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class ZM{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class XM{constructor(){this.centroidXY=new Ge(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ge(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ge(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ge(this.max.x-this.min.x,this.max.y-this.min.y)}}class YM{constructor(){this.acc=new Ge(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,i){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=i.x,t.min.y=t.max.y=i.y)}appendEdge(t,i,c){this.accCount++,this.acc._add(i);let m=!!this.borders;i.x<t.min.x?(t.min.x=i.x,m=!0):i.x>t.max.x&&(t.max.x=i.x,m=!0),i.y<t.min.y?(t.min.y=i.y,m=!0):i.y>t.max.y&&(t.max.y=i.y,m=!0),((i.x===0||i.x===Jr)&&i.x===c.x)!=((i.y===0||i.y===Jr)&&i.y===c.y)&&this.processBorderOverlap(i,c),m&&this.checkBorderIntersection(i,c)}checkBorderIntersection(t,i){i.x<0!=t.x<0&&this.addBorderIntersection(0,Hn(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>Jr!=t.x>Jr&&this.addBorderIntersection(1,Hn(i.y,t.y,(Jr-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,Hn(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>Jr!=t.y>Jr&&this.addBorderIntersection(3,Hn(i.x,t.x,(Jr-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];i<c[0]&&(c[0]=i),i>c[1]&&(c[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,i.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,i.x),this.addBorderIntersection(c,t.x)}}centroid(){return this.accCount===0?new Ge(0,0):new Ge(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0):0}}function KM(r,t){const i=r.add(t)._unit(),c=Ht(r.x*i.x+r.y*i.y,-1,1);var m,g,b;return m=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(m)))/4*hF*((g=r).x*(b=t).y-g.y*b.x<0?-1:1)}const dF=[r=>r.x<0,r=>r.x>Jr,r=>r.y<0,r=>r.y>Jr];function pF(r,t,i,c){const m=[4];if(c===0)return m;i._mult(c);const g=r.sub(i),b=t.sub(i),C=[r,t,g,b];for(let k=0;k<4;k++)for(const R of C)if(dF[k](R)){m.push(k);break}return m}class JM{constructor(t){this.vertexArray=new Vf,this.indexArray=new Wa,this.programConfigurations=new we(t.layers,t.zoom,i=>cF.includes(i)),this._segments=new ua,this.hiddenByLandmarkVertexArray=new Da,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ua}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,i,c,m=!1){const g=t.length;if(g>2){let b=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[b].length);let k;b!==this._segments.get().length-1&&(b++,this._segmentToGroundQuads[b]=[],this._segmentToRegionTriCounts[b]=[0,0,0,0,0]);{const R=t[0],z=t[1];k=KM(R.sub(t[g-1])._perp()._unit(),z.sub(R)._perp()._unit())}for(let R=0;R<g;R++){const z=R===g-1?0:R+1,V=t[R],q=t[z],Q=t[z===g-1?0:z+1],te=q.sub(V)._perp()._unit(),oe=KM(te,Q.sub(q)._perp()._unit()),pe=k,_e=oe;if($T(V,q,i)||m&&tk(V,i)&&tk(q,i)){k=oe;continue}const ze=C.vertexLength;Wb(this.vertexArray,V,q,1,1,pe),Wb(this.vertexArray,V,q,1,0,pe),Wb(this.vertexArray,V,q,0,1,_e),Wb(this.vertexArray,V,q,0,0,_e),C.vertexLength+=4;const Ue=pF(V,q,te,c);for(const Ve of Ue)this._segmentToGroundQuads[b].push({id:ze,region:Ve}),this._segmentToRegionTriCounts[b][Ve]+=2,C.primitiveLength+=2;k=oe}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),i=t.length;for(let c=0;c<i;c++)this._segmentToGroundQuads[c].sort((m,g)=>m.region-g.region);for(let c=0;c<i;c++){const m=this._segmentToGroundQuads[c],g=t[c],b=this._segmentToRegionTriCounts[c];b.reduce((k,R)=>k+R,0);let C=0;for(let k=0;k<=4;k++){const R=b[k];if(R!==0){let z=this.regionSegments[k];z||(z=this.regionSegments[k]=new ua);const V={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+C,vertexLength:g.vertexLength,primitiveLength:R};z.get().push(V)}C+=R}for(let k=0;k<m.length;k++){const R=m[k].id;this.indexArray.emplaceBack(R,R+1,R+3),this.indexArray.emplaceBack(R,R+3,R+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,i,c,m,g,b){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,i,c,m,g,b)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,X_.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,i,c,m,g,b){this.hasData()&&this.programConfigurations.updatePaintArrays(t,i,c,m,g,b)}updateHiddenByLandmark(t){if(!this.hasData())return;const i=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const c=t.flags&xg?1:0;for(let m=t.groundVertexArrayOffset;m<i;++m)this.hiddenByLandmarkVertexArray.emplace(m,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,HB.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const i=this.regionSegments[t];i&&i.destroy()}}}}class Hb{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Wa,this.footprintVertices=new ic,this.footprintSegments=[],this.layoutVertexArray=new oc,this.centroidVertexArray=new Kf,this.indexArray=new Wa,this.programConfigurations=new we(t.layers,t.zoom,i=>lF.includes(i)),this.segments=new ua,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new JM(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,i,c,m){this.features=[],this.hasPattern=lx("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=oi(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:b,index:C,sourceLayerIndex:k}of t){const R=this.layers[0]._featureFilter.needGeometry,z=ls(g,R);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),z,c))continue;const V={id:b,sourceLayerIndex:k,index:C,geometry:R?z.geometry:ss(g,c,m),properties:g.properties,type:g.type,patterns:{}},q=this.layoutVertexArray.length;this.hasPattern?this.features.push(cx("fill-extrusion",this.layers,V,this.zoom,i)):this.addFeature(V,V.geometry,C,c,{},i.availableImages,m,i.brightness),i.featureIndex.insert(g,V.geometry,C,k,this.index,q)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,i,c,m,g,b){for(const C of this.features){const{geometry:k}=C;this.addFeature(C,k,C.index,i,c,m,g,b)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,i,c,m,g){const b=Object.keys(t).length!==0;if(b&&!this.stateDependentLayers.length)return;const C=b?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,i,C,c,m,g),this.groundEffect.update(t,i,C,c,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,XB),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,ZB.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Fb.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,c,m,g,b,C,k){const R=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,z=[new Ge(0,0),new Ge(Jr,Jr)],V=C.projection,q=V.name==="globe",Q=sF[t.type]==="Polygon",te=new YM;te.centroidDataIndex=this.centroidData.length;const oe=new XM,pe=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},m)<=0,_e=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},m);oe.height=_e,oe.vertexArrayOffset=this.layoutVertexArray.length,oe.groundVertexArrayOffset=this.groundEffect.vertexArray.length,q&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Um);const ze=sx(i,500);for(let At=ze.length-1;At>=0;At--){const Bt=ze[At];(Bt.length===0||(Ue=Bt[0]).every(Yt=>Yt.x<=0)||Ue.every(Yt=>Yt.x>=Jr)||Ue.every(Yt=>Yt.y<=0)||Ue.every(Yt=>Yt.y>=Jr))&&ze.splice(At,1)}var Ue;let Ve;if(q)Ve=ok(ze,z,m);else{Ve=[];for(const At of ze)Ve.push({polygon:At,bounds:z})}const nt=Q?this.edgeRadius:0,Qe=nt>0&&this.zoom<17,gt=(At,Bt)=>{if(At.length===0)return!1;const Yt=At[At.length-1];return Bt.x===Yt.x&&Bt.y===Yt.y};for(const{polygon:At,bounds:Bt}of Ve){let Yt=0,Ft=0;for(const Er of At)Q&&!Er[0].equals(Er[Er.length-1])&&Er.push(Er[0]),Ft+=Q?Er.length-1:Er.length;const _r=this.segments.prepareSegment((Q?5:4)*Ft,this.layoutVertexArray,this.indexArray);oe.footprintSegIdx<0&&(oe.footprintSegIdx=this.footprintSegments.length),oe.polygonSegIdx<0&&(oe.polygonSegIdx=this.polygonSegments.length);const Pr={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},dr=new ZM;if(dr.vertexOffset=this.footprintVertices.length,dr.indexOffset=3*this.footprintIndices.length,dr.ringIndices=[],Q){const Er=[],lr=[];Yt=_r.vertexLength;for(let Yr=0;Yr<At.length;Yr++){const kr=At[Yr];kr.length&&Yr!==0&&lr.push(Er.length/2);const bn=[];let dn,jr;dn=kr[1].sub(kr[0])._perp()._unit(),dr.ringIndices.push(kr.length-1);for(let ti=1;ti<kr.length;ti++){const zn=kr[ti],yn=kr[ti===kr.length-1?1:ti+1],Br=zn.clone();if(nt){jr=yn.sub(zn)._perp()._unit();const Wn=dn.add(jr)._unit(),Wi=nt*Math.min(4,1/(dn.x*Wn.x+dn.y*Wn.y));Br.x+=Wi*Wn.x,Br.y+=Wi*Wn.y,Br.x=Math.round(Br.x),Br.y=Math.round(Br.y),dn=jr}!pe||nt!==0&&!Qe||gt(bn,Br)||bn.push(Br),hx(this.layoutVertexArray,Br.x,Br.y,0,0,1,1,0),_r.vertexLength++,this.footprintVertices.emplaceBack(zn.x,zn.y),Er.push(zn.x,zn.y),q&&dx(this.layoutVertexExtArray,V.projectTilePoint(Br.x,Br.y,m),V.upVector(m,Br.x,Br.y))}pe&&(nt===0||Qe)&&(bn.length!==0&&gt(bn,bn[0])&&bn.pop(),this.groundEffect.addData(bn,Bt,R))}const Sr=ev(Er,lr);for(let Yr=0;Yr<Sr.length;Yr+=3)this.footprintIndices.emplaceBack(dr.vertexOffset+Sr[Yr+0],dr.vertexOffset+Sr[Yr+1],dr.vertexOffset+Sr[Yr+2]),this.indexArray.emplaceBack(Yt+Sr[Yr],Yt+Sr[Yr+2],Yt+Sr[Yr+1]),_r.primitiveLength++;dr.indexCount+=Sr.length,dr.vertexCount+=this.footprintVertices.length-dr.vertexOffset}for(let Er=0;Er<At.length;Er++){const lr=At[Er];te.startRing(oe,lr[0]);let Sr=lr.length>4&&rk(lr[lr.length-2],lr[0],lr[1]),Yr=nt?fF(lr[lr.length-2],lr[0],lr[1],nt):0;const kr=[];let bn,dn,jr;dn=lr[1].sub(lr[0])._perp()._unit();let ti=!0;for(let zn=1,yn=0;zn<lr.length;zn++){let Br=lr[zn-1],Wn=lr[zn];const Wi=lr[zn===lr.length-1?1:zn+1];if(te.appendEdge(oe,Wn,Br),$T(Wn,Br,Bt)){nt&&(dn=Wi.sub(Wn)._perp()._unit(),ti=!ti);continue}const ci=Wn.sub(Br)._perp(),Hi=ci.x/(Math.abs(ci.x)+Math.abs(ci.y)),Ei=ci.y>0?1:0,ao=Br.dist(Wn);if(yn+ao>32768&&(yn=0),nt){jr=Wi.sub(Wn)._perp()._unit();let So=ek(Br,Wn,Wi,QM(dn,jr),nt);isNaN(So)&&(So=0);const Po=Wn.sub(Br)._unit();Br=Br.add(Po.mult(Yr))._round(),Wn=Wn.add(Po.mult(-So))._round(),Yr=So,dn=jr,pe&&this.zoom>=17&&(gt(kr,Br)||kr.push(Br),gt(kr,Wn)||kr.push(Wn))}const Ri=_r.vertexLength,Wo=lr.length>4&&rk(Br,Wn,Wi);let _o=nk(yn,Sr,ti);if(hx(this.layoutVertexArray,Br.x,Br.y,Hi,Ei,0,0,_o),hx(this.layoutVertexArray,Br.x,Br.y,Hi,Ei,0,1,_o),yn+=ao,_o=nk(yn,Wo,!ti),Sr=Wo,hx(this.layoutVertexArray,Wn.x,Wn.y,Hi,Ei,0,0,_o),hx(this.layoutVertexArray,Wn.x,Wn.y,Hi,Ei,0,1,_o),_r.vertexLength+=4,this.indexArray.emplaceBack(Ri+0,Ri+1,Ri+2),this.indexArray.emplaceBack(Ri+1,Ri+3,Ri+2),_r.primitiveLength+=2,nt){const So=Yt+(zn===1?lr.length-2:zn-2),Po=zn===1?Yt:So+1;if(this.indexArray.emplaceBack(Ri+1,So,Ri+3),this.indexArray.emplaceBack(So,Po,Ri+3),_r.primitiveLength+=2,bn===void 0&&(bn=Ri),!$T(Wi,lr[zn],Bt)){const yo=zn===lr.length-1?bn:_r.vertexLength;this.indexArray.emplaceBack(Ri+2,Ri+3,yo),this.indexArray.emplaceBack(Ri+3,yo+1,yo),this.indexArray.emplaceBack(Ri+3,Po,yo+1),_r.primitiveLength+=3}ti=!ti}if(q){const So=this.layoutVertexExtArray,Po=V.projectTilePoint(Br.x,Br.y,m),yo=V.projectTilePoint(Wn.x,Wn.y,m),Sa=V.upVector(m,Br.x,Br.y),Lo=V.upVector(m,Wn.x,Wn.y);dx(So,Po,Sa),dx(So,Po,Sa),dx(So,yo,Lo),dx(So,yo,Lo)}}Q&&(Yt+=lr.length-1),pe&&nt&&this.zoom>=17&&(kr.length!==0&&gt(kr,kr[0])&&kr.pop(),this.groundEffect.addData(kr,Bt,R,nt>0))}this.footprintSegments.push(dr),Pr.triangleCount=this.indexArray.length-Pr.triangleArrayOffset,this.polygonSegments.push(Pr),++oe.footprintSegLen,++oe.polygonSegLen}if(oe.vertexCount=this.layoutVertexArray.length-oe.vertexArrayOffset,oe.groundVertexCount=this.groundEffect.vertexArray.length-oe.groundVertexArrayOffset,oe.vertexCount!==0){if(oe.centroidXY=te.borders?HM:this.encodeCentroid(te,oe),this.centroidData.push(oe),te.borders){this.featuresOnBorder.push(te);const At=this.featuresOnBorder.length-1;for(let Bt=0;Bt<te.borders.length;Bt++)te.borders[Bt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Bt].push(At)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,b,m,k),this.groundEffect.addPaintPropertiesData(t,c,g,b,m,k),this.maxHeight=Math.max(this.maxHeight,_e)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((i,c)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}splitToSubtiles(){const t=[];for(let C=0;C<this.centroidData.length;C++){const k=this.centroidData[C],R=+(k.min.y+k.max.y>Jr),z=2*R+(+(k.min.x+k.max.x>Jr)^R);for(let V=0;V<k.polygonSegLen;V++){const q=k.polygonSegIdx+V;t.push({centroidIdx:C,subtile:z,polygonSegmentIdx:q,triangleSegmentIdx:this.polygonSegments[q].triangleSegIdx})}}const i=new Wa;t.sort((C,k)=>C.triangleSegmentIdx===k.triangleSegmentIdx?C.subtile-k.subtile:C.triangleSegmentIdx-k.triangleSegmentIdx);let c=0,m=0,g=0;for(const C of t){if(C.triangleSegmentIdx!==c)break;g++}const b=t.length;for(;m!==t.length;){c=t[m].triangleSegmentIdx;let C=0,k=m,R=m;for(let z=k;z<g&&t[z].subtile===C;z++)R++;for(;k!==g;){const z=t[k];C=z.subtile;const V=this.centroidData[z.centroidIdx].min.clone(),q=this.centroidData[z.centroidIdx].max.clone(),Q={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let te=k;te<R;te++){const oe=t[te],pe=this.polygonSegments[oe.polygonSegmentIdx],_e=this.centroidData[oe.centroidIdx].min,ze=this.centroidData[oe.centroidIdx].max,Ue=this.indexArray.uint16;for(let Ve=pe.triangleArrayOffset;Ve<pe.triangleArrayOffset+pe.triangleCount;Ve++)i.emplaceBack(Ue[3*Ve],Ue[3*Ve+1],Ue[3*Ve+2]);Q.primitiveLength+=pe.triangleCount,V.x=Math.min(V.x,_e.x),V.y=Math.min(V.y,_e.y),q.x=Math.max(q.x,ze.x),q.y=Math.max(q.y,ze.y)}Q.primitiveLength>0&&this.triangleSubSegments.push({segment:Q,min:V,max:q}),k=R;for(let te=k;te<g&&t[te].subtile===t[k].subtile;te++)R++}m=g;for(let z=m;z<b&&t[z].triangleSegmentIdx===t[m].triangleSegmentIdx;z++)g++}i._trim(),this.indexArray=i}getVisibleSegments(t,i,c){let m=0,g=0;const b=1<<t.canonical.z;if(i){const oe=i.getMinMaxForTile(t);oe&&(m=oe.min,g=oe.max)}g+=this.maxHeight;const C=t.toUnwrapped();let k;const R=[C.canonical.x/b+C.wrap,C.canonical.y/b],z=[(C.canonical.x+1)/b+C.wrap,(C.canonical.y+1)/b],V=new ua,q=(oe,pe,_e)=>[oe[0]*(1-_e[0])+pe[0]*_e[0],oe[1]*(1-_e[1])+pe[1]*_e[1]],Q=[],te=[];for(const oe of this.triangleSubSegments){Q[0]=oe.min.x/Jr,Q[1]=oe.min.y/Jr,te[0]=oe.max.x/Jr,te[1]=oe.max.y/Jr;const pe=q(R,z,Q),_e=q(R,z,te);if(new Ko([pe[0],pe[1],m],[_e[0],_e[1],g]).intersectsPrecise(c)===0){k&&(V.segments.push(k),k=void 0);continue}const ze=oe.segment;k&&k.vertexOffset!==ze.vertexOffset&&(V.segments.push(k),k=void 0),k?(k.vertexLength+=ze.vertexLength,k.primitiveLength+=ze.primitiveLength):k={vertexOffset:ze.vertexOffset,primitiveLength:ze.primitiveLength,vertexLength:ze.vertexLength,primitiveOffset:ze.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&V.segments.push(k),V}encodeCentroid(t,i){const c=t.centroid(),m=i.span(),g=Math.min(7,Math.round(m.x*this.tileToMeter/10)),b=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new Ge(Ht(c.x,1,Jr-1)<<3|g,Ht(c.y,1,Jr-1)<<3|b)}encodeBorderCentroid(t){if(!t.borders)return new Ge(0,0);const i=t.borders,c=Number.MAX_VALUE;if(i[0][0]!==c||i[1][0]!==c){const m=i[0][0]!==c?0:1;return new Ge(6|(i[0][0]!==c?0:65528),(i[m][0]+i[m][1])/2<<3|6)}{const m=i[2][0]!==c?2:3;return new Ge((i[m][0]+i[m][1])/2<<3|6,6|(i[2][0]!==c?0:65528))}}showCentroid(t){const i=this.centroidData[t.centroidDataIndex];i.flags&=xg,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const i=t.vertexArrayOffset,c=t.vertexCount+t.vertexArrayOffset,m=t.flags&xg?HM:t.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==m.y||g!==m.x){for(let b=i;b<c;++b)this.centroidVertexArray.emplace(b,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const c=i.getReplacementRegionsForTile(t.toUnwrapped());if(function(g,b){if(g.length!==b.length)return!1;for(let C=0;C<g.length;C++)if(g[C].sourceId!==b[C].sourceId||!LM(g[C],b[C]))return!1;return!0}(this.activeReplacements,c))return;if(this.activeReplacements=c,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const m=[];for(const g of this.activeReplacements){const b=Math.pow(2,g.footprintTileId.canonical.z-t.canonical.z);for(const C of this.centroidData)if(!(C.flags&xg||g.min.x>C.max.x||C.min.x>g.max.x||g.min.y>C.max.y||C.min.y>g.max.y))for(let k=0;k<C.footprintSegLen;k++){const R=this.footprintSegments[C.footprintSegIdx+k];if(m.length=0,mF(this.footprintVertices,R.vertexOffset,R.vertexCount,g.footprintTileId.canonical,t.canonical,m),jM(g.footprint,m,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-b)){C.flags|=xg;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,i,c){let m=!1;for(let g=0;g<c.footprintSegLen;g++){const b=this.footprintSegments[c.footprintSegIdx+g];let C=0;for(const k of b.ringIndices){for(let R=C,z=k+C-1;R<k+C;z=R++){const V=this.footprintVertices.int16[2*(R+b.vertexOffset)+0],q=this.footprintVertices.int16[2*(R+b.vertexOffset)+1],Q=this.footprintVertices.int16[2*(z+b.vertexOffset)+1];q>i!=Q>i&&t<(this.footprintVertices.int16[2*(z+b.vertexOffset)+0]-V)*(i-q)/(Q-q)+V&&(m=!m)}C=k}}return m}getHeightAtTileCoord(t,i){let c=Number.NEGATIVE_INFINITY,m=!0;const g=4*(t+Jr)*Jr+(i+Jr);if(this.partLookup.hasOwnProperty(g)){const b=this.partLookup[g];return b?{height:b.height,hidden:!!(b.flags&xg)}:void 0}for(const b of this.centroidData)t>b.max.x||b.min.x>t||i>b.max.y||b.min.y>i||this.footprintContainsPoint(t,i,b)&&b&&b.height>c&&(c=b.height,this.partLookup[g]=b,m=!!(b.flags&xg));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:m};this.partLookup[g]=void 0}}function QM(r,t){const i=r.add(t)._unit();return r.x*i.x+r.y*i.y}function fF(r,t,i,c){const m=t.sub(r)._perp()._unit(),g=i.sub(t)._perp()._unit();return ek(r,t,i,QM(m,g),c)}function ek(r,t,i,c,m){const g=Math.sqrt(1-c*c);return Math.min(r.dist(t)/3,t.dist(i)/3,m*g/c)}function $T(r,t,i){return r.x<i[0].x&&t.x<i[0].x||r.x>i[1].x&&t.x>i[1].x||r.y<i[0].y&&t.y<i[0].y||r.y>i[1].y&&t.y>i[1].y}function tk(r,t){return r.x<t[0].x||r.x>t[1].x||r.y<t[0].y||r.y>t[1].y}function rk(r,t,i){if(r.x<0||r.x>=Jr||t.x<0||t.x>=Jr||i.x<0||i.x>=Jr)return!1;const c=i.sub(t),m=c.perp(),g=r.sub(t);return(c.x*g.x+c.y*g.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(g.x*g.x+g.y*g.y))>-.866&&m.x*g.x+m.y*g.y<0}function nk(r,t,i){const c=t?2|r:-3&r;return i?1|c:-2&c}function ik(){const r=Math.PI/32,t=Math.tan(r),i=tr;return i*Math.sqrt(1+2*t*t)-i}function ok(r,t,i){const c=1<<i.z,m=Ti(i.x/c),g=Ti((i.x+1)/c),b=ro(i.y/c),C=ro((i.y+1)/c);return function(k,R,z,V,q=0,Q){const te=[];if(!k.length||!z||!V)return te;const oe=(Qe,gt)=>{for(const At of Qe)te.push({polygon:At,bounds:gt})},pe=Math.ceil(Math.log2(z)),_e=Math.ceil(Math.log2(V)),ze=pe-_e,Ue=[];for(let Qe=0;Qe<Math.abs(ze);Qe++)Ue.push(ze>0?0:1);for(let Qe=0;Qe<Math.min(pe,_e);Qe++)Ue.push(0),Ue.push(1);let Ve=k;if(Ve=$b(Ve,R[0].y-q,R[1].y+q,1),Ve=$b(Ve,R[0].x-q,R[1].x+q,0),!Ve.length)return te;const nt=[];for(Ue.length?nt.push({polygons:Ve,bounds:R,depth:0}):oe(Ve,R);nt.length;){const Qe=nt.pop(),gt=Qe.depth,At=Ue[gt],Bt=Qe.bounds[0],Yt=Qe.bounds[1],Ft=At===0?Bt.x:Bt.y,_r=At===0?Yt.x:Yt.y,Pr=Q?Q(At,Ft,_r):.5*(Ft+_r),dr=$b(Qe.polygons,Ft-q,Pr+q,At),Er=$b(Qe.polygons,Pr-q,_r+q,At);if(dr.length){const lr=[Bt,new Ge(At===0?Pr:Yt.x,At===1?Pr:Yt.y)];Ue.length>gt+1?nt.push({polygons:dr,bounds:lr,depth:gt+1}):oe(dr,lr)}if(Er.length){const lr=[new Ge(At===0?Pr:Bt.x,At===1?Pr:Bt.y),Yt];Ue.length>gt+1?nt.push({polygons:Er,bounds:lr,depth:gt+1}):oe(Er,lr)}}return te}(r,t,Math.ceil((g-m)/11.25),Math.ceil((b-C)/11.25),1,(k,R,z)=>{if(k===0)return .5*(R+z);{const V=ro((i.y+R/Jr)/c);return(pi(.5*(ro((i.y+z/Jr)/c)+V))*c-i.y)*Jr}})}function mF(r,t,i,c,m,g){const b=Math.pow(2,c.z-m.z);for(let C=0;C<i;C++){let k=r.int16[2*(C+t)+0],R=r.int16[2*(C+t)+1];k=(k+m.x*Jr)*b-c.x*Jr,R=(R+m.y*Jr)*b-c.y*Jr,g.push(new Ge(k,R))}}re(Hb,"FillExtrusionBucket",{omit:["layers","features"]}),re(XM,"PartData"),re(ZM,"FootprintSegment"),re(YM,"BorderCentroidData"),re(JM,"GroundEffect");const gF=new go({visibility:new Dr(jt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Dr(jt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var _F={paint:new go({"fill-extrusion-opacity":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new an(jt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new an(jt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new an(jt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new an(jt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new an(jt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new an(jt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Dr(jt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:gF};class iv extends Ge{constructor(t,i,c){super(t,i),this.z=c}}function px(r,t){return r.x*t.x+r.y*t.y}function ak(r,t){if(r.length===1){let i=0;const c=t[i++];let m;for(;!m||c.equals(m);)if(m=t[i++],!m)return 1/0;for(;i<t.length;i++){const g=t[i],b=r[0],C=m.sub(c),k=g.sub(c),R=b.sub(c),z=px(C,C),V=px(C,k),q=px(k,k),Q=px(R,C),te=px(R,k),oe=z*q-V*V,pe=(q*Q-V*te)/oe,_e=(z*te-V*Q)/oe,ze=c.z*(1-pe-_e)+m.z*pe+g.z*_e;if(isFinite(ze))return ze}return 1/0}{let i=1/0;for(const c of t)i=Math.min(i,c.z);return i}}function sk(r,t,i,c,m,g,b,C){const k=b*m.getElevationAt(r,t,!0,!0),R=g[0]!==0,z=R?g[1]===0?b*(g[0]/7-450):b*function(V,q,Q){const te=Math.floor(q[0]/8),oe=Math.floor(q[1]/8),pe=10*(q[0]-8*te),_e=10*(q[1]-8*oe),ze=V.getElevationAt(te,oe,!0,!0),Ue=V.getMeterToDEM(Q),Ve=Math.floor(.5*(pe*Ue-1)),nt=Math.floor(.5*(_e*Ue-1)),Qe=V.tileCoordToPixel(te,oe),gt=2*Ve+1,At=2*nt+1,Bt=function(Er,lr,Sr,Yr,kr){return[Er.getElevationAtPixel(lr,Sr,!0),Er.getElevationAtPixel(lr+kr,Sr,!0),Er.getElevationAtPixel(lr,Sr+kr,!0),Er.getElevationAtPixel(lr+Yr,Sr+kr,!0)]}(V,Qe.x-Ve,Qe.y-nt,gt,At),Yt=Math.abs(Bt[0]-Bt[1]),Ft=Math.abs(Bt[2]-Bt[3]),_r=Math.abs(Bt[0]-Bt[2])+Math.abs(Bt[1]-Bt[3]),Pr=Math.min(.25,.5*Ue*(Yt+Ft)/gt),dr=Math.min(.25,.5*Ue*_r/At);return ze+Math.max(Pr*pe,dr*_e)}(m,g,C):k;return{base:k+(i===0)?-1:i,top:R?Math.max(z+c,k+i+2):k+c}}const yF=bo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:vF}=yF,xF=bo([{name:"a_packed",components:4,type:"Float32"}]),{members:bF}=xF;class lk{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new bp({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const c=this.getKey(t,i);return this.positions[c]}trim(){const t=this.width,i=this.height=Vn(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,c){const m=[];let g=t.length%2==1?-t[t.length-1]*c:0,b=t[0]*c,C=!0;m.push({left:g,right:b,isDash:C,zeroLength:t[0]===0});let k=t[0];for(let R=1;R<t.length;R++){C=!C;const z=t[R];g=k*c,k+=z,b=k*c,m.push({left:g,right:b,isDash:C,zeroLength:z===0})}return m}addRoundDash(t,i,c){const m=i/2;for(let g=-c;g<=c;g++){const b=this.width*(this.nextRow+c+g);let C=0,k=t[C];for(let R=0;R<this.width;R++){R/k.right>1&&(k=t[++C]);const z=Math.abs(R-k.left),V=Math.abs(R-k.right),q=Math.min(z,V);let Q;const te=g/c*(m+1);if(k.isDash){const oe=m-Math.abs(te);Q=Math.sqrt(q*q+oe*oe)}else Q=m-Math.sqrt(q*q+te*te);this.image.data[b+R]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(t,i){for(let k=t.length-1;k>=0;--k){const R=t[k],z=t[k+1];R.zeroLength?t.splice(k,1):z&&z.isDash===R.isDash&&(z.left=R.left,t.splice(k,1))}const c=t[0],m=t[t.length-1];c.isDash===m.isDash&&(c.left=m.left-this.width,m.right=c.right+this.width);const g=this.width*this.nextRow;let b=0,C=t[b];for(let k=0;k<this.width;k++){k/C.right>1&&(C=t[++b]);const R=Math.abs(k-C.left),z=Math.abs(k-C.right),V=Math.min(R,z);this.image.data[g+k]=Math.max(0,Math.min(255,(C.isDash?V:-V)+i+128))}}addDash(t,i){const c=this.getKey(t,i);if(this.positions[c])return this.positions[c];const m=i==="round",g=m?7:0,b=2*g+1;if(this.nextRow+b>this.height)return Kt("LineAtlas out of space"),null;t.length===0&&t.push(1);let C=0;for(let z=0;z<t.length;z++)t[z]<0&&(Kt("Negative value is found in line dasharray, replacing values with 0"),t[z]=0),C+=t[z];if(C!==0){const z=this.width/C,V=this.getDashRanges(t,this.width,z);m?this.addRoundDash(V,z,g):this.addRegularDash(V,i==="square"?.5*z:0)}const k=this.nextRow+g;this.nextRow+=b;const R={tl:[k,g],br:[C,0]};return this.positions[c]=R,R}}re(lk,"LineAtlas");const wF=Ub.types,SF=Math.cos(Math.PI/180*37.5);class GT{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Mh,this.layoutVertexArray2=new Ja,this.indexArray=new Wa,this.programConfigurations=new we(t.layers,t.zoom),this.segments=new ua,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,c,m){this.hasPattern=lx("line",this.layers,i);const g=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:z,id:V,index:q,sourceLayerIndex:Q}of t){const te=this.layers[0]._featureFilter.needGeometry,oe=ls(z,te);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),oe,c))continue;const pe=g?g.evaluate(oe,{},c):void 0,_e={id:V,properties:z.properties,type:z.type,sourceLayerIndex:Q,index:q,geometry:te?oe.geometry:ss(z,c,m),patterns:{},sortKey:pe};b.push(_e)}g&&b.sort((z,V)=>z.sortKey-V.sortKey);const{lineAtlas:C,featureIndex:k}=i,R=this.addConstantDashes(C);for(const z of b){const{geometry:V,index:q,sourceLayerIndex:Q}=z;if(R&&this.addFeatureDashes(z,C),this.hasPattern){const te=cx("line",this.layers,z,this.zoom,i);this.patternFeatures.push(te)}else this.addFeature(z,V,q,c,C.positions,i.availableImages,i.brightness);k.insert(t[q].feature,V,q,Q,this.index)}}addConstantDashes(t){let i=!1;for(const c of this.layers){const m=c.paint.get("line-dasharray").value,g=c.layout.get("line-cap").value;if(m.kind!=="constant"||g.kind!=="constant")i=!0;else{const b=g.value,C=m.value;if(!C)continue;t.addDash(C,b)}}return i}addFeatureDashes(t,i){const c=this.zoom;for(const m of this.layers){const g=m.paint.get("line-dasharray").value,b=m.layout.get("line-cap").value;if(g.kind==="constant"&&b.kind==="constant")continue;let C,k;if(g.kind==="constant"){if(C=g.value,!C)continue}else C=g.evaluate({zoom:c},t);k=b.kind==="constant"?b.value:b.evaluate({zoom:c},t),i.addDash(C,k),t.patterns[m.id]=i.getKey(C,k)}}update(t,i,c,m,g){const b=Object.keys(t).length!==0;b&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,b?this.stateDependentLayers:this.layers,c,m,g)}addFeatures(t,i,c,m,g,b){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,i,c,m,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,bF)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vF),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,c,m,g,b,C){const k=this.layers[0].layout,R=k.get("line-join").evaluate(t,{}),z=k.get("line-cap").evaluate(t,{}),V=k.get("line-miter-limit"),q=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const Q of i)this.addLine(Q,t,R,z,V,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,b,m,C)}addLine(t,i,c,m,g,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=wF[i.type]==="Polygon";let k=t.length;for(;k>=2&&t[k-1].equals(t[k-2]);)k--;let R=0;for(;R<k-1&&t[R].equals(t[R+1]);)R++;if(k<(C?3:2))return;c==="bevel"&&(g=1.05);const z=this.overscaling<=16?15*Jr/(512*this.overscaling):0,V=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let q,Q,te,oe,pe;this.e1=this.e2=-1,C&&(q=t[k-2],pe=t[R].sub(q)._unit()._perp());for(let _e=R;_e<k;_e++){if(te=_e===k-1?C?t[R+1]:void 0:t[_e+1],te&&t[_e].equals(te))continue;pe&&(oe=pe),q&&(Q=q),q=t[_e],pe=te?te.sub(q)._unit()._perp():oe,oe=oe||pe;let ze=oe.add(pe);ze.x===0&&ze.y===0||ze._unit();const Ue=oe.x*pe.x+oe.y*pe.y,Ve=ze.x*pe.x+ze.y*pe.y,nt=Ve!==0?1/Ve:1/0,Qe=2*Math.sqrt(2-2*Ve),gt=Ve<SF&&Q&&te,At=oe.x*pe.y-oe.y*pe.x>0;if(gt&&_e>R){const Ft=q.dist(Q);if(Ft>2*z){const _r=q.sub(q.sub(Q)._mult(z/Ft)._round());this.updateDistance(Q,_r),this.addCurrentVertex(_r,oe,0,0,V),Q=_r}}const Bt=Q&&te;let Yt=Bt?c:C?"butt":m;if(Bt&&Yt==="round"&&(nt<b?Yt="miter":nt<=2&&(Yt="fakeround")),Yt==="miter"&&nt>g&&(Yt="bevel"),Yt==="bevel"&&(nt>2&&(Yt="flipbevel"),nt<g&&(Yt="miter")),Q&&this.updateDistance(Q,q),Yt==="miter")ze._mult(nt),this.addCurrentVertex(q,ze,0,0,V);else if(Yt==="flipbevel"){if(nt>100)ze=pe.mult(-1);else{const Ft=nt*oe.add(pe).mag()/oe.sub(pe).mag();ze._perp()._mult(Ft*(At?-1:1))}this.addCurrentVertex(q,ze,0,0,V),this.addCurrentVertex(q,ze.mult(-1),0,0,V)}else if(Yt==="bevel"||Yt==="fakeround"){const Ft=-Math.sqrt(nt*nt-1),_r=At?Ft:0,Pr=At?0:Ft;if(Q&&this.addCurrentVertex(q,oe,_r,Pr,V),Yt==="fakeround"){const dr=Math.round(180*Qe/Math.PI/20);for(let Er=1;Er<dr;Er++){let lr=Er/dr;if(lr!==.5){const Yr=lr-.5;lr+=lr*Yr*(lr-1)*((1.0904+Ue*(Ue*(3.55645-1.43519*Ue)-3.2452))*Yr*Yr+(.848013+Ue*(.215638*Ue-1.06021)))}const Sr=pe.sub(oe)._mult(lr)._add(oe)._unit()._mult(At?-1:1);this.addHalfVertex(q,Sr.x,Sr.y,!1,At,0,V)}}te&&this.addCurrentVertex(q,pe,-_r,-Pr,V)}else if(Yt==="butt")this.addCurrentVertex(q,ze,0,0,V);else if(Yt==="square"){const Ft=Q?1:-1;Q||this.addCurrentVertex(q,ze,Ft,Ft,V),this.addCurrentVertex(q,ze,0,0,V),Q&&this.addCurrentVertex(q,ze,Ft,Ft,V)}else Yt==="round"&&(Q&&(this.addCurrentVertex(q,oe,0,0,V),this.addCurrentVertex(q,oe,1,1,V,!0)),te&&(this.addCurrentVertex(q,pe,-1,-1,V,!0),this.addCurrentVertex(q,pe,0,0,V)));if(gt&&_e<k-1){const Ft=q.dist(te);if(Ft>2*z){const _r=q.add(te.sub(q)._mult(z/Ft)._round());this.updateDistance(q,_r),this.addCurrentVertex(_r,pe,0,0,V),q=_r}}}}addCurrentVertex(t,i,c,m,g,b=!1){const C=i.y*m-i.x,k=-i.y-i.x*m;this.addHalfVertex(t,i.x+i.y*c,i.y-i.x*c,b,!1,c,g),this.addHalfVertex(t,C,k,b,!0,-m,g)}addHalfVertex({x:t,y:i},c,m,g,b,C,k){this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(i<<1)+(b?1:0),Math.round(63*c)+128,Math.round(63*m)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),k.primitiveLength++),b?this.e2=R:this.e1=R}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}re(GT,"LineBucket",{omit:["layers","patternFeatures"]});const TF=new go({"line-cap":new an(jt.layout_line["line-cap"]),"line-join":new an(jt.layout_line["line-join"]),"line-miter-limit":new Dr(jt.layout_line["line-miter-limit"]),"line-round-limit":new Dr(jt.layout_line["line-round-limit"]),"line-sort-key":new an(jt.layout_line["line-sort-key"]),visibility:new Dr(jt.layout_line.visibility)});var ck={paint:new go({"line-opacity":new an(jt.paint_line["line-opacity"]),"line-color":new an(jt.paint_line["line-color"]),"line-translate":new Dr(jt.paint_line["line-translate"]),"line-translate-anchor":new Dr(jt.paint_line["line-translate-anchor"]),"line-width":new an(jt.paint_line["line-width"]),"line-gap-width":new an(jt.paint_line["line-gap-width"]),"line-offset":new an(jt.paint_line["line-offset"]),"line-blur":new an(jt.paint_line["line-blur"]),"line-dasharray":new an(jt.paint_line["line-dasharray"]),"line-pattern":new an(jt.paint_line["line-pattern"]),"line-gradient":new na(jt.paint_line["line-gradient"]),"line-trim-offset":new Dr(jt.paint_line["line-trim-offset"]),"line-emissive-strength":new Dr(jt.paint_line["line-emissive-strength"]),"line-border-width":new an(jt.paint_line["line-border-width"]),"line-border-color":new an(jt.paint_line["line-border-color"])}),layout:TF};function uk(r,t,i){return t*(Jr/(r.tileSize*Math.pow(2,i-r.tileID.overscaledZ)))}function hk(r,t){return 1/uk(r,1,t.tileZoom)}function dk(r,t,i,c){return r.translatePosMatrix(c||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const pk=r=>{const t=[];fk(r)&&t.push("RENDER_LINE_DASH"),r.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=r.paint.get("line-trim-offset");return i[0]===0&&i[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),r.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function fk(r){const t=r.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const mk=new class extends an{possiblyEvaluate(r,t){return t=new $n(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,i,c){return t=ln({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,i,c)}}(ck.paint.properties["line-width"].specification);function gk(r,t){return t>0?t+2*r:r}mk.useIntegerZoom=!0;const EF=bo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),IF=bo([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),CF=bo([{name:"a_projected_pos",components:4,type:"Float32"}],4);bo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const AF=bo([{name:"a_z_offset",components:1,type:"Float32"}],4),PF=bo([{name:"a_texb",components:2,type:"Uint16"}]),MF=bo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),kF=bo([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);bo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _k=bo([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),RF=bo([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bo([{name:"triangle",components:3,type:"Uint16"}]),bo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bo([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),bo([{type:"Float32",name:"offsetX"}]),bo([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Vl=24;const Tp=128;function qT(r,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new $n(r+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:m}=i;let g=0;for(;g<c.length&&c[g]<=r;)g++;g=Math.max(0,g-1);let b=g;for(;b<c.length&&c[b]<r+1;)b++;b=Math.min(c.length-1,b);const C=c[g],k=c[b];return i.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:k,interpolationType:m}:{kind:"camera",minZoom:C,maxZoom:k,minSize:i.evaluate(new $n(C)),maxSize:i.evaluate(new $n(k)),interpolationType:m}}}function Zb(r,{uSize:t,uSizeT:i},{lowerSize:c,upperSize:m}){return r.kind==="source"?c/Tp:r.kind==="composite"?Hn(c/Tp,m/Tp,i):t}function ov(r,t){let i=0,c=0;if(r.kind==="constant")c=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:m,minZoom:g,maxZoom:b}=r,C=m?Ht(Ys.interpolationFactor(m,t,g,b),0,1):0;r.kind==="camera"?c=Hn(r.minSize,r.maxSize,C):i=C}return{uSizeT:i,uSize:c}}var DF=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Tp,evaluateSizeForFeature:Zb,evaluateSizeForZoom:ov,getSizeData:qT});function OF(r,t,i){return r.sections.forEach(c=>{c.text=function(m,g,b){const C=g.layout.get("text-transform").evaluate(b,{});return C==="uppercase"?m=m.toLocaleUpperCase():C==="lowercase"&&(m=m.toLocaleLowerCase()),Qn.applyArabicShaping&&(m=Qn.applyArabicShaping(m)),m}(c.text,t,i)}),r}const fx={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function LF(r){return r==="︶"||r==="﹈"||r==="︸"||r==="﹄"||r==="﹂"||r==="︾"||r==="︼"||r==="︺"||r==="︘"||r==="﹀"||r==="︐"||r==="︓"||r==="︔"||r==="｀"||r==="￣"||r==="︑"||r==="︒"}function zF(r){return r==="︵"||r==="﹇"||r==="︷"||r==="﹃"||r==="﹁"||r==="︽"||r==="︻"||r==="︹"||r==="︗"||r==="︿"}var NF={read:function(r,t,i,c,m){var g,b,C=8*m-c-1,k=(1<<C)-1,R=k>>1,z=-7,V=i?m-1:0,q=i?-1:1,Q=r[t+V];for(V+=q,g=Q&(1<<-z)-1,Q>>=-z,z+=C;z>0;g=256*g+r[t+V],V+=q,z-=8);for(b=g&(1<<-z)-1,g>>=-z,z+=c;z>0;b=256*b+r[t+V],V+=q,z-=8);if(g===0)g=1-R;else{if(g===k)return b?NaN:1/0*(Q?-1:1);b+=Math.pow(2,c),g-=R}return(Q?-1:1)*b*Math.pow(2,g-c)},write:function(r,t,i,c,m,g){var b,C,k,R=8*g-m-1,z=(1<<R)-1,V=z>>1,q=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,Q=c?0:g-1,te=c?1:-1,oe=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(C=isNaN(t)?1:0,b=z):(b=Math.floor(Math.log(t)/Math.LN2),t*(k=Math.pow(2,-b))<1&&(b--,k*=2),(t+=b+V>=1?q/k:q*Math.pow(2,1-V))*k>=2&&(b++,k/=2),b+V>=z?(C=0,b=z):b+V>=1?(C=(t*k-1)*Math.pow(2,m),b+=V):(C=t*Math.pow(2,V-1)*Math.pow(2,m),b=0));m>=8;r[i+Q]=255&C,Q+=te,C/=256,m-=8);for(b=b<<m|C,R+=m;R>0;r[i+Q]=255&b,Q+=te,b/=256,R-=8);r[i+Q-te]|=128*oe}},yk=wa,Xb=NF;function wa(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}wa.Varint=0,wa.Fixed64=1,wa.Bytes=2,wa.Fixed32=5;var WT=4294967296,vk=1/WT,xk=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function _m(r){return r.type===wa.Bytes?r.readVarint()+r.pos:r.pos+1}function av(r,t,i){return i?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function bk(r,t,i){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(c);for(var m=i.pos-1;m>=r;m--)i.buf[m+c]=i.buf[m]}function jF(r,t){for(var i=0;i<r.length;i++)t.writeVarint(r[i])}function BF(r,t){for(var i=0;i<r.length;i++)t.writeSVarint(r[i])}function FF(r,t){for(var i=0;i<r.length;i++)t.writeFloat(r[i])}function VF(r,t){for(var i=0;i<r.length;i++)t.writeDouble(r[i])}function UF(r,t){for(var i=0;i<r.length;i++)t.writeBoolean(r[i])}function $F(r,t){for(var i=0;i<r.length;i++)t.writeFixed32(r[i])}function GF(r,t){for(var i=0;i<r.length;i++)t.writeSFixed32(r[i])}function qF(r,t){for(var i=0;i<r.length;i++)t.writeFixed64(r[i])}function WF(r,t){for(var i=0;i<r.length;i++)t.writeSFixed64(r[i])}function Yb(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function sv(r,t,i){r[i]=t,r[i+1]=t>>>8,r[i+2]=t>>>16,r[i+3]=t>>>24}function wk(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}wa.prototype={destroy:function(){this.buf=null},readFields:function(r,t,i){for(i=i||this.length;this.pos<i;){var c=this.readVarint(),m=c>>3,g=this.pos;this.type=7&c,r(m,t,this),this.pos===g&&this.skip(c)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=Yb(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=wk(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Yb(this.buf,this.pos)+Yb(this.buf,this.pos+4)*WT;return this.pos+=8,r},readSFixed64:function(){var r=Yb(this.buf,this.pos)+wk(this.buf,this.pos+4)*WT;return this.pos+=8,r},readFloat:function(){var r=Xb.read(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Xb.read(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,i,c=this.buf;return t=127&(i=c[this.pos++]),i<128?t:(t|=(127&(i=c[this.pos++]))<<7,i<128?t:(t|=(127&(i=c[this.pos++]))<<14,i<128?t:(t|=(127&(i=c[this.pos++]))<<21,i<128?t:function(m,g,b){var C,k,R=b.buf;if(C=(112&(k=R[b.pos++]))>>4,k<128||(C|=(127&(k=R[b.pos++]))<<3,k<128)||(C|=(127&(k=R[b.pos++]))<<10,k<128)||(C|=(127&(k=R[b.pos++]))<<17,k<128)||(C|=(127&(k=R[b.pos++]))<<24,k<128)||(C|=(1&(k=R[b.pos++]))<<31,k<128))return av(m,C,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=c[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&xk?function(i,c,m){return xk.decode(i.subarray(c,m))}(this.buf,t,r):function(i,c,m){for(var g="",b=c;b<m;){var C,k,R,z=i[b],V=null,q=z>239?4:z>223?3:z>191?2:1;if(b+q>m)break;q===1?z<128&&(V=z):q===2?(192&(C=i[b+1]))==128&&(V=(31&z)<<6|63&C)<=127&&(V=null):q===3?(k=i[b+2],(192&(C=i[b+1]))==128&&(192&k)==128&&((V=(15&z)<<12|(63&C)<<6|63&k)<=2047||V>=55296&&V<=57343)&&(V=null)):q===4&&(k=i[b+2],R=i[b+3],(192&(C=i[b+1]))==128&&(192&k)==128&&(192&R)==128&&((V=(15&z)<<18|(63&C)<<12|(63&k)<<6|63&R)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,q=1):V>65535&&(V-=65536,g+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),g+=String.fromCharCode(V),b+=q}return g}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==wa.Bytes)return r.push(this.readVarint(t));var i=_m(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==wa.Bytes)return r.push(this.readSVarint());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==wa.Bytes)return r.push(this.readBoolean());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==wa.Bytes)return r.push(this.readFloat());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==wa.Bytes)return r.push(this.readDouble());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==wa.Bytes)return r.push(this.readFixed32());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==wa.Bytes)return r.push(this.readSFixed32());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==wa.Bytes)return r.push(this.readFixed64());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==wa.Bytes)return r.push(this.readSFixed64());var t=_m(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===wa.Varint)for(;this.buf[this.pos++]>127;);else if(t===wa.Bytes)this.pos=this.readVarint()+this.pos;else if(t===wa.Fixed32)this.pos+=4;else{if(t!==wa.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),sv(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),sv(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),sv(this.buf,-1&r,this.pos),sv(this.buf,Math.floor(r*vk),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),sv(this.buf,-1&r,this.pos),sv(this.buf,Math.floor(r*vk),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,i){var c,m;if(t>=0?(c=t%4294967296|0,m=t/4294967296|0):(m=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,m=m+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(g,b,C){C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,C.buf[C.pos]=127&(g>>>=7)}(c,0,i),function(g,b){var C=(7&g)<<4;b.buf[b.pos++]|=C|((g>>>=3)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g)))))}(m,i)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(c,m,g){for(var b,C,k=0;k<m.length;k++){if((b=m.charCodeAt(k))>55295&&b<57344){if(!C){b>56319||k+1===m.length?(c[g++]=239,c[g++]=191,c[g++]=189):C=b;continue}if(b<56320){c[g++]=239,c[g++]=191,c[g++]=189,C=b;continue}b=C-55296<<10|b-56320|65536,C=null}else C&&(c[g++]=239,c[g++]=191,c[g++]=189,C=null);b<128?c[g++]=b:(b<2048?c[g++]=b>>6|192:(b<65536?c[g++]=b>>12|224:(c[g++]=b>>18|240,c[g++]=b>>12&63|128),c[g++]=b>>6&63|128),c[g++]=63&b|128)}return g}(this.buf,r,this.pos);var i=this.pos-t;i>=128&&bk(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),Xb.write(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Xb.write(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,t){this.pos++;var i=this.pos;r(t,this);var c=this.pos-i;c>=128&&bk(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c},writeMessage:function(r,t,i){this.writeTag(r,wa.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,jF,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,BF,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,UF,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,FF,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,VF,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,$F,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,GF,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,qF,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,WF,t)},writeBytesField:function(r,t){this.writeTag(r,wa.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,wa.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,wa.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,wa.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,wa.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,wa.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,wa.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,wa.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,wa.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,wa.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var lv=ce(yk);const HT=3;function HF(r,t,i){t.glyphs=[],r===1&&i.readMessage(ZF,t)}function ZF(r,t,i){if(r===3){const{id:c,bitmap:m,width:g,height:b,left:C,top:k,advance:R}=i.readMessage(XF,{});t.glyphs.push({id:c,bitmap:new bp({width:g+2*HT,height:b+2*HT},m),metrics:{width:g,height:b,left:C,top:k,advance:R}})}else r===4?t.ascender=i.readSVarint():r===5&&(t.descender=i.readSVarint())}function XF(r,t,i){r===1?t.id=i.readVarint():r===2?t.bitmap=i.readBytes():r===3?t.width=i.readVarint():r===4?t.height=i.readVarint():r===5?t.left=i.readSVarint():r===6?t.top=i.readSVarint():r===7&&(t.advance=i.readVarint())}const Sk=HT,Nh={horizontal:1,vertical:2,horizontalOnly:3};class mx{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const c=new mx;return c.scale=t||1,c.fontStack=i,c}static forImage(t){const i=new mx;return i.imageName=t,i}}class cv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const c=new cv;for(let m=0;m<t.sections.length;m++){const g=t.sections[m];g.image?c.addImageSection(g):c.addTextSection(g,i)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(i,c){let m="";for(let g=0;g<i.length;g++){const b=i.charCodeAt(g+1)||null,C=i.charCodeAt(g-1)||null;m+=!c&&(b&&It(b)&&!fx[i[g+1]]||C&&It(C)&&!fx[i[g-1]])||!fx[i[g]]?i[g]:fx[i[g]]}return m}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&Kb[this.text.charCodeAt(c)];c++)t++;let i=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&Kb[this.text.charCodeAt(c)];c--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const c=new cv;return c.text=this.text.substring(t,i),c.sectionIndex=this.sectionIndex.slice(t,i),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(mx.forText(t.scale,t.fontStack||i));const c=this.sections.length-1;for(let m=0;m<t.text.length;++m)this.sectionIndex.push(c)}addImageSection(t){const i=t.image?t.image.namePrimary:"";if(i.length===0)return void Kt("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(mx.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Kt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ZT(r,t,i,c,m,g,b,C,k,R,z,V,q,Q,te){const oe=cv.fromFeature(r,m);V===Nh.vertical&&oe.verticalizePunctuation(q);let pe=[];const _e=function(Qe,gt,At,Bt,Yt,Ft){if(!Qe)return[];const _r=[],Pr=function(Sr,Yr,kr,bn,dn,jr){let ti=0;for(let zn=0;zn<Sr.length();zn++){const yn=Sr.getSection(zn);ti+=Tk(Sr.getCodePoint(zn),yn,bn,dn,Yr,jr)}return ti/Math.max(1,Math.ceil(ti/kr))}(Qe,gt,At,Bt,Yt,Ft),dr=Qe.text.indexOf("​")>=0;let Er=0;for(let Sr=0;Sr<Qe.length();Sr++){const Yr=Qe.getSection(Sr),kr=Qe.getCodePoint(Sr);if(Kb[kr]||(Er+=Tk(kr,Yr,Bt,Yt,gt,Ft)),Sr<Qe.length()-1){const bn=!((lr=kr)<11904||!(ke["Bopomofo Extended"](lr)||ke.Bopomofo(lr)||ke["CJK Compatibility Forms"](lr)||ke["CJK Compatibility Ideographs"](lr)||ke["CJK Compatibility"](lr)||ke["CJK Radicals Supplement"](lr)||ke["CJK Strokes"](lr)||ke["CJK Symbols and Punctuation"](lr)||ke["CJK Unified Ideographs Extension A"](lr)||ke["CJK Unified Ideographs"](lr)||ke["Enclosed CJK Letters and Months"](lr)||ke["Halfwidth and Fullwidth Forms"](lr)||ke.Hiragana(lr)||ke["Ideographic Description Characters"](lr)||ke["Kangxi Radicals"](lr)||ke["Katakana Phonetic Extensions"](lr)||ke.Katakana(lr)||ke["Vertical Forms"](lr)||ke["Yi Radicals"](lr)||ke["Yi Syllables"](lr)));(YF[kr]||bn||Yr.imageName)&&_r.push(Ik(Sr+1,Er,Pr,_r,KF(kr,Qe.getCodePoint(Sr+1),bn&&dr),!1))}}var lr;return Ck(Ik(Qe.length(),Er,Pr,_r,0,!0))}(oe,R,g,t,c,Q),{processBidirectionalText:ze,processStyledBidirectionalText:Ue}=Qn;if(ze&&oe.sections.length===1){const Qe=ze(oe.toString(),_e);for(const gt of Qe){const At=new cv;At.text=gt,At.sections=oe.sections;for(let Bt=0;Bt<gt.length;Bt++)At.sectionIndex.push(0);pe.push(At)}}else if(Ue){const Qe=Ue(oe.text,oe.sectionIndex,_e);for(const gt of Qe){const At=new cv;At.text=gt[0],At.sectionIndex=gt[1],At.sections=oe.sections,pe.push(At)}}else pe=function(Qe,gt){const At=[],Bt=Qe.text;let Yt=0;for(const Ft of gt)At.push(Qe.substring(Yt,Ft)),Yt=Ft;return Yt<Bt.length&&At.push(Qe.substring(Yt,Bt.length)),At}(oe,_e);const Ve=[],nt={positionedLines:Ve,text:oe.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr,Er,lr,Sr){let Yr=0,kr=0,bn=0;const dn=Pr==="right"?1:Pr==="left"?0:.5;let jr=!1;for(const Wi of Yt){const ci=Wi.getSections();for(const Hi of ci){if(Hi.imageName)continue;const Ei=gt[Hi.fontStack];if(Ei&&(jr=Ei.ascender!==void 0&&Ei.descender!==void 0,!jr))break}if(!jr)break}let ti=0;for(const Wi of Yt){Wi.trim();const ci=Wi.getMaxScale(),Hi=(ci-1)*Vl,Ei={positionedGlyphs:[],lineOffset:0};Qe.positionedLines[ti]=Ei;const ao=Ei.positionedGlyphs;let Ri=0;if(!Wi.length()){kr+=Ft,++ti;continue}let Wo=0,_o=0;for(let Po=0;Po<Wi.length();Po++){const yo=Wi.getSection(Po),Sa=Wi.getSectionIndex(Po),Lo=Wi.getCodePoint(Po);let Za=yo.scale,Bs=null,Il=null,fa=null,ka=Vl,dl=0;const pl=!(dr===Nh.horizontal||!lr&&!lt(Lo)||lr&&(Kb[Lo]||(zn=Lo,ke.Arabic(zn)||ke["Arabic Supplement"](zn)||ke["Arabic Extended-A"](zn)||ke["Arabic Presentation Forms-A"](zn)||ke["Arabic Presentation Forms-B"](zn))));if(yo.imageName){const fl=Bt[yo.imageName];if(!fl)continue;fa=yo.imageName,Qe.iconsInText=Qe.iconsInText||!0,Il=fl.paddedRect;const aa=fl.displaySize;Za=Za*Vl/Sr,Bs={width:aa[0],height:aa[1],left:0,top:-Sk,advance:pl?aa[1]:aa[0],localGlyph:!1},dl=jr?-Bs.height*Za:ci*Vl-17-aa[1]*Za,ka=Bs.advance;const sh=(pl?aa[0]:aa[1])*Za-Vl*ci;sh>0&&sh>Ri&&(Ri=sh)}else{const fl=At[yo.fontStack];if(!fl)continue;fl[Lo]&&(Il=fl[Lo]);const aa=gt[yo.fontStack];if(!aa)continue;const sh=aa.glyphs[Lo];if(!sh)continue;if(Bs=sh.metrics,ka=Lo!==8203?Vl:0,jr){const Cg=aa.ascender!==void 0?Math.abs(aa.ascender):0,Wc=aa.descender!==void 0?Math.abs(aa.descender):0,Tc=(Cg+Wc)*Za;Wo<Tc&&(Wo=Tc,_o=(Cg-Wc)/2*Za),dl=-Cg*Za}else dl=(ci-Za)*Vl-17}pl?(Qe.verticalizable=!0,ao.push({glyph:Lo,imageName:fa,x:Yr,y:kr+dl,vertical:pl,scale:Za,localGlyph:Bs.localGlyph,fontStack:yo.fontStack,sectionIndex:Sa,metrics:Bs,rect:Il}),Yr+=ka*Za+Er):(ao.push({glyph:Lo,imageName:fa,x:Yr,y:kr+dl,vertical:pl,scale:Za,localGlyph:Bs.localGlyph,fontStack:yo.fontStack,sectionIndex:Sa,metrics:Bs,rect:Il}),Yr+=Bs.advance*Za+Er)}ao.length!==0&&(bn=Math.max(Yr-Er,bn),jr?Ak(ao,dn,Ri,_o,Ft*ci/2):Ak(ao,dn,Ri,0,Ft/2)),Yr=0;const So=Ft*ci+Ri;Ei.lineOffset=Math.max(Ri,Hi),kr+=So,++ti}var zn;const yn=kr,{horizontalAlign:Br,verticalAlign:Wn}=XT(_r);(function(Wi,ci,Hi,Ei,ao,Ri){const Wo=(ci-Hi)*ao,_o=-Ri*Ei;for(const So of Wi)for(const Po of So.positionedGlyphs)Po.x+=Wo,Po.y+=_o})(Qe.positionedLines,dn,Br,Wn,bn,yn),Qe.top+=-Wn*yn,Qe.bottom=Qe.top+yn,Qe.left+=-Br*bn,Qe.right=Qe.left+bn,Qe.hasBaseline=jr}(nt,t,i,c,pe,b,C,k,V,R,q,te),!function(Qe){for(const gt of Qe)if(gt.positionedGlyphs.length!==0)return!1;return!0}(Ve)&&nt}const Kb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},YF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Tk(r,t,i,c,m,g){if(t.imageName){const b=c[t.imageName];return b?b.displaySize[0]*t.scale*Vl/g+m:0}{const b=i[t.fontStack],C=b&&b.glyphs[r];return C?C.metrics.advance*t.scale+m:0}}function Ek(r,t,i,c){const m=Math.pow(r-t,2);return c?r<t?m/2:2*m:m+Math.abs(i)*i}function KF(r,t,i){let c=0;return r===10&&(c-=1e4),i&&(c+=150),r!==40&&r!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function Ik(r,t,i,c,m,g){let b=null,C=Ek(t,i,m,g);for(const k of c){const R=Ek(t-k.x,i,m,g)+k.badness;R<=C&&(b=k,C=R)}return{index:r,x:t,priorBreak:b,badness:C}}function Ck(r){return r?Ck(r.priorBreak).concat(r.index):[]}function XT(r){let t=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Ak(r,t,i,c,m){if(!(t||i||c||m))return;const g=r.length-1,b=r[g],C=(b.x+b.metrics.advance*b.scale)*t;for(let k=0;k<=g;k++)r[k].x-=C,r[k].y+=i+c+m}function JF(r,t,i,c){const{horizontalAlign:m,verticalAlign:g}=XT(c),b=i[0]-r.displaySize[0]*m,C=i[1]-r.displaySize[1]*g;return{imagePrimary:r,imageSecondary:t,top:C,bottom:C+r.displaySize[1],left:b,right:b+r.displaySize[0]}}function Pk(r,t,i,c,m,g){const b=r.imagePrimary;let C;if(b.content){const pe=b.content,_e=b.pixelRatio||1;C=[pe[0]/_e,pe[1]/_e,b.displaySize[0]-pe[2]/_e,b.displaySize[1]-pe[3]/_e]}const k=t.left*g,R=t.right*g;let z,V,q,Q;i==="width"||i==="both"?(Q=m[0]+k-c[3],V=m[0]+R+c[1]):(Q=m[0]+(k+R-b.displaySize[0])/2,V=Q+b.displaySize[0]);const te=t.top*g,oe=t.bottom*g;return i==="height"||i==="both"?(z=m[1]+te-c[0],q=m[1]+oe+c[2]):(z=m[1]+(te+oe-b.displaySize[1])/2,q=z+b.displaySize[1]),{imagePrimary:b,imageSecondary:void 0,top:z,right:V,bottom:q,left:Q,collisionPadding:C}}class ym extends Ge{constructor(t,i,c,m,g){super(t,i),this.angle=m,this.z=c,g!==void 0&&(this.segment=g)}clone(){return new ym(this.x,this.y,this.z,this.angle,this.segment)}}function Mk(r,t,i,c,m){if(t.segment===void 0)return!0;let g=t,b=t.segment+1,C=0;for(;C>-i/2;){if(b--,b<0)return!1;C-=r[b].dist(g),g=r[b]}C+=r[b].dist(r[b+1]),b++;const k=[];let R=0;for(;C<i/2;){const z=r[b],V=r[b+1];if(!V)return!1;let q=r[b-1].angleTo(z)-z.angleTo(V);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:C,angleDelta:q}),R+=q;C-k[0].distance>c;)R-=k.shift().angleDelta;if(R>m)return!1;b++,C+=z.dist(V)}return!0}function kk(r){let t=0;for(let i=0;i<r.length-1;i++)t+=r[i].dist(r[i+1]);return t}function Rk(r,t,i){return r?.6*t*i:0}function Dk(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function QF(r,t,i,c,m,g){const b=Rk(i,m,g),C=Dk(i,c)*g;let k=0;const R=kk(r)/2;for(let z=0;z<r.length-1;z++){const V=r[z],q=r[z+1],Q=V.dist(q);if(k+Q>R){const te=(R-k)/Q,oe=Hn(V.x,q.x,te),pe=Hn(V.y,q.y,te),_e=new ym(oe,pe,0,q.angleTo(V),z);return!b||Mk(r,_e,C,b,t)?_e:void 0}k+=Q}}function e6(r,t,i,c,m,g,b,C,k){const R=Rk(c,g,b),z=Dk(c,m),V=z*b,q=r[0].x===0||r[0].x===k||r[0].y===0||r[0].y===k;return t-V<t/4&&(t=V+t/4),Ok(r,q?t/2*C%t:(z/2+2*g)*b*C%t,t,R,i,V,q,!1,k)}function Ok(r,t,i,c,m,g,b,C,k){const R=g/2,z=kk(r);let V=0,q=t-i,Q=[];for(let te=0;te<r.length-1;te++){const oe=r[te],pe=r[te+1],_e=oe.dist(pe),ze=pe.angleTo(oe);for(;q+i<V+_e;){q+=i;const Ue=(q-V)/_e,Ve=Hn(oe.x,pe.x,Ue),nt=Hn(oe.y,pe.y,Ue);if(Ve>=0&&Ve<k&&nt>=0&&nt<k&&q-R>=0&&q+R<=z){const Qe=new ym(Ve,nt,0,ze,te);c&&!Mk(r,Qe,g,c,m)||Q.push(Qe)}}V+=_e}return C||Q.length||b||(Q=Ok(r,V/2,i,c,m,g,b,!0,k)),Q}function Lk(r,t,i,c,m){const g=[];for(let b=0;b<r.length;b++){const C=r[b];let k;for(let R=0;R<C.length-1;R++){let z=C[R],V=C[R+1];z.x<t&&V.x<t||(z.x<t?z=new Ge(t,z.y+(t-z.x)/(V.x-z.x)*(V.y-z.y))._round():V.x<t&&(V=new Ge(t,z.y+(t-z.x)/(V.x-z.x)*(V.y-z.y))._round()),z.y<i&&V.y<i||(z.y<i?z=new Ge(z.x+(i-z.y)/(V.y-z.y)*(V.x-z.x),i)._round():V.y<i&&(V=new Ge(z.x+(i-z.y)/(V.y-z.y)*(V.x-z.x),i)._round()),z.x>=c&&V.x>=c||(z.x>=c?z=new Ge(c,z.y+(c-z.x)/(V.x-z.x)*(V.y-z.y))._round():V.x>=c&&(V=new Ge(c,z.y+(c-z.x)/(V.x-z.x)*(V.y-z.y))._round()),z.y>=m&&V.y>=m||(z.y>=m?z=new Ge(z.x+(m-z.y)/(V.y-z.y)*(V.x-z.x),m)._round():V.y>=m&&(V=new Ge(z.x+(m-z.y)/(V.y-z.y)*(V.x-z.x),m)._round()),k&&z.equals(k[k.length-1])||(k=[z],g.push(k)),k.push(V)))))}}return g}function zk(r){let t=0,i=0;for(const b of r)t+=b.w*b.h,i=Math.max(i,b.w);r.sort((b,C)=>C.h-b.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let m=0,g=0;for(const b of r)for(let C=c.length-1;C>=0;C--){const k=c[C];if(!(b.w>k.w||b.h>k.h)){if(b.x=k.x,b.y=k.y,g=Math.max(g,b.y+b.h),m=Math.max(m,b.x+b.w),b.w===k.w&&b.h===k.h){const R=c.pop();C<c.length&&(c[C]=R)}else b.h===k.h?(k.x+=b.w,k.w-=b.w):b.w===k.w?(k.y+=b.h,k.h-=b.h):(c.push({x:k.x+b.w,y:k.y,w:k.w-b.w,h:b.h}),k.y+=b.h,k.h-=b.h);break}}return{w:m,h:g,fill:t/(m*g)||0}}re(ym,"Anchor");const ah=1;class YT{constructor(t,{pixelRatio:i,version:c,stretchX:m,stretchY:g,content:b}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=m,this.stretchY=g,this.content=b,this.version=c}get tl(){return[this.paddedRect.x+ah,this.paddedRect.y+ah]}get br(){return[this.paddedRect.x+this.paddedRect.w-ah,this.paddedRect.y+this.paddedRect.h-ah]}get displaySize(){return[(this.paddedRect.w-2*ah)/this.pixelRatio,(this.paddedRect.h-2*ah)/this.pixelRatio]}}class Nk{constructor(t,i){const c={},m={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,c,g),this.addImages(i,m,g);const{w:b,h:C}=zk(g),k=new Gc({width:b||1,height:C||1});for(const R in t){const z=t[R],V=c[R].paddedRect;Gc.copy(z.data,k,{x:0,y:0},{x:V.x+ah,y:V.y+ah},z.data,z.sdf)}for(const R in i){const z=i[R],V=m[R].paddedRect,q=V.x+ah,Q=V.y+ah,te=z.data.width,oe=z.data.height;Gc.copy(z.data,k,{x:0,y:0},{x:q,y:Q},z.data),Gc.copy(z.data,k,{x:0,y:oe-1},{x:q,y:Q-1},{width:te,height:1}),Gc.copy(z.data,k,{x:0,y:0},{x:q,y:Q+oe},{width:te,height:1}),Gc.copy(z.data,k,{x:te-1,y:0},{x:q-1,y:Q},{width:1,height:oe}),Gc.copy(z.data,k,{x:0,y:0},{x:q+te,y:Q},{width:1,height:oe})}this.image=k,this.iconPositions=c,this.patternPositions=m}addImages(t,i,c){for(const m in t){const g=t[m],b={x:0,y:0,w:g.data.width+2*ah,h:g.data.height+2*ah};c.push(b),i[m]=new YT(b,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(t,i,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>t.hasImage(m,c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const m in t.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[m],t.getImage(m,c),i),this.patchUpdatedImage(this.patternPositions[m],t.getImage(m,c),i)}patchUpdatedImage(t,i,c){if(!t||!i||t.version===i.version)return;t.version=i.version;const[m,g]=t.tl,b=!!Object.keys(this.patternPositions).length;c.update(i.data,{useMipmap:b},{x:m,y:g})}}re(YT,"ImagePosition"),re(Nk,"ImageAtlas");const gx=1e20;function jk(r,t,i,c,m,g,b,C,k){for(let R=t;R<t+c;R++)Bk(r,i*g+R,g,m,b,C,k);for(let R=i;R<i+m;R++)Bk(r,R*g+t,1,c,b,C,k)}function Bk(r,t,i,c,m,g,b){g[0]=0,b[0]=-gx,b[1]=gx,m[0]=r[t];for(let C=1,k=0,R=0;C<c;C++){m[C]=r[t+C*i];const z=C*C;do{const V=g[k];R=(m[C]-m[V]+z-V*V)/(C-V)/2}while(R<=b[k]&&--k>-1);k++,g[k]=C,b[k]=R,b[k+1]=gx}for(let C=0,k=0;C<c;C++){for(;b[k+1]<C;)k++;const R=g[k],z=C-R;r[t+C*i]=m[R]+z*z}}const Ep=2,KT={none:0,ideographs:1,all:2};class uv{constructor(t,i,c){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,i){this.urls[i]=t}getGlyphs(t,i,c){const m=[],g=this.urls[i]||G.GLYPHS_URL;for(const b in t)for(const C of t[b])m.push({stack:b,id:C});Tr(m,({stack:b,id:C},k)=>{let R=this.entries[b];R||(R=this.entries[b]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let z=R.glyphs[C];if(z!==void 0)return void k(null,{stack:b,id:C,glyph:z});if(z=this._tinySDF(R,b,C),z)return R.glyphs[C]=z,void k(null,{stack:b,id:C,glyph:z});const V=Math.floor(C/256);if(256*V>65535)return void k(new Error("glyphs > 65535 not supported"));if(R.ranges[V])return void k(null,{stack:b,id:C,glyph:z});let q=R.requests[V];q||(q=R.requests[V]=[],uv.loadGlyphRange(b,V,g,this.requestManager,(Q,te)=>{if(te){R.ascender=te.ascender,R.descender=te.descender;for(const oe in te.glyphs)this._doesCharSupportLocalGlyph(+oe)||(R.glyphs[+oe]=te.glyphs[+oe]);R.ranges[V]=!0}for(const oe of q)oe(Q,te);delete R.requests[V]})),q.push((Q,te)=>{Q?k(Q):te&&k(null,{stack:b,id:C,glyph:te.glyphs[C]||null})})},(b,C)=>{if(b)c(b);else if(C){const k={};for(const{stack:R,id:z,glyph:V}of C)k[R]===void 0&&(k[R]={}),k[R].glyphs===void 0&&(k[R].glyphs={}),k[R].glyphs[z]=V&&{id:V.id,bitmap:V.bitmap.clone(),metrics:V.metrics},k[R].ascender=this.entries[R].ascender,k[R].descender=this.entries[R].descender;c(null,k)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==KT.none&&(this.localGlyphMode===KT.all?!!this.localFontFamily:!!this.localFontFamily&&(ke["CJK Unified Ideographs"](t)||ke["Hangul Syllables"](t)||ke.Hiragana(t)||ke.Katakana(t)||ke["CJK Symbols and Punctuation"](t)||ke["CJK Unified Ideographs Extension A"](t)||ke["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,i,c){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(c))return;let g=t.tinySDF;if(!g){let oe="400";/bold/i.test(i)?oe="900":/medium/i.test(i)?oe="500":/light/i.test(i)&&(oe="200"),g=t.tinySDF=new uv.TinySDF({fontFamily:m,fontWeight:oe,fontSize:24*Ep,buffer:3*Ep,radius:8*Ep}),g.fontWeight=oe}if(this.localGlyphs[g.fontWeight][c])return this.localGlyphs[g.fontWeight][c];const b=String.fromCodePoint(c),{data:C,width:k,height:R,glyphWidth:z,glyphHeight:V,glyphLeft:q,glyphTop:Q,glyphAdvance:te}=g.draw(b);return this.localGlyphs[g.fontWeight][c]={id:c,bitmap:new bp({width:k,height:R},C),metrics:{width:z/Ep,height:V/Ep,left:q/Ep,top:Q/Ep-27,advance:te/Ep,localGlyph:!0}}}}uv.loadGlyphRange=function(r,t,i,c,m){const g=256*t,b=g+255,C=c.transformRequest(c.normalizeGlyphsURL(i).replace("{fontstack}",r).replace("{range}",`${g}-${b}`),et.Glyphs);ve(C,(k,R)=>{if(k)m(k);else if(R){const z={},V=function(q){return new lv(q).readFields(HF,{})}(R);for(const q of V.glyphs)z[q.id]=q;m(null,{glyphs:z,ascender:V.ascender,descender:V.descender})}})},uv.TinySDF=class{constructor({fontSize:r=24,buffer:t=3,radius:i=8,cutoff:c=.25,fontFamily:m="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=i;const C=this.size=r+4*t,k=this._createCanvas(C),R=this.ctx=k.getContext("2d",{willReadFrequently:!0});R.font=`${b} ${g} ${r}px ${m}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(r){const t=document.createElement("canvas");return t.width=t.height=r,t}draw(r){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:c,actualBoundingBoxLeft:m,actualBoundingBoxRight:g}=this.ctx.measureText(r),b=Math.ceil(i),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-m))),k=Math.min(this.size-this.buffer,b+Math.ceil(c)),R=C+2*this.buffer,z=k+2*this.buffer,V=Math.max(R*z,0),q=new Uint8ClampedArray(V),Q={data:q,width:R,height:z,glyphWidth:C,glyphHeight:k,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(C===0||k===0)return Q;const{ctx:te,buffer:oe,gridInner:pe,gridOuter:_e}=this;te.clearRect(oe,oe,C,k),te.fillText(r,oe,oe+b);const ze=te.getImageData(oe,oe,C,k);_e.fill(gx,0,V),pe.fill(0,0,V);for(let Ue=0;Ue<k;Ue++)for(let Ve=0;Ve<C;Ve++){const nt=ze.data[4*(Ue*C+Ve)+3]/255;if(nt===0)continue;const Qe=(Ue+oe)*R+Ve+oe;if(nt===1)_e[Qe]=0,pe[Qe]=gx;else{const gt=.5-nt;_e[Qe]=gt>0?gt*gt:0,pe[Qe]=gt<0?gt*gt:0}}jk(_e,0,0,R,z,R,this.f,this.v,this.z),jk(pe,oe,oe,C,k,R,this.f,this.v,this.z);for(let Ue=0;Ue<V;Ue++){const Ve=Math.sqrt(_e[Ue])-Math.sqrt(pe[Ue]);q[Ue]=Math.round(255-255*(Ve/this.radius+this.cutoff))}return Q}};const bg=ah;function Fk(r,t,i,c){const m=[],g=r.imagePrimary,b=g.pixelRatio,C=g.paddedRect.w-2*bg,k=g.paddedRect.h-2*bg,R=r.right-r.left,z=r.bottom-r.top,V=g.stretchX||[[0,C]],q=g.stretchY||[[0,k]],Q=(Ft,_r)=>Ft+_r[1]-_r[0],te=V.reduce(Q,0),oe=q.reduce(Q,0),pe=C-te,_e=k-oe;let ze=0,Ue=te,Ve=0,nt=oe,Qe=0,gt=pe,At=0,Bt=_e;if(g.content&&c){const Ft=g.content;ze=Jb(V,0,Ft[0]),Ve=Jb(q,0,Ft[1]),Ue=Jb(V,Ft[0],Ft[2]),nt=Jb(q,Ft[1],Ft[3]),Qe=Ft[0]-ze,At=Ft[1]-Ve,gt=Ft[2]-Ft[0]-Ue,Bt=Ft[3]-Ft[1]-nt}const Yt=(Ft,_r,Pr,dr)=>{const Er=Qb(Ft.stretch-ze,Ue,R,r.left),lr=ew(Ft.fixed-Qe,gt,Ft.stretch,te),Sr=Qb(_r.stretch-Ve,nt,z,r.top),Yr=ew(_r.fixed-At,Bt,_r.stretch,oe),kr=Qb(Pr.stretch-ze,Ue,R,r.left),bn=ew(Pr.fixed-Qe,gt,Pr.stretch,te),dn=Qb(dr.stretch-Ve,nt,z,r.top),jr=ew(dr.fixed-At,Bt,dr.stretch,oe),ti=new Ge(Er,Sr),zn=new Ge(kr,Sr),yn=new Ge(kr,dn),Br=new Ge(Er,dn),Wn=new Ge(lr/b,Yr/b),Wi=new Ge(bn/b,jr/b),ci=t*Math.PI/180;if(ci){const _o=Math.sin(ci),So=Math.cos(ci),Po=[So,-_o,_o,So];ti._matMult(Po),zn._matMult(Po),Br._matMult(Po),yn._matMult(Po)}const Hi=Ft.stretch+Ft.fixed,Ei=Pr.stretch+Pr.fixed,ao=_r.stretch+_r.fixed,Ri=dr.stretch+dr.fixed,Wo=r.imageSecondary;return{tl:ti,tr:zn,bl:Br,br:yn,texPrimary:{x:g.paddedRect.x+bg+Hi,y:g.paddedRect.y+bg+ao,w:Ei-Hi,h:Ri-ao},texSecondary:Wo?{x:Wo.paddedRect.x+bg+Hi,y:Wo.paddedRect.y+bg+ao,w:Ei-Hi,h:Ri-ao}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wn,pixelOffsetBR:Wi,minFontScaleX:gt/b/R,minFontScaleY:Bt/b/z,isSDF:i}};if(c&&(g.stretchX||g.stretchY)){const Ft=Vk(V,pe,te),_r=Vk(q,_e,oe);for(let Pr=0;Pr<Ft.length-1;Pr++){const dr=Ft[Pr],Er=Ft[Pr+1];for(let lr=0;lr<_r.length-1;lr++)m.push(Yt(dr,_r[lr],Er,_r[lr+1]))}}else m.push(Yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:k+1}));return m}function Jb(r,t,i){let c=0;for(const m of r)c+=Math.max(t,Math.min(i,m[1]))-Math.max(t,Math.min(i,m[0]));return c}function Vk(r,t,i){const c=[{fixed:-bg,stretch:0}];for(const[m,g]of r){const b=c[c.length-1];c.push({fixed:m-b.stretch,stretch:b.stretch}),c.push({fixed:m-b.stretch,stretch:b.stretch+(g-m)})}return c.push({fixed:t+bg,stretch:i}),c}function Qb(r,t,i,c){return r/t*i+c}function ew(r,t,i,c){return r-t*i/c}function t6(r,t,i,c){const m=t+r.positionedLines[c].lineOffset;return c===0?i+m/2:i+(m+(t+r.positionedLines[c-1].lineOffset))/2}function r6(r,t=1,i=!1){let c=1/0,m=1/0,g=-1/0,b=-1/0;const C=r[0];for(let Q=0;Q<C.length;Q++){const te=C[Q];(!Q||te.x<c)&&(c=te.x),(!Q||te.y<m)&&(m=te.y),(!Q||te.x>g)&&(g=te.x),(!Q||te.y>b)&&(b=te.y)}const k=Math.min(g-c,b-m);let R=k/2;const z=new Ol([],n6);if(k===0)return new Ge(c,m);for(let Q=c;Q<g;Q+=k)for(let te=m;te<b;te+=k)z.push(new hv(Q+R,te+R,R,r));let V=function(Q){let te=0,oe=0,pe=0;const _e=Q[0];for(let ze=0,Ue=_e.length,Ve=Ue-1;ze<Ue;Ve=ze++){const nt=_e[ze],Qe=_e[Ve],gt=nt.x*Qe.y-Qe.x*nt.y;oe+=(nt.x+Qe.x)*gt,pe+=(nt.y+Qe.y)*gt,te+=3*gt}return new hv(oe/te,pe/te,0,Q)}(r),q=z.length;for(;z.length;){const Q=z.pop();(Q.d>V.d||!V.d)&&(V=Q,i&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,q)),Q.max-V.d<=t||(R=Q.h/2,z.push(new hv(Q.p.x-R,Q.p.y-R,R,r)),z.push(new hv(Q.p.x+R,Q.p.y-R,R,r)),z.push(new hv(Q.p.x-R,Q.p.y+R,R,r)),z.push(new hv(Q.p.x+R,Q.p.y+R,R,r)),q+=4)}return i&&(console.log(`num probes: ${q}`),console.log(`best distance: ${V.d}`)),V.p}function n6(r,t){return t.max-r.max}class hv{constructor(t,i,c,m){this.p=new Ge(t,i),this.h=c,this.d=function(g,b){let C=!1,k=1/0;for(let R=0;R<b.length;R++){const z=b[R];for(let V=0,q=z.length,Q=q-1;V<q;Q=V++){const te=z[V],oe=z[Q];te.y>g.y!=oe.y>g.y&&g.x<(oe.x-te.x)*(g.y-te.y)/(oe.y-te.y)+te.x&&(C=!C),k=Math.min(k,lf(g,te,oe))}}return(C?1:-1)*Math.sqrt(k)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const JT=Number.POSITIVE_INFINITY,i6=Math.sqrt(2);function Uk(r,[t,i]){let c=0,m=0;if(i===JT){t<0&&(t=0);const g=t/i6;switch(r){case"top-right":case"top-left":m=g-7;break;case"bottom-right":case"bottom-left":m=7-g;break;case"bottom":m=7-t;break;case"top":m=t-7}switch(r){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),r){case"top-right":case"top-left":case"top":m=i-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-i}switch(r){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,m]}function QT(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function o6(r,t,i,c,m,g,b,C,k,R,z,V,q,Q,te){let oe=g.textMaxSize.evaluate(t,{},V);oe===void 0&&(oe=b);const pe=r.layers[0].layout,_e=pe.get("icon-offset").evaluate(t,{},V),ze=Gk(i.horizontal)||i.vertical,Ue=q.name==="globe",Ve=Vl,nt=b/Ve,Qe=r.tilePixelRatio*oe/Ve,gt=(Er=r.overscaling,r.zoom>18&&Er>2&&(Er>>=1),Math.max(Jr/(512*Er),1)*pe.get("symbol-spacing")),At=pe.get("text-padding")*r.tilePixelRatio,Bt=pe.get("icon-padding")*r.tilePixelRatio,Yt=Et(pe.get("text-max-angle")),Ft=pe.get("text-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",_r=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",Pr=pe.get("symbol-placement"),dr=gt/2;var Er;const lr=pe.get("icon-text-fit").evaluate(t,{},V),Sr=pe.get("icon-text-fit-padding").evaluate(t,{},V),Yr=lr!=="none";let kr;r.hasAnyIconTextFit===!1&&Yr&&(r.hasAnyIconTextFit=!0),c&&Yr&&(r.allowVerticalPlacement&&i.vertical&&(kr=Pk(c,i.vertical,lr,Sr,_e,nt)),ze&&(c=Pk(c,ze,lr,Sr,_e,nt)));const bn=(dn,jr,ti)=>{if(jr.x<0||jr.x>=Jr||jr.y<0||jr.y>=Jr)return;let zn=null;if(Ue){const{x:yn,y:Br,z:Wn}=q.projectTilePoint(jr.x,jr.y,ti);zn={anchor:new ym(yn,Br,Wn,0,void 0),up:q.upVector(ti,jr.x,jr.y)}}(function(yn,Br,Wn,Wi,ci,Hi,Ei,ao,Ri,Wo,_o,So,Po,yo,Sa,Lo,Za,Bs,Il,fa,ka,dl,pl,fl,aa,sh,Cg){const Wc=yn.addToLineVertexArray(Br,Wi);let Tc,Bh,Rx,bw,G3,q3,W3,H3=0,Z3=0,X3=0,Y3=0,SE=-1,TE=-1;const gf={};let K3=Ad("");const Q_=Wn?Wn.anchor:Br,EE=Ri.layout.get("icon-text-fit").evaluate(ka,{},aa)!=="none";let IE=0,CE=0;if(Ri._unevaluatedLayout.getValue("text-radial-offset")===void 0?[IE,CE]=Ri.layout.get("text-offset").evaluate(ka,{},aa).map(lh=>lh*Vl):(IE=Ri.layout.get("text-radial-offset").evaluate(ka,{},aa)*Vl,CE=JT),yn.allowVerticalPlacement&&ci.vertical){const lh=ci.vertical;if(Sa)q3=eE(lh),ao&&(W3=eE(ao));else{const ch=Ri.layout.get("text-rotate").evaluate(ka,{},aa)+90;Rx=tw(Wo,Q_,Br,_o,So,Po,lh,yo,ch,Lo),ao&&(bw=tw(Wo,Q_,Br,_o,So,Po,ao,Bs,ch))}}if(Hi){const lh=Ri.layout.get("icon-rotate").evaluate(ka,{},aa),ch=Fk(Hi,lh,pl,EE),vv=ao?Fk(ao,lh,pl,EE):void 0;Bh=tw(Wo,Q_,Br,_o,So,Po,Hi,Bs,lh),H3=4*ch.length;const J3=yn.iconSizeData;let ey=null;J3.kind==="source"?(ey=[Tp*Ri.layout.get("icon-size").evaluate(ka,{},aa)],ey[0]>wg&&Kt(`${yn.layerIds[0]}: Value for "icon-size" is >= ${_x}. Reduce your "icon-size".`)):J3.kind==="composite"&&(ey=[Tp*dl.compositeIconSizes[0].evaluate(ka,{},aa),Tp*dl.compositeIconSizes[1].evaluate(ka,{},aa)],(ey[0]>wg||ey[1]>wg)&&Kt(`${yn.layerIds[0]}: Value for "icon-size" is >= ${_x}. Reduce your "icon-size".`)),yn.addSymbols(yn.icon,ch,ey,fa,Il,ka,!1,Wn,Br,Wc.lineStartIndex,Wc.lineLength,-1,fl,aa,sh,Cg),SE=yn.icon.placedSymbolArray.length-1,vv&&(Z3=4*vv.length,yn.addSymbols(yn.icon,vv,ey,fa,Il,ka,Nh.vertical,Wn,Br,Wc.lineStartIndex,Wc.lineLength,-1,fl,aa,sh,Cg),TE=yn.icon.placedSymbolArray.length-1)}for(const lh in ci.horizontal){const ch=ci.horizontal[lh];Tc||(K3=Ad(ch.text),Sa?G3=eE(ch):Tc=tw(Wo,Q_,Br,_o,So,Po,ch,yo,Ri.layout.get("text-rotate").evaluate(ka,{},aa),Lo));const vv=ch.positionedLines.length===1;if(X3+=$k(yn,Wn,Br,ch,Ei,Ri,Sa,ka,Lo,Wc,ci.vertical?Nh.horizontal:Nh.horizontalOnly,vv?Object.keys(ci.horizontal):[lh],gf,SE,dl,fl,aa,sh),vv)break}ci.vertical&&(Y3+=$k(yn,Wn,Br,ci.vertical,Ei,Ri,Sa,ka,Lo,Wc,Nh.vertical,["vertical"],gf,TE,dl,fl,aa,sh));let Ag=-1;const AE=(lh,ch)=>lh?Math.max(lh,ch):ch;Ag=AE(G3,Ag),Ag=AE(q3,Ag),Ag=AE(W3,Ag);const SV=Ag>-1?1:0;yn.glyphOffsetArray.length>=65535&&Kt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ka.sortKey!==void 0&&yn.addToSortKeyRanges(yn.symbolInstances.length,ka.sortKey),yn.symbolInstances.emplaceBack(Br.x,Br.y,Q_.x,Q_.y,Q_.z,gf.right>=0?gf.right:-1,gf.center>=0?gf.center:-1,gf.left>=0?gf.left:-1,gf.vertical>=0?gf.vertical:-1,SE,TE,K3,Tc!==void 0?Tc:yn.collisionBoxArray.length,Tc!==void 0?Tc+1:yn.collisionBoxArray.length,Rx!==void 0?Rx:yn.collisionBoxArray.length,Rx!==void 0?Rx+1:yn.collisionBoxArray.length,Bh!==void 0?Bh:yn.collisionBoxArray.length,Bh!==void 0?Bh+1:yn.collisionBoxArray.length,bw||yn.collisionBoxArray.length,bw?bw+1:yn.collisionBoxArray.length,_o,X3,Y3,H3,Z3,SV,0,IE,CE,Ag,0,EE?1:0)})(r,jr,zn,dn,i,c,m,kr,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,At,Ft,k,0,Bt,_r,_e,t,g,R,z,V,Q,te)};if(Pr==="line")for(const dn of Lk(t.geometry,0,0,Jr,Jr)){const jr=e6(dn,gt,Yt,i.vertical||ze,c,Ve,Qe,r.overscaling,Jr);for(const ti of jr)ze&&a6(r,ze.text,dr,ti)||bn(dn,ti,V)}else if(Pr==="line-center"){for(const dn of t.geometry)if(dn.length>1){const jr=QF(dn,Yt,i.vertical||ze,c,Ve,Qe);jr&&bn(dn,jr,V)}}else if(t.type==="Polygon")for(const dn of sx(t.geometry,0)){const jr=r6(dn,16);bn(dn[0],new ym(jr.x,jr.y,0,0,void 0),V)}else if(t.type==="LineString")for(const dn of t.geometry)bn(dn,new ym(dn[0].x,dn[0].y,0,0,void 0),V);else if(t.type==="Point")for(const dn of t.geometry)for(const jr of dn)bn([jr],new ym(jr.x,jr.y,0,0,void 0),V)}const _x=255,wg=_x*Tp;function $k(r,t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe,_e){const ze=function(nt,Qe,gt,At,Bt,Yt,Ft,_r){const Pr=[];if(Qe.positionedLines.length===0)return Pr;const dr=At.layout.get("text-rotate").evaluate(Yt,{})*Math.PI/180,Er=function(bn){const dn=bn[0],jr=bn[1],ti=dn*jr;return ti>0?[dn,-jr]:ti<0?[-dn,jr]:dn===0?[jr,dn]:[jr,-dn]}(gt);let lr=Math.abs(Qe.top-Qe.bottom);for(const bn of Qe.positionedLines)lr-=bn.lineOffset;const Sr=Qe.positionedLines.length,Yr=lr/Sr;let kr=Qe.top-gt[1];for(let bn=0;bn<Sr;++bn){const dn=Qe.positionedLines[bn];kr=t6(Qe,Yr,kr,bn);for(const jr of dn.positionedGlyphs){if(!jr.rect)continue;const ti=jr.rect||{};let zn=Sk+1,yn=!0,Br=1,Wn=0;if(jr.imageName){const fa=Ft[jr.imageName];if(!fa)continue;if(fa.sdf){Kt("SDF images are not supported in formatted text and will be ignored.");continue}yn=!1,Br=fa.pixelRatio,zn=ah/Br}const Wi=(Bt||_r)&&jr.vertical,ci=jr.metrics.advance*jr.scale/2,Hi=jr.metrics,Ei=jr.rect;if(Ei===null)continue;_r&&Qe.verticalizable&&(Wn=jr.imageName?ci-jr.metrics.width*jr.scale/2:0);const ao=Bt?[jr.x+ci,jr.y]:[0,0];let Ri=[0,0],Wo=[0,0],_o=!1;Bt||(Wi?(Wo=[jr.x+ci+Er[0],jr.y+Er[1]-Wn],_o=!0):Ri=[jr.x+ci+gt[0],jr.y+gt[1]-Wn]);const So=Ei.w*jr.scale/(Br*(jr.localGlyph?Ep:1)),Po=Ei.h*jr.scale/(Br*(jr.localGlyph?Ep:1));let yo,Sa,Lo,Za;if(Wi){const fa=jr.y-kr,ka=new Ge(-ci,ci-fa),dl=-Math.PI/2,pl=new Ge(...Wo);yo=new Ge(-ci+Ri[0],Ri[1]),yo._rotateAround(dl,ka)._add(pl),yo.x+=-fa+ci,yo.y-=(Hi.left-zn)*jr.scale;const fl=jr.imageName?Hi.advance*jr.scale:Vl*jr.scale,aa=String.fromCodePoint(jr.glyph);LF(aa)?yo.x+=(1-zn)*jr.scale:zF(aa)?yo.x+=fl-Hi.height*jr.scale+(-zn-1)*jr.scale:yo.x+=jr.imageName||Hi.width+2*zn===Ei.w&&Hi.height+2*zn===Ei.h?(fl-Po)/2:(fl-(Hi.height+2*zn)*jr.scale)/2,Sa=new Ge(yo.x,yo.y-So),Lo=new Ge(yo.x+Po,yo.y),Za=new Ge(yo.x+Po,yo.y-So)}else{const fa=(Hi.left-zn)*jr.scale-ci+Ri[0],ka=(-Hi.top-zn)*jr.scale+Ri[1],dl=fa+So,pl=ka+Po;yo=new Ge(fa,ka),Sa=new Ge(dl,ka),Lo=new Ge(fa,pl),Za=new Ge(dl,pl)}if(dr){let fa;fa=Bt?new Ge(0,0):_o?new Ge(Er[0],Er[1]):new Ge(gt[0],gt[1]),yo._rotateAround(dr,fa),Sa._rotateAround(dr,fa),Lo._rotateAround(dr,fa),Za._rotateAround(dr,fa)}const Bs=new Ge(0,0),Il=new Ge(0,0);Pr.push({tl:yo,tr:Sa,bl:Lo,br:Za,texPrimary:ti,texSecondary:void 0,writingMode:Qe.writingMode,glyphOffset:ao,sectionIndex:jr.sectionIndex,isSDF:yn,pixelOffsetTL:Bs,pixelOffsetBR:Il,minFontScaleX:0,minFontScaleY:0})}}return Pr}(0,c,k,g,b,C,m,r.allowVerticalPlacement),Ue=r.textSizeData;let Ve=null;Ue.kind==="source"?(Ve=[Tp*g.layout.get("text-size").evaluate(C,{},pe)],Ve[0]>wg&&Kt(`${r.layerIds[0]}: Value for "text-size" is >= ${_x}. Reduce your "text-size".`)):Ue.kind==="composite"&&(Ve=[Tp*te.compositeTextSizes[0].evaluate(C,{},pe),Tp*te.compositeTextSizes[1].evaluate(C,{},pe)],(Ve[0]>wg||Ve[1]>wg)&&Kt(`${r.layerIds[0]}: Value for "text-size" is >= ${_x}. Reduce your "text-size".`)),r.addSymbols(r.text,ze,Ve,k,b,C,z,t,i,R.lineStartIndex,R.lineLength,Q,oe,pe,_e,!1);for(const nt of V)q[nt]=r.text.placedSymbolArray.length-1;return 4*ze.length}function Gk(r){for(const t in r)return r[t];return null}function tw(r,t,i,c,m,g,b,C,k,R){let z=b.top,V=b.bottom,q=b.left,Q=b.right;const te=b.collisionPadding;if(te&&(q-=te[0],z-=te[1],Q+=te[2],V+=te[3]),k){const oe=new Ge(q,z),pe=new Ge(Q,z),_e=new Ge(q,V),ze=new Ge(Q,V),Ue=Et(k);let Ve=new Ge(0,0);R&&(Ve=new Ge(R[0],R[1])),oe._rotateAround(Ue,Ve),pe._rotateAround(Ue,Ve),_e._rotateAround(Ue,Ve),ze._rotateAround(Ue,Ve),q=Math.min(oe.x,pe.x,_e.x,ze.x),Q=Math.max(oe.x,pe.x,_e.x,ze.x),z=Math.min(oe.y,pe.y,_e.y,ze.y),V=Math.max(oe.y,pe.y,_e.y,ze.y)}return r.emplaceBack(t.x,t.y,t.z,i.x,i.y,q,z,Q,V,C,c,m,g),r.length-1}function eE(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const t=r.bottom-r.top;return t>0?Math.max(10,t):null}function a6(r,t,i,c){const m=r.compareText;if(t in m){const g=m[t];for(let b=g.length-1;b>=0;b--)if(c.dist(g[b])<i)return!0}else m[t]=[];return m[t].push(c),!1}function qk(r,t){const i=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*t:0,m=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),g=Math.sin(i)*m/Math.sin(Math.max(Math.PI/2-r._pitch-i,.01)),b=Math.sin(r._pitch)*g+m;return Math.min(1.01*b,m*(1/r._horizonShift))}function yx(r,t){if(!t.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:t};const i=Math.pow(2,-r.z),c=r.x*i,m=(r.x+1)*i,g=r.y*i,b=(r.y+1)*i,C=Ti(c),k=Ti(m),R=ro(g),z=ro(b),V=t.project(C,R),q=t.project(k,R),Q=t.project(k,z),te=t.project(C,z);let oe=Math.min(V.x,q.x,Q.x,te.x),pe=Math.min(V.y,q.y,Q.y,te.y),_e=Math.max(V.x,q.x,Q.x,te.x),ze=Math.max(V.y,q.y,Q.y,te.y);const Ue=i/16;function Ve(Qe,gt,At,Bt,Yt,Ft){const _r=(At+Yt)/2,Pr=(Bt+Ft)/2,dr=t.project(Ti(_r),ro(Pr)),Er=Math.max(0,oe-dr.x,pe-dr.y,dr.x-_e,dr.y-ze);oe=Math.min(oe,dr.x),_e=Math.max(_e,dr.x),pe=Math.min(pe,dr.y),ze=Math.max(ze,dr.y),Er>Ue&&(Ve(Qe,dr,At,Bt,_r,Pr),Ve(dr,gt,_r,Pr,Yt,Ft))}Ve(V,q,c,g,m,g),Ve(q,Q,m,g,m,b),Ve(Q,te,m,b,c,b),Ve(te,V,c,b,c,g),oe-=Ue,pe-=Ue,_e+=Ue,ze+=Ue;const nt=1/Math.max(_e-oe,ze-pe);return{scale:nt,x:oe*nt,y:pe*nt,x2:_e*nt,y2:ze*nt,projection:t}}function Wk(r,{x:t,y:i},c=0){return new Ge(((t-c)*r.scale-r.x)*Jr,(i*r.scale-r.y)*Jr)}const s6=s.a6.identity(new Float32Array(16));class Sg{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new zt(0,0)}projectTilePoint(t,i,c){return{x:t,y:i,z:0}}locationPoint(t,i,c=!0){return t._coordinatePoint(t.locationCoordinate(i),c)}pixelsPerMeter(t,i){return Ci(1,t)*i}pixelSpaceConversion(t,i,c){return 1}farthestPixelDistance(t){return qk(t,t.pixelsPerMeter)}pointCoordinate(t,i,c,m){const g=t.horizonLineFromTop(!1),b=new Ge(i,Math.max(g,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(b,m))}pointCoordinate3D(t,i,c){const m=new Ge(i,c);if(t.elevation)return t.elevation.pointCoordinate(m);{const g=this.pointCoordinate(t,m.x,m.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const c=t.horizonLineFromTop();return i.y<c}createInversionMatrix(t,i){return s6}createTileMatrix(t,i,c){let m,g,b;const C=c.canonical,k=s.a6.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=yx(C,this);m=1,g=R.x+c.wrap*R.scale,b=R.y,s.a6.scale(k,k,[m/R.scale,m/R.scale,t.pixelsPerMeter/i])}else m=i/t.zoomScale(C.z),g=(C.x+Math.pow(2,C.z)*c.wrap)*m,b=C.y*m;return s.a6.translate(k,k,[g,b,0]),s.a6.scale(k,k,[m/Jr,m/Jr,1]),k}upVector(t,i,c){return[0,0,1]}upVectorScale(t,i,c){return{metersToTile:1}}}class l6 extends Sg{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,c]=this.parallels=t.parallels||[29.5,45.5],m=Math.sin(Et(i));this.n=(m+Math.sin(Et(c)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:c,c:m,r0:g}=this,b=Et(t-this.center[0]),C=Et(i),k=Math.sqrt(m-2*c*Math.sin(C))/c;return{x:k*Math.sin(b*c),y:k*Math.cos(b*c)-g,z:0}}unproject(t,i){const{n:c,c:m,r0:g}=this,b=g+i;let C=Math.atan2(t,Math.abs(b))*Math.sign(b);b*c<0&&(C-=Math.PI*Math.sign(t)*Math.sign(b));const k=Et(this.center[0])*c;C=sr(C,-Math.PI-k,Math.PI-k);const R=Ht(Wt(C/c)+this.center[0],-180,180),z=Math.asin(Ht((m-(t*t+b*b)*c*c)/(2*c),-1,1)),V=Ht(Wt(z),-Vi,Vi);return new zt(R,V)}}const vx=1.340264,xx=-.081106,bx=893e-6,wx=.003796,rw=Math.sqrt(3)/2;class c6 extends Sg{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(rw*Math.sin(i)),m=c*c,g=m*m*m;return{x:.5*(t*Math.cos(c)/(rw*(vx+3*xx*m+g*(7*bx+9*wx*m)))/Math.PI+.5),y:1-.5*(c*(vx+xx*m+g*(bx+wx*m))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,m=c*c,g=m*m*m;for(let z,V,q,Q=0;Q<12&&(V=c*(vx+xx*m+g*(bx+wx*m))-i,q=vx+3*xx*m+g*(7*bx+9*wx*m),z=V/q,c=Ht(c-z,-Math.PI/3,Math.PI/3),m=c*c,g=m*m*m,!(Math.abs(z)<1e-12));++Q);const b=rw*t*(vx+3*xx*m+g*(7*bx+9*wx*m))/Math.cos(c),C=Math.asin(Math.sin(c)/rw),k=Ht(180*b/Math.PI,-180,180),R=Ht(180*C/Math.PI,-Vi,Vi);return new zt(k,R)}}class u6 extends Sg{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const c=360*(t-.5),m=Ht(360*(.5-i),-Vi,Vi);return new zt(c,m)}}const dv=Math.PI/2;function nw(r){return Math.tan((dv+r)/2)}class h6 extends Sg{constructor(t){super(t),this.center=t.center||[0,30];const[i,c]=this.parallels=t.parallels||[30,30];let m=Et(i),g=Et(c);this.southernCenter=m+g<0,this.southernCenter&&(m=-m,g=-g);const b=Math.cos(m),C=nw(m);this.n=m===g?Math.sin(m):Math.log(b/Math.cos(g))/Math.log(nw(g)/C),this.f=b*Math.pow(nw(m),this.n)/this.n}project(t,i){i=Et(i),this.southernCenter&&(i=-i),t=Et(t-this.center[0]);const c=1e-6,{n:m,f:g}=this;g>0?i<-dv+c&&(i=-dv+c):i>dv-c&&(i=dv-c);const b=g/Math.pow(nw(i),m);let C=b*Math.sin(m*t),k=g-b*Math.cos(m*t);return C=.5*(C/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:C,y:this.southernCenter?k:1-k,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:c,f:m}=this,g=m-i,b=Math.sign(g),C=Math.sign(c)*Math.sqrt(t*t+g*g);let k=Math.atan2(t,Math.abs(g))*b;g*c<0&&(k-=Math.PI*Math.sign(t)*b);const R=Ht(Wt(k/c)+this.center[0],-180,180),z=Ht(Wt(2*Math.atan(Math.pow(m/C,1/c))-dv),-Vi,Vi);return new zt(R,this.southernCenter?-z:z)}}class Hk extends Sg{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:Mi(t),y:pi(i),z:0}}unproject(t,i){const c=Ti(t),m=ro(i);return new zt(c,m)}}const Zk=Et(Vi);class d6 extends Sg{project(t,i){const c=(i=Et(i))*i,m=c*c;return{x:.5*((t=Et(t))*(.8707-.131979*c+m*(m*(.003971*c-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+c*(.015085+m*(.028874*c-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,m=25,g=0,b=c*c;do{b=c*c;const R=b*b;g=(c*(1.007226+b*(.015085+R*(.028874*b-.044475-.005916*R)))-i)/(1.007226+b*(.045255+R*(.259866*b-.311325-.005916*11*R))),c=Ht(c-g,-Zk,Zk)}while(Math.abs(g)>1e-6&&--m>0);b=c*c;const C=Ht(Wt(t/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),k=Wt(c);return new zt(C,k)}}const Xk=Et(Vi);class p6 extends Sg{project(t,i){i=Et(i),t=Et(t);const c=Math.cos(i),m=2/Math.PI,g=Math.acos(c*Math.cos(t/2)),b=Math.sin(g)/g,C=.5*(t*m+2*c*Math.sin(t/2)/b)||0,k=.5*(i+Math.sin(i)/b)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(t,i){let c=t=(2*t-.5)*Math.PI,m=i=(2*(1-i)-1)*Math.PI,g=25;const b=1e-6;let C=0,k=0;do{const R=Math.cos(m),z=Math.sin(m),V=2*z*R,q=z*z,Q=R*R,te=Math.cos(c/2),oe=Math.sin(c/2),pe=2*te*oe,_e=oe*oe,ze=1-Q*te*te,Ue=ze?1/ze:0,Ve=ze?Math.acos(R*te)*Math.sqrt(1/ze):0,nt=.5*(2*Ve*R*oe+2*c/Math.PI)-t,Qe=.5*(Ve*z+m)-i,gt=.5*Ue*(Q*_e+Ve*R*te*q)+1/Math.PI,At=Ue*(pe*V/4-Ve*z*oe),Bt=.125*Ue*(V*oe-Ve*z*Q*pe),Yt=.5*Ue*(q*te+Ve*_e*R)+.5,Ft=At*Bt-Yt*gt;C=(Qe*At-nt*Yt)/Ft,k=(nt*Bt-Qe*gt)/Ft,c=Ht(c-C,-Math.PI,Math.PI),m=Ht(m-k,-Xk,Xk)}while((Math.abs(C)>b||Math.abs(k)>b)&&--g>0);return new zt(Wt(c),Wt(m))}}class Yk extends Sg{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:c,cosPhi:m}=this;return{x:Et(t)*m*c+.5,y:-Math.sin(Et(i))/m*c+.5,z:0}}unproject(t,i){const{scale:c,cosPhi:m}=this,g=-(i-.5)/c,b=Ht(Wt((t-.5)/c)/m,-180,180),C=Math.asin(Ht(g*m,-1,1)),k=Ht(Wt(C),-Vi,Vi);return new zt(b,k)}}class f6 extends Hk{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,c){const m=Nd(t,i,c),g=dg(Sc(c));return s.N.transformMat4(m,m,g),{x:m[0],y:m[1],z:m[2]}}locationPoint(t,i){const c=hr(i.lat,i.lng),m=s.N.normalize([],c),g=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude,b=Ci(1,0)*Jr*g;s.N.scaleAndAdd(c,c,m,b);const C=s.a6.identity(new Float64Array(16));return s.a6.multiply(C,t.pixelMatrix,t.globeMatrix),s.N.transformMat4(c,c,C),new Ge(c[0],c[1])}pixelsPerMeter(t,i){return Ci(1,0)*i}pixelSpaceConversion(t,i,c){const m=Ci(1,t)*i,g=Hn(Ci(1,45)*i,m,c);return this.pixelsPerMeter(t,i)/g}createTileMatrix(t,i,c){const m=Zy(Sc(c.canonical));return s.a6.multiply(new Float64Array(16),t.globeMatrix,m)}createInversionMatrix(t,i){const{center:c}=t,m=dg(Sc(i));return s.a6.rotateY(m,m,Et(c.lng)),s.a6.rotateX(m,m,Et(c.lat)),s.a6.scale(m,m,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(t,i,c,m){return lg(t,i,c,!0)||new no(0,0)}pointCoordinate3D(t,i,c){const m=this.pointCoordinate(t,i,c,0);return[m.x,m.y,m.z]}isPointAboveHorizon(t,i){return!lg(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(m,g){const b=m.cameraToCenterDistance,C=m._centerAltitude*g,k=m._camera,R=m._camera.forward(),z=s.N.add([],s.N.scale([],R,-b),[0,0,C]),V=m.worldSize/(2*Math.PI),q=[0,0,-V],Q=m.width/m.height,te=Math.tan(m.fovAboveCenter),oe=s.N.scale([],k.up(),te),pe=s.N.scale([],k.right(),te*Q),_e=s.N.normalize([],s.N.add([],s.N.add([],R,oe),pe)),ze=[];let Ue;if(new lm(z,_e).closestPointOnSphere(q,V,ze)){const Ve=s.N.add([],ze,q),nt=s.N.sub([],Ve,z);Ue=Math.cos(m.fovAboveCenter)*s.N.length(nt)}else{const Ve=s.N.sub([],z,q),nt=s.N.sub([],q,z);s.N.normalize(nt,nt);const Qe=s.N.length(Ve)-V;Ue=Math.sqrt(Qe*(Qe+2*V));const gt=Math.acos(Ue/(V+Qe))-Math.acos(s.N.dot(R,nt));Ue*=Math.cos(gt)}return 1.01*Ue}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=oa(t.zoom);if(c>0){const m=qk(t,Ci(1,t.center.lat)*t.worldSize),g=t.worldSize/(2*Math.PI),b=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Hn(i,m+g*(1-Math.cos(b)),Math.pow(c,10))}return i}upVector(t,i,c){return Nd(i,c,t,1)}upVectorScale(t){return{metersToTile:hm(hg(Sc(t)))}}}function Kk(r){const t=r.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(r.name){case"mercator":return new Hk(r);case"equirectangular":return new u6(r);case"naturalEarth":return new d6(r);case"equalEarth":return new c6(r);case"winkelTripel":return new p6(r);case"albers":return i?new Yk(r):new l6(r);case"lambertConformalConic":return i?new Yk(r):new h6(r);case"globe":return new f6(r)}throw new Error(`Invalid projection name: ${r.name}`)}const m6=Ub.types,g6=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function iw(r,t,i,c,m,g,b,C,k,R,z,V,q){const Q=C?Math.min(wg,Math.round(C[0])):0,te=C?Math.min(wg,Math.round(C[1])):0;r.emplaceBack(t,i,Math.round(32*c),Math.round(32*m),g,b,(Q<<1)+(k?1:0),te,16*R,16*z,256*V,256*q)}function ow(r,t,i){r.emplaceBack(t,i)}function aw(r,t,i,c,m,g,b){r.emplaceBack(t,i,c,m,g,b)}function sw(r,t,i,c,m){r.emplaceBack(t,i,c,m),r.emplaceBack(t,i,c,m),r.emplaceBack(t,i,c,m),r.emplaceBack(t,i,c,m)}function _6(r){for(const t of r.sections)if(vr(t.text))return!0;return!1}class tE{constructor(t){this.layoutVertexArray=new Uf,this.indexArray=new Wa,this.programConfigurations=t,this.segments=new ua,this.dynamicLayoutVertexArray=new Ja,this.opacityVertexArray=new T_,this.placedSymbolArray=new Yf,this.iconTransitioningVertexArray=new Uc,this.globeExtVertexArray=new S_,this.zOffsetVertexArray=new Gf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,i,c,m,g){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,EF.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,CF.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,g6,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,PF.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,IF.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,AF.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||m)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}re(tE,"SymbolBuffers");class rE{constructor(t,i,c){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new c,this.segments=new ua,this.collisionVertexArray=new Ju,this.collisionVertexArrayExt=new Ja}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,MF.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,kF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}re(rE,"CollisionBuffers");class lw{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(b=>b.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=s.a6.identity([]),this.placementViewportMatrix=s.a6.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=qT(this.zoom,i["text-size"]),this.iconSizeData=qT(this.zoom,i["icon-size"]);const c=this.layers[0].layout,m=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(b=>Nh[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate")}createArrays(){this.text=new tE(new we(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new tE(new we(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new M_,this.lineVertexArray=new Rh,this.symbolInstances=new P_}calculateGlyphDependencies(t,i,c,m,g){for(let b=0;b<t.length;b++){const C=t.codePointAt(b);if(C===void 0)break;if(i[C]=!0,m&&g&&C<=65535){const k=fx[t.charAt(b)];k&&(i[k.charCodeAt(0)]=!0)}}}populate(t,i,c,m){const g=this.layers[0],b=g.layout,C=this.projection.name==="globe",k=b.get("text-font"),R=b.get("text-field"),z=b.get("icon-image"),V=(R.value.kind!=="constant"||R.value.value instanceof ea&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),q=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,Q=b.get("symbol-sort-key");if(this.features=[],!V&&!q)return;const te=i.iconDependencies,oe=i.glyphDependencies,pe=i.availableImages,_e=new $n(this.zoom);for(const{feature:ze,id:Ue,index:Ve,sourceLayerIndex:nt}of t){const Qe=g._featureFilter.needGeometry,gt=ls(ze,Qe);if(!g._featureFilter.filter(_e,gt,c))continue;if(Qe||(gt.geometry=ss(ze,c,m)),C&&ze.type!==1&&c.z<=5){const Ft=gt.geometry,_r=.98078528056,Pr=(dr,Er)=>{const lr=Nd(dr.x,dr.y,c,1),Sr=Nd(Er.x,Er.y,c,1);return s.N.dot(lr,Sr)<_r};for(let dr=0;dr<Ft.length;dr++)Ft[dr]=js(Ft[dr],Pr)}let At,Bt;if(V){const Ft=g.getValueAndResolveTokens("text-field",gt,c,pe),_r=ea.factory(Ft);_6(_r)&&(this.hasRTLText=!0),(!this.hasRTLText||io()==="unavailable"||this.hasRTLText&&Qn.isParsed())&&(At=OF(_r,g,gt))}if(q){const Ft=g.getValueAndResolveTokens("icon-image",gt,c,pe);Bt=Ft instanceof Dn?Ft:Dn.fromString(Ft)}if(!At&&!Bt)continue;const Yt=this.sortFeaturesByKey?Q.evaluate(gt,{},c):void 0;if(this.features.push({id:Ue,text:At,icon:Bt,index:Ve,sourceLayerIndex:nt,geometry:gt.geometry,properties:ze.properties,type:m6[ze.type],sortKey:Yt}),Bt&&(te[Bt.namePrimary]=!0,Bt.nameSecondary&&(te[Bt.nameSecondary]=!0)),At){const Ft=k.evaluate(gt,{},c).join(","),_r=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Nh.vertical)>=0;for(const Pr of At.sections)if(Pr.image)te[Pr.image.namePrimary]=!0;else{const dr=ut(At.toString()),Er=Pr.fontStack||Ft,lr=oe[Er]=oe[Er]||{};this.calculateGlyphDependencies(Pr.text,lr,_r,this.allowVerticalPlacement,dr)}}}b.get("symbol-placement")==="line"&&(this.features=function(ze){const Ue={},Ve={},nt=[];let Qe=0;function gt(Ft){nt.push(ze[Ft]),Qe++}function At(Ft,_r,Pr){const dr=Ve[Ft];return delete Ve[Ft],Ve[_r]=dr,nt[dr].geometry[0].pop(),nt[dr].geometry[0]=nt[dr].geometry[0].concat(Pr[0]),dr}function Bt(Ft,_r,Pr){const dr=Ue[_r];return delete Ue[_r],Ue[Ft]=dr,nt[dr].geometry[0].shift(),nt[dr].geometry[0]=Pr[0].concat(nt[dr].geometry[0]),dr}function Yt(Ft,_r,Pr){const dr=Pr?_r[0][_r[0].length-1]:_r[0][0];return`${Ft}:${dr.x}:${dr.y}`}for(let Ft=0;Ft<ze.length;Ft++){const _r=ze[Ft],Pr=_r.geometry,dr=_r.text?_r.text.toString():null;if(!dr){gt(Ft);continue}const Er=Yt(dr,Pr),lr=Yt(dr,Pr,!0);if(Er in Ve&&lr in Ue&&Ve[Er]!==Ue[lr]){const Sr=Bt(Er,lr,Pr),Yr=At(Er,lr,nt[Sr].geometry);delete Ue[Er],delete Ve[lr],Ve[Yt(dr,nt[Yr].geometry,!0)]=Yr,nt[Sr].geometry=null}else Er in Ve?At(Er,lr,Pr):lr in Ue?Bt(Er,lr,Pr):(gt(Ft),Ue[Er]=Qe-1,Ve[lr]=Qe-1)}return nt.filter(Ft=>Ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,Ue)=>ze.sortKey-Ue.sortKey)}update(t,i,c,m,g){const b=Object.keys(t).length!==0;if(b&&!this.stateDependentLayers.length)return;const C=b?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,i,C,c,m,g),this.icon.programConfigurations.updatePaintArrays(t,i,C,c,m,g)}updateZOffset(){const t=(g,b,C)=>{c+=b,c>g.length&&g.resize(c);for(let k=-b;k<0;k++)g.emplace(k+c,C)},i=(g,b,C)=>{m+=b,m>g.length&&g.resize(m);for(let k=-b;k<0;k++)g.emplace(k+m,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,m=0;for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:k,numIconVertices:R}=b,z=b.zOffset,V=R>0;if((C>0||k>0)&&(t(this.text.zOffsetVertexArray,C,z),t(this.text.zOffsetVertexArray,k,z)),V){const{placedIconSymbolIndex:q,verticalPlacedIconSymbolIndex:Q}=b;q>=0&&i(this.icon.zOffsetVertexArray,R,z),Q>=0&&i(this.icon.zOffsetVertexArray,b.numVerticalIconVertices,z)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Kk(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:m,y:g}of i)this.lineVertexArray.emplaceBack(m,g);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,i,c,m,g,b,C,k,R,z,V,q,Q,te,oe,pe){const _e=t.indexArray,ze=t.layoutVertexArray,Ue=t.globeExtVertexArray,Ve=t.segments.prepareSegment(4*i.length,ze,_e,this.canOverlap?b.sortKey:void 0),nt=this.glyphOffsetArray.length,Qe=Ve.vertexLength,gt=this.allowVerticalPlacement&&C===Nh.vertical?Math.PI/2:0,At=b.text&&b.text.sections;for(let Yt=0;Yt<i.length;Yt++){const{tl:Ft,tr:_r,bl:Pr,br:dr,texPrimary:Er,texSecondary:lr,pixelOffsetTL:Sr,pixelOffsetBR:Yr,minFontScaleX:kr,minFontScaleY:bn,glyphOffset:dn,isSDF:jr,sectionIndex:ti}=i[Yt],zn=Ve.vertexLength,yn=dn[1];if(iw(ze,R.x,R.y,Ft.x,yn+Ft.y,Er.x,Er.y,c,jr,Sr.x,Sr.y,kr,bn),iw(ze,R.x,R.y,_r.x,yn+_r.y,Er.x+Er.w,Er.y,c,jr,Yr.x,Sr.y,kr,bn),iw(ze,R.x,R.y,Pr.x,yn+Pr.y,Er.x,Er.y+Er.h,c,jr,Sr.x,Yr.y,kr,bn),iw(ze,R.x,R.y,dr.x,yn+dr.y,Er.x+Er.w,Er.y+Er.h,c,jr,Yr.x,Yr.y,kr,bn),k){const{x:Br,y:Wn,z:Wi}=k.anchor,[ci,Hi,Ei]=k.up;aw(Ue,Br,Wn,Wi,ci,Hi,Ei),aw(Ue,Br,Wn,Wi,ci,Hi,Ei),aw(Ue,Br,Wn,Wi,ci,Hi,Ei),aw(Ue,Br,Wn,Wi,ci,Hi,Ei),sw(t.dynamicLayoutVertexArray,Br,Wn,Wi,gt)}else sw(t.dynamicLayoutVertexArray,R.x,R.y,R.z,gt);if(pe){const Br=lr||Er;ow(t.iconTransitioningVertexArray,Br.x,Br.y),ow(t.iconTransitioningVertexArray,Br.x+Br.w,Br.y),ow(t.iconTransitioningVertexArray,Br.x,Br.y+Br.h),ow(t.iconTransitioningVertexArray,Br.x+Br.w,Br.y+Br.h)}_e.emplaceBack(zn,zn+1,zn+2),_e.emplaceBack(zn+1,zn+2,zn+3),Ve.vertexLength+=4,Ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(dn[0]),Yt!==i.length-1&&ti===i[Yt+1].sectionIndex||t.programConfigurations.populatePaintArrays(ze.length,b,b.index,{},Q,te,oe,At&&At[ti])}const Bt=k?k.anchor:R;t.placedSymbolArray.emplaceBack(Bt.x,Bt.y,Bt.z,R.x,R.y,nt,this.glyphOffsetArray.length-nt,Qe,z,V,R.segment,c?c[0]:0,c?c[1]:0,m[0],m[1],C,0,!1,0,q,0)}_commitLayoutVertex(t,i,c,m,g,b,C){t.emplaceBack(i,c,m,g,b,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(t,i,c,m,g,b,C){const k=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),R=k.vertexLength,z=C.tileAnchorX,V=C.tileAnchorY;for(let Q=0;Q<4;Q++)c.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,i,t.padding,C.zOffset),this._commitLayoutVertex(c.layoutVertexArray,m,g,b,z,V,new Ge(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,m,g,b,z,V,new Ge(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,m,g,b,z,V,new Ge(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,m,g,b,z,V,new Ge(t.x1,t.y2)),k.vertexLength+=4;const q=c.indexArray;q.emplaceBack(R,R+1),q.emplaceBack(R+1,R+2),q.emplaceBack(R+2,R+3),q.emplaceBack(R+3,R),k.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,c,m,g,b){for(let C=m;C<g;C++){const k=c.get(C),R=this.getSymbolInstanceTextSize(t,b,i,C);this._addCollisionDebugVertices(k,R,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(t,i,c,m,g,b){for(let C=m;C<g;C++){const k=c.get(C),R=this.getSymbolInstanceIconSize(t,i,b.placedIconSymbolIndex);this._addCollisionDebugVertices(k,R,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,b)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rE(Ed,_k.members,Uc),this.iconCollisionBox=new rE(Ed,_k.members,Uc);const c=ov(this.iconSizeData,t),m=ov(this.textSizeData,t);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(m,t,i,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(m,t,i,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(c,t,i,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(c,t,i,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(t,i,c,m){const g=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:m),b=Zb(this.textSizeData,t,g)/Vl;return this.tilePixelRatio*b}getSymbolInstanceIconSize(t,i,c){const m=this.icon.placedSymbolArray.get(c),g=Zb(this.iconSizeData,t,m);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(t,i,c,m){t.emplaceBack(i,-c,-c,m),t.emplaceBack(i,c,-c,m),t.emplaceBack(i,c,c,m),t.emplaceBack(i,-c,c,m)}_updateTextDebugCollisionBoxes(t,i,c,m,g,b){for(let C=m;C<g;C++){const k=c.get(C),R=this.getSymbolInstanceTextSize(t,b,i,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,k.padding,b.zOffset)}}_updateIconDebugCollisionBoxes(t,i,c,m,g,b){for(let C=m;C<g;C++){const k=c.get(C),R=this.getSymbolInstanceIconSize(t,i,b.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,k.padding,b.zOffset)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=ov(this.iconSizeData,t),m=ov(this.textSizeData,t);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(m,t,i,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(m,t,i,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(c,t,i,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._updateIconDebugCollisionBoxes(c,t,i,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,c,m,g,b,C,k,R){const z={};if(i<c){const{x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve,featureIndex:nt}=t.get(i);z.textBox={x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve},z.textFeatureIndex=nt}if(m<g){const{x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve,featureIndex:nt}=t.get(m);z.verticalTextBox={x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve},z.verticalTextFeatureIndex=nt}if(b<C){const{x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve,featureIndex:nt}=t.get(b);z.iconBox={x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve},z.iconFeatureIndex=nt}if(k<R){const{x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve,featureIndex:nt}=t.get(k);z.verticalIconBox={x1:V,y1:q,x2:Q,y2:te,padding:oe,projectedAnchorX:pe,projectedAnchorY:_e,projectedAnchorZ:ze,tileAnchorX:Ue,tileAnchorY:Ve},z.verticalIconFeatureIndex=nt}return z}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,i){const c=t.placedSymbolArray.get(i),m=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<m;g+=4)t.indexArray.emplaceBack(g,g+1,g+2),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),c=Math.cos(t),m=[],g=[],b=[];for(let C=0;C<this.symbolInstances.length;++C){b.push(C);const k=this.symbolInstances.get(C);m.push(0|Math.round(i*k.tileAnchorX+c*k.tileAnchorY)),g.push(k.featureIndex)}return b.sort((C,k)=>m[C]-m[k]||g[k]-g[C]),b}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,i){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===i?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const c=this.symbolInstances.get(i);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:R}=c;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),g>=0&&g!==m&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&b!==g&&b!==m&&this.addIndicesForPlacedSymbol(this.text,b),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}re(lw,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),lw.addDynamicAttributes=sw;const y6=new go({"symbol-placement":new Dr(jt.layout_symbol["symbol-placement"]),"symbol-spacing":new Dr(jt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Dr(jt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new an(jt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Dr(jt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Dr(jt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Dr(jt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Dr(jt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Dr(jt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Dr(jt.layout_symbol["icon-rotation-alignment"]),"icon-size":new an(jt.layout_symbol["icon-size"]),"icon-text-fit":new an(jt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new an(jt.layout_symbol["icon-text-fit-padding"]),"icon-image":new an(jt.layout_symbol["icon-image"]),"icon-rotate":new an(jt.layout_symbol["icon-rotate"]),"icon-padding":new Dr(jt.layout_symbol["icon-padding"]),"icon-keep-upright":new Dr(jt.layout_symbol["icon-keep-upright"]),"icon-offset":new an(jt.layout_symbol["icon-offset"]),"icon-anchor":new an(jt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Dr(jt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Dr(jt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Dr(jt.layout_symbol["text-rotation-alignment"]),"text-field":new an(jt.layout_symbol["text-field"]),"text-font":new an(jt.layout_symbol["text-font"]),"text-size":new an(jt.layout_symbol["text-size"]),"text-max-width":new an(jt.layout_symbol["text-max-width"]),"text-line-height":new an(jt.layout_symbol["text-line-height"]),"text-letter-spacing":new an(jt.layout_symbol["text-letter-spacing"]),"text-justify":new an(jt.layout_symbol["text-justify"]),"text-radial-offset":new an(jt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Dr(jt.layout_symbol["text-variable-anchor"]),"text-anchor":new an(jt.layout_symbol["text-anchor"]),"text-max-angle":new Dr(jt.layout_symbol["text-max-angle"]),"text-writing-mode":new Dr(jt.layout_symbol["text-writing-mode"]),"text-rotate":new an(jt.layout_symbol["text-rotate"]),"text-padding":new Dr(jt.layout_symbol["text-padding"]),"text-keep-upright":new Dr(jt.layout_symbol["text-keep-upright"]),"text-transform":new an(jt.layout_symbol["text-transform"]),"text-offset":new an(jt.layout_symbol["text-offset"]),"text-allow-overlap":new Dr(jt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Dr(jt.layout_symbol["text-ignore-placement"]),"text-optional":new Dr(jt.layout_symbol["text-optional"]),visibility:new Dr(jt.layout_symbol.visibility)});var nE={paint:new go({"icon-opacity":new an(jt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new an(jt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new an(jt.paint_symbol["text-emissive-strength"]),"icon-color":new an(jt.paint_symbol["icon-color"]),"icon-halo-color":new an(jt.paint_symbol["icon-halo-color"]),"icon-halo-width":new an(jt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new an(jt.paint_symbol["icon-halo-blur"]),"icon-translate":new Dr(jt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Dr(jt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new an(jt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new an(jt.paint_symbol["text-opacity"]),"text-color":new an(jt.paint_symbol["text-color"],{runtimeType:Xr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new an(jt.paint_symbol["text-halo-color"]),"text-halo-width":new an(jt.paint_symbol["text-halo-width"]),"text-halo-blur":new an(jt.paint_symbol["text-halo-blur"]),"text-translate":new Dr(jt.paint_symbol["text-translate"]),"text-translate-anchor":new Dr(jt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Dr(jt.paint_symbol["icon-color-saturation"])}),layout:y6};class Jk{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:He,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}re(Jk,"FormatSectionOverride",{omit:["defaultValue"]});class cw extends ia{constructor(t,i,c){super(t,nE,i,c)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const m=[];for(const g of c)m.indexOf(g)<0&&m.push(g);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,c,m){const g=this.layout.get(t).evaluate(i,{},c,m),b=this._unevaluatedLayout._values[t];return b.isDataDriven()||Js(b.value)||!g?g:function(C,k){return k.replace(/{([^{}]+)}/g,(R,z)=>z in C?String(C[z]):"")}(i.properties,g)}createBucket(t){return new lw(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of nE.paint.overridableProperties){if(!cw.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),c=new Jk(i),m=new xc(c,i.property.specification,this.scope,this.options);let g=null;g=i.value.kind==="constant"||i.value.kind==="source"?new Ih("source",m):new Ch("composite",m,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new ra(i.property,g,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,c){return!(!this.layout||i.isDataDriven()||c.isDataDriven())&&cw.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const c=t.get("text-field"),m=nE.paint.properties[i];let g=!1;const b=C=>{for(const k of C)if(m.overrides&&m.overrides.hasOverride(k))return void(g=!0)};if(c.value.kind==="constant"&&c.value.value instanceof ea)b(c.value.value.sections);else if(c.value.kind==="source"){const C=R=>{g||(R instanceof $a&&ta(R.value)===Ca?b(R.value.sections):R instanceof ed?b(R.sections):R.eachChild(C))},k=c.value;k._styleExpression&&C(k._styleExpression.expression)}return g}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,c=[];return t&&c.push("symbolIcon"),i&&c.push("symbolSDF"),c}getDefaultProgramParams(t,i){return{config:new he(this,i),overrideFog:!1}}}const v6=new go({visibility:new Dr(jt.layout_background.visibility)});var x6={paint:new go({"background-color":new Dr(jt.paint_background["background-color"]),"background-pattern":new Dr(jt.paint_background["background-pattern"]),"background-opacity":new Dr(jt.paint_background["background-opacity"]),"background-emissive-strength":new Dr(jt.paint_background["background-emissive-strength"])}),layout:v6};const b6=new go({visibility:new Dr(jt.layout_raster.visibility)});var w6={paint:new go({"raster-opacity":new Dr(jt.paint_raster["raster-opacity"]),"raster-color":new na(jt.paint_raster["raster-color"]),"raster-color-mix":new Dr(jt.paint_raster["raster-color-mix"]),"raster-color-range":new Dr(jt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Dr(jt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Dr(jt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Dr(jt.paint_raster["raster-brightness-max"]),"raster-saturation":new Dr(jt.paint_raster["raster-saturation"]),"raster-contrast":new Dr(jt.paint_raster["raster-contrast"]),"raster-resampling":new Dr(jt.paint_raster["raster-resampling"]),"raster-fade-duration":new Dr(jt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Dr(jt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Dr(jt.paint_raster["raster-array-band"]),"raster-elevation":new Dr(jt.paint_raster["raster-elevation"])}),layout:b6},iE=bo([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class oE{constructor(t,i,c,m){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(i,m)}update(t,i,c){const{width:m,height:g}=t,{context:b}=this,{gl:C}=b;if(C.bindTexture(C.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!i||i.premultiply!==!1)),c||this.size&&this.size[0]===m&&this.size[1]===g){const{x:k,y:R}=c||{x:0,y:0};if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap)C.texSubImage2D(C.TEXTURE_2D,0,k,R,C.RGBA,C.UNSIGNED_BYTE,t);else{let z=this.format,V=C.UNSIGNED_BYTE;this.format===C.R32F&&(z=C.RED,V=C.FLOAT),C.texSubImage2D(C.TEXTURE_2D,0,k,R,m,g,z,V,t.data)}}else if(this.size=[m,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap){let k=this.format;this.format===C.R8&&(k=C.RED),C.texImage2D(C.TEXTURE_2D,0,this.format,k,C.UNSIGNED_BYTE,t)}else{let k=this.format,R=this.format,z=C.UNSIGNED_BYTE;this.format===C.DEPTH_COMPONENT&&(k=C.DEPTH_COMPONENT16,z=C.UNSIGNED_SHORT),this.format===C.R8&&(R=C.RED),this.format===C.R32F&&(z=C.FLOAT,R=C.RED),C.texImage2D(C.TEXTURE_2D,0,k,m,g,0,R,z,t.data)}this.useMipmap=!!(i&&i.useMipmap),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(t,i,c=!1){const{context:m}=this,{gl:g}=m;g.bindTexture(g.TEXTURE_2D,this.texture),t!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!c?t===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),i!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(t,i,c,m){const{context:g}=this,{gl:b}=g;b.bindTexture(b.TEXTURE_2D,this.texture),i!==this.magFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,i),this.magFilter=i),t!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap?t===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),c!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),this.wrapS=c),m!==this.wrapT&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class uw{constructor(t,i){this.context=t,this.texture=i}bind(t,i){const{context:c}=this,{gl:m}=c;m.bindTexture(m.TEXTURE_2D,this.texture),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,t),this.minFilter=t),i!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,i),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,i),this.wrapS=i)}}function hw(r,t,i,c,m,g,b,C){const k=[r,t,1,i,c,1,m,g,1],R=[b,C,1],z=s.co.adjoint([],k),[V,q,Q]=s.N.transformMat3(R,R,z);return s.co.multiply(k,k,[V,0,0,0,q,0,0,0,Q])}function Qk(r,t,i,c,m,g,b,C){const k=function(R,z,V,q,Q,te,oe,pe){const _e=hw(0,0,1,0,1,1,0,1),ze=hw(R,z,V,q,Q,te,oe,pe),Ue=s.co.adjoint([],_e);return s.co.multiply(ze,ze,Ue)}(r,t,i,c,m,g,b,C);return[k[2]/k[8]/Jr,k[5]/k[8]/Jr]}function dw(r){return[r[0],Math.min(Math.max(r[1],-Vi),Vi)]}class e3 extends kl{constructor(t,i,c,m){super(),this.id=t,this.dispatcher=c,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=i,this._dirty=!1}load(t,i){if(this._loaded=i||!1,this.fire(new qi("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=bt(this.map._requestManager.transformRequest(this.url,et.Image),(c,m)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new rs(c)):m&&(this.image=m instanceof HTMLImageElement?br.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new uw(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new qi("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof uw||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=t[0][1],c=t[0][1];for(const g of t)g[1]>c&&(c=g[1]),g[1]<i&&(i=g[1]);const m=(c+i)/2;if(m>Vi?this.onNorthPole=!0:m<-Vi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=t.map(no.fromLngLat);this.tileID=function(b){let C=1/0,k=1/0,R=-1/0,z=-1/0;for(const oe of b)C=Math.min(C,oe.x),k=Math.min(k,oe.y),R=Math.max(R,oe.x),z=Math.max(z,oe.y);const V=Math.max(R-C,z-k),q=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),Q=Math.pow(2,q);let te=Math.floor((C+R)/2*Q);return te>1&&(te-=1),new Lr(q,te,Math.floor((k+z)/2*Q))}(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new qi("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const _e in this.tiles){const ze=this.tiles[_e];ze.state!=="loaded"&&(ze.state="loaded",ze.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const i=yx(new Lr(0,0,0),this.map.transform.projection),c=[i.projection.project(this.coordinates[0][0],this.coordinates[0][1]),i.projection.project(this.coordinates[1][0],this.coordinates[1][1]),i.projection.project(this.coordinates[2][0],this.coordinates[2][1]),i.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(_e){const ze=_e[1].x-_e[0].x,Ue=_e[1].y-_e[0].y,Ve=_e[2].x-_e[1].x,nt=_e[2].y-_e[1].y,Qe=_e[3].x-_e[2].x,gt=_e[3].y-_e[2].y,At=_e[0].x-_e[3].x,Bt=_e[0].y-_e[3].y,Yt=ze*nt-Ve*Ue,Ft=Ve*gt-Qe*nt,_r=Qe*Bt-At*gt,Pr=At*Ue-ze*Bt;return Yt>0&&Ft>0&&_r>0&&Pr>0||Yt<0&&Ft<0&&_r<0&&Pr<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=yx(this.tileID,this.map.transform.projection),[g,b,C,k]=this.coordinates.map(_e=>{const ze=m.projection.project(_e[0],_e[1]);return Wk(m,ze)._round()});this.perspectiveTransform=Qk(g.x,g.y,b.x,b.y,C.x,C.y,k.x,k.y);const R=this._boundsArray=new oc;R.emplaceBack(g.x,g.y,0,0),R.emplaceBack(b.x,b.y,Jr,0),R.emplaceBack(k.x,k.y,0,Jr),R.emplaceBack(C.x,C.y,Jr,Jr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(R,iE.members),this.boundsSegments=ua.simpleSegment(0,0,4,2);const z=[],V=[dw((q=this.coordinates)[0]),dw(q[1]),dw(q[2]),dw(q[3])];var q;const[Q,te,oe,pe]=function(_e){let ze=_e[0][0],Ue=ze,Ve=_e[0][1],nt=Ve;for(let Qe=1;Qe<_e.length;Qe++)_e[Qe][0]<ze?ze=_e[Qe][0]:_e[Qe][0]>Ue&&(Ue=_e[Qe][0]),_e[Qe][1]<Ve?Ve=_e[Qe][1]:_e[Qe][1]>nt&&(nt=_e[Qe][1]);return[ze,Ve,Ue-ze,nt-Ve]}(V);{const _e=new oc,[ze,Ue,Ve,nt]=function(Sr){let Yr=Sr[0].x,kr=Yr,bn=Sr[0].y,dn=bn;for(let jr=1;jr<Sr.length;jr++)Sr[jr].x<Yr?Yr=Sr[jr].x:Sr[jr].x>kr&&(kr=Sr[jr].x),Sr[jr].y<bn?bn=Sr[jr].y:Sr[jr].y>dn&&(dn=Sr[jr].y);return[Yr,bn,kr-Yr,dn-bn]}(c),Qe=Sr=>[(Sr.x-ze)/Ve,(Sr.y-Ue)/nt],[gt,At,Bt,Yt]=c.map(Qe),Ft=function(Sr,Yr,kr,bn,dn,jr,ti,zn){const yn=hw(0,0,1,0,1,1,0,1),Br=hw(Sr,Yr,kr,bn,dn,jr,ti,zn),Wn=s.co.adjoint([],Br);return s.co.multiply(yn,yn,Wn)}(gt[0],gt[1],At[0],At[1],Bt[0],Bt[1],Yt[0],Yt[1]);this.elevatedGlobePerspectiveTransform=Qk(gt[0],gt[1],At[0],At[1],Bt[0],Bt[1],Yt[0],Yt[1]);const _r=(Sr,Yr)=>{z.push(Sr.lng);const kr=Math.round((Sr.lng-Q)/oe*Jr),bn=Math.round((Sr.lat-te)/pe*Jr),dn=Qe(Yr),jr=s.N.transformMat3([],[dn[0],dn[1],1],Ft),ti=Math.round(jr[0]/jr[2]*Jr),zn=Math.round(jr[1]/jr[2]*Jr);_e.emplaceBack(kr,bn,ti,zn)},Pr=c[3].x-c[0].x,dr=c[3].y-c[0].y,Er=c[2].x-c[1].x,lr=c[2].y-c[1].y;for(let Sr=0;Sr<65;Sr++){const Yr=Sr/64,kr=[c[0].x+Yr*Pr,c[0].y+Yr*dr],bn=[c[1].x+Yr*Er,c[1].y+Yr*lr],dn=bn[0]-kr[0],jr=bn[1]-kr[1];for(let ti=0;ti<65;ti++){const zn=ti/64,yn={x:kr[0]+dn*zn,y:kr[1]+jr*zn,z:0};_r(i.projection.unproject(yn.x,yn.y),yn)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(_e,iE.members)}{this.maxLongitudeTriangleSize=0;let _e=[],ze=new Wa;const Ue=(Ve,nt,Qe)=>{ze.emplaceBack(Ve,nt,Qe);const gt=z[Ve],At=z[nt],Bt=z[Qe],Yt=Math.min(Math.min(gt,At),Bt),Ft=Math.max(Math.max(gt,At),Bt)-Yt;Ft>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ft),_e.push(Yt+Ft/2)};for(let Ve=0;Ve<64;Ve++)for(let nt=0;nt<64;nt++){const Qe=65*Ve+nt,gt=Qe+1,At=Qe+65,Bt=At+1;Ue(Qe,At,gt),Ue(gt,At,Bt)}[_e,ze]=function(Ve,nt){const Qe=Array.from({length:Ve.length},(Bt,Yt)=>Yt);Qe.sort((Bt,Yt)=>Ve[Bt]-Ve[Yt]);const gt=[],At=new Wa;for(let Bt=0;Bt<Qe.length;Bt++){const Yt=Qe[Bt];gt.push(Ve[Yt]);const Ft=3*Yt,_r=Ft+1;At.emplaceBack(nt.uint16[Ft],nt.uint16[_r],nt.uint16[_r+1])}return[gt,At]}(_e,ze),this.elevatedGlobeTrianglesCenterLongitudes=_e,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(ze)}this.elevatedGlobeSegments=ua.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,oe/Jr,0,pe/Jr,0,0,te,Q,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const i=this.map.painter.context,c=i.gl;!this._dirty||this.texture instanceof uw||(this.texture?this.texture.update(this.image):(this.texture=new oE(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(i)}loadTile(t,i){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},i(null)):(t.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const i=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!i)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let m=((z,V)=>z+360*Math.round((V-z)/360))(t+180,c[0]);const g=new ua,b=(z,V)=>{g.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:i.segments[0].vertexLength,primitiveLength:V,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-m)<=C){const z=$t(c,0,c.length,m+C);return z===c.length||b(z,at(c,z+1,c.length,m+360-C)-z),g}m<c[0]&&(m+=360);const k=at(c,0,c.length,m-C);if(k===c.length)return b(0,c.length),g;b(0,k-0);const R=$t(c,k+1,c.length,m+C);return R!==c.length&&b(R,c.length-R),g}}const S6=(Math.pow(256,2)-1)/16907520;class t3 extends ia{constructor(t,i,c){super(t,w6,i,c),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isLayerDraped(t){return!(t&&t._source instanceof e3&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const i=this._transitionablePaint._values["raster-color"].value.expression,[c,m]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(m)||c===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=mg({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,m])}}const T6=new go({visibility:new Dr(jt["layout_raster-particle"].visibility)});var E6={paint:new go({"raster-particle-array-band":new Dr(jt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Dr(jt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new na(jt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Dr(jt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Dr(jt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Dr(jt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Dr(jt["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:T6};class r3 extends ia{constructor(t,i,c){super(t,E6,i,c),this._updateColorRamp(),this.onRemove=m=>{this.colorRampTexture&&this.colorRampTexture.destroy(),this.transformFeedbackObject&&m.painter.context.gl.deleteTransformFeedback(this.transformFeedbackObject),this.tileFramebuffer&&this.tileFramebuffer.destroy()},this.lastInvalidatedAt=br.now()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isLayerDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,i=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=mg({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:i}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=br.now()}}class I6 extends ia{constructor(t,i){super(t,{},i),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const C6=new go({visibility:new Dr(jt.layout_sky.visibility)});var A6={paint:new go({"sky-type":new Dr(jt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Dr(jt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Dr(jt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Dr(jt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Dr(jt.paint_sky["sky-gradient-radius"]),"sky-gradient":new na(jt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Dr(jt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Dr(jt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Dr(jt.paint_sky["sky-opacity"])}),layout:C6};function aE(r,t,i){const c=[0,0,1],m=s.bi.identity([]);return s.bi.rotateY(m,m,i?-Et(r)+Math.PI:Et(r)),s.bi.rotateX(m,m,-Et(t)),s.N.transformQuat(c,c,m),s.N.normalize(c,c)}var P6={paint:new go({})};function n3(r,t){const i=pw(r.projection,r.zoom,r.width,r.height),c=function(g,b,C,k,R){const z=new zt(C.lng-180*Tg,C.lat),V=new zt(C.lng+180*Tg,C.lat),q=g.project(z.lng,z.lat),Q=g.project(V.lng,V.lat),te=-Math.atan2(Q.y-q.y,Q.x-q.x),oe=no.fromLngLat(C);oe.y=Ht(oe.y,-1+Tg,1-Tg);const pe=oe.toLngLat(),_e=g.project(pe.lng,pe.lat),ze=no.fromLngLat(pe);ze.x+=Tg;const Ue=ze.toLngLat(),Ve=g.project(Ue.lng,Ue.lat),nt=a3(Ve.x-_e.x,Ve.y-_e.y,te),Qe=no.fromLngLat(pe);Qe.y+=Tg;const gt=Qe.toLngLat(),At=g.project(gt.lng,gt.lat),Bt=a3(At.x-_e.x,At.y-_e.y,te),Yt=Math.abs(nt.x)/Math.abs(Bt.y),Ft=s.a6.identity([]);s.a6.rotateZ(Ft,Ft,-te*(1-(R?0:k)));const _r=s.a6.identity([]);return s.a6.scale(_r,_r,[1,1-(1-Yt)*k,1]),_r[4]=-Bt.x/Bt.y*k,s.a6.rotateZ(_r,_r,te),s.a6.multiply(_r,Ft,_r),_r}(r.projection,0,r.center,i,t),m=i3(r);return s.a6.scale(c,c,[m,m,1]),c}function i3(r){const t=r.projection,i=pw(r.projection,r.zoom,r.width,r.height),c=o3(t,r.center),m=o3(t,zt.convert(t.center));return Math.pow(2,c*i+(1-i)*m)}function pw(r,t,i,c,m=1/0){const g=r.range;if(!g)return 0;const b=Math.min(m,Math.max(i,c)),C=Math.log(b/1024)/Math.LN2;return Qt(g[0]+C,g[1]+C,t)}const Tg=1/4e4;function o3(r,t){const i=Ht(t.lat,-Vi,Vi),c=new zt(t.lng-180*Tg,i),m=new zt(t.lng+180*Tg,i),g=r.project(c.lng,i),b=r.project(m.lng,i),C=no.fromLngLat(c),k=no.fromLngLat(m),R=b.x-g.x,z=b.y-g.y,V=k.x-C.x,q=k.y-C.y,Q=Math.sqrt((V*V+q*q)/(R*R+z*z));return Math.log(Q)/Math.LN2}function a3(r,t,i){const c=Math.cos(i),m=Math.sin(i);return{x:r*c-t*m,y:r*m+t*c}}function s3(r,t,i){s.a6.identity(r),s.a6.rotateZ(r,r,Et(t[2])),s.a6.rotateX(r,r,Et(t[0])),s.a6.rotateY(r,r,Et(t[1])),s.a6.scale(r,r,i),s.a6.multiply(r,r,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function fw(r,t,i,c,m,g,b,C){const k=[i[0]-t[0],i[1]-t[1],0],R=[c[0]-t[0],c[1]-t[1],0];if(s.N.length(k)<1e-12||s.N.length(R)<1e-12)return s.bi.identity(r);const z=s.N.cross([],k,R);s.N.normalize(z,z),s.N.subtract(R,c,t),k[2]=(g-m)*C,R[2]=(b-m)*C;const V=k;return s.N.cross(V,k,R),s.N.normalize(V,V),s.bi.rotationTo(r,z,V)}function sE(r,t,i=!1){const c=oa(t.zoom),m=function(g,b,C){const k=b.worldSize,R=[g[12],g[13],g[14]],z=ro(R[1]/k),V=Ti(R[0]/k),q=s.a6.identity([]),Q=Ci(1,z)*k,te=Ci(1,0)*k*fi(z,b.zoom),oe=1/V_(k);let pe=te*oe;if(C){const Ve=pw(b.projection,b.zoom,b.width,b.height,1024);pe=oe*b.projection.pixelSpaceConversion(b.center.lat,k,Ve)}const _e=hr(z,V);s.N.add(_e,_e,s.N.scale([],s.N.normalize([],_e),Q*pe*R[2]));const ze=function(Ve){const nt=[Ve[0],Ve[1],Ve[2]];let Qe=[0,1,0];const gt=s.N.cross([],Qe,nt);return s.N.cross(Qe,nt,gt),s.N.squaredLength(Qe)===0&&(Qe=[0,1,0],s.N.cross(gt,nt,Qe)),s.N.normalize(gt,gt),s.N.normalize(Qe,Qe),s.N.normalize(nt,nt),[gt[0],gt[1],gt[2],0,Qe[0],Qe[1],Qe[2],0,nt[0],nt[1],nt[2],0,Ve[0],Ve[1],Ve[2],1]}(_e);s.a6.scale(q,q,[pe,pe,pe*Q]),s.a6.translate(q,q,[-R[0],-R[1],-R[2]]);const Ue=s.a6.multiply([],b.globeMatrix,ze);return s.a6.multiply(Ue,Ue,q),s.a6.multiply(Ue,Ue,g),Ue}(r,t,i);if(c>0){const g=function(b,C){const k=C.worldSize,R=Ci(1,0)*k*fi(C.center.lat,C.zoom)/V_(k),z=Ci(1,C.center.lat)*k,V=s.a6.identity([]);return s.a6.rotateY(V,V,Et(C.center.lng)),s.a6.rotateX(V,V,Et(C.center.lat)),s.a6.translate(V,V,[0,0,Be]),s.a6.scale(V,V,[R,R,R*z]),s.a6.translate(V,V,[C.point.x-.5*k,C.point.y-.5*k,0]),s.a6.multiply(V,V,b),s.a6.multiply(V,C.globeMatrix,V)}(r,t);return function(b,C,k){const R=(te,oe,pe)=>{const _e=s.N.length(te),ze=s.N.length(oe),Ue=nh(te,oe,pe);return s.N.scale(Ue,Ue,1/s.N.length(Ue)*Hn(_e,ze,pe))},z=R([b[0],b[1],b[2]],[C[0],C[1],C[2]],k),V=R([b[4],b[5],b[6]],[C[4],C[5],C[6]],k),q=R([b[8],b[9],b[10]],[C[8],C[9],C[10]],k),Q=nh([b[12],b[13],b[14]],[C[12],C[13],C[14]],k);return[z[0],z[1],z[2],0,V[0],V[1],V[2],0,q[0],q[1],q[2],0,Q[0],Q[1],Q[2],1]}(m,g,c)}return m}function l3(r,t,i,c){const m=Ko.projectAabbCorners(c,i);let g=Number.MAX_VALUE,b=-1;for(let R=0;R<m.length;++R){const z=m[R];z[0]=(.5*z[0]+.5)*t.width,z[1]=(.5-.5*z[1])*t.height,z[2]<g&&(b=R,g=z[2])}const C=R=>new Ge(m[R][0],m[R][1]);let k;switch(b){case 0:case 6:k=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:k=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:k=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:k=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(wu(r,k))return g}const M6=bo([{name:"a_pos_3f",components:3,type:"Float32"}]),k6=bo([{name:"a_color_3f",components:3,type:"Float32"}]),R6=bo([{name:"a_color_4f",components:4,type:"Float32"}]),D6=bo([{name:"a_uv_2f",components:2,type:"Float32"}]),O6=bo([{name:"a_normal_3f",components:3,type:"Float32"}]),L6=bo([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),z6=bo([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class c3{constructor(t,i){this.feature=t,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class u3{constructor(){this.instancedDataArray=new Cd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class lE{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,i,c,m){this.tileToMeter=oi(c);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:b,id:C,index:k,sourceLayerIndex:R}of t){const z=ls(b,g);if(!this.layers[0]._featureFilter.filter(new $n(this.zoom),z,c))continue;const V={id:C,sourceLayerIndex:R,index:k,geometry:g?z.geometry:ss(b,c,m),properties:b.properties,type:b.type,patterns:{}},q=this.addFeature(V,V.geometry,z);q&&i.featureIndex.insert(b,V.geometry,k,R,this.index,this.instancesPerModel[q].instancedDataArray.length,Jr/32)}this.lookup=null}update(t,i,c,m){for(const g in this.instancesPerModel){const b=this.instancesPerModel[g];for(const C in t)b.idToFeaturesIndex.hasOwnProperty(C)&&this.evaluate(b.features[b.idToFeaturesIndex[C]],t[C],b,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const i in this.instancesPerModel){const c=this.instancesPerModel[i];for(const m of c.features){const g=this.layers[0],b=m.feature,C=this.canonical,k=g.paint.get("model-rotation").evaluate(b,{},C),R=g.paint.get("model-scale").evaluate(b,{},C),z=g.paint.get("model-translation").evaluate(b,{},C);s.N.exactEquals(m.rotation,k)&&s.N.exactEquals(m.scale,R)&&s.N.exactEquals(m.translation,z)||(this.evaluate(m,m.featureStates,c,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const i in this.instancesPerModel){const c=this.instancesPerModel[i];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=t.createVertexBuffer(c.instancedDataArray,L6.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const i=this.instancesPerModel[t];i.instancedDataArray.length!==0&&i.instancedDataBuffer&&i.instancedDataBuffer.destroy()}}addFeature(t,i,c){const m=this.layers[0],g=m.layout.get("model-id").evaluate(c,{},this.canonical);if(!g)return Kt(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),g;this.instancesPerModel[g]||(this.instancesPerModel[g]=new u3);const b=this.instancesPerModel[g],C=b.instancedDataArray,k=new c3(c,C.length);for(const R of i)for(const z of R){if(z.x<0||z.x>=Jr||z.y<0||z.y>=Jr)continue;const V=(this.lookupDim-1)/Jr,q=this.lookupDim*(z.y*V|0)+z.x*V|0;if(this.lookup){if(this.lookup[q]!==0)continue;this.lookup[q]=1}this.instanceCount++;const Q=C.length;C.resize(Q+1),b.instancesEvaluatedElevation.push(0),C.float32[16*Q]=z.x,C.float32[16*Q+1]=z.y}return k.instancedDataCount=b.instancedDataArray.length-k.instancedDataOffset,k.instancedDataCount>0&&(t.id&&(b.idToFeaturesIndex[t.id]=b.features.length),b.features.push(k),this.evaluate(k,{},b,!1)),g}evaluate(t,i,c,m){const g=this.layers[0],b=t.feature,C=this.canonical,k=t.rotation=g.paint.get("model-rotation").evaluate(b,i,C),R=t.scale=g.paint.get("model-scale").evaluate(b,i,C),z=t.translation=g.paint.get("model-translation").evaluate(b,i,C),V=g.paint.get("model-color").evaluate(b,i,C);V.a=g.paint.get("model-color-mix-intensity").evaluate(b,i,C);const q=[];this.maxVerticalOffset<z[2]&&(this.maxVerticalOffset=z[2]),this.maxScale=Math.max(Math.max(this.maxScale,R[0]),Math.max(R[1],R[2])),s3(q,k,R);const Q=Math.round(100*V.a)+V.b/1.05;for(let te=0;te<t.instancedDataCount;++te){const oe=t.instancedDataOffset+te,pe=16*oe,_e=c.instancedDataArray.float32;let ze=0;m&&(ze=_e[pe+6]-c.instancesEvaluatedElevation[oe]);const Ue=0|_e[pe+1];_e[pe]=(0|_e[pe])+V.r/1.05,_e[pe+1]=Ue+V.g/1.05,_e[pe+2]=Q,_e[pe+3]=1/(C.z>10?this.tileToMeter:oi(C,Ue)),_e[pe+4]=z[0],_e[pe+5]=z[1],_e[pe+6]=z[2]+ze,_e[pe+7]=q[0],_e[pe+8]=q[1],_e[pe+9]=q[2],_e[pe+10]=q[4],_e[pe+11]=q[5],_e[pe+12]=q[6],_e[pe+13]=q[8],_e[pe+14]=q[9],_e[pe+15]=q[10],c.instancesEvaluatedElevation[oe]=z[2]}}}re(lE,"ModelBucket",{omit:["layers"]}),re(u3,"PerModelAttributes"),re(c3,"ModelFeature");const N6=new go({visibility:new Dr(jt.layout_model.visibility),"model-id":new an(jt.layout_model["model-id"])});var j6={paint:new go({"model-opacity":new Dr(jt.paint_model["model-opacity"]),"model-rotation":new an(jt.paint_model["model-rotation"]),"model-scale":new an(jt.paint_model["model-scale"]),"model-translation":new an(jt.paint_model["model-translation"]),"model-color":new an(jt.paint_model["model-color"]),"model-color-mix-intensity":new an(jt.paint_model["model-color-mix-intensity"]),"model-type":new Dr(jt.paint_model["model-type"]),"model-cast-shadows":new Dr(jt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Dr(jt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Dr(jt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new an(jt.paint_model["model-emissive-strength"]),"model-roughness":new an(jt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new an(jt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Dr(jt.paint_model["model-cutoff-fade-range"])}),layout:N6};const Y_=64,pv={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function h3(r,t,i,c,m,g,b,C,k,R=!1){const z=i.zoom,V=i.project(c),q=fi(c.lat,z),Q=1/q;s.a6.identity(r),s.a6.translate(r,r,[V.x+b[0]*Q,V.y+b[1]*Q,b[2]]);let te=1,oe=1;const pe=i.worldSize;if(R){if(i.projection.name==="mercator"){let Ve=0;i.elevation&&(Ve=i.elevation.getAtPointOrZero(new no(V.x/pe,V.y/pe),0));const nt=s.a7.transformMat4([],[V.x,V.y,Ve,1],i.projMatrix)[3]/i.cameraToCenterDistance;te=nt,oe=nt*fi(i.center.lat,z)}else if(i.projection.name==="globe"){const Ve=sE(r,i),nt=s.a6.multiply([],i.projMatrix,Ve),Qe=[0,0,0,1];s.a7.transformMat4(Qe,Qe,nt);const gt=Qe[3]/i.cameraToCenterDistance,At=oa(z),Bt=i.projection.pixelsPerMeter(c.lat,pe)*fi(c.lat,z),Yt=i.projection.pixelsPerMeter(i.center.lat,pe)*fi(i.center.lat,z);te=gt/Hn(Bt,Zo(i.center.lat),At),oe=gt*q/Bt,te*=Yt,oe*=Yt}}else te=Q;s.a6.scale(r,r,[te,te,oe]);const _e=[...r],ze=t.orientation,Ue=[];if(s3(Ue,[ze[0]+m[0],ze[1]+m[1],ze[2]+m[2]],g),s.a6.multiply(r,_e,Ue),C&&i.elevation){let Ve=0;const nt=[];if(k&&i.elevation){Ve=function(At,Bt,Yt,Ft,_r){const Pr=Bt.elevation;if(!Pr)return 0;const dr=Ko.projectAabbCorners(Yt,Ft),Er=Ci(1,_r.lat)*Bt.worldSize,lr=function(Wn,Wi){const ci=[0,0,1],Hi=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Ei of Hi){const ao=Wn[Ei.corners[0]],Ri=Wn[Ei.corners[1]],Wo=Wn[Ei.corners[2]],_o=[Ri[0]-ao[0],Ri[1]-ao[1],Wi*(Ri[2]-ao[2])],So=s.N.cross(_o,_o,[Wo[0]-ao[0],Wo[1]-ao[1],Wi*(Wo[2]-ao[2])]);s.N.normalize(So,So),Ei.dotProductWithUp=s.N.dot(So,ci)}return Hi.sort((Ei,ao)=>Ei.dotProductWithUp-ao.dotProductWithUp),Hi[0].corners}(dr,Er),Sr=dr[lr[0]],Yr=dr[lr[1]],kr=dr[lr[2]],bn=dr[lr[3]],dn=Pr.getAtPointOrZero(new no(Sr[0]/Bt.worldSize,Sr[1]/Bt.worldSize),0),jr=Pr.getAtPointOrZero(new no(Yr[0]/Bt.worldSize,Yr[1]/Bt.worldSize),0),ti=Pr.getAtPointOrZero(new no(kr[0]/Bt.worldSize,kr[1]/Bt.worldSize),0),zn=Pr.getAtPointOrZero(new no(bn[0]/Bt.worldSize,bn[1]/Bt.worldSize),0),yn=(dn+zn)/2,Br=(jr+ti)/2;return yn>Br?jr<ti?fw(At,Yr,bn,Sr,jr,zn,dn,Er):fw(At,kr,Sr,bn,ti,dn,zn,Er):dn<zn?fw(At,Sr,Yr,kr,dn,jr,ti,Er):fw(At,bn,kr,Yr,zn,ti,jr,Er),Math.max(yn,Br)}(nt,i,t.aabb,r,c);const Qe=s.a6.fromQuat([],nt),gt=s.a6.multiply([],Qe,Ue);s.a6.multiply(r,_e,gt)}else Ve=i.elevation.getAtPointOrZero(new no(V.x/pe,V.y/pe),0);Ve!==0&&(r[14]+=Ve)}}function Sx(r,t,i=!1){r.uploaded||(r.gfxTexture=new oE(t,r.image,i?t.gl.R8:t.gl.RGBA,{useMipmap:r.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),r.uploaded=!0,r.image=null)}function B6(r,t,i){r.indexBuffer=t.createIndexBuffer(r.indexArray,!1,!0),r.vertexBuffer=t.createVertexBuffer(r.vertexArray,M6.members,!1,!0),r.normalArray&&(r.normalBuffer=t.createVertexBuffer(r.normalArray,O6.members,!1,!0)),r.texcoordArray&&(r.texcoordBuffer=t.createVertexBuffer(r.texcoordArray,D6.members,!1,!0)),r.colorArray&&(r.colorBuffer=t.createVertexBuffer(r.colorArray,(r.colorArray.bytesPerElement===12?k6:R6).members,!1,!0)),r.featureArray&&(r.pbrBuffer=t.createVertexBuffer(r.featureArray,z6.members,!0)),r.segments=ua.simpleSegment(0,0,r.vertexArray.length,r.indexArray.length);const c=r.material;c.pbrMetallicRoughness.baseColorTexture&&Sx(c.pbrMetallicRoughness.baseColorTexture,t),c.pbrMetallicRoughness.metallicRoughnessTexture&&Sx(c.pbrMetallicRoughness.metallicRoughnessTexture,t),c.normalTexture&&Sx(c.normalTexture,t),c.occlusionTexture&&Sx(c.occlusionTexture,t,i),c.emissionTexture&&Sx(c.emissionTexture,t)}function cE(r,t,i){if(r.meshes)for(const c of r.meshes)B6(c,t,i);if(r.children)for(const c of r.children)cE(c,t,i)}function mw(r){if(r.meshes)for(const t of r.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(r.children)for(const t of r.children)mw(t)}function uE(r){if(r.meshes)for(const i of r.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((t=i.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(r.children)for(const i of r.children)uE(i)}class F6{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class V6{constructor(){this.tasks={},this.taskQueue=[],fn(["process"],this),this.invoker=new F6(this.process),this.nextId=0}add(t,i){const c=this.nextId++,m=function({type:g,isSymbolTile:b,zoom:C}){return C=C||0,g==="message"?0:g!=="maybePrepare"||b?g!=="parseTile"||b?g==="parseTile"&&b?300-C:g==="maybePrepare"&&b?400-C:500:200-C:100-C}(i);if(m===0){Zr();try{t()}finally{}return null}return this.tasks[c]={fn:t,metadata:i,priority:m,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Zr();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let m=0;m<this.taskQueue.length;m++){const g=this.tasks[this.taskQueue[m]];g.priority<i&&(i=g.priority,t=m)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class d3{constructor(t,i,c){this.target=t,this.parent=i,this.mapId=c,this.callbacks={},this.cancelCallbacks={},fn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new V6}send(t,i,c,m,g=!1,b){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=b,this.callbacks[C]=c);const k=new Set;return this.target.postMessage({id:C,type:t,hasCallback:!!c,targetMapId:m,mustQueue:g,sourceMapId:this.mapId,data:Ze(i,k)},k),{cancel:()=>{c&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(t){const i=t.data,c=i.id;if(c&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const m=this.cancelCallbacks[c];delete this.cancelCallbacks[c],m&&m.cancel()}else if(i.mustQueue||Zr()){const m=this.callbacks[c],g=this.scheduler.add(()=>this.processTask(c,i),m&&m.metadata||{type:"message"});g&&(this.cancelCallbacks[c]=g)}else this.processTask(c,i)}processTask(t,i){if(delete this.cancelCallbacks[t],i.type==="<response>"){const c=this.callbacks[t];delete this.callbacks[t],c&&(i.error?c(Je(i.error)):c(null,Je(i.data)))}else{const c=new Set,m=i.hasCallback?(b,C)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:b?Ze(b):null,data:Ze(C,c)},c)}:b=>{},g=Je(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,g,m);else if(this.parent.getWorkerSource){const b=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,b[0],g.source,g.scope)[b[1]](g,m)}else m(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class fv{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=wi();const c=this.workerPool.acquire(this.id);for(let m=0;m<c.length;m++){const g=new fv.Actor(c[m],i,this.id);g.name=`Worker ${m}`,this.actors.push(g)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,i,c){Tr(this.actors,(m,g)=>{m.send(t,i,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}fv.Actor=d3;var Tx={workerUrl:"",workerClass:null,workerParams:void 0};function U6(){return Tx.workerClass!=null?new Tx.workerClass:new self.Worker(Tx.workerUrl,Tx.workerParams)}const hE="mapboxgl_preloaded_worker_pool";class Ex{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ex.workerCount;)this.workers.push(new U6);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[hE]}numActive(){return Object.keys(this.active).length}}let Ix;function gw(){return Ix||(Ix=new Ex),Ix}Ex.workerCount=2;let _w,dE,Ip,mv,pE,gv=null;function p3(){return Zr()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:dE||G.DRACO_URL}function f3(){if(Zr()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(mv)return mv;const r=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return mv=WebAssembly.validate(r)?G.MESHOPT_SIMD_URL:G.MESHOPT_URL,mv}const yw={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$6={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Cx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function m3(r,t,i){const c=i.json.bufferViews.length,m=i.buffers.length;t.bufferView=c,i.json.bufferViews[c]={buffer:m,byteLength:r.byteLength},i.buffers[m]=r}const fE="KHR_draco_mesh_compression";function G6(r,t){const i=r.extensions&&r.extensions[fE];if(!i)return;const c=new Ip.Decoder,m=v3(t,i.bufferView),g=new Ip.Mesh;if(!c.DecodeArrayToMesh(m,m.byteLength,g))throw new Error("Failed to decode Draco mesh");const b=t.json.accessors[r.indices],C=yw[b.componentType],k=b.count*C.BYTES_PER_ELEMENT,R=Ip._malloc(k);C===Uint16Array?c.GetTrianglesUInt16Array(g,k,R):c.GetTrianglesUInt32Array(g,k,R),m3(Ip.memory.buffer.slice(R,R+k),b,t),Ip._free(R);for(const z of Object.keys(i.attributes)){const V=c.GetAttributeByUniqueId(g,i.attributes[z]),q=t.json.accessors[r.attributes[z]],Q=$6[q.componentType],te=q.count*Cx[q.type]*yw[q.componentType].BYTES_PER_ELEMENT,oe=Ip._malloc(te);c.GetAttributeDataArrayForAllPoints(g,V,Ip[Q],te,oe),m3(Ip.memory.buffer.slice(oe,oe+te),q,t),Ip._free(oe)}c.destroy(),g.destroy(),delete r.extensions[fE]}const vw="EXT_meshopt_compression";function q6(r,t){if(!r.extensions||!r.extensions[vw])return;const i=r.extensions[vw],c=new Uint8Array(t.buffers[i.buffer],i.byteOffset||0,i.byteLength||0),m=new Uint8Array(i.count*i.byteStride);pE.decodeGltfBuffer(m,i.count,i.byteStride,c,i.mode,i.filter),r.buffer=t.buffers.length,r.byteOffset=0,t.buffers[r.buffer]=m.buffer,delete r.extensions[vw]}const g3=1179937895,_3=new TextDecoder("utf8");function y3(r,t){return new URL(r,t).href}function W6(r,t,i,c){return fetch(y3(r.uri,c)).then(m=>m.arrayBuffer()).then(m=>{t.buffers[i]=m})}function v3(r,t){const i=r.json.bufferViews[t];return new Uint8Array(r.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function H6(r,t,i,c){if(r.uri){const m=y3(r.uri,c);return fetch(m).then(g=>g.blob()).then(g=>createImageBitmap(g)).then(g=>{t.images[i]=g})}if(r.bufferView!==void 0){const m=v3(t,r.bufferView),g=new Blob([m],{type:r.mimeType});return createImageBitmap(g).then(b=>{t.images[i]=b})}}function x3(r,t=0,i){const c={json:null,images:[],buffers:[]};if(new Uint32Array(r,t,1)[0]===g3){const z=new Uint32Array(r,t);let V=2;const q=(z[V++]>>2)-3,Q=z[V++]>>2;if(V++,c.json=JSON.parse(_3.decode(z.subarray(V,V+Q))),V+=Q,V<q){const te=z[V++];V++;const oe=t+(V<<2);c.buffers[0]=r.slice(oe,oe+te)}}else c.json=JSON.parse(_3.decode(new Uint8Array(r,t)));const{buffers:m,images:g,meshes:b,extensionsUsed:C,bufferViews:k}=c.json;let R=Promise.resolve();if(m){const z=[];for(let V=0;V<m.length;V++){const q=m[V];q.uri?z.push(W6(q,c,V,i)):c.buffers[V]||(c.buffers[V]=null)}R=Promise.all(z)}return R.then(()=>{const z=[],V=C&&C.includes(fE),q=C&&C.includes(vw);if(V&&z.push(function(){if(!Ip)return _w||(_w=function(Q){let te,oe=null;function pe(){te=new Uint8Array(oe.buffer)}function _e(){throw new Error("Unexpected Draco error.")}const ze={a:{a:_e,d:function(Ue,Ve,nt){return te.copyWithin(Ue,Ve,Ve+nt)},c:function(Ue){const Ve=te.length,nt=Math.max(Ue>>>0,Math.ceil(1.2*Ve)),Qe=Math.ceil((nt-Ve)/65536);try{return oe.grow(Qe),pe(),!0}catch{return!1}},b:_e}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Q,ze):Q.then(Ue=>Ue.arrayBuffer()).then(Ue=>WebAssembly.instantiate(Ue,ze))).then(Ue=>{const{Rb:Ve,Qb:nt,P:Qe,T:gt,X:At,Ja:Bt,La:Yt,Qa:Ft,Va:_r,Wa:Pr,eb:dr,jb:Er,f:lr,e:Sr,yb:Yr,zb:kr,Ab:bn,Bb:dn,Db:jr,Gb:ti}=Ue.instance.exports;oe=Sr;const zn=(()=>{let yn=0,Br=0,Wn=0,Wi=0;return ci=>{Wn&&(Ve(Wi),Ve(yn),Br+=Wn,Wn=yn=0),yn||(Br+=128,yn=nt(Br));const Hi=ci.length+7&-8;let Ei=yn;Hi>=Br&&(Wn=Hi,Ei=Wi=nt(Hi));for(let ao=0;ao<ci.length;ao++)te[Ei+ao]=ci[ao];return Ei}})();return pe(),lr(),{memory:Sr,_free:Ve,_malloc:nt,Mesh:class{constructor(){this.ptr=Qe()}destroy(){gt(this.ptr)}},Decoder:class{constructor(){this.ptr=Bt()}destroy(){Er(this.ptr)}DecodeArrayToMesh(yn,Br,Wn){const Wi=zn(yn),ci=Yt(this.ptr,Wi,Br,Wn.ptr);return!!At(ci)}GetAttributeByUniqueId(yn,Br){return{ptr:Ft(this.ptr,yn.ptr,Br)}}GetTrianglesUInt16Array(yn,Br,Wn){_r(this.ptr,yn.ptr,Br,Wn)}GetTrianglesUInt32Array(yn,Br,Wn){Pr(this.ptr,yn.ptr,Br,Wn)}GetAttributeDataArrayForAllPoints(yn,Br,Wn,Wi,ci){dr(this.ptr,yn.ptr,Br.ptr,Wn,Wi,ci)}},DT_INT8:Yr(),DT_UINT8:kr(),DT_INT16:bn(),DT_UINT16:dn(),DT_UINT32:jr(),DT_FLOAT32:ti()}})}(fetch(p3())),_w.then(Q=>{Ip=Q,_w=void 0}))}()),q&&z.push(function(){if(pE)return;const Q=function(te){let oe;const pe=WebAssembly.instantiateStreaming(te,{}).then(Ue=>{oe=Ue.instance,oe.exports.__wasm_call_ctors()}),_e={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ze={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:pe,supported:!0,decodeGltfBuffer(Ue,Ve,nt,Qe,gt,At){(function(Bt,Yt,Ft,_r,Pr,dr,Er){const lr=Bt.exports.sbrk,Sr=_r+3&-4,Yr=lr(Sr*Pr),kr=lr(dr.length),bn=new Uint8Array(Bt.exports.memory.buffer);bn.set(dr,kr);const dn=Yt(Yr,_r,Pr,kr,dr.length);if(dn===0&&Er&&Er(Yr,Sr,Pr),Ft.set(bn.subarray(Yr,Yr+_r*Pr)),lr(Yr-lr(0)),dn!==0)throw new Error(`Malformed buffer data: ${dn}`)})(oe,oe.exports[ze[gt]],Ue,Ve,nt,Qe,oe.exports[_e[At]])}}}(fetch(f3()));return Q.ready.then(()=>{pE=Q})}()),g)for(let Q=0;Q<g.length;Q++)z.push(H6(g[Q],c,Q,i));return(z.length?Promise.all(z):Promise.resolve()).then(()=>{if(V&&b)for(const{primitives:Q}of b)for(const te of Q)G6(te,c);if(q&&b&&k)for(const Q of k)q6(Q,c);return c})})}class b3{constructor(t,i,c){if(this.triangleCount=i.length/3,this.min=new Ge(0,0),this.max=new Ge(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||c===0)return;const m=t.map(z=>z.x),g=t.map(z=>z.y);this.min=new Ge(Math.min(...m),Math.min(...g)),this.max=new Ge(Math.max(...m),Math.max(...g));const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const C=Math.max(b.x,b.y)/c;this.cellsX=Math.max(1,Math.ceil(b.x/C)),this.cellsY=Math.max(1,Math.ceil(b.y/C)),this.xScale=1/C,this.yScale=1/C;const k=[];for(let z=0;z<this.triangleCount;z++){const V=t[i[3*z+0]].sub(this.min),q=t[i[3*z+1]].sub(this.min),Q=t[i[3*z+2]].sub(this.min),te=Eg(Math.floor(Math.min(V.x,q.x,Q.x)),this.xScale,this.cellsX),oe=Eg(Math.floor(Math.max(V.x,q.x,Q.x)),this.xScale,this.cellsX),pe=Eg(Math.floor(Math.min(V.y,q.y,Q.y)),this.yScale,this.cellsY),_e=Eg(Math.floor(Math.max(V.y,q.y,Q.y)),this.yScale,this.cellsY),ze=new Ge(0,0),Ue=new Ge(0,0),Ve=new Ge(0,0),nt=new Ge(0,0);for(let Qe=pe;Qe<=_e;++Qe){ze.y=Ue.y=Qe*C,Ve.y=nt.y=(Qe+1)*C;for(let gt=te;gt<=oe;++gt)ze.x=Ve.x=gt*C,Ue.x=nt.x=(gt+1)*C,(eg(V,q,Q,ze,Ue,nt)||eg(V,q,Q,ze,nt,Ve))&&k.push({cellIdx:Qe*this.cellsX+gt,triIdx:z})}}if(k.length===0)return;k.sort((z,V)=>z.cellIdx-V.cellIdx||z.triIdx-V.triIdx);let R=0;for(;R<k.length;){const z=k[R].cellIdx,V={start:this.payload.length,len:0};for(;R<k.length&&k[R].cellIdx===z;)++V.len,this.payload.push(k[R++].triIdx);this.cells[z]=V}}query(t,i,c){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>i.x||t.y>this.max.y||this.min.y>i.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let k=0;k<this.lookup.length;k++)this.lookup[k]=0;const m=Eg(t.x-this.min.x,this.xScale,this.cellsX),g=Eg(i.x-this.min.x,this.xScale,this.cellsX),b=Eg(t.y-this.min.y,this.yScale,this.cellsY),C=Eg(i.y-this.min.y,this.yScale,this.cellsY);for(let k=b;k<=C;k++)for(let R=m;R<=g;R++){const z=this.cells[k*this.cellsX+R];if(z)for(let V=0;V<z.len;V++){const q=this.payload[z.start+V],Q=Math.floor(q/8),te=1<<q%8;if(!(this.lookup[Q]&te)&&(this.lookup[Q]|=te,c.push(q),c.length===this.triangleCount))return}}}}function Eg(r,t,i){return Math.max(0,Math.min(i-1,Math.floor(r*t)))}function K_(r,t){const i=r.json.bufferViews[t.bufferView],c=yw[t.componentType];return new c(r.buffers[i.buffer],(t.byteOffset||0)+(i.byteOffset||0),t.count*(i.byteStride&&i.byteStride!==Cx[t.type]*c.BYTES_PER_ELEMENT?i.byteStride/c.BYTES_PER_ELEMENT:Cx[t.type]))}function mE(r,t,i,c){const m=yw[t.componentType],g=function(z){switch(z){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),b=r.json.bufferViews[t.bufferView],C=b.byteStride?b.byteStride/m.BYTES_PER_ELEMENT:Cx[t.type],k=i.float32,R=k.length/i.capacity;for(let z=0,V=0;z<t.count*C;z+=C,V+=R)for(let q=0;q<R;q++)k[V+q]=c[z+q]*g;i._trim()}function Z6(r,t,i){const c=r.indices,m=r.attributes,g={};g.indexArray=new Wa;const b=t.json.accessors[c],C=b.count/3;g.indexArray.reserve(C);const k=K_(t,b);for(let q=0;q<C;q++)g.indexArray.emplaceBack(k[3*q],k[3*q+1],k[3*q+2]);g.indexArray._trim(),g.vertexArray=new kh;const R=t.json.accessors[m.POSITION];g.vertexArray.reserve(R.count);const z=K_(t,R);for(let q=0;q<R.count;q++)g.vertexArray.emplaceBack(z[3*q],z[3*q+1],z[3*q+2]);if(g.vertexArray._trim(),g.aabb=new Ko(R.min,R.max),g.centroid=function(q,Q){const te=[0,0,0],oe=q.length;if(oe>0){for(let pe=0;pe<oe;pe++){const _e=3*q[pe];te[0]+=Q[_e],te[1]+=Q[_e+1],te[2]+=Q[_e+2]}te[0]/=oe,te[1]/=oe,te[2]/=oe}return te}(k,z),m.COLOR_0!==void 0){const q=t.json.accessors[m.COLOR_0],Q=Cx[q.type],te=K_(t,q);g.colorArray=Q===3?new kh:new Ja,g.colorArray.resize(q.count),mE(t,q,g.colorArray,te)}if(m.NORMAL!==void 0){g.normalArray=new kh;const q=t.json.accessors[m.NORMAL];g.normalArray.resize(q.count);const Q=K_(t,q);mE(t,q,g.normalArray,Q)}if(m.TEXCOORD_0!==void 0&&i.length>0){g.texcoordArray=new Wf;const q=t.json.accessors[m.TEXCOORD_0];g.texcoordArray.resize(q.count);const Q=K_(t,q);mE(t,q,g.texcoordArray,Q)}if(m._FEATURE_ID_RGBA4444!==void 0){const q=t.json.accessors[m._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=K_(t,q))}m._FEATURE_RGBA4444!==void 0&&(g.featureData=new Uint32Array(K_(t,t.json.accessors[m._FEATURE_RGBA4444]).buffer));const V=r.material;return g.material=function(q,Q){const{emissiveFactor:te=[0,0,0],alphaMode:oe="OPAQUE",alphaCutoff:pe=.5,normalTexture:_e,occlusionTexture:ze,emissiveTexture:Ue,doubleSided:Ve}=q,{baseColorFactor:nt=[1,1,1,1],metallicFactor:Qe=1,roughnessFactor:gt=1,baseColorTexture:At,metallicRoughnessTexture:Bt}=q.pbrMetallicRoughness||{},Yt=ze?Q[ze.index]:void 0;if(ze&&ze.extensions&&ze.extensions.KHR_texture_transform&&Yt){const Ft=ze.extensions.KHR_texture_transform;Yt.offsetScale=[Ft.offset[0],Ft.offset[1],Ft.scale[0],Ft.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new po(...nt),metallicFactor:Qe,roughnessFactor:gt,baseColorTexture:At?Q[At.index]:void 0,metallicRoughnessTexture:Bt?Q[Bt.index]:void 0},doubleSided:Ve,emissiveFactor:te,alphaMode:oe,alphaCutoff:pe,normalTexture:_e?Q[_e.index]:void 0,occlusionTexture:Yt,emissionTexture:Ue?Q[Ue.index]:void 0,defined:q.defined===void 0}}(V!==void 0?t.json.materials[V]:{defined:!1},i),g}function w3(r,t,i){const{matrix:c,rotation:m,translation:g,scale:b,mesh:C,extras:k,children:R}=r,z={};if(z.matrix=c||s.a6.fromRotationTranslationScale([],m||[0,0,0,1],g||[0,0,0],b||[1,1,1]),C!==void 0){z.meshes=i[C];const V=z.anchor=[0,0];for(const q of z.meshes){const{min:Q,max:te}=q.aabb;V[0]+=Q[0]+te[0],V[1]+=Q[1]+te[1]}V[0]=Math.floor(V[0]/z.meshes.length/2),V[1]=Math.floor(V[1]/z.meshes.length/2)}if(k&&(k.id&&(z.id=k.id),k.lights&&(z.lights=function(V){if(!V.length)return[];const q=function(_e){const ze=atob(_e),Ue=new Uint8Array(ze.length);for(let Ve=0;Ve<ze.length;Ve++)Ue[Ve]=ze.codePointAt(Ve);return Ue}(V),Q=[],te=q.length/24,oe=new Uint16Array(q.buffer),pe=new Float32Array(q.buffer);for(let _e=0;_e<te;_e++){const ze=oe[2*_e*6]/30,Ue=oe[2*_e*6+1]/30,Ve=oe[2*_e*6+10]/100,nt=pe[6*_e+1],Qe=pe[6*_e+2],gt=pe[6*_e+3],At=pe[6*_e+4],Bt=gt-nt,Yt=At-Qe,Ft=Math.hypot(Bt,Yt);Q.push({pos:[nt+.5*Bt,Qe+.5*Yt,Ue],normal:[Yt/Ft,-Bt/Ft,0],width:Ft,height:ze,depth:Ve,points:[nt,Qe,gt,At]})}return Q}(k.lights))),R){const V=[];for(const q of R)V.push(w3(t.json.nodes[q],t,i));z.children=V}return z}function X6(r){if(r.vertices.length===0||r.indices.length===0)return null;const[t,i]=[r.vertices[0].clone(),r.vertices[0].clone()];for(let b=1;b<r.vertices.length;++b){const C=r.vertices[b];t.x=Math.min(t.x,C.x),t.y=Math.min(t.y,C.y),i.x=Math.max(i.x,C.x),i.y=Math.max(i.y,C.y)}const c=Math.ceil(Math.max(i.x-t.x,i.y-t.y)/256),m=Math.max(8,c),g=new b3(r.vertices,r.indices,m);return{vertices:r.vertices,indices:r.indices,grid:g,min:t,max:i}}function Y6(r){if(!r.extras||!r.extras.ground)return null;const t=r.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const i=t[0];if(!i||!Array.isArray(i)||i.length===0)return null;const c=[];for(const b of i){if(!Array.isArray(b)||b.length!==2)continue;const C=b[0],k=b[1];typeof C=="number"&&typeof k=="number"&&c.push(new Ge(C,k))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let m=0;for(let b=0;b<c.length;b++){const C=c[b],k=c[(b+1)%c.length],R=c[(b+2)%c.length];m+=(C.x-k.x)*(R.y-k.y)-(R.x-k.x)*(C.y-k.y)}m>0&&c.reverse();const g=ev(c.flatMap(b=>[b.x,b.y]),[]);return g.length===0?null:{vertices:c,indices:g}}function K6(r){const t=[],i=[];let c=0;for(const m of r){c=t.length;const g=m.vertexArray.float32,b=m.indexArray.uint16;for(let C=0;C<m.vertexArray.length;C++)t.push(new Ge(g[3*C+0],g[3*C+1]));for(let C=0;C<3*m.indexArray.length;C++)i.push(b[C]+c)}if(i.length%3!=0)return null;for(let m=0;m<i.length;m+=3){const g=t[i[m+0]],b=t[i[m+1]],C=t[i[m+2]];(g.x-b.x)*(C.y-b.y)-(C.x-b.x)*(g.y-b.y)>0&&([i[m+1],i[m+2]]=[i[m+2],i[m+1]])}return{vertices:t,indices:i}}function S3(r){const t=function(k,R){const z=[],V=WebGL2RenderingContext;if(k.json.textures)for(const q of k.json.textures){const Q={magFilter:V.LINEAR,minFilter:V.NEAREST,wrapS:V.REPEAT,wrapT:V.REPEAT};q.sampler!==void 0&&Object.assign(Q,k.json.samplers[q.sampler]),z.push({image:R[q.source],sampler:Q,uploaded:!1})}return z}(r,r.images),i=function(k,R){const z=[];for(const V of k.json.meshes){const q=[];for(const Q of V.primitives)q.push(Z6(Q,k,R));z.push(q)}return z}(r,t),{scenes:c,scene:m,nodes:g}=r.json,b=c?c[m||0].nodes:g,C=[];for(const k of b)C.push(w3(g[k],r,i));return function(k,R,z){const V={},q=new Set;for(let Q=0;Q<k.length;Q++){const te=z[R[Q]];if(!te.extras)continue;const oe=te.extras["mapbox:footprint:version"],pe=te.extras["mapbox:footprint:id"];(oe||pe)&&q.add(Q),oe==="1.0.0"&&pe&&(V[pe]=Q)}for(let Q=0;Q<k.length;Q++){if(q.has(Q))continue;const te=k[Q],oe=z[R[Q]];if(!oe.extras)continue;let pe=null;te.id in V&&(pe=K6(k[V[te.id]].meshes)),pe||(pe=Y6(oe)),pe&&(te.footprint=X6(pe))}if(q.size>0){const Q=Array.from(q.values()).sort((te,oe)=>te-oe);for(let te=Q.length-1;te>=0;te--)k.splice(Q[te],1)}}(C,b,r.json.nodes),C}function J6(r){r.heightmap=new Float32Array(4096),r.heightmap.fill(-1);const t=r.vertexArray.float32,i=r.aabb.min[0]-1,c=r.aabb.min[1]-1,m=Y_/(r.aabb.max[0]-i+2),g=Y_/(r.aabb.max[1]-c+2);for(let b=0;b<t.length;b+=3){const C=t[b+2],k=(t[b+0]-i)*m|0,R=(t[b+1]-c)*g|0;C>r.heightmap[R*Y_+k]&&(r.heightmap[R*Y_+k]=C)}}function Q6(r,t){const i={};i.indexArray=new Wa,i.indexArray.reserve(4*r.length),i.vertexArray=new kh,i.vertexArray.reserve(10*r.length),i.colorArray=new Ja,i.vertexArray.reserve(10*r.length);let c=0;for(const b of r){const C=Math.min(10,Math.max(4,1.3*b.height))*t,k=[-b.normal[1],b.normal[0],0],R=Math.min(.29,.1*b.width/b.depth),z=b.width-2*b.depth*t*(R+.01),V=s.N.scaleAndAdd([],b.pos,k,z/2),q=s.N.scaleAndAdd([],b.pos,k,-z/2),Q=[V[0],V[1],V[2]+b.height],te=[q[0],q[1],q[2]+b.height],oe=s.N.scaleAndAdd([],b.normal,k,R);s.N.scale(oe,oe,C);const pe=s.N.scaleAndAdd([],b.normal,k,-R);s.N.scale(pe,pe,C),s.N.add(oe,V,oe),s.N.add(pe,q,pe),V[2]+=.1,q[2]+=.1,i.vertexArray.emplaceBack(oe[0],oe[1],oe[2]),i.vertexArray.emplaceBack(pe[0],pe[1],pe[2]),i.vertexArray.emplaceBack(V[0],V[1],V[2]),i.vertexArray.emplaceBack(q[0],q[1],q[2]),i.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),i.vertexArray.emplaceBack(te[0],te[1],te[2]),i.vertexArray.emplaceBack(V[0],V[1],V[2]),i.vertexArray.emplaceBack(q[0],q[1],q[2]),i.vertexArray.emplaceBack(oe[0],oe[1],oe[2]),i.vertexArray.emplaceBack(pe[0],pe[1],pe[2]);const _e=z/C/2;i.colorArray.emplaceBack(-_e-R,-1,_e,.8),i.colorArray.emplaceBack(_e+R,-1,_e,.8),i.colorArray.emplaceBack(-_e,0,_e,1.3),i.colorArray.emplaceBack(_e,0,_e,1.3),i.colorArray.emplaceBack(_e+R,-.8,_e,.7),i.colorArray.emplaceBack(_e+R,-.8,_e,.7),i.colorArray.emplaceBack(0,0,_e,1.3),i.colorArray.emplaceBack(0,0,_e,1.3),i.colorArray.emplaceBack(_e+R,-1.2,_e,.8),i.colorArray.emplaceBack(_e+R,-1.2,_e,.8),i.indexArray.emplaceBack(6+c,4+c,8+c),i.indexArray.emplaceBack(7+c,9+c,5+c),i.indexArray.emplaceBack(0+c,1+c,2+c),i.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const m={defined:!0,emissiveFactor:[0,0,0]},g={};return g.baseColorFactor=po.white,m.pbrMetallicRoughness=g,i.material=m,i.aabb=new Ko([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}re(b3,"TriangleGridIndex");class T3{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const c=t[i];this._stringToNumber[c]=i,this._numberToString[i]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const eV=["tile","layer","source","sourceLayer","state"];class E3{constructor(t,i,c,m,g){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=c,this._y=m,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of eV)this[i]!==void 0&&(t[i]=this[i]);return t}}class I3{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new W(Jr,16,0),this.featureIndexArray=new qm,this.promoteId=i,this.is3DTile=!1}insert(t,i,c,m,g,b=0,C=0){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,m,g,b);const R=this.grid;for(let z=0;z<i.length;z++){const V=i[z],q=[1/0,1/0,-1/0,-1/0];for(let Q=0;Q<V.length;Q++){const te=V[Q];q[0]=Math.min(q[0],te.x),q[1]=Math.min(q[1],te.y),q[2]=Math.max(q[2],te.x),q[3]=Math.max(q[3],te.y)}C!==0&&(q[0]-=C,q[1]-=C,q[2]+=C,q[3]+=C),q[0]<Jr&&q[1]<Jr&&q[2]>=0&&q[3]>=0&&R.insert(k,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new UT(new lv(this.rawTileData)).layers,this.sourceLayerCoder=new T3(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,c,m){this.loadVTLayers();const g=t.params||{},b=Pa(g.filter),C=t.tileResult,k=t.transform,R=C.bufferedTilespaceBounds,z=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,(te,oe,pe,_e)=>L0(C.bufferedTilespaceGeometry,te,oe,pe,_e));z.sort(tV);let V=null;k.elevation&&z.length>0&&(V=nv.create(k.elevation,this.tileID));const q={};let Q;for(let te=0;te<z.length;te++){const oe=z[te];if(oe===Q)continue;Q=oe;const pe=this.featureIndexArray.get(oe);let _e=null;if(this.is3DTile){const ze=this.bucketLayerIDs[0][0],Ue=i[ze];if(Ue.type!=="model")continue;const{queryFeature:Ve,intersectionZ:nt}=Ue.queryIntersectsMatchingFeature(C,pe.featureIndex,b,k);Ve&&this.appendToResult(q,ze,pe.featureIndex,Ve,nt)}else this.loadMatchingFeature(q,pe,b,g.layers,g.availableImages,i,c,m,(ze,Ue,Ve,nt=0)=>(_e||(_e=ss(ze,this.tileID.canonical,t.tileTransform)),Ue.queryIntersectsFeature(C,ze,Ve,_e,this.z,t.transform,t.pixelPosMatrix,V,nt)))}return q}loadMatchingFeature(t,i,c,m,g,b,C,k,R){const{featureIndex:z,bucketIndex:V,sourceLayerIndex:q,layoutVertexArrayOffset:Q}=i,te=this.bucketLayerIDs[V];if(m&&!function(ze,Ue){for(let Ve=0;Ve<ze.length;Ve++)if(Ue.indexOf(ze[Ve])>=0)return!0;return!1}(m,te))return;const oe=this.sourceLayerCoder.decode(q),pe=this.vtLayers[oe].feature(z);if(c.needGeometry){const ze=ls(pe,!0);if(!c.filter(new $n(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!c.filter(new $n(this.tileID.overscaledZ),pe))return;const _e=this.getId(pe,oe);for(let ze=0;ze<te.length;ze++){const Ue=te[ze];if(m&&m.indexOf(Ue)<0)continue;const Ve=b[Ue];if(!Ve)continue;let nt={};_e!==void 0&&k&&(nt=k.getState(Ve.sourceLayer||"_geojsonTileLayer",_e));const Qe=!R||R(pe,Ve,nt,Q);if(!Qe)continue;const gt=new E3(pe,this.z,this.x,this.y,_e),At=ln({},C[Ue]);At.paint=C3(At.paint,Ve.paint,pe,nt,g),At.layout=C3(At.layout,Ve.layout,pe,nt,g),gt.layer=At,this.appendToResult(t,Ue,z,gt,Qe)}}appendToResult(t,i,c,m,g){let b=t[i];b===void 0&&(b=t[i]=[]),b.push({featureIndex:c,feature:m,intersectionZ:g})}lookupSymbolFeatures(t,i,c,m,g,b,C,k){const R={};this.loadVTLayers();const z=Pa(g);for(const V of t)this.loadMatchingFeature(R,{bucketIndex:c,sourceLayerIndex:m,featureIndex:V,layoutVertexArrayOffset:0},z,b,C,k,i);return R}loadFeature(t){const{featureIndex:i,sourceLayerIndex:c}=t;this.loadVTLayers();const m=this.sourceLayerCoder.decode(c),g=this.vtFeatures[m];if(g[i])return g[i];const b=this.vtLayers[m].feature(i);return g[i]=b,b}hasLayer(t){for(const i of this.bucketLayerIDs)for(const c of i)if(t===c)return!0;return!1}getId(t,i){let c=t.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];m!=null&&(c=t.properties[m]),typeof c=="boolean"&&(c=Number(c))}return c}}function C3(r,t,i,c,m){return Pt(r,(g,b)=>{const C=t instanceof Ka?t.get(b):null;return C&&C.evaluate?C.evaluate(i,c,m):C})}function tV(r,t){return t-r}re(I3,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const gE=new Float32Array(262144),J_=new Uint8Array(262144);function A3(r){let t=0;if(r.meshes)for(const i of r.meshes)t=Math.max(t,i.aabb.max[2]);if(r.children)for(const i of r.children)t=Math.max(t,A3(i));return t}function P3(r,t,i){if(r.meshes)for(const c of r.meshes)c.aabb.min[0]!==1/0&&i.insert(t,c.aabb.min[0],c.aabb.min[1],c.aabb.max[0],c.aabb.max[1]);if(r.children)for(const c of r.children)P3(c,t,i)}const M3=["","wall","door","roof","window","lamp","logo"];class k3{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:A3(t)}}}getLocalBounds(){if(!this.node.meshes)return new Ko([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const i=new Ko([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==t&&i.encapsulate(c.aabb),t++;this.aabb=i}return this.aabb}}class xw{constructor(t,i,c,m,g,b){this.id=i,this.modelTraits|=pv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=pv.HasMapboxMeshFeatures),m&&(this.modelTraits|=pv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const C of t)this.nodesInfo.push(new k3(C)),P3(C,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0)}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const c of i){const m=c.node;this.uploaded?this.updatePbrBuffer(m):cE(m,t,!0)}for(const c of i)mw(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let i=!1;if(!t.meshes)return i;for(const c of t.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),i=!0);return i}needsReEvaluation(t,i,c){const m=t.transform.projectionOptions,g=t.style.getBrightness(),b=this.brightness!==g;return!!(!this.uploaded||this.dirty||m.name!==this.projection.name||Ax(c.paint.get("model-color").value,b)||Ax(c.paint.get("model-color-mix-intensity").value,b)||Ax(c.paint.get("model-roughness").value,b)||Ax(c.paint.get("model-emissive-strength").value,b)||Ax(c.paint.get("model-height-based-emissive-strength-multiplier").value,b))&&(this.projection=m,this.brightness=g,!0)}evaluateScale(t,i){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const c=this.getNodesInfo(),m=this.id.canonical;for(const g of c){const b=g.feature;g.evaluatedScale=i.paint.get("model-scale").evaluate(b,{},m)}}evaluate(t){const i=this.getNodesInfo();for(const c of i){if(!c.node.meshes)continue;const m=c.feature,g=c.node.meshes&&c.node.meshes[0].featureData,b=c.evaluatedColor[2],C=c.evaluatedRMEA[2],k=this.id.canonical;if(c.hasTranslucentParts=!1,g){for(let R=0;R<M3.length;R++){const z=M3[R];z.length&&(m.properties.part=z);const V=t.paint.get("model-color").evaluate(m,{},k),q=t.paint.get("model-color-mix-intensity").evaluate(m,{},k);c.evaluatedColor[R]=[V.r,V.g,V.b,q],c.evaluatedRMEA[R][0]=t.paint.get("model-roughness").evaluate(m,{},k),c.evaluatedRMEA[R][2]=t.paint.get("model-emissive-strength").evaluate(m,{},k),c.evaluatedRMEA[R][3]=V.a,c.emissionHeightBasedParams[R]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,{},k),!c.hasTranslucentParts&&V.a<1&&(c.hasTranslucentParts=!0)}delete m.properties.part,nV(c,b!==c.evaluatedColor[2]||C!==c.evaluatedRMEA[2],this.modelTraits)}else c.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(m,{},k);c.evaluatedScale=t.paint.get("model-scale").evaluate(m,{},k),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,i,c,m){const g=t.findDEMTileFor(c);if(g&&(g.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const b=nv.create(t,c,g);if(!b)return;this.modelTraits&pv.HasMapboxMeshFeatures&&this.updateDEM(t,b,c,m);for(const C of this.getNodesInfo()){const k=C.node;if(!k.footprint||!k.footprint.vertices||!k.footprint.vertices.length)continue;const R=k.footprint.vertices;let z=b.getElevationAt(R[0].x,R[0].y,!0,!0);for(let V=1;V<R.length;V++)z=Math.min(z,b.getElevationAt(R[V].x,R[V].y,!0,!0));k.elevation=z}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=i}}updateDEM(t,i,c,m){let g=i._dem._modifiedForSources[m];if(g===void 0&&(i._dem._modifiedForSources[m]=[],g=i._dem._modifiedForSources[m]),g.includes(c.canonical))return;const b=i._dem.dim;g.push(c.canonical);let C=!1;for(const k of this.getNodesInfo()){const R=k.node;if(!R.footprint||!R.footprint.grid)continue;const z=R.footprint.grid,V=i.tileCoordToPixel(z.min.x,z.min.y),q=i.tileCoordToPixel(z.max.x,z.max.y),Q=Math.min(Math.min(b-q.y,V.x),Math.min(V.y,b-q.x));if(Q<0)continue;const te=Ht(Q,2,5);let oe=Math.max(0,V.x-te),pe=Math.max(0,V.y-te),_e=Math.min(q.x+te,b-1),ze=Math.min(q.y+te,b-1);for(let Qe=pe;Qe<=ze;++Qe)for(let gt=oe;gt<=_e;++gt)J_[Qe*b+gt]=255;let Ue=0,Ve=0;for(let Qe=0;Qe<z.cellsY;++Qe)for(let gt=0;gt<z.cellsX;++gt){if(!z.cells[Qe*z.cellsX+gt])continue;const At=i.tileCoordToPixel(z.min.x+gt/z.xScale,z.min.y+Qe/z.yScale),Bt=i.tileCoordToPixel(z.min.x+(gt+1)/z.xScale,z.min.y+(Qe+1)/z.yScale);for(let Yt=At.y;Yt<=Math.min(Bt.y+1,b-1);++Yt)for(let Ft=At.x;Ft<=Math.min(Bt.x+1,b-1);++Ft)J_[Yt*b+Ft]===255&&(J_[Yt*b+Ft]=0,Ue+=i.getElevationAtPixel(Ft,Yt),Ve++)}const nt=Ue/Ve;oe=Math.max(1,V.x-te),pe=Math.max(1,V.y-te),_e=Math.min(q.x+te,b-2),ze=Math.min(q.y+te,b-2),C=!0;for(let Qe=pe;Qe<=ze;++Qe)for(let gt=oe;gt<=_e;++gt)J_[Qe*b+gt]===0&&(gE[Qe*b+gt]=i._dem.set(gt,Qe,nt));for(let Qe=1;Qe<te;++Qe){oe=Math.max(1,V.x-Qe),pe=Math.max(1,V.y-Qe),_e=Math.min(q.x+Qe,b-2),ze=Math.min(q.y+Qe,b-2);for(let gt=pe;gt<=ze;++gt)for(let At=oe;At<=_e;++At){const Bt=gt*b+At;if(J_[Bt]===255){let Yt=0,Ft=0,_r=-1,Pr=-1;for(let dr=-1;dr<=1;++dr)for(let Er=-1;Er<=1;++Er){const lr=(gt+dr)*b+At+Er;if(J_[lr]>=Qe)continue;const Sr=gE[lr],Yr=Math.abs(Sr);Yr>Ft&&(Yt=Sr,Ft=Yr,_r=Er,Pr=dr)}if(Ft>.1){const dr=1-(Qe+.5*Math.abs(_r*Pr))/te;let Er=i._dem.get(At,gt)+Yt*dr;const lr=i._dem.get(At+_r,gt+Pr),Sr=i._dem.get(At-_r,gt-Pr,!0);(Er-lr)*(Er-Sr)>0&&(Er=(lr+Sr)/2),gE[Bt]=i._dem.set(At,gt,Er),J_[Bt]=Qe}}}}}C&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=br.now())}getNodesInfo(){return this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const i of t)mw(i.node),uE(i.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const c=i.getReplacementRegionsForTile(t.toUnwrapped()),m=this.getNodesInfo();for(let g=0;g<this.nodesInfo.length;g++){const b=m[g].node;m[g].hiddenByReplacement=!!b.footprint&&!c.find(C=>C.footprint===b.footprint)}}getHeightAtTileCoord(t,i){const c=this.getNodesInfo(),m=[];for(let g=0;g<this.nodesInfo.length;g++){const b=c[g],C=b.node.meshes[0];if(t<C.aabb.min[0]||i<C.aabb.min[1]||t>C.aabb.max[0]||i>C.aabb.max[1])continue;const k=(t-C.aabb.min[0])/(C.aabb.max[0]-C.aabb.min[0])*Y_|0,R=Math.min(63,(i-C.aabb.min[1])/(C.aabb.max[1]-C.aabb.min[1])*Y_|0)*Y_+Math.min(63,k);if(!(C.heightmap[R]<0&&b.node.footprint))return b.hiddenByReplacement?void 0:{height:C.heightmap[R],maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};if(b.node.footprint.grid.query(new Ge(t,i),new Ge(t,i),m),m.length>0)return{height:void 0,maxHeight:b.feature.properties.height,hidden:b.hiddenByReplacement,verticalScale:b.evaluatedScale[2]}}}}function Ax(r,t){return!r.isLightConstant&&t}function rV(r,t,i,c,m,g,b,C){let k=(61440&t|(61440&t)>>4)>>8,R=(3840&t|(3840&t)>>4)>>4,z=240&t|(240&t)>>4;i[3]>0&&(k=Hn(k,255*i[0],i[3]),R=Hn(R,255*i[1],i[3]),z=Hn(z,255*i[2],i[3]));const V=k<<8|R,q=z<<8|Math.floor(255*c[3]),Q=function(Qe){const gt=Ht(Qe,0,2);return Math.min(Math.round(.5*gt*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],te=Ht(m[0],0,1),oe=Ht(m[1],0,1),pe=Ht(m[2],0,1),_e=Ht(m[3],0,1);let ze,Ue,Ve,nt;if(te!==oe&&b!==g&&oe!==te){const Qe=b-g;Ue=1/(Qe*(oe-te)),Ve=-(g+Qe*te)/(Qe*(oe-te));const gt=Ht(m[4],-1,1);nt=Math.pow(10,gt),ze=255*pe<<8|255*_e}else ze=65535,Ue=0,Ve=1,nt=1;if(r.emplaceBack(V,q,Q,ze,Ue,Ve,nt),C){const Qe=C.length;C.clear();for(let gt=0;gt<Qe;gt++)C.emplaceBack(V,q,Q,ze,Ue,Ve,nt)}}function nV(r,t,i){const c=r.node;let m=0;const g=i&pv.HasMeshoptCompression;for(const b of c.meshes){if(c.lights&&c.lightMeshIndex===m||!b.featureData)continue;b.featureArray=new Hf,b.featureArray.reserve(b.featureData.length);let C=t;for(const k of b.featureData){const R=g?65535&k:k>>16&65535,z=g?k>>16&65535:65535&k,V=(15&z)<8?15&z:0,q=r.evaluatedRMEA[V],Q=r.evaluatedColor[V],te=r.emissionHeightBasedParams[V];let oe;if(C&&V===2&&c.lights&&(oe=new Hf,oe.resize(10*c.lights.length)),rV(b.featureArray,R,Q,q,te,b.aabb.min[2],b.aabb.max[2],oe),oe&&C){C=!1;const pe=c.meshes[c.lightMeshIndex];pe.featureArray=oe,pe.featureArray._trim()}}b.featureArray._trim(),m++}}function R3(r,t,i,c){const m=1<<r.z;t.lat=ro((c/Jr+r.y)/m),t.lng=Ti((i/Jr+r.x)/m)}re(xw,"Tiled3dModelBucket",{omit:["layers"]}),re(k3,"Tiled3dModelFeature");const iV={circle:class extends ia{constructor(r,t,i){super(r,BT,t,i)}createBucket(r){return new Tl(r)}queryRadius(r){const t=r;return _p("circle-radius",this,t)+_p("circle-stroke-width",this,t)+rm(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,i,c,m,g,b,C){const k=wb(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return U_(r,c,g,b,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,R)}getProgramIds(){return["circle"]}getDefaultProgramParams(r,t){const i=zh(this);return{config:new he(this,t),defines:i,overrideFog:!1}}},heatmap:class extends ia{createBucket(r){return new J0(r)}constructor(r,t,i){super(r,Jy,t,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return _p("heatmap-radius",this,r)}queryIntersectsFeature(r,t,i,c,m,g,b,C){const k=this.paint.get("heatmap-radius").evaluate(t,i);return U_(r,c,g,b,C,!0,!0,new Ge(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(r,t){return r==="heatmap"?{config:new he(this,t),overrideFog:!1}:{}}},hillshade:class extends ia{constructor(r,t,i){super(r,FT,t,i)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},fill:class extends ia{constructor(r,t,i){super(r,tv,t,i)}getProgramIds(){const r=this.paint.get("fill-pattern"),t=r&&r.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(r,t){return{config:new he(this,t),overrideFog:!1}}recalculate(r,t){super.recalculate(r,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new ux(r)}queryRadius(){return rm(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,i,c,m,g){return!r.queryGeometry.isAboveHorizon&&gp(nm(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends ia{constructor(r,t,i){super(r,_F,t,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(r){return new Hb(r)}queryRadius(){return rm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(r,t,i,c,m,g,b,C,k){const R=wb(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),z=this.paint.get("fill-extrusion-height").evaluate(t,i),V=this.paint.get("fill-extrusion-base").evaluate(t,i),q=[0,0],Q=C&&g.elevation,te=g.elevation?g.elevation.exaggeration():1,oe=r.tile.getBucket(this);if(Q&&oe instanceof Hb){const Ve=oe.centroidVertexArray,nt=k+1;nt<Ve.length&&(q[0]=Ve.geta_centroid_pos0(nt),q[1]=Ve.geta_centroid_pos1(nt))}if(q[0]===0&&q[1]===1)return!1;g.projection.name==="globe"&&(c=ok([c],[new Ge(0,0),new Ge(Jr,Jr)],r.tileID.canonical).map(Ve=>Ve.polygon).flat());const pe=Q?C:null,[_e,ze]=function(Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr){return Ve.projection.name==="globe"?function(Er,lr,Sr,Yr,kr,bn,dn,jr,ti,zn,yn){const Br=[],Wn=[],Wi=Er.projection.upVectorScale(yn,Er.center.lat,Er.worldSize).metersToTile,ci=[0,0,0,1],Hi=[0,0,0,1],Ei=(Ri,Wo,_o,So)=>{Ri[0]=Wo,Ri[1]=_o,Ri[2]=So,Ri[3]=1},ao=ik();Sr>0&&(Sr+=ao),Yr+=ao;for(const Ri of lr){const Wo=[],_o=[];for(const So of Ri){const Po=So.x+kr.x,yo=So.y+kr.y,Sa=Er.projection.projectTilePoint(Po,yo,yn),Lo=Er.projection.upVector(yn,So.x,So.y);let Za=Sr,Bs=Yr;if(dn){const Il=sk(Po,yo,Sr,Yr,dn,jr,ti,zn);Za+=Il.base,Bs+=Il.top}Sr!==0?Ei(ci,Sa.x+Lo[0]*Wi*Za,Sa.y+Lo[1]*Wi*Za,Sa.z+Lo[2]*Wi*Za):Ei(ci,Sa.x,Sa.y,Sa.z),Ei(Hi,Sa.x+Lo[0]*Wi*Bs,Sa.y+Lo[1]*Wi*Bs,Sa.z+Lo[2]*Wi*Bs),s.N.transformMat4(ci,ci,bn),s.N.transformMat4(Hi,Hi,bn),Wo.push(new iv(ci[0],ci[1],ci[2])),_o.push(new iv(Hi[0],Hi[1],Hi[2]))}Br.push(Wo),Wn.push(_o)}return[Br,Wn]}(Ve,nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr,dr):Yt?function(Er,lr,Sr,Yr,kr,bn,dn,jr,ti){const zn=[],yn=[],Br=[0,0,0,1];for(const Wn of Er){const Wi=[],ci=[];for(const Hi of Wn){const Ei=Hi.x+Yr.x,ao=Hi.y+Yr.y,Ri=sk(Ei,ao,lr,Sr,bn,dn,jr,ti);Br[0]=Ei,Br[1]=ao,Br[2]=Ri.base,Br[3]=1,s.a7.transformMat4(Br,Br,kr),Br[3]=Math.max(Br[3],1e-5);const Wo=new iv(Br[0]/Br[3],Br[1]/Br[3],Br[2]/Br[3]);Br[0]=Ei,Br[1]=ao,Br[2]=Ri.top,Br[3]=1,s.a7.transformMat4(Br,Br,kr),Br[3]=Math.max(Br[3],1e-5);const _o=new iv(Br[0]/Br[3],Br[1]/Br[3],Br[2]/Br[3]);Wi.push(Wo),ci.push(_o)}zn.push(Wi),yn.push(ci)}return[zn,yn]}(nt,Qe,gt,At,Bt,Yt,Ft,_r,Pr):function(Er,lr,Sr,Yr,kr){const bn=[],dn=[],jr=kr[8]*lr,ti=kr[9]*lr,zn=kr[10]*lr,yn=kr[11]*lr,Br=kr[8]*Sr,Wn=kr[9]*Sr,Wi=kr[10]*Sr,ci=kr[11]*Sr;for(const Hi of Er){const Ei=[],ao=[];for(const Ri of Hi){const Wo=Ri.x+Yr.x,_o=Ri.y+Yr.y,So=kr[0]*Wo+kr[4]*_o+kr[12],Po=kr[1]*Wo+kr[5]*_o+kr[13],yo=kr[2]*Wo+kr[6]*_o+kr[14],Sa=kr[3]*Wo+kr[7]*_o+kr[15],Lo=So+jr,Za=Po+ti,Bs=yo+zn,Il=Math.max(Sa+yn,1e-5),fa=So+Br,ka=Po+Wn,dl=yo+Wi,pl=Math.max(Sa+ci,1e-5);Ei.push(new iv(Lo/Il,Za/Il,Bs/Il)),ao.push(new iv(fa/pl,ka/pl,dl/pl))}bn.push(Ei),dn.push(ao)}return[bn,dn]}(nt,Qe,gt,At,Bt)}(g,c,V,z,R,b,pe,q,te,g.center.lat,r.tileID.canonical),Ue=r.queryGeometry;return function(Ve,nt,Qe){let gt=1/0;gp(Qe,nt)&&(gt=ak(Qe,nt[0]));for(let At=0;At<nt.length;At++){const Bt=nt[At],Yt=Ve[At];for(let Ft=0;Ft<Bt.length-1;Ft++){const _r=Bt[Ft],Pr=[_r,Bt[Ft+1],Yt[Ft+1],Yt[Ft],_r];wu(Qe,Pr)&&(gt=Math.min(gt,ak(Qe,Pr)))}}return gt!==1/0&&gt}(_e,ze,Ue.isPointQuery()?Ue.screenBounds:Ue.screenGeometry)}},line:class extends ia{constructor(r,t,i){super(r,ck,t,i),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof fu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=mk.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new GT(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(r,t){const i=pk(this);return{config:new he(this,t),defines:i,overrideFog:!1}}queryRadius(r){const t=r,i=gk(_p("line-width",this,t),_p("line-gap-width",this,t)),c=_p("line-offset",this,t);return i/2+Math.abs(c)+rm(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,i,c,m,g){if(r.queryGeometry.isAboveHorizon)return!1;const b=nm(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,r.pixelToTileUnitsFactor),C=r.pixelToTileUnitsFactor/2*gk(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),k=this.paint.get("line-offset").evaluate(t,i);return k&&(c=function(R,z){const V=[],q=new Ge(0,0);for(let Q=0;Q<R.length;Q++){const te=R[Q],oe=[];for(let pe=0;pe<te.length;pe++){const _e=te[pe],ze=te[pe+1],Ue=pe===0?q:_e.sub(te[pe-1])._unit()._perp(),Ve=pe===te.length-1?q:ze.sub(_e)._unit()._perp(),nt=Ue._add(Ve)._unit();nt._mult(1/(nt.x*Ve.x+nt.y*Ve.y)),oe.push(nt._mult(z)._add(_e))}V.push(oe)}return V}(c,k*r.pixelToTileUnitsFactor)),function(R,z,V){for(let q=0;q<z.length;q++){const Q=z[q];if(R.length>=3){for(let te=0;te<Q.length;te++)if(Qu(R,Q[te]))return!0}if(of(R,Q,V))return!0}return!1}(b,c,C)}isTileClipped(){return!0}},symbol:cw,background:class extends ia{constructor(r,t,i){super(r,x6,t,i)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},raster:t3,"raster-particle":r3,sky:class extends ia{constructor(r,t,i){super(r,A6,t,i),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=mg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(r,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),m=!c,g=r.style.light,b=g.properties.get("position");return m&&g.properties.get("anchor")==="viewport"&&Kt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?aE(b.azimuthal,90-b.polar,t):aE(c[0],90-c[1],t)}const i=this.paint.get("sky-gradient-center");return aE(i[0],90-i[1],t)}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}},slot:class extends ia{constructor(r,t,i){super(r,P6,t)}},model:class extends ia{constructor(r,t,i){super(r,j6,t,i),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(r){return new lE(r)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(r){return r instanceof xw?Jr-1:0}queryIntersectsFeature(r,t,i,c,m,g){if(!this.modelManager)return!1;const b=this.modelManager,C=r.tile.getBucket(this);if(!(C&&C instanceof lE))return!1;const k=C;for(const R in k.instancesPerModel){const z=k.instancesPerModel[R];if(z.idToFeaturesIndex.hasOwnProperty(t.id)){const V=z.features[z.idToFeaturesIndex[t.id]],q=b.getModel(R,this.scope);if(!q)return!1;let Q=s.a6.create();const te=new zt(0,0),oe=k.canonical;let pe=Number.MAX_VALUE;for(let _e=0;_e<V.instancedDataCount;++_e){const ze=16*(V.instancedDataOffset+_e),Ue=z.instancedDataArray.float32,Ve=[Ue[ze+4],Ue[ze+5],Ue[ze+6]];R3(oe,te,Ue[ze],0|Ue[ze+1]),h3(Q,q,g,te,V.rotation,V.scale,Ve,!1,!1,!1),g.projection.name==="globe"&&(Q=sE(Q,g));const nt=s.a6.multiply([],g.projMatrix,Q),Qe=r.queryGeometry,gt=l3(Qe.isPointQuery()?Qe.screenBounds:Qe.screenGeometry,g,nt,q.aabb);gt!=null&&(pe=Math.min(gt,pe))}return pe!==Number.MAX_VALUE&&pe}}return!1}_handleOverridablePaintPropertyUpdate(r,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven()||r!=="model-color"&&r!=="model-color-mix-intensity"&&r!=="model-rotation"&&r!=="model-scale"&&r!=="model-translation"&&r!=="model-emissive-strength")}_isPropertyZoomDependent(r){const t=this._transitionablePaint._values[r];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof Ch}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(r,t,i,c){const m=r.tile,g=m.getBucket(this);let b=null,C=Number.MAX_VALUE;if(!(g&&g instanceof xw))return{queryFeature:b,intersectionZ:C};const k=g.getNodesInfo()[t];if(k.hiddenByReplacement||!k.node.meshes||!i.filter(new $n(m.tileID.overscaledZ),k.feature,m.tileID.canonical))return{queryFeature:b,intersectionZ:C};const R=k.node,z=c.calculatePosMatrix(m.tileID.toUnwrapped(),c.worldSize),V=k.evaluatedScale;let q=0;c.elevation&&R.elevation&&(q=R.elevation*c.elevation.exaggeration()),s.a6.translate(z,z,[(R.anchor?R.anchor[0]:0)*(V[0]-1),(R.anchor?R.anchor[1]:0)*(V[1]-1),q]),s.a6.scale(z,z,V),s.a6.multiply(z,z,R.matrix);const Q=r.queryGeometry,te=Q.isPointQuery()?Q.screenBounds:Q.screenGeometry,oe=function(_e){const ze=s.a6.multiply([],z,_e.matrix),Ue=s.a6.multiply(ze,c.expandedFarZProjMatrix,ze);for(let Ve=0;Ve<_e.meshes.length;++Ve){const nt=_e.meshes[Ve];if(Ve===_e.lightMeshIndex)continue;const Qe=l3(te,c,Ue,nt.aabb);Qe!=null&&(C=Math.min(Qe,C))}if(_e.children)for(const Ve of _e.children)oe(Ve)};if(oe(R),C===Number.MAX_VALUE)return{queryFeature:b,intersectionZ:C};const pe=new zt(0,0);return R3(m.tileID.canonical,pe,k.node.anchor[0],k.node.anchor[1]),b={type:"Feature",geometry:{type:"Point",coordinates:[pe.lng,pe.lat]},properties:k.feature.properties,id:k.feature.id,state:{},layer:this.serialize()},{queryFeature:b,intersectionZ:C}}}},Bi={read:function(r,t){return r.readFields(Bi._readField,{header_length:0,x:0,y:0,z:0,layers:[]},t)},_readField:function(r,t,i){r===1?t.header_length=i.readFixed32():r===2?t.x=i.readVarint():r===3?t.y=i.readVarint():r===4?t.z=i.readVarint():r===5&&t.layers.push(Bi.Layer.read(i,i.readVarint()+i.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};Bi.Filter.read=function(r,t){return r.readFields(Bi.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},t)},Bi.Filter._readField=function(r,t,i){r===1?(t.delta_filter=Bi.Filter.Delta.read(i,i.readVarint()+i.pos),t.filter="delta_filter"):r===2?(t.zigzag_filter=Bi.Filter.Zigzag.read(i,i.readVarint()+i.pos),t.filter="zigzag_filter"):r===3?(t.bitshuffle_filter=Bi.Filter.BitShuffle.read(i,i.readVarint()+i.pos),t.filter="bitshuffle_filter"):r===4&&(t.byteshuffle_filter=Bi.Filter.ByteShuffle.read(i,i.readVarint()+i.pos),t.filter="byteshuffle_filter")},Bi.Filter.Delta={},Bi.Filter.Delta.read=function(r,t){return r.readFields(Bi.Filter.Delta._readField,{block_size:0},t)},Bi.Filter.Delta._readField=function(r,t,i){r===1&&(t.block_size=i.readVarint())},Bi.Filter.Zigzag={},Bi.Filter.Zigzag.read=function(r,t){return r.readFields(Bi.Filter.Zigzag._readField,{},t)},Bi.Filter.Zigzag._readField=function(r,t,i){},Bi.Filter.BitShuffle={},Bi.Filter.BitShuffle.read=function(r,t){return r.readFields(Bi.Filter.BitShuffle._readField,{},t)},Bi.Filter.BitShuffle._readField=function(r,t,i){},Bi.Filter.ByteShuffle={},Bi.Filter.ByteShuffle.read=function(r,t){return r.readFields(Bi.Filter.ByteShuffle._readField,{},t)},Bi.Filter.ByteShuffle._readField=function(r,t,i){},Bi.Codec={},Bi.Codec.read=function(r,t){return r.readFields(Bi.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},t)},Bi.Codec._readField=function(r,t,i){r===1?(t.gzip_data=Bi.Codec.GzipData.read(i,i.readVarint()+i.pos),t.codec="gzip_data"):r===2?(t.jpeg_image=Bi.Codec.JpegImage.read(i,i.readVarint()+i.pos),t.codec="jpeg_image"):r===3?(t.webp_image=Bi.Codec.WebpImage.read(i,i.readVarint()+i.pos),t.codec="webp_image"):r===4&&(t.png_image=Bi.Codec.PngImage.read(i,i.readVarint()+i.pos),t.codec="png_image")},Bi.Codec.GzipData={},Bi.Codec.GzipData.read=function(r,t){return r.readFields(Bi.Codec.GzipData._readField,{},t)},Bi.Codec.GzipData._readField=function(r,t,i){},Bi.Codec.JpegImage={},Bi.Codec.JpegImage.read=function(r,t){return r.readFields(Bi.Codec.JpegImage._readField,{},t)},Bi.Codec.JpegImage._readField=function(r,t,i){},Bi.Codec.WebpImage={},Bi.Codec.WebpImage.read=function(r,t){return r.readFields(Bi.Codec.WebpImage._readField,{},t)},Bi.Codec.WebpImage._readField=function(r,t,i){},Bi.Codec.PngImage={},Bi.Codec.PngImage.read=function(r,t){return r.readFields(Bi.Codec.PngImage._readField,{},t)},Bi.Codec.PngImage._readField=function(r,t,i){},Bi.DataIndexEntry={},Bi.DataIndexEntry.read=function(r,t){return r.readFields(Bi.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},t)},Bi.DataIndexEntry._readField=function(r,t,i){r===1?t.first_byte=i.readFixed64():r===2?t.last_byte=i.readFixed64():r===3?t.filters.push(Bi.Filter.read(i,i.readVarint()+i.pos)):r===4?t.codec=Bi.Codec.read(i,i.readVarint()+i.pos):r===5?t.offset=i.readFloat():r===6?t.scale=i.readFloat():r===7&&t.bands.push(i.readString())},Bi.Layer={},Bi.Layer.read=function(r,t){return r.readFields(Bi.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},t)},Bi.Layer._readField=function(r,t,i){r===1?t.version=i.readVarint():r===2?t.name=i.readString():r===3?t.units=i.readString():r===4?t.tilesize=i.readVarint():r===5?t.buffer=i.readVarint():r===6?t.pixel_format=i.readVarint():r===7&&t.data_index.push(Bi.DataIndexEntry.read(i,i.readVarint()+i.pos))};const Cp={read:function(r,t){return r.readFields(Cp._readField,{uint32_values:null,values:null,fixed32_values:null},t)},_readField:function(r,t,i){r===2?(t.uint32_values=Cp.Uint32Values.read(i,i.readVarint()+i.pos),t.values="uint32_values"):r===3&&(t.fixed32_values=Cp.Fixed32Values.read(i,i.readVarint()+i.pos),t.values="fixed32_values")},Uint32Values:{}};Cp.Uint32Values.read=function(r,t){return r.readFields(Cp.Uint32Values._readField,{values:[]},t)},Cp.Uint32Values._readField=function(r,t,i){r===1&&(t.readValuesInto=function(c){if(c.type!==2)throw new Error(`Unsupported pbf type "${c.type}"`);const m=function(b){return b.type===2?b.readVarint()+b.pos:b.pos+1}(c),g=c.pos;return c.pos=m,function(b){c.pos=g;let C=0;for(;c.pos<m;){const k=c.readVarint();b[C++]=k}return b}}(i))},Cp.Fixed32Values={},Cp.Fixed32Values.read=function(r,t){return r.readFields(Cp.Fixed32Values._readField,{values:[]},t)},Cp.Fixed32Values._readField=function(r,t,i){throw new Error("Not implemented")};/**
 * tiny-lru
 *
 * @copyright 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.2.5
 */class oV{constructor(t=0,i=0,c=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=c,this.size=0,this.ttl=i}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const i=this.items[t];delete this.items[t],this.size--,i.prev!==null&&(i.prev.next=i.next),i.next!==null&&(i.next.prev=i.prev),this.first===i&&(this.first=i.next),this.last===i&&(this.last=i.prev)}return this}entries(t=this.keys()){return t.map(i=>[i,this.get(i)])}evict(t=!1){if(t||this.size>0){const i=this.first;delete this.items[i.key],--this.size==0?(this.first=null,this.last=null):(this.first=i.next,this.first.prev=null)}return this}expiresAt(t){let i;return this.has(t)&&(i=this.items[t].expiry),i}get(t){let i;if(this.has(t)){const c=this.items[t];this.ttl>0&&c.expiry<=Date.now()?this.delete(t):(i=c.value,this.set(t,i,!0))}return i}has(t){return t in this.items}keys(){const t=[];let i=this.first;for(;i!==null;)t.push(i.key),i=i.next;return t}set(t,i,c=!1,m=this.resetTtl){let g;if(c||this.has(t)){if(g=this.items[t],g.value=i,c===!1&&m&&(g.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==g){const b=this.last,C=g.next,k=g.prev;this.first===g&&(this.first=g.next),g.next=null,g.prev=this.last,b.next=g,k!==null&&(k.next=C),C!==null&&(C.prev=k)}}else this.max>0&&this.size===this.max&&this.evict(!0),g=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:i},++this.size==1?this.first=g:this.last.next=g;return this.last=g,this}values(t=this.keys()){return t.map(i=>this.get(i))}}function aV(r,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let i=t[3];for(let c=2;c>=1;c--){const m=c===1?1:0,g=c===2?1:0;for(let b=0;b<t[0];b++){const C=t[1]*b;for(let k=m;k<t[1];k++){const R=t[2]*(k+C);for(let z=g;z<t[2];z++){const V=t[3]*(z+R);for(let q=0;q<t[3];q++){const Q=V+q;r[Q]+=r[Q-i]}}}}i*=t[c]}return r}function sV(r){for(let t=0,i=r.length;t<i;t++)r[t]=r[t]>>>1^-(1&r[t]);return r}function lV(r,t){switch(t){case"uint32":return r;case"uint16":for(let i=0;i<r.length;i+=2){const c=r[i],m=r[i+1];r[i]=(240&c)>>4|(61440&c)>>8|(240&m)<<4|61440&m,r[i+1]=15&c|(3840&c)>>4|(15&m)<<8|(3840&m)<<4}return r;case"uint8":for(let i=0;i<r.length;i+=4){const c=r[i],m=r[i+1],g=r[i+2],b=r[i+3];r[i+0]=(192&c)>>6|(192&m)>>4|(192&g)>>2|192&b,r[i+1]=(48&c)>>4|(48&m)>>2|48&g|(48&b)<<2,r[i+2]=(12&c)>>2|12&m|(12&g)<<2|(12&b)<<4,r[i+3]=3&c|(3&m)<<2|(3&g)<<4|(3&b)<<6}return r;default:throw new Error(`Invalid pixel format, "${t}"`)}}class Ig extends Error{constructor(t){super(t),this.name="MRTError"}}var jh=Uint8Array,_v=Uint16Array,cV=Int32Array,D3=new jh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),O3=new jh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uV=new jh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L3=function(r,t){for(var i=new _v(31),c=0;c<31;++c)i[c]=t+=1<<r[c-1];var m=new cV(i[30]);for(c=1;c<30;++c)for(var g=i[c];g<i[c+1];++g)m[g]=g-i[c]<<5|c;return{b:i,r:m}},z3=L3(D3,2),N3=z3.b,hV=z3.r;N3[28]=258,hV[258]=28;for(var dV=L3(O3,0).b,_E=new _v(32768),Ss=0;Ss<32768;++Ss){var yv=(43690&Ss)>>1|(21845&Ss)<<1;_E[Ss]=((65280&(yv=(61680&(yv=(52428&yv)>>2|(13107&yv)<<2))>>4|(3855&yv)<<4))>>8|(255&yv)<<8)>>1}var Px=function(r,t,i){for(var c=r.length,m=0,g=new _v(t);m<c;++m)r[m]&&++g[r[m]-1];var b,C=new _v(t);for(m=1;m<t;++m)C[m]=C[m-1]+g[m-1]<<1;if(i){b=new _v(1<<t);var k=15-t;for(m=0;m<c;++m)if(r[m])for(var R=m<<4|r[m],z=t-r[m],V=C[r[m]-1]++<<z,q=V|(1<<z)-1;V<=q;++V)b[_E[V]>>k]=R}else for(b=new _v(c),m=0;m<c;++m)r[m]&&(b[m]=_E[C[r[m]-1]++]>>15-r[m]);return b},Mx=new jh(288);for(Ss=0;Ss<144;++Ss)Mx[Ss]=8;for(Ss=144;Ss<256;++Ss)Mx[Ss]=9;for(Ss=256;Ss<280;++Ss)Mx[Ss]=7;for(Ss=280;Ss<288;++Ss)Mx[Ss]=8;var j3=new jh(32);for(Ss=0;Ss<32;++Ss)j3[Ss]=5;var pV=Px(Mx,9,1),fV=Px(j3,5,1),yE=function(r){for(var t=r[0],i=1;i<r.length;++i)r[i]>t&&(t=r[i]);return t},Ap=function(r,t,i){var c=t/8|0;return(r[c]|r[c+1]<<8)>>(7&t)&i},vE=function(r,t){var i=t/8|0;return(r[i]|r[i+1]<<8|r[i+2]<<16)>>(7&t)},mV=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Pp=function(r,t,i){var c=new Error(t||mV[r]);if(c.code=r,Error.captureStackTrace&&Error.captureStackTrace(c,Pp),!i)throw c;return c},gV=new jh(0),_V=typeof TextDecoder<"u"&&new TextDecoder;try{_V.decode(gV,{stream:!0})}catch{}const yV={gzip_data:"gzip"},vV={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},xV={uint32:1,uint16:2,uint8:4},bV={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class B3{constructor(t=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){return this.layers[t]}getHeaderLength(t){const i=new Uint8Array(t),c=new DataView(t);if(i[0]!==13)throw new Ig("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(t){const i=new Uint8Array(t),c=this.getHeaderLength(t);if(i.length<c)throw new Ig(`Expected header with length >= ${c} but got buffer of length ${i.length}`);const m=new lv(i.subarray(0,c)),g=Bi.read(m);if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Ig(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const b of g.layers)this.layers[b.name]=new wV(b,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const i=[],c=this.getLayer(t.layerName);for(let m=0;m<c.dataIndex.length;m++){const g=c.dataIndex[m],b=g.first_byte-t.firstByte,C=g.last_byte+1-t.firstByte;if(m<t.firstBlock||m>t.lastBlock||c._blocksInProgress.has(m))continue;const k={layerName:c.name,firstByte:b,lastByte:C,pixelFormat:c.pixelFormat,blockIndex:m,blockShape:[g.bands.length].concat(c.bandShape),buffer:c.buffer,codec:g.codec.codec,filters:g.filters.map(R=>R.filter)};c._blocksInProgress.add(m),i.push(k)}return new F3(i,()=>{i.forEach(m=>c._blocksInProgress.delete(m.blockIndex))},(m,g)=>{if(i.forEach(b=>c._blocksInProgress.delete(b.blockIndex)),m)throw m;g.forEach(b=>{this.getLayer(b.layerName).processDecodedData(b)})})}}class wV{constructor({version:t,name:i,units:c,tilesize:m,pixel_format:g,buffer:b,data_index:C},k){if(this.version=t,this.version!==1)throw new Ig(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=i,this.units=c,this.tileSize=m,this.buffer=b,this.pixelFormat=vV[g],this.dataIndex=C,this.bandShape=[m+2*b,m+2*b,xV[this.pixelFormat]],this._decodedBlocks=function(R=1e3,z=0,V=!1){if(isNaN(R)||R<0)throw new TypeError("Invalid max value");if(isNaN(z)||z<0)throw new TypeError("Invalid ttl value");if(typeof V!="boolean")throw new TypeError("Invalid resetTtl value");return new oV(R,z,V)}(k?k.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(t){const i=t.blockIndex.toString();this._decodedBlocks.get(i)||this._decodedBlocks.set(i,t.data)}getBlockForBand(t){let i=0;switch(typeof t){case"string":for(const[c,m]of this.dataIndex.entries()){for(const[g,b]of m.bands.entries())if(b===t)return{bandIndex:i+g,blockIndex:c,blockBandIndex:g};i+=m.bands.length}break;case"number":for(const[c,m]of this.dataIndex.entries()){if(t>=i&&t<i+m.bands.length)return{bandIndex:t,blockIndex:c,blockBandIndex:t-i};i+=m.bands.length}break;default:throw new Ig(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}throw new Ig(`Band not found: ${JSON.stringify(t)}`)}getDataRange(t){let i=1/0,c=-1/0,m=1/0,g=-1/0;for(const b of t){const{blockIndex:C}=this.getBlockForBand(b);if(C<0)throw new Ig(`Invalid band: ${JSON.stringify(b)}`);const k=this.dataIndex[C];m=Math.min(m,C),g=Math.max(g,C),i=Math.min(i,k.first_byte),c=Math.max(c,k.last_byte)}return{layerName:this.name,firstByte:i,lastByte:c,firstBlock:m,lastBlock:g}}hasBand(t){const{blockIndex:i}=this.getBlockForBand(t);return i>=0}hasDataForBand(t){const{blockIndex:i}=this.getBlockForBand(t);return i>=0&&!!this._decodedBlocks.get(i.toString())}getBandView(t){const{blockIndex:i,blockBandIndex:c}=this.getBlockForBand(t),m=this._decodedBlocks.get(i.toString());if(!m)throw new Ig(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[i],b=this.bandShape.reduce((R,z)=>R*z,1),C=c*b,k=m.subarray(C,C+b);return{data:k,bytes:new Uint8Array(k.buffer).subarray(k.byteOffset,k.byteOffset+k.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:g.offset,scale:g.scale}}}class F3{constructor(t,i,c){this.tasks=t,this._onCancel=i,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,i){this._finalized||(this._onComplete(t,i),this._finalized=!0)}}B3.performDecoding=function(r,t){return Promise.all(t.tasks.map(i=>{const{layerName:c,firstByte:m,lastByte:g,pixelFormat:b,blockShape:C,blockIndex:k,filters:R,codec:z}=i,V=new Uint8Array(r).subarray(m,g+1),q=new Uint32Array(C[0]*C[1]*C[2]);let Q;if(z!=="gzip_data")throw new Error(`Unhandled codec: ${z}`);return Q=function(te,oe){if(!globalThis.DecompressionStream&&oe==="gzip_data")return Promise.resolve(((Ue=function(Qe){Qe[0]==31&&Qe[1]==139&&Qe[2]==8||Pp(6,"invalid gzip data");var gt=Qe[3],At=10;4&gt&&(At+=2+(Qe[10]|Qe[11]<<8));for(var Bt=(gt>>3&1)+(gt>>4&1);Bt>0;Bt-=!Qe[At++]);return At+(2&gt)}(ze=te))+8>ze.length&&Pp(6,"invalid gzip data"),function(Qe,gt,At,Bt){var Yt=Qe.length;if(!Yt||gt.f&&!gt.l)return At||new jh(0);var Ft=!At,_r=Ft||gt.i!=2,Pr=gt.i;Ft&&(At=new jh(3*Yt));var dr=function(Wc){var Tc=At.length;if(Wc>Tc){var Bh=new jh(Math.max(2*Tc,Wc));Bh.set(At),At=Bh}},Er=gt.f||0,lr=gt.p||0,Sr=gt.b||0,Yr=gt.l,kr=gt.d,bn=gt.m,dn=gt.n,jr=8*Yt;do{if(!Yr){Er=Ap(Qe,lr,1);var ti=Ap(Qe,lr+1,3);if(lr+=3,!ti){var zn=Qe[(_o=4+((lr+7)/8|0))-4]|Qe[_o-3]<<8,yn=_o+zn;if(yn>Yt){Pr&&Pp(0);break}_r&&dr(Sr+zn),At.set(Qe.subarray(_o,yn),Sr),gt.b=Sr+=zn,gt.p=lr=8*yn,gt.f=Er;continue}if(ti==1)Yr=pV,kr=fV,bn=9,dn=5;else if(ti==2){var Br=Ap(Qe,lr,31)+257,Wn=Ap(Qe,lr+10,15)+4,Wi=Br+Ap(Qe,lr+5,31)+1;lr+=14;for(var ci=new jh(Wi),Hi=new jh(19),Ei=0;Ei<Wn;++Ei)Hi[uV[Ei]]=Ap(Qe,lr+3*Ei,7);lr+=3*Wn;var ao=yE(Hi),Ri=(1<<ao)-1,Wo=Px(Hi,ao,1);for(Ei=0;Ei<Wi;){var _o,So=Wo[Ap(Qe,lr,Ri)];if(lr+=15&So,(_o=So>>4)<16)ci[Ei++]=_o;else{var Po=0,yo=0;for(_o==16?(yo=3+Ap(Qe,lr,3),lr+=2,Po=ci[Ei-1]):_o==17?(yo=3+Ap(Qe,lr,7),lr+=3):_o==18&&(yo=11+Ap(Qe,lr,127),lr+=7);yo--;)ci[Ei++]=Po}}var Sa=ci.subarray(0,Br),Lo=ci.subarray(Br);bn=yE(Sa),dn=yE(Lo),Yr=Px(Sa,bn,1),kr=Px(Lo,dn,1)}else Pp(1);if(lr>jr){Pr&&Pp(0);break}}_r&&dr(Sr+131072);for(var Za=(1<<bn)-1,Bs=(1<<dn)-1,Il=lr;;Il=lr){var fa=(Po=Yr[vE(Qe,lr)&Za])>>4;if((lr+=15&Po)>jr){Pr&&Pp(0);break}if(Po||Pp(2),fa<256)At[Sr++]=fa;else{if(fa==256){Il=lr,Yr=null;break}var ka=fa-254;fa>264&&(ka=Ap(Qe,lr,(1<<(fl=D3[Ei=fa-257]))-1)+N3[Ei],lr+=fl);var dl=kr[vE(Qe,lr)&Bs],pl=dl>>4;if(dl||Pp(3),lr+=15&dl,Lo=dV[pl],pl>3){var fl=O3[pl];Lo+=vE(Qe,lr)&(1<<fl)-1,lr+=fl}if(lr>jr){Pr&&Pp(0);break}_r&&dr(Sr+131072);var aa=Sr+ka;if(Sr<Lo){var sh=0-Lo,Cg=Math.min(Lo,aa);for(sh+Sr<0&&Pp(3);Sr<Cg;++Sr)At[Sr]=Bt[sh+Sr]}for(;Sr<aa;++Sr)At[Sr]=At[Sr-Lo]}}gt.l=Yr,gt.p=Il,gt.b=Sr,gt.f=Er,Yr&&(Er=1,gt.m=bn,gt.d=kr,gt.n=dn)}while(!Er);return Sr!=At.length&&Ft?function(Wc,Tc,Bh){return(Tc==null||Tc<0)&&(Tc=0),(Bh==null||Bh>Wc.length)&&(Bh=Wc.length),new jh(Wc.subarray(Tc,Bh))}(At,0,Sr):At.subarray(0,Sr)}(ze.subarray(Ue,-8),{i:2},new jh(((pe=ze)[(_e=pe.length)-4]|pe[_e-3]<<8|pe[_e-2]<<16|pe[_e-1]<<24)>>>0),void 0)));var pe,_e,ze,Ue;const Ve=yV[oe];if(!Ve)throw new Error(`Unhandled codec: ${oe}`);const nt=new globalThis.DecompressionStream(Ve);return new Response(new Blob([te]).stream().pipeThrough(nt)).arrayBuffer().then(Qe=>new Uint8Array(Qe))}(V,z).then(te=>{const oe=Cp.read(new lv(te));if(oe.values==="uint32_values")return oe.uint32_values.readValuesInto(q),new bV[b](q.buffer);throw new Error(`Unhandled numeric data "${oe.values}"`)}),Q.then(te=>{for(let oe=R.length-1;oe>=0;oe--)switch(R[oe]){case"delta_filter":aV(te,C);break;case"zigzag_filter":sV(te);break;case"bitshuffle_filter":lV(te,b);break;default:throw new Error(`Unhandled filter "${R[oe]}"`)}return{layerName:c,blockIndex:k,data:te}}).catch(te=>{throw te})}))},re(F3,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});const V3=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xE{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,c]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=c>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const g=V3[15&c];if(!g)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new xE(C,b,g,t)}constructor(t,i=64,c=Float64Array,m){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=V3.indexOf(this.ArrayType),b=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-C%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+k,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+b+C+k),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+k,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=i,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return bE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,c,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:C}=this,k=[0,g.length-1,0],R=[];for(;k.length;){const z=k.pop()||0,V=k.pop()||0,q=k.pop()||0;if(V-q<=C){for(let pe=q;pe<=V;pe++){const _e=b[2*pe],ze=b[2*pe+1];_e>=t&&_e<=c&&ze>=i&&ze<=m&&R.push(g[pe])}continue}const Q=q+V>>1,te=b[2*Q],oe=b[2*Q+1];te>=t&&te<=c&&oe>=i&&oe<=m&&R.push(g[Q]),(z===0?t<=te:i<=oe)&&(k.push(q),k.push(Q-1),k.push(1-z)),(z===0?c>=te:m>=oe)&&(k.push(Q+1),k.push(V),k.push(1-z))}return R}within(t,i,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:b}=this,C=[0,m.length-1,0],k=[],R=c*c;for(;C.length;){const z=C.pop()||0,V=C.pop()||0,q=C.pop()||0;if(V-q<=b){for(let pe=q;pe<=V;pe++)$3(g[2*pe],g[2*pe+1],t,i)<=R&&k.push(m[pe]);continue}const Q=q+V>>1,te=g[2*Q],oe=g[2*Q+1];$3(te,oe,t,i)<=R&&k.push(m[Q]),(z===0?t-c<=te:i-c<=oe)&&(C.push(q),C.push(Q-1),C.push(1-z)),(z===0?t+c>=te:i+c>=oe)&&(C.push(Q+1),C.push(V),C.push(1-z))}return k}}function bE(r,t,i,c,m,g){if(m-c<=i)return;const b=c+m>>1;U3(r,t,b,c,m,g),bE(r,t,i,c,b-1,1-g),bE(r,t,i,b+1,m,1-g)}function U3(r,t,i,c,m,g){for(;m>c;){if(m-c>600){const R=m-c+1,z=i-c+1,V=Math.log(R),q=.5*Math.exp(2*V/3),Q=.5*Math.sqrt(V*q*(R-q)/R)*(z-R/2<0?-1:1);U3(r,t,i,Math.max(c,Math.floor(i-z*q/R+Q)),Math.min(m,Math.floor(i+(R-z)*q/R+Q)),g)}const b=t[2*i+g];let C=c,k=m;for(kx(r,t,c,i),t[2*m+g]>b&&kx(r,t,c,m);C<k;){for(kx(r,t,C,k),C++,k--;t[2*C+g]<b;)C++;for(;t[2*k+g]>b;)k--}t[2*c+g]===b?kx(r,t,c,k):(k++,kx(r,t,k,m)),k<=i&&(c=k+1),i<=k&&(m=k-1)}}function kx(r,t,i,c){wE(r,i,c),wE(t,2*i,2*c),wE(t,2*i+1,2*c+1)}function wE(r,t,i){const c=r[t];r[t]=r[i],r[i]=c}function $3(r,t,i,c){const m=r-i,g=t-c;return m*m+g*g}s.$=Wk,s.A=Zu,s.B=tc,s.C=Ki,s.D=jt,s.E=kl,s.F=go,s.G=Dr,s.H=class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return fr(r.expression.evaluate(t))}interpolate(r,t,i){return{x:Hn(r.x,t.x,i),y:Hn(r.y,t.y,i),z:Hn(r.z,t.z,i),azimuthal:Hn(r.azimuthal,t.azimuthal,i),polar:Hn(r.polar,t.polar,i)}}},s.I=YT,s.J=Ii,s.K=$n,s.L=no,s.M=class{constructor(r,t,i,c){this.id=r,this.position=t!=null?new zt(t[0],t[1]):new zt(0,0),this.orientation=i??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new Ko([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(r,t){if(s.a6.multiply(r.matrix,t,r.matrix),r.meshes)for(const i of r.meshes){const c=Ko.applyTransform(i.aabb,r.matrix);this.aabb.encapsulate(c)}if(r.children)for(const i of r.children)this._applyTransformations(i,r.matrix)}computeBoundsAndApplyParent(){const r=s.a6.identity([]);for(const t of this.nodes)this._applyTransformations(t,r)}computeModelMatrix(r,t,i,c,m,g,b=!1){h3(this.matrix,this,r.transform,this.position,t,i,c,m,g,b)}upload(r){if(!this.uploaded){for(const t of this.nodes)cE(t,r);for(const t of this.nodes)mw(t);this.uploaded=!0}}destroy(){for(const r of this.nodes)uE(r)}},s.O=Qt,s.P=Ge,s.Q=Ka,s.R=et,s.S=oa,s.T=oE,s.U=Hn,s.V=Jr,s.W=Ra,s.X=class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return function([i,c]){const m=fr([1,i,c]);return{x:m.x,y:m.y,z:m.z}}(r.expression.evaluate(t))}interpolate(r,t,i){return{x:Hn(r.x,t.x,i),y:Hn(r.y,t.y,i),z:Hn(r.z,t.z,i)}}},s.Y=function(r,t,i=0,c=!0){const m=new Ge(i,i),g=r.sub(m),b=t.add(m),C=[g,new Ge(b.x,g.y),b,new Ge(g.x,b.y)];return c&&C.push(g.clone()),C},s.Z=Ch,s._=function(r,t){const i=[];for(let c=0;c<r.length;c++){const m=sr(c-1,-1,r.length-1),g=sr(c+1,-1,r.length-1),b=r[c],C=r[g],k=r[m].sub(b).unit(),R=C.sub(b).unit(),z=R.angleWithSep(k.x,k.y),V=k.add(R).unit().mult(-1*t/Math.sin(z/2));i.push(b.add(V))}return i},s.a=rs,s.a$=function(r){const t=[];for(const i in r)t.push(r[i]);return t},s.a0=L0,s.a1=function(r,t,i=0){return s.N.fromValues(((t.x-i)*r.scale-r.x)*Jr,(t.y*r.scale-r.y)*Jr,Ro(t.z,t.y))},s.a2=lm,s.a3=uk,s.a4=function(r){let t=1/0,i=1/0,c=-1/0,m=-1/0;for(const g of r)t=Math.min(t,g.x),i=Math.min(i,g.y),c=Math.max(c,g.x),m=Math.max(m,g.y);return{min:new Ge(t,i),max:new Ge(c,m)}},s.a5=Mi,s.a8=Qu,s.a9=ji,s.aA=_s,s.aB=ua,s.aC=wi,s.aD=A_,s.aE=lw,s.aF=function(){Qn.isLoading()||Qn.isLoaded()||io()!=="deferred"||An()},s.aG=Pa,s.aH=ls,s.aI=E3,s.aJ=qr,s.aK=GT,s.aL=ux,s.aM=ss,s.aN=ic,s.aO=C_,s.aP=sg,s.aQ=ev,s.aR=iE,s.aS=function(r,t){const i=oa(t.zoom);if(i===0)return Sc(r);const c=zd(r),m=pm(c),g=Mi(c.getWest())*t.worldSize,b=Mi(c.getEast())*t.worldSize,C=pi(c.getNorth())*t.worldSize,k=pi(c.getSouth())*t.worldSize,R=[g,C,0],z=[b,C,0],V=[g,k,0],q=[b,k,0],Q=s.a6.invert([],t.globeMatrix);return s.N.transformMat4(R,R,Q),s.N.transformMat4(z,z,Q),s.N.transformMat4(V,V,Q),s.N.transformMat4(q,q,Q),m[0]=nh(m[0],V,i),m[1]=nh(m[1],q,i),m[2]=nh(m[2],z,i),m[3]=nh(m[3],R,i),Ko.fromPoints(m)},s.aT=dg,s.aU=Nd,s.aV=nh,s.aW=as,s.aX=j_,s.aY=fn,s.aZ=B3,s.a_=ve,s.aa=Ht,s.ab=Be,s.ac=function(r,t){const i={};for(let c=0;c<t.length;c++){const m=t[c];m in r&&(i[m]=r[m])}return i},s.ad=ir,s.ae=pi,s.af=class{constructor(r){this.entries={},this.scheduler=r}request(r,t,i,c){const m=this.entries[r]=this.entries[r]||{callbacks:[]};if(m.result){const[g,b]=m.result;return this.scheduler?this.scheduler.add(()=>{c(g,b)},t):c(g,b),()=>{}}return m.callbacks.push(c),m.cancel||(m.cancel=i((g,b)=>{m.result=[g,b];for(const C of m.callbacks)this.scheduler?this.scheduler.add(()=>{C(g,b)},t):C(g,b);setTimeout(()=>delete this.entries[r],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(g=>g!==c),m.callbacks.length||(m.cancel(),delete this.entries[r]))}}},s.ag=Co,s.ah=function(r,t,i){const c=JSON.stringify(r.request);return r.data&&(this.deduped.entries[c]={result:[null,r.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},m=>{const g=ve(r.request,(b,C,k,R)=>{b?m(b):C&&m(null,{vectorTile:i?void 0:new UT(new lv(C)),rawData:C,cacheControl:k,expires:R})});return()=>{g.cancel(),m()}},t)},s.ai=function(r){mi++,mi>Kr&&(r.getActor().send("enforceCacheSizeLimit",ur),mi=0)},s.aj=si,s.ak=cr,s.al=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},s.am=Gr,s.an=t3,s.ao=r3,s.ap=e3,s.aq=function(r,t){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(let c=0;c<r.length;c++){const m=document.createElement("source");Le(r[c])||(i.crossOrigin="Anonymous"),m.src=r[c],i.appendChild(m)}return{cancel:()=>{}}},s.ar=uw,s.as=yx,s.at=Ti,s.au=ro,s.av=oc,s.aw=Wa,s.ax=po,s.ay=bo,s.az=kh,s.b=qi,s.b$=Yn,s.b0=function(r,t){const i=[];for(const c in r)c in t||i.push(c);return i},s.b1=Tr,s.b2=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.b3=function(r,t){const{x:i,y:c}=r.point,m=pg(i,c,r.worldSize/r._pixelsPerMercatorPixel,0,0);return s.a6.multiply(m,m,Zy(Sc(t)))},s.b5=ov,s.b6=Nh,s.b7=Zb,s.b8=function(r,t,i,c,m){const g=5*t+2;r.float32[g+0]=i,r.float32[g+1]=c,r.float32[g+2]=m},s.b9=sw,s.bA=pw,s.bB=n3,s.bC=function(r){const t=n3(r,!0);return s.b4.invert([],[t[0],t[1],t[4],t[5]])},s.bD=og,s.bE=function(r){const{x:t,y:i}=r.point,{lng:c,lat:m}=r._center;return pg(t,i,r.worldSize,c,m)},s.bF=Wt,s.bG=We,s.bH=function(r){const t=Math.round((r+45+360)%360/90)%4;return Ar[t]},s.bI=45,s.bJ=Sn,s.bK=x,s.bL=Pd,s.bM=Km,s.bN=ys,s.bO=Ym,s.bP=_,s.bQ=function(r,t,i){const c=Math.sqrt(r*r+t*t+i*i),m=c>0?Math.acos(i/c)*yt:0;let g=r!==0||t!==0?Math.atan2(-t,-r)*yt+90:0;return g<0&&(g+=360),[c,g,m]},s.bR=oi,s.bS=Ko,s.bT=fr,s.bU=function(r){return[Math.pow(r[0],1/2.2),Math.pow(r[1],1/2.2),Math.pow(r[2],1/2.2)]},s.bV=function(r){return r({pluginStatus:Hr,pluginURL:mn}),Jn.on("pluginStateChange",r),r},s.bW=fv,s.bX=gw,s.bY=uv,s.bZ=KT,s.b_=wt,s.ba=Lk,s.bb=wu,s.bc=Vl,s.bd=Uk,s.be=QT,s.bf=XT,s.bg=xE,s.bh=sr,s.bj=Et,s.bk=qe,s.bl=Ci,s.bm=function(r,t,i){r[4*t+0]=i[0],r[4*t+1]=i[1],r[4*t+2]=i[2],r[4*t+3]=i[3]},s.bn=zt,s.bo=Kk,s.bp=Wr,s.bq=Ld,s.br=i3,s.bs=Lr,s.bt=ug,s.bu=function(r,t,i,c,m,g,b,C,k){if(k.name==="globe")return ug(r,t,new Lr(i,c,m),!1);const R=yx({z:i,x:c,y:m},k);return new Ko([(g+R.x/R.scale)*t,t*(R.y/R.scale),b],[(g+R.x2/R.scale)*t,t*(R.y2/R.scale),C])},s.bv=function(r,t,i){let c=0;for(let m=0;m<2;++m){const g=i?i[m]:0;r[m]>g&&(c+=(r[m]-g)*(r[m]-g)),t[m]<g&&(c+=(g-t[m])*(g-t[m]))}return c},s.bw=Vi,s.bx=Pe,s.by=function(r){const t=s.a6.identity(new Float64Array(16));s.a6.multiply(t,r.pixelMatrix,r.globeMatrix);const i=[0,Tt,0],c=[0,Zt,0];return s.N.transformMat4(i,i,t),s.N.transformMat4(c,c,t),[i[0]>0&&i[0]<=r.width&&i[1]>0&&i[1]<=r.height&&!X0(r,new zt(r.center.lat,90)),c[0]>0&&c[0]<=r.width&&c[1]>0&&c[1]<=r.height&&!X0(r,new zt(r.center.lat,-90))]},s.bz=function(r,t){const{scale:i}=r.tileTransform,c=i*Jr/(r.tileSize*Math.pow(2,t.zoom-r.tileID.overscaledZ+r.tileID.canonical.z));return s.b4.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[c,c])},s.c=S3,s.c$=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.c0=X,s.c1=Ir,s.c2=function(r,t,i){return r.type==="custom"?new I6(r,t):new iV[r.type](r,t,i)},s.c3=function(r){const t=r.indexOf(Vc);return t>=0?r.slice(0,t):r},s.c4=function(r){return r.indexOf(Vc)>=0},s.c5=function(r){const t=r.indexOf(Vc);return t>=0?r.slice(t+1):""},s.c6=function(r){const t=[],i=r.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},s.c7=Dt,s.c8=Jn,s.c9=$e,s.cA=pk,s.cB=(r,t,i,c,m,g)=>{const b=r.transform;return{u_matrix:dk(r,t,i,c),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:m,u_image:0,u_tile_units_to_pixels:hk(t,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:g}},s.cC=(r,t,i,c,m,g,b)=>{const C=r.transform,k=C.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:dk(r,t,i,c),u_pixels_to_tile_units:k,u_device_pixel_ratio:g,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:fk(i)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:hk(t,r.transform),u_alpha_discard_threshold:0,u_trim_offset:b,u_emissive_strength:i.paint.get("line-emissive-strength")}},s.cD=Vn,s.cE=mg,s.cF=ik,s.cG=_n,s.cH=Hb,s.cI=xg,s.cJ=450,s.cK=7,s.cL=S6,s.cM=256,s.cN=Zy,s.cO=Id,s.cP=I_,s.cQ=function(r,t,i,c,m){return Ht((r-t)/(i-t)*(m-c)+c,c,m)},s.cR=fi,s.cS=sE,s.cT=[1,1,1],s.cU=nv,s.cV=pv,s.cW=Uc,s.cX=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(r){const t=NM(new Ge(0,0),new Ge(Jr,Jr),r),i=[];for(const c of this._activeRegions){if(c.hiddenByOverlap||!zM(t,c))continue;const m=nF(c.min,c.max,r);i.push({min:m.min,max:m.max,sourceId:this._sourceIds[c.priority],footprint:c.footprint,footprintTileId:c.tileId})}return i}setSources(r){this._setSources(r.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const i=[];for(const c of t.cache.getVisibleCoordinates()){const m=t.cache.getTile(c).buckets[t.layer];if(m)for(const g of m.getNodesInfo()){const b=g.node;b.footprint&&i.push({footprint:b.footprint,id:c.toUnwrapped()})}}return i}})))}_addSource(r){const t=r.getFootprints();if(t.length!==0){for(const i of t){if(!i.footprint)continue;const c=NM(i.footprint.min,i.footprint.max,i.id);this._activeRegions.push({min:c.min,max:c.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:i.id,footprint:i.footprint})}this._sourceIds.push(r.getSourceId())}}_computeReplacement(){this._activeRegions.sort((t,i)=>t.priority-i.priority||Gb(t.min,i.min)||Gb(t.max,i.max));let r=this._activeRegions.length!==this._prevRegions.length;if(!r){let t=0,i=0;for(;!r&&t!==this._activeRegions.length;){const c=this._activeRegions[t],m=this._prevRegions[i];r=c.priority!==m.priority||!LM(c,m),++t,++i}}if(r){++this._updateTime;const t=i=>{const c=this._activeRegions;if(i>=c.length)return i;const m=c[i].priority;for(;i<c.length&&c[i].priority===m;)++i;return i};if(this._sourceIds.length>1){let i=0,c=t(i);for(;i!==c;){let m=i;const g=i;for(;m!==c;){const b=this._activeRegions[m];b.hiddenByOverlap=!1;for(let C=0;C<g;C++){const k=this._activeRegions[C];if(!k.hiddenByOverlap&&zM(b,k)&&(b.hiddenByOverlap=BM(b.footprint,b.tileId,k.footprint,k.tileId),b.hiddenByOverlap))break}++m}i=c,c=t(i)}}}}_setSources(r){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=r.length-1;t>=0;t--)this._addSource(r[t]);this._computeReplacement()}},s.cY=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy()}_fillGridMeshWithLods(r,t){const i=new ic,c=new Wa,m=[],g=r+1+2,b=t[0]+1,C=t[0]+1+(1+t.length),k=(R,z,V)=>{let q=R===g-1?R-2:R===0?R:R-1;return q+=V?24575:0,[q,z]};for(let R=0;R<g;++R)i.emplaceBack(...k(R,0,!0));for(let R=0;R<b;++R)for(let z=0;z<g;++z)i.emplaceBack(...k(z,R,(z===0||z===g-1)&&!0));for(let R=0;R<t.length;++R){const z=t[R];for(let V=0;V<g;++V)i.emplaceBack(...k(V,z,!0))}for(let R=0;R<t.length;++R){const z=c.length,V=t[R]+1+2,q=new Wa;for(let oe=0;oe<V-1;oe++){const pe=oe===V-2,_e=pe?g*(C-t.length+R-oe):g;for(let ze=0;ze<g-1;ze++){const Ue=oe*g+ze;oe===0||pe||ze===0||ze===g-2?(q.emplaceBack(Ue+1,Ue,Ue+_e),q.emplaceBack(Ue+_e,Ue+_e+1,Ue+1)):(c.emplaceBack(Ue+1,Ue,Ue+_e),c.emplaceBack(Ue+_e,Ue+_e+1,Ue+1))}}const Q=ua.simpleSegment(0,z,i.length,c.length-z);for(let oe=0;oe<q.uint16.length;oe+=3)c.emplaceBack(q.uint16[oe],q.uint16[oe+1],q.uint16[oe+2]);const te=ua.simpleSegment(0,z,i.length,c.length-z);m.push({withoutSkirts:Q,withSkirts:te})}return{vertices:i,indices:c,segments:m}}_createGrid(r){const t=this._fillGridMeshWithLods(st,pt);this._gridSegments=t.segments,this._gridBuffer=r.createVertexBuffer(t.vertices,sg.members),this._gridIndexBuffer=r.createIndexBuffer(t.indices,!0)}_createPoles(r){const t=new Wa;for(let b=0;b<=st;b++)t.emplaceBack(0,b+1,b+2);this._poleIndexBuffer=r.createIndexBuffer(t,!0);const i=new Id,c=new Id,m=new Id,g=new Id;this._poleSegments=[];for(let b=0,C=0;b<We;b++){const k=360/(1<<b);i.emplaceBack(0,-Be,0,.5,0),c.emplaceBack(0,-Be,0,.5,1),m.emplaceBack(0,-Be,0,.5,.5),g.emplaceBack(0,-Be,0,.5,.5);for(let R=0;R<=st;R++){let z=R/st,V=0;const q=Hn(0,k,z),[Q,te,oe]=xt(Y0,Rb,q,Be);i.emplaceBack(Q,te,oe,z,V),c.emplaceBack(Q,te,oe,z,1-V);const pe=Et(q);z=.5+.5*Math.sin(pe),V=.5+.5*Math.cos(pe),m.emplaceBack(Q,te,oe,z,V),g.emplaceBack(Q,te,oe,z,1-V)}this._poleSegments.push(ua.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(i,um,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(c,um,!1),this._texturedPoleNorthVertexBuffer=r.createVertexBuffer(m,um,!1),this._texturedPoleSouthVertexBuffer=r.createVertexBuffer(g,um,!1)}getGridBuffers(r,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}},s.cZ=function(r){return xo.has(r)},s.c_=nr,s.ca=o,s.cb=class extends Dh{constructor(r){super(r),this.current=I}set(r,t,i){if(this.fetchUniformLocation(r,t)){for(let c=0;c<9;c++)if(i[c]!==this.current[c]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},s.cc=mt,s.cd=function(r,t,i){const c=oa(i.zoom),m=r.style.map._antialias,g=t.options.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return c===0&&!m&&!g},s.ce=function(r){const t=r.pixelsPerMeter,i=t/Ci(1,r.center.lat),c=s.a6.identity(new Float64Array(16));return s.a6.translate(c,c,[r.point.x,r.point.y,0]),s.a6.scale(c,c,[i,i,t]),Float32Array.from(c)},s.cf=zd,s.cg=function(r){const t=Vi-5;r=Ht(r,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(Et(r))),3);return Math.round(i*(pt.length-1))},s.ch=function(r,t,i,c){const m=t.getNorth(),g=t.getSouth(),b=t.getWest(),C=t.getEast(),k=1<<r.z,R=C-b,z=m-g,V=R/st,q=-z/pt[i],Q=[0,V,0,q,0,0,m,b,0];if(r.z>0){const te=180/c;s.co.multiply(Q,Q,[te/R+1,0,0,0,te/z+1,0,-.5*te/V,.5*te/q,1])}return Q[2]=k,Q[5]=r.x,Q[8]=r.y,Q},s.ci=Sc,s.cj=function(r,t,i){const c=s.a6.identity(new Float64Array(16)),m=(t/(1<<r)-.5)*Math.PI*2;return s.a6.rotateY(c,i.globeMatrix,m),Float32Array.from(c)},s.ck=class{isDataAvailableAtPoint(r){const t=this._source();if(this.isUsingMockSource()||!t||r.y<0||r.y>1)return!1;const i=t.getSource().maxzoom,c=1<<i,m=Math.floor(r.x),g=Math.floor((r.x-m)*c),b=Math.floor(r.y*c),C=this.findDEMTileFor(new Gr(i,m,i,g,b));return!(!C||!C.dem)}getAtPointOrZero(r,t=0){return this.getAtPoint(r,t)||0}getAtPoint(r,t,i=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const c=this._source();if(!c||r.y<0||r.y>1)return t;const m=c.getSource().maxzoom,g=1<<m,b=Math.floor(r.x),C=r.x-b,k=new Gr(m,b,m,Math.floor(C*g),Math.floor(r.y*g)),R=this.findDEMTileFor(k);if(!R||!R.dem)return t;const z=R.dem,V=1<<R.tileID.canonical.z,q=(C*V-R.tileID.canonical.x)*z.dim,Q=(r.y*V-R.tileID.canonical.y)*z.dim,te=Math.floor(q),oe=Math.floor(Q);return(i?this.exaggeration():1)*Hn(Hn(z.get(te,oe),z.get(te,oe+1),Q-oe),Hn(z.get(te+1,oe),z.get(te+1,oe+1),Q-oe),q-te)}getAtTileOffset(r,t,i){const c=1<<r.canonical.z;return this.getAtPointOrZero(new no(r.wrap+(r.canonical.x+t/Jr)/c,(r.canonical.y+i/Jr)/c))}getAtTileOffsetFunc(r,t,i,c){return m=>{const g=this.getAtTileOffset(r,m.x,m.y),b=c.upVector(r.canonical,m.x,m.y),C=c.upVectorScale(r.canonical,t,i).metersToTile;return s.N.scale(b,b,g*C),b}}getForTilePoints(r,t,i,c){if(this.isUsingMockSource())return!1;const m=nv.create(this,r,c);return!!m&&(t.forEach(g=>{g[2]=this.exaggeration()*m.getElevationAt(g[0],g[1],i)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(r);if(!t||!t.dem)return null;const i=t.dem.tree,c=t.tileID,m=1<<r.canonical.z-c.canonical.z;let g=r.canonical.x/m-c.canonical.x,b=r.canonical.y/m-c.canonical.y,C=0;for(let k=0;k<r.canonical.z-c.canonical.z&&!i.leaves[C];k++){g*=2,b*=2;const R=2*Math.floor(b)+Math.floor(g);C=i.childOffsets[C]+R,g%=1,b%=1}return{min:this.exaggeration()*i.minimums[C],max:this.exaggeration()*i.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,t,i){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const r=this.visibleDemTiles;if(r.length===0)return null;let t=!1,i=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const m of r){const g=this.getMinMaxForTile(m.tileID);g&&(i=Math.min(i,g.min),c=Math.max(c,g.max),t=!0)}return t?{min:i,max:c}:null}},s.cl=hm,s.cm=ex,s.cn=function(r,t){return[Math.pow(r[0],2.2)*t,Math.pow(r[1],2.2)*t,Math.pow(r[2],2.2)*t]},s.cp=kb,s.cq=256,s.cr=function(r,t){const i=[0,0,0],c=dg(Sc(t.canonical));return s.N.transformMat4(i,i,c),s.N.transformMat4(i,i,r),i},s.cs=r=>({u_camera_to_center_distance:new ys(r),u_extrude_scale:new D(r),u_device_pixel_ratio:new ys(r),u_matrix:new x(r),u_inv_rot_matrix:new x(r),u_merc_center:new Pd(r),u_tile_id:new Km(r),u_zoom_transition:new ys(r),u_up_dir:new Km(r),u_emissive_strength:new ys(r)}),s.ct=r=>({u_matrix:new x(r),u_pixels_to_tile_units:new D(r),u_device_pixel_ratio:new ys(r),u_units_to_pixels:new Pd(r),u_dash_image:new Ym(r),u_gradient_image:new Ym(r),u_image_height:new ys(r),u_texsize:new Pd(r),u_tile_units_to_pixels:new ys(r),u_alpha_discard_threshold:new ys(r),u_trim_offset:new Pd(r),u_emissive_strength:new ys(r)}),s.cu=r=>({u_matrix:new x(r),u_texsize:new Pd(r),u_pixels_to_tile_units:new D(r),u_device_pixel_ratio:new ys(r),u_image:new Ym(r),u_units_to_pixels:new Pd(r),u_tile_units_to_pixels:new ys(r),u_alpha_discard_threshold:new ys(r),u_trim_offset:new Pd(r)}),s.cv=$f,s.cw=RF,s.cx=DF,s.cy=zh,s.cz=(r,t,i,c,m,g)=>{const b=r.transform,C=b.projection.name==="globe";let k;if(g.paint.get("circle-pitch-alignment")==="map")if(C){const z=kb(b.zoom,t.canonical)*b._pixelsPerMercatorPixel;k=Float32Array.from([z,0,0,z])}else k=b.calculatePixelsToTileUnitsMatrix(i);else k=new Float32Array([b.pixelsToGLUnits[0],0,0,b.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:r.transform.getCameraToCenterDistance(b.projection),u_matrix:r.translatePosMatrix(t.projMatrix,i,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:br.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:Xy,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(C){R.u_inv_rot_matrix=c,R.u_merc_center=m,R.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],R.u_zoom_transition=oa(b.zoom);const z=m[0]*Jr,V=m[1]*Jr;R.u_up_dir=b.projection.upVector(new Lr(0,0,0),z,V)}return R},s.d=bt,s.d0=Xt,s.d1=Ji,s.d2=hr,s.d3=function([r,t,i]){const c=Math.hypot(r,t,i),m=Math.atan2(r,i),g=.5*Math.PI-Math.acos(-t/c);return new zt(Wt(m),Wt(g))},s.d4=tr,s.d5=G,s.d6=X0,s.d7=ih,s.d8=function(r){const t=[0,0,0],i=s.a6.identity(new Float64Array(16));return s.a6.multiply(i,r.pixelMatrix,r.globeMatrix),s.N.transformMat4(t,t,i),new Ge(t[0],t[1])},s.d9=function(r){const t=r.navigator?r.navigator.userAgent:null;return!!function(i){if(rr==null){const c=i.navigator?i.navigator.userAgent:null;rr=!!i.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return rr}(r)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.dA=Ep,s.dB=T3,s.dC=I3,s.dD=lk,s.dE=Pt,s.dF=Nk,s.dG=function(r,t,i,c,m,g,b,C,k,R,z){r.createArrays(),r.tilePixelRatio=Jr/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const V=r.layers[0].layout,q=r.layers[0]._unevaluatedLayout._values,Q={};if(r.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:ze}=r.textSizeData;Q.compositeTextSizes=[q["text-size"].possiblyEvaluate(new $n(_e),C),q["text-size"].possiblyEvaluate(new $n(ze),C)]}if(r.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:ze}=r.iconSizeData;Q.compositeIconSizes=[q["icon-size"].possiblyEvaluate(new $n(_e),C),q["icon-size"].possiblyEvaluate(new $n(ze),C)]}Q.layoutTextSize=q["text-size"].possiblyEvaluate(new $n(k+1),C),Q.layoutIconSize=q["icon-size"].possiblyEvaluate(new $n(k+1),C),Q.textMaxSize=q["text-size"].possiblyEvaluate(new $n(18),C);const te=V.get("text-rotation-alignment")==="map"&&V.get("symbol-placement")!=="point",oe=V.get("text-size");let pe=!1;for(const _e of r.features)if(_e.icon&&_e.icon.nameSecondary){pe=!0;break}for(const _e of r.features){const ze=V.get("text-font").evaluate(_e,{},C).join(","),Ue=oe.evaluate(_e,{},C),Ve=Q.layoutTextSize.evaluate(_e,{},C),nt=(Q.layoutIconSize.evaluate(_e,{},C),{horizontal:{},vertical:void 0}),Qe=_e.text;let gt,At=[0,0];if(Qe){const Ft=Qe.toString(),_r=V.get("text-letter-spacing").evaluate(_e,{},C)*Vl,Pr=V.get("text-line-height").evaluate(_e,{},C)*Vl,dr=ht(Ft)?_r:0,Er=V.get("text-anchor").evaluate(_e,{},C),lr=V.get("text-variable-anchor");if(!lr){const dn=V.get("text-radial-offset").evaluate(_e,{},C);At=dn?Uk(Er,[dn*Vl,JT]):V.get("text-offset").evaluate(_e,{},C).map(jr=>jr*Vl)}let Sr=te?"center":V.get("text-justify").evaluate(_e,{},C);const Yr=V.get("symbol-placement")==="point",kr=Yr?V.get("text-max-width").evaluate(_e,{},C)*Vl:1/0,bn=dn=>{r.allowVerticalPlacement&&ut(Ft)&&(nt.vertical=ZT(Qe,t,i,m,ze,kr,Pr,Er,dn,dr,At,Nh.vertical,!0,Ve,Ue))};if(!te&&lr){const dn=Sr==="auto"?lr.map(ti=>QT(ti)):[Sr];let jr=!1;for(let ti=0;ti<dn.length;ti++){const zn=dn[ti];if(!nt.horizontal[zn])if(jr)nt.horizontal[zn]=nt.horizontal[0];else{const yn=ZT(Qe,t,i,m,ze,kr,Pr,"center",zn,dr,At,Nh.horizontal,!1,Ve,Ue);yn&&(nt.horizontal[zn]=yn,jr=yn.positionedLines.length===1)}}bn("left")}else{if(Sr==="auto"&&(Sr=QT(Er)),Yr||V.get("text-writing-mode").indexOf("horizontal")>=0||!ut(Ft)){const dn=ZT(Qe,t,i,m,ze,kr,Pr,Er,Sr,dr,At,Nh.horizontal,!1,Ve,Ue);dn&&(nt.horizontal[Sr]=dn)}bn(Yr?"left":Sr)}}let Bt=!1;if(_e.icon&&_e.icon.namePrimary){const Ft=c[_e.icon.namePrimary];Ft&&(gt=JF(m[_e.icon.namePrimary],_e.icon.nameSecondary?m[_e.icon.nameSecondary]:void 0,V.get("icon-offset").evaluate(_e,{},C),V.get("icon-anchor").evaluate(_e,{},C)),Bt=Ft.sdf,r.sdfIcons===void 0?r.sdfIcons=Ft.sdf:r.sdfIcons!==Ft.sdf&&Kt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ft.pixelRatio!==r.pixelRatio||V.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Yt=Gk(nt.horizontal)||nt.vertical;r.iconsInText||(r.iconsInText=!!Yt&&Yt.iconsInText),(Yt||gt)&&o6(r,_e,nt,gt,c,Q,Ve,0,At,Bt,b,C,R,z,pe)}g&&r.generateCollisionDebugBuffers(k,r.collisionBoxArray)},s.dH=UT,s.dI=lv,s.dJ=qb,s.dK=ce,s.dL=Ub,s.dM=Vb,s.dN=rt,s.dO=yk,s.dP=function(r){let t=0;if(new Uint32Array(r,0,1)[0]!==g3){const i=new Uint32Array(r,0,7),[,,c,m,g,b]=i;t=i.byteLength+m+g+b+g,(c!==r.byteLength||t>=r.byteLength)&&Kt("Invalid b3dm header information.")}return x3(r,t)},s.dQ=function(r,t){const i=S3(r);for(const c of i){for(const m of c.meshes)J6(m);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(Q6(c.lights,t)))}return i},s.dR=xw,s.dS=d3,s.dT=Qn,s.dU=function(r){Mr(),Vr&&Vr.then(t=>{t.keys().then(i=>{for(let c=0;c<i.length-r;c++)t.delete(i[c])})})},s.da=class{constructor(r,t,i){this._transformRequestFn=r,this._customAccessToken=t,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const r=function(){let t="";for(let i=0;i<10;i++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Rt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,t){return this._transformRequestFn&&this._transformRequestFn(r,t)||{url:r}}normalizeStyleURL(r,t){if(!X(r))return r;const i=Nt(r);return i.params.push(`sdk=js-${L}`),i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeGlyphsURL(r,t){if(!X(r))return r;const i=Nt(r);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeModelURL(r,t){if(!X(r))return r;const i=Nt(r);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||t)}normalizeSourceURL(r,t,i,c){if(!X(r))return r;const m=Nt(r);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),i&&m.params.push(`language=${i}`),c&&m.params.push(`worldview=${c}`),this._makeAPIURL(m,this._customAccessToken||t)}normalizeSpriteURL(r,t,i,c){const m=Nt(r);return X(r)?(m.path=`/styles/v1${m.path}/sprite${t}${i}`,this._makeAPIURL(m,this._customAccessToken||c)):(m.path+=`${t}${i}`,Rr(m))}normalizeTileURL(r,t,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!X(r))return r;const c=Nt(r);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||i&&c.authority!=="raster"&&i===512?"@2x":""}${gi.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${G.RASTER_URL_PREFIX}${c.path}`:c.authority==="rasterarrays"?c.path=`/${G.RASTERARRAYS_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${G.TILE_URL_VERSION}${c.path}`);const m=this._customAccessToken||function(g){for(const b of g){const C=b.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(c.params)||G.ACCESS_TOKEN;return G.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,m)}canonicalizeTileURL(r,t){const i=Nt(r);if(!i.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!i.path.match(/\.[\w]+$/))return r;let c="mapbox://";i.path.match(/^\/raster\/v1\//)?c+=`raster/${i.path.replace(`/${G.RASTER_URL_PREFIX}/`,"")}`:i.path.match(/^\/rasterarrays\/v1\//)?c+=`rasterarrays/${i.path.replace(`/${G.RASTERARRAYS_URL_PREFIX}/`,"")}`:c+=`tiles/${i.path.replace(`/${G.TILE_URL_VERSION}/`,"")}`;let m=i.params;return t&&(m=m.filter(g=>!g.match(/^access_token=/))),m.length&&(c+=`?${m.join("&")}`),c}canonicalizeTileset(r,t){const i=!!t&&X(t),c=[];for(const m of r.tiles||[])H(m)?c.push(this.canonicalizeTileURL(m,i)):c.push(m);return c}_makeAPIURL(r,t){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Nt(G.API_URL);if(r.protocol=c.protocol,r.authority=c.authority,r.protocol==="http"){const m=r.params.indexOf("secure");m>=0&&r.params.splice(m,1)}if(c.path!=="/"&&(r.path=`${c.path}${r.path}`),!G.REQUIRE_ACCESS_TOKEN)return Rr(r);if(t=t||G.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return r.params=r.params.filter(m=>m.indexOf("access_token")===-1),r.params.push(`access_token=${t||""}`),Rr(r)}},s.db=function(r,t){t?xo.add(r):xo.delete(r)},s.dc=gi,s.dd=di,s.de=to,s.df=ar,s.dg=xn,s.dh=function(r){xo.delete(r)},s.di=vo,s.dj=Yi,s.dk=L,s.dl=function(r,t){ur=r,Kr=t},s.dm=function(r,t,i=!1){if(Hr===mr||Hr===wr||Hr===Ur)throw new Error("setRTLTextPlugin cannot be called multiple times.");mn=br.resolveURL(r),Hr=mr,on=t,ni(),i||An()},s.dn=io,s.dp=function(){gw().acquire(hE)},s.dq=function(){const r=Ix;r&&(r.isPreloaded()&&r.numActive()===1?(r.release(hE),Ix=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.dr=Ex,s.ds=function(r){const t=Xn();if(!t)return;const i=t.delete(en);r&&i.catch(r).then(()=>r())},s.dt=Tx,s.du=p3,s.dv=function(r){dE=br.resolveURL(r),gv||(gv=new fv(gw(),new kl)),gv.broadcast("setDracoUrl",dE)},s.dw=f3,s.dx=function(r){mv=br.resolveURL(r),gv||(gv=new fv(gw(),new kl)),gv.broadcast("setMeshoptUrl",mv)},s.dy=re,s.dz=bp,s.e=ln,s.f=br,s.g=function(r,t){return $e(ln(r,{type:"json"}),t)},s.h=Gc,s.i=Du,s.j=Gs,s.k=_u,s.l=function(r){return fetch(r).then(t=>t.arrayBuffer()).then(t=>x3(t,0,r))},s.m=dp,s.n=Js,s.o=rc,s.p=zk,s.q=Ah,s.r=bd,s.s=Hu,s.t=hu,s.u=os,s.v=Aa,s.w=Kt,s.x=Vu,s.z=jl}),w(["./shared"],function(s){function L(rr){const Me=rr?rr.url.toString():void 0;return Me?performance.getEntriesByName(Me):[]}function F(rr){if(typeof rr=="number"||typeof rr=="boolean"||typeof rr=="string"||rr==null)return JSON.stringify(rr);if(Array.isArray(rr)){let qe="[";for(const at of rr)qe+=`${F(at)},`;return`${qe}]`}let Me="{";for(const qe of Object.keys(rr).sort())Me+=`${qe}:${F(rr[qe])},`;return`${Me}}`}function G(rr){let Me="";for(const qe of s.b2)Me+=`/${F(rr[qe])}`;return Me}class H{constructor(Me){this.keyCache={},this._layers={},this._layerConfigs={},Me&&this.replace(Me)}replace(Me,qe){this._layerConfigs={},this._layers={},this.update(Me,[],qe)}update(Me,qe,at){this._options=at;for(const cr of Me)this._layerConfigs[cr.id]=cr,(this._layers[cr.id]=s.c2(cr,this.scope,this._options)).compileFilter(),this.keyCache[cr.id]&&delete this.keyCache[cr.id];for(const cr of qe)delete this.keyCache[cr],delete this._layerConfigs[cr],delete this._layers[cr];this.familiesBySource={};const $t=function(cr,br){const en={};for(let Kr=0;Kr<cr.length;Kr++){const Vr=br&&br[cr[Kr].id]||G(cr[Kr]);br&&(br[cr[Kr].id]=Vr);let cn=en[Vr];cn||(cn=en[Vr]=[]),cn.push(cr[Kr])}const ur=[];for(const Kr in en)ur.push(en[Kr]);return ur}(s.a$(this._layerConfigs),this.keyCache);for(const cr of $t){const br=cr.map(Xn=>this._layers[Xn.id]),en=br[0];if(en.visibility==="none")continue;const ur=en.source||"";let Kr=this.familiesBySource[ur];Kr||(Kr=this.familiesBySource[ur]={});const Vr=en.sourceLayer||"_geojsonTileLayer";let cn=Kr[Vr];cn||(cn=Kr[Vr]=[]),cn.push(br)}}}const X=1*s.dA;class ne{constructor(Me){const qe={},at=[];for(const en in Me){const ur=Me[en],Kr=qe[en]={};for(const Vr in ur.glyphs){const cn=ur.glyphs[+Vr];if(!cn||cn.bitmap.width===0||cn.bitmap.height===0)continue;const Xn=cn.metrics.localGlyph?X:1,Mr={x:0,y:0,w:cn.bitmap.width+2*Xn,h:cn.bitmap.height+2*Xn};at.push(Mr),Kr[Vr]=Mr}}const{w:$t,h:cr}=s.p(at),br=new s.dz({width:$t||1,height:cr||1});for(const en in Me){const ur=Me[en];for(const Kr in ur.glyphs){const Vr=ur.glyphs[+Kr];if(!Vr||Vr.bitmap.width===0||Vr.bitmap.height===0)continue;const cn=qe[en][Kr],Xn=Vr.metrics.localGlyph?X:1;s.dz.copy(Vr.bitmap,br,{x:0,y:0},{x:cn.x+Xn,y:cn.y+Xn},Vr.bitmap)}}this.image=br,this.positions=qe}}s.dy(ne,"GlyphAtlas");class ie{constructor(Me){this.tileID=new s.am(Me.tileID.overscaledZ,Me.tileID.wrap,Me.tileID.canonical.z,Me.tileID.canonical.x,Me.tileID.canonical.y),this.tileZoom=Me.tileZoom,this.uid=Me.uid,this.zoom=Me.zoom,this.canonical=Me.tileID.canonical,this.pixelRatio=Me.pixelRatio,this.tileSize=Me.tileSize,this.source=Me.source,this.scope=Me.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Me.showCollisionBoxes,this.collectResourceTiming=!!Me.collectResourceTiming,this.promoteId=Me.promoteId,this.isSymbolTile=Me.isSymbolTile,this.tileTransform=s.as(Me.tileID.canonical,Me.projection),this.projection=Me.projection,this.brightness=Me.brightness,this.extraShadowCaster=!!Me.extraShadowCaster}parse(Me,qe,at,$t,cr){this.status="parsing",this.data=Me,this.collisionBoxArray=new s.aD;const br=new s.dB(Object.keys(Me.layers).sort()),en=new s.dC(this.tileID,this.promoteId);en.bucketLayerIDs=[];const ur={},Kr=new s.dD(256,256),Vr={featureIndex:en,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Kr,availableImages:at,brightness:this.brightness},cn=qe.familiesBySource[this.source];for(const Xi in cn){const mo=Me.layers[Xi];if(!mo)continue;let eo=!1,Se=!1,Re=!1;for(const it of cn[Xi])it[0].type==="symbol"?eo=!0:Se=!0,it[0].is3D()&&it[0].type!=="model"&&(Re=!0);if(this.extraShadowCaster&&!Re||this.isSymbolTile===!0&&!eo||this.isSymbolTile===!1&&!Se)continue;mo.version===1&&s.w(`Vector tile source "${this.source}" layer "${Xi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Fe=br.encode(Xi),et=[];for(let it=0;it<mo.length;it++){const wt=mo.feature(it),$e=en.getId(wt,Xi);et.push({feature:wt,id:$e,index:it,sourceLayerIndex:Fe})}for(const it of cn[Xi]){const wt=it[0];(!this.extraShadowCaster||wt.is3D()&&wt.type!=="model")&&(this.isSymbolTile!==void 0&&wt.type==="symbol"!==this.isSymbolTile||wt.minzoom&&this.zoom<Math.floor(wt.minzoom)||wt.maxzoom&&this.zoom>=wt.maxzoom||wt.visibility!=="none"&&(se(it,this.zoom,Vr.brightness,at),(ur[wt.id]=wt.createBucket({index:en.bucketLayerIDs.length,layers:it,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Fe,sourceID:this.source,projection:this.projection.spec})).populate(et,Vr,this.tileID.canonical,this.tileTransform),en.bucketLayerIDs.push(it.map($e=>$e.id))))}}let Xn,Mr,Fr,ri;Kr.trim();const mi={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},gi=()=>{if(Xn)return this.status="done",cr(Xn);if(this.extraShadowCaster)this.status="done",cr(null,{buckets:s.a$(ur).filter(Xi=>!Xi.isEmpty()),featureIndex:en,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Vr.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Mr&&Fr&&ri){const Xi=new ne(Mr),mo=new s.dF(Fr,ri);for(const eo in ur){const Se=ur[eo];Se instanceof s.aE?(se(Se.layers,this.zoom,Vr.brightness,at),s.dG(Se,Mr,Xi.positions,Fr,mo.iconPositions,this.showCollisionBoxes,at,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Se.hasPattern&&(Se instanceof s.aK||Se instanceof s.aL||Se instanceof s.cH)&&(se(Se.layers,this.zoom,Vr.brightness,at),Se.addFeatures(Vr,this.tileID.canonical,mo.patternPositions,at,this.tileTransform,this.brightness))}this.status="done",cr(null,{buckets:s.a$(ur).filter(eo=>!eo.isEmpty()),featureIndex:en,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xi.image,lineAtlas:Kr,imageAtlas:mo,brightness:Vr.brightness})}};if(!this.extraShadowCaster){const Xi=s.dE(Vr.glyphDependencies,Se=>Object.keys(Se).map(Number));Object.keys(Xi).length?$t.send("getGlyphs",{uid:this.uid,stacks:Xi,scope:this.scope},(Se,Re)=>{Xn||(Xn=Se,Mr=Re,gi())},void 0,!1,mi):Mr={};const mo=Object.keys(Vr.iconDependencies);mo.length?$t.send("getImages",{icons:mo,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Se,Re)=>{Xn||(Xn=Se,Fr=Re,gi())},void 0,!1,mi):Fr={};const eo=Object.keys(Vr.patternDependencies);eo.length?$t.send("getImages",{icons:eo,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Se,Re)=>{Xn||(Xn=Se,ri=Re,gi())},void 0,!1,mi):ri={}}gi()}}function se(rr,Me,qe,at){const $t=new s.K(Me,{brightness:qe});for(const cr of rr)cr.recalculate($t,at)}class Te extends s.E{constructor(Me,qe,at,$t,cr,br){super(),this.actor=Me,this.layerIndex=qe,this.availableImages=at,this.loadVectorData=cr||s.ah,this.loading={},this.loaded={},this.deduped=new s.af(Me.scheduler),this.isSpriteLoaded=$t,this.scheduler=Me.scheduler,this.brightness=br}loadTile(Me,qe){const at=Me.uid,$t=Me&&Me.request,cr=$t&&$t.collectResourceTiming,br=this.loading[at]=new ie(Me);br.abort=this.loadVectorData(Me,(en,ur)=>{const Kr=!this.loading[at];if(delete this.loading[at],Kr||en||!ur)return br.status="done",Kr||(this.loaded[at]=br),qe(en);const Vr=ur.rawData,cn={};ur.expires&&(cn.expires=ur.expires),ur.cacheControl&&(cn.cacheControl=ur.cacheControl),br.vectorTile=ur.vectorTile||new s.dH(new s.dI(Vr));const Xn=()=>{br.parse(br.vectorTile,this.layerIndex,this.availableImages,this.actor,(Mr,Fr)=>{if(Mr||!Fr)return qe(Mr);const ri={};if(cr){const mi=L($t);mi.length>0&&(ri.resourceTiming=JSON.parse(JSON.stringify(mi)))}qe(null,s.e({rawTileData:Vr.slice(0)},Fr,cn,ri))})};this.isSpriteLoaded?Xn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Xn,{type:"parseTile",isSymbolTile:Me.isSymbolTile,zoom:Me.tileZoom}):Xn()}),this.loaded=this.loaded||{},this.loaded[at]=br})}reloadTile(Me,qe){const at=this.loaded,$t=Me.uid,cr=this;if(at&&at[$t]){const br=at[$t];br.showCollisionBoxes=Me.showCollisionBoxes,br.projection=Me.projection,br.brightness=Me.brightness,br.tileTransform=s.as(Me.tileID.canonical,Me.projection),br.extraShadowCaster=Me.extraShadowCaster;const en=(ur,Kr)=>{const Vr=br.reloadCallback;Vr&&(delete br.reloadCallback,br.parse(br.vectorTile,cr.layerIndex,this.availableImages,cr.actor,Vr)),qe(ur,Kr)};br.status==="parsing"?br.reloadCallback=en:br.status==="done"&&(br.vectorTile?br.parse(br.vectorTile,this.layerIndex,this.availableImages,this.actor,en):en())}else qe(null,void 0)}abortTile(Me,qe){const at=Me.uid,$t=this.loading[at];$t&&($t.abort&&$t.abort(),delete this.loading[at]),qe()}removeTile(Me,qe){const at=this.loaded,$t=Me.uid;at&&at[$t]&&delete at[$t],qe()}}class ue{loadTile(Me,qe){const{uid:at,encoding:$t,rawImageData:cr,padding:br}=Me,en=ImageBitmap&&cr instanceof ImageBitmap?this.getImageData(cr,br):cr;qe(null,new s.dJ(at,en,$t,br<1))}getImageData(Me,qe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Me.width,Me.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Me.width,this.offscreenCanvas.height=Me.height,this.offscreenCanvasContext.drawImage(Me,0,0,Me.width,Me.height);const at=this.offscreenCanvasContext.getImageData(-qe,-qe,Me.width+2*qe,Me.height+2*qe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),at}}class ce{decodeRasterArray({task:Me,buffer:qe},at){s.aZ.performDecoding(qe,Me).then($t=>{at(null,$t)},$t=>{at($t)})}}function de(rr,Me){if(rr.length!==0){Ee(rr[0],Me);for(var qe=1;qe<rr.length;qe++)Ee(rr[qe],!Me)}}function Ee(rr,Me){for(var qe=0,at=0,$t=0,cr=rr.length,br=cr-1;$t<cr;br=$t++){var en=(rr[$t][0]-rr[br][0])*(rr[br][1]+rr[$t][1]),ur=qe+en;at+=Math.abs(qe)>=Math.abs(en)?qe-ur+en:en-ur+qe,qe=ur}qe+at>=0!=!!Me&&rr.reverse()}var Ne=s.dK(function rr(Me,qe){var at,$t=Me&&Me.type;if($t==="FeatureCollection")for(at=0;at<Me.features.length;at++)rr(Me.features[at],qe);else if($t==="GeometryCollection")for(at=0;at<Me.geometries.length;at++)rr(Me.geometries[at],qe);else if($t==="Feature")rr(Me.geometry,qe);else if($t==="Polygon")de(Me.coordinates,qe);else if($t==="MultiPolygon")for(at=0;at<Me.coordinates.length;at++)de(Me.coordinates[at],qe);return Me});const rt=s.dL.prototype.toGeoJSON;let tt=class{constructor(rr){this._feature=rr,this.extent=s.V,this.type=rr.type,this.properties=rr.tags,"id"in rr&&!isNaN(rr.id)&&(this.id=parseInt(rr.id,10))}loadGeometry(){if(this._feature.type===1){const rr=[];for(const Me of this._feature.geometry)rr.push([new s.P(Me[0],Me[1])]);return rr}{const rr=[];for(const Me of this._feature.geometry){const qe=[];for(const at of Me)qe.push(new s.P(at[0],at[1]));rr.push(qe)}return rr}}toGeoJSON(rr,Me,qe){return rt.call(this,rr,Me,qe)}},Ge=class{constructor(rr){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.V,this.length=rr.length,this._features=rr}feature(rr){return new tt(this._features[rr])}};var _t={exports:{}},yt=s.dN,Et=s.dM.VectorTileFeature,Wt=Ar;function Ar(rr,Me){this.options=Me||{},this.features=rr,this.length=rr.length}function mt(rr,Me){this.id=typeof rr.id=="number"?rr.id:void 0,this.type=rr.type,this.rawGeometry=rr.type===1?[rr.geometry]:rr.geometry,this.properties=rr.tags,this.extent=Me||4096}Ar.prototype.feature=function(rr){return new mt(this.features[rr],this.options.extent)},mt.prototype.loadGeometry=function(){var rr=this.rawGeometry;this.geometry=[];for(var Me=0;Me<rr.length;Me++){for(var qe=rr[Me],at=[],$t=0;$t<qe.length;$t++)at.push(new yt(qe[$t][0],qe[$t][1]));this.geometry.push(at)}return this.geometry},mt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var rr=this.geometry,Me=1/0,qe=-1/0,at=1/0,$t=-1/0,cr=0;cr<rr.length;cr++)for(var br=rr[cr],en=0;en<br.length;en++){var ur=br[en];Me=Math.min(Me,ur.x),qe=Math.max(qe,ur.x),at=Math.min(at,ur.y),$t=Math.max($t,ur.y)}return[Me,at,qe,$t]},mt.prototype.toGeoJSON=Et.prototype.toGeoJSON;var nr=s.dO,Xt=Wt;function Ht(rr){var Me=new nr;return function(qe,at){for(var $t in qe.layers)at.writeMessage(3,Qt,qe.layers[$t])}(rr,Me),Me.finish()}function Qt(rr,Me){var qe;Me.writeVarintField(15,rr.version||1),Me.writeStringField(1,rr.name||""),Me.writeVarintField(5,rr.extent||4096);var at={keys:[],values:[],keycache:{},valuecache:{}};for(qe=0;qe<rr.length;qe++)at.feature=rr.feature(qe),Me.writeMessage(2,sr,at);var $t=at.keys;for(qe=0;qe<$t.length;qe++)Me.writeStringField(3,$t[qe]);var cr=at.values;for(qe=0;qe<cr.length;qe++)Me.writeMessage(4,hi,cr[qe])}function sr(rr,Me){var qe=rr.feature;qe.id!==void 0&&Me.writeVarintField(1,qe.id),Me.writeMessage(2,Tr,rr),Me.writeVarintField(3,qe.type),Me.writeMessage(4,wi,qe)}function Tr(rr,Me){var qe=rr.feature,at=rr.keys,$t=rr.values,cr=rr.keycache,br=rr.valuecache;for(var en in qe.properties){var ur=qe.properties[en],Kr=cr[en];if(ur!==null){Kr===void 0&&(at.push(en),cr[en]=Kr=at.length-1),Me.writeVarint(Kr);var Vr=typeof ur;Vr!=="string"&&Vr!=="boolean"&&Vr!=="number"&&(ur=JSON.stringify(ur));var cn=Vr+":"+ur,Xn=br[cn];Xn===void 0&&($t.push(ur),br[cn]=Xn=$t.length-1),Me.writeVarint(Xn)}}}function ln(rr,Me){return(Me<<3)+(7&rr)}function vn(rr){return rr<<1^rr>>31}function wi(rr,Me){for(var qe=rr.loadGeometry(),at=rr.type,$t=0,cr=0,br=qe.length,en=0;en<br;en++){var ur=qe[en],Kr=1;at===1&&(Kr=ur.length),Me.writeVarint(ln(1,Kr));for(var Vr=at===3?ur.length-1:ur.length,cn=0;cn<Vr;cn++){cn===1&&at!==1&&Me.writeVarint(ln(2,Vr-1));var Xn=ur[cn].x-$t,Mr=ur[cn].y-cr;Me.writeVarint(vn(Xn)),Me.writeVarint(vn(Mr)),$t+=Xn,cr+=Mr}at===3&&Me.writeVarint(ln(7,1))}}function hi(rr,Me){var qe=typeof rr;qe==="string"?Me.writeStringField(1,rr):qe==="boolean"?Me.writeBooleanField(7,rr):qe==="number"&&(rr%1!=0?Me.writeDoubleField(3,rr):rr<0?Me.writeSVarintField(6,rr):Me.writeVarintField(5,rr))}_t.exports=Ht,_t.exports.fromVectorTileJs=Ht,_t.exports.fromGeojsonVt=function(rr,Me){Me=Me||{};var qe={};for(var at in rr)qe[at]=new Xt(rr[at].features,Me),qe[at].name=at,qe[at].version=Me.version,qe[at].extent=Me.extent;return Ht({layers:qe})},_t.exports.GeoJSONWrapper=Xt;var Vn=s.dK(_t.exports);const Oi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:rr=>rr},fn=Math.fround||(Nn=new Float32Array(1),rr=>(Nn[0]=+rr,Nn[0]));var Nn;const Pt=3,Dt=5,Ir=6;class xr{constructor(Me){this.options=Object.assign(Object.create(Oi),Me),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Me){const{log:qe,minZoom:at,maxZoom:$t}=this.options;qe&&console.time("total time");const cr=`prepare ${Me.length} points`;qe&&console.time(cr),this.points=Me;const br=[];for(let ur=0;ur<Me.length;ur++){const Kr=Me[ur];if(!Kr.geometry)continue;const[Vr,cn]=Kr.geometry.coordinates,Xn=fn(gn(Vr)),Mr=fn(fr(cn));br.push(Xn,Mr,1/0,ur,-1,1),this.options.reduce&&br.push(0)}let en=this.trees[$t+1]=this._createTree(br);qe&&console.timeEnd(cr);for(let ur=$t;ur>=at;ur--){const Kr=+Date.now();en=this.trees[ur]=this._createTree(this._cluster(en,ur)),qe&&console.log("z%d: %d clusters in %dms",ur,en.numItems,+Date.now()-Kr)}return qe&&console.timeEnd("total time"),this}getClusters(Me,qe){let at=((Me[0]+180)%360+360)%360-180;const $t=Math.max(-90,Math.min(90,Me[1]));let cr=Me[2]===180?180:((Me[2]+180)%360+360)%360-180;const br=Math.max(-90,Math.min(90,Me[3]));if(Me[2]-Me[0]>=360)at=-180,cr=180;else if(at>cr){const cn=this.getClusters([at,$t,180,br],qe),Xn=this.getClusters([-180,$t,cr,br],qe);return cn.concat(Xn)}const en=this.trees[this._limitZoom(qe)],ur=en.range(gn(at),fr(br),gn(cr),fr($t)),Kr=en.data,Vr=[];for(const cn of ur){const Xn=this.stride*cn;Vr.push(Kr[Xn+Dt]>1?Kt(Kr,Xn,this.clusterProps):this.points[Kr[Xn+Pt]])}return Vr}getChildren(Me){const qe=this._getOriginId(Me),at=this._getOriginZoom(Me),$t="No cluster with the specified id.",cr=this.trees[at];if(!cr)throw new Error($t);const br=cr.data;if(qe*this.stride>=br.length)throw new Error($t);const en=this.options.radius/(this.options.extent*Math.pow(2,at-1)),ur=cr.within(br[qe*this.stride],br[qe*this.stride+1],en),Kr=[];for(const Vr of ur){const cn=Vr*this.stride;br[cn+4]===Me&&Kr.push(br[cn+Dt]>1?Kt(br,cn,this.clusterProps):this.points[br[cn+Pt]])}if(Kr.length===0)throw new Error($t);return Kr}getLeaves(Me,qe,at){const $t=[];return this._appendLeaves($t,Me,qe=qe||10,at=at||0,0),$t}getTile(Me,qe,at){const $t=this.trees[this._limitZoom(Me)],cr=Math.pow(2,Me),{extent:br,radius:en}=this.options,ur=en/br,Kr=(at-ur)/cr,Vr=(at+1+ur)/cr,cn={features:[]};return this._addTileFeatures($t.range((qe-ur)/cr,Kr,(qe+1+ur)/cr,Vr),$t.data,qe,at,cr,cn),qe===0&&this._addTileFeatures($t.range(1-ur/cr,Kr,1,Vr),$t.data,cr,at,cr,cn),qe===cr-1&&this._addTileFeatures($t.range(0,Kr,ur/cr,Vr),$t.data,-1,at,cr,cn),cn.features.length?cn:null}getClusterExpansionZoom(Me){let qe=this._getOriginZoom(Me)-1;for(;qe<=this.options.maxZoom;){const at=this.getChildren(Me);if(qe++,at.length!==1)break;Me=at[0].properties.cluster_id}return qe}_appendLeaves(Me,qe,at,$t,cr){const br=this.getChildren(qe);for(const en of br){const ur=en.properties;if(ur&&ur.cluster?cr+ur.point_count<=$t?cr+=ur.point_count:cr=this._appendLeaves(Me,ur.cluster_id,at,$t,cr):cr<$t?cr++:Me.push(en),Me.length===at)break}return cr}_createTree(Me){const qe=new s.bg(Me.length/this.stride|0,this.options.nodeSize,Float32Array);for(let at=0;at<Me.length;at+=this.stride)qe.add(Me[at],Me[at+1]);return qe.finish(),qe.data=Me,qe}_addTileFeatures(Me,qe,at,$t,cr,br){for(const en of Me){const ur=en*this.stride,Kr=qe[ur+Dt]>1;let Vr,cn,Xn;if(Kr)Vr=Cn(qe,ur,this.clusterProps),cn=qe[ur],Xn=qe[ur+1];else{const ri=this.points[qe[ur+Pt]];Vr=ri.properties;const[mi,gi]=ri.geometry.coordinates;cn=gn(mi),Xn=fr(gi)}const Mr={type:1,geometry:[[Math.round(this.options.extent*(cn*cr-at)),Math.round(this.options.extent*(Xn*cr-$t))]],tags:Vr};let Fr;Fr=Kr||this.options.generateId?qe[ur+Pt]:this.points[qe[ur+Pt]].id,Fr!==void 0&&(Mr.id=Fr),br.features.push(Mr)}}_limitZoom(Me){return Math.max(this.options.minZoom,Math.min(Math.floor(+Me),this.options.maxZoom+1))}_cluster(Me,qe){const{radius:at,extent:$t,reduce:cr,minPoints:br}=this.options,en=at/($t*Math.pow(2,qe)),ur=Me.data,Kr=[],Vr=this.stride;for(let cn=0;cn<ur.length;cn+=Vr){if(ur[cn+2]<=qe)continue;ur[cn+2]=qe;const Xn=ur[cn],Mr=ur[cn+1],Fr=Me.within(ur[cn],ur[cn+1],en),ri=ur[cn+Dt];let mi=ri;for(const gi of Fr){const Xi=gi*Vr;ur[Xi+2]>qe&&(mi+=ur[Xi+Dt])}if(mi>ri&&mi>=br){let gi,Xi=Xn*ri,mo=Mr*ri,eo=-1;const Se=(cn/Vr<<5)+(qe+1)+this.points.length;for(const Re of Fr){const Fe=Re*Vr;if(ur[Fe+2]<=qe)continue;ur[Fe+2]=qe;const et=ur[Fe+Dt];Xi+=ur[Fe]*et,mo+=ur[Fe+1]*et,ur[Fe+4]=Se,cr&&(gi||(gi=this._map(ur,cn,!0),eo=this.clusterProps.length,this.clusterProps.push(gi)),cr(gi,this._map(ur,Fe)))}ur[cn+4]=Se,Kr.push(Xi/mi,mo/mi,1/0,Se,-1,mi),cr&&Kr.push(eo)}else{for(let gi=0;gi<Vr;gi++)Kr.push(ur[cn+gi]);if(mi>1)for(const gi of Fr){const Xi=gi*Vr;if(!(ur[Xi+2]<=qe)){ur[Xi+2]=qe;for(let mo=0;mo<Vr;mo++)Kr.push(ur[Xi+mo])}}}}return Kr}_getOriginId(Me){return Me-this.points.length>>5}_getOriginZoom(Me){return(Me-this.points.length)%32}_map(Me,qe,at){if(Me[qe+Dt]>1){const br=this.clusterProps[Me[qe+Ir]];return at?Object.assign({},br):br}const $t=this.points[Me[qe+Pt]].properties,cr=this.options.map($t);return at&&cr===$t?Object.assign({},cr):cr}}function Kt(rr,Me,qe){return{type:"Feature",id:rr[Me+Pt],properties:Cn(rr,Me,qe),geometry:{type:"Point",coordinates:[(at=rr[Me],360*(at-.5)),Zr(rr[Me+1])]}};var at}function Cn(rr,Me,qe){const at=rr[Me+Dt],$t=at>=1e4?`${Math.round(at/1e3)}k`:at>=1e3?Math.round(at/100)/10+"k":at,cr=rr[Me+Ir],br=cr===-1?{}:Object.assign({},qe[cr]);return Object.assign(br,{cluster:!0,cluster_id:rr[Me+Pt],point_count:at,point_count_abbreviated:$t})}function gn(rr){return rr/360+.5}function fr(rr){const Me=Math.sin(rr*Math.PI/180),qe=.5-.25*Math.log((1+Me)/(1-Me))/Math.PI;return qe<0?0:qe>1?1:qe}function Zr(rr){const Me=(180-360*rr)*Math.PI/180;return 360*Math.atan(Math.exp(Me))/Math.PI-90}var qr={exports:{}};qr.exports=function(){function rr($e,ve,Le,ot){for(var Mt,Ot=ot,bt=Le-ve>>1,Rt=Le-ve,ar=$e[ve],qt=$e[ve+1],Nt=$e[Le],Rr=$e[Le+1],er=ve+3;er<Le;er+=3){var Nr=Me($e[er],$e[er+1],ar,qt,Nt,Rr);if(Nr>Ot)Mt=er,Ot=Nr;else if(Nr===Ot){var Ln=Math.abs(er-bt);Ln<Rt&&(Mt=er,Rt=Ln)}}Ot>ot&&(Mt-ve>3&&rr($e,ve,Mt,ot),$e[Mt+2]=Ot,Le-Mt>3&&rr($e,Mt,Le,ot))}function Me($e,ve,Le,ot,Mt,Ot){var bt=Mt-Le,Rt=Ot-ot;if(bt!==0||Rt!==0){var ar=(($e-Le)*bt+(ve-ot)*Rt)/(bt*bt+Rt*Rt);ar>1?(Le=Mt,ot=Ot):ar>0&&(Le+=bt*ar,ot+=Rt*ar)}return(bt=$e-Le)*bt+(Rt=ve-ot)*Rt}function qe($e,ve,Le,ot){var Mt={id:$e===void 0?null:$e,type:ve,geometry:Le,tags:ot,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ot){var bt=Ot.geometry,Rt=Ot.type;if(Rt==="Point"||Rt==="MultiPoint"||Rt==="LineString")at(Ot,bt);else if(Rt==="Polygon"||Rt==="MultiLineString")for(var ar=0;ar<bt.length;ar++)at(Ot,bt[ar]);else if(Rt==="MultiPolygon")for(ar=0;ar<bt.length;ar++)for(var qt=0;qt<bt[ar].length;qt++)at(Ot,bt[ar][qt])}(Mt),Mt}function at($e,ve){for(var Le=0;Le<ve.length;Le+=3)$e.minX=Math.min($e.minX,ve[Le]),$e.minY=Math.min($e.minY,ve[Le+1]),$e.maxX=Math.max($e.maxX,ve[Le]),$e.maxY=Math.max($e.maxY,ve[Le+1])}function $t($e,ve,Le,ot){if(ve.geometry){var Mt=ve.geometry.coordinates,Ot=ve.geometry.type,bt=Math.pow(Le.tolerance/((1<<Le.maxZoom)*Le.extent),2),Rt=[],ar=ve.id;if(Le.promoteId?ar=ve.properties[Le.promoteId]:Le.generateId&&(ar=ot||0),Ot==="Point")cr(Mt,Rt);else if(Ot==="MultiPoint")for(var qt=0;qt<Mt.length;qt++)cr(Mt[qt],Rt);else if(Ot==="LineString")br(Mt,Rt,bt,!1);else if(Ot==="MultiLineString"){if(Le.lineMetrics){for(qt=0;qt<Mt.length;qt++)br(Mt[qt],Rt=[],bt,!1),$e.push(qe(ar,"LineString",Rt,ve.properties));return}en(Mt,Rt,bt,!1)}else if(Ot==="Polygon")en(Mt,Rt,bt,!0);else{if(Ot!=="MultiPolygon"){if(Ot==="GeometryCollection"){for(qt=0;qt<ve.geometry.geometries.length;qt++)$t($e,{id:ar,geometry:ve.geometry.geometries[qt],properties:ve.properties},Le,ot);return}throw new Error("Input data is not a valid GeoJSON object.")}for(qt=0;qt<Mt.length;qt++){var Nt=[];en(Mt[qt],Nt,bt,!0),Rt.push(Nt)}}$e.push(qe(ar,Ot,Rt,ve.properties))}}function cr($e,ve){ve.push(ur($e[0])),ve.push(Kr($e[1])),ve.push(0)}function br($e,ve,Le,ot){for(var Mt,Ot,bt=0,Rt=0;Rt<$e.length;Rt++){var ar=ur($e[Rt][0]),qt=Kr($e[Rt][1]);ve.push(ar),ve.push(qt),ve.push(0),Rt>0&&(bt+=ot?(Mt*qt-ar*Ot)/2:Math.sqrt(Math.pow(ar-Mt,2)+Math.pow(qt-Ot,2))),Mt=ar,Ot=qt}var Nt=ve.length-3;ve[2]=1,rr(ve,0,Nt,Le),ve[Nt+2]=1,ve.size=Math.abs(bt),ve.start=0,ve.end=ve.size}function en($e,ve,Le,ot){for(var Mt=0;Mt<$e.length;Mt++){var Ot=[];br($e[Mt],Ot,Le,ot),ve.push(Ot)}}function ur($e){return $e/360+.5}function Kr($e){var ve=Math.sin($e*Math.PI/180),Le=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return Le<0?0:Le>1?1:Le}function Vr($e,ve,Le,ot,Mt,Ot,bt,Rt){if(ot/=ve,Ot>=(Le/=ve)&&bt<ot)return $e;if(bt<Le||Ot>=ot)return null;for(var ar=[],qt=0;qt<$e.length;qt++){var Nt=$e[qt],Rr=Nt.geometry,er=Nt.type,Nr=Mt===0?Nt.minX:Nt.minY,Ln=Mt===0?Nt.maxX:Nt.maxY;if(Nr>=Le&&Ln<ot)ar.push(Nt);else if(!(Ln<Le||Nr>=ot)){var $r=[];if(er==="Point"||er==="MultiPoint")cn(Rr,$r,Le,ot,Mt);else if(er==="LineString")Xn(Rr,$r,Le,ot,Mt,!1,Rt.lineMetrics);else if(er==="MultiLineString")Fr(Rr,$r,Le,ot,Mt,!1);else if(er==="Polygon")Fr(Rr,$r,Le,ot,Mt,!0);else if(er==="MultiPolygon")for(var si=0;si<Rr.length;si++){var Yi=[];Fr(Rr[si],Yi,Le,ot,Mt,!0),Yi.length&&$r.push(Yi)}if($r.length){if(Rt.lineMetrics&&er==="LineString"){for(si=0;si<$r.length;si++)ar.push(qe(Nt.id,er,$r[si],Nt.tags));continue}er!=="LineString"&&er!=="MultiLineString"||($r.length===1?(er="LineString",$r=$r[0]):er="MultiLineString"),er!=="Point"&&er!=="MultiPoint"||(er=$r.length===3?"Point":"MultiPoint"),ar.push(qe(Nt.id,er,$r,Nt.tags))}}}return ar.length?ar:null}function cn($e,ve,Le,ot,Mt){for(var Ot=0;Ot<$e.length;Ot+=3){var bt=$e[Ot+Mt];bt>=Le&&bt<=ot&&(ve.push($e[Ot]),ve.push($e[Ot+1]),ve.push($e[Ot+2]))}}function Xn($e,ve,Le,ot,Mt,Ot,bt){for(var Rt,ar,qt=Mr($e),Nt=Mt===0?mi:gi,Rr=$e.start,er=0;er<$e.length-3;er+=3){var Nr=$e[er],Ln=$e[er+1],$r=$e[er+2],si=$e[er+3],Yi=$e[er+4],xn=Mt===0?Nr:Ln,$i=Mt===0?si:Yi,di=!1;bt&&(Rt=Math.sqrt(Math.pow(Nr-si,2)+Math.pow(Ln-Yi,2))),xn<Le?$i>Le&&(ar=Nt(qt,Nr,Ln,si,Yi,Le),bt&&(qt.start=Rr+Rt*ar)):xn>ot?$i<ot&&(ar=Nt(qt,Nr,Ln,si,Yi,ot),bt&&(qt.start=Rr+Rt*ar)):ri(qt,Nr,Ln,$r),$i<Le&&xn>=Le&&(ar=Nt(qt,Nr,Ln,si,Yi,Le),di=!0),$i>ot&&xn<=ot&&(ar=Nt(qt,Nr,Ln,si,Yi,ot),di=!0),!Ot&&di&&(bt&&(qt.end=Rr+Rt*ar),ve.push(qt),qt=Mr($e)),bt&&(Rr+=Rt)}var vo=$e.length-3;Nr=$e[vo],Ln=$e[vo+1],$r=$e[vo+2],(xn=Mt===0?Nr:Ln)>=Le&&xn<=ot&&ri(qt,Nr,Ln,$r),vo=qt.length-3,Ot&&vo>=3&&(qt[vo]!==qt[0]||qt[vo+1]!==qt[1])&&ri(qt,qt[0],qt[1],qt[2]),qt.length&&ve.push(qt)}function Mr($e){var ve=[];return ve.size=$e.size,ve.start=$e.start,ve.end=$e.end,ve}function Fr($e,ve,Le,ot,Mt,Ot){for(var bt=0;bt<$e.length;bt++)Xn($e[bt],ve,Le,ot,Mt,Ot,!1)}function ri($e,ve,Le,ot){$e.push(ve),$e.push(Le),$e.push(ot)}function mi($e,ve,Le,ot,Mt,Ot){var bt=(Ot-ve)/(ot-ve);return $e.push(Ot),$e.push(Le+(Mt-Le)*bt),$e.push(1),bt}function gi($e,ve,Le,ot,Mt,Ot){var bt=(Ot-Le)/(Mt-Le);return $e.push(ve+(ot-ve)*bt),$e.push(Ot),$e.push(1),bt}function Xi($e,ve){for(var Le=[],ot=0;ot<$e.length;ot++){var Mt,Ot=$e[ot],bt=Ot.type;if(bt==="Point"||bt==="MultiPoint"||bt==="LineString")Mt=mo(Ot.geometry,ve);else if(bt==="MultiLineString"||bt==="Polygon"){Mt=[];for(var Rt=0;Rt<Ot.geometry.length;Rt++)Mt.push(mo(Ot.geometry[Rt],ve))}else if(bt==="MultiPolygon")for(Mt=[],Rt=0;Rt<Ot.geometry.length;Rt++){for(var ar=[],qt=0;qt<Ot.geometry[Rt].length;qt++)ar.push(mo(Ot.geometry[Rt][qt],ve));Mt.push(ar)}Le.push(qe(Ot.id,bt,Mt,Ot.tags))}return Le}function mo($e,ve){var Le=[];Le.size=$e.size,$e.start!==void 0&&(Le.start=$e.start,Le.end=$e.end);for(var ot=0;ot<$e.length;ot+=3)Le.push($e[ot]+ve,$e[ot+1],$e[ot+2]);return Le}function eo($e,ve){if($e.transformed)return $e;var Le,ot,Mt,Ot=1<<$e.z,bt=$e.x,Rt=$e.y;for(Le=0;Le<$e.features.length;Le++){var ar=$e.features[Le],qt=ar.geometry,Nt=ar.type;if(ar.geometry=[],Nt===1)for(ot=0;ot<qt.length;ot+=2)ar.geometry.push(Se(qt[ot],qt[ot+1],ve,Ot,bt,Rt));else for(ot=0;ot<qt.length;ot++){var Rr=[];for(Mt=0;Mt<qt[ot].length;Mt+=2)Rr.push(Se(qt[ot][Mt],qt[ot][Mt+1],ve,Ot,bt,Rt));ar.geometry.push(Rr)}}return $e.transformed=!0,$e}function Se($e,ve,Le,ot,Mt,Ot){return[Math.round(Le*($e*ot-Mt)),Math.round(Le*(ve*ot-Ot))]}function Re($e,ve,Le,ot,Mt){for(var Ot=ve===Mt.maxZoom?0:Mt.tolerance/((1<<ve)*Mt.extent),bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Le,y:ot,z:ve,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Rt=0;Rt<$e.length;Rt++){bt.numFeatures++,Fe(bt,$e[Rt],Ot,Mt);var ar=$e[Rt].minX,qt=$e[Rt].minY,Nt=$e[Rt].maxX,Rr=$e[Rt].maxY;ar<bt.minX&&(bt.minX=ar),qt<bt.minY&&(bt.minY=qt),Nt>bt.maxX&&(bt.maxX=Nt),Rr>bt.maxY&&(bt.maxY=Rr)}return bt}function Fe($e,ve,Le,ot){var Mt=ve.geometry,Ot=ve.type,bt=[];if(Ot==="Point"||Ot==="MultiPoint")for(var Rt=0;Rt<Mt.length;Rt+=3)bt.push(Mt[Rt]),bt.push(Mt[Rt+1]),$e.numPoints++,$e.numSimplified++;else if(Ot==="LineString")et(bt,Mt,$e,Le,!1,!1);else if(Ot==="MultiLineString"||Ot==="Polygon")for(Rt=0;Rt<Mt.length;Rt++)et(bt,Mt[Rt],$e,Le,Ot==="Polygon",Rt===0);else if(Ot==="MultiPolygon")for(var ar=0;ar<Mt.length;ar++){var qt=Mt[ar];for(Rt=0;Rt<qt.length;Rt++)et(bt,qt[Rt],$e,Le,!0,Rt===0)}if(bt.length){var Nt=ve.tags||null;if(Ot==="LineString"&&ot.lineMetrics){for(var Rr in Nt={},ve.tags)Nt[Rr]=ve.tags[Rr];Nt.mapbox_clip_start=Mt.start/Mt.size,Nt.mapbox_clip_end=Mt.end/Mt.size}var er={geometry:bt,type:Ot==="Polygon"||Ot==="MultiPolygon"?3:Ot==="LineString"||Ot==="MultiLineString"?2:1,tags:Nt};ve.id!==null&&(er.id=ve.id),$e.features.push(er)}}function et($e,ve,Le,ot,Mt,Ot){var bt=ot*ot;if(ot>0&&ve.size<(Mt?bt:ot))Le.numPoints+=ve.length/3;else{for(var Rt=[],ar=0;ar<ve.length;ar+=3)(ot===0||ve[ar+2]>bt)&&(Le.numSimplified++,Rt.push(ve[ar]),Rt.push(ve[ar+1])),Le.numPoints++;Mt&&function(qt,Nt){for(var Rr=0,er=0,Nr=qt.length,Ln=Nr-2;er<Nr;Ln=er,er+=2)Rr+=(qt[er]-qt[Ln])*(qt[er+1]+qt[Ln+1]);if(Rr>0===Nt)for(er=0,Nr=qt.length;er<Nr/2;er+=2){var $r=qt[er],si=qt[er+1];qt[er]=qt[Nr-2-er],qt[er+1]=qt[Nr-1-er],qt[Nr-2-er]=$r,qt[Nr-1-er]=si}}(Rt,Ot),$e.push(Rt)}}function it($e,ve){var Le=(ve=this.options=function(Mt,Ot){for(var bt in Ot)Mt[bt]=Ot[bt];return Mt}(Object.create(this.options),ve)).debug;if(Le&&console.time("preprocess data"),ve.maxZoom<0||ve.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ve.promoteId&&ve.generateId)throw new Error("promoteId and generateId cannot be used together.");var ot=function(Mt,Ot){var bt=[];if(Mt.type==="FeatureCollection")for(var Rt=0;Rt<Mt.features.length;Rt++)$t(bt,Mt.features[Rt],Ot,Rt);else $t(bt,Mt.type==="Feature"?Mt:{geometry:Mt},Ot);return bt}($e,ve);this.tiles={},this.tileCoords=[],Le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ve.indexMaxZoom,ve.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ot=function(Mt,Ot){var bt=Ot.buffer/Ot.extent,Rt=Mt,ar=Vr(Mt,1,-1-bt,bt,0,-1,2,Ot),qt=Vr(Mt,1,1-bt,2+bt,0,-1,2,Ot);return(ar||qt)&&(Rt=Vr(Mt,1,-bt,1+bt,0,-1,2,Ot)||[],ar&&(Rt=Xi(ar,1).concat(Rt)),qt&&(Rt=Rt.concat(Xi(qt,-1)))),Rt}(ot,ve)).length&&this.splitTile(ot,0,0,0),Le&&(ot.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wt($e,ve,Le){return 32*((1<<$e)*Le+ve)+$e}return it.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},it.prototype.splitTile=function($e,ve,Le,ot,Mt,Ot,bt){for(var Rt=[$e,ve,Le,ot],ar=this.options,qt=ar.debug;Rt.length;){ot=Rt.pop(),Le=Rt.pop(),ve=Rt.pop(),$e=Rt.pop();var Nt=1<<ve,Rr=wt(ve,Le,ot),er=this.tiles[Rr];if(!er&&(qt>1&&console.time("creation"),er=this.tiles[Rr]=Re($e,ve,Le,ot,ar),this.tileCoords.push({z:ve,x:Le,y:ot}),qt)){qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ve,Le,ot,er.numFeatures,er.numPoints,er.numSimplified),console.timeEnd("creation"));var Nr="z"+ve;this.stats[Nr]=(this.stats[Nr]||0)+1,this.total++}if(er.source=$e,Mt){if(ve===ar.maxZoom||ve===Mt)continue;var Ln=1<<Mt-ve;if(Le!==Math.floor(Ot/Ln)||ot!==Math.floor(bt/Ln))continue}else if(ve===ar.indexMaxZoom||er.numPoints<=ar.indexMaxPoints)continue;if(er.source=null,$e.length!==0){qt>1&&console.time("clipping");var $r,si,Yi,xn,$i,di,vo=.5*ar.buffer/ar.extent,to=.5-vo,xo=.5+vo,so=1+vo;$r=si=Yi=xn=null,$i=Vr($e,Nt,Le-vo,Le+xo,0,er.minX,er.maxX,ar),di=Vr($e,Nt,Le+to,Le+so,0,er.minX,er.maxX,ar),$e=null,$i&&($r=Vr($i,Nt,ot-vo,ot+xo,1,er.minY,er.maxY,ar),si=Vr($i,Nt,ot+to,ot+so,1,er.minY,er.maxY,ar),$i=null),di&&(Yi=Vr(di,Nt,ot-vo,ot+xo,1,er.minY,er.maxY,ar),xn=Vr(di,Nt,ot+to,ot+so,1,er.minY,er.maxY,ar),di=null),qt>1&&console.timeEnd("clipping"),Rt.push($r||[],ve+1,2*Le,2*ot),Rt.push(si||[],ve+1,2*Le,2*ot+1),Rt.push(Yi||[],ve+1,2*Le+1,2*ot),Rt.push(xn||[],ve+1,2*Le+1,2*ot+1)}}},it.prototype.getTile=function($e,ve,Le){var ot=this.options,Mt=ot.extent,Ot=ot.debug;if($e<0||$e>24)return null;var bt=1<<$e,Rt=wt($e,ve=(ve%bt+bt)%bt,Le);if(this.tiles[Rt])return eo(this.tiles[Rt],Mt);Ot>1&&console.log("drilling down to z%d-%d-%d",$e,ve,Le);for(var ar,qt=$e,Nt=ve,Rr=Le;!ar&&qt>0;)qt--,Nt=Math.floor(Nt/2),Rr=Math.floor(Rr/2),ar=this.tiles[wt(qt,Nt,Rr)];return ar&&ar.source?(Ot>1&&console.log("found parent tile z%d-%d-%d",qt,Nt,Rr),Ot>1&&console.time("drilling down"),this.splitTile(ar.source,qt,Nt,Rr,$e,ve,Le),Ot>1&&console.timeEnd("drilling down"),this.tiles[Rt]?eo(this.tiles[Rt],Mt):null):null},function($e,ve){return new it($e,ve)}}();var sn=s.dK(qr.exports);function qn(rr,Me){const qe=rr.tileID.canonical;if(!this._geoJSONIndex)return Me(null,null);const at=this._geoJSONIndex.getTile(qe.z,qe.x,qe.y);if(!at)return Me(null,null);const $t=new Ge(at.features);let cr=Vn($t);cr.byteOffset===0&&cr.byteLength===cr.buffer.byteLength||(cr=new Uint8Array(cr)),Me(null,{vectorTile:$t,rawData:cr.buffer})}class Li extends Te{constructor(Me,qe,at,$t,cr,br){super(Me,qe,at,$t,qn,br),cr&&(this.loadGeoJSON=cr)}loadData(Me,qe){const at=Me&&Me.request,$t=at&&at.collectResourceTiming;this.loadGeoJSON(Me,(cr,br)=>{if(cr||!br)return qe(cr);if(typeof br!="object")return qe(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`));{Ne(br,!0);try{if(Me.filter){const ur=s.r(Me.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ur.result==="error")throw new Error(ur.value.map(Vr=>`${Vr.key}: ${Vr.message}`).join(", "));br={type:"FeatureCollection",features:br.features.filter(Vr=>ur.value.evaluate({zoom:0},Vr))}}this._geoJSONIndex=Me.cluster?new xr(function({superclusterOptions:ur,clusterProperties:Kr}){if(!Kr||!ur)return ur;const Vr={},cn={},Xn={accumulated:null,zoom:0},Mr={properties:null},Fr=Object.keys(Kr);for(const ri of Fr){const[mi,gi]=Kr[ri],Xi=s.r(gi),mo=s.r(typeof mi=="string"?[mi,["accumulated"],["get",ri]]:mi);Vr[ri]=Xi.value,cn[ri]=mo.value}return ur.map=ri=>{Mr.properties=ri;const mi={};for(const gi of Fr)mi[gi]=Vr[gi].evaluate(Xn,Mr);return mi},ur.reduce=(ri,mi)=>{Mr.properties=mi;for(const gi of Fr)Xn.accumulated=ri[gi],ri[gi]=cn[gi].evaluate(Xn,Mr)},ur}(Me)).load(br.features):sn(br,Me.geojsonVtOptions)}catch(ur){return qe(ur)}this.loaded={};const en={};if($t){const ur=L(at);ur&&(en.resourceTiming={},en.resourceTiming[Me.source]=JSON.parse(JSON.stringify(ur)))}qe(null,en)}})}reloadTile(Me,qe){const at=this.loaded;return at&&at[Me.uid]?super.reloadTile(Me,qe):this.loadTile(Me,qe)}loadGeoJSON(Me,qe){if(Me.request)s.g(Me.request,qe);else{if(typeof Me.data!="string")return qe(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`));try{return qe(null,JSON.parse(Me.data))}catch{return qe(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Me,qe){try{qe(null,this._geoJSONIndex.getClusterExpansionZoom(Me.clusterId))}catch(at){qe(at)}}getClusterChildren(Me,qe){try{qe(null,this._geoJSONIndex.getChildren(Me.clusterId))}catch(at){qe(at)}}getClusterLeaves(Me,qe){try{qe(null,this._geoJSONIndex.getLeaves(Me.clusterId,Me.limit,Me.offset))}catch(at){qe(at)}}}class _i{constructor(Me,qe){this.tileID=new s.am(Me.tileID.overscaledZ,Me.tileID.wrap,Me.tileID.canonical.z,Me.tileID.canonical.x,Me.tileID.canonical.y),this.tileZoom=Me.tileZoom,this.uid=Me.uid,this.zoom=Me.zoom,this.canonical=Me.tileID.canonical,this.pixelRatio=Me.pixelRatio,this.tileSize=Me.tileSize,this.source=Me.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Me.projection,this.brightness=qe}parse(Me,qe,at,$t){this.status="parsing";const cr=new s.am(at.tileID.overscaledZ,at.tileID.wrap,at.tileID.canonical.z,at.tileID.canonical.x,at.tileID.canonical.y),br={},en=qe.familiesBySource[at.source],ur=new s.dC(cr,at.promoteId);return ur.bucketLayerIDs=[],ur.is3DTile=!0,s.dP(Me).then(Kr=>{if(!Kr)return $t(new Error("Could not parse tile"));const Vr=s.dQ(Kr,1/s.bR(at.tileID.canonical)),cn=Kr.json.extensionsUsed&&Kr.json.extensionsUsed.includes("MAPBOX_mesh_features")||Kr.json.asset.extras&&Kr.json.asset.extras.MAPBOX_mesh_features,Xn=Kr.json.extensionsUsed&&Kr.json.extensionsUsed.includes("EXT_meshopt_compression"),Mr=new s.K(this.zoom,{brightness:this.brightness});for(const Fr in en)for(const ri of en[Fr]){const mi=ri[0];ur.bucketLayerIDs.push(ri.map(Xi=>Xi.id)),mi.recalculate(Mr,[]);const gi=new s.dR(Vr,cr,cn,Xn,this.brightness,ur);cn||(gi.needsUpload=!0),br[mi.fqid]=gi,gi.evaluate(mi)}this.status="done",$t(null,{buckets:br,featureIndex:ur})}).catch(Kr=>$t(new Error(Kr.message)))}}class zi{constructor(Me,qe,at,$t,cr,br){this.actor=Me,this.layerIndex=qe,this.brightness=br,this.loading={},this.loaded={}}loadTile(Me,qe){const at=Me.uid,$t=this.loading[at]=new _i(Me,this.brightness);s.a_(Me.request,(cr,br)=>{const en=!this.loading[at];return delete this.loading[at],en||cr?($t.status="done",en||(this.loaded[at]=$t),qe(cr)):br&&br.byteLength!==0?void $t.parse(br,this.layerIndex,Me,(ur,Kr)=>{$t.status="done",this.loaded=this.loaded||{},this.loaded[at]=$t,ur||!Kr?qe(ur):qe(null,Kr)}):($t.status="done",this.loaded[at]=$t,qe())})}reloadTile(Me,qe){const at=this.loaded,$t=Me.uid;if(at&&at[$t]){const cr=at[$t];cr.projection=Me.projection,cr.brightness=Me.brightness;const br=(en,ur)=>{cr.reloadCallback&&(delete cr.reloadCallback,this.loadTile(Me,qe)),qe(en,ur)};cr.status==="parsing"?cr.reloadCallback=br:cr.status==="done"&&this.loadTile(Me,qe)}}abortTile(Me,qe){const at=Me.uid;this.loading[at]&&delete this.loading[at],qe()}removeTile(Me,qe){const at=this.loaded,$t=Me.uid;at&&at[$t]&&delete at[$t],qe()}}class Pi{constructor(Me){this.self=Me,this.actor=new s.dS(Me,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.bo({name:"mercator"}),this.workerSourceTypes={vector:Te,geojson:Li,"batched-model":zi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(qe,at)=>{if(this.workerSourceTypes[qe])throw new Error(`Worker source with name "${qe}" already registered.`);this.workerSourceTypes[qe]=at},this.self.registerRTLTextPlugin=qe=>{if(s.dT.isParsed())throw new Error("RTL text plugin already registered.");s.dT.applyArabicShaping=qe.applyArabicShaping,s.dT.processBidirectionalText=qe.processBidirectionalText,s.dT.processStyledBidirectionalText=qe.processStyledBidirectionalText}}clearCaches(Me,qe,at){delete this.layerIndexes[Me],delete this.availableImages[Me],delete this.workerSources[Me],delete this.demWorkerSources[Me],delete this.rasterArrayWorkerSource,at()}checkIfReady(Me,qe,at){at()}setReferrer(Me,qe){this.referrer=qe}spriteLoaded(Me,{scope:qe,isLoaded:at}){if(this.isSpriteLoaded[Me]||(this.isSpriteLoaded[Me]={}),this.isSpriteLoaded[Me][qe]=at,this.workerSources[Me]&&this.workerSources[Me][qe])for(const $t in this.workerSources[Me][qe]){const cr=this.workerSources[Me][qe][$t];for(const br in cr)cr[br]instanceof Te&&(cr[br].isSpriteLoaded=at,cr[br].fire(new s.b("isSpriteLoaded")))}}setImages(Me,{scope:qe,images:at},$t){if(this.availableImages[Me]||(this.availableImages[Me]={}),this.availableImages[Me][qe]=at,this.workerSources[Me]&&this.workerSources[Me][qe]){for(const cr in this.workerSources[Me][qe]){const br=this.workerSources[Me][qe][cr];for(const en in br)br[en].availableImages=at}$t()}else $t()}setProjection(Me,qe){this.projections[Me]=s.bo(qe)}setBrightness(Me,qe,at){this.brightness=qe,at()}setLayers(Me,qe,at){this.getLayerIndex(Me,qe.scope).replace(qe.layers,qe.options),at()}updateLayers(Me,qe,at){this.getLayerIndex(Me,qe.scope).update(qe.layers,qe.removedIds,qe.options),at()}loadTile(Me,qe,at){qe.projection=this.projections[Me]||this.defaultProjection,this.getWorkerSource(Me,qe.type,qe.source,qe.scope).loadTile(qe,at)}loadDEMTile(Me,qe,at){this.getDEMWorkerSource(Me,qe.source,qe.scope).loadTile(qe,at)}decodeRasterArray(Me,qe,at){this.getRasterArrayWorkerSource().decodeRasterArray(qe,at)}reloadTile(Me,qe,at){qe.projection=this.projections[Me]||this.defaultProjection,this.getWorkerSource(Me,qe.type,qe.source,qe.scope).reloadTile(qe,at)}abortTile(Me,qe,at){this.getWorkerSource(Me,qe.type,qe.source,qe.scope).abortTile(qe,at)}removeTile(Me,qe,at){this.getWorkerSource(Me,qe.type,qe.source,qe.scope).removeTile(qe,at)}removeSource(Me,qe,at){if(!(this.workerSources[Me]&&this.workerSources[Me][qe.scope]&&this.workerSources[Me][qe.scope][qe.type]&&this.workerSources[Me][qe.scope][qe.type][qe.source]))return;const $t=this.workerSources[Me][qe.scope][qe.type][qe.source];delete this.workerSources[Me][qe.scope][qe.type][qe.source],$t.removeSource!==void 0?$t.removeSource(qe,at):at()}loadWorkerSource(Me,qe,at){try{this.self.importScripts(qe.url),at()}catch($t){at($t.toString())}}syncRTLPluginState(Me,qe,at){try{s.dT.setState(qe);const $t=s.dT.getPluginURL();if(s.dT.isLoaded()&&!s.dT.isParsed()&&$t!=null){this.self.importScripts($t);const cr=s.dT.isParsed();at(cr?void 0:new Error(`RTL Text Plugin failed to import scripts from ${$t}`),cr)}}catch($t){at($t.toString())}}setDracoUrl(Me,qe){this.dracoUrl=qe}getAvailableImages(Me,qe){this.availableImages[Me]||(this.availableImages[Me]={});let at=this.availableImages[Me][qe];return at||(at=[]),at}getLayerIndex(Me,qe){this.layerIndexes[Me]||(this.layerIndexes[Me]={});let at=this.layerIndexes[Me][qe];return at||(at=this.layerIndexes[Me][qe]=new H,at.scope=qe),at}getWorkerSource(Me,qe,at,$t){if(this.workerSources[Me]||(this.workerSources[Me]={}),this.workerSources[Me][$t]||(this.workerSources[Me][$t]={}),this.workerSources[Me][$t][qe]||(this.workerSources[Me][$t][qe]={}),this.isSpriteLoaded[Me]||(this.isSpriteLoaded[Me]={}),!this.workerSources[Me][$t][qe][at]){const cr={send:(br,en,ur,Kr,Vr,cn)=>{this.actor.send(br,en,ur,Me,Vr,cn)},scheduler:this.actor.scheduler};this.workerSources[Me][$t][qe][at]=new this.workerSourceTypes[qe](cr,this.getLayerIndex(Me,$t),this.getAvailableImages(Me,$t),this.isSpriteLoaded[Me][$t],void 0,this.brightness)}return this.workerSources[Me][$t][qe][at]}getDEMWorkerSource(Me,qe,at){return this.demWorkerSources[Me]||(this.demWorkerSources[Me]={}),this.demWorkerSources[Me][at]||(this.demWorkerSources[Me][at]={}),this.demWorkerSources[Me][at][qe]||(this.demWorkerSources[Me][at][qe]=new ue),this.demWorkerSources[Me][at][qe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ce),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Me,qe){s.dU(qe)}getWorkerPerformanceMetrics(Me,qe,at){at(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pi(self)),Pi}),w(["./shared"],function(s){function L(_,o){if(Array.isArray(_)){if(!Array.isArray(o)||_.length!==o.length)return!1;for(let h=0;h<_.length;h++)if(!L(_[h],o[h]))return!1;return!0}if(typeof _=="object"&&_!==null&&o!==null){if(typeof o!="object"||Object.keys(_).length!==Object.keys(o).length)return!1;for(const h in _)if(!L(_[h],o[h]))return!1;return!0}return _===o}var F=G;function G(_){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,I,A=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(A);try{I=new Worker(D),x=!0}catch{x=!1}return I&&I.terminate(),URL.revokeObjectURL(D),x}()?function(){var x=document.createElement("canvas");x.width=x.height=1;var I=x.getContext("2d");if(!I)return!1;var A=I.getImageData(0,0,1,1);return A&&A.width===x.width}()?(H[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(H[h]=function(x){var I,A=function(D){var N=document.createElement("canvas"),U=Object.create(G.webGLContextAttributes);return U.failIfMajorPerformanceCaveat=D,N.getContext("webgl2",U)}(x);if(!A)return!1;try{I=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!I||A.isContextLost())&&(A.shaderSource(I,"void main() {}"),A.compileShader(I),A.getShaderParameter(I,A.COMPILE_STATUS)===!0)}(h)),H[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var h}(_)}var H={};function X(_,o,h){const x=document.createElement(_);return o!=null&&(x.className=o),h&&h.appendChild(x),x}function ne(_,o,h){const x=document.createElementNS("http://www.w3.org/2000/svg",_);for(const I of Object.keys(o))x.setAttributeNS(null,I,String(o[I]));return h&&h.appendChild(x),x}G.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ie=typeof document<"u"?document.documentElement&&document.documentElement.style:null,se=ie&&ie.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Te;function ue(){ie&&se&&(Te=ie[se],ie[se]="none")}function ce(){ie&&se&&(ie[se]=Te)}function de(_){_.preventDefault(),_.stopPropagation(),window.removeEventListener("click",de,!0)}function Ee(){window.addEventListener("click",de,!0),window.setTimeout(()=>{window.removeEventListener("click",de,!0)},0)}function Ne(_,o){const h=_.getBoundingClientRect();return Ge(_,h,o)}function rt(_,o){const h=_.getBoundingClientRect(),x=[];for(let I=0;I<o.length;I++)x.push(Ge(_,h,o[I]));return x}function tt(_){return window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function Ge(_,o,h){const x=_.offsetWidth===o.width?1:_.offsetWidth/o.width;return new s.P((h.clientX-o.left)*x,(h.clientY-o.top)*x)}class _t{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,h){this._updatedSourceCaches[o]=h,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const h=o.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(o.id),this.setDirty()}removeLayer(o){const h=o.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][o.id]=o,this._updatedLayers[h].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const h in this._updatedLayers)o[h]=o[h]||{},o[h].updatedIds=Array.from(this._updatedLayers[h].values());for(const h in this._removedLayers)o[h]=o[h]||{},o[h].removedIds=Object.keys(this._removedLayers[h]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}class yt extends s.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.numModelsLoading={}}loadModel(o,h){return s.l(this.requestManager.transformRequest(h,s.R.Model).url).then(x=>{if(!x)return;const I=s.c(x),A=new s.M(o,void 0,void 0,I);return A.computeBoundsAndApplyParent(),A}).catch(x=>{this.fire(new s.a(new Error(`Could not load model ${o} from ${h}: ${x.message}`)))})}load(o,h){this.models[h]||(this.models[h]={});const x=Object.keys(o);this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+x.length;const I=[];for(const A of x)I.push(this.loadModel(A,o[A]));Promise.allSettled(I).then(A=>{for(let D=0;D<A.length;D++){const{status:N,value:U}=A[D];N==="fulfilled"&&U&&(this.models[h][x[D]]=U)}this.numModelsLoading[h]-=x.length,this.fire(new s.b("data",{dataType:"style"}))}).catch(A=>{this.fire(new s.a(new Error(`Could not load models: ${A.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,h){return!!this.getModel(o,h)}getModel(o,h){return this.models[h]||(this.models[h]={}),this.models[h][o]}addModel(o,h,x){this.models[x]||(this.models[x]={}),this.hasModel(o,x)&&this.removeModel(o,x),this.load({[o]:this.requestManager.normalizeModelURL(h)},x)}addModels(o,h){const x={};for(const I in o)x[I]=this.requestManager.normalizeModelURL(o[I]);this.load(x,h)}removeModel(o,h){this.models[h]||(this.models[h]={});const x=this.models[h][o];delete this.models[h][o],x.destroy()}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,h){this.models[h]||(this.models[h]={});for(const x in this.models[h])this.models[h][x].upload(o.context)}}class Et{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,h,x){const I=String(h);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][I]=this.stateChanges[o][I]||{},s.e(this.stateChanges[o][I],x),this.deletedStates[o]===null){this.deletedStates[o]={};for(const A in this.state[o])A!==I&&(this.deletedStates[o][A]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][I]===null){this.deletedStates[o][I]={};for(const A in this.state[o][I])x[A]||(this.deletedStates[o][I][A]=null)}else for(const A in x)this.deletedStates[o]&&this.deletedStates[o][I]&&this.deletedStates[o][I][A]===null&&delete this.deletedStates[o][I][A]}removeFeatureState(o,h,x){if(this.deletedStates[o]===null)return;const I=String(h);if(this.deletedStates[o]=this.deletedStates[o]||{},x&&h!==void 0)this.deletedStates[o][I]!==null&&(this.deletedStates[o][I]=this.deletedStates[o][I]||{},this.deletedStates[o][I][x]=null);else if(h!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][I])for(x in this.deletedStates[o][I]={},this.stateChanges[o][I])this.deletedStates[o][I][x]=null;else this.deletedStates[o][I]=null;else this.deletedStates[o]=null}getState(o,h){const x=String(h),I=s.e({},(this.state[o]||{})[x],(this.stateChanges[o]||{})[x]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const A=this.deletedStates[o][h];if(A===null)return{};for(const D in A)delete I[D]}return I}initializeTileState(o,h){o.setFeatureState(this.state,h)}coalesceChanges(o,h){const x={};for(const I in this.stateChanges){this.state[I]=this.state[I]||{};const A={};for(const D in this.stateChanges[I])this.state[I][D]||(this.state[I][D]={}),s.e(this.state[I][D],this.stateChanges[I][D]),A[D]=this.state[I][D];x[I]=A}for(const I in this.deletedStates){this.state[I]=this.state[I]||{};const A={};if(this.deletedStates[I]===null)for(const D in this.state[I])A[D]={},this.state[I][D]={};else for(const D in this.deletedStates[I]){if(this.deletedStates[I][D]===null)this.state[I][D]={};else if(this.state[I][D])for(const N of Object.keys(this.deletedStates[I][D]))delete this.state[I][D][N];A[D]=this.state[I][D]}x[I]=x[I]||{},s.e(x[I],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(x).length!==0)for(const I in o)o[I].setFeatureState(x,h)}}function Wt(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ar extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new s.h({width:1,height:1})}isLoaded(){for(const o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,h){if(this.loaded[h]!==o&&(this.loaded[h]=o,o)){for(const{ids:x,callback:I}of this.requestors)this._notify(x,h,I);this.requestors=[]}}hasImage(o,h){return!!this.getImage(o,h)}getImage(o,h){return this.images[h][o]}addImage(o,h,x){this._validate(o,x)&&(this.images[h][o]=x)}_validate(o,h){let x=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new s.a(new Error(`Image "${o}" has invalid "stretchX" value`))),x=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new s.a(new Error(`Image "${o}" has invalid "stretchY" value`))),x=!1),this._validateContent(h.content,h)||(this.fire(new s.a(new Error(`Image "${o}" has invalid "content" value`))),x=!1),x}_validateStretch(o,h){if(!o)return!0;let x=0;for(const I of o){if(I[0]<x||I[1]<I[0]||h<I[1])return!1;x=I[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h,x){x.version=this.images[h][o].version+1,this.images[h][o]=x,this.updatedImages[h][o]=!0}removeImage(o,h){const x=this.images[h][o];delete this.images[h][o],delete this.patterns[h][o],x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,h,x){let I=!0;const A=!!this.loaded[h];if(!A)for(const D of o)this.images[h][D]||(I=!1);A||I?this._notify(o,h,x):this.requestors.push({ids:o,scope:h,callback:x})}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,h,x){const I={};for(const A of o){this.images[h][A]||this.fire(new s.b("styleimagemissing",{id:A}));const D=this.images[h][A];D?I[A]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!!(D.userImage&&D.userImage.render)}:s.w(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}x(null,I)}getPixelSize(o){const{width:h,height:x}=this.atlasImage[o];return{width:h,height:x}}getPattern(o,h){const x=this.patterns[h][o],I=this.getImage(o,h);if(!I)return null;if(x&&x.position.version===I.version)return x.position;if(x)x.position.version=I.version;else{const A={w:I.data.width+2,h:I.data.height+2,x:0,y:0},D=new s.I(A,I);this.patterns[h][o]={bin:A,position:D}}return this._updatePatternAtlas(h),this.patterns[h][o].position}bind(o,h){const x=o.gl;let I=this.atlasTexture[h];I?this.dirty&&(I.update(this.atlasImage[h]),this.dirty=!1):(I=new s.T(o,this.atlasImage[h],x.RGBA),this.atlasTexture[h]=I),I.bind(x.LINEAR,x.CLAMP_TO_EDGE)}_updatePatternAtlas(o){const h=[];for(const D in this.patterns[o])h.push(this.patterns[o][D].bin);const{w:x,h:I}=s.p(h),A=this.atlasImage[o];A.resize({width:x||1,height:I||1});for(const D in this.patterns[o]){const{bin:N}=this.patterns[o][D],U=N.x+1,Z=N.y+1,J=this.images[o][D].data,ee=J.width,ae=J.height;s.h.copy(J,A,{x:0,y:0},{x:U,y:Z},{width:ee,height:ae}),s.h.copy(J,A,{x:0,y:ae-1},{x:U,y:Z-1},{width:ee,height:1}),s.h.copy(J,A,{x:0,y:0},{x:U,y:Z+ae},{width:ee,height:1}),s.h.copy(J,A,{x:ee-1,y:0},{x:U-1,y:Z},{width:1,height:ae}),s.h.copy(J,A,{x:0,y:0},{x:U+ee,y:Z},{width:1,height:ae})}this.dirty=!0}beginFrame(){for(const o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,h){for(const x of o){if(this.callbackDispatchedThisFrame[h][x])continue;this.callbackDispatchedThisFrame[h][x]=!0;const I=this.images[h][x];Wt(I)&&this.updateImage(x,h,I)}}}class mt{constructor(o,h,x,I){this.message=(o?`${o}: `:"")+x,I&&(this.identifier=I),h!=null&&h.__line__&&(this.line=h.__line__)}}class nr extends mt{}function Xt(_){const o=_.key,h=_.value,x=_.valueSpec||{},I=_.objectElementValidators||{},A=_.style,D=_.styleSpec;let N=[];const U=s.i(h);if(U!=="object")return[new mt(o,h,`object expected, ${U} found`)];for(const Z in h){const J=Z.split(".")[0];let ee;I[J]?ee=I[J]:x[J]?ee=sn:I["*"]?ee=I["*"]:x["*"]&&(ee=sn),ee?N=N.concat(ee({key:(o&&`${o}.`)+Z,value:h[Z],valueSpec:x[J]||x["*"],style:A,styleSpec:D,object:h,objectKey:Z},h)):N.push(new nr(o,h[Z],`unknown property "${Z}"`))}for(const Z in x)I[Z]||x[Z].required&&x[Z].default===void 0&&h[Z]===void 0&&N.push(new mt(o,h,`missing required property "${Z}"`));return N}function Ht(_){const o=_.value,h=_.valueSpec,x=_.style,I=_.styleSpec,A=_.key,D=_.arrayElementValidator||sn;if(s.i(o)!=="array")return[new mt(A,o,`array expected, ${s.i(o)} found`)];if(h.length&&o.length!==h.length)return[new mt(A,o,`array length ${h.length} expected, length ${o.length} found`)];if(h["min-length"]&&o.length<h["min-length"])return[new mt(A,o,`array length at least ${h["min-length"]} expected, length ${o.length} found`)];let N={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};I.$version<7&&(N.function=h.function),s.i(h.value)==="object"&&(N=h.value);let U=[];for(let Z=0;Z<o.length;Z++)U=U.concat(D({array:o,arrayIndex:Z,value:o[Z],valueSpec:N,style:x,styleSpec:I,key:`${A}[${Z}]`},!0));return U}function Qt(_){const o=_.key,h=_.value,x=_.valueSpec;let I=s.i(h);if(I==="number"&&h!=h&&(I="NaN"),I!=="number")return[new mt(o,h,`number expected, ${I} found`)];if("minimum"in x){let A=x.minimum;if(s.i(x.minimum)==="array"&&(A=x.minimum[_.arrayIndex]),h<A)return[new mt(o,h,`${h} is less than the minimum value ${A}`)]}if("maximum"in x){let A=x.maximum;if(s.i(x.maximum)==="array"&&(A=x.maximum[_.arrayIndex]),h>A)return[new mt(o,h,`${h} is greater than the maximum value ${A}`)]}return[]}function sr(_){const o=_.valueSpec,h=s.u(_.value.type);let x,I,A,D={};const N=h!=="categorical"&&_.value.property===void 0,U=!N,Z=s.i(_.value.stops)==="array"&&s.i(_.value.stops[0])==="array"&&s.i(_.value.stops[0][0])==="object",J=Xt({key:_.key,value:_.value,valueSpec:_.styleSpec.function,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{stops:function(he){if(h==="identity")return[new mt(he.key,he.value,'identity function may not have a "stops" property')];let we=[];const xe=he.value;return we=we.concat(Ht({key:he.key,value:xe,valueSpec:he.valueSpec,style:he.style,styleSpec:he.styleSpec,arrayElementValidator:ee})),s.i(xe)==="array"&&xe.length===0&&we.push(new mt(he.key,xe,"array must have at least one stop")),we},default:function(he){return sn({key:he.key,value:he.value,valueSpec:o,style:he.style,styleSpec:he.styleSpec})}}});return h==="identity"&&N&&J.push(new mt(_.key,_.value,'missing required property "property"')),h==="identity"||_.value.stops||J.push(new mt(_.key,_.value,'missing required property "stops"')),h==="exponential"&&_.valueSpec.expression&&!s.s(_.valueSpec)&&J.push(new mt(_.key,_.value,"exponential functions not supported")),_.styleSpec.$version>=8&&(U&&!s.k(_.valueSpec)?J.push(new mt(_.key,_.value,"property functions not supported")):N&&!s.m(_.valueSpec)&&J.push(new mt(_.key,_.value,"zoom functions not supported"))),h!=="categorical"&&!Z||_.value.property!==void 0||J.push(new mt(_.key,_.value,'"property" property is required')),J;function ee(he){let we=[];const xe=he.value,Ce=he.key;if(s.i(xe)!=="array")return[new mt(Ce,xe,`array expected, ${s.i(xe)} found`)];if(xe.length!==2)return[new mt(Ce,xe,`array length 2 expected, length ${xe.length} found`)];if(Z){if(s.i(xe[0])!=="object")return[new mt(Ce,xe,`object expected, ${s.i(xe[0])} found`)];if(xe[0].zoom===void 0)return[new mt(Ce,xe,"object stop key must have zoom")];if(xe[0].value===void 0)return[new mt(Ce,xe,"object stop key must have value")];const ge=s.u(xe[0].zoom);if(typeof ge!="number")return[new mt(Ce,xe[0].zoom,"stop zoom values must be numbers")];if(A&&A>ge)return[new mt(Ce,xe[0].zoom,"stop zoom values must appear in ascending order")];ge!==A&&(A=ge,I=void 0,D={}),we=we.concat(Xt({key:`${Ce}[0]`,value:xe[0],valueSpec:{zoom:{}},style:he.style,styleSpec:he.styleSpec,objectElementValidators:{zoom:Qt,value:ae}}))}else we=we.concat(ae({key:`${Ce}[0]`,value:xe[0],valueSpec:{},style:he.style,styleSpec:he.styleSpec},xe));return s.n(s.o(xe[1]))?we.concat([new mt(`${Ce}[1]`,xe[1],"expressions are not allowed in function stops.")]):we.concat(sn({key:`${Ce}[1]`,value:xe[1],valueSpec:o,style:he.style,styleSpec:he.styleSpec}))}function ae(he,we){const xe=s.i(he.value),Ce=s.u(he.value),ge=he.value!==null?he.value:we;if(x){if(xe!==x)return[new mt(he.key,ge,`${xe} stop domain type must match previous stop domain type ${x}`)]}else x=xe;if(xe!=="number"&&xe!=="string"&&xe!=="boolean"&&typeof Ce!="number"&&typeof Ce!="string"&&typeof Ce!="boolean")return[new mt(he.key,ge,"stop domain value must be a number, string, or boolean")];if(xe!=="number"&&h!=="categorical"){let De=`number expected, ${xe} found`;return s.k(o)&&h===void 0&&(De+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mt(he.key,ge,De)]}return h!=="categorical"||xe!=="number"||typeof Ce=="number"&&isFinite(Ce)&&Math.floor(Ce)===Ce?h!=="categorical"&&xe==="number"&&typeof Ce=="number"&&typeof I=="number"&&I!==void 0&&Ce<I?[new mt(he.key,ge,"stop domain values must appear in ascending order")]:(I=Ce,h==="categorical"&&Ce in D?[new mt(he.key,ge,"stop domain values must be unique")]:(D[Ce]=!0,[])):[new mt(he.key,ge,`integer expected, found ${String(Ce)}`)]}}function Tr(_){const o=(_.expressionContext==="property"?s.q:s.r)(s.o(_.value),_.valueSpec);if(o.result==="error")return o.value.map(x=>new mt(`${_.key}${x.key}`,_.value,x.message));const h=o.value.expression||o.value._styleExpression.expression;if(_.expressionContext==="property"&&_.propertyKey==="text-font"&&!h.outputDefined())return[new mt(_.key,_.value,`Invalid data expression for "${_.propertyKey}". Output values must be contained as literals within the expression.`)];if(_.expressionContext==="property"&&_.propertyType==="layout"&&!s.t(h))return[new mt(_.key,_.value,'"feature-state" data expressions are not supported with layout properties.')];if(_.expressionContext==="filter")return ln(h,_);if(_.expressionContext&&_.expressionContext.indexOf("cluster")===0){if(!s.v(h,["zoom","feature-state"]))return[new mt(_.key,_.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(_.expressionContext==="cluster-initial"&&!s.x(h))return[new mt(_.key,_.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ln(_,o){const h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const I of o.valueSpec.expression.parameters)h.delete(I);if(h.size===0)return[];const x=[];return _ instanceof s.C&&h.has(_.name)?[new mt(o.key,o.value,`["${_.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(_.eachChild(I=>{x.push(...ln(I,o))}),x)}function vn(_){const o=_.key,h=_.value,x=_.valueSpec,I=[];return Array.isArray(x.values)?x.values.indexOf(s.u(h))===-1&&I.push(new mt(o,h,`expected one of [${x.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(x.values).indexOf(s.u(h))===-1&&I.push(new mt(o,h,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(h)} found`)),I}function wi(_){return s.z(s.o(_.value))?Tr(s.j({},_,{expressionContext:"filter",valueSpec:_.styleSpec[`filter_${_.layerType||"fill"}`]})):hi(_)}function hi(_){const o=_.value,h=_.key;if(s.i(o)!=="array")return[new mt(h,o,`array expected, ${s.i(o)} found`)];const x=_.styleSpec;let I,A=[];if(o.length<1)return[new mt(h,o,"filter array must have at least 1 element")];switch(A=A.concat(vn({key:`${h}[0]`,value:o[0],valueSpec:x.filter_operator,style:_.style,styleSpec:_.styleSpec})),s.u(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&s.u(o[1])==="$type"&&A.push(new mt(h,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&A.push(new mt(h,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(I=s.i(o[1]),I!=="string"&&A.push(new mt(`${h}[1]`,o[1],`string expected, ${I} found`)));for(let D=2;D<o.length;D++)I=s.i(o[D]),s.u(o[1])==="$type"?A=A.concat(vn({key:`${h}[${D}]`,value:o[D],valueSpec:x.geometry_type,style:_.style,styleSpec:_.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&A.push(new mt(`${h}[${D}]`,o[D],`string, number, or boolean expected, ${I} found`));break;case"any":case"all":case"none":for(let D=1;D<o.length;D++)A=A.concat(hi({key:`${h}[${D}]`,value:o[D],style:_.style,styleSpec:_.styleSpec}));break;case"has":case"!has":I=s.i(o[1]),o.length!==2?A.push(new mt(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):I!=="string"&&A.push(new mt(`${h}[1]`,o[1],`string expected, ${I} found`))}return A}function Vn(_,o){const h=_.key,x=_.style,I=_.layer,A=_.styleSpec,D=_.value,N=_.objectKey,U=A[`${o}_${_.layerType}`];if(!U)return[];const Z=N.match(/^(.*)-transition$/);if(o==="paint"&&Z&&U[Z[1]]&&U[Z[1]].transition)return sn({key:h,value:D,valueSpec:A.transition,style:x,styleSpec:A});const J=_.valueSpec||U[N];if(!J)return[new nr(h,D,`unknown property "${N}"`)];let ee;if(s.i(D)==="string"&&s.k(J)&&!J.tokens&&(ee=/^{([^}]+)}$/.exec(D))){const he=`\`{ "type": "identity", "property": ${ee?JSON.stringify(ee[1]):'"_"'} }\``;return[new mt(h,D,`"${N}" does not support interpolation syntax
Use an identity property function instead: ${he}.`)]}const ae=[];if(_.layerType==="symbol")N!=="text-field"||!x||x.glyphs||x.imports||ae.push(new mt(h,D,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&s.A(s.o(D))&&s.u(D.type)==="identity"&&ae.push(new mt(h,D,'"text-font" does not support identity functions'));else if(_.layerType==="model"&&o==="paint"&&I&&I.layout&&I.layout.hasOwnProperty("model-id")&&s.k(J)&&(s.B(J)||s.m(J))){const he=s.q(s.o(D),J),we=he.value.expression||he.value._styleExpression.expression;we&&!s.v(we,["measure-light"])&&(N==="model-emissive-strength"&&s.x(we)&&s.t(we)||ae.push(new mt(h,D,`${N} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ae.concat(sn({key:_.key,value:D,valueSpec:J,style:x,styleSpec:A,expressionContext:"property",propertyType:o,propertyKey:N}))}function Oi(_){return Vn(_,"paint")}function fn(_){return Vn(_,"layout")}function Nn(_){let o=[];const h=_.value,x=_.key,I=_.style,A=_.styleSpec;h.type||h.ref||o.push(new mt(x,h,'either "type" or "ref" is required'));let D=s.u(h.type);const N=s.u(h.ref);if(h.id){const U=s.u(h.id);for(let Z=0;Z<_.arrayIndex;Z++){const J=I.layers[Z];s.u(J.id)===U&&o.push(new mt(x,h.id,`duplicate layer id "${h.id}", previously used at line ${J.id.__line__}`))}}if("ref"in h){let U;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in h&&o.push(new mt(x,h[Z],`"${Z}" is prohibited for ref layers`))}),I.layers.forEach(Z=>{s.u(Z.id)===N&&(U=Z)}),U?U.ref?o.push(new mt(x,h.ref,"ref cannot reference another ref layer")):D=s.u(U.type):typeof N=="string"&&o.push(new mt(x,h.ref,`ref layer "${N}" not found`))}else if(D!=="background"&&D!=="sky"&&D!=="slot")if(h.source){const U=I.sources&&I.sources[h.source],Z=U&&s.u(U.type);U?Z==="vector"&&D==="raster"?o.push(new mt(x,h.source,`layer "${h.id}" requires a raster source`)):Z==="raster"&&D!=="raster"?o.push(new mt(x,h.source,`layer "${h.id}" requires a vector source`)):Z!=="vector"||h["source-layer"]?Z==="raster-dem"&&D!=="hillshade"?o.push(new mt(x,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):Z!=="raster-array"||["raster","raster-particle"].includes(D)?D!=="line"||!h.paint||!h.paint["line-gradient"]&&!h.paint["line-trim-offset"]||Z==="geojson"&&U.lineMetrics?D==="raster-particle"&&Z!=="raster-array"&&o.push(new mt(x,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):o.push(new mt(x,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new mt(x,h.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new mt(x,h,`layer "${h.id}" must specify a "source-layer"`)):o.push(new mt(x,h.source,`source "${h.source}" not found`))}else o.push(new mt(x,h,'missing required property "source"'));return o=o.concat(Xt({key:x,value:h,valueSpec:A.layer,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":()=>[],type:()=>sn({key:`${x}.type`,value:h.type,valueSpec:A.layer.type,style:_.style,styleSpec:_.styleSpec,object:h,objectKey:"type"}),filter:U=>wi(s.j({layerType:D},U)),layout:U=>Xt({layer:h,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":Z=>fn(s.j({layerType:D},Z))}}),paint:U=>Xt({layer:h,key:U.key,value:U.value,valueSpec:{},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{"*":Z=>Oi(s.j({layerType:D,layer:h},Z))}})}})),o}function Pt(_){const o=_.value,h=_.key,x=s.i(o);return x!=="string"?[new mt(h,o,`string expected, ${x} found`)]:[]}const Dt={promoteId:function({key:_,value:o}){if(s.i(o)==="string")return Pt({key:_,value:o});{const h=[];for(const x in o)h.push(...Pt({key:`${_}.${x}`,value:o[x]}));return h}}};function Ir(_){const o=_.value,h=_.key,x=_.styleSpec,I=_.style;if(!o.type)return[new mt(h,o,'"type" is required')];const A=s.u(o.type);let D=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&(o.url||o.tiles||D.push(new nr(h,o,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return D=D.concat(Xt({key:h,value:o,valueSpec:x[`source_${A.replace("-","_")}`],style:_.style,styleSpec:x,objectElementValidators:Dt})),D;case"geojson":if(D=Xt({key:h,value:o,valueSpec:x.source_geojson,style:I,styleSpec:x,objectElementValidators:Dt}),o.cluster)for(const N in o.clusterProperties){const[U,Z]=o.clusterProperties[N],J=typeof U=="string"?[U,["accumulated"],["get",N]]:U;D.push(...Tr({key:`${h}.${N}.map`,value:Z,expressionContext:"cluster-map"})),D.push(...Tr({key:`${h}.${N}.reduce`,value:J,expressionContext:"cluster-reduce"}))}return D;case"video":return Xt({key:h,value:o,valueSpec:x.source_video,style:I,styleSpec:x});case"image":return Xt({key:h,value:o,valueSpec:x.source_image,style:I,styleSpec:x});case"canvas":return[new mt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vn({key:`${h}.type`,value:o.type,valueSpec:{values:xr(x)},style:I,styleSpec:x})}}function xr(_){return _.source.reduce((o,h)=>{const x=_[h];return x.type.type==="enum"&&(o=o.concat(Object.keys(x.type.values))),o},[])}function Kt(_){const o=_.value;let h=[];if(!o)return h;const x=s.i(o);return x!=="string"?(h=h.concat([new mt(_.key,o,`string expected, "${x}" found`)]),h):(function(I){const A=I.indexOf("://")===-1;try{return new URL(I,A?"http://example.com":void 0),!0}catch{return!1}}(o)||(h=h.concat([new mt(_.key,o,`invalid url "${o}"`)])),h)}function Cn(_){const o=_.value,h=_.styleSpec,x=h.light,I=_.style;let A=[];const D=s.i(o);if(o===void 0)return A;if(D!=="object")return A=A.concat([new mt("light",o,`object expected, ${D} found`)]),A;for(const N in o){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&x[U[1]]&&x[U[1]].transition?sn({key:N,value:o[N],valueSpec:h.transition,style:I,styleSpec:h}):x[N]?sn({key:N,value:o[N],valueSpec:x[N],style:I,styleSpec:h}):[new mt(N,o[N],`unknown property "${N}"`)])}return A}function gn(_){const o=_.value;let h=[];if(!o)return h;const x=s.i(o);if(x!=="object")return h=h.concat([new mt("light-3d",o,`object expected, ${x} found`)]),h;const I=_.styleSpec,A=I["light-3d"],D=_.key,N=_.style,U=_.style.lights;for(const ee of["type","id"])if(!(ee in o))return h=h.concat([new mt("light-3d",o,`missing property ${ee} on light`)]),h;if(o.type&&U)for(let ee=0;ee<_.arrayIndex;ee++){const ae=s.u(o.type),he=U[ee];s.u(he.type)===ae&&h.push(new mt(D,o.id,`duplicate light type "${o.type}", previously defined at line ${he.id.__line__}`))}const Z=`properties_light_${o.type}`;if(!(Z in I))return h=h.concat([new mt("light-3d",o,`Invalid light type ${o.type}`)]),h;const J=I[Z];for(const ee in o)if(ee==="properties"){const ae=o[ee],he=s.i(ae);if(he!=="object")return h=h.concat([new mt("properties",ae,`object expected, ${he} found`)]),h;for(const we in ae)h=h.concat(J[we]?sn({key:we,value:ae[we],valueSpec:J[we],style:N,styleSpec:I}):[new nr(_.key,ae[we],`unknown property "${we}"`)])}else{const ae=ee.match(/^(.*)-transition$/);h=h.concat(ae&&A[ae[1]]&&A[ae[1]].transition?sn({key:ee,value:o[ee],valueSpec:I.transition,style:N,styleSpec:I}):A[ee]?sn({key:ee,value:o[ee],valueSpec:A[ee],style:N,styleSpec:I}):[new nr(ee,o[ee],`unknown property "${ee}"`)])}return h}function fr(_){const o=_.value,h=_.key,x=_.style,I=_.styleSpec,A=I.terrain;let D=[];const N=s.i(o);if(o===void 0||N==="null")return D;if(N!=="object")return D=D.concat([new mt("terrain",o,`object expected, ${N} found`)]),D;for(const U in o){const Z=U.match(/^(.*)-transition$/);D=D.concat(Z&&A[Z[1]]&&A[Z[1]].transition?sn({key:U,value:o[U],valueSpec:I.transition,style:x,styleSpec:I}):A[U]?sn({key:U,value:o[U],valueSpec:A[U],style:x,styleSpec:I}):[new nr(U,o[U],`unknown property "${U}"`)])}if(o.source){const U=x.sources&&x.sources[o.source],Z=U&&s.u(U.type);U?Z!=="raster-dem"&&D.push(new mt(h,o.source,`terrain cannot be used with a source of type ${String(Z)}, it only be used with a "raster-dem" source type`)):D.push(new mt(h,o.source,`source "${o.source}" not found`))}else D.push(new mt(h,o,'terrain is missing required property "source"'));return D}function Zr(_){const o=_.value,h=_.style,x=_.styleSpec,I=x.fog;let A=[];const D=s.i(o);if(o===void 0)return A;if(D!=="object")return A=A.concat([new mt("fog",o,`object expected, ${D} found`)]),A;for(const N in o){const U=N.match(/^(.*)-transition$/);A=A.concat(U&&I[U[1]]&&I[U[1]].transition?sn({key:N,value:o[N],valueSpec:x.transition,style:h,styleSpec:x}):I[N]?sn({key:N,value:o[N],valueSpec:I[N],style:h,styleSpec:x}):[new nr(N,o[N],`unknown property "${N}"`)])}return A}const qr={"*":()=>[],array:Ht,boolean:function(_){const o=_.value,h=_.key,x=s.i(o);return x!=="boolean"?[new mt(h,o,`boolean expected, ${x} found`)]:[]},number:Qt,color:function(_){const o=_.key,h=_.value,x=s.i(h);return x!=="string"?[new mt(o,h,`color expected, ${x} found`)]:s.y(h)===null?[new mt(o,h,`color expected, "${h}" found`)]:[]},enum:vn,filter:wi,function:sr,layer:Nn,object:Xt,source:Ir,model:Kt,light:Cn,"light-3d":gn,terrain:fr,fog:Zr,string:Pt,formatted:function(_){return Pt(_).length===0?[]:Tr(_)},resolvedImage:function(_){return Pt(_).length===0?[]:Tr(_)},projection:function(_){const o=_.value,h=_.styleSpec,x=h.projection,I=_.style;let A=[];const D=s.i(o);if(D==="object")for(const N in o)A=A.concat(sn({key:N,value:o[N],valueSpec:x[N],style:I,styleSpec:h}));else D!=="string"&&(A=A.concat([new mt("projection",o,`object or string expected, ${D} found`)]));return A},import:function(_){const{value:o,styleSpec:h}=_,{data:x,...I}=o;Object.defineProperty(I,"__line__",{value:o.__line__,enumerable:!1});let A=Xt(s.j({},_,{value:I,valueSpec:h.import}));return s.u(I.id)===""&&A.push(new mt(`${_.key}.id`,I,"import id can't be an empty string")),x&&(A=A.concat(Li(x,h,{key:`${_.key}.data`}))),A}};function sn(_,o=!1){const h=_.value,x=_.valueSpec,I=_.styleSpec;if(x.expression&&s.A(s.u(h)))return sr(_);if(x.expression&&s.n(s.o(h)))return Tr(_);if(x.type&&qr[x.type]){const A=qr[x.type](_);return o===!0&&A.length>0&&s.i(_.value)==="array"?Tr(_):A}return Xt(s.j({},_,{valueSpec:x.type?I[x.type]:x}))}function qn(_){const o=_.value,h=_.key,x=Pt(_);return x.length||(o.indexOf("{fontstack}")===-1&&x.push(new mt(h,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&x.push(new mt(h,o,'"glyphs" url must include a "{range}" token'))),x}function Li(_,o=s.D,h={}){return sn({key:h.key||"",value:_,valueSpec:o.$root,styleSpec:o,style:_,objectElementValidators:{glyphs:qn,"*":()=>[]}})}function _i(_,o=s.D){return ur(Li(_,o))}const zi=_=>ur(Ir(_)),Pi=_=>ur(Cn(_)),rr=_=>ur(gn(_)),Me=_=>ur(fr(_)),qe=_=>ur(Zr(_)),at=_=>ur(Nn(_)),$t=_=>ur(wi(_)),cr=_=>ur(Oi(_)),br=_=>ur(fn(_)),en=_=>ur(Kt(_));function ur(_){return _.slice().sort((o,h)=>o.line&&h.line?o.line-h.line:0)}function Kr(_,o){let h=!1;if(o&&o.length)for(const x of o)x instanceof nr?s.w(x.message):(_.fire(new s.a(new Error(x.message))),h=!0);return h}const Vr=new s.F({anchor:new s.G(s.D.light.anchor),position:new s.H(s.D.light.position),color:new s.G(s.D.light.color),intensity:new s.G(s.D.light.intensity)});class cn extends s.E{constructor(o,h="flat"){super(),this._transitionable=new s.J(Vr),this.setLight(o,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h,x={}){this._validate(Pi,o,x)||(this._transitionable.setTransitionOrValue(o),this.id=h)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,x){return(!x||x.validate!==!1)&&Kr(this,o.call(_i,s.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:s.D})))}}const Xn=new s.F({source:new s.G(s.D.terrain.source),exaggeration:new s.G(s.D.terrain.exaggeration)});let Mr=class extends s.E{constructor(_,o,h,x){super(),this.scope=h,this._transitionable=new s.J(Xn,h,x),this._transitionable.setTransitionOrValue(_,x),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(_,o){this._transitionable.setTransitionOrValue(_,o)}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}getExaggeration(_){return this._transitioning.possiblyEvaluate(new s.K(_)).get("exaggeration")}isZoomDependent(){const _=this._transitionable._values.exaggeration;return _!=null&&_.value!=null&&_.value.expression!=null&&_.value.expression instanceof s.Z}};const Fr=45,ri=65,mi=.05;function gi(_,o,h,x){const I=s.O(Fr,ri,h),[A,D]=Xi(_,x);let N=1-Math.min(1,Math.exp((o-A)/(D-A)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*I*_.alpha}function Xi(_,o){const h=.5/Math.tan(.5*o);return[_.range[0]+h,_.range[1]+h]}function mo(_,o,h,x,I){const A=s.N.transformMat4([],[o,h,x],I.mercatorFogMatrix);return gi(_,s.N.length(A),I.pitch,I._fov)}function eo(_,o,h,x,I,A,D){const N=[[h,x,0],[I,x,0],[I,A,0],[h,A,0]];let U=Number.MAX_VALUE,Z=-Number.MAX_VALUE;for(const J of N){const ee=s.N.transformMat4([],J,o),ae=s.N.length(ee);U=Math.min(U,ae),Z=Math.max(Z,ae)}return[gi(_,U,D.pitch,D._fov),gi(_,Z,D.pitch,D._fov)]}const Se=new s.F({range:new s.G(s.D.fog.range),color:new s.G(s.D.fog.color),"high-color":new s.G(s.D.fog["high-color"]),"space-color":new s.G(s.D.fog["space-color"]),"horizon-blend":new s.G(s.D.fog["horizon-blend"]),"star-intensity":new s.G(s.D.fog["star-intensity"]),"vertical-range":new s.G(s.D.fog["vertical-range"])});class Re extends s.E{constructor(o,h,x,I){super(),this._transitionable=new s.J(Se,x,new Map(I)),this.set(o,I),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new s.Q(Se)}get state(){const o=this._transform,h=o.projection.name==="globe",x=s.S(o.zoom),I=this.properties.get("range"),A=[.5,3];return{range:h?[s.U(A[0],I[0],x),s.U(A[1],I[1],x)]:I,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h,x={}){if(this._validate(qe,o,x))return;const I=s.e({},o);for(const A of Object.keys(s.D.fog))I[A]===void 0&&(I[A]=s.D.fog[A].default);this._options=I,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.O(Fr,ri,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?function(x,I,A){const D=s.L.fromLngLat(I),N=A.elevation?A.elevation.getAtPointOrZero(D):0;return mo(x,D.x,D.y,N,A)}(this.state,o,h):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const h=this._transform.calculateFogTileMatrix(o.toUnwrapped());return eo(this.state,h,0,0,s.V,s.V,this._transform)}getOpacityForBounds(o,h,x,I,A){return this._transform.projection.supportsFog?eo(this.state,o,h,x,I,A,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Xi(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const h=[4,5,6,7];for(const x of h){const I=o.points[x];let A;if(I[2]>=0)A=I;else{const D=o.points[x-4];A=s.W(D,I,D[2]/(D[2]-I[2]))}if(mo(this.state,A[0],A[1],0,this._transform)>=mi)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,x){return(!x||x.validate!==!1)&&Kr(this,o.call(_i,s.e({value:h,style:{glyphs:!0,sprite:!0},styleSpec:s.D})))}}class Fe extends s.E{constructor(o,h,x,I){super(),this.scope=x,this._options=o,this.properties=new s.Q(h),this._transitionable=new s.J(h,x,new Map(I)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,h){this._options=o,this._transitionable.setTransitionOrValue(o.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const et=new s.F({color:new s.G(s.D.properties_light_ambient.color),intensity:new s.G(s.D.properties_light_ambient.intensity)}),it=new s.F({direction:new s.X(s.D.properties_light_directional.direction),color:new s.G(s.D.properties_light_directional.color),intensity:new s.G(s.D.properties_light_directional.intensity),"cast-shadows":new s.G(s.D.properties_light_directional["cast-shadows"]),"shadow-intensity":new s.G(s.D.properties_light_directional["shadow-intensity"])});class wt{constructor(o,h,x,I){this.screenBounds=o,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,I)}static createFromScreenPoints(o,h){let x,I;if(o instanceof s.P||typeof o[0]=="number"){const A=s.P.convert(o);x=[A],I=h.isPointAboveHorizon(A)}else{const A=s.P.convert(o[0]),D=s.P.convert(o[1]);x=[A,D],I=s.Y(A,D).every(N=>h.isPointAboveHorizon(N))}return new wt(x,h.getCameraPoint(),I,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return s.Y(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const h=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],I=s.Y(h,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<x.x?I.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?I[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(I[3]=this.cameraPoint)),s._(I,o)}bufferedCameraGeometryGlobe(o){const h=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],I=s.Y(h,x,o),A=this.cameraPoint.clone();switch(3*((A.y>h.y)+(A.y>x.y))+((A.x>h.x)+(A.x>x.x))){case 0:I[0]=A,I[4]=A.clone();break;case 1:I.splice(1,0,A);break;case 2:I[1]=A;break;case 3:I.splice(4,0,A);break;case 5:I.splice(2,0,A);break;case 6:I[3]=A;break;case 7:I.splice(3,0,A);break;case 8:I[2]=A}return I}containsTile(o,h,x,I=0){const A=o.queryPadding/h._pixelsPerMercatorPixel+1,D=x?this._bufferedCameraMercator(A,h):this._bufferedScreenMercator(A,h);let N=o.tileID.wrap+(D.unwrapped?I:0);const U=D.polygon.map(Ce=>s.$(o.tileTransform,Ce,N));if(!s.a0(U,0,0,s.V,s.V))return;N=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?I:0);const Z=this.screenGeometryMercator.polygon.map(Ce=>s.a1(o.tileTransform,Ce,N)),J=Z.map(Ce=>new s.P(Ce[0],Ce[1])),ee=h.getFreeCameraOptions().position||new s.L(0,0,0),ae=s.a1(o.tileTransform,ee,N),he=Z.map(Ce=>{const ge=s.N.sub(Ce,Ce,ae);return s.N.normalize(ge,ge),new s.a2(ae,ge)}),we=s.a3(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:J,tilespaceRays:he,bufferedTilespaceGeometry:U,bufferedTilespaceBounds:(xe=s.a4(U),xe.min.x=s.aa(xe.min.x,0,s.V),xe.min.y=s.aa(xe.min.y,0,s.V),xe.max.x=s.aa(xe.max.x,0,s.V),xe.max.y=s.aa(xe.max.y,0,s.V),xe),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:we};var xe}_bufferedScreenMercator(o,h){const x=Le(o);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let I;return I=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map(A=>h.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[x]=I,I}}_bufferedCameraMercator(o,h){const x=Le(o);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let I;return I=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map(A=>h.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[x]=I,I}}_projectAndResample(o,h){const x=function(A,D){const N=s.a6.multiply([],D.pixelMatrix,D.globeMatrix),U=[0,-s.ab,0,1],Z=[0,s.ab,0,1],J=[0,0,0,1];s.a7.transformMat4(U,U,N),s.a7.transformMat4(Z,Z,N),s.a7.transformMat4(J,J,N);const ee=new s.P(U[0]/U[3],U[1]/U[3]),ae=new s.P(Z[0]/Z[3],Z[1]/Z[3]),he=s.a8(A,ee)&&U[3]<J[3],we=s.a8(A,ae)&&Z[3]<J[3];if(!he&&!we)return null;const xe=function(Ke,st,pt){for(let Tt=1;Tt<Ke.length;Tt++){const Zt=ve(st.pointCoordinate3D(Ke[Tt-1]).x),xt=ve(st.pointCoordinate3D(Ke[Tt]).x);if(pt<0){if(Zt<xt)return{idx:Tt,t:-Zt/(xt-1-Zt)}}else if(xt<Zt)return{idx:Tt,t:(1-Zt)/(xt+1-Zt)}}return null}(A,D,he?-1:1);if(!xe)return null;const{idx:Ce,t:ge}=xe;let De=Ce>1?$e(A.slice(0,Ce),D):[],Xe=Ce<A.length?$e(A.slice(Ce),D):[];De=De.map(Ke=>new s.P(ve(Ke.x),Ke.y)),Xe=Xe.map(Ke=>new s.P(ve(Ke.x),Ke.y));const Be=[...De];Be.length===0&&Be.push(Xe[Xe.length-1]);const We=s.U(Be[Be.length-1].y,(Xe.length===0?De[0]:Xe[0]).y,ge);let Pe;return Pe=he?[new s.P(0,We),new s.P(0,0),new s.P(1,0),new s.P(1,We)]:[new s.P(1,We),new s.P(1,1),new s.P(0,1),new s.P(0,We)],Be.push(...Pe),Xe.length===0?Be.push(De[0]):Be.push(...Xe),{polygon:Be.map(Ke=>new s.L(Ke.x,Ke.y)),unwrapped:!1}}(o,h);if(x)return x;const I=function(A,D){let N=!1,U=-1/0,Z=0;for(let ee=0;ee<A.length-1;ee++)A[ee].x>U&&(U=A[ee].x,Z=ee);for(let ee=0;ee<A.length-1;ee++){const ae=(Z+ee)%(A.length-1),he=A[ae],we=A[ae+1];Math.abs(he.x-we.x)>.5&&(he.x<we.x?(he.x+=1,ae===0&&(A[A.length-1].x+=1)):(we.x+=1,ae+1===A.length-1&&(A[0].x+=1)),N=!0)}const J=s.a5(D.center.lng);return N&&J<Math.abs(J-1)&&A.forEach(ee=>{ee.x-=1}),{polygon:A,unwrapped:N}}($e(o,h).map(A=>new s.P(ve(A.x),A.y)),h);return{polygon:I.polygon.map(A=>new s.L(A.x,A.y)),unwrapped:I.unwrapped}}}function $e(_,o){return s.a9(_,h=>{const x=o.pointCoordinate3D(h);h.x=x.x,h.y=x.y},1/256)}function ve(_){return _<0?1+_%1:_%1}function Le(_){return 100*_|0}function ot(_,o,h,x,I){const A=function(D,N){if(D)return I(D);if(N){_.url&&N.tiles&&_.tiles&&delete _.tiles;const U=s.ac(s.e(N,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);N.vector_layers&&(U.vectorLayers=N.vector_layers,U.vectorLayerIds=U.vectorLayers.map(Z=>Z.id)),N.raster_layers&&(U.rasterLayers=N.raster_layers,U.rasterLayerIds=U.rasterLayers.map(Z=>Z.id)),U.tiles=o.canonicalizeTileset(U,_.url),I(null,U)}};return _.url?s.g(o.transformRequest(o.normalizeSourceURL(_.url,null,h,x),s.R.Source),A):s.f.frame(()=>A(null,_))}class Mt{constructor(o,h,x){this.bounds=s.ad.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=x||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),x=Math.floor(s.a5(this.bounds.getWest())*h),I=Math.floor(s.ae(this.bounds.getNorth())*h),A=Math.ceil(s.a5(this.bounds.getEast())*h),D=Math.ceil(s.ae(this.bounds.getSouth())*h);return o.x>=x&&o.x<A&&o.y>=I&&o.y<D}}class Ot extends s.E{constructor(o,h,x,I){if(super(),this.id=o,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.ac(h,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(I),this._tileWorkers={},this._deduped=new s.af}load(o){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=ot(this._options,this.map._requestManager,h,x,(I,A)=>{this._tileJSONRequest=null,this._loaded=!0,I?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new s.a(I))):A&&(s.e(this,A),A.bounds&&(this.tileBounds=new Mt(A.bounds,this.minzoom,this.maxzoom)),s.aj(A.tiles,this.map._requestManager._customAccessToken),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),o&&o(I)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=s.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.e({},this._options)}loadTile(o,h){const x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),I={request:this.map._requestManager.transformRequest(x,s.R.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster};if(I.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",I,A.bind(this));else if(o.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",I,A.bind(this),void 0,!0);else{const D=s.ah.call({deduped:this._deduped},I,(N,U)=>{N||!U?A.call(this,N):(I.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},o.actor&&o.actor.send("loadTile",I,A.bind(this),void 0,!0))},!0);o.request={cancel:D}}function A(D,N){return delete o.request,o.aborted?h(null):D&&D.status!==404?h(D):(N&&N.resourceTiming&&(o.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&o.setExpiryData(N),o.loadVectorData(N,this.map.painter),s.ai(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class bt extends s.E{constructor(o,h,x,I){super(),this.id=o,this.dispatcher=x,this.setEventedParent(I),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},h),s.e(this,s.ac(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"})),this._tileJSONRequest=ot(this._options,this.map._requestManager,null,null,(h,x)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new s.a(h)):x&&(s.e(this,x),x.bounds&&(this.tileBounds=new Mt(x.bounds,this.minzoom,this.maxzoom)),s.aj(x.tiles),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),o&&o(h)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=s.ag(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const x=s.f.devicePixelRatio>=2,I=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);o.request=s.d(this.map._requestManager.transformRequest(I,s.R.Tile),(A,D,N,U)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):A?(o.state="errored",h(A)):D?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:N,expires:U}),o.setTexture(D,this.map.painter),o.state="loaded",s.ai(this.dispatcher),void h(null)):h(null)))}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&o.texture instanceof s.T?(o.destroy(!0),o.texture&&o.texture instanceof s.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Rt extends bt{constructor(o,h,x,I){super(o,h,x,I),this.type="raster-array",this.maxzoom=22,this._options=s.e({type:"raster-array"},h)}triggerRepaint(o){const h=this.map.painter._terrain,x=this.map.style.getSourceCache(this.id);h&&h.enabled&&x&&h._clearRenderCacheForTile(x.id,o.tileID),this.map.triggerRepaint()}loadTile(o,h){const x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),I=this.map._requestManager.transformRequest(x,s.R.Tile);o.requestParams=I,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(A,D,N,U)=>{if(delete o.request,o.aborted)return o.state="unloaded",h(null);if(A)return A.code===20?void 0:(o.state="errored",h(A));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:N,expires:U}),o.state="empty",h(null)})}unloadTile(o){const h=o.texture;h&&h instanceof s.T?(o.destroy(!0),this.map.painter.saveTileTexture(h)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,h,x){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(h,x,(I,A)=>{if(I)return o.state="errored",this.fire(new s.a(I)),void this.triggerRepaint(o);A&&(o.setTexture(A,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const h=this.rasterLayers.find(({id:A})=>A===o),x=h&&h.fields,I=x&&x.bands&&x.bands;return I?I[0]:0}getTextureDescriptor(o,h,x){if(!o)return;const I=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!I)return;let A=null;h instanceof s.an?A=h.paint.get("raster-array-band"):h instanceof s.ao&&(A=h.paint.get("raster-particle-array-band"));const D=A||this.getInitialBand(I);if(D!=null)if(o.textureDescriptor){if(!o.updateNeeded(I,D)||x)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,I,D)}}const ar=32,qt=33,Nt=new Uint16Array(8184);for(let _=0;_<2046;_++){let o=_+2,h=0,x=0,I=0,A=0,D=0,N=0;for(1&o?I=A=D=ar:h=x=N=ar;(o>>=1)>1;){const Z=h+I>>1,J=x+A>>1;1&o?(I=h,A=x,h=D,x=N):(h=I,x=A,I=D,A=N),D=Z,N=J}const U=4*_;Nt[U+0]=h,Nt[U+1]=x,Nt[U+2]=I,Nt[U+3]=A}const Rr=new Uint16Array(2178),er=new Uint8Array(1089),Nr=new Uint16Array(1089);function Ln(_){return _===0?-.03125:_===32?.03125:0}class $r{constructor(o,h,x,I){this.id=$r.uniqueIdxCounter,$r.uniqueIdxCounter++,this.context=o;const A=o.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||I||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=$r.uniqueIdxCounter,$r.uniqueIdxCounter++;const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}$r.uniqueIdxCounter=0;const si={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yi{constructor(o,h,x,I,A,D){this.length=h.length,this.attributes=x,this.itemSize=h.bytesPerElement,this.dynamicDraw=I,this.instanceCount=D,this.context=o;const N=o.gl;this.buffer=N.createBuffer(),o.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||A||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let x=0;x<this.attributes.length;x++){const I=h.attributes[this.attributes[x].name];I!==void 0&&o.enableVertexAttribArray(I)}}setVertexAttribPointers(o,h,x){for(let I=0;I<this.attributes.length;I++){const A=this.attributes[I],D=h.attributes[A.name];D!==void 0&&o.vertexAttribPointer(D,A.components,o[si[A.type]],!1,this.itemSize,A.offset+this.itemSize*(x||0))}}setVertexAttribDivisor(o,h,x){for(let I=0;I<this.attributes.length;I++){const A=h.attributes[this.attributes[I].name];A!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(A,x)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $i extends xn{getDefault(){return s.ax.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class di extends xn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class vo extends xn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class to extends xn{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class xo extends xn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class so extends xn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ni extends xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class qi extends xn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class rs extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class kl extends xn{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class ga extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ho extends xn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Oc extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class Wl extends xn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Qo extends xn{getDefault(){return s.ax.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Va extends xn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class po extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class Hn extends xn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ra extends xn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Uo=class extends xn{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class Gs extends xn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Os extends xn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class _l extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class qs extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class zf extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class He extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Oe extends xn{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ft extends xn{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class Vt extends xn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Xr extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Gn extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class kn extends xn{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class _a extends kn{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Ca extends kn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ua extends kn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class ya extends Ca{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class va{constructor(o,h,x,I,A){this.context=o,this.width=h,this.height=x;const D=this.framebuffer=o.gl.createFramebuffer();I&&(this.colorAttachment=new _a(o,D)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new Ca(o,D):new Ua(o,D))}destroy(){const o=this.context.gl;if(this.colorAttachment){const h=this.colorAttachment.get();h&&o.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const h=this.depthAttachment.get();h&&o.deleteRenderbuffer(h)}else{const h=this.depthAttachment.get();h&&o.deleteTexture(h)}o.deleteFramebuffer(this.framebuffer)}}class Un{constructor(o,h,x){this.func=o,this.mask=h,this.range=x}}Un.ReadOnly=!1,Un.ReadWrite=!0,Un.disabled=new Un(519,Un.ReadOnly,[0,1]);const Hl=7680;class ui{constructor(o,h,x,I,A,D){this.test=o,this.ref=h,this.mask=x,this.fail=I,this.depthFail=A,this.pass=D}}ui.disabled=new ui({func:519,mask:0},0,0,Hl,Hl,Hl);const Zl=771;class Fi{constructor(o,h,x,I){this.blendFunction=o,this.blendColor=h,this.mask=x,this.blendEquation=I}}Fi.Replace=[1,0,1,0],Fi.disabled=new Fi(Fi.Replace,s.ax.transparent,[!1,!1,!1,!1]),Fi.unblended=new Fi(Fi.Replace,s.ax.transparent,[!0,!0,!0,!0]),Fi.alphaBlended=new Fi([1,Zl,1,Zl],s.ax.transparent,[!0,!0,!0,!0]),Fi.multiply=new Fi([774,0,774,0],s.ax.transparent,[!0,!0,!0,!0]);const tu=1029,ea=2305;class Dn{constructor(o,h,x){this.enable=o,this.mode=h,this.frontFace=x}}Dn.disabled=new Dn(!1,tu,ea),Dn.backCCW=new Dn(!0,tu,ea),Dn.backCW=new Dn(!0,tu,2304),Dn.frontCW=new Dn(!0,1028,2304),Dn.frontCCW=new Dn(!0,1028,ea);class ru{constructor(o,h){this.gl=o,this.clearColor=new $i(this),this.clearDepth=new di(this),this.clearStencil=new vo(this),this.colorMask=new to(this),this.depthMask=new xo(this),this.stencilMask=new so(this),this.stencilFunc=new Ni(this),this.stencilOp=new qi(this),this.stencilTest=new rs(this),this.depthRange=new kl(this),this.depthTest=new ga(this),this.depthFunc=new Ho(this),this.blend=new Oc(this),this.blendFunc=new Wl(this),this.blendColor=new Qo(this),this.blendEquation=new Va(this),this.cullFace=new po(this),this.cullFaceSide=new Hn(this),this.frontFace=new Ra(this),this.program=new Uo(this),this.activeTexture=new Gs(this),this.viewport=new Os(this),this.bindFramebuffer=new _l(this),this.bindRenderbuffer=new qs(this),this.bindTexture=new zf(this),this.bindVertexBuffer=new He(this),this.bindElementBuffer=new Oe(this),this.bindVertexArrayOES=new ft(this),this.pixelStoreUnpack=new Vt(this),this.pixelStoreUnpackPremultiplyAlpha=new Xr(this),this.pixelStoreUnpackFlipY=new Gn(this),this.options=h?{...h}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h,x){return new $r(this,o,h,x)}createVertexBuffer(o,h,x,I,A){return new Yi(this,o,h,x,I,A)}createRenderbuffer(o,h,x){const I=this.gl,A=I.createRenderbuffer();return this.bindRenderbuffer.set(A),I.renderbufferStorage(I.RENDERBUFFER,o,h,x),this.bindRenderbuffer.set(null),A}createFramebuffer(o,h,x,I){return new va(this,o,h,x,I)}clear({color:o,depth:h,stencil:x,colorMask:I}){const A=this.gl;let D=0;o&&(D|=A.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(I||[!0,!0,!0,!0])),h!==void 0&&(D|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),x!==void 0&&(D|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),A.clear(D)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){L(o.blendFunction,Fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}var Rl=s.ay([{name:"a_pos",type:"Float32",components:3}]);class ta{constructor(o,h,x,I){const A={width:x[0],height:x[1],data:null},D=o.gl;this.targetColorTexture=new s.T(o,A,D.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new s.T(o,A,D.RGBA,{useMipmap:!1}),this.context=o,this.setNumParticles(h,I),this.lastInvalidatedAt=0}setNumParticles(o,h){if(this.numParticles===h)return;(this.particleVertices0||this.particleVertices1||this.particleSegment)&&(this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy());const x=new s.az;x.reserve(Math.round(h));const I=s.aA(o.key);for(let A=0;A<h;A++)x.emplaceBack(I(),I(),I());this.particleVertices0=this.context.createVertexBuffer(x,Rl.members,!0),this.particleVertices1=this.context.createVertexBuffer(x,Rl.members,!0),this.particleSegment=s.aB.simpleSegment(0,0,this.particleVertices0.length,0),this.numParticles=h}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=s.f.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleVertices0.destroy(),this.particleVertices1.destroy(),this.particleSegment.destroy()}}const ms={type:2,extent:s.V,loadGeometry:()=>[[new s.P(0,0),new s.P(s.V+1,0),new s.P(s.V+1,s.V+1),new s.P(0,s.V+1),new s.P(0,0)]]};class hc{constructor(o,h,x,I,A){this.tileID=o,this.uid=s.aC(),this.uses=0,this.tileSize=h,this.tileZoom=x,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,I&&I.style&&(this._lastUpdatedBrightness=I.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",I&&I.transform&&(this.projection=I.transform.projection)}registerFadeDuration(o){const h=o+this.timeAdded;h<s.f.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.as(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,h,x){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(I,A){const D={};if(!A)return D;for(const N of I){const U=N.layerIds.map(Z=>A.getLayer(Z)).filter(Boolean);if(U.length!==0){N.layers=U,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(Z=>U.filter(J=>J.id===Z)[0]));for(const Z of U)D[Z.fqid]=N}}return D}(o.buckets,h.style),this.hasSymbolBuckets=!1;for(const I in this.buckets){const A=this.buckets[I];if(A instanceof s.aE){if(this.hasSymbolBuckets=!0,!x)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const I in this.buckets){const A=this.buckets[I];if(A instanceof s.aE&&A.hasRTLText){this.hasRTLText=!0,s.aF();break}}this.queryPadding=0;for(const I in this.buckets){const A=this.buckets[I],D=h.style.getOwnLayer(I);if(!D)continue;const N=D.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,N)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new s.aD}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const I in this.buckets){const A=this.buckets[I];A.uploadPending()&&A.upload(o)}const h=o.gl,x=this.imageAtlas;if(x&&!x.uploaded){const I=!!Object.keys(x.patternPositions).length;this.imageAtlasTexture=new s.T(o,x.image,h.RGBA,{useMipmap:I}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(o,this.glyphAtlasImage,h.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(o,this.lineAtlas.image,h.R8),this.lineAtlas.uploaded=!0)}prepare(o,h,x){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,x),!h||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const I=h.style.getBrightness();(this._lastUpdatedBrightness||I)&&(this._lastUpdatedBrightness&&I&&Math.abs(this._lastUpdatedBrightness-I)<.001||(this._lastUpdatedBrightness=I,this.updateBuckets(void 0,h)))}queryRenderedFeatures(o,h,x,I,A,D,N,U){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:I,pixelPosMatrix:N,transform:D,params:A,tileTransform:this.tileTransform},o,h,x):{}}querySourceFeatures(o,h){const x=this.latestFeatureIndex;if(!x||!x.rawTileData)return;const I=x.loadVTLayers(),A=h?h.sourceLayer:"",D=I._geojsonTileLayer||I[A];if(!D)return;const N=s.aG(h&&h.filter),{z:U,x:Z,y:J}=this.tileID.canonical,ee={z:U,x:Z,y:J};for(let ae=0;ae<D.length;ae++){const he=D.feature(ae);if(N.needGeometry){const Ce=s.aH(he,!0);if(!N.filter(new s.K(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!N.filter(new s.K(this.tileID.overscaledZ),he))continue;const we=x.getId(he,A),xe=new s.aI(he,U,Z,J,we);xe.tile=ee,o.push(xe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const o in this.buckets)if(this.buckets[o].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const h=this.expirationTime;if(o.cacheControl){const x=s.aJ(o.cacheControl);x["max-age"]&&(this.expirationTime=Date.now()+1e3*x["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const x=Date.now();let I=!1;if(this.expirationTime>x)I=!1;else if(h)if(this.expirationTime<h)I=!0;else{const A=this.expirationTime-h;A?this.expirationTime=x+Math.max(A,3e4):I=!0}else I=!0;I?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,h){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(o).length!==0&&h&&this.updateBuckets(o,h)}updateBuckets(o,h){if(!this.latestFeatureIndex)return;const x=this.latestFeatureIndex.loadVTLayers(),I=h.style.listImages(),A=h.style.getBrightness();for(const D in this.buckets){if(!h.style.hasLayer(D))continue;const N=this.buckets[D],U=N.layers[0].sourceLayer||"_geojsonTileLayer",Z=x[U];let J={};if(o&&(J=o[U],!Z||!J||Object.keys(J).length===0))continue;if(N.update(J,Z,I,this.imageAtlas&&this.imageAtlas.patternPositions||{},A),N instanceof s.aK||N instanceof s.aL){const ae=h.style.getOwnSourceCache(N.layers[0].source);h._terrain&&h._terrain.enabled&&ae&&N.programConfigurations.needsUpload&&h._terrain._clearRenderCacheForTile(ae.id,this.tileID)}const ee=h&&h.style&&h.style.getOwnLayer(D);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.f.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=s.f.now()+o}setTexture(o,h){const x=h.context,I=x.gl;this.texture=this.texture||h.getTileTexture(o.width),this.texture&&this.texture instanceof s.T?this.texture.update(o,{useMipmap:!0}):(this.texture=new s.T(x,o,I.RGBA,{useMipmap:!0}),this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE))}setDependencies(o,h){const x={};for(const I of h)x[I]=!0;this.dependencies[o]=x}hasDependency(o,h){for(const x of o){const I=this.dependencies[x];if(I){for(const A of h)if(I[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,h){if(!h||h.name==="mercator"||this._tileDebugBuffer)return;const x=s.aM(ms,this.tileID.canonical,this.tileTransform)[0],I=new s.aN,A=new s.aO;for(let D=0;D<x.length;D++){const{x:N,y:U}=x[D];I.emplaceBack(N,U),A.emplaceBack(D)}A.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(A),this._tileDebugBuffer=o.createVertexBuffer(I,s.aP.members),this._tileDebugSegments=s.aB.simpleSegment(0,0,I.length,A.length)}_makeTileBoundsBuffers(o,h){if(this._tileBoundsBuffer||!h||h.name==="mercator")return;const x=s.aM(ms,this.tileID.canonical,this.tileTransform)[0];let I,A;if(this.isRaster){const D=function(N,U){const Z=s.as(N,U),J=Math.pow(2,N.z);for(let Ce=0;Ce<qt;Ce++)for(let ge=0;ge<qt;ge++){const De=s.at((N.x+(ge+Ln(ge))/ar)/J),Xe=s.au((N.y+(Ce+Ln(Ce))/ar)/J),Be=U.project(De,Xe),We=Ce*qt+ge;Rr[2*We+0]=Math.round((Be.x*Z.scale-Z.x)*s.V),Rr[2*We+1]=Math.round((Be.y*Z.scale-Z.y)*s.V)}er.fill(0),Nr.fill(0);for(let Ce=2045;Ce>=0;Ce--){const ge=4*Ce,De=Nt[ge+0],Xe=Nt[ge+1],Be=Nt[ge+2],We=Nt[ge+3],Pe=De+Be>>1,Ke=Xe+We>>1,st=Pe+Ke-Xe,pt=Ke+De-Pe,Tt=Xe*qt+De,Zt=We*qt+Be,xt=Ke*qt+Pe,hr=Math.hypot((Rr[2*Tt+0]+Rr[2*Zt+0])/2-Rr[2*xt+0],(Rr[2*Tt+1]+Rr[2*Zt+1])/2-Rr[2*xt+1])>=16;er[xt]=er[xt]||(hr?1:0),Ce<1022&&(er[xt]=er[xt]||er[(Xe+pt>>1)*qt+(De+st>>1)]||er[(We+pt>>1)*qt+(Be+st>>1)])}const ee=new s.av,ae=new s.aw;let he=0;function we(Ce,ge){const De=ge*qt+Ce;return Nr[De]===0&&(ee.emplaceBack(Rr[2*De+0],Rr[2*De+1],Ce*s.V/ar,ge*s.V/ar),Nr[De]=++he),Nr[De]-1}function xe(Ce,ge,De,Xe,Be,We){const Pe=Ce+De>>1,Ke=ge+Xe>>1;if(Math.abs(Ce-Be)+Math.abs(ge-We)>1&&er[Ke*qt+Pe])xe(Be,We,Ce,ge,Pe,Ke),xe(De,Xe,Be,We,Pe,Ke);else{const st=we(Ce,ge),pt=we(De,Xe),Tt=we(Be,We);ae.emplaceBack(st,pt,Tt)}}return xe(0,0,ar,ar,ar,0),xe(ar,ar,0,0,0,ar),{vertices:ee,indices:ae}}(this.tileID.canonical,h);I=D.vertices,A=D.indices}else{I=new s.av,A=new s.aw;for(const{x:N,y:U}of x)I.emplaceBack(N,U,0,0);const D=s.aQ(I.int16,void 0,4);for(let N=0;N<D.length;N+=3)A.emplaceBack(D[N],D[N+1],D[N+2])}this._tileBoundsBuffer=o.createVertexBuffer(I,s.aR.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(A),this._tileBoundsSegments=s.aB.simpleSegment(0,0,I.length,A.length)}_makeGlobeTileDebugBuffers(o,h){const x=h.projection;if(!x||x.name!=="globe"||h.freezeTileCoverage)return;const I=this.tileID.canonical,A=s.aS(I,h),D=s.aT(A),N=s.S(h.zoom);let U;N>0&&(U=s.a6.invert(new Float64Array(16),h.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,I,h,D,U,N),this._makeGlobeTileDebugTextBuffer(o,I,h,D,U,N)}_globePoint(o,h,x,I,A,D,N){let U=s.aU(o,h,x);if(D){const Z=1<<x.z,J=s.a5(I.center.lng),ee=s.ae(I.center.lat),ae=(x.x+.5)/Z-J;let he=0;ae>.5?he=-1:ae<-.5&&(he=1);let we=(o/s.V+x.x)/Z+he,xe=(h/s.V+x.y)/Z;we=(we-J)*I._pixelsPerMercatorPixel+J,xe=(xe-ee)*I._pixelsPerMercatorPixel+ee;const Ce=[we*I.worldSize,xe*I.worldSize,0];s.N.transformMat4(Ce,Ce,D),U=s.aV(U,Ce,N)}return s.N.transformMat4(U,U,A)}_makeGlobeTileDebugBorderBuffer(o,h,x,I,A,D){const N=new s.aN,U=new s.aO,Z=new s.aW,J=(ae,he,we,xe,Ce)=>{const ge=(we-ae)/(Ce-1),De=(xe-he)/(Ce-1),Xe=N.length;for(let Be=0;Be<Ce;Be++){const We=ae+Be*ge,Pe=he+Be*De;N.emplaceBack(We,Pe);const Ke=this._globePoint(We,Pe,h,x,I,A,D);Z.emplaceBack(Ke[0],Ke[1],Ke[2]),U.emplaceBack(Xe+Be)}},ee=s.V;J(0,0,ee,0,16),J(ee,0,ee,ee,16),J(ee,ee,0,ee,16),J(0,ee,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(U),this._tileDebugBuffer=o.createVertexBuffer(N,s.aP.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(Z,s.aX.members),this._tileDebugSegments=s.aB.simpleSegment(0,0,N.length,U.length)}_makeGlobeTileDebugTextBuffer(o,h,x,I,A,D){const N=s.V/4,U=new s.aN,Z=new s.aw,J=new s.aW,ee=25;Z.reserve(32),U.reserve(ee),J.reserve(ee);const ae=(he,we)=>ee*he+we;for(let he=0;he<ee;he++){const we=he*N;for(let xe=0;xe<ee;xe++){const Ce=xe*N;U.emplaceBack(Ce,we);const ge=this._globePoint(Ce,we,h,x,I,A,D);J.emplaceBack(ge[0],ge[1],ge[2])}}for(let he=0;he<4;he++)for(let we=0;we<4;we++){const xe=ae(he,we),Ce=ae(he,we+1),ge=ae(he+1,we),De=ae(he+1,we+1);Z.emplaceBack(xe,Ce,ge),Z.emplaceBack(ge,Ce,De)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(Z),this._tileDebugTextBuffer=o.createVertexBuffer(U,s.aP.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(J,s.aX.members),this._tileDebugTextSegments=s.aB.simpleSegment(0,0,ee,32)}destroy(o=!1){for(const h in this.buckets)this.buckets[h].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}const $a={vector:Ot,raster:bt,"raster-dem":class extends bt{constructor(_,o,h,x){super(_,o,h,x),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(_,o){const h=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(I,A){I&&(_.state="errored",o(I)),A&&(_.dem=A,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",o(null))}_.request=s.d(this.map._requestManager.transformRequest(h,s.R.Tile),(function(I,A,D,N){if(delete _.request,_.aborted)_.state="unloaded",o(null);else if(I)_.state="errored",o(I);else if(A){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:D,expires:N});const U=ImageBitmap&&A instanceof ImageBitmap&&s.ak(),Z=1-(A.width-s.al(A.width))/2;Z<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const J=U?A:s.f.getImageData(A,Z),ee={uid:_.uid,coord:_.tileID,source:this.id,scope:this.scope,rawImageData:J,encoding:this.encoding,padding:Z};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",ee,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const o=_.canonical,h=Math.pow(2,o.z),x=(o.x-1+h)%h,I=o.x===0?_.wrap-1:_.wrap,A=(o.x+1+h)%h,D=o.x+1===h?_.wrap+1:_.wrap,N={};return N[new s.am(_.overscaledZ,I,o.z,x,o.y).key]={backfilled:!1},N[new s.am(_.overscaledZ,D,o.z,A,o.y).key]={backfilled:!1},o.y>0&&(N[new s.am(_.overscaledZ,I,o.z,x,o.y-1).key]={backfilled:!1},N[new s.am(_.overscaledZ,_.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},N[new s.am(_.overscaledZ,D,o.z,A,o.y-1).key]={backfilled:!1}),o.y+1<h&&(N[new s.am(_.overscaledZ,I,o.z,x,o.y+1).key]={backfilled:!1},N[new s.am(_.overscaledZ,_.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},N[new s.am(_.overscaledZ,D,o.z,A,o.y+1).key]={backfilled:!1}),N}},"raster-array":Rt,geojson:class extends s.E{constructor(_,o,h,x){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(x),this._data=o.data,this._options=s.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const I=s.V/this.tileSize;this.workerOptions=s.e({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*I,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*I,extent:s.V,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.V,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*I,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id,scope:this.scope},o),this}getClusterChildren(_,o){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id,scope:this.scope},o),this}getClusterLeaves(_,o,h,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:_,limit:o,offset:h},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.b("dataloading",{dataType:"source"})),this._loaded=!1;const _=s.e({},this.workerOptions);_.scope=this.scope;const o=this._data;typeof o=="string"?(_.request=this.map._requestManager.transformRequest(s.f.resolveURL(o),s.R.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(h,x)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new s.a(h));else{const I={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(I.resourceTiming=x.resourceTiming[this.id]),this.fire(new s.b("data",I)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,o){const h=_.actor?"reloadTile":"loadTile";_.actor=this.actor;const x={type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:s.f.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};_.request=this.actor.send(h,x,(I,A)=>(delete _.request,_.destroy(),_.aborted?o(null):I?o(I):(_.loadVectorData(A,this.map.painter,h==="reloadTile"),o(null))),void 0,h==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id,scope:this.scope}),_.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.ap{constructor(_,o,h,x){super(_,o,h,x),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const o of _.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.R.Source).url);s.aq(this.urls,(o,h)=>{this._loaded=!0,o?this.fire(new s.a(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const o=this.video.seekable;_<o.start(0)||_>o.end(0)?this.fire(new s.a(new mt(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,o=_.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(_,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.ap,model:class extends s.E{constructor(_,o,h,x){super(),this.id=_,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const _=[];for(const o in this._options.models){const h=this._options.models[o],x=s.l(this.map._requestManager.transformRequest(h.uri,s.R.Model).url).then(I=>{if(!I)return;const A=s.c(I),D=new s.M(o,h.position,h.orientation,A);D.computeBoundsAndApplyParent(),this.models.push(D)}).catch(I=>{this.fire(new s.a(new Error(`Could not load model ${o} from ${h.uri}: ${I.message}`)))});_.push(x)}return Promise.allSettled(_).then(()=>{this._loaded=!0,this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new s.a(new Error(`Could not load models: ${o.message}`)))})}onAdd(_){this.map=_,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(_,o){}serialize(){return{type:"model"}}},"batched-model":class extends s.E{constructor(_,o,h,x){super(),this.type="batched-model",this.id=_,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(x)}onAdd(_){this.map=_,this.load()}load(_){this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map._worldview;this._tileJSONRequest=ot(this._options,this.map._requestManager,o,h,(x,I)=>{this._tileJSONRequest=null,this._loaded=!0,x?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new s.a(x))):I&&(s.e(this,I),I.bounds&&(this.tileBounds=new Mt(I.bounds,this.minzoom,this.maxzoom)),s.aj(I.tiles,this.map._requestManager._customAccessToken),this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))),_&&_(x)})}hasTransition(){return!1}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}loaded(){return this._loaded}loadTile(_,o){const h=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(h,s.R.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:_.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(_.actor&&_.state!=="expired")if(_.state==="loading")_.reloadCallback=o;else{if(_.buckets){const A=Object.values(_.buckets);for(const D of A)D.dirty=!0;return void(_.state="loaded")}_.request=_.actor.send("reloadTile",x,I.bind(this))}else _.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",x,I.bind(this),void 0,!0);function I(A,D){return _.aborted?o(null):A&&A.status!==404?o(A):(D&&(D.resourceTiming&&(_.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&_.setExpiryData(D),_.buckets={..._.buckets,...D.buckets},D.featureIndex&&(_.latestFeatureIndex=D.featureIndex)),_.state="loaded",void o(null))}}serialize(){return s.e({},this._options)}},canvas:class extends s.ap{constructor(_,o,h,x){super(_,o,h,x),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(A=>typeof A!="number"))||this.fire(new s.a(new mt(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.a(new mt(`sources.${_}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.a(new mt(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new s.a(new mt(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.a(new mt(`sources.${_}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.a(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!_&&!this._playing||this.texture instanceof s.ar||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends s.E{constructor(_,o,h,x){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.a(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.a(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Mt(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.e(this,s.ac(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.ac(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.b("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new s.b("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:o,y:h,z:x}=_.canonical;return this._implementation.hasTile({x:o,y:h,z:x})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,o){const{x:h,y:x,z:I}=_.tileID.canonical,A=new AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:h,y:x,z:I},{signal:A.signal})).then((function(D){return delete _.request,_.aborted?(_.state="unloaded",o(null)):D===void 0?(_.state="errored",o(null)):D===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",o(null)):function(N){return N instanceof ImageData||N instanceof HTMLCanvasElement||N instanceof ImageBitmap||N instanceof HTMLImageElement}(D)?(this.loadTileData(_,D),_.state="loaded",void o(null)):(_.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(D=>{D.code!==20&&(_.state="errored",o(D))}),_.request.cancel=()=>A.abort()}loadTileData(_,o){_.setTexture(o,this._map.painter)}unloadTile(_,o){if(_.texture&&_.texture instanceof s.T?(_.destroy(!0),_.texture&&_.texture instanceof s.T&&this._map.painter.saveTileTexture(_.texture)):_.destroy(),this._implementation.unloadTile){const{x:h,y:x,z:I}=_.tileID.canonical;this._implementation.unloadTile({x:h,y:x,z:I})}o()}abortTile(_,o){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){const _=s.ag(this.id,this.scope);this._map.style.clearSource(_)}_update(){this.fire(new s.b("data",{dataType:"source",sourceDataType:"content"}))}}},lo=function(_,o,h,x){const I=new $a[o.type](_,o,h,x);if(I.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${I.id}`);return s.aY(["load","abort","unload","serialize","prepare"],I),I};function Ru(_,o){const h=s.a6.identity([]);return s.a6.scale(h,h,[.5*_.width,.5*-_.height,1]),s.a6.translate(h,h,[1,-1,0]),s.a6.multiply(h,h,_.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(h)}function Up(_,o,h,x,I,A,D,N=!1){const U=_.tilesIn(x,D,N);U.sort(ed);const Z=[];for(const ee of U)Z.push({wrappedTileID:ee.tile.tileID.wrapped().key,queryResults:ee.tile.queryRenderedFeatures(o,h,_._state,ee,I,A,Ru(_.transform,ee.tile.tileID),N)});const J=function(ee){const ae={},he={};for(const we of ee){const xe=we.queryResults,Ce=we.wrappedTileID,ge=he[Ce]=he[Ce]||{};for(const De in xe){const Xe=xe[De],Be=ge[De]=ge[De]||{},We=ae[De]=ae[De]||[];for(const Pe of Xe)Be[Pe.featureIndex]||(Be[Pe.featureIndex]=!0,We.push(Pe))}}return ae}(Z);for(const ee in J)J[ee].forEach(ae=>{const he=ae.feature,we=he.layer;we&&we.type!=="background"&&we.type!=="sky"&&we.type!=="slot"&&(he.source=we.source,we["source-layer"]&&(he.sourceLayer=we["source-layer"]),he.state=he.id!==void 0?_.getFeatureState(we["source-layer"],he.id):{})});return J}function nu(_,o){const h=_.getRenderableIds().map(A=>_.getTileByID(A)),x=[],I={};for(let A=0;A<h.length;A++){const D=h[A],N=D.tileID.canonical.key;I[N]||(I[N]=!0,D.querySourceFeatures(x,o))}return x}function ed(_,o){const h=_.tileID,x=o.tileID;return h.overscaledZ-x.overscaledZ||h.canonical.y-x.canonical.y||h.wrap-x.wrap||h.canonical.x-x.canonical.x}class iu extends hc{constructor(o,h,x,I,A){super(o,h,x,I,A),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(o,h){const x=h.context,I=x.gl;this.texture=this.texture||h.getTileTexture(o.width),this.texture&&this.texture instanceof s.T?this.texture.update(o,{useMipmap:!1,premultiply:!1}):this.texture=new s.T(x,o,I.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,h){const x=this._mrt=new s.aZ(30),I=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=s.a_(I,(A,D,N,U)=>{if(A)h(A);else try{const Z=x.getHeaderLength(D);if(Z>o)return void(this.request=this.fetchHeader(Z,h));x.parseHeader(D),this._isHeaderLoaded=!0;let J=0;for(const ee of Object.values(x.layers))J=Math.max(J,ee.dataIndex[ee.dataIndex.length-1].last_byte);D.byteLength>=J&&(this.entireBuffer=D),h(null,this.entireBuffer||D,N,U)}catch(Z){h(Z)}}),this.request}fetchBand(o,h,x){const I=this._mrt;if(!this._isHeaderLoaded||!I)return void x(new Error("Tile header is not ready"));const A=this.actor;if(!A)return void x(new Error("Can't fetch tile band without an actor"));let D;const N=(ee,ae)=>{D.complete(ee,ae),ee?x(ee):(this.updateTextureDescriptor(o,h),x(null,this.textureDescriptor&&this.textureDescriptor.img))},U=(ee,ae)=>{if(ee)return x(ee);const he=A.send("decodeRasterArray",{buffer:ae,task:D},N,void 0,!0);this._workQueue.push(()=>{he&&he.cancel(),D.cancel()})},Z=I.getLayer(o);if(!Z)return void x(new Error(`Unknown sourceLayer "${o}"`));if(Z.hasDataForBand(h))return this.updateTextureDescriptor(o,h),void x(null,this.textureDescriptor?this.textureDescriptor.img:null);const J=Z.getDataRange([h]);if(D=I.createDecodingTask(J),!D||D.tasks.length)if(this.flushQueues(),this.entireBuffer)U(null,this.entireBuffer.slice(J.firstByte,J.lastByte+1));else{const ee=Object.assign({},this.requestParams,{headers:{Range:`bytes=${J.firstByte}-${J.lastByte}`}}),ae=s.a_(ee,U);this._fetchQueue.push(()=>{ae.cancel(),D.cancel()})}else x(null)}updateNeeded(o,h){return(!this.textureDescriptor||this.textureDescriptor.band!==h||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,h){if(!this._mrt)return;const x=this._mrt.getLayer(o);if(!x||!x.hasBand(h)||!x.hasDataForBand(h))return;const{bytes:I,tileSize:A,buffer:D,offset:N,scale:U}=x.getBandView(h),Z=A+2*D,J={data:I,width:Z,height:Z},ee=this.texture;ee&&ee instanceof s.T&&ee.update(J,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:o,band:h,img:J,buffer:D,offset:N,tileSize:A,format:x.pixelFormat,mix:[U,256*U,65536*U,16777216*U]}}}class Du{constructor(o,h){this.max=o,this.onRemove=h,this.reset()}reset(){for(const o in this.data)for(const h of this.data[o])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(o,h,x){const I=o.wrapped().key;this.data[I]===void 0&&(this.data[I]=[]);const A={value:h,timeout:void 0};if(x!==void 0&&(A.timeout=setTimeout(()=>{this.remove(o,A)},x)),this.data[I].push(A),this.order.push(I),this.order.length>this.max){const D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const h=this.data[o].shift();return h.timeout&&clearTimeout(h.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),h.value}getByKey(o){const h=this.data[o];return h?h[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,h){if(!this.has(o))return this;const x=o.wrapped().key,I=h===void 0?0:this.data[x].indexOf(h),A=this.data[x][I];return this.data[x].splice(I,1),A.timeout&&clearTimeout(A.timeout),this.data[x].length===0&&delete this.data[x],this.onRemove(A.value),this.order.splice(this.order.indexOf(x),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(o){const h=[];for(const x in this.data)for(const I of this.data[x])o(I.value)||h.push(I);for(const x of h)this.remove(x.value.tileID,x)}}class Dl extends s.E{constructor(o,h,x){super(),this.id=o,this._onlySymbols=x,h.on("data",I=>{I.dataType==="source"&&I.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&I.dataType==="source"&&I.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),h.on("error",()=>{this._sourceErrored=!0}),this._source=h,this._tiles={},this._cache=new Du(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Et,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const h=this._tiles[o];if(h.state!=="errored"&&(h.state!=="loaded"||!h.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,h){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,h)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const x=this._tiles[h];x.upload(o),x.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return s.a$(this._tiles).map(o=>o.tileID).sort(td).map(o=>o.key)}getRenderableIds(o,h){const x=[];for(const I in this._tiles)this._isIdRenderable(+I,o,h)&&x.push(this._tiles[I]);return o?x.sort((I,A)=>{const D=I.tileID,N=A.tileID,U=new s.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle),Z=new s.P(N.canonical.x,N.canonical.y)._rotate(this.transform.angle);return D.overscaledZ-N.overscaledZ||Z.y-U.y||Z.x-U.x}).map(I=>I.tileID.key):x.map(I=>I.tileID).sort(td).map(I=>I.key)}hasRenderableParent(o){const h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(o,h,x){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())&&(x||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,h){const x=this._tiles[o];x&&(x.state!=="loading"&&(x.state=h),this._loadTile(x,this._tileLoaded.bind(this,x,o,h)))}_tileLoaded(o,h,x,I){if(I)if(o.state="errored",I.status!==404)this._source.fire(new s.a(I,{tile:o}));else{if(!(o.tileID.key in this._loadedParentTiles))return void this._source.fire(new s.b("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=s.f.now(),x==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new s.b("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const h=this.getRenderableIds();for(let I=0;I<h.length;I++){const A=h[I];if(o.neighboringTiles&&o.neighboringTiles[A]){const D=this.getTileByID(A);x(o,D),x(D,o)}}function x(I,A){if(!I.dem||I.dem.borderReady)return;I.needsHillshadePrepare=!0,I.needsDEMTextureUpload=!0;let D=A.tileID.canonical.x-I.tileID.canonical.x;const N=A.tileID.canonical.y-I.tileID.canonical.y,U=Math.pow(2,I.tileID.canonical.z),Z=A.tileID.key;D===0&&N===0||Math.abs(N)>1||(Math.abs(D)>1&&(Math.abs(D+U)===1?D+=U:Math.abs(D-U)===1&&(D-=U)),A.dem&&I.dem&&(I.dem.backfillBorder(A.dem,D,N),I.neighboringTiles&&I.neighboringTiles[Z]&&(I.neighboringTiles[Z].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,h,x,I){for(const A in this._tiles){let D=this._tiles[A];if(I[A]||!D.hasData()||D.tileID.overscaledZ<=h||D.tileID.overscaledZ>x)continue;let N=D.tileID;for(;D&&D.tileID.overscaledZ>h+1;){const Z=D.tileID.scaledTo(D.tileID.overscaledZ-1);D=this._tiles[Z.key],D&&D.hasData()&&(N=Z)}let U=N;for(;U.overscaledZ>h;)if(U=U.scaledTo(U.overscaledZ-1),o[U.key]){I[N.key]=N;break}}}findLoadedParent(o,h){if(o.key in this._loadedParentTiles){const x=this._loadedParentTiles[o.key];return x&&x.tileID.overscaledZ>=h?x:null}for(let x=o.overscaledZ-1;x>=h;x--){const I=o.scaledTo(x),A=this._getLoadedTile(I);if(A)return A}}_getLoadedTile(o){const h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,h){h=h||this._source.tileSize;const x=Math.ceil(o.width/h)+1,I=Math.ceil(o.height/h)+1,A=Math.floor(x*I*5),D=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,D):D;this._cache.setMaxSize(N)}handleWrapJump(o){const h=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,h){const x={};for(const I in this._tiles){const A=this._tiles[I];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+h),x[A.tileID.key]=A}this._tiles=x;for(const I in this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(const I in this._tiles)this._setTileReloadTimer(+I,this._tiles[I])}}update(o,h,x,I){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!x)return;let A;if(this.updateCacheSize(o,h),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain)if(this._source.tileID)A=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new s.am(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y));else if(this.tileCoverLift!==0){const U=o.clone();U.tileCoverLift=this.tileCoverLift,A=U.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!x,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&o.projection.name==="globe"&&(A.push(new s.am(1,0,1,0,0)),A.push(new s.am(1,0,1,1,0)),A.push(new s.am(1,0,1,0,1)),A.push(new s.am(1,0,1,1,1)))}else A=o.coveringTiles({tileSize:h||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!x,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(A=A.filter(U=>this._source.hasTile(U)));else A=[];if(A.length>0&&this.castsShadows&&I&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Lc(this._source.type)){const U=o.coveringZoomLevel({tileSize:h||this._source.tileSize,roundZoom:this._source.roundZoom&&!x}),Z=Math.min(U,this._source.maxzoom),J=o.extendTileCoverForShadows(A,I,Z);for(const ee of J)this._shadowCasterTiles[ee.key]=!0,A.push(ee)}const D=this._updateRetainedTiles(A);if(Lc(this._source.type)&&A.length!==0){const U={},Z={},J=Object.keys(D);for(const ae of J){const he=D[ae],we=this._tiles[ae];if(!we||we.fadeEndTime&&we.fadeEndTime<=s.f.now())continue;const xe=this.findLoadedParent(he,Math.max(he.overscaledZ-Dl.maxOverzooming,this._source.minzoom));xe&&(this._addTile(xe.tileID),U[xe.tileID.key]=xe.tileID),Z[ae]=he}const ee=A[A.length-1].overscaledZ;for(const ae in this._tiles){const he=this._tiles[ae];if(D[ae]||!he.hasData())continue;let we=he.tileID;for(;we.overscaledZ>ee;){we=we.scaledTo(we.overscaledZ-1);const xe=this._tiles[we.key];if(xe&&xe.hasData()&&Z[we.key]){D[ae]=he.tileID;break}}}for(const ae in U)D[ae]||(this._coveredTiles[ae]=!0,D[ae]=U[ae])}for(const U in D)this._tiles[U].clearFadeHold();const N=s.b0(this._tiles,D);for(const U of N){const Z=this._tiles[U];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(+U)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const h={};if(o.length===0)return h;const x={},I=o.reduce((Z,J)=>Math.min(Z,J.overscaledZ),1/0),A=o[0].overscaledZ,D=Math.max(A-Dl.maxOverzooming,this._source.minzoom),N=Math.max(A+Dl.maxUnderzooming,this._source.minzoom),U={};for(const Z of o){const J=this._addTile(Z);h[Z.key]=Z,J.hasData()||I<this._source.maxzoom&&(U[Z.key]=Z)}this._retainLoadedChildren(U,I,N,h);for(const Z of o){let J=this._tiles[Z.key];if(J.hasData())continue;if(Z.canonical.z>=this._source.maxzoom){const ae=Z.children(this._source.maxzoom)[0],he=this.getTile(ae);if(he&&he.hasData()){h[ae.key]=ae;continue}}else{const ae=Z.children(this._source.maxzoom);if(h[ae[0].key]&&h[ae[1].key]&&h[ae[2].key]&&h[ae[3].key])continue}let ee=J.wasRequested();for(let ae=Z.overscaledZ-1;ae>=D;--ae){const he=Z.scaledTo(ae);if(x[he.key]||(x[he.key]=!0,J=this.getTile(he),!J&&ee&&(J=this._addTile(he)),J&&(h[he.key]=he,ee=J.wasRequested(),J.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const h=[];let x,I=this._tiles[o].tileID;for(;I.overscaledZ>0;){if(I.key in this._loadedParentTiles){x=this._loadedParentTiles[I.key];break}h.push(I.key);const A=I.scaledTo(I.overscaledZ-1);if(x=this._getLoadedTile(A),x)break;I=A}for(const A of h)this._loadedParentTiles[A]=x}}_addTile(o){let h=this._tiles[o.key];if(h)return h.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),h;h=this._cache.getAndRemove(o),h&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));const x=!!h;if(!x){const I=this.map?this.map.painter:null,A=this._source.tileSize*o.overscaleFactor();h=this._source.type==="raster-array"?new iu(o,A,this.transform.tileZoom,I,this._isRaster):new hc(o,A,this.transform.tileZoom,I,this._isRaster),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))}return h?(h.uses++,this._tiles[o.key]=h,x||this._source.fire(new s.b("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null}_setTileReloadTimer(o,h){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const x=h.getExpiryTimeout();x&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},x))}_removeTile(o){const h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&h.state!=="reloading"||h.state==="empty"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,h,x){const I=[],A=this.transform;if(!A)return I;const D=A.projection.name==="globe",N=s.a5(A.center.lng);for(const U in this._tiles){const Z=this._tiles[U];if(x&&Z.clearQueryDebugViz(),Z.holdingForFade())continue;let J;if(D){const ee=Z.tileID.canonical;if(ee.z===0){const ae=[Math.abs(s.aa(N,...rd(ee,-1))-N),Math.abs(s.aa(N,...rd(ee,1))-N)];J=[0,2*ae.indexOf(Math.min(...ae))-1]}else{const ae=[Math.abs(s.aa(N,...rd(ee,-1))-N),Math.abs(s.aa(N,...rd(ee,0))-N),Math.abs(s.aa(N,...rd(ee,1))-N)];J=[ae.indexOf(Math.min(...ae))-1]}}else J=[0];for(const ee of J){const ae=o.containsTile(Z,A,h,ee);ae&&I.push(ae)}}return I}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,h){const x=this.getRenderableIds(o,h).map(A=>this._tiles[A].tileID),I=this.transform.projection.name==="globe";for(const A of x)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=I?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return x}sortCoordinatesByDistance(o){const h=o.slice(),x=this.transform._camera.position,I=this.transform._camera.forward(),A={};for(const D of h){const N=1/(1<<D.canonical.z);A[D.key]=((D.canonical.x+.5)*N+D.wrap-x[0])*I[0]+((D.canonical.y+.5)*N-x[1])*I[1]-x[2]*I[2]}return h.sort((D,N)=>A[D.key]-A[N.key]),h}hasTransition(){if(this._source.hasTransition())return!0;if(Lc(this._source.type))for(const o in this._tiles){const h=this._tiles[o];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=s.f.now())return!0}return!1}setFeatureState(o,h,x){this._state.updateState(o=o||"_geojsonTileLayer",h,x)}removeFeatureState(o,h,x){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,x)}getFeatureState(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)}setDependencies(o,h,x){const I=this._tiles[o];I&&I.setDependencies(h,x)}reloadTilesForDependencies(o,h){for(const x in this._tiles)this._tiles[x].hasDependency(o,h)&&this._reloadTile(+x,"reloading");this._cache.filter(x=>!x.hasDependency(o,h))}_preloadTiles(o,h){if(!this._sourceLoaded){const U=()=>{this._sourceLoaded&&(this._source.off("data",U),this._preloadTiles(o,h))};return void this._source.on("data",U)}const x=new Map,I=Array.isArray(o)?o:[o],A=this.map.painter.terrain,D=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const U of I){const Z=U.coveringTiles({tileSize:D,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const J of Z)x.set(J.key,J);this.usedForTerrain&&U.updateElevation(!1)}const N=Array.from(x.values());s.b1(N,(U,Z)=>{const J=new hc(U,this._source.tileSize*U.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(J,ee=>{this._source.type==="raster-dem"&&J.dem&&this._backfillDEM(J),Z(ee,J)})},h)}}function td(_,o){const h=Math.abs(2*_.wrap)-+(_.wrap<0),x=Math.abs(2*o.wrap)-+(o.wrap<0);return _.overscaledZ-o.overscaledZ||x-h||o.canonical.y-_.canonical.y||o.canonical.x-_.canonical.x}function Lc(_){return _==="raster"||_==="image"||_==="video"||_==="custom"}function rd(_,o){const h=1<<_.z;return[_.x/h+o,(_.x+1)/h+o]}Dl.maxOverzooming=10,Dl.maxUnderzooming=3;class jm{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,h=!1;for(const x in this.style._mergedLayers){const I=this.style._mergedLayers[x];if(I.type==="fill-extrusion")this.layers.push({layer:I,visible:o,visibilityChanged:h});else if(I.type==="model"){const A=this.style.getLayerSource(I);A&&A.type==="batched-model"&&this.layers.push({layer:I,visible:o,visibilityChanged:h})}}}onNewFrame(o){this.layersGotHidden=!1;for(const h of this.layers){const x=h.layer;let I=!1;x.type==="fill-extrusion"?I=!x.isHidden(o)&&x.paint.get("fill-extrusion-opacity")>0:x.type==="model"&&(I=!x.isHidden(o)&&x.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!I&&h.visible,h.visible=I}}updateZOffset(o,h){this.currentBuildingBuckets=[];for(const I of this.layers){const A=I.layer,D=this.style.getLayerSourceCache(A);let N=1;A.type==="fill-extrusion"&&(N=I.visible?A.paint.get("fill-extrusion-vertical-scale"):0);let U=D?D.getTile(h):null;if(!U&&D&&h.canonical.z>D.getSource().minzoom){let Z=h.scaledTo(Math.min(D.getSource().maxzoom,h.overscaledZ-1));for(;Z.overscaledZ>=D.getSource().minzoom&&(U=D.getTile(Z),!U&&Z.overscaledZ!==0);)Z=Z.scaledTo(Z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:U?U.getBucket(A):null,tileID:U?U.tileID:h,verticalScale:N})}o.hasAnyZOffset=!1;let x=!1;for(let I=0;I<o.symbolInstances.length;I++){const A=o.symbolInstances.get(I),D=A.zOffset,N=this._getHeightAtTileOffset(h,A.tileAnchorX,A.tileAnchorY);A.zOffset=N!==Number.NEGATIVE_INFINITY?N:D,x||D===A.zOffset||(x=!0),o.hasAnyZOffset||A.zOffset===0||(o.hasAnyZOffset=!0)}x&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,h,x,I){let A=h,D=x;if(o.canonical.z!==I.canonical.z){const N=I.canonical,U=1/(1<<o.canonical.z-N.z);A=(h+o.canonical.x*s.V)*U-N.x*s.V|0,D=(x+o.canonical.y*s.V)*U-N.y*s.V|0}return{tileX:A,tileY:D}}_getHeightAtTileOffset(o,h,x){let I,A;for(let D=0;D<this.layers.length;++D){if(this.layers[D].layer.type!=="fill-extrusion")continue;const{bucket:N,tileID:U,verticalScale:Z}=this.currentBuildingBuckets[D];if(!N)continue;const{tileX:J,tileY:ee}=this._mapCoordToOverlappingTile(o,h,x,U),ae=N.getHeightAtTileCoord(J,ee);ae&&ae.height!==void 0&&(ae.hidden?I=ae.height:A=Math.max(ae.height*Z,A||0))}if(A!==void 0)return A;for(let D=0;D<this.layers.length;++D){const N=this.layers[D];if(N.layer.type!=="model"||!N.visible)continue;const{bucket:U,tileID:Z}=this.currentBuildingBuckets[D];if(!U)continue;const{tileX:J,tileY:ee}=this._mapCoordToOverlappingTile(o,h,x,Z),ae=U.getHeightAtTileCoord(J,ee);if(ae&&!ae.hidden)return ae.height===void 0&&I!==void 0?Math.min(ae.maxHeight,I)*ae.verticalScale:(ae.height||0)*ae.verticalScale}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function dc(_,o){const h={};for(const x in _)x!=="ref"&&(h[x]=_[x]);return s.b2.forEach(x=>{x in o&&(h[x]=o[x])}),h}function nd(_){_=_.slice();const o=Object.create(null);for(let h=0;h<_.length;h++)o[_[h].id]=_[h];for(let h=0;h<_.length;h++)"ref"in _[h]&&(_[h]=dc(_[h],o[_[h].ref]));return _}const Ki={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Ga(_,o,h){h.push({command:Ki.addSource,args:[_,o[_]]})}function rp(_,o,h){o.push({command:Ki.removeSource,args:[_]}),h[_]=!0}function Ou(_,o,h,x){rp(_,h,x),Ga(_,o,h)}function Lu(_,o,h){let x;for(x in _[h])if(_[h].hasOwnProperty(x)&&x!=="data"&&!L(_[h][x],o[h][x]))return!1;for(x in o[h])if(o[h].hasOwnProperty(x)&&x!=="data"&&!L(_[h][x],o[h][x]))return!1;return!0}function yl(_,o,h,x,I,A){let D;for(D in o=o||{},_=_||{})_.hasOwnProperty(D)&&(L(_[D],o[D])||h.push({command:A,args:[x,D,o[D],I]}));for(D in o)o.hasOwnProperty(D)&&!_.hasOwnProperty(D)&&(L(_[D],o[D])||h.push({command:A,args:[x,D,o[D],I]}))}function vl(_){return _.id}function pc(_,o){return _[o.id]=o,_}class Xl{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.aa(o,0,1);let h=1,x=this._distances[h];const I=o*this.paddedLength+this.padding;for(;x<I&&h<this._distances.length;)x=this._distances[++h];const A=h-1,D=this._distances[A],N=x-D,U=N>0?(I-D)/N:0;return this.points[A].mult(1-U).add(this.points[h].mult(U))}}class ou{constructor(o,h,x){const I=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(o/x),this.yCellCount=Math.ceil(h/x);for(let D=0;D<this.xCellCount*this.yCellCount;D++)I.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,x,I,A){this._forEachCell(h,x,I,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(x),this.bboxes.push(I),this.bboxes.push(A)}insertCircle(o,h,x,I){this._forEachCell(h-I,x-I,h+I,x+I,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(x),this.circles.push(I)}_insertBoxCell(o,h,x,I,A,D){this.boxCells[A].push(D)}_insertCircleCell(o,h,x,I,A,D){this.circleCells[A].push(D)}_query(o,h,x,I,A,D){if(x<0||o>this.width||I<0||h>this.height)return!A&&[];const N=[];if(o<=0&&h<=0&&this.width<=x&&this.height<=I){if(A)return!0;for(let U=0;U<this.boxKeys.length;U++)N.push({key:this.boxKeys[U],x1:this.bboxes[4*U],y1:this.bboxes[4*U+1],x2:this.bboxes[4*U+2],y2:this.bboxes[4*U+3]});for(let U=0;U<this.circleKeys.length;U++){const Z=this.circles[3*U],J=this.circles[3*U+1],ee=this.circles[3*U+2];N.push({key:this.circleKeys[U],x1:Z-ee,y1:J-ee,x2:Z+ee,y2:J+ee})}return D?N.filter(D):N}return this._forEachCell(o,h,x,I,this._queryCell,N,{hitTest:A,seenUids:{box:{},circle:{}}},D),A?N.length>0:N}_queryCircle(o,h,x,I,A){const D=o-x,N=o+x,U=h-x,Z=h+x;if(N<0||D>this.width||Z<0||U>this.height)return!I&&[];const J=[];return this._forEachCell(D,U,N,Z,this._queryCellCircle,J,{hitTest:I,circle:{x:o,y:h,radius:x},seenUids:{box:{},circle:{}}},A),I?J.length>0:J}query(o,h,x,I,A){return this._query(o,h,x,I,!1,A)}hitTest(o,h,x,I,A){return this._query(o,h,x,I,!0,A)}hitTestCircle(o,h,x,I){return this._queryCircle(o,h,x,!0,I)}_queryCell(o,h,x,I,A,D,N,U){const Z=N.seenUids,J=this.boxCells[A];if(J!==null){const ae=this.bboxes;for(const he of J)if(!Z.box[he]){Z.box[he]=!0;const we=4*he;if(o<=ae[we+2]&&h<=ae[we+3]&&x>=ae[we+0]&&I>=ae[we+1]&&(!U||U(this.boxKeys[he]))){if(N.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[he],x1:ae[we],y1:ae[we+1],x2:ae[we+2],y2:ae[we+3]})}}}const ee=this.circleCells[A];if(ee!==null){const ae=this.circles;for(const he of ee)if(!Z.circle[he]){Z.circle[he]=!0;const we=3*he;if(this._circleAndRectCollide(ae[we],ae[we+1],ae[we+2],o,h,x,I)&&(!U||U(this.circleKeys[he]))){if(N.hitTest)return D.push(!0),!0;{const xe=ae[we],Ce=ae[we+1],ge=ae[we+2];D.push({key:this.circleKeys[he],x1:xe-ge,y1:Ce-ge,x2:xe+ge,y2:Ce+ge})}}}}}_queryCellCircle(o,h,x,I,A,D,N,U){const Z=N.circle,J=N.seenUids,ee=this.boxCells[A];if(ee!==null){const he=this.bboxes;for(const we of ee)if(!J.box[we]){J.box[we]=!0;const xe=4*we;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,he[xe+0],he[xe+1],he[xe+2],he[xe+3])&&(!U||U(this.boxKeys[we])))return D.push(!0),!0}}const ae=this.circleCells[A];if(ae!==null){const he=this.circles;for(const we of ae)if(!J.circle[we]){J.circle[we]=!0;const xe=3*we;if(this._circlesCollide(he[xe],he[xe+1],he[xe+2],Z.x,Z.y,Z.radius)&&(!U||U(this.circleKeys[we])))return D.push(!0),!0}}}_forEachCell(o,h,x,I,A,D,N,U){const Z=this._convertToXCellCoord(o),J=this._convertToYCellCoord(h),ee=this._convertToXCellCoord(x),ae=this._convertToYCellCoord(I);for(let he=Z;he<=ee;he++)for(let we=J;we<=ae;we++)if(A.call(this,o,h,x,I,this.xCellCount*we+he,D,N,U))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,x,I,A,D){const N=I-o,U=A-h,Z=x+D;return Z*Z>N*N+U*U}_circleAndRectCollide(o,h,x,I,A,D,N){const U=(D-I)/2,Z=Math.abs(o-(I+U));if(Z>U+x)return!1;const J=(N-A)/2,ee=Math.abs(h-(A+J));if(ee>J+x)return!1;if(Z<=U||ee<=J)return!0;const ae=Z-U,he=ee-J;return ae*ae+he*he<=x*x}}const Ws={unknown:0,flipRequired:1,flipNotRequired:2},au=Math.tan(85*Math.PI/180);function id(_,o,h,x,I,A,D){const N=s.a6.create();if(h)if(A.name==="globe"){const U=s.b3(I,o);s.a6.multiply(N,N,U)}else{const U=s.b4.invert([],D);N[0]=U[0],N[1]=U[1],N[4]=U[2],N[5]=U[3],x||s.a6.rotateZ(N,N,I.angle)}else s.a6.multiply(N,I.labelPlaneMatrix,_);return N}function No(_,o,h,x,I,A,D){const N=id(_,o,h,x,I,A,D);return A.name==="globe"&&h||(N[2]=N[6]=N[10]=N[14]=0),N}function Nf(_,o,h,x,I,A,D){if(h){if(A.name==="globe"){const N=id(_,o,h,x,I,A,D);return s.a6.invert(N,N),s.a6.multiply(N,_,N),N}{const N=s.a6.clone(_),U=s.a6.identity([]);return U[0]=D[0],U[1]=D[1],U[4]=D[2],U[5]=D[3],s.a6.multiply(N,N,U),x||s.a6.rotateZ(N,N,-I.angle),N}}return I.glCoordMatrix}function sl(_,o,h,x){const I=[_,o,h,1];h?s.a7.transformMat4(I,I,x):lu(I,I,x);const A=I[3];return I[0]/=A,I[1]/=A,I[2]/=A,I}function jf(_,o){return Math.min(.5+_/o*.5,1.5)}function $p(_,o){const h=_[0]/_[3],x=_[1]/_[3];return h>=-o[0]&&h<=o[0]&&x>=-o[1]&&x<=o[1]}function Gp(_,o,h,x,I,A,D,N,U,Z){const J=h.transform,ee=x?_.textSizeData:_.iconSizeData,ae=s.b5(ee,h.transform.zoom),he=J.projection.name==="globe",we=[256/h.width*2+1,256/h.height*2+1],xe=x?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;xe.clear();let Ce=null;he&&(Ce=x?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const ge=_.lineVertexArray,De=x?_.text.placedSymbolArray:_.icon.placedSymbolArray,Xe=h.transform.width/h.transform.height;let Be,We=!1;for(let Pe=0;Pe<De.length;Pe++){const Ke=De.get(Pe),{numGlyphs:st,writingMode:pt}=Ke;if(pt!==s.b6.vertical||We||Be===s.b6.horizontal||(We=!0),Be=pt,(Ke.hidden||pt===s.b6.vertical)&&!We){Nc(st,xe);continue}We=!1;const Tt=new s.P(Ke.tileAnchorX,Ke.tileAnchorY);let{x:Zt,y:xt,z:hr}=J.projection.projectTilePoint(Tt.x,Tt.y,Z.canonical);if(U){const[tn,_n,Fn]=U(Tt);Zt+=tn,xt+=_n,hr+=Fn}const tr=[Zt,xt,hr,1];if(s.a7.transformMat4(tr,tr,o),!$p(tr,we)){Nc(st,xe);continue}const Cr=tr[3],zt=jf(h.transform.getCameraToCenterDistance(J.projection),Cr),ir=s.b7(ee,ae,Ke),vt=D?ir/zt:ir*zt,Ut=sl(Zt,xt,hr,I);if(Ut[3]<=0){Nc(st,xe);continue}let Lr={};const Wr=D?null:U,Gr=zc(Ke,vt,!1,N,o,I,A,_.glyphOffsetArray,ge,xe,Ce,Ut,Tt,Lr,Xe,Wr,J.projection,Z,D);We=Gr.useVertical,Wr&&Gr.needsFlipping&&(Lr={}),(Gr.notEnoughRoom||We||Gr.needsFlipping&&zc(Ke,vt,!0,N,o,I,A,_.glyphOffsetArray,ge,xe,Ce,Ut,Tt,Lr,Xe,Wr,J.projection,Z,D).notEnoughRoom)&&Nc(st,xe)}x?(_.text.dynamicLayoutVertexBuffer.updateData(xe),Ce&&_.text.globeExtVertexBuffer&&_.text.globeExtVertexBuffer.updateData(Ce)):(_.icon.dynamicLayoutVertexBuffer.updateData(xe),Ce&&_.icon.globeExtVertexBuffer&&_.icon.globeExtVertexBuffer.updateData(Ce))}function qp(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe){const{lineStartIndex:Ce,glyphStartIndex:ge,segment:De}=N,Xe=ge+N.numGlyphs,Be=Ce+N.lineLength,We=o.getoffsetX(ge),Pe=o.getoffsetX(Xe-1),Ke=od(_*We,h,x,I,A,D,De,Ce,Be,U,Z,J,ee,ae,!0,he,we,xe);if(!Ke)return null;const st=od(_*Pe,h,x,I,A,D,De,Ce,Be,U,Z,J,ee,ae,!0,he,we,xe);return st?{first:Ke,last:st}:null}function su(_,o,h,x){return _===s.b6.horizontal&&Math.abs(x)>Math.abs(h)?{useVertical:!0}:_===s.b6.vertical?x>0?{needsFlipping:!0}:null:o!==Ws.unknown&&function(I,A){return I===0||Math.abs(A/I)>au}(h,x)?o===Ws.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function zc(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge,De){const Xe=o/24,Be=_.lineOffsetX*Xe,We=_.lineOffsetY*Xe,{lineStartIndex:Pe,glyphStartIndex:Ke,numGlyphs:st,segment:pt,writingMode:Tt,flipState:Zt}=_,xt=Pe+_.lineLength,hr=tr=>{if(J){const[vt,Ut,Lr]=tr.up,Wr=Z.length;s.b8(J,Wr+0,vt,Ut,Lr),s.b8(J,Wr+1,vt,Ut,Lr),s.b8(J,Wr+2,vt,Ut,Lr),s.b8(J,Wr+3,vt,Ut,Lr)}const[Cr,zt,ir]=tr.point;s.b9(Z,Cr,zt,ir,tr.angle)};if(st>1){const tr=qp(Xe,N,Be,We,h,ee,ae,_,U,A,he,xe,!1,Ce,ge,De);if(!tr)return{notEnoughRoom:!0};if(x&&!h){let[Cr,zt,ir]=tr.first.point,[vt,Ut,Lr]=tr.last.point;[Cr,zt]=sl(Cr,zt,ir,D),[vt,Ut]=sl(vt,Ut,Lr,D);const Wr=su(Tt,Zt,(vt-Cr)*we,Ut-zt);if(_.flipState=Wr&&Wr.needsFlipping?Ws.flipRequired:Ws.flipNotRequired,Wr)return Wr}hr(tr.first);for(let Cr=Ke+1;Cr<Ke+st-1;Cr++){const zt=od(Xe*N.getoffsetX(Cr),Be,We,h,ee,ae,pt,Pe,xt,U,A,he,xe,!1,!1,Ce,ge,De);if(!zt)return Z.length-=4*(Cr-Ke),{notEnoughRoom:!0};hr(zt)}hr(tr.last)}else{if(x&&!h){const Cr=sl(ae.x,ae.y,0,I),zt=Pe+pt+1,ir=new s.P(U.getx(zt),U.gety(zt)),vt=sl(ir.x,ir.y,0,I),Ut=vt[3]>0?vt:np(ae,ir,Cr,1,I,void 0,Ce,ge.canonical),Lr=su(Tt,Zt,(Ut[0]-Cr[0])*we,Ut[1]-Cr[1]);if(_.flipState=Lr&&Lr.needsFlipping?Ws.flipRequired:Ws.flipNotRequired,Lr)return Lr}const tr=od(Xe*N.getoffsetX(Ke),Be,We,h,ee,ae,pt,Pe,xt,U,A,he,xe,!1,!1,Ce,ge,De);if(!tr)return{notEnoughRoom:!0};hr(tr)}return{}}function Yl(_,o,h,x,I){const{x:A,y:D,z:N}=x.projectTilePoint(_.x,_.y,o);if(!I)return sl(A,D,N,h);const[U,Z,J]=I(_);return sl(A+U,D+Z,N+J,h)}function np(_,o,h,x,I,A,D,N){const U=Yl(_.sub(o)._unit()._add(_),N,I,D,A);return s.N.sub(U,h,U),s.N.normalize(U,U),s.N.scaleAndAdd(U,h,U,x)}function od(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge){const De=x?_-o:_+o;let Xe=De>0?1:-1,Be=0;x&&(Xe*=-1,Be=Math.PI),Xe<0&&(Be+=Math.PI);let We=N+D+(Xe>0?0:1)|0,Pe=I,Ke=I,st=0,pt=0;const Tt=Math.abs(De),Zt=[],xt=[];let hr=A,tr=hr;const Cr=()=>np(tr,hr,Ke,Tt-st+1,J,ae,xe,Ce.canonical);for(;st+pt<=Tt;){if(We+=Xe,We<N||We>=U)return null;if(Ke=Pe,tr=hr,Zt.push(Ke),he&&xt.push(tr),hr=new s.P(Z.getx(We),Z.gety(We)),Pe=ee[We],!Pe){const _n=Yl(hr,Ce.canonical,J,xe,ae);Pe=_n[3]>0?ee[We]=_n:Cr()}st+=pt,pt=s.N.distance(Ke,Pe)}we&&ae&&(ee[We]&&(Pe=Cr(),pt=s.N.distance(Ke,Pe)),ee[We]=Pe);const zt=(Tt-st)/pt,ir=hr.sub(tr)._mult(zt)._add(tr),vt=s.N.sub([],Pe,Ke),Ut=s.N.scaleAndAdd([],Ke,vt,zt);let Lr=[0,0,1],Wr=vt[0],Gr=vt[1];if(ge&&(Lr=xe.upVector(Ce.canonical,ir.x,ir.y),Lr[0]!==0||Lr[1]!==0||Lr[2]!==1)){const _n=[Lr[2],0,-Lr[0]],Fn=s.N.cross([],Lr,_n);s.N.normalize(_n,_n),s.N.normalize(Fn,Fn),Wr=s.N.dot(vt,_n),Gr=s.N.dot(vt,Fn)}if(h){const _n=s.N.cross([],Lr,vt);s.N.normalize(_n,_n),s.N.scaleAndAdd(Ut,Ut,_n,h*Xe)}const tn=Be+Math.atan2(Gr,Wr);return Zt.push(Ut),he&&xt.push(ir),{point:Ut,angle:tn,path:Zt,tilePath:xt,up:Lr}}function Nc(_,o){const h=o.length,x=h+4*_;o.resize(x),o.float32.fill(-1/0,4*h,4*x)}function lu(_,o,h){const x=o[0],I=o[1];return _[0]=h[0]*x+h[4]*I+h[12],_[1]=h[1]*x+h[5]*I+h[13],_[3]=h[3]*x+h[7]*I+h[15],_}const Ol=100;class Jr{constructor(o,h,x=new ou(o.width+200,o.height+200,25),I=new ou(o.width+200,o.height+200,25)){this.transform=o,this.grid=x,this.ignoredGrid=I,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Ol,this.screenBottomBoundary=o.height+Ol,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,x,I,A,D,N,U){let Z=x.projectedAnchorX,J=x.projectedAnchorY,ee=x.projectedAnchorZ;const ae=x.elevation,he=x.tileID,we=o.getProjection();if(ae&&he){const[Pe,Ke,st]=we.upVector(he.canonical,x.tileAnchorX,x.tileAnchorY),pt=we.upVectorScale(he.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=Pe*ae*pt,J+=Ke*ae*pt,ee+=st*ae*pt}const xe=this.projectAndGetPerspectiveRatio(N,Z,J,ee,x.tileID,we.name==="globe"||!!ae||this.transform.pitch>0,we),Ce=D*xe.perspectiveRatio,ge=(x.x1*h+I.x-x.padding)*Ce+xe.point.x,De=(x.y1*h+I.y-x.padding)*Ce+xe.point.y,Xe=(x.x2*h+I.x+x.padding)*Ce+xe.point.x,Be=(x.y2*h+I.y+x.padding)*Ce+xe.point.y,We=xe.perspectiveRatio<=.55||xe.occluded;return!this.isInsideGrid(ge,De,Xe,Be)||!A&&this.grid.hitTest(ge,De,Xe,Be,U)||We?{box:[],offscreen:!1,occluded:xe.occluded}:{box:[ge,De,Xe,Be],offscreen:this.isOffscreen(ge,De,Xe,Be),occluded:!1}}placeCollisionCircles(o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe){const Ce=[],ge=this.transform.elevation,De=o.getProjection(),Xe=ge?ge.getAtTileOffsetFunc(xe,this.transform.center.lat,this.transform.worldSize,De):null,Be=new s.P(x.tileAnchorX,x.tileAnchorY);let{x:We,y:Pe,z:Ke}=De.projectTilePoint(Be.x,Be.y,xe.canonical);if(Xe){const[ir,vt,Ut]=Xe(Be);We+=ir,Pe+=vt,Ke+=Ut}const st=De.name==="globe",pt=this.projectAndGetPerspectiveRatio(N,We,Pe,Ke,xe,st||!!ge||this.transform.pitch>0,De),{perspectiveRatio:Tt}=pt,Zt=(ee?D/Tt:D*Tt)/s.bc,xt=sl(We,Pe,Ke,U),hr=pt.signedDistanceFromCamera>0?qp(Zt,A,x.lineOffsetX*Zt,x.lineOffsetY*Zt,!1,xt,Be,x,I,U,{},ge&&!ee?Xe:null,ee&&!!ge,De,xe,ee):null;let tr=!1,Cr=!1,zt=!0;if(hr&&!pt.occluded){const ir=.5*he*Tt+we,vt=new s.P(-100,-100),Ut=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Lr=new Xl,{first:Wr,last:Gr}=hr,tn=Wr.path.length;let _n=[];for(let Sn=tn-1;Sn>=1;Sn--)_n.push(Wr.path[Sn]);for(let Sn=1;Sn<Gr.path.length;Sn++)_n.push(Gr.path[Sn]);const Fn=2.5*ir;Z&&(_n=_n.map(([Sn,Mi,pi],Ci)=>(Xe&&!st&&(pi=Xe(Ci<tn-1?Wr.tilePath[tn-1-Ci]:Gr.tilePath[Ci-tn+2])[2]),sl(Sn,Mi,pi,Z))),_n.some(Sn=>Sn[3]<=0)&&(_n=[]));let wn=[];if(_n.length>0){let Sn=1/0,Mi=-1/0,pi=1/0,Ci=-1/0;for(const Ti of _n)Sn=Math.min(Sn,Ti[0]),pi=Math.min(pi,Ti[1]),Mi=Math.max(Mi,Ti[0]),Ci=Math.max(Ci,Ti[1]);Mi>=vt.x&&Sn<=Ut.x&&Ci>=vt.y&&pi<=Ut.y&&(wn=[_n.map(Ti=>new s.P(Ti[0],Ti[1]))],(Sn<vt.x||Mi>Ut.x||pi<vt.y||Ci>Ut.y)&&(wn=s.ba(wn,vt.x,vt.y,Ut.x,Ut.y)))}for(const Sn of wn){Lr.reset(Sn,.25*ir);let Mi=0;Mi=Lr.length<=.5*ir?1:Math.ceil(Lr.paddedLength/Fn)+1;for(let pi=0;pi<Mi;pi++){const Ci=pi/Math.max(Mi-1,1),Ti=Lr.lerp(Ci),ro=Ti.x+Ol,Ro=Ti.y+Ol;Ce.push(ro,Ro,ir,0);const Vi=ro-ir,Zo=Ro-ir,fi=ro+ir,Ji=Ro+ir;if(zt=zt&&this.isOffscreen(Vi,Zo,fi,Ji),Cr=Cr||this.isInsideGrid(Vi,Zo,fi,Ji),!h&&this.grid.hitTestCircle(ro,Ro,ir,ae)&&(tr=!0,!J))return{circles:[],offscreen:!1,collisionDetected:tr,occluded:!1}}}}return{circles:!J&&tr||!Cr?[]:Ce,offscreen:zt,collisionDetected:tr,occluded:pt.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let x=1/0,I=1/0,A=-1/0,D=-1/0;for(const J of o){const ee=new s.P(J.x+Ol,J.y+Ol);x=Math.min(x,ee.x),I=Math.min(I,ee.y),A=Math.max(A,ee.x),D=Math.max(D,ee.y),h.push(ee)}const N=this.grid.query(x,I,A,D).concat(this.ignoredGrid.query(x,I,A,D)),U={},Z={};for(const J of N){const ee=J.key;if(U[ee.bucketInstanceId]===void 0&&(U[ee.bucketInstanceId]={}),U[ee.bucketInstanceId][ee.featureIndex])continue;const ae=[new s.P(J.x1,J.y1),new s.P(J.x2,J.y1),new s.P(J.x2,J.y2),new s.P(J.x1,J.y2)];s.bb(h,ae)&&(U[ee.bucketInstanceId][ee.featureIndex]=!0,Z[ee.bucketInstanceId]===void 0&&(Z[ee.bucketInstanceId]=[]),Z[ee.bucketInstanceId].push(ee.featureIndex))}return Z}insertCollisionBox(o,h,x,I,A){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:I,collisionGroupID:A},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,x,I,A){const D=h?this.ignoredGrid:this.grid,N={bucketInstanceId:x,featureIndex:I,collisionGroupID:A};for(let U=0;U<o.length;U+=4)D.insertCircle(N,o[U],o[U+1],o[U+2])}projectAndGetPerspectiveRatio(o,h,x,I,A,D,N){const U=[h,x,I,1];let Z=!1;I||this.transform.pitch>0?(s.a7.transformMat4(U,U,o),this.fogState&&A&&N.name!=="globe"&&(Z=function(ae,he,we,xe,Ce,ge){const De=ge.calculateFogTileMatrix(Ce),Xe=[he,we,xe];return s.N.transformMat4(Xe,Xe,De),gi(ae,s.N.length(Xe),ge.pitch,ge._fov)}(this.fogState,h,x,I,A.toUnwrapped(),this.transform)>.9)):lu(U,U,o);const J=U[3];return{point:new s.P((U[0]/J+1)/2*this.transform.width+Ol,(-U[1]/J+1)/2*this.transform.height+Ol),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(N)/J*.5,1.5),signedDistanceFromCamera:J,occluded:D&&U[2]>J||Z}}isOffscreen(o,h,x,I){return x<Ol||o>=this.screenRightBoundary||I<Ol||h>this.screenBottomBoundary}isInsideGrid(o,h,x,I){return x>=0&&o<this.gridRightBoundary&&I>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=s.a6.identity([]);return s.a6.translate(o,o,[-100,-100,0]),o}}function jc(_,o,h){const x=o.createTileMatrix(_,_.worldSize,h.toUnwrapped());return s.a6.multiply(new Float32Array(16),_.projMatrix,x)}function Wp(_,o,h){if(o.projection.name===h.projection.name)return _.projMatrix;const x=h.clone();return x.setProjection(o.projection),jc(x,o.getProjection(),_)}function cu(_,o,h){return o.name===h.projection.name?_.projMatrix:jc(h,o,_)}class Go{constructor(o,h,x,I){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):I&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class fc{constructor(o,h,x,I,A,D=!1){this.text=new Go(o?o.text:null,h,x,A),this.icon=new Go(o?o.icon:null,h,I,A),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class mc{constructor(o,h,x,I=!1){this.text=o,this.icon=h,this.skipFade=x,this.clipped=I}}class zu{constructor(){this.invProjMatrix=s.a6.create(),this.viewportMatrix=s.a6.create(),this.circles=[]}}class Nu{constructor(o,h,x,I,A){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=x,this.bucketIndex=I,this.tileID=A}}class Hp{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:x=>x.collisionGroupID===h}}return this.collisionGroups[o]}}function ju(_,o,h,x,I){const{horizontalAlign:A,verticalAlign:D}=s.bf(_),N=-(A-.5)*o,U=-(D-.5)*h,Z=s.bd(_,x);return new s.P(N+Z[0]*I,U+Z[1]*I)}function ad(_,o,h,x,I){const A=new s.P(_,o);return h&&A._rotate(x?I:-I),A}class sd{constructor(o,h,x,I,A,D){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Jr(this.transform,A),this.buildingIndex=D,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Hp(x),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,x,I){const A=x.getBucket(h),D=x.latestFeatureIndex;if(!A||!D||h.fqid!==A.layerIds[0])return;const N=A.layers[0].layout,U=x.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),J=x.tileSize/s.V,ee=x.tileID.toUnwrapped();this.transform.setProjection(A.projection);const ae=(he=x.tileID,we=A.getProjection(),xe=this.transform,we.name===this.projection?xe.calculateProjMatrix(he.toUnwrapped()):jc(xe,we,he));var he,we,xe;const Ce=N.get("text-pitch-alignment")==="map",ge=N.get("text-rotation-alignment")==="map";h.compileFilter();const De=h.dynamicFilter(),Xe=h.dynamicFilterNeedsFeature(),Be=this.transform.calculatePixelsToTileUnitsMatrix(x),We=No(ae,x.tileID.canonical,Ce,ge,this.transform,A.getProjection(),Be);let Pe=null;if(Ce){const pt=Nf(ae,x.tileID.canonical,Ce,ge,this.transform,A.getProjection(),Be);Pe=s.a6.multiply([],this.transform.labelPlaneMatrix,pt)}let Ke=null;De&&x.latestFeatureIndex&&(Ke={unwrappedTileID:ee,dynamicFilter:De,dynamicFilterNeedsFeature:Xe,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[A.bucketInstanceId]=new Nu(A.bucketInstanceId,D,A.sourceLayerIndex,A.index,x.tileID);const st={bucket:A,layout:N,posMatrix:ae,textLabelPlaneMatrix:We,labelToScreenMatrix:Pe,clippingData:Ke,scale:Z,textPixelRatio:J,holdingForFade:x.holdingForFade(),collisionBoxArray:U,partiallyEvaluatedTextSize:s.b5(A.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.b5(A.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(I)for(const pt of A.sortKeyRanges){const{sortKey:Tt,symbolInstanceStart:Zt,symbolInstanceEnd:xt}=pt;o.push({sortKey:Tt,symbolInstanceStart:Zt,symbolInstanceEnd:xt,parameters:st})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:st})}attemptAnchorPlacement(o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge,De){const{textOffset0:Xe,textOffset1:Be,crossTileID:We}=ae,Pe=[Xe,Be],Ke=ju(o,x,I,Pe,A),st=this.collisionIndex.placeCollisionBox(we,A,h,ad(Ke.x,Ke.y,D,N,this.transform.angle),ee,U,Z,J.predicate);if(Ce){const pt=we.getSymbolInstanceIconSize(De,this.transform.zoom,ae.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(we,pt,Ce,ad(Ke.x,Ke.y,D,N,this.transform.angle),ee,U,Z,J.predicate).box.length===0)return}if(st.box.length>0){let pt;return this.prevPlacement&&this.prevPlacement.variableOffsets[We]&&this.prevPlacement.placements[We]&&this.prevPlacement.placements[We].text&&(pt=this.prevPlacement.variableOffsets[We].anchor),this.variableOffsets[We]={textOffset:Pe,width:x,height:I,anchor:o,textScale:A,prevAnchor:pt},this.markUsedJustification(we,o,ae,xe),we.allowVerticalPlacement&&(this.markUsedOrientation(we,xe,ae),this.placedOrientations[We]=xe),{shift:Ke,placedGlyphBoxes:st}}}placeLayerBucketPart(o,h,x,I){const{bucket:A,layout:D,posMatrix:N,textLabelPlaneMatrix:U,labelToScreenMatrix:Z,clippingData:J,textPixelRatio:ee,holdingForFade:ae,collisionBoxArray:he,partiallyEvaluatedTextSize:we,partiallyEvaluatedIconSize:xe,collisionGroup:Ce}=o.parameters,ge=D.get("text-optional"),De=D.get("icon-optional"),Xe=D.get("text-allow-overlap"),Be=D.get("icon-allow-overlap"),We=D.get("text-rotation-alignment")==="map",Pe=D.get("text-pitch-alignment")==="map",Ke=D.get("symbol-z-order")==="viewport-y",st=D.get("symbol-z-elevate");this.transform.setProjection(A.projection);let pt=Xe&&(Be||!A.hasIconData()||De),Tt=Be&&(Xe||!A.hasTextData()||ge);!A.collisionArrays&&he&&A.deserializeCollisionBoxes(he),x&&I&&A.updateCollisionDebugBuffers(this.transform.zoom,he);const Zt=(xt,hr,tr)=>{const{crossTileID:Cr,numVerticalGlyphVertices:zt}=xt;if(J){const fi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ji=null;if(J.dynamicFilterNeedsFeature){const oi=this.retainedQueryData[A.bucketInstanceId];Ji=J.featureIndex.loadFeature({featureIndex:xt.featureIndex,bucketIndex:oi.bucketIndex,sourceLayerIndex:oi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,J.dynamicFilter)(fi,Ji,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new s.P(xt.tileAnchorX,xt.tileAnchorY),this.transform.calculateDistanceTileData(J.unwrappedTileID)))return this.placements[Cr]=new mc(!1,!1,!1,!0),void h.add(Cr)}if(h.has(Cr))return;if(ae)return void(this.placements[Cr]=new mc(!1,!1,!1));let ir=!1,vt=!1,Ut=!0,Lr=!1,Wr=!1,Gr=null,tn={box:null,offscreen:null,occluded:null},_n={box:null,offscreen:null,occluded:null},Fn=null,wn=null,Sn=null,Mi=0,pi=0,Ci=0;tr.textFeatureIndex?Mi=tr.textFeatureIndex:xt.useRuntimeCollisionCircles&&(Mi=xt.featureIndex),tr.verticalTextFeatureIndex&&(pi=tr.verticalTextFeatureIndex);const Ti=fi=>{fi.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const Ji=this.transform.elevation;fi.elevation=xt.zOffset+(Ji?Ji.getAtTileOffset(fi.tileID,fi.tileAnchorX,fi.tileAnchorY):0)},ro=tr.textBox;if(ro){Ti(ro);const fi=oi=>{let no=s.b6.horizontal;if(A.allowVerticalPlacement&&!oi&&this.prevPlacement){const Bo=this.prevPlacement.placedOrientations[Cr];Bo&&(this.placedOrientations[Cr]=Bo,no=Bo,this.markUsedOrientation(A,no,xt))}return no},Ji=(oi,no)=>{if(A.allowVerticalPlacement&&zt>0&&tr.verticalTextBox){for(const Bo of A.writingModes)if(Bo===s.b6.vertical?(tn=no(),_n=tn):tn=oi(),tn&&tn.box&&tn.box.length)break}else tn=oi()};if(D.get("text-variable-anchor")){let oi=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Cr]){const ji=this.prevPlacement.variableOffsets[Cr];oi.indexOf(ji.anchor)>0&&(oi=oi.filter(vs=>vs!==ji.anchor),oi.unshift(ji.anchor))}const no=(ji,vs,js)=>{const ac=A.getSymbolInstanceTextSize(we,xt,this.transform.zoom,hr),bu=(ji.x2-ji.x1)*ac+2*ji.padding,Sl=(ji.y2-ji.y1)*ac+2*ji.padding,ss=xt.hasIconTextFit&&!Be?vs:null;ss&&Ti(ss);let ls={box:[],offscreen:!1,occluded:!1};const ul=Xe?2*oi.length:oi.length;for(let Ps=0;Ps<ul;++Ps){const Tl=this.attemptAnchorPlacement(oi[Ps%oi.length],ji,bu,Sl,ac,We,Pe,ee,N,Ce,Ps>=oi.length,xt,hr,A,js,ss,we,xe);if(Tl&&(ls=Tl.placedGlyphBoxes,ls&&ls.box&&ls.box.length)){ir=!0,Gr=Tl.shift;break}}return ls};Ji(()=>no(ro,tr.iconBox,s.b6.horizontal),()=>{const ji=tr.verticalTextBox;return ji&&Ti(ji),A.allowVerticalPlacement&&!(tn&&tn.box&&tn.box.length)&&zt>0&&ji?no(ji,tr.verticalIconBox,s.b6.vertical):{box:null,offscreen:null,occluded:null}}),tn&&(ir=tn.box,Ut=tn.offscreen,Lr=tn.occluded);const Bo=fi(!(!tn||!tn.box));if(!ir&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[Cr];ji&&(this.variableOffsets[Cr]=ji,this.markUsedJustification(A,ji.anchor,xt,Bo))}}else{const oi=(no,Bo)=>{const ji=A.getSymbolInstanceTextSize(we,xt,this.transform.zoom,hr),vs=this.collisionIndex.placeCollisionBox(A,ji,no,new s.P(0,0),Xe,ee,N,Ce.predicate);return vs&&vs.box&&vs.box.length&&(this.markUsedOrientation(A,Bo,xt),this.placedOrientations[Cr]=Bo),vs};Ji(()=>oi(ro,s.b6.horizontal),()=>{const no=tr.verticalTextBox;return A.allowVerticalPlacement&&zt>0&&no?(Ti(no),oi(no,s.b6.vertical)):{box:null,offscreen:null,occluded:null}}),fi(!!(tn&&tn.box&&tn.box.length))}}if(Fn=tn,ir=Fn&&Fn.box&&Fn.box.length>0,Ut=Fn&&Fn.offscreen,Lr=Fn&&Fn.occluded,xt.useRuntimeCollisionCircles){const fi=A.text.placedSymbolArray.get(xt.centerJustifiedTextSymbolIndex>=0?xt.centerJustifiedTextSymbolIndex:xt.verticalPlacedTextSymbolIndex),Ji=s.b7(A.textSizeData,we,fi),oi=D.get("text-padding");wn=this.collisionIndex.placeCollisionCircles(A,Xe,fi,A.lineVertexArray,A.glyphOffsetArray,Ji,N,U,Z,x,Pe,Ce.predicate,xt.collisionCircleDiameter*Ji/s.bc,oi,this.retainedQueryData[A.bucketInstanceId].tileID),ir=Xe||wn.circles.length>0&&!wn.collisionDetected,Ut=Ut&&wn.offscreen,Lr=wn.occluded}if(tr.iconFeatureIndex&&(Ci=tr.iconFeatureIndex),tr.iconBox){const fi=Ji=>{Ti(Ji);const oi=xt.hasIconTextFit&&Gr?ad(Gr.x,Gr.y,We,Pe,this.transform.angle):new s.P(0,0),no=A.getSymbolInstanceIconSize(xe,this.transform.zoom,xt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,no,Ji,oi,Be,ee,N,Ce.predicate)};_n&&_n.box&&_n.box.length&&tr.verticalIconBox?(Sn=fi(tr.verticalIconBox),vt=Sn.box.length>0):(Sn=fi(tr.iconBox),vt=Sn.box.length>0),Ut=Ut&&Sn.offscreen,Wr=Sn.occluded}const Ro=ge||xt.numHorizontalGlyphVertices===0&&zt===0,Vi=De||xt.numIconVertices===0;if(Ro||Vi?Vi?Ro||(vt=vt&&ir):ir=vt&&ir:vt=ir=vt&&ir,ir&&Fn&&Fn.box&&this.collisionIndex.insertCollisionBox(Fn.box,D.get("text-ignore-placement"),A.bucketInstanceId,_n&&_n.box&&pi?pi:Mi,Ce.ID),vt&&Sn&&this.collisionIndex.insertCollisionBox(Sn.box,D.get("icon-ignore-placement"),A.bucketInstanceId,Ci,Ce.ID),wn&&(ir&&this.collisionIndex.insertCollisionCircles(wn.circles,D.get("text-ignore-placement"),A.bucketInstanceId,Mi,Ce.ID),x)){const fi=A.bucketInstanceId;let Ji=this.collisionCircleArrays[fi];Ji===void 0&&(Ji=this.collisionCircleArrays[fi]=new zu);for(let oi=0;oi<wn.circles.length;oi+=4)Ji.circles.push(wn.circles[oi+0]),Ji.circles.push(wn.circles[oi+1]),Ji.circles.push(wn.circles[oi+2]),Ji.circles.push(wn.collisionDetected?1:0)}const Zo=A.projection.name!=="globe";pt=pt&&(Zo||!Lr),Tt=Tt&&(Zo||!Wr),this.placements[Cr]=new mc(ir||pt,vt||Tt,Ut||A.justReloaded),h.add(Cr)};if(st&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,this.retainedQueryData[A.bucketInstanceId].tileID),A.updateZOffset()),Ke){const xt=A.getSortedSymbolIndexes(this.transform.angle);for(let hr=xt.length-1;hr>=0;--hr){const tr=xt[hr];Zt(A.symbolInstances.get(tr),tr,A.collisionArrays[tr])}A.hasAnyZOffset&&s.w(`${A.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(A.hasAnyZOffset){const xt=A.getSortedIndexesByZOffset();for(let hr=0;hr<xt.length;++hr){const tr=xt[hr];Zt(A.symbolInstances.get(tr),tr,A.collisionArrays[tr])}}else for(let xt=o.symbolInstanceStart;xt<o.symbolInstanceEnd;xt++)Zt(A.symbolInstances.get(xt),xt,A.collisionArrays[xt]);if(x&&A.bucketInstanceId in this.collisionCircleArrays){const xt=this.collisionCircleArrays[A.bucketInstanceId];s.a6.invert(xt.invProjMatrix,N),xt.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(o,h,x,I){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:U,crossTileID:Z}=x,J=s.be(h),ee=I===s.b6.vertical?U:J==="left"?A:J==="center"?D:J==="right"?N:-1;A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=ee>=0&&A!==ee?0:Z),D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=ee>=0&&D!==ee?0:Z),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=ee>=0&&N!==ee?0:Z),U>=0&&(o.text.placedSymbolArray.get(U).crossTileID=ee>=0&&U!==ee?0:Z)}markUsedOrientation(o,h,x){const I=h===s.b6.horizontal||h===s.b6.horizontalOnly?h:0,A=h===s.b6.vertical?h:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:Z}=x,J=o.text.placedSymbolArray;D>=0&&(J.get(D).placedOrientation=I),N>=0&&(J.get(N).placedOrientation=I),U>=0&&(J.get(U).placedOrientation=I),Z>=0&&(J.get(Z).placedOrientation=A)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let x=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const I=h?h.symbolFadeChange(o):1,A=h?h.opacities:{},D=h?h.variableOffsets:{},N=h?h.placedOrientations:{};for(const U in this.placements){const Z=this.placements[U],J=A[U];J?(this.opacities[U]=new fc(J,I,Z.text,Z.icon,null,Z.clipped),x=x||Z.text!==J.text.placed||Z.icon!==J.icon.placed):(this.opacities[U]=new fc(null,I,Z.text,Z.icon,Z.skipFade,Z.clipped),x=x||Z.text||Z.icon)}for(const U in A){const Z=A[U];if(!this.opacities[U]){const J=new fc(Z,I,!1,!1);J.isHidden()||(this.opacities[U]=J,x=x||Z.text.placed||Z.icon.placed)}}for(const U in D)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=D[U]);for(const U in N)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=N[U]);x?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const x=new Set;for(const I of h){const A=I.getBucket(o);A&&I.latestFeatureIndex&&o.fqid===A.layerIds[0]&&(this.updateBucketOpacities(A,x,I.collisionBoxArray),A.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,I.tileID),A.updateZOffset()))}}updateBucketOpacities(o,h,x){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const I=o.layers[0].layout,A=!!o.layers[0].dynamicFilter(),D=new fc(null,0,!1,!1,!0),N=I.get("text-allow-overlap"),U=I.get("icon-allow-overlap"),Z=I.get("text-variable-anchor"),J=I.get("text-rotation-alignment")==="map",ee=I.get("text-pitch-alignment")==="map",ae=new fc(null,0,N&&(U||!o.hasIconData()||I.get("icon-optional")),U&&(N||!o.hasTextData()||I.get("text-optional")),!0);!o.collisionArrays&&x&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(x);const he=(xe,Ce,ge)=>{for(let De=0;De<Ce/4;De++)xe.opacityVertexArray.emplaceBack(ge)};let we=0;for(let xe=0;xe<o.symbolInstances.length;xe++){const Ce=o.symbolInstances.get(xe),{numHorizontalGlyphVertices:ge,numVerticalGlyphVertices:De,crossTileID:Xe,numIconVertices:Be}=Ce,We=h.has(Xe);let Pe=this.opacities[Xe];We?Pe=D:Pe||(Pe=ae,this.opacities[Xe]=Pe),h.add(Xe);const Ke=ge>0||De>0,st=Be>0,pt=this.placedOrientations[Xe],Tt=pt===s.b6.vertical,Zt=pt===s.b6.horizontal||pt===s.b6.horizontalOnly;if(!Ke&&!st||Pe.isHidden()||we++,Ke){const xt=Bf(Pe.text);he(o.text,ge,Tt?ud:xt),he(o.text,De,Zt?ud:xt);const hr=Pe.text.isHidden(),{leftJustifiedTextSymbolIndex:tr,centerJustifiedTextSymbolIndex:Cr,rightJustifiedTextSymbolIndex:zt,verticalPlacedTextSymbolIndex:ir}=Ce,vt=o.text.placedSymbolArray,Ut=hr||Tt?1:0;tr>=0&&(vt.get(tr).hidden=Ut),Cr>=0&&(vt.get(Cr).hidden=Ut),zt>=0&&(vt.get(zt).hidden=Ut),ir>=0&&(vt.get(ir).hidden=hr||Zt?1:0);const Lr=this.variableOffsets[Xe];Lr&&this.markUsedJustification(o,Lr.anchor,Ce,pt);const Wr=this.placedOrientations[Xe];Wr&&(this.markUsedJustification(o,"left",Ce,Wr),this.markUsedOrientation(o,Wr,Ce))}if(st){const xt=Bf(Pe.icon),{placedIconSymbolIndex:hr,verticalPlacedIconSymbolIndex:tr}=Ce,Cr=o.icon.placedSymbolArray,zt=Pe.icon.isHidden()?1:0;hr>=0&&(he(o.icon,Be,Tt?ud:xt),Cr.get(hr).hidden=zt),tr>=0&&(he(o.icon,Ce.numVerticalIconVertices,Zt?ud:xt),Cr.get(tr).hidden=zt)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const xt=o.collisionArrays[xe];if(xt){let hr=new s.P(0,0),tr=!0;if(xt.textBox||xt.verticalTextBox){if(Z){const zt=this.variableOffsets[Xe];zt?(hr=ju(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textScale),J&&hr._rotate(ee?this.transform.angle:-this.transform.angle)):tr=!1}A&&(tr=!Pe.clipped),xt.textBox&&Bc(o.textCollisionBox.collisionVertexArray,Pe.text.placed,!tr||Tt,hr.x,hr.y),xt.verticalTextBox&&Bc(o.textCollisionBox.collisionVertexArray,Pe.text.placed,!tr||Zt,hr.x,hr.y)}const Cr=tr&&!!(!Zt&&xt.verticalIconBox);xt.iconBox&&Bc(o.iconCollisionBox.collisionVertexArray,Pe.icon.placed,Cr,Ce.hasIconTextFit?hr.x:0,Ce.hasIconTextFit?hr.y:0),xt.verticalIconBox&&Bc(o.iconCollisionBox.collisionVertexArray,Pe.icon.placed,!Cr,Ce.hasIconTextFit?hr.x:0,Ce.hasIconTextFit?hr.y:0)}}}if(o.fullyClipped=we===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const xe=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=xe.invProjMatrix,o.placementViewportMatrix=xe.viewportMatrix,o.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const x=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*x>o}setStale(){this.stale=!0}}function Bc(_,o,h,x,I){_.emplaceBack(o?1:0,h?1:0,x||0,I||0),_.emplaceBack(o?1:0,h?1:0,x||0,I||0),_.emplaceBack(o?1:0,h?1:0,x||0,I||0),_.emplaceBack(o?1:0,h?1:0,x||0,I||0)}const Zp=Math.pow(2,25),ld=Math.pow(2,24),xh=Math.pow(2,17),Xp=Math.pow(2,16),cd=Math.pow(2,9),gc=Math.pow(2,8),Bm=Math.pow(2,1);function Bf(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const o=_.placed?1:0,h=Math.floor(127*_.opacity);return h*Zp+o*ld+h*xh+o*Xp+h*cd+o*gc+h*Bm+o}const ud=0;class bh{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,x,I,A){const D=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(D,I,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((N,U)=>N.sortKey-U.sortKey));this._currentPartIndex<D.length;){const N=D[this._currentPartIndex];if(h.placeLayerBucketPart(N,this._seenCrossTileIDs,x,N.symbolInstanceStart===0),this._currentPartIndex++,A())return!0}return!1}}class Bu{constructor(o,h,x,I,A,D,N,U,Z){this.placement=new sd(o,A,D,N,U,Z),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(o,h,x,I){const A=s.f.now(),D=()=>{const N=s.f.now()-A;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=h[o[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=U)&&(!N.maxzoom||N.maxzoom>U)){const Z=N,J=Z.layout.get("symbol-z-elevate"),ee=this._inProgressLayer=this._inProgressLayer||new bh(Z),ae=s.ag(N.source,N.scope);if(ee.continuePlacement(J?I[ae]:x[ae],this.placement,this._showCollisionBoxes,N,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const hd=512/s.V/2;class Yp{constructor(o,h,x){this.tileID=o,this.bucketInstanceId=x,this.index=new s.bg(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const I=o.canonical.x*s.V,A=o.canonical.y*s.V;for(let D=0;D<h.length;D++){const{key:N,crossTileID:U,tileAnchorX:Z,tileAnchorY:J}=h.get(D),ee=Math.floor((I+Z)*hd),ae=Math.floor((A+J)*hd);this.index.add(ee,ae),this.keys.push(N),this.crossTileIDs.push(U)}this.index.finish()}findMatches(o,h,x){const I=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),A=hd/Math.pow(2,h.canonical.z-this.tileID.canonical.z),D=h.canonical.x*s.V,N=h.canonical.y*s.V;for(let U=0;U<o.length;U++){const Z=o.get(U);if(Z.crossTileID)continue;const{key:J,tileAnchorX:ee,tileAnchorY:ae}=Z,he=Math.floor((D+ee)*A),we=Math.floor((N+ae)*A),xe=this.index.range(he-I,we-I,he+I,we+I);for(const Ce of xe){const ge=this.crossTileIDs[Ce];if(this.keys[Ce]===J&&!x.has(ge)){x.add(ge),Z.crossTileID=ge;break}}}}}class dd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kp{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const x in this.indexes){const I=this.indexes[x],A={};for(const D in I){const N=I[D];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+h),A[N.tileID.key]=N}this.indexes[x]=A}this.lng=o}addBucket(o,h,x){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let A=0;A<h.symbolInstances.length;A++)h.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const I=this.usedCrossTileIDs[o.overscaledZ];for(const A in this.indexes){const D=this.indexes[A];if(Number(A)>o.overscaledZ)for(const N in D){const U=D[N];U.tileID.isChildOf(o)&&U.findMatches(h.symbolInstances,o,I)}else{const N=D[o.scaledTo(Number(A)).key];N&&N.findMatches(h.symbolInstances,o,I)}}for(let A=0;A<h.symbolInstances.length;A++){const D=h.symbolInstances.get(A);D.crossTileID||(D.crossTileID=x.generate(),I.add(D.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Yp(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const x of h.crossTileIDs)this.usedCrossTileIDs[o].delete(x)}removeStaleBuckets(o){let h=!1;for(const x in this.indexes){const I=this.indexes[x];for(const A in I)o[I[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,I[A]),delete I[A],h=!0)}return h}}class pd{constructor(){this.layerIndexes={},this.crossTileIDs=new dd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,x,I){let A=this.layerIndexes[o.fqid];A===void 0&&(A=this.layerIndexes[o.fqid]=new Kp);let D=!1;const N={};I.name!=="globe"&&A.handleWrapJump(x);for(const U of h){const Z=U.getBucket(o);Z&&o.fqid===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(U.tileID,Z,this.crossTileIDs)&&(D=!0),N[Z.bucketInstanceId]=!0)}return A.removeStaleBuckets(N)&&(D=!0),D}pruneUnusedLayers(o){const h={};o.forEach(x=>{h[x]=!0});for(const x in this.layerIndexes)h[x]||delete this.layerIndexes[x]}}class uu{constructor(o=0,h=0,x=0,I=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(x)||x<0||isNaN(I)||I<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=x,this.right=I}interpolate(o,h,x){return h.top!=null&&o.top!=null&&(this.top=s.U(o.top,h.top,x)),h.bottom!=null&&o.bottom!=null&&(this.bottom=s.U(o.bottom,h.bottom,x)),h.left!=null&&o.left!=null&&(this.left=s.U(o.left,h.left,x)),h.right!=null&&o.right!=null&&(this.right=s.U(o.right,h.right,x)),this}getCenter(o,h){const x=s.aa((this.left+o-this.right)/2,0,o),I=s.aa((this.top+h-this.bottom)/2,0,h);return new s.P(x,I)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new uu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ip(_,o){const h=s.bk(_,3);s.a6.fromQuat(_,o),s.bm(_,3,h)}function fd(_,o){const h=s.bi.identity([]);return s.bi.rotateZ(h,h,-o),s.bi.rotateX(h,h,-_),h}function md(_,o){const h=[_[0],_[1],0],x=[o[0],o[1],0];if(s.N.length(h)>=1e-15){const D=s.N.normalize([],h);s.N.scale(x,D,s.N.dot(x,D)),o[0]=x[0],o[1]=x[1]}const I=s.N.cross([],o,_);if(s.N.len(I)<1e-15)return null;const A=Math.atan2(-I[1],I[0]);return fd(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),A)}class wh{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){const h=o instanceof s.L?o:new s.L(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=s.bh(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;const x=this.position,I=this._elevation?this._elevation.getAtPointOrZero(s.L.fromLngLat(o)):0,A=s.L.fromLngLat(o,I),D=[A.x-x.x,A.y-x.y,A.z-x.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=md(D,h)}setPitchBearing(o,h){this.orientation=fd(s.bj(o),s.bj(-h))}}class Fu{constructor(o,h){this._transform=s.a6.identity([]),this.orientation=h,this.position=o}get mercatorPosition(){const o=this.position;return new s.L(o[0],o[1],o[2])}get position(){const o=s.bk(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&s.bm(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.bi.identity([]),o&&ip(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=fd(o,h),ip(this._transform,this._orientation)}forward(){const o=s.bk(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.bk(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.bk(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){const x=new Float64Array(16);return s.a6.invert(x,this.getWorldToCamera(o,h)),x}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,h,x){const I=this.position;s.N.scale(I,I,-o);const A=new Float64Array(16);return s.a6.fromScaling(A,[x,x,x]),s.a6.translate(A,A,I),A[10]*=h,A}getWorldToCamera(o,h){const x=new Float64Array(16),I=new Float64Array(4),A=this.position;return s.bi.conjugate(I,this._orientation),s.N.scale(A,A,-o),s.a6.fromQuat(x,I),s.a6.translate(x,x,A),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=h,x[9]*=h,x[10]*=h,x[11]*=h,x}getCameraToClipPerspective(o,h,x,I){const A=new Float64Array(16);return s.a6.perspective(A,o,h,x,I),A}getCameraToClipOrthographic(o,h,x,I,A,D){const N=new Float64Array(16);return s.a6.ortho(N,o,h,x,I,A,D),N}getDistanceToElevation(o,h=!1){const x=o===0?0:s.bl(o,h?s.au(this.position[1]):this.position[1]),I=this.forward();return(x-this.position[2])/I[2]}clone(){return new Fu([...this.position],[...this.orientation])}}const Vu=(_,o,h)=>(1-h)*_+h*o,hu=_=>_*_*_*_*_;class gd{constructor(o,h,x,I,A,D,N){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=x??0,this._maxPitch=I??60,this.setProjection(D),this.setMaxBounds(N),this.width=0,this.height=0,this._center=new s.bn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new uu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Fu,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const o=new gd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,h=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(o||x)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return s.ac(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=s.bo(this.projectionOptions);const x=!L(h,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.bo({name:"mercator"});const h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.bl(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bh(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const h=-o*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=s.b4.create(),s.b4.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=s.aa(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=s.bj(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const x=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&x.exaggeration()&&this._centerAltitudeValidForExaggeration!==x.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*x.exaggeration(),this._centerAltitudeValidForExaggeration=x.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=x.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let I=0,A=0;for(let D=0;D<h.length;D++){const N=new s.P(h[D][0]*this.width,x+h[D][1]*(this.height-x)),U=o.pointCoordinate(N);if(!U)continue;const Z=1/Math.hypot(U[0]-this._camera.position[0],U[1]-this._camera.position[1]);I+=U[3]*Z,A+=Z}return A===0?NaN:I/A}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*h,I=this._mercatorZfromZoom(o),A=this._mercatorZfromZoom(this._maxZoom),D=Math.max(I-x,A);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let x;x=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];const I=s.N.length(s.N.sub([],this._camera.position,x));return s.aa(this._zoomFromMercatorZ(I),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!s.bi.exactEquals(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){const x=[o.position.x,o.position.y,o.position.z];s.N.exactEquals(x,this._camera.position)||(this._setCameraPosition(x),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,h=new wh;return h.position=new s.L(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!s.bi.length(o))return!1;s.bi.normalize(o,o);const h=s.N.transformQuat([],[0,0,-1],o),x=s.N.transformQuat([],[0,-1,0],o);if(x[2]<0)return!1;const I=md(h,x);return!!I&&(this._camera.orientation=I,!0)}_setCameraPosition(o){const h=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,I=this.cameraToCenterDistance;o[2]=s.aa(o[2],I/x,I/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,x){this._unmodified=!1,this._edgeInsets.interpolate(o,h,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new s.bp(0,o)];if(this.renderWorldCopies){const x=this.pointCoordinate(new s.P(0,0)),I=this.pointCoordinate(new s.P(this.width,0)),A=this.pointCoordinate(new s.P(this.width,this.height)),D=this.pointCoordinate(new s.P(0,this.height)),N=Math.floor(Math.min(x.x,I.x,A.x,D.x)),U=Math.floor(Math.max(x.x,I.x,A.x,D.x)),Z=1;for(let J=N-Z;J<=U+Z;J++)J!==0&&h.push(new s.bp(J,o))}return h}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(o,h,x){let I=[];if(h[0]===0&&h[1]===0)return I;for(const D of o){const N=D.canonical,U=D.overscaledZ,Z=D.wrap,J=1<<N.z,ee=N.x+1<J,ae=N.x>0,he=N.y+1<J,we=N.y>0,xe=D.wrap-(ae?0:1),Ce=D.wrap+(ee?0:1),ge=ae?N.x-1:J-1,De=ee?N.x+1:0;h[0]<0?(I.push(new s.am(U,Ce,N.z,De,N.y)),h[1]<0&&he&&(I.push(new s.am(U,Z,N.z,N.x,N.y+1)),I.push(new s.am(U,Ce,N.z,De,N.y+1))),h[1]>0&&we&&(I.push(new s.am(U,Z,N.z,N.x,N.y-1)),I.push(new s.am(U,Ce,N.z,De,N.y-1)))):h[0]>0?(I.push(new s.am(U,xe,N.z,ge,N.y)),h[1]<0&&he&&(I.push(new s.am(U,Z,N.z,N.x,N.y+1)),I.push(new s.am(U,xe,N.z,ge,N.y+1))),h[1]>0&&we&&(I.push(new s.am(U,Z,N.z,N.x,N.y-1)),I.push(new s.am(U,xe,N.z,ge,N.y-1)))):h[1]<0&&he?I.push(new s.am(U,Z,N.z,N.x,N.y+1)):we&&I.push(new s.am(U,Z,N.z,N.x,N.y-1))}if(I.length>1){I.sort((U,Z)=>U.overscaledZ-Z.overscaledZ||U.wrap-Z.wrap||U.canonical.z-Z.canonical.z||U.canonical.x-Z.canonical.x||U.canonical.y-Z.canonical.y);let D=0,N=0;for(;N<I.length;)I[N].equals(I[D])?++N:I[++D]=I[N++];I.length=D+1}const A=[];for(const D of I)I.some(N=>D.isChildOf(N))||A.push(D);return I=A.filter(D=>!o.some(N=>!!(D.overscaledZ<x&&N.isChildOf(D))||D.equals(N)||D.isChildOf(N))),I}coveringTiles(o){let h=this.coveringZoomLevel(o);const x=h,I=this.elevation&&this.elevation.exaggeration(),A=I&&!o.isTerrainDEM,D=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const N=this.locationCoordinate(this.center),U=this.center.lat,Z=1<<h,J=[Z*N.x,Z*N.y,0],ee=this.projection.name==="globe",ae=!ee,he=s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,ae),we=ee?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),xe=Z*s.bl(1,this.center.lat),Ce=this._camera.position[2]/s.bl(1,this.center.lat),ge=[Z*we.x,Z*we.y,Ce*(ae?1:xe)],De=ee||I,Xe=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Be=this.isLODDisabled(!0)?h:0;let We;if(this._elevation&&o.isTerrainDEM)We=1e4*this._elevation.exaggeration();else if(this._elevation){const vt=this._elevation.getMinMaxForVisibleTiles();We=vt?vt.max:this._centerAltitude}else We=this._centerAltitude;const Pe=o.isTerrainDEM?-We:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ke=this.projection.isReprojectedInTileSpace?s.br(this):1,st=vt=>{const Lr=new s.L(vt.x+25e-6,vt.y,vt.z),Wr=new s.L(vt.x,vt.y+25e-6,vt.z),Gr=vt.toLngLat(),tn=Lr.toLngLat(),_n=Wr.toLngLat(),Fn=this.locationCoordinate(Gr),wn=this.locationCoordinate(tn),Sn=this.locationCoordinate(_n),Mi=Math.hypot(wn.x-Fn.x,wn.y-Fn.y),pi=Math.hypot(Sn.x-Fn.x,Sn.y-Fn.y);return Math.sqrt(Mi*pi)*Ke/25e-6},pt=vt=>{const Ut=We,Lr=Pe;return{aabb:s.bu(this,Z,0,0,0,vt,Lr,Ut,this.projection),zoom:0,x:0,y:0,minZ:Lr,maxZ:Ut,wrap:vt,fullyVisible:!1}},Tt=[];let Zt=[];const xt=h,hr=o.reparseOverscaled?x:h,tr=vt=>vt*vt,Cr=tr((Ce-this._centerAltitude)*xe),zt=vt=>{if(!this._elevation||!vt.tileID||!D)return;const Ut=this._elevation.getMinMaxForTile(vt.tileID),Lr=vt.aabb;Ut?(Lr.min[2]=Ut.min,Lr.max[2]=Ut.max,Lr.center[2]=(Lr.min[2]+Lr.max[2])/2):(vt.shouldSplit=ir(vt),vt.shouldSplit||(Lr.min[2]=Lr.max[2]=Lr.center[2]=this._centerAltitude))},ir=vt=>{if(vt.zoom<Be)return!0;if(vt.zoom===xt)return!1;if(vt.shouldSplit!=null)return vt.shouldSplit;const Ut=vt.aabb.distanceX(ge),Lr=vt.aabb.distanceY(ge);let Wr=Cr,Gr=1;if(ee){Wr=tr(vt.aabb.distanceZ(ge));const Fn=Math.pow(2,vt.zoom),wn=s.au((vt.y+1)/Fn),Sn=s.au(vt.y/Fn),Mi=Math.min(Math.max(U,wn),Sn),pi=s.bJ(Mi)/s.bJ(U);if(Gr=Mi===U?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,pi/this._mercatorScaleRatio),this.zoom<=s.bG&&vt.zoom===xt-1&&pi>=.9)return!0}else if(A&&(Wr=tr(vt.aabb.distanceZ(ge)*xe)),this.projection.isReprojectedInTileSpace&&x<=5){const Fn=Math.pow(2,vt.zoom),wn=st(new s.L((vt.x+.5)/Fn,(vt.y+.5)/Fn));Gr=wn>.85?1:wn}const tn=Ut*Ut+Lr*Lr+Wr,_n=tr((1<<xt-vt.zoom)*Xe*Gr*((Fn,wn)=>{if(wn*tr(.707)<Fn)return 1;const Sn=Math.sqrt(wn/Fn);return Sn/(1.4144271570014144+(Math.pow(1.1,Sn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Wr,Cr),tn));return tn<_n};if(this.renderWorldCopies)for(let vt=1;vt<=3;vt++)Tt.push(pt(-vt)),Tt.push(pt(vt));for(Tt.push(pt(0));Tt.length>0;){const vt=Tt.pop(),Ut=vt.x,Lr=vt.y;let Wr=vt.fullyVisible;const Gr=()=>this.projection.name==="globe"&&(vt.y===0||vt.y===(1<<vt.zoom)-1);if(!Wr){let tn=De?vt.aabb.intersects(he):vt.aabb.intersectsFlat(he);if(tn===0&&Gr()){const _n=new s.bs(vt.zoom,Ut,Lr);tn=s.bt(this,Z,_n,!0).intersects(he)}if(tn===0)continue;Wr=tn===2}if(vt.zoom!==xt&&ir(vt))for(let tn=0;tn<4;tn++){const _n=(Ut<<1)+tn%2,Fn=(Lr<<1)+(tn>>1),wn={aabb:D?vt.aabb.quadrant(tn):s.bu(this,Z,vt.zoom+1,_n,Fn,vt.wrap,vt.minZ,vt.maxZ,this.projection),zoom:vt.zoom+1,x:_n,y:Fn,wrap:vt.wrap,fullyVisible:Wr,tileID:void 0,shouldSplit:void 0,minZ:vt.minZ,maxZ:vt.maxZ};A&&!ee&&(wn.tileID=new s.am(vt.zoom+1===xt?hr:vt.zoom+1,vt.wrap,vt.zoom+1,_n,Fn),zt(wn)),Tt.push(wn)}else{const tn=vt.zoom===xt?hr:vt.zoom;if(o.minzoom&&o.minzoom>tn)continue;if(!Wr){let Sn=De?vt.aabb.intersectsPrecise(he):vt.aabb.intersectsPreciseFlat(he);if(Sn===0&&Gr()){const Mi=new s.bs(vt.zoom,Ut,Lr);Sn=s.bt(this,Z,Mi,!0).intersectsPrecise(he)}if(Sn===0)continue}const _n=J[0]-(.5+Ut+(vt.wrap<<vt.zoom))*(1<<h-vt.zoom),Fn=J[1]-.5-Lr,wn=vt.tileID?vt.tileID:new s.am(tn,vt.wrap,vt.zoom,Ut,Lr);Zt.push({tileID:wn,distanceSq:_n*_n+Fn*Fn})}}if(this.fogCullDistSq){const vt=this.fogCullDistSq,Ut=this.horizonLineFromTop();Zt=Zt.filter(Lr=>{const Wr=[0,0,0,1],Gr=[s.V,s.V,0,1],tn=this.calculateFogTileMatrix(Lr.tileID.toUnwrapped());s.a7.transformMat4(Wr,Wr,tn),s.a7.transformMat4(Gr,Gr,tn);const _n=s.a7.min([],Wr,Gr),Fn=s.a7.max([],Wr,Gr),wn=s.bv(_n,Fn);if(wn===0)return!0;let Sn=!1;const Mi=this._elevation;if(Mi&&wn>vt&&Ut!==0){const pi=this.calculateProjMatrix(Lr.tileID.toUnwrapped());let Ci;o.isTerrainDEM||(Ci=Mi.getMinMaxForTile(Lr.tileID)),Ci||(Ci={min:Pe,max:We});const Ti=s.bH(this.rotation),ro=[Ti[0]*s.V,Ti[1]*s.V,Ci.max];s.N.transformMat4(ro,ro,pi),Sn=(1-ro[1])*this.height*.5<Ut}return wn<vt||Sn})}return Zt.sort((vt,Ut)=>vt.distanceSq-Ut.distanceSq).map(vt=>vt.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=s.aa(o.lat,-s.bw,s.bw),x=this.projection.project(o.lng,h);return new s.P(x.x*this.worldSize,x.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.bl(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let x,I;const A=this.centerPoint;if(this.projection.name==="globe"){const N=this.worldSize;x=(h.x-A.x)/N,I=(h.y-A.y)/N}else{const N=this.pointCoordinate(h),U=this.pointCoordinate(A);x=N.x-U.x,I=N.y-U.y}const D=this.locationCoordinate(o);this.setLocation(new s.L(D.x-x,D.y-I))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,h){const x=h?s.bl(h,o.lat):void 0,I=this.projection.project(o.lng,o.lat);return new s.L(I.x,I.y,x)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){const x=h??this._centerAltitude,I=[o.x,o.y,0,1],A=[o.x,o.y,1,1];s.a7.transformMat4(I,I,this.pixelMatrixInverse),s.a7.transformMat4(A,A,this.pixelMatrixInverse);const D=A[3];s.a7.scale(I,I,1/I[3]),s.a7.scale(A,A,1/D);const N=I[2],U=A[2];return{p0:I,p1:A,t:N===U?0:(x-N)/(U-N)}}screenPointToMercatorRay(o){const h=[o.x,o.y,0,1],x=[o.x,o.y,1,1];return s.a7.transformMat4(h,h,this.pixelMatrixInverse),s.a7.transformMat4(x,x,this.pixelMatrixInverse),s.a7.scale(h,h,1/h[3]),s.a7.scale(x,x,1/x[3]),h[2]=s.bl(h[2],this._center.lat)*this.worldSize,x[2]=s.bl(x[2],this._center.lat)*this.worldSize,s.a7.scale(h,h,1/this.worldSize),s.a7.scale(x,x,1/this.worldSize),new s.a2([h[0],h[1],h[2]],s.N.normalize([],s.N.sub([],x,h)))}rayIntersectionCoordinate(o){const{p0:h,p1:x,t:I}=o,A=s.bl(h[2],this._center.lat),D=s.bl(x[2],this._center.lat);return new s.L(s.U(h[0],x[0],I)/this.worldSize,s.U(h[1],x[1],I)/this.worldSize,s.U(A,D,I))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let h=this.projection.pointCoordinate3D(this,o.x,o.y);if(h)return new s.L(h[0],h[1],h[2]);let x=0,I=this.horizonLineFromTop();if(o.y>I)return this.pointCoordinate(o);const A=.02*I,D=o.clone();for(let N=0;N<10&&I-x>A;N++){D.y=s.U(x,I,.66);const U=this.projection.pointCoordinate3D(this,D.x,D.y);U?(I=D.y,h=U):x=D.y}return h?new s.L(h[0],h[1],h[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=s.bx)return!this.isPointAboveHorizon(o);const h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){const x=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,I=[o.x*this.worldSize,o.y*this.worldSize,x+o.toAltitude(),1];return s.a7.transformMat4(I,I,this.pixelMatrix),I[3]>0?new s.P(I[0]/I[3],I[1]/I[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:h}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,A=this.pointLocation3D(new s.P(h,o)),D=this.pointLocation3D(new s.P(I,o)),N=this.pointLocation3D(new s.P(I,x)),U=this.pointLocation3D(new s.P(h,x));let Z=Math.min(A.lng,D.lng,N.lng,U.lng),J=Math.max(A.lng,D.lng,N.lng,U.lng),ee=Math.min(A.lat,D.lat,N.lat,U.lat),ae=Math.max(A.lat,D.lat,N.lat,U.lat);const he=Math.pow(2,-this.zoom)/16*270,we=this.projection.name==="globe"?1:4,xe=(Ce,ge,De,Xe,Be)=>{const We=(Ce+De)/2,Pe=(ge+Xe)/2,Ke=new s.P(We,Pe),{lng:st,lat:pt}=this.pointLocation3D(Ke),Tt=Math.max(0,Z-st,ee-pt,st-J,pt-ae);Z=Math.min(Z,st),J=Math.max(J,st),ee=Math.min(ee,pt),ae=Math.max(ae,pt),(Be<we||Tt>he)&&(xe(Ce,ge,We,Pe,Be+1),xe(We,Pe,De,Xe,Be+1))};if(xe(h,o,I,o,1),xe(I,o,I,x,1),xe(I,x,h,x,1),xe(h,x,h,o,1),this.projection.name==="globe"){const[Ce,ge]=s.by(this);Ce?(ae=90,J=180,Z=-180):ge&&(ee=-90,J=180,Z=-180)}return new s.ad(new s.bn(Z,ee),new s.bn(J,ae))}_getBoundsRectangular(o,h){const{top:x,left:I}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,D=this.width-this._edgeInsets.right,N=new s.P(I,x),U=new s.P(D,x),Z=new s.P(D,A),J=new s.P(I,A);let ee=this.pointCoordinate(N,o),ae=this.pointCoordinate(U,o);const he=this.pointCoordinate(Z,h),we=this.pointCoordinate(J,h),xe=(Ce,ge)=>(ge.y-Ce.y)/(ge.x-Ce.x);return ee.y>1&&ae.y>=0?ee=new s.L((1-we.y)/xe(we,ee)+we.x,1):ee.y<0&&ae.y<=1&&(ee=new s.L(-we.y/xe(we,ee)+we.x,0)),ae.y>1&&ee.y>=0?ae=new s.L((1-he.y)/xe(he,ae)+he.x,1):ae.y<0&&ee.y<=1&&(ae=new s.L(-he.y/xe(he,ae)+he.x,0)),new s.ad().extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(we)).extend(this.coordinateLocation(he))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=o.visibleDemTiles.reduce((x,I)=>{if(I.dem){const A=I.dem.tree;x.min=Math.min(x.min,A.minimums[0]),x.max=Math.max(x.max,A.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,x=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-s.bw,this.maxLat=s.bw,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.a5(this.minLng)*this.tileSize,this.worldMaxX=s.a5(this.maxLng)*this.tileSize,this.worldMinY=s.ae(this.maxLat)*this.tileSize,this.worldMaxY=s.ae(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){const h=o.key,x=this._distanceTileDataCache;if(x[h])return x[h];const I=o.canonical,A=1/this.height,D=this.cameraWorldSize,N=D/this.zoomScale(I.z),U=(I.x+Math.pow(2,I.z)*o.wrap)*N,Z=I.y*N,J=this.point;J.x*=D/this.worldSize,J.y*=D/this.worldSize;const ee=this.angle,ae=Math.sin(-ee),he=-Math.cos(-ee);return x[h]={bearing:[ae,he],center:[(J.x-U)*A,(J.y-Z)*A],scale:N/s.V*A},x[h]}calculateFogTileMatrix(o){const h=o.key,x=this._fogTileMatrixCache;if(x[h])return x[h];const I=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return s.a6.multiply(I,this.worldToFogMatrix,I),x[h]=new Float32Array(I),x[h]}calculateProjMatrix(o,h=!1,x=!1){const I=o.key;let A;if(A=x?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,A[I])return A[I];const D=this.calculatePosMatrix(o,this.worldSize);let N;return N=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:x?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,s.a6.multiply(D,N,D),A[I]=new Float32Array(D),A[I]}calculatePixelsToTileUnitsMatrix(o){const h=o.tileID.key,x=this._pixelsToTileUnitsCache;if(x[h])return x[h];const I=s.bz(o,this);return x[h]=I,x[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,h=s.a6.fromScaling([],[o,o,o]);return s.a6.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const h=s.bl(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(h),I=this._camera.forward(),A=s.bl(1,this._center.lat);x[2]/=A,I[2]/=A,s.N.normalize(I,I);const D=o.raycast(x,I,o.exaggeration());if(D){const N=s.N.scaleAndAdd([],x,I,D),U=new s.L(N[0],N[1],s.bl(N[2],s.au(N[1]))),Z=(U.z+s.N.length([U.x-x[0],U.y-x[1],U.z-x[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=U.toAltitude(),this._center=this.coordinateLocation(U),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const h=this._elevation,x=s.bl(1,this._center.lat)*this.worldSize,I=this._computeCameraPosition(x),A=h.getAtPointOrZero(new s.L(...I)),D=this.pixelsPerMeter/this.worldSize*A,N=this._minimumHeightOverTerrain(),U=I[2]-D;if(U<=N)if(U<0||o){const Z=this.locationCoordinate(this._center,this._centerAltitude),J=[I[0],I[1],Z.z-I[2]],ee=s.N.length(J);J[2]-=(N-U)/this._pixelsPerMercatorPixel;const ae=s.N.length(J);if(ae===0)return;s.N.scale(J,J,ee/ae*this._pixelsPerMercatorPixel),this._camera.position=[I[0],I[1],Z.z*this._pixelsPerMercatorPixel-J[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const ae=this.center;return ae.lat=s.aa(ae.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(ae.lng=s.aa(ae.lng,this.minLng,this.maxLng)),this.center=ae,void(this._constraining=!1)}const h=this._unmodified,{x,y:I}=this.point;let A=0,D=x,N=I;const U=this.width/2,Z=this.height/2,J=this.worldMinY*this.scale,ee=this.worldMaxY*this.scale;if(I-Z<J&&(N=J+Z),I+Z>ee&&(N=ee-Z),ee-J<this.height&&(A=Math.max(A,this.height/(ee-J)),N=(ee+J)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ae=this.worldMinX*this.scale,he=this.worldMaxX*this.scale,we=this.worldSize/2-(ae+he)/2;D=(x+we+this.worldSize)%this.worldSize-we,D-U<ae&&(D=ae+U),D+U>he&&(D=he-U),he-ae<this.width&&(A=Math.max(A,this.width/(he-ae)),D=(he+ae)/2)}D===x&&N===I||(this.center=this.unproject(new s.P(D,N))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.projection.name==="globe",x=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.bl(1,this.center.lat)/s.bl(1,s.bI));const I=s.bA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,I),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?x:1,D=this._camera.getWorldToCamera(this.worldSize,A);let N;const U=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(U[8]=2*-o.x/this.width,U[9]=2*o.y/this.height,this.isOrthographic){let pt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Tt=pt*this.aspect,Zt=-Tt,xt=-pt;Tt-=o.x,Zt-=o.x,pt+=o.y,xt+=o.y,N=this._camera.getCameraToClipOrthographic(Zt,Tt,xt,pt,this._nearZ,this._farZ),((hr,tr,Cr,zt)=>{for(let ir=0;ir<16;ir++)hr[ir]=Vu(tr[ir],Cr[ir],zt)})(N,N,U,hu(this.pitch>=15?1:this.pitch/15))}else N=U;const Z=s.a6.mul([],U,D);let J=s.a6.mul([],N,D);if(this.projection.isReprojectedInTileSpace){const pt=this.locationCoordinate(this.center),Tt=s.a6.identity([]);s.a6.translate(Tt,Tt,[pt.x*this.worldSize,pt.y*this.worldSize,0]),s.a6.multiply(Tt,Tt,s.bB(this)),s.a6.translate(Tt,Tt,[-pt.x*this.worldSize,-pt.y*this.worldSize,0]),s.a6.multiply(J,J,Tt),s.a6.multiply(Z,Z,Tt),this.inverseAdjustmentMatrix=s.bC(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.a6.scale([],J,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=J,this.invProjMatrix=s.a6.invert(new Float64Array(16),this.projMatrix),h){const pt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);pt[8]=2*-o.x/this.width,pt[9]=2*o.y/this.height,this.expandedFarZProjMatrix=s.a6.mul([],pt,D)}else this.expandedFarZProjMatrix=this.projMatrix;const ee=s.a6.invert([],N);this.frustumCorners=s.bD.fromInvProjectionMatrix(ee,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);const ae=new Float32Array(16);s.a6.identity(ae),s.a6.scale(ae,ae,[1,-1,1]),s.a6.rotateX(ae,ae,this._pitch),s.a6.rotateZ(ae,ae,this.angle);const he=s.a6.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.a6.clone(he);const we=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;he[8]=2*-o.x/this.width,he[9]=2*(o.y+we)/this.height,this.skyboxMatrix=s.a6.multiply(ae,he,ae);const xe=this.point,Ce=xe.x,ge=xe.y,De=this.width%2/2,Xe=this.height%2/2,Be=Math.cos(this.angle),We=Math.sin(this.angle),Pe=Ce-Math.round(Ce)+Be*De+We*Xe,Ke=ge-Math.round(ge)+Be*Xe+We*De,st=new Float64Array(J);if(s.a6.translate(st,st,[Pe>.5?Pe-1:Pe,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=st,J=s.a6.create(),s.a6.scale(J,J,[this.width/2,-this.height/2,1]),s.a6.translate(J,J,[1,-1,0]),this.labelPlaneMatrix=J,J=s.a6.create(),s.a6.scale(J,J,[1,-1,1]),s.a6.translate(J,J,[-1,-1,0]),s.a6.scale(J,J,[2/this.width,2/this.height,1]),this.glCoordMatrix=J,this.pixelMatrix=s.a6.multiply(new Float64Array(16),this.labelPlaneMatrix,Z),this._calcFogMatrices(),this._distanceTileDataCache={},J=s.a6.invert(new Float64Array(16),this.pixelMatrix),!J)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=J,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.bE(this);const pt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.N.transformMat4(pt,pt,D),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=J;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,x=this._camera.position,I=1/this.height/this._pixelsPerMercatorPixel,A=[o,o,h];s.N.scale(A,A,I),s.N.scale(x,x,-1),s.N.multiply(x,x,A);const D=s.a6.create();s.a6.translate(D,D,x),s.a6.scale(D,D,A),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,I)}_computeCameraPosition(o){const h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),I=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[I.x/this.worldSize-x[0]*A,I.y/this.worldSize-x[1]*A,o/this.worldSize*this._centerAltitude-x[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],I=o[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),I>0&&(A=Math.min((h-x)/I,1)),this._camera.position=s.N.scaleAndAdd([],this._camera.position,o,A),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,h=this._camera.forward(),{pitch:x,bearing:I}=this._camera.getPitchBearing(),A=s.bl(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.bj(this._maxPitch)),N=Math.max((o[2]-A)/Math.cos(x),D),U=this._zoomFromMercatorZ(N);s.N.scaleAndAdd(o,o,h,N),this._pitch=s.aa(x,s.bj(this.minPitch),s.bj(this.maxPitch)),this.angle=s.bh(I,-Math.PI,Math.PI),this._setZoom(s.aa(U,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.L(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,x=s.bx,I=0,A=1/0;for(;x-h>1e-6&&x>h;){const D=h+.5*(x-h),N=this.tileSize*Math.pow(2,D),U=this.getCameraToCenterDistance(this.projection,D,N),Z=this.scaleZoom(U/(o*this.tileSize)),J=Math.abs(D-Z);J<A&&(A=J,I=D),D<Z?h=D:x=D}return I}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){const x=Math.min(o.x,h.x),I=Math.max(o.x,h.x),A=Math.min(o.y,h.y),D=Math.max(o.y,h.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const N=[new s.P(x,A),new s.P(I,D),new s.P(x,D),new s.P(I,A)],U=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const J of N){const ee=this.pointRayIntersection(J);if(ee.t<0)return!0;const ae=this.rayIntersectionCoordinate(ee);if(ae.x<U||ae.y<0||ae.x>Z||ae.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.bF(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(o,h){const x=s.N.length(s.N.sub([],this._camera.position,o)),I=this._zoomFromMercatorZ(x)+h;return x-this._mercatorZfromZoom(I)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([h,x,I],A){const D=[h,x,I,1];s.a7.transformMat4(D,D,A);const N=D[3]=Math.max(D[3],1e-6);return D[0]/=N,D[1]/=N,D[2]/=N,D}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,o))}}getCameraToCenterDistance(o,h=this.zoom,x=this.worldSize){const I=s.bA(o,h,this.width,this.height,1024),A=o.pixelSpaceConversion(this.center.lat,x,I);let D=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(D=Vu(1,D,hu(this.pitch>=15?1:this.pitch/15))),D}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.a6.multiply(o,o,this.globeMatrix),o}getFrustum(o){return s.bq.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const Aa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Oo=(_,o)=>{if(o>0&&_.terrain&&s.w("Cutoff is currently disabled on terrain"),o<=0||_.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const h=_.transform,x=Math.max(Math.abs(h._zoom-(_.minCutoffZoom-1)),1),I=h.isLODDisabled(!1)?s.O(60,45,h.pitch):s.O(30,15,h.pitch),A=h._farZ-h._nearZ,D=o*h.height,N=((1-(U=I))*h.cameraToCenterDistance+U*(h._farZ+D))*x;var U;return{shouldRenderCutoff:I<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(N-h._nearZ)/A,(N-D-h._nearZ)/A]}}},Is={cascadeCount:2,shadowMapResolution:2048};class du{constructor(o,h){this.aabb=o,this.lastCascade=h}}class pu{add(o,h){const x=this.receivers[o.key];x!==void 0?(x.aabb.min[0]=Math.min(x.aabb.min[0],h.min[0]),x.aabb.min[1]=Math.min(x.aabb.min[1],h.min[1]),x.aabb.min[2]=Math.min(x.aabb.min[2],h.min[2]),x.aabb.max[0]=Math.max(x.aabb.max[0],h.max[0]),x.aabb.max[1]=Math.max(x.aabb.max[1],h.max[1]),x.aabb.max[2]=Math.max(x.aabb.max[2],h.max[2])):this.receivers[o.key]=new du(h,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,h,x){const I=s.bS.fromPoints(o.points);let A=0;for(const D in this.receivers){const N=this.receivers[D];if(!N||!I.intersectsAabb(N.aabb))continue;N.aabb.min=I.closestPoint(N.aabb.min),N.aabb.max=I.closestPoint(N.aabb.max);const U=N.aabb.getCorners();for(let Z=0;Z<x.length;Z++){let J=!0;for(const ee of U){const ae=[ee[0]*h,ee[1]*h,ee[2]];if(s.N.transformMat4(ae,ae,x[Z].matrix),ae[0]<-1||ae[0]>1||ae[1]<-1||ae[1]>1){J=!1;break}}if(N.lastCascade=Z,A=Math.max(A,Z),J)break}}return A+1}}class co{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new pu,this._depthMode=new Un(o.context.gl.LEQUAL,Un.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1,o.tp.registerParameter(Is,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(Is,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,h){const x=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;const I=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||I<=0||(this._shadowLayerCount=x.style.order.reduce((we,xe)=>{const Ce=x.style._mergedLayers[xe];return we+(Ce.hasShadowPass()&&!Ce.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const A=x.context,D=Is.shadowMapResolution,N=Is.shadowMapResolution;if(this._cascades.length===0||Is.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let we=0;we<Is.cascadeCount;++we){const xe=x._shadowMapDebug,Ce=A.gl,ge=A.createFramebuffer(D,N,xe,"texture"),De=new s.T(A,{width:D,height:N,data:null},Ce.DEPTH_COMPONENT);if(ge.depthAttachment.set(De.texture),xe){const Xe=new s.T(A,{width:D,height:N,data:null},Ce.RGBA);ge.colorAttachment.set(Xe.texture)}this._cascades.push({framebuffer:ge,texture:De,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.bq,scale:0})}}this.shadowDirection=Hs(h);let U=0;if(o.elevation){const we=o.elevation,xe=[1e4,-1e4];we.visibleDemTiles.filter(Ce=>Ce.dem).forEach(Ce=>{const ge=Ce.dem.tree;xe[0]=Math.min(xe[0],ge.minimums[0]),xe[1]=Math.max(xe[1],ge.maximums[0])}),xe[0]!==1e4&&(U=(xe[1]-xe[0])*we.exaggeration())}const Z=1.5*o.cameraToCenterDistance,J=3*Z,ee=new Float64Array(16);for(let we=0;we<this._cascades.length;++we){const xe=this._cascades[we];let Ce=o.height/50,ge=1;Is.cascadeCount===1?ge=J:we===0?ge=Z:(Ce=Z,ge=J);const[De,Xe]=Sh(o,this.shadowDirection,Ce,ge,Is.shadowMapResolution,U);xe.scale=o.scale,xe.matrix=De,xe.boundingSphereRadius=Xe,s.a6.invert(ee,xe.matrix),xe.frustum=s.bq.fromInvProjectionMatrix(ee,1,0,!0),xe.far=ge}const ae=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ae].far,this._cascades[ae].far],this._uniformValues.u_shadow_intensity=I,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Is.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Is.shadowMapResolution,this._uniformValues.u_shadowmap_0=Aa.ShadowMap0,this._uniformValues.u_shadowmap_1=Aa.ShadowMap0+1,this._groundShadowTiles=x.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const he=x.transform.elevation;for(const we of this._groundShadowTiles){let xe={min:0,max:0};if(he){const Ce=he.getMinMaxForTile(we);Ce&&(xe=Ce)}this.addShadowReceiver(we.toUnwrapped(),xe.min,xe.max)}}get enabled(){return this._enabled}set enabled(o){this._enabled=o}drawShadowPass(o,h){if(!this._enabled)return;const x=this.painter,I=x.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(x.transform.getFrustum(0),x.transform.worldSize,this._cascades),I.viewport.set([0,0,Is.shadowMapResolution,Is.shadowMapResolution]);for(let A=0;A<this._numCascadesToRender;++A){x.currentShadowCascade=A,I.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),I.clear({color:s.ax.white,depth:1});for(const D of o.order){const N=o._mergedLayers[D];if(!N.hasShadowPass()||N.isHidden(x.transform.zoom))continue;const U=o.getLayerSourceCache(N),Z=U?h[U.id]:void 0;(N.type==="model"||Z&&Z.length)&&x.renderLayer(x,U,N,Z)}}x.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const o=this.painter,h=o.style,x=o.context,I=h.directionalLight,A=h.ambientLight;if(!I||!A)return;const D=[],N=Oo(o,o.longestCutoffRange);N.shouldRenderCutoff&&D.push("RENDER_CUTOFF");const U=fu(I,A),Z=new Un(x.gl.LEQUAL,Un.ReadOnly,o.depthRangeFor3D);for(const J of this._groundShadowTiles){const ee=J.toUnwrapped(),ae=o.isTileAffectedByFog(J),he=o.getOrCreateProgram("groundShadow",{defines:D,overrideFog:ae});this.setupShadows(ee,he),o.uploadCommonUniforms(x,he,ee,null,N);const we={u_matrix:o.transform.calculateProjMatrix(ee),u_ground_shadow_factor:U};he.draw(o,x.gl.TRIANGLES,Z,ui.disabled,Fi.multiply,Dn.disabled,we,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Fi.unblended:Fi.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const h=this.painter.transform,x=h.calculatePosMatrix(o,h.worldSize);return s.a6.multiply(x,this._cascades[this.painter.currentShadowCascade].matrix,x),Float32Array.from(x)}calculateShadowPassMatrixFromMatrix(o){return s.a6.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,h,x,I=0){if(!this._enabled)return;const A=this.painter.transform,D=this.painter.context,N=D.gl,U=this._uniformValues,Z=new Float64Array(16),J=A.calculatePosMatrix(o,A.worldSize);for(let ee=0;ee<this._cascades.length;ee++)s.a6.multiply(Z,this._cascades[ee].matrix,J),U[ee===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Z),D.activeTexture.set(N.TEXTURE0+Aa.ShadowMap0+ee),this._cascades[ee].texture.bind(N.NEAREST,N.CLAMP_TO_EDGE);if(this.useNormalOffset=!!x,this.useNormalOffset){const ee=s.bR(o.canonical),ae=2/A.tileSize*s.V/Is.shadowMapResolution,he=ae*this._cascades[0].boundingSphereRadius,we=ae*this._cascades[this._cascades.length-1].boundingSphereRadius,xe=(x==="vector-tile"?1:3)/Math.pow(2,I-o.canonical.z-(1-A.zoom+Math.floor(A.zoom)));U.u_shadow_normal_offset=[ee,he*xe,we*xe],U.u_shadow_bias=[6e-5,.0012,.012]}else U.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(D,U)}setupShadowsFromMatrix(o,h,x=!1){if(!this._enabled)return;const I=this.painter.context,A=I.gl,D=this._uniformValues,N=new Float64Array(16);for(let U=0;U<Is.cascadeCount;U++)s.a6.multiply(N,this._cascades[U].matrix,o),D[U===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),I.activeTexture.set(A.TEXTURE0+Aa.ShadowMap0+U),this._cascades[U].texture.bind(A.NEAREST,A.CLAMP_TO_EDGE);this.useNormalOffset=x,x?(D.u_shadow_normal_offset=[1,5,5],D.u_shadow_bias=[6e-5,.0012,.012]):D.u_shadow_bias=[36e-5,.0012,.012],h.setShadowUniformValues(I,D)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,h,x,I){if(I[2]>=0)return{};const A=function(U,Z,J){const ee=J/(1<<U.canonical.z);return new s.bS([U.canonical.x*ee+U.wrap*J,U.canonical.y*ee+U.wrap*J,0],[(U.canonical.x+1)*ee+U.wrap*J,(U.canonical.y+1)*ee+U.wrap*J,Z])}(o,h,x).getCorners(),D=h/-I[2];I[0]<0?(s.N.add(A[0],A[0],[I[0]*D,0,0]),s.N.add(A[3],A[3],[I[0]*D,0,0])):I[0]>0&&(s.N.add(A[1],A[1],[I[0]*D,0,0]),s.N.add(A[2],A[2],[I[0]*D,0,0])),I[1]<0?(s.N.add(A[0],A[0],[0,I[1]*D,0]),s.N.add(A[1],A[1],[0,I[1]*D,0])):I[1]>0&&(s.N.add(A[2],A[2],[0,I[1]*D,0]),s.N.add(A[3],A[3],[0,I[1]*D,0]));const N={};return N.vertices=A,N.planes=[ko(A[1],A[0],A[4]),ko(A[2],A[1],A[5]),ko(A[3],A[2],A[6]),ko(A[0],A[3],A[7])],N}addShadowReceiver(o,h,x){this._receivers.add(o,s.bS.fromTileIdAndHeight(o,h,x))}getMaxCascadeForTile(o){const h=this._receivers.get(o);return h&&h.lastCascade?h.lastCascade:0}}function ko(_,o,h){const x=s.N.sub([],h,o),I=s.N.sub([],_,o),A=s.N.cross([],x,I),D=s.N.length(A);return D===0?[0,0,1,0]:(s.N.scale(A,A,1/D),[A[0],A[1],A[2],-s.N.dot(A,o)])}function Hs(_){const o=_.properties.get("direction"),h=s.bQ(o.x,o.y,o.z);h[2]=s.aa(h[2],0,75);const x=s.bT([h[0],h[1],h[2]]);return s.N.fromValues(x.x,x.y,x.z)}function fu(_,o){const h=_.properties.get("color"),x=_.properties.get("intensity"),I=_.properties.get("direction"),A=[I.x,I.y,I.z],D=o.properties.get("color"),N=o.properties.get("intensity"),U=Math.max(s.N.dot([0,0,1],A),0),Z=[0,0,0];s.N.scale(Z,D.toArray01Linear().slice(0,3),N);const J=[0,0,0];return s.N.scale(J,h.toArray01Linear().slice(0,3),U*x),s.bU([Z[0]>0?Z[0]/(Z[0]+J[0]):0,Z[1]>0?Z[1]/(Z[1]+J[1]):0,Z[2]>0?Z[2]/(Z[2]+J[2]):0])}function Sh(_,o,h,x,I,A){const D=_.zoom,N=_.scale,U=_.worldSize,Z=1/U,J=_.aspect,ee=Math.sqrt(1+J*J)*Math.tan(.5*_.fovX),ae=ee*ee,he=x-h,we=x+h;let xe,Ce;ae>he/we?(xe=x,Ce=x*ee):(xe=.5*we*(1+ae),Ce=.5*Math.sqrt(he*he+2*(x*x+h*h)*ae+we*we*ae*ae));const ge=_.projection.pixelsPerMeter(_.center.lat,U),De=_._camera.getCameraToWorldMercator(),Xe=[0,0,-xe*Z];s.N.transformMat4(Xe,Xe,De);let Be=Ce*Z;const We=_._edgeInsets;if(!(We.left===0&&We.top===0&&We.right===0&&We.bottom===0||We.left===We.right&&We.top===We.bottom)){const Wr=_._camera.getWorldToCamera(_.worldSize,_.projection.zAxisUnit==="meters"?ge:1),Gr=_._camera.getCameraToClipPerspective(_._fov,_.width/_.height,h,x);Gr[8]=2*-_.centerOffset.x/_.width,Gr[9]=2*_.centerOffset.y/_.height;const tn=new Float64Array(16);s.a6.mul(tn,Gr,Wr);const _n=new Float64Array(16);s.a6.invert(_n,tn);const Fn=s.bq.fromInvProjectionMatrix(_n,U,D,!0);for(const wn of Fn.points){const Sn=((Pe=wn)[0]/=N,Pe[1]/=N,Pe[2]=s.bl(Pe[2],_._center.lat),Pe);Be=Math.max(Be,s.N.len(s.N.subtract([],Xe,Sn)))}}var Pe;Be*=I/(I-1);const Ke=Math.acos(o[2]),st=Math.atan2(-o[0],-o[1]),pt=new Fu;pt.position=Xe,pt.setPitchBearing(Ke,st);const Tt=pt.getWorldToCamera(U,ge),Zt=Be*U,xt=Math.min(_._mercatorZfromZoom(17)*U*-2,-2*Zt),hr=pt.getCameraToClipOrthographic(-Zt,Zt,-Zt,Zt,xt,(Zt+A*ge)/o[2]),tr=new Float64Array(16);s.a6.multiply(tr,hr,Tt);const Cr=s.N.fromValues(Math.floor(1e6*Xe[0])/1e6*U,Math.floor(1e6*Xe[1])/1e6*U,0),zt=.5*I,ir=[0,0,0];s.N.transformMat4(ir,Cr,tr),s.N.scale(ir,ir,zt);const vt=[Math.floor(ir[0]),Math.floor(ir[1]),Math.floor(ir[2])],Ut=[0,0,0];s.N.sub(Ut,ir,vt),s.N.scale(Ut,Ut,-1/zt);const Lr=new Float64Array(16);return s.a6.identity(Lr),s.a6.translate(Lr,Lr,Ut),s.a6.multiply(tr,Lr,tr),[tr,Zt]}const Kl=(_,o)=>Kr(_,o&&o.filter(h=>h.identifier!=="source.canvas")),Fm=s.ac(Ki,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),_d=s.ac(Ki,["setCenter","setZoom","setBearing","setPitch"]),Th={version:8,layers:[],sources:{}},yd={duration:300,delay:0},mu=new Set(["fill","line","background","hillshade","raster"]);class qo extends s.E{constructor(o,h={}){super(),this.map=o,this.scope=h.scope||"",this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=s.e({},yd),this._buildingIndex=new jm(this),this.crossTileSymbolIndex=new pd,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new _t,this.dispatcher=h.dispatcher?h.dispatcher:new s.bW(s.bX(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new Ar,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new s.bY(o._requestManager,h.localFontFamily?s.bZ.all:h.localIdeographFontFamily?s.bZ.ideographs:s.bZ.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new yt(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this.dispatcher.broadcast("setReferrer",s.b_());const x=this;this._rtlTextPluginCallback=qo.registerForPluginStateChange(I=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},(A,D)=>{if(s.b$(A),D&&D.every(N=>N))for(const N in x._sourceCaches){const U=x._sourceCaches[N],Z=U.getSource().type;Z!=="vector"&&Z!=="geojson"||U.reload()}})}),this.on("data",I=>{if(I.dataType!=="source"||I.sourceDataType!=="metadata")return;const A=this.getOwnSource(I.sourceId);if(A&&A.vectorLayerIds)for(const D in this._layers){const N=this._layers[D];N.source===A.id&&this._validateLayer(N)}})}loadURL(o,h={}){this.fire(new s.b("dataloading",{dataType:"style"}));const x=typeof h.validate=="boolean"?h.validate:!s.c0(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken),this.resolvedImports.add(o);const I=this.importsCache.get(o);if(I)return this._load(I,x);const A=this.map._requestManager.transformRequest(o,s.R.Style);this._request=s.g(A,(D,N)=>{if(this._request=null,D)this.fire(new s.a(D));else if(N)return this.importsCache.set(o,N),this._load(N,x)})}loadJSON(o,h={}){this.fire(new s.b("dataloading",{dataType:"style"})),this._request=s.f.frame(()=>{this._request=null,this._load(o,h.validate!==!1)})}loadEmpty(){this.fire(new s.b("dataloading",{dataType:"style"})),this._load(Th,!1)}_loadImports(o,h,x){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const I=[];for(const A of o){const D=this._createFragmentStyle(A),N=new Promise(J=>{D.once("style.import.load",J),D.once("error",J)}).then(()=>this.mergeAll());if(I.push(N),this.resolvedImports.has(A.url)){D.loadEmpty();continue}const U=A.data||this.importsCache.get(A.url);U?D.loadJSON(U,{validate:h}):A.url?D.loadURL(A.url,{validate:h}):D.loadEmpty();const Z={style:D,id:A.id,config:A.config};if(x){const J=this.fragments.findIndex(({id:ee})=>ee===x);this.fragments=this.fragments.slice(0,J).concat(Z).concat(this.fragments.slice(J))}else this.fragments.push(Z)}return Promise.allSettled(I)}_createFragmentStyle(o){const h=this.scope?s.ag(o.id,this.scope):o.id,x=new qo(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:o.config,configOptions:this.options,configDependentLayers:this._configDependentLayers});return x.setEventedParent(this.map,{style:x}),x}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const o=this.isRootStyle();this._shouldPrecompile=o,this.fire(new s.b(o?"style.load":"style.import.load"))}_load(o,h){const x=o.schema;if(this.isRootStyle()&&(o.fragment||x&&o.fragment!==!1)){const D=s.e({},Th,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(D,h)}if(this.setConfig(this._config,x),h&&Kl(this,_i(o)))return;this._loaded=!0,this.stylesheet=s.c1(o);for(const D in o.sources)this.addSource(D,o.sources[D],{validate:!1,isInitialLoad:!0});o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);const I=nd(this.stylesheet.layers);if(this._order=I.map(D=>D.id),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const D=this.stylesheet.lights[0];this.light=new cn(D.properties,D.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new cn(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const D of I){const N=s.c2(D,this.scope,this.options);N.isConfigDependent&&this._configDependentLayers.add(N.fqid),N.setEventedParent(this,{layer:{id:N.id}}),this._layers[N.id]=N,this._serializedLayers[N.id]=N.serialize();const U=this.getOwnLayerSourceCache(N),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();U&&N.canCastShadows()&&Z&&(U.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const A=this.stylesheet.terrain;A&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.f.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(A,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.b("data",{dataType:"style"})),o.imports?this._loadImports(o.imports,h).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,h,x,I,A,D,N,U;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Z=>{if(Z.stylesheet){if(Z.light!=null&&(o=Z.light),Z.stylesheet.lights)for(const J of Z.stylesheet.lights)J.type==="ambient"&&Z.ambientLight!=null&&(h=Z.ambientLight),J.type==="directional"&&Z.directionalLight!=null&&(x=Z.directionalLight);I=this._prioritizeTerrain(I,Z.terrain,Z.stylesheet.terrain),Z.stylesheet.fog&&Z.fog!=null&&(A=Z.fog),Z.stylesheet.camera!=null&&(U=Z.stylesheet.camera),Z.stylesheet.projection!=null&&(D=Z.stylesheet.projection),Z.stylesheet.transition!=null&&(N=Z.stylesheet.transition)}}),this.light=o,this.ambientLight=h,this.directionalLight=x,this.fog=A,I===null?delete this.terrain:this.terrain=I,this.camera=U||{"camera-projection":"perspective"},this.projection=D||{name:"mercator"},this.transition=s.e({},yd,N),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const h=x=>{for(const I of x.fragments)h(I.style);o(x)};h(this)}_prioritizeTerrain(o,h,x){const I=o&&o.drapeRenderMode===0;return x===null?h&&h.drapeRenderMode===0?h:I?o:null:h!=null&&(!o||I||h&&h.drapeRenderMode===1)?h:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{o=this._prioritizeTerrain(o,h.terrain,h.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(o=h.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},h={},x={};this.forEachFragmentStyle(I=>{for(const A in I._sourceCaches){const D=s.ag(A,I.scope);o[D]=I._sourceCaches[A]}for(const A in I._otherSourceCaches){const D=s.ag(A,I.scope);h[D]=I._otherSourceCaches[A]}for(const A in I._symbolSourceCaches){const D=s.ag(A,I.scope);x[D]=I._symbolSourceCaches[A]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=x}mergeLayers(){const o={},h=[],x={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(A=>{for(const D of A._order){const N=A._layers[D];if(N.type==="slot"){const U=s.c3(D);if(o[U])continue;o[U]=[]}N.slot&&o[N.slot]?o[N.slot].push(N):h.push(N)}}),this._mergedOrder=[];const I=(A=[])=>{for(const D of A)if(D.type==="slot"){const N=s.c3(D.id);o[N]&&I(o[N])}else{const N=s.ag(D.id,D.scope);this._mergedOrder.push(N),x[N]=D,D.is3D()&&(this._has3DLayers=!0),D.type==="circle"&&(this._hasCircleLayers=!0),D.type==="symbol"&&(this._hasSymbolLayers=!0)}};I(h),this._mergedLayers=x,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=s.e({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(h,x,I){let A,D,N;const U=s.f.devicePixelRatio>1?"@2x":"";let Z=s.g(x.transformRequest(x.normalizeSpriteURL(h,U,".json"),s.R.SpriteJSON),(ae,he)=>{Z=null,N||(N=ae,A=he,ee())}),J=s.d(x.transformRequest(x.normalizeSpriteURL(h,U,".png"),s.R.SpriteImage),(ae,he)=>{J=null,N||(N=ae,D=he,ee())});function ee(){if(N)I(N);else if(A&&D){const ae=s.f.getImageData(D),he={};for(const we in A){const{width:xe,height:Ce,x:ge,y:De,sdf:Xe,pixelRatio:Be,stretchX:We,stretchY:Pe,content:Ke}=A[we],st=new s.h({width:xe,height:Ce});s.h.copy(ae,st,{x:ge,y:De},{x:0,y:0},{width:xe,height:Ce}),he[we]={data:st,pixelRatio:Be,sdf:Xe,stretchX:We,stretchY:Pe,content:Ke}}I(null,he)}}return{cancel(){Z&&(Z.cancel(),Z=null),J&&(J.cancel(),J=null)}}}(o,this.map._requestManager,(h,x)=>{if(this._spriteRequest=null,h)this.fire(new s.a(h));else if(x)for(const I in x)this.imageManager.addImage(I,this.scope,x[I]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.b("data",{dataType:"style"}))})}_validateLayer(o){const h=this.getOwnSource(o.source);if(!h)return;const x=o.sourceLayer;x&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(x)===-1)&&this.fire(new s.a(new Error(`Source layer "${x}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,h)=>{const x=this.fragments[h];return x&&x.style&&(o.data=x.style.serialize()),o})}_serializeSources(){const o={};for(const h in this._sourceCaches){const x=this._sourceCaches[h].getSource();o[x.id]||(o[x.id]=x.serialize())}return o}_serializeLayers(o){const h=[];for(const x of o){const I=this._layers[x];I&&I.type!=="custom"&&h.push(I.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped(this.getLayerSourceCache(o)):mu.has(o.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const h=this.getOwnLayer(o);if(h)return h;this.fire(new s.a(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const h=this.getOwnSource(o);if(h)return h;this.fire(new s.a(new Error(`The source '${o}' does not exist in the map's style.`)))}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const h=this.calculateLightsBrightness();o.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));const x=this._changes.isDirty();if(this._changes.isDirty()){const A=this._changes.getLayerUpdatesByScope();for(const D in A){const{updatedIds:N,removedIds:U}=A[D];(N||U)&&this._updateWorkerLayers(D,N,U)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._changes.reset()}const I={};for(const A in this._mergedSourceCaches){const D=this._mergedSourceCaches[A];I[A]=D.used,D.used=!1,D.tileCoverLift=0}for(const A of this._mergedOrder){const D=this._mergedLayers[A];if(D.recalculate(o,this._availableImages),!D.isHidden(o.zoom)){const N=this.getLayerSourceCache(D);N&&(N.used=!0,N.tileCoverLift=Math.max(N.tileCoverLift,D.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let N=D.minzoom||0;N<(D.maxzoom||25.5);N++){const U=this.map.painter;if(U){const Z=D.getProgramIds();if(!Z)continue;for(const J of Z){const ee=D.getDefaultProgramParams(J,o.zoom);ee&&(U.style=this,this.fog&&(U._fogVisible=!0,ee.overrideFog=!0,U.getOrCreateProgram(J,ee)),U._fogVisible=!1,ee.overrideFog=!1,U.getOrCreateProgram(J,ee),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(ee.overrideRtt=!0,U.getOrCreateProgram(J,ee)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const A in I){const D=this._mergedSourceCaches[A];I[A]!==D.used&&D.getSource().fire(new s.b("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),x&&this.fire(new s.b("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=this._changes.getUpdatedImages();if(o.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,h,x){const I=this.getFragmentStyle(o);I&&this.dispatcher.broadcast("updateLayers",{layers:h?I._serializeLayers(h):[],scope:o,removedIds:x||[],options:I.options})}setState(o){if(this._checkLoaded(),Kl(this,_i(o)))return!1;(o=s.c1(o)).layers=nd(o.layers);const h=function(I,A){if(!I)return[{command:Ki.setStyle,args:[A]}];let D=[];try{if(!L(I.version,A.version))return[{command:Ki.setStyle,args:[A]}];L(I.center,A.center)||D.push({command:Ki.setCenter,args:[A.center]}),L(I.zoom,A.zoom)||D.push({command:Ki.setZoom,args:[A.zoom]}),L(I.bearing,A.bearing)||D.push({command:Ki.setBearing,args:[A.bearing]}),L(I.pitch,A.pitch)||D.push({command:Ki.setPitch,args:[A.pitch]}),L(I.sprite,A.sprite)||D.push({command:Ki.setSprite,args:[A.sprite]}),L(I.glyphs,A.glyphs)||D.push({command:Ki.setGlyphs,args:[A.glyphs]}),L(I.imports,A.imports)||function(ee=[],ae=[],he){ae=ae||[];const we=(ee=ee||[]).map(vl),xe=ae.map(vl),Ce=ee.reduce(pc,{}),ge=ae.reduce(pc,{}),De=we.slice();let Xe,Be,We,Pe;for(Xe=0,Be=0;Xe<we.length;Xe++)We=we[Xe],ge.hasOwnProperty(We)?Be++:(he.push({command:Ki.removeImport,args:[We]}),De.splice(De.indexOf(We,Be),1));for(Xe=0,Be=0;Xe<xe.length;Xe++)We=xe[xe.length-1-Xe],De[De.length-1-Xe]!==We&&(Ce.hasOwnProperty(We)?(he.push({command:Ki.removeImport,args:[We]}),De.splice(De.lastIndexOf(We,De.length-Be),1)):Be++,Pe=De[De.length-Xe],he.push({command:Ki.addImport,args:[ge[We],Pe]}),De.splice(De.length-Xe,0,We));for(const Ke of ae){const st=Ce[Ke.id];st&&!L(st,Ke)&&he.push({command:Ki.updateImport,args:[Ke.id,Ke]})}}(I.imports,A.imports,D),L(I.transition,A.transition)||D.push({command:Ki.setTransition,args:[A.transition]}),L(I.light,A.light)||D.push({command:Ki.setLight,args:[A.light]}),L(I.fog,A.fog)||D.push({command:Ki.setFog,args:[A.fog]}),L(I.projection,A.projection)||D.push({command:Ki.setProjection,args:[A.projection]}),L(I.lights,A.lights)||D.push({command:Ki.setLights,args:[A.lights]}),L(I.camera,A.camera)||D.push({command:Ki.setCamera,args:[A.camera]});const N={},U=[];(function(ee,ae,he,we){let xe;for(xe in ae=ae||{},ee=ee||{})ee.hasOwnProperty(xe)&&(ae.hasOwnProperty(xe)||rp(xe,he,we));for(xe in ae){if(!ae.hasOwnProperty(xe))continue;const Ce=ae[xe];ee.hasOwnProperty(xe)?L(ee[xe],Ce)||(ee[xe].type==="geojson"&&Ce.type==="geojson"&&Lu(ee,ae,xe)?he.push({command:Ki.setGeoJSONSourceData,args:[xe,Ce.data]}):Ou(xe,ae,he,we)):Ga(xe,ae,he)}})(I.sources,A.sources,U,N);const Z=[];I.layers&&I.layers.forEach(ee=>{ee.source&&N[ee.source]?D.push({command:Ki.removeLayer,args:[ee.id]}):Z.push(ee)});let J=I.terrain;J&&N[J.source]&&(D.push({command:Ki.setTerrain,args:[void 0]}),J=void 0),D=D.concat(U),L(J,A.terrain)||D.push({command:Ki.setTerrain,args:[A.terrain]}),function(ee,ae,he){ae=ae||[];const we=(ee=ee||[]).map(vl),xe=ae.map(vl),Ce=ee.reduce(pc,{}),ge=ae.reduce(pc,{}),De=we.slice(),Xe=Object.create(null);let Be,We,Pe,Ke,st,pt,Tt;for(Be=0,We=0;Be<we.length;Be++)Pe=we[Be],ge.hasOwnProperty(Pe)?We++:(he.push({command:Ki.removeLayer,args:[Pe]}),De.splice(De.indexOf(Pe,We),1));for(Be=0,We=0;Be<xe.length;Be++)Pe=xe[xe.length-1-Be],De[De.length-1-Be]!==Pe&&(Ce.hasOwnProperty(Pe)?(he.push({command:Ki.removeLayer,args:[Pe]}),De.splice(De.lastIndexOf(Pe,De.length-We),1)):We++,pt=De[De.length-Be],he.push({command:Ki.addLayer,args:[ge[Pe],pt]}),De.splice(De.length-Be,0,Pe),Xe[Pe]=!0);for(Be=0;Be<xe.length;Be++)if(Pe=xe[Be],Ke=Ce[Pe],st=ge[Pe],!Xe[Pe]&&!L(Ke,st))if(L(Ke.source,st.source)&&L(Ke["source-layer"],st["source-layer"])&&L(Ke.type,st.type)){for(Tt in yl(Ke.layout,st.layout,he,Pe,null,Ki.setLayoutProperty),yl(Ke.paint,st.paint,he,Pe,null,Ki.setPaintProperty),L(Ke.slot,st.slot)||he.push({command:Ki.setSlot,args:[Pe,st.slot]}),L(Ke.filter,st.filter)||he.push({command:Ki.setFilter,args:[Pe,st.filter]}),L(Ke.minzoom,st.minzoom)&&L(Ke.maxzoom,st.maxzoom)||he.push({command:Ki.setLayerZoomRange,args:[Pe,st.minzoom,st.maxzoom]}),Ke)Ke.hasOwnProperty(Tt)&&Tt!=="layout"&&Tt!=="paint"&&Tt!=="filter"&&Tt!=="metadata"&&Tt!=="minzoom"&&Tt!=="maxzoom"&&Tt!=="slot"&&(Tt.indexOf("paint.")===0?yl(Ke[Tt],st[Tt],he,Pe,Tt.slice(6),Ki.setPaintProperty):L(Ke[Tt],st[Tt])||he.push({command:Ki.setLayerProperty,args:[Pe,Tt,st[Tt]]}));for(Tt in st)st.hasOwnProperty(Tt)&&!Ke.hasOwnProperty(Tt)&&Tt!=="layout"&&Tt!=="paint"&&Tt!=="filter"&&Tt!=="metadata"&&Tt!=="minzoom"&&Tt!=="maxzoom"&&Tt!=="slot"&&(Tt.indexOf("paint.")===0?yl(Ke[Tt],st[Tt],he,Pe,Tt.slice(6),Ki.setPaintProperty):L(Ke[Tt],st[Tt])||he.push({command:Ki.setLayerProperty,args:[Pe,Tt,st[Tt]]}))}else he.push({command:Ki.removeLayer,args:[Pe]}),pt=De[De.lastIndexOf(Pe)+1],he.push({command:Ki.addLayer,args:[st,pt]})}(Z,A.layers,D)}catch(N){console.warn("Unable to compute style diff:",N),D=[{command:Ki.setStyle,args:[A]}]}return D}(this.serialize(),o).filter(I=>!(I.command in _d));if(h.length===0)return!1;const x=h.filter(I=>!(I.command in Fm));if(x.length>0)throw new Error(`Unimplemented: ${x.map(I=>I.command).join(", ")}.`);return h.forEach(I=>{this[I.command].apply(this,I.args)}),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,h){return this.getImage(o)?this.fire(new s.a(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,h),this._afterImageUpdated(o),this)}updateImage(o,h){this.imageManager.updateImage(o,this.scope,h)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new s.a(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new s.b("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,h,x={}){return this._checkLoaded(),this._validate(en,`models.${o}`,h,null,x)||(this.modelManager.addModel(o,h,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new s.a(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,h,x={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(zi,`sources.${o}`,h,null,x))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const I=lo(o,h,this.dispatcher,this);I.scope=this.scope,I.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(I.id),source:I.serialize(),sourceId:I.id}));const A=D=>{const N=(D?"symbol:":"other:")+I.id,U=s.ag(N,this.scope),Z=this._sourceCaches[N]=new Dl(U,I,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[I.id]=Z,Z.onAdd(this.map)};A(!1),h.type!=="vector"&&h.type!=="geojson"||A(!0),I.onAdd&&I.onAdd(this.map),x.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const h=this.getOwnSource(o);if(!h)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===o)return this.fire(new s.a(new Error(`Source "${o}" cannot be removed while layer "${I}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new s.a(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const x=this.getOwnSourceCaches(o);for(const I of x){const A=s.c3(I.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(I.id),I.fire(new s.b("data",{sourceDataType:"metadata",dataType:"source",sourceId:I.getSource().id})),I.setEventedParent(null),I.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getOwnSource(o).setData(h),this._changes.setDirty()}getOwnSource(o){const h=this.getOwnSourceCache(o);return h&&h.getSource()}getOwnSources(){const o=[];for(const h in this._otherSourceCaches){const x=this.getOwnSourceCache(h);x&&o.push(x.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const h in o){const x=o[h]._tiles;for(const I in x){const A=x[I];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const h=this._getTransitionParameters();for(const I of o){if(this._validate(rr,"lights",I))return;switch(I.type){case"ambient":if(this.ambientLight){const A=this.ambientLight;A.set(I),A.updateTransitions(h)}else this.ambientLight=new Fe(I,et,this.scope,this.options);break;case"directional":if(this.directionalLight){const A=this.directionalLight;A.set(I),A.updateTransitions(h)}else this.directionalLight=new Fe(I,it,this.scope,this.options)}}const x=new s.K(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,h=this.ambientLight;if(!o||!h)return;const x=ee=>.2126*(ee[0]<=.03928?ee[0]/12.92:Math.pow((ee[0]+.055)/1.055,2.4))+.7152*(ee[1]<=.03928?ee[1]/12.92:Math.pow((ee[1]+.055)/1.055,2.4))+.0722*(ee[2]<=.03928?ee[2]/12.92:Math.pow((ee[2]+.055)/1.055,2.4)),I=o.properties.get("color").toArray01(),A=o.properties.get("intensity"),D=o.properties.get("direction"),N=1-s.bQ(D.x,D.y,D.z)[2]/90,U=x(I)*A*N,Z=h.properties.get("color").toArray01(),J=h.properties.get("intensity");return(U+x(Z)*J)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(s.c4(o)){const h=s.c5(o),x=this.fragments.find(({id:A})=>A===h);if(!x)throw new Error(`Style import not found: ${o}`);const I=s.c3(o);return x.style.getFragmentStyle(I)}{const h=this.fragments.find(({id:x})=>x===o);if(!h)throw new Error(`Style import not found: ${o}`);return h.style}}getConfigProperty(o,h){const x=this.getFragmentStyle(o);if(!x)return null;const I=s.ag(h,x.scope),A=x.options.get(I),D=A?A.value||A.default:null;return D?D.serialize():null}setConfigProperty(o,h,x){const I=s.r(x);if(I.result!=="success")return void Kl(this,I.value);const A=I.value.expression,D=this.getFragmentStyle(o);if(!D)return;const N=s.ag(h,D.scope),U=D.options.get(N);U&&(this.options.set(N,{...U,value:A}),this.updateConfigDependencies())}setConfig(o,h){if(this._config=o,o||h)if(h)for(const x in h){let I,A;const D=s.r(h[x].default);if(D.result==="success"&&(I=D.value.expression),o&&o[x]!==void 0){const ae=s.r(o[x]);ae.result==="success"&&(A=ae.value.expression)}const{minValue:N,maxValue:U,stepValue:Z,type:J,values:ee}=h[x];if(I){const ae=s.ag(x,this.scope);this.options.set(ae,{default:I,value:A,minValue:N,maxValue:U,stepValue:Z,type:J,values:ee})}else this.fire(new s.a(new Error(`No schema defined for config option "${x}".`)))}else this.fire(new s.a(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const o of this._configDependentLayers){const h=this.getLayer(o);h&&(h.possiblyEvaluateVisibility(),this._updateLayer(h))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this._changes.setDirty()}addLayer(o,h,x={}){this._checkLoaded();const I=o.id;if(this._layers[I])return void this.fire(new s.a(new Error(`Layer with id "${I}" already exists on this map`)));let A;if(o.type==="custom"){if(Kl(this,s.c6(o)))return;A=s.c2(o,this.scope,this.options)}else{if(typeof o.source=="object"&&(this.addSource(I,o.source),o=s.c1(o),o=s.e(o,{source:I})),this._validate(at,`layers.${I}`,o,{arrayIndex:-1},x))return;A=s.c2(o,this.scope,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:I}}),this._serializedLayers[A.id]=A.serialize()}A.isConfigDependent&&this._configDependentLayers.add(A.fqid);let D=this._order.length;if(h){const J=this._order.indexOf(h);if(J===-1)return void this.fire(new s.a(new Error(`Layer with id "${h}" does not exist on this map.`)));A.slot===this._layers[h].slot?D=J:s.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(D,0,I),this._layerOrderChanged=!0,this._layers[I]=A;const N=this.getOwnLayerSourceCache(A),U=!!this.directionalLight&&this.directionalLight.shadowsEnabled();N&&A.canCastShadows()&&U&&(N.castsShadows=!0);const Z=this._changes.getRemovedLayer(A);if(Z&&A.source&&N&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const J=s.ag(A.source,A.scope);Z.type!==A.type?this._changes.updateSourceCache(J,"clear"):(this._changes.updateSourceCache(J,"reload"),N.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(o,h){this._checkLoaded();const x=this._checkLayer(o);if(!x||o===h)return;const I=this._order.indexOf(o);this._order.splice(I,1);let A=this._order.length;if(h){const D=this._order.indexOf(h);if(D===-1)return void this.fire(new s.a(new Error(`Layer with id "${h}" does not exist on this map.`)));x.slot===this._layers[h].slot?A=D:s.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const h=this._checkLayer(o);if(!h)return;h.setEventedParent(null);const x=this._order.indexOf(o);this._order.splice(x,1),delete this._layers[o],delete this._serializedLayers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);const I=this.getOwnLayerSourceCache(h);if(I&&I.castsShadows){let A=!1;for(const D in this._layers)if(this._layers[D].source===h.source&&this._layers[D].canCastShadows()){A=!0;break}I.castsShadows=A}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,x){this._checkLoaded();const I=this._checkLayer(o);I&&(I.minzoom===h&&I.maxzoom===x||(h!=null&&(I.minzoom=h),x!=null&&(I.maxzoom=x),this._updateLayer(I)))}setSlot(o,h){this._checkLoaded();const x=this._checkLayer(o);x&&x.slot!==h&&(x.slot=h,this._updateLayer(x))}setFilter(o,h,x={}){this._checkLoaded();const I=this._checkLayer(o);if(I&&!L(I.filter,h))return h==null?(I.filter=void 0,void this._updateLayer(I)):void(this._validate($t,`layers.${I.id}.filter`,h,{layerType:I.type},x)||(I.filter=s.c1(h),this._updateLayer(I)))}getFilter(o){const h=this._checkLayer(o);if(h)return s.c1(h.filter)}setLayoutProperty(o,h,x,I={}){this._checkLoaded();const A=this._checkLayer(o);if(A&&!L(A.getLayoutProperty(h),x)){if(x!=null&&(!I||I.validate!==!1)&&Kl(A,br.call(_i,{key:`layers.${o}.layout.${h}`,layerType:A.type,objectKey:h,value:x,styleSpec:s.D,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(h,x),A.isConfigDependent&&this._configDependentLayers.add(A.fqid),this._updateLayer(A)}}getLayoutProperty(o,h){const x=this._checkLayer(o);if(x)return x.getLayoutProperty(h)}setPaintProperty(o,h,x,I={}){this._checkLoaded();const A=this._checkLayer(o);if(!A||L(A.getPaintProperty(h),x)||x!=null&&(!I||I.validate!==!1)&&Kl(A,cr.call(_i,{key:`layers.${o}.paint.${h}`,layerType:A.type,objectKey:h,value:x,styleSpec:s.D})))return;const D=A.setPaintProperty(h,x);A.isConfigDependent&&this._configDependentLayers.add(A.fqid),D&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(o,h){const x=this._checkLayer(o);if(x)return x.getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const x=o.source,I=o.sourceLayer,A=this._checkSource(x);if(!A)return;const D=A.type;if(D==="geojson"&&I)return void this.fire(new s.a(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(D==="vector"&&!I)return void this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new s.a(new Error("The feature id parameter must be provided.")));const N=this.getOwnSourceCaches(x);for(const U of N)U.setFeatureState(I,o.id,h)}removeFeatureState(o,h){this._checkLoaded();const x=o.source,I=this._checkSource(x);if(!I)return;const A=I.type,D=A==="vector"?o.sourceLayer:void 0;if(A==="vector"&&!D)return void this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new s.a(new Error("A feature id is required to remove its specific state property.")));const N=this.getOwnSourceCaches(x);for(const U of N)U.removeFeatureState(D,o.id,h)}getFeatureState(o){this._checkLoaded();const h=o.source,x=o.sourceLayer,I=this._checkSource(h);if(I){if(I.type!=="vector"||x)return o.id===void 0&&this.fire(new s.a(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(x,o.id);this.fire(new s.a(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=s.e({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return s.e({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),h=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return s.c7({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},x=>x!==void 0)}_updateLayer(o){this._changes.updateLayer(o);const h=this.getLayerSourceCache(o),x=s.ag(o.source,o.scope),I=this._changes.getUpdatedSourceCaches();o.source&&!I[x]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(x,"reload"),h.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const h=N=>this._mergedLayers[N].type==="fill-extrusion"||this._mergedLayers[N].type==="model",x=this.order,I={},A=[];for(let N=x.length-1;N>=0;N--){const U=x[N];if(h(U)){I[U]=N;for(const Z of o){const J=Z[U];if(J)for(const ee of J)A.push(ee)}}}A.sort((N,U)=>U.intersectionZ-N.intersectionZ);const D=[];for(let N=x.length-1;N>=0;N--){const U=x[N];if(h(U))for(let Z=A.length-1;Z>=0;Z--){const J=A[Z].feature;if(I[J.layer.id]<N)break;D.push(J),A.pop()}else for(const Z of o){const J=Z[U];if(J)for(const ee of J)D.push(ee.feature)}}return D}queryRenderedFeatures(o,h,x){h&&h.filter&&this._validate($t,"queryRenderedFeatures.filter",h.filter,null,h),h.scope=this.scope,h.availableImages=this._availableImages,h.serializedLayers=this._serializedLayers;const I={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new s.a(new Error("parameters.layers must be an Array."))),[];for(const Z of h.layers){const J=this._mergedLayers[Z];if(!J)return this.fire(new s.a(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];I[J.source]=!0}}const A=[],D=h.serializedLayers||{},N=h&&h.layers?h.layers.some(Z=>{const J=this.getLayer(Z);return J&&J.is3D()}):this.has3DLayers(),U=wt.createFromScreenPoints(o,x);for(const Z in this._mergedSourceCaches){const J=this._mergedSourceCaches[Z].getSource();if(!J||J.scope!==h.scope)continue;const ee=this._mergedSourceCaches[Z].getSource().id;h.layers&&!I[ee]||A.push(Up(this._mergedSourceCaches[Z],this._mergedLayers,D,U,h,x,N,!!this.map._showQueryGeometry))}return this.placement&&A.push(function(Z,J,ee,ae,he,we,xe){const Ce={},ge=we.queryRenderedSymbols(ae),De=[];for(const Xe of Object.keys(ge).map(Number))De.push(xe[Xe]);De.sort(ed);for(const Xe of De){const Be=Xe.featureIndex.lookupSymbolFeatures(ge[Xe.bucketInstanceId],J,Xe.bucketIndex,Xe.sourceLayerIndex,he.filter,he.layers,he.availableImages,Z);for(const We in Be){const Pe=Ce[We]=Ce[We]||[],Ke=Be[We];Ke.sort((st,pt)=>{const Tt=Xe.featureSortOrder;if(Tt){const Zt=Tt.indexOf(st.featureIndex);return Tt.indexOf(pt.featureIndex)-Zt}return pt.featureIndex-st.featureIndex});for(const st of Ke)Pe.push(st)}}for(const Xe in Ce)Ce[Xe].forEach(Be=>{const We=Be.feature,Pe=ee(Z[Xe]);if(!Pe)return;const Ke=Pe.getFeatureState(We.layer["source-layer"],We.id);We.source=We.layer.source,We.layer["source-layer"]&&(We.sourceLayer=We.layer["source-layer"]),We.state=Ke});return Ce}(this._mergedLayers,D,this.getLayerSourceCache.bind(this),U.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(o,h){h&&h.filter&&this._validate($t,"querySourceFeatures.filter",h.filter,null,h);const x=this.getOwnSourceCaches(o);let I=[];for(const A of x)I=I.concat(nu(A,h));return I}addSourceType(o,h,x){return qo.getSourceType(o)?x(new Error(`A source type called "${o}" already exists.`)):(qo.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},x):x(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,h,x={}){this._checkLoaded();const I=this.light.getLight();let A=!1;for(const N in o)if(!L(o[N],I[N])){A=!0;break}if(!A)return;const D=this._getTransitionParameters();this.light.setLight(o,h,x),this.light.updateTransitions(D)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,h=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()&&h!==0||delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=o;const I=o.source==null;if(h===1){if(typeof x.source=="object"){const N="terrain-dem-src";this.addSource(N,x.source),x=s.c1(x),x=s.e(x,{source:N})}const A=s.e({},x),D={};if(this.terrain&&I){A.source=this.terrain.get().source;const N=this.terrain?this.getFragmentStyle(this.terrain.scope):null;N&&(D.style=N.serialize())}if(this._validate(Me,"terrain",A,D))return}if(!this.terrain||this.terrain.scope!==this.scope&&!I||this.terrain&&h!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,h),this.fire(new s.b("data",{dataType:"style"}))}else{const A=this.terrain,D=A.get();for(const N of Object.keys(s.D.terrain))!x.hasOwnProperty(N)&&s.D.terrain[N].default&&(x[N]=s.D.terrain[N].default);for(const N in o)if(!L(o[N],D[N])){A.set(o,this.options),this.stylesheet.terrain=o;const U=this._getTransitionParameters({duration:0});A.updateTransitions(U),this.fire(new s.b("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const h=this.fog=new Re(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();const x=this._getTransitionParameters({duration:0});h.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog;if(!L(h.get(),o)){h.set(o,this.options),this.stylesheet.fog=h.get();const x=this._getTransitionParameters({duration:0});h.updateTransitions(x)}}else this._createFog(o);this._markersNeedUpdate=!0}_getTransitionParameters(o){return{now:s.f.now(),transition:s.e(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],h=[];for(const x in this._mergedLayers)this.isLayerDraped(this._mergedLayers[x])?o.push(x):h.push(x);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){const x=this.terrain=new Mr(o,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const I=this._getTransitionParameters({duration:0});x.updateTransitions(I)}_force3DLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,x,I,A={}){if(A&&A.validate===!1)return!1;const D=s.e({},this.serialize());return Kl(this,o.call(_i,s.e({key:h,style:D,value:x,styleSpec:s.D},I)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.c8.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){const h=this.getSourceCaches(o);for(const x of h)x.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const h=this.getSourceCaches(o);for(const x of h)x.resume(),x.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}updateSources(o){let h;this.directionalLight&&(h=Hs(this.directionalLight));for(const x in this._mergedSourceCaches)this._mergedSourceCaches[x].update(o,void 0,void 0,h)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,x,I,A=!1){let D=!1,N=!1;const U={},Z={};for(const J of this._mergedOrder){const ee=this._mergedLayers[J];if(ee.type!=="symbol")continue;const ae=s.ag(ee.source,ee.scope);let he=U[ae];if(!he){const xe=this.getLayerSourceCache(ee);if(!xe)continue;const Ce=xe.getRenderableIds(!0).map(ge=>xe.getTileByID(ge));Z[ae]=Ce.slice(),he=U[ae]=Ce.sort((ge,De)=>De.tileID.overscaledZ-ge.tileID.overscaledZ||(ge.tileID.isLessThan(De.tileID)?-1:1))}const we=this.crossTileSymbolIndex.addLayer(ee,he,o.center.lng,o.projection);D=D||we}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),A=A||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new s.b("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.f.now(),o.zoom))&&(this.pauseablePlacement=new Bu(o,this._mergedOrder,A,h,x,I,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,U,Z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.f.now()),N=!0),D&&this.pauseablePlacement.placement.setStale()),N||D){this._buildingIndex.onNewFrame(o.zoom);for(const J of this._mergedOrder){const ee=this._mergedLayers[J];ee.type==="symbol"&&this.placement.updateLayerOpacities(ee,U[s.ag(ee.source,ee.scope)])}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.f.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,h){this._checkLoaded();const x=this.stylesheet.imports=this.stylesheet.imports||[];if(x.findIndex(({id:A})=>A===o.id)!==-1)return this.fire(new s.a(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!h)return x.push(o),this._loadImports([o],!0),this;const I=x.findIndex(({id:A})=>A===h);return I===-1?this.fire(new s.a(new Error(`Import with id "${h}" does not exist on this map.`))):(this.stylesheet.imports=x.slice(0,I).concat(o).concat(x.slice(I)),this._loadImports([o],!0,h),this)}updateImport(o,h){this._checkLoaded();const x=this.stylesheet.imports||[],I=this.getImportIndex(o);return I===-1?this:typeof h=="string"?(this.setImportUrl(o,h),this):(h.url&&h.url!==x[I].url&&this.setImportUrl(o,h.url),L(h.config,x[I].config)||this.setImportConfig(o,h.config),L(h.data,x[I].data)||this.setImportData(o,h.data),this)}moveImport(o,h){this._checkLoaded();let x=this.stylesheet.imports||[];const I=this.getImportIndex(o);if(I===-1)return this;const A=this.getImportIndex(h);if(A===-1)return this;const D=x[I],N=this.fragments[I];return x=x.filter(({id:U})=>U!==o),this.fragments=this.fragments.filter(({id:U})=>U!==o),this.stylesheet.imports=x.slice(0,A).concat(D).concat(x.slice(A)),this.fragments=this.fragments.slice(0,A).concat(N).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(o,h){this._checkLoaded();const x=this.stylesheet.imports||[],I=this.getImportIndex(o);if(I===-1)return this;x[I].url=h;const A=this.fragments[I];return A.style=this._createFragmentStyle(x[I]),A.style.on("style.import.load",()=>this.mergeAll()),A.style.loadURL(h),this}setImportData(o,h){this._checkLoaded();const x=this.getImportIndex(o),I=this.stylesheet.imports||[];return x===-1?this:h?(this.fragments[x].style.setState(h),this._reloadImports(),this):(delete I[x].data,this.setImportUrl(o,I[x].url))}setImportConfig(o,h){this._checkLoaded();const x=this.getImportIndex(o),I=this.stylesheet.imports||[];if(x===-1)return this;h?I[x].config=h:delete I[x].config;const A=this.fragments[x],D=A.style.stylesheet&&A.style.stylesheet.schema;return A.config=h,A.style.setConfig(h,D),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const h=this.stylesheet.imports||[],x=this.getImportIndex(o);return x===-1||(h.splice(x,1),this.fragments[x].style._remove(),this.fragments.splice(x,1),this._reloadImports()),this}getImportIndex(o){const h=(this.stylesheet.imports||[]).findIndex(x=>x.id===o);return h===-1&&this.fire(new s.a(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),h}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const h in this._mergedOtherSourceCaches){const x=this._mergedOtherSourceCaches[h];x&&o.push(x.getSource())}return o}getSource(o,h){const x=this.getSourceCache(o,h);return x&&x.getSource()}getLayerSource(o){const h=this.getLayerSourceCache(o);return h&&h.getSource()}getSourceCache(o,h){const x=s.ag(o,h);return this._mergedOtherSourceCaches[x]}getLayerSourceCache(o){const h=s.ag(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(o){const h=[];return this._mergedOtherSourceCaches[o]&&h.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&h.push(this._mergedSymbolSourceCaches[o]),h}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const h in o){const x=o[h];x==="reload"?this.reloadSource(h):x==="clear"&&this.clearSource(h)}}updateLayers(o){const h=this._changes.getUpdatedPaintProperties();for(const x of h){const I=this.getLayer(x);I&&I.updateTransitions(o)}}getImages(o,h,x){this.imageManager.getImages(h.icons,h.scope,x),this._updateTilesForChangedImages();const I=A=>{A&&A.setDependencies(h.tileID.key,h.type,h.icons)};I(this._otherSourceCaches[h.source]),I(this._symbolSourceCaches[h.source])}getGlyphs(o,h,x){this.glyphManager.getGlyphs(h.stacks,h.scope,x)}getResource(o,h,x){return s.c9(h,x)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){const h=this.getOwnSourceCaches(o);return h.length===0?(this.fire(new s.a(new Error(`There is no source with ID '${o}'`))),!1):h.every(x=>x.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}qo.getSourceType=function(_){return $a[_]},qo.setSourceType=function(_,o){$a[_]=o},qo.registerForPluginStateChange=s.bV;var Uu=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,op=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}`,xa=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Rn="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Zs=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,vd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Eh=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Xs=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,gs=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform vec2 u_velocity_res;uniform float u_max_speed;const vec2 INVALID_VELOCITY=vec2(-1);uniform vec2 u_texture_offset;uniform float u_data_offset;uniform vec4 u_data_scale;vec2 lookup_velocity(vec2 uv) {uv=u_texture_offset.x+u_texture_offset.y*uv;vec2 fxy;ivec4 c=_raTexLinearCoord(uv,u_velocity_res,fxy);vec4 tl=texelFetch(u_velocity,c.yz,0);vec4 tr=texelFetch(u_velocity,c.xz,0);vec4 bl=texelFetch(u_velocity,c.yw,0);vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NODATA) {return INVALID_VELOCITY;}if (tr==NODATA) {return INVALID_VELOCITY;}if (bl==NODATA) {return INVALID_VELOCITY;}if (br==NODATA) {return INVALID_VELOCITY;}vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);
#ifdef DATA_FORMAT_UINT32
vec2 velocity=vec2(u_data_offset+dot(t,u_data_scale),0);return velocity;
#else
vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));
#endif
return velocity/max(u_max_speed,length(velocity));}
#endif`,ap=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,un=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const $u=[];_c(Uu,$u),_c(xa,$u),_c(op,$u);const Ys={"_prelude_fog.vertex.glsl":vd,"_prelude_terrain.vertex.glsl":Zs,"_prelude_shadow.vertex.glsl":ap,"_prelude_fog.fragment.glsl":Eh,"_prelude_shadow.fragment.glsl":un,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Xs,"_prelude_raster_particle.glsl":gs},Gu={};Si("",Zs),Si(Eh,vd),Si(un,ap),Si(Xs,""),Si(gs,"");const xl=Si(op,xa),Ls=Uu;var xd={background:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Si("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Si(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Si(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Si("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Si("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Si("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Si(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Si(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Si(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Si(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float pattern_x=v_linesofar/pattern_size.x*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;vec2 uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
vec2 uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Si("precision highp float;uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`precision highp float;
#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {vec2 pos=a_pos.xy+u_tile_offset;vec2 tex_coords=fract(pos);gl_PointSize=1.0;vec2 velocity=lookup_velocity(tex_coords);if (velocity==INVALID_VELOCITY) {v_particle_speed=0.0;gl_Position=vec4(2.0,2.0,2.0,1.0);} else {v_particle_speed=length(velocity);gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);}}`),rasterParticleTexture:Si("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {v_tex_pos=0.5*a_pos+vec2(0.5);gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Si("void main() {}",`#include "_prelude_raster_array.glsl"
#include "_prelude_raster_particle.glsl"
in vec3 a_pos;uniform float u_speed_factor;uniform float u_lifetime_delta;uniform float u_rand_seed;out vec3 v_new_particle;const vec3 rand_constants=vec3(12.9898,78.233,4375.85453);float rand(const vec2 co) {float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {float lifetime=a_pos.z;vec2 pos=a_pos.xy;vec2 uv=clamp(pos,vec2(0.0),vec2(1.0));vec2 velocity=lookup_velocity(uv);float next_lifetime=lifetime-u_lifetime_delta;float t=step(0.0,next_lifetime);
#ifdef DATA_FORMAT_UINT32
vec2 dp=vec2(0);
#else
vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;
#endif
vec2 seed=pos*u_rand_seed;vec2 next_pos=pos+dp;vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));v_new_particle=vec3(
vec2(mix(random_pos,next_pos,t)),mix(1.0,next_lifetime,t)
);}`),symbolIcon:Si(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Si(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Si(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Si("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Si(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Rn),skyboxGradient:Si(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Rn),skyboxCapture:Si(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Si(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Si(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Si(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Si(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function _c(_,o){const h=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of h)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const I=x.split(" ");for(const A of I)o.includes(A)||o.push(A)}}function Si(_,o){const h=/#include\s+"([^"]+)"/g,x=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let I=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);I&&(I=I.map(Z=>{const J=Z.split(" ");return J[J.length-1]}),I=[...new Set(I)]);const A={},D=[],N=[];if(_=_.replace(h,(Z,J)=>(N.push(J),"")),(o=o.replace(h,(Z,J)=>(D.push(J),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let U=[...$u];_c(_,U),_c(o,U);for(const Z of[...D,...N])Ys[Z]||console.error(`Undefined include: ${Z}`),Gu[Z]||(Gu[Z]=[],_c(Ys[Z],Gu[Z])),U=[...U,...Gu[Z]];return{fragmentSource:_=_.replace(x,(Z,J,ee,ae,he)=>(A[he]=!0,J==="define"?`
#ifndef HAS_UNIFORM_u_${he}
in ${ee} ${ae} ${he};
#else
uniform ${ee} ${ae} u_${he};
#endif
`:J==="initialize"?`
#ifdef HAS_UNIFORM_u_${he}
    ${ee} ${ae} ${he} = u_${he};
#endif
`:J==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${he}
    in ${ee} ${ae} ${he};
#endif
`:J==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(x,(Z,J,ee,ae,he)=>{const we=ae==="float"?"vec2":ae,xe=he.match(/color/)?"color":we;return J==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${he}
in ${ee} ${ae} a_${he};
#endif
`:A[he]?J==="define"?`
#ifndef HAS_UNIFORM_u_${he}
uniform lowp float u_${he}_t;
in ${ee} ${we} a_${he};
out ${ee} ${ae} ${he};
#else
uniform ${ee} ${ae} u_${he};
#endif
`:J==="initialize"?xe==="vec4"?`
#ifndef HAS_UNIFORM_u_${he}
    ${he} = a_${he};
#else
    ${ee} ${ae} ${he} = u_${he};
#endif
`:`
#ifndef HAS_UNIFORM_u_${he}
    ${he} = unpack_mix_${xe}(a_${he}, u_${he}_t);
#else
    ${ee} ${ae} ${he} = u_${he};
#endif
`:J==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${he}
    in ${ee} ${ae} a_${he};
    out ${ee} ${ae} ${he};
#endif
`:J==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${he}
    ${he} = a_${he};
#endif
`:void 0:J==="define"?`
#ifndef HAS_UNIFORM_u_${he}
uniform lowp float u_${he}_t;
in ${ee} ${we} a_${he};
#else
uniform ${ee} ${ae} u_${he};
#endif
`:J==="define-instanced"?xe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${he}0;
in vec4 a_${he}1;
in vec4 a_${he}2;
in vec4 a_${he}3;
#else
uniform ${ee} ${ae} u_${he};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${ee} ${we} a_${he};
#else
uniform ${ee} ${ae} u_${he};
#endif
`:J==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${he}
    ${ee} ${ae} ${he} = a_${he};
#endif
`:xe==="vec4"?`
#ifndef HAS_UNIFORM_u_${he}
    ${ee} ${ae} ${he} = a_${he};
#else
    ${ee} ${ae} ${he} = u_${he};
#endif
`:`
#ifndef HAS_UNIFORM_u_${he}
    ${ee} ${ae} ${he} = unpack_mix_${xe}(a_${he}, u_${he}_t);
#else
    ${ee} ${ae} ${he} = u_${he};
#endif
`}),staticAttributes:I,usedDefines:U,vertexIncludes:D,fragmentIncludes:N}}class yc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,x,I,A,D,N,U){this.context=o;let Z=this.boundPaintVertexBuffers.length!==I.length;for(let ee=0;!Z&&ee<I.length;ee++)this.boundPaintVertexBuffers[ee]!==I[ee]&&(Z=!0);let J=this.boundDynamicVertexBuffers.length!==N.length;for(let ee=0;!J&&ee<N.length;ee++)this.boundDynamicVertexBuffers[ee]!==N[ee]&&(J=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==x||Z||J||this.boundIndexBuffer!==A||this.boundVertexOffset!==D)this.freshBind(h,x,I,A,D,N,U);else{o.bindVertexArrayOES.set(this.vao);for(const ee of N)ee&&(ee.bind(),U&&ee.instanceCount&&ee.setVertexAttribDivisor(o.gl,h,U));A&&A.dynamicDraw&&A.bind()}}freshBind(o,h,x,I,A,D,N){const U=o.numAttributes,Z=this.context,J=Z.gl;this.vao&&this.destroy(),this.vao=Z.gl.createVertexArray(),Z.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=I,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=D,h.enableAttributes(J,o),h.bind(),h.setVertexAttribPointers(J,o,A);for(const ee of x)ee.enableAttributes(J,o),ee.bind(),ee.setVertexAttribPointers(J,o,A);for(const ee of D)ee&&(ee.enableAttributes(J,o),ee.bind(),ee.setVertexAttribPointers(J,o,A),N&&ee.instanceCount&&ee.setVertexAttribDivisor(J,o,N));I&&I.bind(),Z.currentNumAttributes=U}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Vm(_,o){const h=Math.pow(2,o.canonical.z),x=o.canonical.y;return[new s.L(0,x/h).toLngLat().lat,new s.L(0,(x+1)/h).toLngLat().lat]}function qu(_,o,h,x,I,A,D){const N=_.context,U=N.gl,Z=h.hillshadeFBO;if(!Z)return;_.prepareDrawTile();const J=_.isTileAffectedByFog(o),ee=_.getOrCreateProgram("hillshade",{overrideFog:J});N.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,Z.colorAttachment.get());const ae=((Ce,ge,De,Xe)=>{const Be=De.paint.get("hillshade-shadow-color"),We=De.paint.get("hillshade-highlight-color"),Pe=De.paint.get("hillshade-accent-color"),Ke=De.paint.get("hillshade-emissive-strength");let st=s.bj(De.paint.get("hillshade-illumination-direction"));if(De.paint.get("hillshade-illumination-anchor")==="viewport")st-=Ce.transform.angle;else if(Ce.style&&Ce.style.enable3dLights()&&Ce.style.directionalLight){const Tt=Ce.style.directionalLight.properties.get("direction"),Zt=s.bQ(Tt.x,Tt.y,Tt.z);st=s.bj(Zt[1])}const pt=!Ce.options.moving;return{u_matrix:Xe||Ce.transform.calculateProjMatrix(ge.tileID.toUnwrapped(),pt),u_image:0,u_latrange:Vm(0,ge.tileID),u_light:[De.paint.get("hillshade-exaggeration"),st],u_shadow:Be,u_highlight:We,u_emissive_strength:Ke,u_accent:Pe}})(_,h,x,_.terrain?o.projMatrix:null);_.uploadCommonUniforms(N,ee,o.toUnwrapped());const{tileBoundsBuffer:he,tileBoundsIndexBuffer:we,tileBoundsSegments:xe}=_.getTileBoundsBuffers(h);ee.draw(_,U.TRIANGLES,I,A,D,Dn.disabled,ae,x.id,he,we,xe)}function Jp(_,o,h){if(!o.needsDEMTextureUpload)return;const x=_.context,I=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(h.stride);const A=h.getPixels();o.demTexture?o.demTexture.update(A,{premultiply:!1}):o.demTexture=new s.T(x,A,I.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function sp(_,o,h){const x=_.context,I=x.gl;if(!o.dem)return;const A=o.dem;if(x.activeTexture.set(I.TEXTURE1),Jp(_,o,A),!o.demTexture)return;o.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const D=A.dim;x.activeTexture.set(I.TEXTURE0);let N=o.hillshadeFBO;if(!N){const ae=new s.T(x,{width:D,height:D,data:null},I.RGBA);ae.bind(I.LINEAR,I.CLAMP_TO_EDGE),N=o.hillshadeFBO=x.createFramebuffer(D,D,!0,"renderbuffer"),N.colorAttachment.set(ae.texture)}x.bindFramebuffer.set(N.framebuffer),x.viewport.set([0,0,D,D]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:Z,tileBoundsSegments:J}=_.getMercatorTileBoundsBuffers(),ee=[];_.linearFloatFilteringSupported()&&ee.push("TERRAIN_DEM_FLOAT_FORMAT"),_.getOrCreateProgram("hillshadePrepare",{defines:ee}).draw(_,I.TRIANGLES,Un.disabled,ui.disabled,Fi.unblended,Dn.disabled,((ae,he)=>{const we=he.stride,xe=s.a6.create();return s.a6.ortho(xe,0,s.V,-s.V,0,0,1),s.a6.translate(xe,xe,[0,-s.V,0]),{u_matrix:xe,u_image:1,u_dimension:[we,we],u_zoom:ae.overscaledZ}})(o.tileID,A),h.id,U,Z,J),o.needsHillshadePrepare=!1}const Jl=_=>({u_matrix:new s.bK(_),u_image0:new s.bO(_),u_skirt_height:new s.bN(_),u_ground_shadow_factor:new s.bM(_)}),Ks=(_,o,h)=>({u_matrix:_,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:h}),oo=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:h,u_zoom_transition:I,u_merc_center:A,u_image0:0,u_frustum_tl:D,u_frustum_tr:N,u_frustum_br:U,u_frustum_bl:Z,u_globe_pos:J,u_globe_radius:ee,u_viewport:ae,u_grid_matrix:xe?Float32Array.from(xe):new Float32Array(9),u_skirt_height:he,u_far_z_cutoff:we});function bl(_,o){return _!=null&&o!=null&&!(!_.hasData()||!o.hasData())&&_.demTexture!=null&&o.demTexture!=null&&_.tileID.key!==o.tileID.key}const zs=new class{constructor(){this.operations={}}newMorphing(_,o,h,x,I){if(_ in this.operations){const A=this.operations[_];A.to.tileID.key!==h.tileID.key&&(A.queued=h)}else this.operations[_]={startTime:x,phase:0,duration:I,from:o,to:h,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const o=this.operations[_];return{from:o.from,to:o.to,phase:o.phase}}update(_){for(const o in this.operations){const h=this.operations[o];for(h.phase=(_-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,_)){delete this.operations[o];break}}}_nextOp(_,o){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=o,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},ns={0:null,1:"TERRAIN_VERTEX_MORPHING"};function gu(_,o,h){if(o===0)return 0;const x=o<1&&h===514?.25/o:1;return 6*Math.pow(1.5,22-_)*Math.max(o,1)*x}function Ll(_,o){const h=1<<_.z;return!o&&(_.x===0||_.x===h-1)||_.y===0||_.y===h-1}const zl=_=>({u_matrix:_});function Cs(_,o,h,x,I){if(I>0){const A=s.f.now(),D=(A-_.timeAdded)/I,N=o?(A-o.timeAdded)/I:-1,U=h.getSource(),Z=x.coveringZoomLevel({tileSize:U.tileSize,roundZoom:U.roundZoom}),J=!o||Math.abs(o.tileID.overscaledZ-Z)>Math.abs(_.tileID.overscaledZ-Z),ee=J&&_.refreshedUponExpiration?1:s.aa(J?D:1-N,0,1);return _.refreshedUponExpiration&&D>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ee}:{opacity:ee,mix:0}}return{opacity:1,mix:0}}class lp extends Dl{constructor(o){const h={type:"raster-dem",maxzoom:o.transform.maxZoom},x=new s.bW(s.bX(),null),I=lo("mock-dem",h,x,o.style);super("mock-dem",I,!1),I.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class Kn extends Dl{constructor(o){const h=lo("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new s.bW(s.bX(),null),o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,x){if(o.freezeTileCoverage)return;this.transform=o;const I=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,D)=>{if(A[D.key]="",!this._tiles[D.key]){const N=new hc(D,this._source.tileSize*D.overscaleFactor(),o.tileZoom);N.state="loaded",this._tiles[D.key]=N}return A},{});for(const A in this._tiles)A in I||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(o){const h=this.proxyCachedFBO[o];if(h!==void 0){const x=Object.values(h);this.renderCachePool.push(...x),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Bn extends s.am{constructor(o,h,x){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=x}}class Qp extends s.ck{constructor(o,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,I,A]=function(U){const Z=new s.aN,J=new s.aw,ee=131;Z.reserve(17161),J.reserve(33800);const ae=s.V/128,he=s.V+ae/2,we=he+ae;for(let Ce=-ae;Ce<we;Ce+=ae)for(let ge=-ae;ge<we;ge+=ae){const De=ge<0||ge>he||Ce<0||Ce>he?24575:0,Xe=s.aa(Math.round(ge),0,s.V),Be=s.aa(Math.round(Ce),0,s.V);Z.emplaceBack(Xe+De,Be)}const xe=(Ce,ge)=>{const De=ge*ee+Ce;J.emplaceBack(De+1,De,De+ee),J.emplaceBack(De+ee,De+ee+1,De+1)};for(let Ce=1;Ce<129;Ce++)for(let ge=1;ge<129;ge++)xe(ge,Ce);return[0,129].forEach(Ce=>{for(let ge=0;ge<130;ge++)xe(ge,Ce),xe(Ce,ge)}),[Z,J,32768]}(),D=o.context;this.gridBuffer=D.createVertexBuffer(x,s.aP.members),this.gridIndexBuffer=D.createIndexBuffer(I),this.gridSegments=s.aB.simpleSegment(0,0,x.length,I.length),this.gridNoSkirtSegments=s.aB.simpleSegment(0,0,x.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Kn(h.map),this.orthoMatrix=s.a6.create(),s.a6.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.V,0,s.V,0,1);const N=D.gl;this._overlapStencilMode=new ui({func:N.GEQUAL,mask:255},0,255,N.KEEP,N.KEEP,N.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new lp(h.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,h,x){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const I=o.terrain.properties,A=o.terrain.drapeRenderMode===0,D=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.f.now();const N=o.terrain&&o.terrain.scope,U=I.get("source"),Z=A?this._mockSourceCache:o.getSourceCache(U,N);if(!Z)return void s.w(`Couldn't find terrain source "${U}".`);if(this.sourceCache=Z,this._exaggeration=D?this.calculateExaggeration(h):I.get("exaggeration"),!h.projection.requiresDraping&&D&&this._exaggeration===0)return void this._disable();this.enabled=!0;const J=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ee=this.getScaledDemTileSize();this.sourceCache.update(h,ee,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,J(),this._initializing=!0),J(),h.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(o){const h=this._previousCameraAltitude,x=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=x;const I=h!=null?x-h:Number.MAX_VALUE;if(Math.abs(I)<2)return this._exaggeration;const A=o.zoom,D=this._style.terrain;if(!this._previousUpdateTimestamp)return D.getExaggeration(A);let N=A-this._previousZoom;const U=this._previousUpdateTimestamp;let Z=A;this._evaluationZoom!=null&&(Z=this._evaluationZoom,Math.abs(A-Z)>.5&&(N=.5*(A-Z+N)),N*I<0&&(Z+=N)),this._evaluationZoom=Z;const J=D.getExaggeration(Z),ee=J===D.getExaggeration(Math.max(0,Z-.1));if(ee&&Math.abs(J-this._exaggeration)<.01)return J;let ae=Math.min(.1,.00375*(this._updateTimestamp-U));return(ee||J<.1||Math.abs(N)<1e-4)&&(ae=Math.min(.2,4*ae)),s.U(this._exaggeration,J,ae)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(s.L.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const I=this.proxyCoords=h.getIds().map(U=>{const Z=h.getTileByID(U).tileID;return Z.projMatrix=x.calculateProjMatrix(Z.toUnwrapped()),Z});(function(U,Z){const J=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),ee=new s.P(J.x,J.y);U.sort((ae,he)=>{if(he.overscaledZ-ae.overscaledZ)return he.overscaledZ-ae.overscaledZ;const we=new s.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),xe=new s.P(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),Ce=ee.mult(1<<ae.canonical.z);return Ce.x-=.5,Ce.y-=.5,Ce.distSqr(we)-Ce.distSqr(xe)})})(I,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},I.forEach(U=>{this.proxyToSource[U.key]={}}),this.terrainTileForTile={};const D=this._style._mergedSourceCaches;for(const U in D){const Z=D[U];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,o[U],A),Z.usedForTerrain))continue;const J=o[U];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(J)}this.proxiedCoords[h.id]=I.map(U=>new Bn(U,U.key,this.orthoMatrix)),this._assignTerrainTiles(I),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const N={};this._visibleDemTiles=[];for(const U of this.proxyCoords){const Z=this.terrainTileForTile[U.key];if(!Z)continue;const J=Z.tileID.key;J in N||(this._visibleDemTiles.push(Z),N[J]=J)}}_assignTerrainTiles(o){this._initializing||o.forEach(h=>{if(this.terrainTileForTile[h.key])return;const x=this._findTileCoveringTileID(h,this.sourceCache);x&&(this.terrainTileForTile[h.key]=x)})}_prepareDEMTextures(){const o=this.painter.context,h=o.gl;for(const x in this.terrainTileForTile){const I=this.terrainTileForTile[x],A=I.dem;!A||I.demTexture&&!I.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),Jp(this.painter,I,A))}}_prepareDemTileUniforms(o,h,x,I){if(!h||h.demTexture==null)return!1;const A=o.tileID.canonical,D=Math.pow(2,h.tileID.canonical.z-A.z),N=I||"";return x[`u_dem_tl${N}`]=[A.x*D%1,A.y*D%1],x[`u_dem_scale${N}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,h=o.gl;if(!this._emptyDepthBufferTexture){const x=new s.h({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.T(o,x,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const h=this._visibleDemTiles.reduce((x,I)=>{if(!I.dem)return x;const A=I.dem.tree.minimums[0];return A>0&&o++,x+A},0);return o?h/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);const x=this._getLoadedAreaMinimum(),[I,A]=(()=>{const N=new s.cm({width:1,height:1},new Float32Array([x]));return[h.R32F,N]})();this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(A,{premultiply:!1}):D=this._emptyDEMTexture=new s.T(o,A,I,{premultiply:!1}),D}setupElevationDraw(o,h,x){const I=this.painter.context,A=I.gl,D={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};D.u_exaggeration=this.exaggeration();let N=null,U=null,Z=1;if(x&&x.morphing&&this._useVertexMorphing){const ae=x.morphing.srcDemTile,he=x.morphing.dstDemTile;Z=x.morphing.phase,ae&&he&&(this._prepareDemTileUniforms(o,ae,D,"_prev")&&(U=ae),this._prepareDemTileUniforms(o,he,D)&&(N=he))}const J=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST,ee=ae=>{D.u_dem_size=ae.size[0]===1?1:ae.size[0]-2};if(U&&N)I.activeTexture.set(A.TEXTURE2),N.demTexture.bind(J(N),A.CLAMP_TO_EDGE),I.activeTexture.set(A.TEXTURE4),U.demTexture.bind(J(U),A.CLAMP_TO_EDGE),N.demTexture&&ee(N.demTexture),D.u_dem_lerp=Z;else{N=this.terrainTileForTile[o.tileID.key],I.activeTexture.set(A.TEXTURE2);const ae=this._prepareDemTileUniforms(o,N,D)?N.demTexture:this.emptyDEMTexture;ae.bind(J(N),A.CLAMP_TO_EDGE),ee(ae)}if(I.activeTexture.set(A.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&N){const ae=(1<<N.tileID.canonical.z)*s.bl(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=ae}if(x&&x.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),h.setTerrainUniformValues(I,D),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,o.tileID.canonical,x&&x.useDenormalizedUpVectorScale);h.setGlobeUniformValues(I,ae)}}globeUniformValues(o,h,x){const I=o.projection;return{u_tile_tl_up:I.upVector(h,0,0),u_tile_tr_up:I.upVector(h,s.V,0),u_tile_br_up:I.upVector(h,s.V,s.V),u_tile_bl_up:I.upVector(h,0,s.V),u_tile_up_scale:x?s.cl(1):I.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const h=this.painter,x=this.painter.context;o.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(I,A,D,N,U){if(I.transform.projection.name==="globe")(function(Z,J,ee,ae,he){const we=Z.context,xe=we.gl;let Ce,ge;const De=Z.transform,Xe=s.cd(Z,we,De),Be=(hr,tr)=>{if(ge===tr)return;const Cr=[ns[tr],"PROJECTION_GLOBE_VIEW"];Xe&&Cr.push("CUSTOM_ANTIALIASING");const zt=Z.isTileAffectedByFog(hr);Ce=Z.getOrCreateProgram("globeRaster",{defines:Cr,overrideFog:zt}),ge=tr},We=Z.colorModeForRenderPass(),Pe=new Un(xe.LEQUAL,Un.ReadWrite,Z.depthRangeFor3D);zs.update(he);const Ke=s.ce(De),st=[s.a5(De.center.lng),s.ae(De.center.lat)],pt=Z.globeSharedBuffers,Tt=[De.width*s.f.devicePixelRatio,De.height*s.f.devicePixelRatio],Zt=Float32Array.from(De.globeMatrix),xt={useDenormalizedUpVectorScale:!0};{const hr=Z.transform,tr=gu(hr.zoom,J.exaggeration(),J.sourceCache._source.tileSize);ge=-1;const Cr=xe.TRIANGLES;for(const zt of ae){const ir=ee.getTile(zt),vt=ui.disabled,Ut=J.prevTerrainTileForTile[zt.key],Lr=J.terrainTileForTile[zt.key];bl(Ut,Lr)&&zs.newMorphing(zt.key,Ut,Lr,he,250),we.activeTexture.set(xe.TEXTURE0),ir.texture&&ir.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Wr=zs.getMorphValuesForProxy(zt.key),Gr=Wr?1:0;Wr&&s.j(xt,{morphing:{srcDemTile:Wr.from,dstDemTile:Wr.to,phase:s.cc(Wr.phase)}});const tn=s.cf(zt.canonical),_n=s.cg(tn.getCenter().lat),Fn=s.ch(zt.canonical,tn,_n,hr.worldSize/hr._pixelsPerMercatorPixel),wn=s.aT(s.ci(zt.canonical)),Sn=oo(hr.expandedFarZProjMatrix,Zt,Ke,wn,s.S(hr.zoom),st,hr.frustumCorners.TL,hr.frustumCorners.TR,hr.frustumCorners.BR,hr.frustumCorners.BL,hr.globeCenterInViewSpace,hr.globeRadius,Tt,tr,hr._farZ,Fn);if(Be(zt,Gr),Ce&&(J.setupElevationDraw(ir,Ce,xt),Z.uploadCommonUniforms(we,Ce,zt.toUnwrapped()),pt)){const[Mi,pi,Ci]=pt.getGridBuffers(_n,tr!==0);Ce.draw(Z,Cr,Pe,vt,We,Dn.backCCW,Sn,"globe_raster",Mi,pi,Ci)}}}if(pt&&(Z.renderDefaultNorthPole||Z.renderDefaultSouthPole)){const hr=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Xe&&hr.push("CUSTOM_ANTIALIASING"),Ce=Z.getOrCreateProgram("globeRaster",{defines:hr});for(const tr of ae){const{x:Cr,y:zt,z:ir}=tr.canonical,vt=zt===0,Ut=zt===(1<<ir)-1,[Lr,Wr,Gr,tn]=pt.getPoleBuffers(ir,!1);if(tn&&(vt||Ut)){const _n=ee.getTile(tr);we.activeTexture.set(xe.TEXTURE0),_n.texture&&_n.texture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);let Fn=s.cj(ir,Cr,De);const wn=s.aT(s.ci(tr.canonical)),Sn=(Mi,pi)=>Mi.draw(Z,xe.TRIANGLES,Pe,ui.disabled,We,Dn.disabled,oo(De.expandedFarZProjMatrix,Fn,Fn,wn,0,st,De.frustumCorners.TL,De.frustumCorners.TR,De.frustumCorners.BR,De.frustumCorners.BL,De.globeCenterInViewSpace,De.globeRadius,Tt,0,De._farZ),"globe_pole_raster",pi,Gr,tn);J.setupElevationDraw(_n,Ce,xt),Z.uploadCommonUniforms(we,Ce,tr.toUnwrapped()),vt&&Z.renderDefaultNorthPole&&Sn(Ce,Lr),Ut&&Z.renderDefaultSouthPole&&(Fn=s.a6.scale(s.a6.create(),Fn,[1,-1,1]),Sn(Ce,Wr))}}}})(I,A,D,N,U);else{const Z=I.context,J=Z.gl;let ee,ae;const he=I.shadowRenderer,we=Oo(I,I.longestCutoffRange),xe=We=>{if(ae===We)return;const Pe=[];Pe.push(ns[We]),we.shouldRenderCutoff&&Pe.push("RENDER_CUTOFF"),ee=I.getOrCreateProgram("terrainRaster",{defines:Pe}),ae=We},Ce=I.colorModeForRenderPass(),ge=new Un(J.LEQUAL,Un.ReadWrite,I.depthRangeFor3D);zs.update(U);const De=I.transform,Xe=gu(De.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let Be=[0,0,0];if(he){const We=I.style.directionalLight,Pe=I.style.ambientLight;We&&Pe&&(Be=fu(We,Pe))}{ae=-1;const We=J.TRIANGLES,[Pe,Ke]=[A.gridIndexBuffer,A.gridSegments];for(const st of N){const pt=D.getTile(st),Tt=ui.disabled,Zt=A.prevTerrainTileForTile[st.key],xt=A.terrainTileForTile[st.key];bl(Zt,xt)&&zs.newMorphing(st.key,Zt,xt,U,250),Z.activeTexture.set(J.TEXTURE0),pt.texture&&pt.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const hr=zs.getMorphValuesForProxy(st.key),tr=hr?1:0;let Cr;hr&&(Cr={morphing:{srcDemTile:hr.from,dstDemTile:hr.to,phase:s.cc(hr.phase)}});const zt=Ks(st.projMatrix,Ll(st.canonical,De.renderWorldCopies)?Xe/10:Xe,Be);if(xe(tr),!ee)continue;A.setupElevationDraw(pt,ee,Cr);const ir=st.toUnwrapped();he&&he.setupShadows(ir,ee),I.uploadCommonUniforms(Z,ee,ir,null,we),ee.draw(I,We,ge,Tt,Ce,Dn.backCCW,zt,"terrain_raster",A.gridBuffer,Pe,Ke)}}}}(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const h=this.painter,x=this.painter.context,I=this.proxySourceCache,A=this.proxiedCoords[I.id],D=this._drapedRenderBatches.shift(),N=h.style.order,U=[];let Z=0;for(const J of A){const ee=I.getTileByID(J.proxyTileKey),ae=I.proxyCachedFBO[J.key]?I.proxyCachedFBO[J.key][o]:void 0,he=ae!==void 0?I.renderCache[ae]:this.pool[Z++],we=ae!==void 0;if(ee.texture=he.tex,we&&!he.dirty){U.push(ee.tileID);continue}let xe;x.bindFramebuffer.set(he.fb.framebuffer),this.renderedToTile=!1,he.dirty&&(x.clear({color:s.ax.transparent,stencil:0}),he.dirty=!1);for(let Ce=D.start;Ce<=D.end;++Ce){const ge=h.style._mergedLayers[N[Ce]];if(ge.isHidden(h.transform.zoom))continue;const De=h.style.getLayerSourceCache(ge),Xe=De?this.proxyToSource[J.key][De.id]:[J];if(!Xe)continue;const Be=Xe;x.viewport.set([0,0,he.fb.width,he.fb.height]),xe!==(De?De.id:null)&&(this._setupStencil(he,Xe,ge,De),xe=De?De.id:null),h.renderLayer(h,De,ge,Be)}if(this._drapedRenderBatches.length===0)for(const Ce of this._pendingGroundEffectLayers){const ge=h.style._mergedLayers[N[Ce]];if(ge.isHidden(h.transform.zoom))continue;const De=h.style.getLayerSourceCache(ge),Xe=De?this.proxyToSource[J.key][De.id]:[J];if(!Xe)continue;const Be=Xe;x.viewport.set([0,0,he.fb.width,he.fb.height]),xe!==(De?De.id:null)&&(this._setupStencil(he,Xe,ge,De),xe=De?De.id:null),h.renderLayer(h,De,ge,Be)}this.renderedToTile?(he.dirty=!0,U.push(ee.tileID)):we||--Z,Z===5&&(Z=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,h.width,h.height]),D.end+1}postRender(){}isLayerOrderingCorrect(o){const h=o.order.length;let x=-1,I=h;for(let A=0;A<h;++A)this._style.isLayerDraped(o._mergedLayers[o.order[A]])?x=Math.max(x,A):I=Math.min(I,A);return I>x}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{o=Math.min(o,h.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,h,x){if(!this._visibleDemTiles)return null;const I=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const D=A.tileID,N=1<<D.overscaledZ,{x:U,y:Z}=D.canonical,J=U/N,ee=(U+1)/N,ae=Z/N,he=(Z+1)/N;return{minx:J,miny:ae,maxx:ee,maxy:he,t:A.dem.tree.raycastRoot(J,ae,ee,he,o,h,x),tile:A}});I.sort((A,D)=>(A.t!==null?A.t:Number.MAX_VALUE)-(D.t!==null?D.t:Number.MAX_VALUE));for(const A of I){if(A.t==null)return null;const D=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,o,h,x);if(D!=null)return D}return null}_createFBO(){const o=this.painter.context,h=o.gl,x=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);const I=new s.T(o,{width:x[0],height:x[1],data:null},h.RGBA);I.bind(h.LINEAR,h.CLAMP_TO_EDGE);const A=o.createFramebuffer(x[0],x[1],!0,null);return A.colorAttachment.set(I.texture),A.depthAttachment=new ya(o,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:A,tex:I,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const h=this._style._mergedLayers[o],x=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!x&&h.shouldRedrape():!x&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const x of this._style.getSources())if(x instanceof Ot){o=!0;break}if(!o)return;const h={};for(let x=0;x<this._style.order.length;++x){const I=this._style._mergedLayers[this._style.order[x]],A=this._style.getLayerSourceCache(I);if(A&&!h[A.id]&&!I.isHidden(this.painter.transform.zoom)&&I.type==="line"&&I.widthExpression()instanceof s.Z){h[A.id]=!0;for(const D of this.proxyCoords){const N=this.proxyToSource[D.key][A.id];if(N)for(const U of N)this._clearRenderCacheForTile(A.id,U)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const x in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[x]._source instanceof bt){o=!0;break}if(!o)return;const h={};for(let x=0;x<this._style.order.length;++x){const I=this._style._mergedLayers[this._style.order[x]],A=this._style.getLayerSourceCache(I);if(!A||h[A.id]||I.isHidden(this.painter.transform.zoom)||I.type!=="raster")continue;const D=I.paint.get("raster-fade-duration");for(const N of this.proxyCoords){const U=this.proxyToSource[N.key][A.id];if(U)for(const Z of U){const J=Cs(A.getTile(Z),A.findLoadedParent(Z,0),A,this.painter.transform,D);(J.opacity!==1||J.mix!==0)&&this._clearRenderCacheForTile(A.id,Z)}}}}_setupDrapedRenderBatches(){const o=this._style.order,h=o.length;if(h===0)return;const x=[];this._pendingGroundEffectLayers=[];let I,A=0,D=this._style._mergedLayers[o[A]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++A<h;)D=this._style._mergedLayers[o[A]];for(;A<h;++A){const N=this._style._mergedLayers[o[A]];N.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(N)?I===void 0&&(I=A):(N.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),I!==void 0&&(x.push({start:I,end:A-1}),I=void 0)))}if(I!==void 0&&x.push({start:I,end:A-1}),x.length!==0){const N=x[x.length-1];this._pendingGroundEffectLayers.every(U=>U>N.end)||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=x}_setupRenderCache(o){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const D=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let N=0;N<D.length;++N){const U=Object.values(D[N]);h.renderCachePool.push(...U)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,I=this._tilesDirty;for(let D=x.length-1;D>=0;D--){const N=x[D];if(h.getTileByID(N.key),h.proxyCachedFBO[N.key]!==void 0){const U=o[N.key],Z=this.proxyToSource[N.key];let J=0;for(const ee in Z){const ae=Z[ee],he=U[ee];if(!he||he.length!==ae.length||ae.some((we,xe)=>we!==he[xe]||I[ee]&&I[ee].hasOwnProperty(we.key))){J=-1;break}++J}for(const ee in h.proxyCachedFBO[N.key])h.renderCache[h.proxyCachedFBO[N.key][ee]].dirty=J<0||J!==Object.values(U).length}}const A=[...this._drapedRenderBatches];A.sort((D,N)=>N.end-N.start-(D.end-D.start));for(const D of A)for(const N of x){if(h.proxyCachedFBO[N.key])continue;let U=h.renderCachePool.pop();U===void 0&&h.renderCache.length<50&&(U=h.renderCache.length,h.renderCache.push(this._createFBO())),U!==void 0&&(h.proxyCachedFBO[N.key]={},h.proxyCachedFBO[N.key][D.start]=U,h.renderCache[U].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,x,I){if(!I||!this._sourceTilesOverlap[I.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,D=A.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let N;if(x.isTileClipped())N=h.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);N=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+N>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=N,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):ui.disabled}_renderTileClippingMasks(o,h){const x=this.painter,I=this.painter.context,A=I.gl;x._tileClippingMaskIDs={},I.setColorMode(Fi.disabled),I.setDepthMode(Un.disabled);const D=x.getOrCreateProgram("clippingMask");for(const N of o){const U=x._tileClippingMaskIDs[N.key]=--h;D.draw(x,A.TRIANGLES,Un.disabled,new ui({func:A.ALWAYS,mask:0},U,255,A.KEEP,A.KEEP,A.REPLACE),Fi.disabled,Dn.disabled,zl(N.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(o){const h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;const x=[o.x,o.y,1,1];s.a7.transformMat4(x,x,h.pixelMatrixInverse),s.a7.scale(x,x,1/x[3]),x[0]/=h.worldSize,x[1]/=h.worldSize;const I=h._camera.position,A=s.bl(1,h.center.lat),D=[I[0],I[1],I[2]/A,0],N=s.N.subtract([],x.slice(0,3),D);s.N.normalize(N,N);const U=this.raycast(D,N,this._exaggeration);return U!==null&&U?(s.N.scaleAndAdd(D,D,N,U),D[3]=D[2],D[2]*=A,D):null}drawDepth(){const o=this.painter,h=o.context,x=this.proxySourceCache,I=Math.ceil(o.width),A=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===I&&this._depthFBO.height===A||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=h.gl,N=h.createFramebuffer(I,A,!0,"renderbuffer");h.activeTexture.set(D.TEXTURE0);const U=new s.T(h,{width:I,height:A,data:null},D.RGBA);U.bind(D.NEAREST,D.CLAMP_TO_EDGE),N.colorAttachment.set(U.texture);const Z=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,I,A);N.depthAttachment.set(Z),this._depthFBO=N,this._depthTexture=U}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,I,A]),function(D,N,U,Z){if(D.transform.projection.name==="globe")return;const J=D.context,ee=J.gl;J.clear({depth:1});const ae=D.getOrCreateProgram("terrainDepth"),he=new Un(ee.LESS,Un.ReadWrite,D.depthRangeFor3D);for(const we of Z){const xe=U.getTile(we),Ce=Ks(we.projMatrix,0,[0,0,0]);N.setupElevationDraw(xe,ae),ae.draw(D,ee.TRIANGLES,he,ui.disabled,Fi.unblended,Dn.backCCW,Ce,"terrain_depth",N.gridBuffer,N.gridIndexBuffer,N.gridNoSkirtSegments)}}(o,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,h,x){if(o.getSource()instanceof s.ap)return this._setupProxiedCoordsForImageSource(o,h,x);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const I=this.proxiedCoords[o.id]=[],A=this.proxyCoords;for(let U=0;U<A.length;U++){const Z=A[U],J=this._findTileCoveringTileID(Z,o);if(J){const ee=this._createProxiedId(Z,J,x[Z.key]&&x[Z.key][o.id]);I.push(ee),this.proxyToSource[Z.key][o.id]=[ee]}}let D=!1;const N=new Set;for(let U=0;U<h.length;U++){const Z=o.getTile(h[U]);if(!Z||!Z.hasData())continue;const J=this._findTileCoveringTileID(Z.tileID,this.proxySourceCache);if(J&&J.tileID.canonical.z!==Z.tileID.canonical.z){const ee=this.proxyToSource[J.tileID.key][o.id],ae=this._createProxiedId(J.tileID,Z,x[J.tileID.key]&&x[J.tileID.key][o.id]);ee?ee.splice(ee.length-1,0,ae):this.proxyToSource[J.tileID.key][o.id]=[ae];const he=this.proxyToSource[J.tileID.key][o.id];N.has(he)||N.add(he),I.push(ae),D=!0}}if(this._sourceTilesOverlap[o.id]=D,D&&this._debugParams.sortTilesHiZFirst)for(const U of N)U.sort((Z,J)=>J.overscaledZ-Z.overscaledZ)}_setupProxiedCoordsForImageSource(o,h,x){if(!o.getSource().loaded())return;const I=this.proxiedCoords[o.id]=[],A=this.proxyCoords,D=o.getSource(),N=D.tileID;if(!N)return;const U=new s.P(N.x,N.y)._div(1<<N.z),Z=D.coordinates.map(s.L.fromLngLat).reduce((ee,ae)=>(ee.min.x=Math.min(ee.min.x,ae.x-U.x),ee.min.y=Math.min(ee.min.y,ae.y-U.y),ee.max.x=Math.max(ee.max.x,ae.x-U.x),ee.max.y=Math.max(ee.max.y,ae.y-U.y),ee),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),J=(ee,ae)=>{const he=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),we=ee.canonical.y/(1<<ee.canonical.z),xe=s.V/(1<<ee.canonical.z),Ce=ae.wrap+ae.canonical.x/(1<<ae.canonical.z),ge=ae.canonical.y/(1<<ae.canonical.z);return he+xe<Ce+Z.min.x||he>Ce+Z.max.x||we+xe<ge+Z.min.y||we>ge+Z.max.y};for(let ee=0;ee<A.length;ee++){const ae=A[ee];for(let he=0;he<h.length;he++){const we=o.getTile(h[he]);if(!we||!we.hasData()||J(ae,we.tileID))continue;const xe=this._createProxiedId(ae,we,x[ae.key]&&x[ae.key][o.id]),Ce=this.proxyToSource[ae.key][o.id];Ce?Ce.push(xe):this.proxyToSource[ae.key][o.id]=[xe],I.push(xe)}}}_createProxiedId(o,h,x){let I=this.orthoMatrix;if(x){const A=x.find(D=>D.key===h.tileID.key);if(A)return A}if(h.tileID.key!==o.key){const A=o.canonical.z-h.tileID.canonical.z;let D,N,U;I=s.a6.create();const Z=h.tileID.wrap-o.wrap<<o.overscaledZ;A>0?(D=s.V>>A,N=D*((h.tileID.canonical.x<<A)-o.canonical.x+Z),U=D*((h.tileID.canonical.y<<A)-o.canonical.y)):(D=s.V<<-A,N=s.V*(h.tileID.canonical.x-(o.canonical.x+Z<<-A)),U=s.V*(h.tileID.canonical.y-(o.canonical.y<<-A))),s.a6.ortho(I,0,D,0,D,0,1),s.a6.translate(I,I,[N,U,0])}return new Bn(h.tileID,o.key,I)}_findTileCoveringTileID(o,h){let x=h.getTile(o);if(x&&x.hasData())return x;const I=this._findCoveringTileCache[h.id],A=I[o.key];if(x=A?h.getTileByID(A):null,x&&x.hasData()||A===null)return x;let D=x?x.tileID:o,N=D.overscaledZ;const U=h.getSource().minzoom,Z=[];if(!A){const ee=h.getSource().maxzoom;if(o.canonical.z>=ee){const ae=o.canonical.z-ee;h.getSource().reparseOverscaled?(N=Math.max(o.canonical.z+2,h.transform.tileZoom),D=new s.am(N,o.wrap,ee,o.canonical.x>>ae,o.canonical.y>>ae)):ae!==0&&(N=ee,D=new s.am(N,o.wrap,ee,o.canonical.x>>ae,o.canonical.y>>ae))}D.key!==o.key&&(Z.push(D.key),x=h.getTile(D))}const J=ee=>{Z.forEach(ae=>{I[ae]=ee}),Z.length=0};for(N-=1;N>=U&&(!x||!x.hasData());N--){x&&J(x.tileID.key);const ee=D.calculateScaledKey(N);if(x=h.getTileByID(ee),x&&x.hasData())break;const ae=I[ee];if(ae===null)break;ae===void 0?Z.push(ee):x=h.getTileByID(ae)}return J(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let x=this._tilesDirty[o];x||(x=this._tilesDirty[o]={}),x[h.key]=!0}}function As(_,o,h){const x=function(N,U,Z){const J=s.N.dot(U,N),ee=s.N.dot(Z,[.2126,.7152,.0722]),ae=(we,xe,Ce)=>(1-Ce)*we+Ce*xe,he=ae(1-.3*Math.min(ee,1),1,Math.min(J+1,1));return ae(.92,1,Math.asin(s.aa(U[2],-1,1))/Math.PI+.5)*he}(_,[0,0,1],o),I=[0,0,0];s.N.scale(I,h.slice(0,3),x);const A=[0,0,0];s.N.scale(A,o.slice(0,3),_[2]);const D=[0,0,0];return s.N.add(D,I,A),s.bU(D)}const Nl=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],_s=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Ql{static cacheKey(o,h,x,I){let A=`${h}${I?I.cacheKey:""}`;for(const D of x)o.usedDefines.includes(D)&&(A+=`/${D}`);return A}constructor(o,h,x,I,A,D,N){const U=o.gl;this.program=U.createProgram(),this.configuration=I,this.name=h,this.fixedDefines=[...D];const Z=I?I.getBinderAttributes():[],J=(x.staticAttributes||[]).concat(Z);let ee=I?I.defines():[];ee=ee.concat(D.map(ge=>`#define ${ge}`));const ae=`#version 300 es
`;let he=ae+ee.concat("precision mediump float;",Ls,xl.fragmentSource).join(`
`);for(const ge of x.fragmentIncludes)he+=`
${Ys[ge]}`;he+=`
${x.fragmentSource}`;let we=ae+ee.concat("precision highp float;",Ls,xl.vertexSource).join(`
`);for(const ge of x.vertexIncludes)we+=`
${Ys[ge]}`;we+=`
${x.vertexSource}`;const xe=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(xe,he),U.compileShader(xe),U.attachShader(this.program,xe);const Ce=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())this.failedToCreate=!0;else{U.shaderSource(Ce,we),U.compileShader(Ce),U.attachShader(this.program,Ce),this.attributes={},this.numAttributes=J.length;for(let ge=0;ge<this.numAttributes;ge++)if(J[ge]){const De=J[ge].startsWith("a_")?J[ge]:`a_${J[ge]}`;U.bindAttribLocation(this.program,ge,De),this.attributes[De]=ge}N&&N.shaderVaryings.length>0&&U.transformFeedbackVaryings(this.program,N.shaderVaryings,N.bufferMode),U.linkProgram(this.program),U.deleteShader(Ce),U.deleteShader(xe),this.fixedUniforms=A(o),this.binderUniforms=I?I.getUniforms(o):[],D.includes("TERRAIN")&&(this.terrainUniforms=(ge=>({u_dem:new s.bO(ge),u_dem_prev:new s.bO(ge),u_dem_tl:new s.bL(ge),u_dem_scale:new s.bN(ge),u_dem_tl_prev:new s.bL(ge),u_dem_scale_prev:new s.bN(ge),u_dem_size:new s.bN(ge),u_dem_lerp:new s.bN(ge),u_exaggeration:new s.bN(ge),u_depth:new s.bO(ge),u_depth_size_inv:new s.bL(ge),u_meter_to_dem:new s.bN(ge),u_label_plane_matrix_inv:new s.bK(ge)}))(o)),D.includes("GLOBE")&&(this.globeUniforms=(ge=>({u_tile_tl_up:new s.bM(ge),u_tile_tr_up:new s.bM(ge),u_tile_br_up:new s.bM(ge),u_tile_bl_up:new s.bM(ge),u_tile_up_scale:new s.bN(ge)}))(o)),D.includes("FOG")&&(this.fogUniforms=(ge=>({u_fog_matrix:new s.bK(ge),u_fog_range:new s.bL(ge),u_fog_color:new s.bP(ge),u_fog_horizon_blend:new s.bN(ge),u_fog_vertical_limit:new s.bL(ge),u_fog_temporal_offset:new s.bN(ge),u_frustum_tl:new s.bM(ge),u_frustum_tr:new s.bM(ge),u_frustum_br:new s.bM(ge),u_frustum_bl:new s.bM(ge),u_globe_pos:new s.bM(ge),u_globe_radius:new s.bN(ge),u_globe_transition:new s.bN(ge),u_is_globe:new s.bO(ge),u_viewport:new s.bL(ge)}))(o)),D.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ge=>({u_cutoff_params:new s.bP(ge)}))(o)),D.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ge=>({u_lighting_ambient_color:new s.bM(ge),u_lighting_directional_dir:new s.bM(ge),u_lighting_directional_color:new s.bM(ge),u_ground_radiance:new s.bM(ge)}))(o)),D.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ge=>({u_light_matrix_0:new s.bK(ge),u_light_matrix_1:new s.bK(ge),u_fade_range:new s.bL(ge),u_shadow_normal_offset:new s.bM(ge),u_shadow_intensity:new s.bN(ge),u_shadow_texel_size:new s.bN(ge),u_shadow_map_resolution:new s.bN(ge),u_shadow_direction:new s.bM(ge),u_shadow_bias:new s.bM(ge),u_shadowmap_0:new s.bO(ge),u_shadowmap_1:new s.bO(ge)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const I in h)x[I]&&x[I].set(this.program,I,h[I])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const I in h)x[I]&&x[I].set(this.program,I,h[I])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const I in h)x[I].set(this.program,I,h[I])}}setCutoffUniformValues(o,h){if(!this.cutoffUniforms)return;const x=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const I in h)x[I].set(this.program,I,h[I])}}setLightsUniformValues(o,h){if(!this.lightsUniforms)return;const x=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const I in h)x[I].set(this.program,I,h[I])}}setShadowUniformValues(o,h){if(this.failedToCreate||!this.shadowUniforms)return;const x=this.shadowUniforms;o.program.set(this.program);for(const I in h)x[I].set(this.program,I,h[I])}_drawDebugWireframe(o,h,x,I,A,D,N,U,Z,J){const ee=o.options.wireframe;if(ee.terrain===!1&&ee.layers2D===!1&&ee.layers3D===!1)return;const ae=o.context;if(!(()=>!(!ee.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ee.layers2D||o._terrain&&o._terrain.renderingToTexture||!Nl.includes(this.name))||!(!ee.layers3D||!_s.includes(this.name)))())return;const he=ae.gl,we=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,A,ae);if(!we)return;const xe=[...this.fixedDefines];xe.push("DEBUG_WIREFRAME");const Ce=o.getOrCreateProgram(this.name,{config:this.configuration,defines:xe});ae.program.set(Ce.program);const ge=(Be,We,Pe)=>{if(We[Be]&&Pe[Be])for(const Ke in We[Be])Pe[Be][Ke]&&Pe[Be][Ke].set(Pe.program,Ke,We[Be][Ke].current)};Z&&Z.setUniforms(Ce.program,ae,Ce.binderUniforms,N,{zoom:U}),ge("fixedUniforms",this,Ce),ge("terrainUniforms",this,Ce),ge("globeUniforms",this,Ce),ge("fogUniforms",this,Ce),ge("lightsUniforms",this,Ce),ge("shadowUniforms",this,Ce),we.bind(),ae.setColorMode(new Fi([he.ONE,he.ONE_MINUS_SRC_ALPHA,he.ZERO,he.ONE],s.ax.transparent,[!0,!0,!0,!1])),ae.setDepthMode(new Un(h.func===he.LESS?he.LEQUAL:h.func,Un.ReadOnly,h.range)),ae.setStencilMode(ui.disabled);const De=3*D.primitiveLength*2,Xe=3*D.primitiveOffset*2*2;J&&J>1?he.drawElementsInstanced(he.LINES,De,he.UNSIGNED_SHORT,Xe,J):he.drawElements(he.LINES,De,he.UNSIGNED_SHORT,Xe),A.bind(),ae.program.set(this.program),ae.setDepthMode(h),ae.setStencilMode(x),ae.setColorMode(I)}draw(o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge){const De=o.context,Xe=De.gl;if(this.failedToCreate)return;De.program.set(this.program),De.setDepthMode(x),De.setStencilMode(I),De.setColorMode(A),De.setCullFace(D);for(const Ke of Object.keys(this.fixedUniforms))this.fixedUniforms[Ke].set(this.program,Ke,N[Ke]);we&&we.setUniforms(this.program,De,this.binderUniforms,ae,{zoom:he});const Be={[Xe.POINTS]:1,[Xe.LINES]:2,[Xe.TRIANGLES]:3,[Xe.LINE_STRIP]:1}[h],We=ge&&ge.length>0;if(We){for(const Ke of ge)Xe.bindBufferBase(Xe.TRANSFORM_FEEDBACK_BUFFER,Ke.targetIndex,Ke.buffer.buffer);Xe.beginTransformFeedback(h)}const Pe=Ce&&Ce>0?1:void 0;for(const Ke of ee.get()){const st=Ke.vaos||(Ke.vaos={});(st[U]||(st[U]=new yc)).bind(De,this,Z,we?we.getPaintVertexBuffers():[],J,Ke.vertexOffset,xe||[],Pe),Ce&&Ce>1?Xe.drawElementsInstanced(h,Ke.primitiveLength*Be,Xe.UNSIGNED_SHORT,Ke.primitiveOffset*Be*2,Ce):J?Xe.drawElements(h,Ke.primitiveLength*Be,Xe.UNSIGNED_SHORT,Ke.primitiveOffset*Be*2):Xe.drawArrays(h,Ke.vertexOffset,Ke.vertexLength),h===Xe.TRIANGLES&&J&&this._drawDebugWireframe(o,x,I,A,J,Ke,ae,he,we,Ce)}We&&Xe.endTransformFeedback()}}function cp(_,o){const h=Math.pow(2,o.tileID.overscaledZ),x=o.tileSize*Math.pow(2,_.transform.tileZoom)/h,I=x*(o.tileID.canonical.x+o.tileID.wrap*h),A=x*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.a3(o,1,_.transform.tileZoom),u_pixel_coord_upper:[I>>16,A>>16],u_pixel_coord_lower:[65535&I,65535&A]}}const up=s.a6.create(),Mo=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe)=>{const Ce=o.style.light,ge=Ce.properties.get("position"),De=[ge.x,ge.y,ge.z],Xe=s.co.create();Ce.properties.get("anchor")==="viewport"&&(s.co.fromRotation(Xe,-o.transform.angle),s.N.transformMat3(De,De,Xe));const Be=Ce.properties.get("color"),We=o.transform,Pe={u_matrix:_,u_lightpos:De,u_lightintensity:Ce.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_vertical_gradient:+h,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:up,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:I,u_edge_radius:A,u_flood_light_color:ee,u_vertical_scale:ae,u_flood_light_intensity:he,u_ground_shadow_factor:we,u_emissive_strength:xe};return We.projection.name==="globe"&&(Pe.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Pe.u_zoom_transition=U,Pe.u_inv_rot_matrix=J,Pe.u_merc_center=Z,Pe.u_up_dir=We.projection.upVector(new s.bs(0,0,0),Z[0]*s.V,Z[1]*s.V),Pe.u_height_lift=N),Pe},Ya=(_,o,h)=>({u_matrix:_,u_edge_radius:o,u_vertical_scale:h}),Wu=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he)=>{const we=Mo(_,o,h,x,I,A,D,U,Z,J,ee,ae,he,1,[0,0,0],0),xe={u_height_factor:-Math.pow(2,D.overscaledZ)/N.tileSize/8};return s.e(we,cp(o,N),xe)},ec=(_,o)=>({u_matrix:_,u_emissive_strength:o}),hp=(_,o,h,x)=>s.e(ec(_,o),cp(h,x)),ll=(_,o,h)=>({u_matrix:_,u_world:h,u_emissive_strength:o}),cl=(_,o,h,x,I)=>s.e(hp(_,o,h,x),{u_world:I}),_u=(_,o,h,x)=>{const I=s.V/h.tileSize;return{u_matrix:_,u_camera_to_center_distance:o.getCameraToCenterDistance(x),u_extrude_scale:[o.pixelsToGLUnits[0]/I,o.pixelsToGLUnits[1]/I]}},tc=(_,o,h=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:h}),dp=s.a6.create(),Hu=(_,o,h,x,I,A,D)=>{const N=_.transform,U=N.projection.name==="globe",Z=U?s.cp(N.zoom,o.canonical)*N._pixelsPerMercatorPixel:s.a3(h,1,A),J={u_matrix:o.projMatrix,u_extrude_scale:Z,u_intensity:D,u_inv_rot_matrix:dp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){J.u_inv_rot_matrix=x,J.u_merc_center=I,J.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],J.u_zoom_transition=s.S(N.zoom);const ee=I[0]*s.V,ae=I[1]*s.V;J.u_up_dir=N.projection.upVector(new s.bs(0,0,0),ee,ae)}return J};function Zu(_,[o,h,x,I],[A,D]){if(A===D)return[0,0,0,0];const N=255*(_-1)/(_*(D-A));return[o*N,h*N,x*N,I*N]}function ef(_,o,[h,x]){return h===x?0:.5/_+(o-h)*(_-1)/(_*(x-h))}const Xu=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge,De,Xe,Be)=>{return{u_matrix:_,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:x,u_grid_matrix:I,u_tl_parent:A,u_scale_parent:Z,u_fade_t:J.mix,u_opacity:J.opacity*ee.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ee.paint.get("raster-brightness-min"),u_brightness_high:ee.paint.get("raster-brightness-max"),u_saturation_factor:(Pe=ee.paint.get("raster-saturation"),Pe>0?1-1/(1.001-Pe):-Pe),u_contrast_factor:(We=ee.paint.get("raster-contrast"),We>0?1/(1-We):1+We),u_spin_weights:vc(ee.paint.get("raster-hue-rotate")),u_perspective_transform:ae,u_raster_elevation:he,u_zoom_transition:D,u_merc_center:N,u_cutoff_params:U,u_colorization_mix:Zu(s.cq,xe,ge),u_colorization_offset:ef(s.cq,Ce,ge),u_color_ramp:we,u_texture_offset:[Xe/(De+2*Xe),De/(De+2*Xe)],u_texture_res:[De+2*Xe,De+2*Xe],u_emissive_strength:Be};var We,Pe};function vc(_){_*=Math.PI/180;const o=Math.sin(_),h=Math.cos(_);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const Ff=(_,o,h,x,I,A,D,N,U,Z,J,ee)=>({u_matrix:_,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:x,u_grid_matrix:I,u_tl_parent:A,u_scale_parent:Z,u_fade_t:J.mix,u_opacity:J.opacity,u_image0:0,u_image1:1,u_raster_elevation:ee,u_zoom_transition:D,u_merc_center:N,u_cutoff_params:U}),Yu=(_,o,h,x,I,A,D,N)=>({u_tile_offset:_,u_velocity:o,u_color_ramp:x,u_velocity_res:h,u_max_speed:I,u_texture_offset:A,u_data_scale:D,u_data_offset:N}),yu=(_,o,h,x,I,A,D,N)=>({u_velocity:_,u_velocity_res:o,u_max_speed:h,u_speed_factor:x,u_lifetime_delta:I,u_rand_seed:Math.random(),u_texture_offset:A,u_data_scale:D,u_data_offset:N}),pp=s.a6.create(),xc=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge)=>{const De=I.transform,Xe={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:De.getCameraToCenterDistance(xe),u_rotate_symbol:+h,u_aspect_ratio:De.width/De.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:D,u_coord_matrix:N,u_is_text:+U,u_pitch_with_map:+x,u_texsize:Z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:pp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:pp,u_up_vector:[0,-1,0],u_icon_transition:ge||0,u_icon_saturation:Ce};return xe.name==="globe"&&(Xe.u_tile_id=[J.canonical.x,J.canonical.y,1<<J.canonical.z],Xe.u_zoom_transition=ee,Xe.u_inv_rot_matrix=he,Xe.u_merc_center=ae,Xe.u_camera_forward=De._camera.forward(),Xe.u_ecef_origin=s.cr(De.globeMatrix,J.toUnwrapped()),Xe.u_tile_matrix=Float32Array.from(De.globeMatrix),Xe.u_up_vector=we),Xe},Js=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce)=>s.e(xc(_,o,h,x,I,A,D,N,U,Z,ee,ae,he,we,xe,Ce,1),{u_gamma_scale:x?I.transform.getCameraToCenterDistance(Ce)*Math.cos(I.terrain?0:I.transform._pitch):1,u_device_pixel_ratio:s.f.devicePixelRatio,u_is_halo:+J,undefined:void 0}),bd=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe)=>s.e(Js(_,o,h,x,I,A,D,N,!0,U,!0,J,ee,ae,he,we,xe),{u_texsize_icon:Z,u_texture_icon:1}),Ih=(_,o,h,x)=>({u_matrix:_,u_emissive_strength:o,u_opacity:h,u_color:x}),Ch=(_,o,h,x,I,A,D)=>s.e(function(N,U,Z,J){const ee=Z.imageManager.getPattern(N.toString(),U),{width:ae,height:he}=Z.imageManager.getPixelSize(U),we=Math.pow(2,J.tileID.overscaledZ),xe=J.tileSize*Math.pow(2,Z.transform.tileZoom)/we,Ce=xe*(J.tileID.canonical.x+J.tileID.wrap*we),ge=xe*J.tileID.canonical.y;return{u_image:0,u_pattern_tl:ee.tl,u_pattern_br:ee.br,u_texsize:[ae,he],u_pattern_size:ee.displaySize,u_tile_units_to_pixels:1/s.a3(J,1,Z.transform.tileZoom),u_pixel_coord_upper:[Ce>>16,ge>>16],u_pixel_coord_lower:[65535&Ce,65535&ge]}}(I,A,x,D),{u_matrix:_,u_emissive_strength:o,u_opacity:h}),Ah=(_,o,h,x,I,A,D,N,U,Z,J,ee,ae=[0,0,0],he)=>{const we=x.style.light,xe=we.properties.get("position"),Ce=[-xe.x,-xe.y,xe.z],ge=s.co.create();we.properties.get("anchor")==="viewport"&&(s.co.fromRotation(ge,-x.transform.angle),s.N.transformMat3(Ce,Ce,ge));const De=Z.alphaMode==="MASK",Xe=we.properties.get("color"),Be=ee.paint.get("model-ambient-occlusion-intensity"),We=ee.paint.get("model-color").constantOr(s.ax.white),Pe=ee.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:_,u_lighting_matrix:o,u_normal_matrix:h,u_lightpos:Ce,u_lightintensity:we.properties.get("intensity"),u_lightcolor:[Xe.r,Xe.g,Xe.b],u_camera_pos:ae,u_opacity:I,u_baseTextureIsAlpha:0,u_alphaMask:+De,u_alphaCutoff:Z.alphaCutoff,u_baseColorFactor:[A.r,A.g,A.b,A.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:N,u_roughnessFactor:U,u_baseColorTexture:Aa.BaseColor,u_metallicRoughnessTexture:Aa.MetallicRoughness,u_normalTexture:Aa.Normal,u_occlusionTexture:Aa.Occlusion,u_emissionTexture:Aa.Emission,u_color_mix:[We.r,We.g,We.b,Pe],u_aoIntensity:Be,u_emissive_strength:J,u_occlusionTextureTransform:he||[0,0,0,0]}},S=new Float32Array(16),E=(_,o=S,h=S)=>({u_matrix:_,u_instance:o,u_node_matrix:h}),T={fillExtrusion:_=>({u_matrix:new s.bK(_),u_lightpos:new s.bM(_),u_lightintensity:new s.bN(_),u_lightcolor:new s.bM(_),u_vertical_gradient:new s.bN(_),u_opacity:new s.bN(_),u_edge_radius:new s.bN(_),u_ao:new s.bL(_),u_tile_id:new s.bM(_),u_zoom_transition:new s.bN(_),u_inv_rot_matrix:new s.bK(_),u_merc_center:new s.bL(_),u_up_dir:new s.bM(_),u_height_lift:new s.bN(_),u_flood_light_color:new s.bM(_),u_vertical_scale:new s.bN(_),u_flood_light_intensity:new s.bN(_),u_ground_shadow_factor:new s.bM(_),u_emissive_strength:new s.bN(_)}),fillExtrusionDepth:_=>({u_matrix:new s.bK(_),u_edge_radius:new s.bN(_),u_vertical_scale:new s.bN(_)}),fillExtrusionPattern:_=>({u_matrix:new s.bK(_),u_lightpos:new s.bM(_),u_lightintensity:new s.bN(_),u_lightcolor:new s.bM(_),u_vertical_gradient:new s.bN(_),u_height_factor:new s.bN(_),u_edge_radius:new s.bN(_),u_ao:new s.bL(_),u_tile_id:new s.bM(_),u_zoom_transition:new s.bN(_),u_inv_rot_matrix:new s.bK(_),u_merc_center:new s.bL(_),u_up_dir:new s.bM(_),u_height_lift:new s.bN(_),u_image:new s.bO(_),u_texsize:new s.bL(_),u_pixel_coord_upper:new s.bL(_),u_pixel_coord_lower:new s.bL(_),u_tile_units_to_pixels:new s.bN(_),u_opacity:new s.bN(_)}),fillExtrusionGroundEffect:_=>({u_matrix:new s.bK(_),u_opacity:new s.bN(_),u_ao_pass:new s.bN(_),u_meter_to_tile:new s.bN(_),u_ao:new s.bL(_),u_flood_light_intensity:new s.bN(_),u_flood_light_color:new s.bM(_),u_attenuation:new s.bN(_),u_edge_radius:new s.bN(_),u_fb:new s.bO(_),u_fb_size:new s.bN(_)}),fill:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_)}),fillPattern:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_),u_image:new s.bO(_),u_texsize:new s.bL(_),u_pixel_coord_upper:new s.bL(_),u_pixel_coord_lower:new s.bL(_),u_tile_units_to_pixels:new s.bN(_)}),fillOutline:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_),u_world:new s.bL(_)}),fillOutlinePattern:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_),u_world:new s.bL(_),u_image:new s.bO(_),u_texsize:new s.bL(_),u_pixel_coord_upper:new s.bL(_),u_pixel_coord_lower:new s.bL(_),u_tile_units_to_pixels:new s.bN(_)}),circle:s.cs,collisionBox:_=>({u_matrix:new s.bK(_),u_camera_to_center_distance:new s.bN(_),u_extrude_scale:new s.bL(_)}),collisionCircle:_=>({u_matrix:new s.bK(_),u_inv_matrix:new s.bK(_),u_camera_to_center_distance:new s.bN(_),u_viewport_size:new s.bL(_)}),debug:_=>({u_color:new s.ca(_),u_matrix:new s.bK(_),u_overlay:new s.bO(_),u_overlay_scale:new s.bN(_)}),clippingMask:_=>({u_matrix:new s.bK(_)}),heatmap:_=>({u_extrude_scale:new s.bN(_),u_intensity:new s.bN(_),u_matrix:new s.bK(_),u_inv_rot_matrix:new s.bK(_),u_merc_center:new s.bL(_),u_tile_id:new s.bM(_),u_zoom_transition:new s.bN(_),u_up_dir:new s.bM(_)}),heatmapTexture:_=>({u_image:new s.bO(_),u_color_ramp:new s.bO(_),u_opacity:new s.bN(_)}),hillshade:_=>({u_matrix:new s.bK(_),u_image:new s.bO(_),u_latrange:new s.bL(_),u_light:new s.bL(_),u_shadow:new s.ca(_),u_highlight:new s.ca(_),u_emissive_strength:new s.bN(_),u_accent:new s.ca(_)}),hillshadePrepare:_=>({u_matrix:new s.bK(_),u_image:new s.bO(_),u_dimension:new s.bL(_),u_zoom:new s.bN(_)}),line:s.ct,linePattern:s.cu,raster:_=>({u_matrix:new s.bK(_),u_normalize_matrix:new s.bK(_),u_globe_matrix:new s.bK(_),u_merc_matrix:new s.bK(_),u_grid_matrix:new s.cb(_),u_tl_parent:new s.bL(_),u_scale_parent:new s.bN(_),u_fade_t:new s.bN(_),u_opacity:new s.bN(_),u_image0:new s.bO(_),u_image1:new s.bO(_),u_brightness_low:new s.bN(_),u_brightness_high:new s.bN(_),u_saturation_factor:new s.bN(_),u_contrast_factor:new s.bN(_),u_spin_weights:new s.bM(_),u_perspective_transform:new s.bL(_),u_raster_elevation:new s.bN(_),u_zoom_transition:new s.bN(_),u_merc_center:new s.bL(_),u_cutoff_params:new s.bP(_),u_colorization_mix:new s.bP(_),u_colorization_offset:new s.bN(_),u_color_ramp:new s.bO(_),u_texture_offset:new s.bL(_),u_texture_res:new s.bL(_),u_emissive_strength:new s.bN(_)}),rasterParticle:_=>({u_matrix:new s.bK(_),u_normalize_matrix:new s.bK(_),u_globe_matrix:new s.bK(_),u_merc_matrix:new s.bK(_),u_grid_matrix:new s.cb(_),u_tl_parent:new s.bL(_),u_scale_parent:new s.bN(_),u_fade_t:new s.bN(_),u_opacity:new s.bN(_),u_image0:new s.bO(_),u_image1:new s.bO(_),u_raster_elevation:new s.bN(_),u_zoom_transition:new s.bN(_),u_merc_center:new s.bL(_),u_cutoff_params:new s.bP(_)}),rasterParticleTexture:_=>({u_texture:new s.bO(_),u_opacity:new s.bN(_)}),rasterParticleDraw:_=>({u_tile_offset:new s.bL(_),u_velocity:new s.bO(_),u_color_ramp:new s.bO(_),u_velocity_res:new s.bL(_),u_max_speed:new s.bN(_),u_texture_offset:new s.bL(_),u_data_scale:new s.bP(_),u_data_offset:new s.bN(_)}),rasterParticleUpdate:_=>({u_velocity:new s.bO(_),u_velocity_res:new s.bL(_),u_max_speed:new s.bN(_),u_speed_factor:new s.bN(_),u_lifetime_delta:new s.bN(_),u_rand_seed:new s.bN(_),u_texture_offset:new s.bL(_),u_data_scale:new s.bP(_),u_data_offset:new s.bN(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new s.bO(_),u_is_size_feature_constant:new s.bO(_),u_size_t:new s.bN(_),u_size:new s.bN(_),u_camera_to_center_distance:new s.bN(_),u_rotate_symbol:new s.bO(_),u_aspect_ratio:new s.bN(_),u_fade_change:new s.bN(_),u_matrix:new s.bK(_),u_label_plane_matrix:new s.bK(_),u_coord_matrix:new s.bK(_),u_is_text:new s.bO(_),u_pitch_with_map:new s.bO(_),u_texsize:new s.bL(_),u_tile_id:new s.bM(_),u_zoom_transition:new s.bN(_),u_inv_rot_matrix:new s.bK(_),u_merc_center:new s.bL(_),u_camera_forward:new s.bM(_),u_tile_matrix:new s.bK(_),u_up_vector:new s.bM(_),u_ecef_origin:new s.bM(_),u_texture:new s.bO(_),u_icon_transition:new s.bN(_),u_icon_saturation:new s.bN(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new s.bO(_),u_is_size_feature_constant:new s.bO(_),u_size_t:new s.bN(_),u_size:new s.bN(_),u_camera_to_center_distance:new s.bN(_),u_rotate_symbol:new s.bO(_),u_aspect_ratio:new s.bN(_),u_fade_change:new s.bN(_),u_matrix:new s.bK(_),u_label_plane_matrix:new s.bK(_),u_coord_matrix:new s.bK(_),u_is_text:new s.bO(_),u_pitch_with_map:new s.bO(_),u_texsize:new s.bL(_),u_texture:new s.bO(_),u_gamma_scale:new s.bN(_),u_device_pixel_ratio:new s.bN(_),u_tile_id:new s.bM(_),u_zoom_transition:new s.bN(_),u_inv_rot_matrix:new s.bK(_),u_merc_center:new s.bL(_),u_camera_forward:new s.bM(_),u_tile_matrix:new s.bK(_),u_up_vector:new s.bM(_),u_ecef_origin:new s.bM(_),u_is_halo:new s.bO(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new s.bO(_),u_is_size_feature_constant:new s.bO(_),u_size_t:new s.bN(_),u_size:new s.bN(_),u_camera_to_center_distance:new s.bN(_),u_rotate_symbol:new s.bO(_),u_aspect_ratio:new s.bN(_),u_fade_change:new s.bN(_),u_matrix:new s.bK(_),u_label_plane_matrix:new s.bK(_),u_coord_matrix:new s.bK(_),u_is_text:new s.bO(_),u_pitch_with_map:new s.bO(_),u_texsize:new s.bL(_),u_texsize_icon:new s.bL(_),u_texture:new s.bO(_),u_texture_icon:new s.bO(_),u_gamma_scale:new s.bN(_),u_device_pixel_ratio:new s.bN(_),u_is_halo:new s.bO(_)}),background:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_),u_opacity:new s.bN(_),u_color:new s.ca(_)}),backgroundPattern:_=>({u_matrix:new s.bK(_),u_emissive_strength:new s.bN(_),u_opacity:new s.bN(_),u_image:new s.bO(_),u_pattern_tl:new s.bL(_),u_pattern_br:new s.bL(_),u_texsize:new s.bL(_),u_pattern_size:new s.bL(_),u_pixel_coord_upper:new s.bL(_),u_pixel_coord_lower:new s.bL(_),u_tile_units_to_pixels:new s.bN(_)}),terrainRaster:Jl,terrainDepth:Jl,skybox:_=>({u_matrix:new s.bK(_),u_sun_direction:new s.bM(_),u_cubemap:new s.bO(_),u_opacity:new s.bN(_),u_temporal_offset:new s.bN(_)}),skyboxGradient:_=>({u_matrix:new s.bK(_),u_color_ramp:new s.bO(_),u_center_direction:new s.bM(_),u_radius:new s.bN(_),u_opacity:new s.bN(_),u_temporal_offset:new s.bN(_)}),skyboxCapture:_=>({u_matrix_3f:new s.cb(_),u_sun_direction:new s.bM(_),u_sun_intensity:new s.bN(_),u_color_tint_r:new s.bP(_),u_color_tint_m:new s.bP(_),u_luminance:new s.bN(_)}),globeRaster:_=>({u_proj_matrix:new s.bK(_),u_globe_matrix:new s.bK(_),u_normalize_matrix:new s.bK(_),u_merc_matrix:new s.bK(_),u_zoom_transition:new s.bN(_),u_merc_center:new s.bL(_),u_image0:new s.bO(_),u_grid_matrix:new s.cb(_),u_skirt_height:new s.bN(_),u_far_z_cutoff:new s.bN(_),u_frustum_tl:new s.bM(_),u_frustum_tr:new s.bM(_),u_frustum_br:new s.bM(_),u_frustum_bl:new s.bM(_),u_globe_pos:new s.bM(_),u_globe_radius:new s.bN(_),u_viewport:new s.bL(_)}),globeAtmosphere:_=>({u_frustum_tl:new s.bM(_),u_frustum_tr:new s.bM(_),u_frustum_br:new s.bM(_),u_frustum_bl:new s.bM(_),u_horizon:new s.bN(_),u_transition:new s.bN(_),u_fadeout_range:new s.bN(_),u_color:new s.bP(_),u_high_color:new s.bP(_),u_space_color:new s.bP(_),u_temporal_offset:new s.bN(_),u_horizon_angle:new s.bN(_)}),model:_=>({u_matrix:new s.bK(_),u_lighting_matrix:new s.bK(_),u_normal_matrix:new s.bK(_),u_lightpos:new s.bM(_),u_lightintensity:new s.bN(_),u_lightcolor:new s.bM(_),u_camera_pos:new s.bM(_),u_opacity:new s.bN(_),u_baseColorFactor:new s.bP(_),u_emissiveFactor:new s.bP(_),u_metallicFactor:new s.bN(_),u_roughnessFactor:new s.bN(_),u_baseTextureIsAlpha:new s.bO(_),u_alphaMask:new s.bO(_),u_alphaCutoff:new s.bN(_),u_baseColorTexture:new s.bO(_),u_metallicRoughnessTexture:new s.bO(_),u_normalTexture:new s.bO(_),u_occlusionTexture:new s.bO(_),u_emissionTexture:new s.bO(_),u_color_mix:new s.bP(_),u_aoIntensity:new s.bN(_),u_emissive_strength:new s.bN(_),u_occlusionTextureTransform:new s.bP(_)}),modelDepth:_=>({u_matrix:new s.bK(_),u_instance:new s.bK(_),u_node_matrix:new s.bK(_)}),groundShadow:_=>({u_matrix:new s.bK(_),u_ground_shadow_factor:new s.bM(_)}),stars:_=>({u_matrix:new s.bK(_),u_up:new s.bM(_),u_right:new s.bM(_),u_intensity_multiplier:new s.bN(_)})};let M;function B(_,o,h,x,I,A,D){const N=_.context,U=N.gl,Z=_.transform,J=_.getOrCreateProgram("collisionBox"),ee=[];let ae=0,he=0;for(let Be=0;Be<x.length;Be++){const We=x[Be],Pe=o.getTile(We),Ke=Pe.getBucket(h);if(!Ke)continue;const st=Wp(We,Ke,Z);let pt=st;I[0]===0&&I[1]===0||(pt=_.translatePosMatrix(st,Pe,I,A));const Tt=D?Ke.textCollisionBox:Ke.iconCollisionBox,Zt=Ke.collisionCircleArray;if(Zt.length>0){const xt=s.a6.create(),hr=pt;s.a6.mul(xt,Ke.placementInvProjMatrix,Z.glCoordMatrix),s.a6.mul(xt,xt,Ke.placementViewportMatrix),ee.push({circleArray:Zt,circleOffset:he,transform:hr,invTransform:xt,projection:Ke.getProjection()}),ae+=Zt.length/4,he=ae}Tt&&(_.terrain&&_.terrain.setupElevationDraw(Pe,J),J.draw(_,U.LINES,Un.disabled,ui.disabled,_.colorModeForRenderPass(),Dn.disabled,_u(pt,Z,Pe,Ke.getProjection()),h.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,null,Z.zoom,null,[Tt.collisionVertexBuffer,Tt.collisionVertexBufferExt]))}if(!D||!ee.length)return;const we=_.getOrCreateProgram("collisionCircle"),xe=new s.cv;xe.resize(4*ae),xe._trim();let Ce=0;for(const Be of ee)for(let We=0;We<Be.circleArray.length/4;We++){const Pe=4*We,Ke=Be.circleArray[Pe+0],st=Be.circleArray[Pe+1],pt=Be.circleArray[Pe+2],Tt=Be.circleArray[Pe+3];xe.emplace(Ce++,Ke,st,pt,Tt,0),xe.emplace(Ce++,Ke,st,pt,Tt,1),xe.emplace(Ce++,Ke,st,pt,Tt,2),xe.emplace(Ce++,Ke,st,pt,Tt,3)}(!M||M.length<2*ae)&&(M=function(Be){const We=2*Be,Pe=new s.aw;Pe.resize(We),Pe._trim();for(let Ke=0;Ke<We;Ke++){const st=6*Ke;Pe.uint16[st+0]=4*Ke+0,Pe.uint16[st+1]=4*Ke+1,Pe.uint16[st+2]=4*Ke+2,Pe.uint16[st+3]=4*Ke+2,Pe.uint16[st+4]=4*Ke+3,Pe.uint16[st+5]=4*Ke+0}return Pe}(ae));const ge=N.createIndexBuffer(M,!0),De=N.createVertexBuffer(xe,s.cw.members,!0);for(const Be of ee){const We={u_matrix:Be.transform,u_inv_matrix:Be.invTransform,u_camera_to_center_distance:(Xe=Z).getCameraToCenterDistance(Be.projection),u_viewport_size:[Xe.width,Xe.height]};we.draw(_,U.TRIANGLES,Un.disabled,ui.disabled,_.colorModeForRenderPass(),Dn.disabled,We,h.id,De,ge,s.aB.simpleSegment(0,2*Be.circleOffset,Be.circleArray.length,Be.circleArray.length/2),null,Z.zoom)}var Xe;De.destroy(),ge.destroy()}const W=s.a6.create();function Y(_){const o=_._camera.getWorldToCamera(_.worldSize,1),h=s.a6.multiply([],o,_.globeMatrix);s.a6.invert(h,h);const x=[0,0,0],I=[0,1,0,0];return s.a7.transformMat4(I,I,h),x[0]=I[0],x[1]=I[1],x[2]=I[2],s.N.normalize(x,x),x}function re({width:_,height:o,anchor:h,textOffset:x,textScale:I},A){const{horizontalAlign:D,verticalAlign:N}=s.bf(h),U=-(D-.5)*_,Z=-(N-.5)*o,J=s.bd(h,x);return new s.P((U/I+J[0])*A,(Z/I+J[1])*A)}function ye(_,o,h,x,I,A,D,N,U,Z,J){const ee=_.text.placedSymbolArray,ae=_.text.dynamicLayoutVertexArray,he=_.icon.dynamicLayoutVertexArray,we={},xe=_.getProjection(),Ce=cu(N,xe,A),ge=A.elevation,De=xe.upVectorScale(N.canonical,A.center.lat,A.worldSize).metersToTile;ae.clear();for(let Xe=0;Xe<ee.length;Xe++){const Be=ee.get(Xe),{tileAnchorX:We,tileAnchorY:Pe,numGlyphs:Ke}=Be,st=Be.hidden||!Be.crossTileID||_.allowVerticalPlacement&&!Be.placedOrientation?null:x[Be.crossTileID];if(st){let pt=0,Tt=0,Zt=0;if(ge){const Lr=ge?ge.getAtTileOffset(N,We,Pe):0,[Wr,Gr,tn]=xe.upVector(N.canonical,We,Pe);pt=Lr*Wr*De,Tt=Lr*Gr*De,Zt=Lr*tn*De}let[xt,hr,tr,Cr]=sl(Be.projectedAnchorX+pt,Be.projectedAnchorY+Tt,Be.projectedAnchorZ+Zt,h?Ce:D);const zt=jf(A.getCameraToCenterDistance(xe),Cr);let ir=I.evaluateSizeForFeature(_.textSizeData,Z,Be)*zt/s.bc;h&&(ir*=_.tilePixelRatio/U);const vt=re(st,ir);h?({x:xt,y:hr,z:tr}=xe.projectTilePoint(We+vt.x,Pe+vt.y,N.canonical),[xt,hr,tr]=sl(xt+pt,hr+Tt,tr+Zt,D)):(o&&vt._rotate(-A.angle),xt+=vt.x,hr+=vt.y,tr=0);const Ut=_.allowVerticalPlacement&&Be.placedOrientation===s.b6.vertical?Math.PI/2:0;for(let Lr=0;Lr<Ke;Lr++)s.b9(ae,xt,hr,tr,Ut);J&&Be.associatedIconIndex>=0&&(we[Be.associatedIconIndex]={x:xt,y:hr,z:tr,angle:Ut})}else Nc(Ke,ae)}if(J){he.clear();const Xe=_.icon.placedSymbolArray;for(let Be=0;Be<Xe.length;Be++){const We=Xe.get(Be),{numGlyphs:Pe}=We,Ke=we[Be];if(We.hidden||!Ke)Nc(Pe,he);else{const{x:st,y:pt,z:Tt,angle:Zt}=Ke;for(let xt=0;xt<Pe;xt++)s.b9(he,st,pt,Tt,Zt)}}_.icon.dynamicLayoutVertexBuffer.updateData(he)}_.text.dynamicLayoutVertexBuffer.updateData(ae)}function Ae(_,o,h,x,I,A,D={}){const N=h.paint.get("icon-translate"),U=h.paint.get("text-translate"),Z=h.paint.get("icon-translate-anchor"),J=h.paint.get("text-translate-anchor"),ee=h.layout.get("icon-rotation-alignment"),ae=h.layout.get("text-rotation-alignment"),he=h.layout.get("icon-pitch-alignment"),we=h.layout.get("text-pitch-alignment"),xe=h.layout.get("icon-keep-upright"),Ce=h.layout.get("text-keep-upright"),ge=h.paint.get("icon-color-saturation"),De=_.context,Xe=De.gl,Be=_.transform,We=ee==="map",Pe=ae==="map",Ke=he==="map",st=we==="map",pt=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Tt=!1;const Zt=_.depthModeForSublayer(0,Un.ReadOnly),xt=[s.a5(Be.center.lng),s.ae(Be.center.lat)],hr=h.layout.get("text-variable-anchor"),tr=Be.projection.name==="globe",Cr=[],zt=[0,-1,0];for(const ir of x){const vt=o.getTile(ir),Ut=vt.getBucket(h);if(!Ut||Ut.projection.name==="mercator"&&tr||Ut.fullyClipped)continue;const Lr=Ut.projection.name==="globe",Wr=Lr?s.S(Be.zoom):0,Gr=cu(ir,Ut.getProjection(),Be),tn=Be.calculatePixelsToTileUnitsMatrix(vt),_n=hr&&Ut.hasTextData(),Fn=Ut.hasIconTextFit()&&_n&&Ut.hasIconData(),wn=Ut.getProjection().createInversionMatrix(Be,ir.canonical),Sn=()=>{const Zo=We&&h.layout.get("symbol-placement")!=="point",fi=[],Ji=Zo||Fn,oi=h.paint.get("icon-image-cross-fade").constantOr(0);_.terrainRenderModeElevated()&&Ke&&fi.push("PITCH_WITH_MAP_TERRAIN"),Lr&&(fi.push("PROJECTION_GLOBE_VIEW"),Ji&&fi.push("PROJECTED_POS_ON_VIEWPORT")),oi>0&&fi.push("ICON_TRANSITION"),Ut.icon.zOffsetVertexBuffer&&fi.push("Z_OFFSET"),ge<1&&fi.push("SATURATION");const no=Ut.icon.programConfigurations.get(h.id),Bo=_.getOrCreateProgram(Ut.sdfIcons?"symbolSDF":"symbolIcon",{config:no,defines:fi});let ji;const vs=vt.imageAtlasTexture?vt.imageAtlasTexture.size:[0,0],js=Ut.iconSizeData,ac=s.b5(js,Be.zoom),bu=Ke||Be.pitch!==0,Sl=id(Gr,vt.tileID.canonical,Ke,We,Be,Ut.getProjection(),tn),ss=Nf(Gr,vt.tileID.canonical,Ke,We,Be,Ut.getProjection(),tn),ls=_.translatePosMatrix(ss,vt,N,Z,!0),ul=_.translatePosMatrix(Gr,vt,N,Z),Ps=Ji?W:Sl,Tl=We&&!Ke&&!Zo;let wu=zt;!tr&&!Be.mercatorFromTransition||We||(wu=Y(Be));const Oh=Lr?wu:zt;ji=Ut.sdfIcons&&!Ut.iconsInText?Js(js.kind,ac,Tl,Ke,_,ul,Ps,ls,!1,vs,!0,ir,Wr,xt,wn,Oh,Ut.getProjection()):xc(js.kind,ac,Tl,Ke,_,ul,Ps,ls,!1,vs,ir,Wr,xt,wn,Oh,Ut.getProjection(),ge,oi);const gp=vt.imageAtlasTexture?vt.imageAtlasTexture:null,of=h.layout.get("icon-size").constantOr(0)!==1||Ut.iconsNeedLinear,af=Ut.sdfIcons||_.options.rotating||_.options.zooming||of||bu?Xe.LINEAR:Xe.NEAREST,Jm=Ut.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,sf=_.terrain&&Ke&&Zo?s.a6.invert(s.a6.create(),Sl):W;if(Zo&&Ut.icon){const lf=Be.elevation,Qm=lf?lf.getAtTileOffsetFunc(ir,Be.center.lat,Be.worldSize,Ut.getProjection()):null,Qu=No(Gr,vt.tileID.canonical,Ke,We,Be,Ut.getProjection(),tn);Gp(Ut,Gr,_,!1,Qu,ss,Ke,xe,Qm,ir)}return{program:Bo,buffers:Ut.icon,uniformValues:ji,atlasTexture:gp,atlasTextureIcon:null,atlasInterpolation:af,atlasInterpolationIcon:null,isSDF:Ut.sdfIcons,hasHalo:Jm,tile:vt,labelPlaneMatrixInv:sf}},Mi=()=>{const Zo=Pe&&h.layout.get("symbol-placement")!=="point",fi=[],Ji=Zo||hr||Fn;_.terrainRenderModeElevated()&&st&&fi.push("PITCH_WITH_MAP_TERRAIN"),Lr&&(fi.push("PROJECTION_GLOBE_VIEW"),Ji&&fi.push("PROJECTED_POS_ON_VIEWPORT")),Ut.text.zOffsetVertexBuffer&&fi.push("Z_OFFSET");const oi=Ut.text.programConfigurations.get(h.id),no=_.getOrCreateProgram(Ut.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:oi,defines:fi});let Bo,ji=[0,0],vs=null;const js=Ut.textSizeData;Ut.iconsInText&&(ji=vt.imageAtlasTexture?vt.imageAtlasTexture.size:[0,0],vs=vt.imageAtlasTexture?vt.imageAtlasTexture:null,Bo=st||Be.pitch!==0||_.options.rotating||_.options.zooming||js.kind==="composite"||js.kind==="camera"?Xe.LINEAR:Xe.NEAREST);const ac=vt.glyphAtlasTexture?vt.glyphAtlasTexture.size:[0,0],bu=s.b5(js,Be.zoom),Sl=id(Gr,vt.tileID.canonical,st,Pe,Be,Ut.getProjection(),tn),ss=Nf(Gr,vt.tileID.canonical,st,Pe,Be,Ut.getProjection(),tn),ls=_.translatePosMatrix(ss,vt,U,J,!0),ul=_.translatePosMatrix(Gr,vt,U,J),Ps=Ji?W:Sl,Tl=Pe&&!st&&!Zo;let wu=zt;!tr&&!Be.mercatorFromTransition||Pe||(wu=Y(Be));const Oh=Lr?wu:zt;let gp;gp=Ut.iconsInText?bd(js.kind,bu,Tl,st,_,ul,Ps,ls,ac,ji,ir,Wr,xt,wn,Oh,Ut.getProjection()):Js(js.kind,bu,Tl,st,_,ul,Ps,ls,!0,ac,!0,ir,Wr,xt,wn,Oh,Ut.getProjection());const of=vt.glyphAtlasTexture?vt.glyphAtlasTexture:null,af=Xe.LINEAR,Jm=h.paint.get("text-halo-width").constantOr(1)!==0,sf=_.terrain&&st&&Zo?s.a6.invert(s.a6.create(),Sl):W;if(Zo&&Ut.text){const lf=Be.elevation,Qm=lf?lf.getAtTileOffsetFunc(ir,Be.center.lat,Be.worldSize,Ut.getProjection()):null,Qu=No(Gr,vt.tileID.canonical,st,Pe,Be,Ut.getProjection(),tn);Gp(Ut,Gr,_,!0,Qu,ss,st,Ce,Qm,ir)}return{program:no,buffers:Ut.text,uniformValues:gp,atlasTexture:of,atlasTextureIcon:vs,atlasInterpolation:af,atlasInterpolationIcon:Bo,isSDF:!0,hasHalo:Jm,tile:vt,labelPlaneMatrixInv:sf}},pi=Ut.icon.segments.get().length,Ci=Ut.text.segments.get().length,Ti=pi&&!D.onlyText?Sn():null,ro=Ci&&!D.onlyIcons?Mi():null,Ro=h.paint.get("icon-opacity").constantOr(1),Vi=h.paint.get("text-opacity").constantOr(1);if(pt&&Ut.canOverlap){Tt=!0;const Zo=Ro&&!D.onlyText?Ut.icon.segments.get():[],fi=Vi&&!D.onlyIcons?Ut.text.segments.get():[];for(const Ji of Zo)Cr.push({segments:new s.aB([Ji]),sortKey:Ji.sortKey,state:Ti});for(const Ji of fi)Cr.push({segments:new s.aB([Ji]),sortKey:Ji.sortKey,state:ro})}else D.onlyText||Cr.push({segments:Ro?Ut.icon.segments:new s.aB([]),sortKey:0,state:Ti}),D.onlyIcons||Cr.push({segments:Vi?Ut.text.segments:new s.aB([]),sortKey:0,state:ro})}Tt&&Cr.sort((ir,vt)=>ir.sortKey-vt.sortKey);for(const ir of Cr){const vt=ir.state;if(vt)if(_.terrain&&_.terrain.setupElevationDraw(vt.tile,vt.program,{useDepthForOcclusion:Be.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:vt.labelPlaneMatrixInv}),De.activeTexture.set(Xe.TEXTURE0),vt.atlasTexture&&vt.atlasTexture.bind(vt.atlasInterpolation,Xe.CLAMP_TO_EDGE,!0),vt.atlasTextureIcon&&(De.activeTexture.set(Xe.TEXTURE1),vt.atlasTextureIcon&&vt.atlasTextureIcon.bind(vt.atlasInterpolationIcon,Xe.CLAMP_TO_EDGE,!0)),_.uploadCommonLightUniforms(_.context,vt.program),vt.hasHalo){const Ut=vt.uniformValues;Ut.u_is_halo=1,Ze(vt.buffers,ir.segments,h,_,vt.program,Zt,I,A,Ut,2),Ut.u_is_halo=0}else{if(vt.isSDF){const Ut=vt.uniformValues;vt.hasHalo&&(Ut.u_is_halo=1,Ze(vt.buffers,ir.segments,h,_,vt.program,Zt,I,A,Ut,1)),Ut.u_is_halo=0}Ze(vt.buffers,ir.segments,h,_,vt.program,Zt,I,A,vt.uniformValues,1)}}}function Ze(_,o,h,x,I,A,D,N,U,Z){const J=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.iconTransitioningVertexBuffer,_.globeExtVertexBuffer,_.zOffsetVertexBuffer];I.draw(x,x.context.gl.TRIANGLES,A,D,N,Dn.disabled,U,h.id,_.layoutVertexBuffer,_.indexBuffer,o,h.paint,x.transform.zoom,_.programConfigurations.get(h.id),J,Z)}function Je(_,o,h,x,I,A,D){const N=_.context.gl,U=h.paint.get("fill-pattern"),Z=U&&U.constantOr(1);let J,ee,ae,he,we;D?(ee=Z&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=N.LINES):(ee=Z?"fillPattern":"fill",J=N.TRIANGLES);for(const xe of x){const Ce=o.getTile(xe);if(Z&&!Ce.patternsLoaded())continue;const ge=Ce.getBucket(h);if(!ge)continue;_.prepareDrawTile();const De=ge.programConfigurations.get(h.id),Xe=_.isTileAffectedByFog(xe),Be=_.getOrCreateProgram(ee,{config:De,overrideFog:Xe});Z&&(_.context.activeTexture.set(N.TEXTURE0),Ce.imageAtlasTexture&&Ce.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),De.updatePaintBuffers());const We=U.constantOr(null);if(We&&Ce.imageAtlas){const st=Ce.imageAtlas.patternPositions[We.toString()];st&&De.setConstantPatternPositions(st)}const Pe=_.translatePosMatrix(xe.projMatrix,Ce,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor")),Ke=h.paint.get("fill-emissive-strength");if(D){he=ge.indexBuffer2,we=ge.segments2;const st=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];ae=ee==="fillOutlinePattern"&&Z?cl(Pe,Ke,_,Ce,st):ll(Pe,Ke,st)}else he=ge.indexBuffer,we=ge.segments,ae=Z?hp(Pe,Ke,_,Ce):ec(Pe,Ke);_.uploadCommonUniforms(_.context,Be,xe.toUnwrapped()),Be.draw(_,J,I,_.stencilModeForClipping(xe),A,Dn.disabled,ae,h.id,ge.layoutVertexBuffer,he,we,h.paint,_.transform.zoom,De,void 0)}}function ke(_,o,h,x,I,A,D,N){h.resetLayerRenderingStats(_);const U=_.context,Z=U.gl,J=_.transform,ee=h.paint.get("fill-extrusion-pattern"),ae=ee.constantOr(1),he=h.paint.get("fill-extrusion-opacity"),we=_.style.enable3dLights(),xe=h.paint.get(we&&!ae?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Ce=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),xe],ge=h.layout.get("fill-extrusion-edge-radius"),De=ge>0&&!h.paint.get("fill-extrusion-rounded-roof"),Xe=De?0:ge,Be=J.projection.name==="globe"?s.cF():0,We=J.projection.name==="globe",Pe=We?s.S(J.zoom):0,Ke=[s.a5(J.center.lng),s.ae(J.center.lat)],st=h.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),pt=h.paint.get("fill-extrusion-flood-light-intensity"),Tt=h.paint.get("fill-extrusion-vertical-scale"),Zt=Oo(_,h.paint.get("fill-extrusion-cutoff-fade-range")),xt=h.paint.get("fill-extrusion-emissive-strength"),hr=[];let tr;We&&hr.push("PROJECTION_GLOBE_VIEW"),Ce[0]>0&&hr.push("FAUX_AO"),De&&hr.push("ZERO_ROOF_RADIUS"),N&&hr.push("HAS_CENTROID"),pt>0&&hr.push("FLOOD_LIGHT"),Zt.shouldRenderCutoff&&hr.push("RENDER_CUTOFF");const Cr=_.renderPass==="shadow",zt=_.shadowRenderer,ir=Cr&&!!zt;_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!0);let vt=[0,0,0];if(zt){const Wr=_.style.directionalLight,Gr=_.style.ambientLight;Wr&&Gr&&(vt=fu(Wr,Gr)),tr=hr.concat(["SHADOWS_SINGLE_CASCADE"])}const Ut=ir?"fillExtrusionDepth":ae?"fillExtrusionPattern":"fillExtrusion",Lr=h.getLayerRenderingStats();for(const Wr of x){const Gr=o.getTile(Wr),tn=Gr.getBucket(h);if(!tn||tn.projection.name!==J.projection.name)continue;let _n=!1;zt&&(_n=zt.getMaxCascadeForTile(Wr.toUnwrapped())===0);const Fn=_.isTileAffectedByFog(Wr),wn=tn.programConfigurations.get(h.id),Sn=_.getOrCreateProgram(Ut,{config:wn,defines:_n?tr:hr,overrideFog:Fn});if(_.terrain&&_.terrain.setupElevationDraw(Gr,Sn,{useMeterToDem:!0}),!tn.centroidVertexBuffer){const Ro=Sn.attributes.a_centroid_pos;Ro!==void 0&&Z.vertexAttrib2f(Ro,0,0)}!Cr&&zt&&zt.setupShadows(Gr.tileID.toUnwrapped(),Sn,"vector-tile",Gr.tileID.overscaledZ),ae&&(_.context.activeTexture.set(Z.TEXTURE0),Gr.imageAtlasTexture&&Gr.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),wn.updatePaintBuffers());const Mi=ee.constantOr(null);if(Mi&&Gr.imageAtlas){const Ro=Gr.imageAtlas.patternPositions[Mi.toString()];Ro&&wn.setConstantPatternPositions(Ro)}const pi=h.paint.get("fill-extrusion-vertical-gradient");let Ci;if(Cr&&zt){if(Lt(Gr.tileID,tn,_))continue;const Ro=zt.calculateShadowPassMatrixFromTile(Gr.tileID.toUnwrapped());Ci=Ya(Ro,Xe,Tt)}else{const Ro=_.translatePosMatrix(Wr.expandedProjMatrix,Gr,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Vi=J.projection.createInversionMatrix(J,Wr.canonical);Ci=ae?Wu(Ro,_,pi,he,Ce,Xe,Wr,Gr,Be,Pe,Ke,Vi,st,Tt):Mo(Ro,_,pi,he,Ce,Xe,Wr,Be,Pe,Ke,Vi,st,Tt,pt,vt,xt)}_.uploadCommonUniforms(U,Sn,Wr.toUnwrapped(),null,Zt);let Ti=tn.segments;if(J.projection.name==="mercator"&&!Cr&&(Ti=tn.getVisibleSegments(Gr.tileID,_.terrain,_.transform.getFrustum(0)),!Ti.get().length))continue;if(Lr)if(Cr)for(const Ro of Ti.get())Lr.numRenderedVerticesInShadowPass+=Ro.primitiveLength;else for(const Ro of Ti.get())Lr.numRenderedVerticesInTransparentPass+=Ro.primitiveLength;const ro=[];(_.terrain||N)&&ro.push(tn.centroidVertexBuffer),We&&ro.push(tn.layoutVertexExtBuffer),Sn.draw(_,U.gl.TRIANGLES,I,A,D,Dn.backCCW,Ci,h.id,tn.layoutVertexBuffer,tn.indexBuffer,Ti,h.paint,_.transform.zoom,wn,ro)}_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!1)}function ut(_,o,h,x,I,A,D,N,U,Z,J,ee,ae,he,we,xe,Ce,ge,De){const Xe=_.context,Be=Xe.gl,We=_.transform,Pe=_.transform.zoom,Ke=[],st=Oo(_,h.paint.get("fill-extrusion-cutoff-fade-range"));Z==="clear"?(Ke.push("CLEAR_SUBPASS"),De&&(Ke.push("CLEAR_FROM_TEXTURE"),Xe.activeTexture.set(Be.TEXTURE0),De.bind(Be.LINEAR,Be.CLAMP_TO_EDGE))):Z==="sdf"&&Ke.push("SDF_SUBPASS"),Ce&&Ke.push("HAS_CENTROID"),st.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF");const pt=h.layout.get("fill-extrusion-edge-radius"),Tt=(Zt,xt,hr,tr,Cr)=>{const zt=xt.programConfigurations.get(h.id),ir=_.isTileAffectedByFog(Zt),vt=_.getOrCreateProgram("fillExtrusionGroundEffect",{config:zt,defines:Ke,overrideFog:ir}),Ut=((Wr,Gr,tn,_n,Fn,wn,Sn,Mi,pi,Ci,Ti)=>({u_matrix:Gr,u_opacity:tn,u_ao_pass:_n?1:0,u_meter_to_tile:Fn,u_ao:wn,u_flood_light_intensity:Sn,u_flood_light_color:Mi,u_attenuation:pi,u_edge_radius:Ci,u_fb:0,u_fb_size:Ti}))(0,tr,J,U,Cr,[ee,ae*Cr],he,we,xe,Pe>=17?0:pt*Cr,De?De.size[0]:0),Lr=[];Ce&&Lr.push(xt.hiddenByLandmarkVertexBuffer),_.uploadCommonUniforms(Xe,vt,Zt.toUnwrapped(),null,st),vt.draw(_,Xe.gl.TRIANGLES,I,A,D,N,Ut,h.id,xt.vertexBuffer,xt.indexBuffer,hr,h.paint,Pe,zt,Lr)};for(const Zt of x){const xt=o.getTile(Zt),hr=xt.getBucket(h);if(!hr||hr.projection.name!==We.projection.name||!hr.groundEffect||hr.groundEffect&&!hr.groundEffect.hasData())continue;const tr=hr.groundEffect,Cr=1/hr.tileToMeter;{const zt=_.translatePosMatrix(Zt.projMatrix,xt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ir=tr.getDefaultSegment();Tt(Zt,tr,ir,zt,Cr)}if(ge)for(let zt=0;zt<4;zt++){const ir=s.cG[zt](Zt),vt=o.getTile(ir);if(!vt)continue;const Ut=vt.getBucket(h);if(!Ut||Ut.projection.name!==We.projection.name||!Ut.groundEffect||Ut.groundEffect&&!Ut.groundEffect.hasData())continue;const Lr=Ut.groundEffect;let Wr,Gr;zt===0?(Wr=[-s.V,0,0],Gr=1):zt===1?(Wr=[s.V,0,0],Gr=0):zt===2?(Wr=[0,-s.V,0],Gr=3):(Wr=[0,s.V,0],Gr=2);const tn=Lr.regionSegments[Gr];if(!tn)continue;const _n=new Float32Array(16);s.a6.translate(_n,Zt.projMatrix,Wr),Tt(Zt,Lr,tn,_.translatePosMatrix(_n,xt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Cr)}}}function ht(_,o,h,x,I,A,D){x.centroidVertexArray.length===0&&x.createCentroidsBuffer();const N=A?A.findDEMTileFor(h):null;if(!(N&&N.dem||D))return;const U=ge=>new s.P(Math.ceil((ge+s.cJ)*s.cK),0),Z=ge=>{const De=o.getSource().minzoom,Xe=We=>{const Pe=o.getTileByID(We);if(Pe&&Pe.hasData())return Pe.getBucket(I)},Be=[0,-1,1];for(const We of Be){if(ge.overscaledZ+We<De)continue;const Pe=Xe(ge.calculateScaledKey(ge.overscaledZ+We));if(Pe)return Pe}},J=[0,0,0],ee=(ge,De)=>(J[0]=Math.min(ge.min.y,De.min.y),J[1]=Math.max(ge.max.y,De.max.y),J[2]=s.V-De.min.x>ge.max.x?De.min.x-s.V:ge.max.x,J),ae=(ge,De)=>(J[0]=Math.min(ge.min.x,De.min.x),J[1]=Math.max(ge.max.x,De.max.x),J[2]=s.V-De.min.y>ge.max.y?De.min.y-s.V:ge.max.y,J),he=[(ge,De)=>ee(ge,De),(ge,De)=>ee(De,ge),(ge,De)=>ae(ge,De),(ge,De)=>ae(De,ge)],we=(ge,De,Xe,Be,We,Pe,Ke)=>{if(!A)return 0;const st=[[Pe?Xe:ge,Pe?ge:Xe,0],[Pe?Xe:De,Pe?De:Xe,0]],pt=Ke<0?s.V+Ke:Ke,Tt=[Pe?pt:(ge+De)/2,Pe?(ge+De)/2:pt,0];return Xe===0&&Ke<0||Xe!==0&&Ke>0?A.getForTilePoints(We,[Tt],!0,Be):st.push(Tt),A.getForTilePoints(h,st,!0,N),Math.max(st[0][2],st[1][2],Tt[2])/A.exaggeration()};for(let ge=0;ge<4;ge++){const De=x.borderFeatureIndices[ge];if(De.length===0)continue;const Xe=s.cG[ge](h),Be=Z(Xe);if(!(Be&&Be instanceof s.cH)||x.borderDoneWithNeighborZ[ge]===Be.canonical.z)continue;Be.centroidVertexArray.length===0&&Be.createCentroidsBuffer();const We=A?A.findDEMTileFor(Xe):null;if(!(We&&We.dem||D))continue;const Pe=(ge<2?1:5)-ge,Ke=Be.borderDoneWithNeighborZ[Pe]!==x.canonical.z,st=Be.borderFeatureIndices[Pe];let pt=0;if(x.canonical.z!==Be.canonical.z){for(const Tt of De)x.showCentroid(x.featuresOnBorder[Tt]);if(Ke)for(const Tt of st)Be.showCentroid(Be.featuresOnBorder[Tt]);x.borderDoneWithNeighborZ[ge]=Be.canonical.z,Be.borderDoneWithNeighborZ[Pe]=x.canonical.z}for(const Tt of De){const Zt=x.featuresOnBorder[Tt],xt=x.centroidData[Zt.centroidDataIndex],hr=Zt.borders[ge];let tr;for(;pt<st.length;){tr=Be.featuresOnBorder[st[pt]];const Cr=tr.borders[Pe];if(Cr[1]>hr[0]+3||Cr[0]>hr[0]-3)break;Be.showCentroid(tr),pt++}if(tr&&pt<st.length){const Cr=pt;let zt=0;for(;!(tr.borders[Pe][0]>hr[1]-3)&&(zt++,++pt!==st.length);)tr=Be.featuresOnBorder[st[pt]];if(tr=Be.featuresOnBorder[st[Cr]],zt>1){const Ut=tr.borders[Pe];Math.abs(hr[0]-Ut[0])<3&&Math.abs(hr[1]-Ut[1])<3&&(zt=1,pt=Cr+1)}else if(zt===0){x.showCentroid(Zt);continue}const ir=Be.centroidData[tr.centroidDataIndex];D&&zt===1&&(((xe=xt).flags|(Ce=ir).flags)&s.cI?(xe.flags|=s.cI,Ce.flags|=s.cI):(xe.flags&=~s.cI,Ce.flags&=~s.cI));const vt=Zt.intersectsCount()>1||tr.intersectsCount()>1;if(zt>1)pt=Cr,xt.centroidXY=ir.centroidXY=new s.P(0,0);else if(We&&We.dem&&!vt){const Ut=he[ge](xt,ir),Lr=ge%2?s.V-1:0,Wr=we(Ut[0],Math.min(s.V-1,Ut[1]),Lr,We,Xe,ge<2,Ut[2]);xt.centroidXY=ir.centroidXY=U(Wr)}else vt?xt.centroidXY=ir.centroidXY=new s.P(0,0):(xt.centroidXY=x.encodeBorderCentroid(Zt),ir.centroidXY=Be.encodeBorderCentroid(tr));x.writeCentroidToBuffer(xt),Be.writeCentroidToBuffer(ir)}else x.showCentroid(Zt)}x.borderDoneWithNeighborZ[ge]=Be.canonical.z,Be.borderDoneWithNeighborZ[Pe]=x.canonical.z}var xe,Ce;(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(_)}const Ct=[1,0,0],lt=[0,1,0],It=[0,0,1];function Lt(_,o,h){const x=h.transform,I=h.shadowRenderer;if(!I)return!0;const A=_.toUnwrapped(),D=x.tileSize*I._cascades[h.currentShadowCascade].scale;let N=o.maxHeight;if(x.elevation){const xe=x.elevation.getMinMaxForTile(_);xe&&(N+=xe.max)}const U=[...I.shadowDirection];U[2]=-U[2];const Z=I.computeSimplifiedTileShadowVolume(A,N,D,U);if(!Z)return!1;const J=[Ct,lt,It,U,[U[0],0,U[2]],[0,U[1],U[2]]],ee=x.projection.name==="globe",ae=x.scaleZoom(D),he=s.bq.fromInvProjectionMatrix(x.invProjMatrix,x.worldSize,ae,!ee),we=I.getCurrentCascadeFrustum();return he.intersectsPrecise(Z.vertices,Z.planes,J)===0||we.intersectsPrecise(Z.vertices,Z.planes,J)===0}function Jt(_){return[_[0]*s.cL,_[1]*s.cL,_[2]*s.cL,0]}function vr(_,o,h,x,I,A,D,N,U){const Z=x.getSource(),J=h.globeSharedBuffers;if(!J)return;let ee,ae,he;if(o&&(ee=x.getTile(o)),Z instanceof s.ap?(ae=Z.texture,he=s.cj(0,0,h.transform)):ee&&o&&(ae=ee.texture,he=s.cj(o.canonical.z,o.canonical.x,h.transform)),!ae||!he)return;_||(he=s.a6.scale(s.a6.create(),he,[1,-1,1]));const we=h.context,xe=we.gl,Ce=I.paint.get("raster-resampling")==="nearest"?xe.NEAREST:xe.LINEAR,ge=h.colorModeForDrapableLayerRenderPass(A),De=D.defines;De.push("GLOBE_POLES");const Xe=new Un(xe.LEQUAL,Un.ReadWrite,h.depthRangeFor3D),Be=Float32Array.from(h.transform.expandedFarZProjMatrix),We=Float32Array.from(s.aT(s.ci(new s.bs(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),we.activeTexture.set(xe.TEXTURE0),ae.bind(Ce,xe.CLAMP_TO_EDGE),we.activeTexture.set(xe.TEXTURE1),ae.bind(Ce,xe.CLAMP_TO_EDGE),ae.useMipmap&&we.extTextureFilterAnisotropic&&h.transform.pitch>20&&xe.texParameterf(xe.TEXTURE_2D,we.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,we.extTextureFilterAnisotropicMax);const[Pe,Ke,st,pt]=o?J.getPoleBuffers(o.canonical.z,!1):J.getPoleBuffers(0,!0),Tt=I.paint.get("raster-elevation");let Zt;_?(Zt=Pe,h.renderDefaultNorthPole=Tt!==0):(Zt=Ke,h.renderDefaultSouthPole=Tt!==0);const xt=Jt(D.mix),hr=((Cr,zt,ir,vt,Ut,Lr,Wr,Gr,tn,_n,Fn,wn,Sn)=>Xu(Cr,zt,ir,new Float32Array(16),new Float32Array(9),[0,0],vt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Lr,[0,0],Gr,2,_n,Fn,wn,1,0,Sn))(Be,We,he,s.S(h.transform.zoom),0,I,0,Tt,0,xt,D.offset,D.range,A),tr=h.getOrCreateProgram("raster",{defines:De});h.uploadCommonUniforms(we,tr,null),tr.draw(h,xe.TRIANGLES,Xe,U,ge,N,hr,I.id,Zt,st,pt)}function mr(_){const o=_._nearZ,h=_.projection.farthestPixelDistance(_),x=h-o,I=.2*_.height,A=o+I;return[o,h,(A-I-o)/x,(A-o)/x]}function wr(_,o,h,x){if(_)return o instanceof Rt&&_ instanceof iu?o.getTextureDescriptor(_,h,!0):{texture:_.texture,mix:Jt(x.mix),offset:x.offset,buffer:0,tileSize:1}}function Ur(_,o,h){if(!_)return null;const x=o.getTextureDescriptor(_,h,!0);if(!x)return null;let{texture:I,mix:A,offset:D,tileSize:N,buffer:U,format:Z}=x;if(!I||!Z)return null;let J=!1;return Z==="uint32"&&(J=!0,A[3]=0,A=Zu(s.cM,A,[0,h.paint.get("raster-particle-max-speed")]),D=ef(s.cM,D,[0,h.paint.get("raster-particle-max-speed")])),{texture:I,textureOffset:[U/(N+2*U),N/(N+2*U)],tileSize:N,scalarData:J,scale:A,offset:D,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Z]]}}function on(_){const o=_._nearZ,h=_.projection.farthestPixelDistance(_),x=h-o,I=.2*_.height,A=o+I;return[o,h,(A-I-o)/x,(A-o)/x]}const Hr=new s.ax(1,0,0,1),mn=new s.ax(0,1,0,1),Yn=new s.ax(0,0,1,1),ni=new s.ax(1,0,1,1),Jn=new s.ax(0,1,1,1);function io(_,o,h,x,I,A,D){const N=_.context,U=_.transform,Z=N.gl,J=U.projection.name==="globe",ee=J?["PROJECTION_GLOBE_VIEW"]:[];let ae=s.a6.clone(h.projMatrix);if(J&&s.S(U.zoom)>0){const xt=s.aS(h.canonical,U),hr=s.cN(xt);ae=s.a6.multiply(new Float32Array(16),U.globeMatrix,hr),s.a6.multiply(ae,U.projMatrix,ae)}const he=s.a6.create();he[12]+=2*I/(s.f.devicePixelRatio*U.width),he[13]+=2*A/(s.f.devicePixelRatio*U.height),s.a6.multiply(ae,he,ae);const we=_.getOrCreateProgram("debug",{defines:ee}),xe=o.getTileByID(h.key);_.terrain&&_.terrain.setupElevationDraw(xe,we);const Ce=Un.disabled,ge=ui.disabled,De=_.colorModeForRenderPass(),Xe="$debug";N.activeTexture.set(Z.TEXTURE0),_.emptyTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),J?xe._makeGlobeTileDebugBuffers(_.context,U):xe._makeDebugTileBoundsBuffers(_.context,U.projection);const Be=xe._tileDebugBuffer||_.debugBuffer,We=xe._tileDebugIndexBuffer||_.debugIndexBuffer,Pe=xe._tileDebugSegments||_.debugSegments;if(we.draw(_,Z.LINE_STRIP,Ce,ge,De,Dn.disabled,tc(ae,x),Xe,Be,We,Pe,null,null,null,[xe._globeTileDebugBorderBuffer]),D){const xt=xe.latestRawTileData,hr=Math.floor((xt&&xt.byteLength||0)/1024);let tr=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(tr+=` => ${h.overscaledZ}`),tr+=` ${xe.state}`,tr+=` ${hr}kb`,function(Cr,zt){Cr.initDebugOverlayCanvas();const ir=Cr.debugOverlayCanvas,vt=Cr.context.gl,Ut=Cr.debugOverlayCanvas.getContext("2d");Ut.clearRect(0,0,ir.width,ir.height),Ut.shadowColor="white",Ut.shadowBlur=2,Ut.lineWidth=1.5,Ut.strokeStyle="white",Ut.textBaseline="top",Ut.font="bold 36px Open Sans, sans-serif",Ut.fillText(zt,5,5),Ut.strokeText(zt,5,5),Cr.debugOverlayTexture.update(ir),Cr.debugOverlayTexture.bind(vt.LINEAR,vt.CLAMP_TO_EDGE)}(_,tr)}const Ke=o.getTile(h).tileSize,st=512/Math.min(Ke,512)*(h.overscaledZ/U.zoom)*.5,pt=xe._tileDebugTextBuffer||_.debugBuffer,Tt=xe._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,Zt=xe._tileDebugTextSegments||_.debugSegments;we.draw(_,Z.TRIANGLES,Ce,ge,Fi.alphaBlended,Dn.disabled,tc(ae,s.ax.transparent,st),Xe,pt,Tt,Zt,null,null,null,[xe._globeTileDebugTextBuffer])}function An(_,o,h,x){$n(_,0,o+h/2,_.transform.width,h,x)}function Qn(_,o,h,x){$n(_,o-h/2,0,h,_.transform.height,x)}function $n(_,o,h,x,I,A){const D=_.context,N=D.gl;N.enable(N.SCISSOR_TEST),N.scissor(o*s.f.devicePixelRatio,h*s.f.devicePixelRatio,x*s.f.devicePixelRatio,I*s.f.devicePixelRatio),D.clear({color:A}),N.disable(N.SCISSOR_TEST)}const vi=s.ay([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:xi}=vi;function Ii(_,o,h,x){_.emplaceBack(o,h,x)}class yi{constructor(o){this.vertexArray=new s.az,this.indices=new s.aw,Ii(this.vertexArray,-1,-1,1),Ii(this.vertexArray,1,-1,1),Ii(this.vertexArray,-1,1,1),Ii(this.vertexArray,1,1,1),Ii(this.vertexArray,-1,-1,-1),Ii(this.vertexArray,1,-1,-1),Ii(this.vertexArray,-1,1,-1),Ii(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,xi),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.aB.simpleSegment(0,0,36,12)}}function ii(_,o,h,x,I,A){const D=_.context.gl,N=o.paint.get("sky-atmosphere-color"),U=o.paint.get("sky-atmosphere-halo-color"),Z=o.paint.get("sky-atmosphere-sun-intensity"),J=((ee,ae,he,we,xe)=>({u_matrix_3f:ee,u_sun_direction:ae,u_sun_intensity:he,u_color_tint_r:[we.r,we.g,we.b,we.a],u_color_tint_m:[xe.r,xe.g,xe.b,xe.a],u_luminance:5e-5}))(s.co.fromMat4(s.co.create(),x),I,Z,N,U);D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+A,o.skyboxTexture,0),h.draw(_,D.TRIANGLES,Un.disabled,ui.disabled,Fi.unblended,Dn.frontCW,J,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const is=s.ay([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ra{constructor(o){const h=new s.cO;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const x=new s.aw;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,is.members),this.indexBuffer=o.createIndexBuffer(x),this.segments=s.aB.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ka=s.ay([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Dr{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class an{constructor(o){this.colorModeAlphaBlendedWriteRGB=new Fi([1,Zl,1,Zl],s.ax.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Fi([1,0,1,0],s.ax.transparent,[!1,!1,!1,!0]),this.params=new Dr,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const h=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new ra(h);const x=this.params.sizeRange,I=this.params.intensityRange,A=function(J){const ee=s.aA(30),ae=[];for(let he=0;he<J;++he){const we=2*Math.PI*ee(),xe=Math.acos(1-2*ee())-.5*Math.PI;ae.push(s.N.fromValues(Math.cos(xe)*Math.cos(we),Math.cos(xe)*Math.sin(we),Math.sin(xe)))}return ae}(this.params.starsCount),D=s.aA(300),N=new s.cP,U=new s.aw;let Z=0;for(let J=0;J<A.length;++J){const ee=s.N.scale([],A[J],200),ae=Math.max(0,1+.01*x*(1*D()-.5)),he=Math.max(0,1+.01*I*(1*D()-.5));N.emplaceBack(ee[0],ee[1],ee[2],-1,-1,ae,he),N.emplaceBack(ee[0],ee[1],ee[2],1,-1,ae,he),N.emplaceBack(ee[0],ee[1],ee[2],1,1,ae,he),N.emplaceBack(ee[0],ee[1],ee[2],-1,1,ae,he),U.emplaceBack(Z+0,Z+1,Z+2),U.emplaceBack(Z+0,Z+2,Z+3),Z+=4}this.starsVx=h.createVertexBuffer(N,Ka.members),this.starsIdx=h.createIndexBuffer(U),this.starsSegments=s.aB.simpleSegment(0,0,N.length,U.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,h){const x=o.context,I=x.gl,A=o.transform,D=new Un(I.LEQUAL,Un.ReadOnly,[0,1]),N=s.S(A.zoom),U=h.properties.get("color").toArray01(),Z=h.properties.get("high-color").toArray01(),J=h.properties.get("space-color").toArray01PremultipliedAlpha(),ee=5e-4,ae=s.cQ(h.properties.get("horizon-blend"),0,1,ee,.25),he=s.cd(o,x,A)&&ae===ee?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,we=o.frameCounter/1e3%1,xe=s.N.length(A.globeCenterInViewSpace),Ce=Math.sqrt(Math.pow(xe,2)-Math.pow(he,2)),ge=Math.acos(Ce/xe),De=Xe=>{const Be=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Xe&&Be.push("ALPHA_PASS");const We=o.getOrCreateProgram("globeAtmosphere",{defines:Be}),Pe=((st,pt,Tt,Zt,xt,hr,tr,Cr,zt,ir,vt,Ut)=>({u_frustum_tl:st,u_frustum_tr:pt,u_frustum_br:Tt,u_frustum_bl:Zt,u_horizon:xt,u_transition:hr,u_fadeout_range:tr,u_color:Cr,u_high_color:zt,u_space_color:ir,u_temporal_offset:vt,u_horizon_angle:Ut}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,N,ae,U,Z,J,we,ge);o.uploadCommonUniforms(x,We);const Ke=this.atmosphereBuffer;Ke&&We.draw(o,I.TRIANGLES,D,ui.disabled,Xe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Dn.backCW,Pe,Xe?"atmosphere_glow_alpha":"atmosphere_glow",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)};De(!1),De(!0)}drawStars(o,h){const x=s.aa(h.properties.get("star-intensity"),0,1);if(x===0)return;const I=o.context,A=I.gl,D=o.transform,N=o.getOrCreateProgram("stars"),U=s.bi.identity([]);s.bi.rotateX(U,U,-D._pitch),s.bi.rotateZ(U,U,-D.angle),s.bi.rotateX(U,U,s.bj(D._center.lat)),s.bi.rotateY(U,U,-s.bj(D._center.lng));const Z=s.a6.fromQuat(new Float32Array(16),U),J=s.a6.multiply([],D.starsProjMatrix,Z),ee=s.co.fromMat4([],Z),ae=s.co.invert([],ee),he=[0,1,0];s.N.transformMat3(he,he,ae),s.N.scale(he,he,this.params.sizeMultiplier);const we=[1,0,0];s.N.transformMat3(we,we,ae),s.N.scale(we,we,this.params.sizeMultiplier);const xe=(Ce=he,ge=we,De=x,{u_matrix:Float32Array.from(J),u_up:Ce,u_right:ge,u_intensity_multiplier:De});var Ce,ge,De;o.uploadCommonUniforms(I,N),this.starsVx&&this.starsIdx&&N.draw(o,A.TRIANGLES,Un.disabled,ui.disabled,this.colorModeAlphaBlendedWriteRGB,Dn.disabled,xe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function na(_,o){const h=[..._],x=o.cameraWorldSizeForFog/o.worldSize,I=s.a6.identity([]);return s.a6.scale(I,I,[x,x,1]),s.a6.multiply(h,I,h),s.a6.multiply(h,o.worldToFogMatrix,h),h}function go(_,o,h,x){const I=h.material,A=x.context,{baseColorTexture:D,metallicRoughnessTexture:N}=I.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:Z,emissionTexture:J}=I;function ee(ae,he,we){if(ae&&(_.push(he),A.activeTexture.set(A.gl.TEXTURE0+we),ae.gfxTexture)){const{minFilter:xe,magFilter:Ce,wrapS:ge,wrapT:De}=ae.sampler;ae.gfxTexture.bindExtraParam(xe,Ce,ge,De)}}ee(D,"HAS_TEXTURE_u_baseColorTexture",Aa.BaseColor),ee(N,"HAS_TEXTURE_u_metallicRoughnessTexture",Aa.MetallicRoughness),ee(U,"HAS_TEXTURE_u_normalTexture",Aa.Normal),ee(Z,"HAS_TEXTURE_u_occlusionTexture",Aa.Occlusion),ee(J,"HAS_TEXTURE_u_emissionTexture",Aa.Emission),h.texcoordBuffer&&(_.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(h.texcoordBuffer)),h.colorBuffer&&(_.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(h.colorBuffer)),h.normalBuffer&&(_.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(h.normalBuffer)),h.pbrBuffer&&(_.push("HAS_ATTRIBUTE_a_pbr"),_.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(h.pbrBuffer)),I.alphaMode!=="OPAQUE"&&I.alphaMode!=="MASK"||_.push("UNPREMULT_TEXTURE_IN_SHADER"),I.defined||_.push("DIFFUSE_SHADED"),_.push("USE_STANDARD_DERIVATIVES")}function os(_,o,h,x,I,A){const D=h.paint.get("model-opacity"),N=o.context,U=new Un(o.context.gl.LEQUAL,Un.ReadWrite,o.depthRangeFor3D),Z=o.transform,J=_.mesh,ee=J.material,ae=ee.pbrMetallicRoughness,he=o.style.fog;let we;we=o.transform.projection.zAxisUnit==="pixels"?[..._.nodeModelMatrix]:s.a6.multiply([],x.zScaleMatrix,_.nodeModelMatrix),s.a6.multiply(we,x.negCameraPosMatrix,we);const xe=s.a6.invert([],we);s.a6.transpose(xe,xe);const Ce=h.paint.get("model-emissive-strength").constantOr(0),ge=Ah(new Float32Array(_.worldViewProjection),new Float32Array(we),new Float32Array(xe),o,D,ae.baseColorFactor,ee.emissiveFactor,ae.metallicFactor,ae.roughnessFactor,ee,Ce,h),De={defines:[]},Xe=[];go(De.defines,Xe,J,o);const Be=o.shadowRenderer;Be&&(Be.useNormalOffset=!1);let We=null;if(he){const st=na(_.nodeModelMatrix,o.transform);if(We=new Float32Array(st),Z.projection.name!=="globe"){const pt=J.aabb.min,Tt=J.aabb.max,[Zt,xt]=he.getOpacityForBounds(st,pt[0],pt[1],Tt[0],Tt[1]);De.overrideFog=Zt>=mi||xt>=mi}}const Pe=Oo(o,h.paint.get("model-cutoff-fade-range"));Pe.shouldRenderCutoff&&De.defines.push("RENDER_CUTOFF");const Ke=o.getOrCreateProgram("model",De);o.uploadCommonUniforms(N,Ke,null,We,Pe),o.renderPass!=="shadow"&&Be&&Be.setupShadowsFromMatrix(_.nodeModelMatrix,Ke),Ke.draw(o,N.gl.TRIANGLES,U,I,A,J.material.doubleSided?Dn.disabled:Dn.backCCW,ge,h.id,J.vertexBuffer,J.indexBuffer,J.segments,h.paint,o.transform.zoom,void 0,Xe)}function rc(_,o,h,x,I,A,D){let N;N=_.projection.name==="globe"?s.cS(h,_):[...h],s.a6.multiply(N,N,o.matrix);const U=s.a6.multiply([],x,N);if(o.meshes)for(const Z of o.meshes){if(Z.material.alphaMode!=="BLEND"){D.push({mesh:Z,depth:0,modelIndex:I,worldViewProjection:U,nodeModelMatrix:N});continue}const J=s.N.transformMat4([],Z.centroid,U);J[2]>0&&A.push({mesh:Z,depth:J[2],modelIndex:I,worldViewProjection:U,nodeModelMatrix:N})}if(o.children)for(const Z of o.children)rc(_,Z,h,x,I,A,D)}function jt(_,o,h,x){const I=h.shadowRenderer;if(!I)return;const A=I.getShadowPassDepthMode(),D=I.getShadowPassColorMode(),N=I.calculateShadowPassMatrixFromMatrix(o),U=E(N);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,A,ui.disabled,D,Dn.backCCW,U,x.id,_.vertexBuffer,_.indexBuffer,_.segments,x.paint,h.transform.zoom,void 0,void 0)}function jl(_,o,h){const x=o.updateZoomBasedPaintProperties(),I=function(A,D,N){let U,Z,J,ee=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&ee>0){const ae=A.terrain,he=ae.findDEMTileFor(N);he&&he.dem?U=s.cU.create(ae,N,he):ee=0}if(ee===0&&(D.terrainElevationMin=0,D.terrainElevationMax=0),ee===D.validForExaggeration&&(ee===0||U&&U._demTile&&U._demTile.tileID===D.validForDEMTile.id&&U._dem._timestamp===D.validForDEMTile.timestamp))return!1;for(const ae in D.instancesPerModel){const he=D.instancesPerModel[ae];for(let we=0;we<he.instancedDataArray.length;++we){const xe=(U?ee*U.getElevationAt(0|he.instancedDataArray.float32[16*we],0|he.instancedDataArray.float32[16*we+1],!0,!0):0)+he.instancesEvaluatedElevation[we];he.instancedDataArray.float32[16*we+6]=xe,Z=Z?Math.min(D.terrainElevationMin,xe):xe,J=J?Math.max(D.terrainElevationMax,xe):xe}}return D.terrainElevationMin=Z||0,D.terrainElevationMax=J||0,D.validForExaggeration=ee,D.validForDEMTile=U&&U._demTile?{id:U._demTile.tileID,timestamp:U._dem._timestamp}:{id:void 0,timestamp:0},!0}(_,o,h);(x||I)&&(o.uploaded=!1,o.upload(_.context))}const Pa={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.bS([0,0,0],[s.V,s.V,0])};function wd(_,o){const h=1<<_.canonical.z,x=o.getFreeCameraOptions().position,I=o.elevation,A=_.canonical.x/h,D=(_.canonical.x+1)/h,N=_.canonical.y/h,U=(_.canonical.y+1)/h;let Z=o._centerAltitude;if(I){const he=I.getMinMaxForTile(_);he&&he.max>Z&&(Z=he.max)}const J=s.aa(x.x,A,D)-x.x,ee=s.aa(x.y,N,U)-x.y,ae=s.bl(Z,o.center.lat)-x.z;return o._zoomFromMercatorZ(Math.sqrt(J*J+ee*ee+ae*ae))}function Ku(_,o,h,x,I,A,D){const N=_.context,U=_.renderPass==="shadow",Z=_.shadowRenderer,J=U&&Z?Z.getShadowPassDepthMode():new Un(N.gl.LEQUAL,Un.ReadWrite,_.depthRangeFor3D),ee=_.isTileAffectedByFog(A);if(h.meshes)for(const ae of h.meshes){const he=["MODEL_POSITION_ON_GPU"],we=[];let xe,Ce,ge;x.instancedDataArray.length>20&&he.push("INSTANCED_ARRAYS");const De=Oo(_,o.paint.get("model-cutoff-fade-range"));if(De.shouldRenderCutoff&&he.push("RENDER_CUTOFF"),U&&Z)xe=_.getOrCreateProgram("modelDepth",{defines:he}),Ce=E(D.shadowTileMatrix,D.shadowTileMatrix,Float32Array.from(h.matrix)),ge=Z.getShadowPassColorMode();else{go(he,we,ae,_),xe=_.getOrCreateProgram("model",{defines:he,overrideFog:ee});const Be=ae.material,We=Be.pbrMetallicRoughness,Pe=o.paint.get("model-opacity"),Ke=o.paint.get("model-emissive-strength").constantOr(0);Ce=Ah(A.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),_,Pe,We.baseColorFactor,Be.emissiveFactor,We.metallicFactor,We.roughnessFactor,Be,Ke,o,I),Z&&(D.shadowUniformsInitialized?xe.setShadowUniformValues(N,Z.getShadowUniformValues()):(Z.setupShadows(A.toUnwrapped(),xe,"model-tile",A.overscaledZ),D.shadowUniformsInitialized=!0)),ge=De.shouldRenderCutoff||Pe<1||Be.alphaMode!=="OPAQUE"?Fi.alphaBlended:Fi.unblended}_.uploadCommonUniforms(N,xe,A.toUnwrapped(),null,De);const Xe=ae.material.doubleSided?Dn.disabled:Dn.backCCW;if(x.instancedDataArray.length>20)we.push(x.instancedDataBuffer),xe.draw(_,N.gl.TRIANGLES,J,ui.disabled,ge,Xe,Ce,o.id,ae.vertexBuffer,ae.indexBuffer,ae.segments,o.paint,_.transform.zoom,void 0,we,x.instancedDataArray.length);else{const Be=U?"u_instance":"u_normal_matrix";for(let We=0;We<x.instancedDataArray.length;++We)Ce[Be]=new Float32Array(x.instancedDataArray.arrayBuffer,64*We,16),xe.draw(_,N.gl.TRIANGLES,J,ui.disabled,ge,Xe,Ce,o.id,ae.vertexBuffer,ae.indexBuffer,ae.segments,o.paint,_.transform.zoom,void 0,we)}}if(h.children)for(const ae of h.children)Ku(_,o,ae,x,I,A,D)}const Bl=[1,-1,1];function Sd(_,o,h,x){if(!h.modelManager)return!0;const I=h.modelManager;if(!h.shadowRenderer)return!0;const A=h.shadowRenderer,D=o.aabb;let N=!0,U=_.maxHeight;if(U===0){let J=0;for(const ee in _.instancesPerModel){const ae=I.getModel(ee,x);ae?J=Math.max(J,Math.max(Math.max(ae.aabb.max[0],ae.aabb.max[1]),ae.aabb.max[2])):N=!1}U=_.maxScale*J*1.41+_.maxVerticalOffset,N&&(_.maxHeight=U)}D.max[2]=U,D.min[2]+=_.terrainElevationMin,D.max[2]+=_.terrainElevationMax,s.N.transformMat4(D.min,D.min,o.tileMatrix),s.N.transformMat4(D.max,D.max,o.tileMatrix);const Z=D.intersects(A.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(_.isInsideFirstShadowMapFrustum=Z===2),Z===0}class fp{}class bc{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,h,x){{const ee=this._storage.get(h.id);if(ee)return ee.lastUsedFrameIdx=o,ee.buf}const I=x.gl,A=I.getBufferParameter(I.ELEMENT_ARRAY_BUFFER,I.BUFFER_SIZE),D=new ArrayBuffer(A),N=new Int16Array(D);I.getBufferSubData(I.ELEMENT_ARRAY_BUFFER,0,new Int16Array(D));const U=new s.cW;for(let ee=0;ee<A/2;ee+=3){const ae=N[ee],he=N[ee+1],we=N[ee+2];U.emplaceBack(ae,he),U.emplaceBack(he,we),U.emplaceBack(we,ae)}const Z=x.bindVertexArrayOES.current,J=new fp;return J.buf=new $r(x,U),J.lastUsedFrameIdx=o,this._storage.set(h.id,J),x.bindVertexArrayOES.set(Z),J.buf}update(o){for(const[h,x]of this._storage)o-x.lastUsedFrameIdx>30&&(x.buf.destroy(),this._storage.delete(h))}destroy(){for(const[o,h]of this._storage)h.buf.destroy(),this._storage.delete(o)}}class vu{registerParameter(o,h,x,I,A){}registerButton(o,h,x){}}const wl={symbol:function(_,o,h,x,I){if(_.renderPass!=="translucent")return;const A=ui.disabled,D=_.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(Z,J,ee,ae,he,we,xe){const Ce=J.transform,ge=he==="map",De=we==="map";for(const Xe of Z){const Be=ae.getTile(Xe),We=Be.getBucket(ee);if(!We||!We.text||!We.text.segments.get().length)continue;const Pe=s.b5(We.textSizeData,Ce.zoom),Ke=cu(Xe,We.getProjection(),Ce),st=Ce.calculatePixelsToTileUnitsMatrix(Be),pt=id(Ke,Be.tileID.canonical,De,ge,Ce,We.getProjection(),st),Tt=We.hasIconTextFit()&&We.hasIconData();if(Pe){const Zt=Math.pow(2,Ce.zoom-Be.tileID.overscaledZ);ye(We,ge,De,xe,s.cx,Ce,pt,Xe,Zt,Pe,Tt)}}}(x,_,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),I);const N=h.paint.get("icon-opacity").constantOr(1)!==0,U=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(N||U)?Ae(_,o,h,x,A,D):(N&&Ae(_,o,h,x,A,D,{onlyIcons:!0}),U&&Ae(_,o,h,x,A,D,{onlyText:!0})),o.map.showCollisionBoxes&&(B(_,o,h,x,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),B(_,o,h,x,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(_,o,h,x){if(_.renderPass!=="translucent")return;const I=h.paint.get("circle-opacity"),A=h.paint.get("circle-stroke-width"),D=h.paint.get("circle-stroke-opacity"),N=h.layout.get("circle-sort-key").constantOr(1)!==void 0,U=h.paint.get("circle-emissive-strength");if(I.constantOr(1)===0&&(A.constantOr(1)===0||D.constantOr(1)===0))return;const Z=_.context,J=Z.gl,ee=_.transform,ae=_.depthModeForSublayer(0,Un.ReadOnly),he=ui.disabled,we=_.colorModeForDrapableLayerRenderPass(U),xe=ee.projection.name==="globe",Ce=[s.a5(ee.center.lng),s.ae(ee.center.lat)],ge=[];for(let Xe=0;Xe<x.length;Xe++){const Be=x[Xe],We=o.getTile(Be),Pe=We.getBucket(h);if(!Pe||Pe.projection.name!==ee.projection.name)continue;const Ke=Pe.programConfigurations.get(h.id),st=s.cy(h),pt=_.isTileAffectedByFog(Be);xe&&st.push("PROJECTION_GLOBE_VIEW");const Tt=_.getOrCreateProgram("circle",{config:Ke,defines:st,overrideFog:pt}),Zt=Pe.layoutVertexBuffer,xt=Pe.globeExtVertexBuffer,hr=Pe.indexBuffer,tr=ee.projection.createInversionMatrix(ee,Be.canonical),Cr={programConfiguration:Ke,program:Tt,layoutVertexBuffer:Zt,globeExtVertexBuffer:xt,indexBuffer:hr,uniformValues:s.cz(_,Be,We,tr,Ce,h),tile:We};if(N){const zt=Pe.segments.get();for(const ir of zt)ge.push({segments:new s.aB([ir]),sortKey:ir.sortKey,state:Cr})}else ge.push({segments:Pe.segments,sortKey:0,state:Cr})}N&&ge.sort((Xe,Be)=>Xe.sortKey-Be.sortKey);const De={useDepthForOcclusion:ee.depthOcclusionForSymbolsAndCircles};for(const Xe of ge){const{programConfiguration:Be,program:We,layoutVertexBuffer:Pe,globeExtVertexBuffer:Ke,indexBuffer:st,uniformValues:pt,tile:Tt}=Xe.state,Zt=Xe.segments;_.terrain&&_.terrain.setupElevationDraw(Tt,We,De),_.uploadCommonUniforms(Z,We,Tt.tileID.toUnwrapped()),We.draw(_,J.TRIANGLES,ae,he,we,Dn.disabled,pt,h.id,Pe,st,Zt,h.paint,ee.zoom,Be,[Ke])}},heatmap:function(_,o,h,x){if(h.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const I=_.context,A=I.gl,D=ui.disabled,N=new Fi([A.ONE,A.ONE,A.ONE,A.ONE],s.ax.transparent,[!0,!0,!0,!0]);(function(he,we,xe,Ce){const ge=he.gl,De=we.width*Ce,Xe=we.height*Ce;he.activeTexture.set(ge.TEXTURE1),he.viewport.set([0,0,De,Xe]);let Be=xe.heatmapFbo;if(!Be||Be&&(Be.width!==De||Be.height!==Xe)){Be&&Be.destroy();const We=ge.createTexture();ge.bindTexture(ge.TEXTURE_2D,We),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_S,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_T,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MIN_FILTER,ge.LINEAR),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MAG_FILTER,ge.LINEAR),Be=xe.heatmapFbo=he.createFramebuffer(De,Xe,!0,null),function(Pe,Ke,st,pt,Tt,Zt){const xt=Pe.gl;xt.texImage2D(xt.TEXTURE_2D,0,Pe.extRenderToTextureHalfFloat?xt.RGBA16F:xt.RGBA,Tt,Zt,0,xt.RGBA,Pe.extRenderToTextureHalfFloat?xt.HALF_FLOAT:xt.UNSIGNED_BYTE,null),pt.colorAttachment.set(st)}(he,0,We,Be,De,Xe)}else ge.bindTexture(ge.TEXTURE_2D,Be.colorAttachment.get()),he.bindFramebuffer.set(Be.framebuffer)})(I,_,h,_.transform.projection.name==="globe"?.5:.25),I.clear({color:s.ax.transparent});const U=_.transform,Z=U.projection.name==="globe",J=Z?["PROJECTION_GLOBE_VIEW"]:[],ee=Z?Dn.frontCCW:Dn.disabled,ae=[s.a5(U.center.lng),s.ae(U.center.lat)];for(let he=0;he<x.length;he++){const we=x[he];if(o.hasRenderableParent(we))continue;const xe=o.getTile(we),Ce=xe.getBucket(h);if(!Ce||Ce.projection.name!==U.projection.name)continue;const ge=_.isTileAffectedByFog(we),De=Ce.programConfigurations.get(h.id),Xe=_.getOrCreateProgram("heatmap",{config:De,defines:J,overrideFog:ge}),{zoom:Be}=_.transform;_.terrain&&_.terrain.setupElevationDraw(xe,Xe),_.uploadCommonUniforms(I,Xe,we.toUnwrapped());const We=U.projection.createInversionMatrix(U,we.canonical);Xe.draw(_,A.TRIANGLES,Un.disabled,D,N,ee,Hu(_,we,xe,We,ae,Be,h.paint.get("heatmap-intensity")),h.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,h.paint,_.transform.zoom,De,Z?[Ce.globeExtVertexBuffer]:null)}I.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(I,A){const D=I.context,N=D.gl,U=A.heatmapFbo;if(!U)return;D.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,U.colorAttachment.get()),D.activeTexture.set(N.TEXTURE1);let Z=A.colorRampTexture;Z||(Z=A.colorRampTexture=new s.T(D,A.colorRamp,N.RGBA)),Z.bind(N.LINEAR,N.CLAMP_TO_EDGE),I.getOrCreateProgram("heatmapTexture").draw(I,N.TRIANGLES,Un.disabled,ui.disabled,I.colorModeForRenderPass(),Dn.disabled,((J,ee,ae,he)=>({u_image:0,u_color_ramp:1,u_opacity:ee.paint.get("heatmap-opacity")}))(0,A),A.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,A.paint,I.transform.zoom)}(_,h))},line:function(_,o,h,x){if(_.renderPass!=="translucent")return;const I=h.paint.get("line-opacity"),A=h.paint.get("line-width");if(I.constantOr(1)===0||A.constantOr(1)===0)return;const D=h.paint.get("line-emissive-strength"),N=_.depthModeForSublayer(0,Un.ReadOnly),U=_.colorModeForDrapableLayerRenderPass(D),Z=_.terrain&&_.terrain.renderingToTexture?1:s.f.devicePixelRatio,J=h.paint.get("line-dasharray"),ee=J.constantOr(1),ae=h.layout.get("line-cap"),he=h.paint.get("line-pattern"),we=he.constantOr(1),xe=h.paint.get("line-pattern").constantOr(1),Ce=h.paint.get("line-opacity").constantOr(1)!==1;let ge=!xe&&Ce;const De=h.paint.get("line-gradient"),Xe=we?"linePattern":"line",Be=_.context,We=Be.gl,Pe=s.cA(h);_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(ge=!1);for(const Ke of x){const st=o.getTile(Ke);if(we&&!st.patternsLoaded())continue;const pt=st.getBucket(h);if(!pt)continue;_.prepareDrawTile();const Tt=pt.programConfigurations.get(h.id),Zt=_.isTileAffectedByFog(Ke),xt=_.getOrCreateProgram(Xe,{config:Tt,defines:Pe,overrideFog:Zt}),hr=he.constantOr(null);if(hr&&st.imageAtlas){const Wr=st.imageAtlas.patternPositions[hr.toString()];Wr&&Tt.setConstantPatternPositions(Wr)}const tr=J.constantOr(null),Cr=ae.constantOr(null);if(!we&&tr&&Cr&&st.lineAtlas){const Wr=st.lineAtlas.getDash(tr,Cr);Wr&&Tt.setConstantPatternPositions(Wr)}let[zt,ir]=h.paint.get("line-trim-offset");(Cr==="round"||Cr==="square")&&zt!==ir&&(zt===0&&(zt-=1),ir===1&&(ir+=1));const vt=_.terrain?Ke.projMatrix:null,Ut=we?s.cB(_,st,h,vt,Z,[zt,ir]):s.cC(_,st,h,vt,pt.lineClipsArray.length,Z,[zt,ir]);if(De){const Wr=pt.gradients[h.id];let Gr=Wr.texture;if(h.gradientVersion!==Wr.version){let tn=256;if(h.stepInterpolant){const _n=o.getSource().maxzoom,Fn=Ke.canonical.z===_n?Math.ceil(1<<_.transform.maxZoom-Ke.canonical.z):1;tn=s.aa(s.cD(pt.maxLineLength/s.V*1024*Fn),256,Be.maxTextureSize)}Wr.gradient=s.cE({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:tn,image:Wr.gradient||void 0,clips:pt.lineClipsArray}),Wr.texture?Wr.texture.update(Wr.gradient):Wr.texture=new s.T(Be,Wr.gradient,We.RGBA),Wr.version=h.gradientVersion,Gr=Wr.texture}Be.activeTexture.set(We.TEXTURE1),Gr.bind(h.stepInterpolant?We.NEAREST:We.LINEAR,We.CLAMP_TO_EDGE)}ee&&(Be.activeTexture.set(We.TEXTURE0),st.lineAtlasTexture&&st.lineAtlasTexture.bind(We.LINEAR,We.REPEAT),Tt.updatePaintBuffers()),we&&(Be.activeTexture.set(We.TEXTURE0),st.imageAtlasTexture&&st.imageAtlasTexture.bind(We.LINEAR,We.CLAMP_TO_EDGE),Tt.updatePaintBuffers()),_.uploadCommonUniforms(Be,xt,Ke.toUnwrapped());const Lr=Wr=>{xt.draw(_,We.TRIANGLES,N,Wr,U,Dn.disabled,Ut,h.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,h.paint,_.transform.zoom,Tt,[pt.layoutVertexBuffer2])};if(ge){const Wr=_.stencilModeForClipping(Ke).ref;Wr===0&&_.terrain&&Be.clear({stencil:0});const Gr={func:We.EQUAL,mask:255};Ut.u_alpha_discard_threshold=.8,Lr(new ui(Gr,Wr,255,We.KEEP,We.KEEP,We.INVERT)),Ut.u_alpha_discard_threshold=0,Lr(new ui(Gr,Wr,255,We.KEEP,We.KEEP,We.KEEP))}else Lr(_.stencilModeForClipping(Ke))}ge&&(_.resetStencilClippingMasks(),_.terrain&&Be.clear({stencil:0}))},fill:function(_,o,h,x){const I=h.paint.get("fill-color"),A=h.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const D=h.paint.get("fill-emissive-strength"),N=_.colorModeForDrapableLayerRenderPass(D),U=h.paint.get("fill-pattern"),Z=_.opaquePassEnabledForLayer()&&!U.constantOr(1)&&I.constantOr(s.ax.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===Z){const J=_.depthModeForSublayer(1,_.renderPass==="opaque"?Un.ReadWrite:Un.ReadOnly);Je(_,o,h,x,J,N,!1)}if(_.renderPass==="translucent"&&h.paint.get("fill-antialias")){const J=_.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,Un.ReadOnly);Je(_,o,h,x,J,N,!0)}},"fill-extrusion":function(_,o,h,x){const I=h.paint.get("fill-extrusion-opacity"),A=_.context,D=A.gl,N=_.terrain,U=N&&N.renderingToTexture;if(I===0)return;const Z=_.conflationActive&&_.layerUsedInConflation(h,o.getSource());if(Z&&function(J,ee,ae,he){for(const we of he){const xe=ee.getTile(we).getBucket(ae);xe&&(xe.updateReplacement(we,J.replacementSource),xe.uploadCentroid(J.context))}}(_,o,h,x),N||Z)for(const J of x){const ee=o.getTile(J).getBucket(h);ee&&ht(_.context,o,J,ee,h,N,Z)}if(_.renderPass==="shadow"&&_.shadowRenderer){const J=_.shadowRenderer;if(N&&I<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.Z)return;const ee=J.getShadowPassDepthMode(),ae=J.getShadowPassColorMode();ke(_,o,h,x,ee,ui.disabled,ae,Z)}else if(_.renderPass==="translucent"){const J=!h.paint.get("fill-extrusion-pattern").constantOr(1),ee=h.paint.get("fill-extrusion-color").constantOr(s.ax.white);if(!U&&ee.a!==0){const ae=new Un(_.context.gl.LEQUAL,Un.ReadWrite,_.depthRangeFor3D);I===1&&J?ke(_,o,h,x,ae,ui.disabled,Fi.unblended,Z):(ke(_,o,h,x,ae,ui.disabled,Fi.disabled,Z),ke(_,o,h,x,ae,_.stencilModeFor3D(),_.colorModeForRenderPass(),Z),_.resetStencilClippingMasks())}if(_.style.enable3dLights()&&J&&(!N&&_.transform.projection.name!=="globe"||U)){const ae=h.paint.get("fill-extrusion-opacity"),he=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),we=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),xe=h.paint.get("fill-extrusion-flood-light-intensity"),Ce=h.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ge=he>0&&we>0,De=xe>0,Xe=(We,Pe,Ke)=>(1-Ke)*We+Ke*Pe,Be=We=>{const Pe=_.depthModeForSublayer(1,Un.ReadOnly,D.LEQUAL,!0),Ke=h.paint.get(We?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),st=Xe(.1,3,Ke),pt=_._showOverdrawInspector;if(!pt){const Tt=new ui({func:D.ALWAYS,mask:255},255,255,D.KEEP,D.KEEP,D.REPLACE),Zt=new Fi([D.ONE,D.ONE,D.ONE,D.ONE],s.ax.transparent,[!1,!1,!1,!0],D.MIN);ut(_,o,h,x,Pe,Tt,Zt,Dn.disabled,We,"sdf",ae,he,we,xe,Ce,st,Z,!1)}{const Tt=pt?ui.disabled:new ui({func:D.EQUAL,mask:255},255,255,D.KEEP,D.DECR,D.DECR),Zt=pt?_.colorModeForRenderPass():new Fi([D.ONE_MINUS_DST_ALPHA,D.DST_ALPHA,D.ONE,D.ONE],s.ax.transparent,[!0,!0,!0,!0]);ut(_,o,h,x,Pe,Tt,Zt,Dn.disabled,We,"color",ae,he,we,xe,Ce,st,Z,!1)}};if(U){const We=(Pe,Ke,st)=>{const pt=_.depthModeForSublayer(1,Un.ReadOnly,D.LEQUAL,!1),Tt=h.paint.get(Pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Zt=Xe(.1,3,Tt);{const xt=new Fi([D.ONE,D.ONE,D.ONE,D.ONE],s.ax.transparent,[!1,!1,!1,!0]);ut(_,o,h,x,pt,ui.disabled,xt,Dn.disabled,Pe,"clear",ae,he,we,xe,Ce,Zt,Z,Ke)}{const xt=new ui({func:D.ALWAYS,mask:255},255,255,D.KEEP,D.KEEP,D.REPLACE),hr=new Fi([D.ONE,D.ONE,D.ONE,D.ONE],s.ax.transparent,[!1,!1,!1,!0],D.MIN);ut(_,o,h,x,pt,xt,hr,Dn.disabled,Pe,"sdf",ae,he,we,xe,Ce,Zt,Z,Ke)}{const xt=Pe?D.ZERO:D.ONE_MINUS_DST_ALPHA,hr=new ui({func:D.EQUAL,mask:255},255,255,D.KEEP,D.DECR,D.DECR),tr=new Fi([xt,D.DST_ALPHA,D.ONE_MINUS_DST_ALPHA,D.ZERO],s.ax.transparent,[!0,!0,!0,!0]);ut(_,o,h,x,pt,hr,tr,Dn.disabled,Pe,"color",ae,he,we,xe,Ce,Zt,Z,Ke)}{const xt=new Fi([D.ONE,D.ONE,D.ONE,Pe?D.ZERO:D.ONE],s.ax.transparent,[!1,!1,!1,!0],Pe?D.FUNC_ADD:D.MAX);ut(_,o,h,x,pt,ui.disabled,xt,Dn.disabled,Pe,"clear",ae,he,we,xe,Ce,Zt,Z,Ke,st)}};if(ge||De){let Pe;if(_.prepareDrawTile(),N){const Ke=N.drapeBufferSize[0],st=N.drapeBufferSize[1];Pe=N.framebufferCopyTexture,Pe&&(!Pe||Pe.size[0]===Ke&&Pe.size[1]===st)||(Pe&&Pe.destroy(),Pe=N.framebufferCopyTexture=new s.T(A,new s.h({width:Ke,height:st}),D.RGBA)),Pe.bind(D.LINEAR,D.CLAMP_TO_EDGE),D.copyTexImage2D(D.TEXTURE_2D,0,D.RGBA,0,0,Ke,st,0)}ge&&We(!0,!1,Pe),De&&We(!1,!0,Pe)}}else ge&&Be(!0),De&&Be(!1)}}},hillshade:function(_,o,h,x){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent"||_.style.disableElevatedTerrain)return;const I=_.context,A=_.terrain&&_.terrain.renderingToTexture,[D,N]=_.renderPass!=="translucent"||A?[{},x]:_.stencilConfigForOverlap(x);for(const U of N){const Z=o.getTile(U);if(Z.needsHillshadePrepare&&_.renderPass==="offscreen")sp(_,Z,h);else if(_.renderPass==="translucent"){const J=_.depthModeForSublayer(0,Un.ReadOnly),ee=h.paint.get("hillshade-emissive-strength"),ae=_.colorModeForDrapableLayerRenderPass(ee),he=A&&_.terrain?_.terrain.stencilModeForRTTOverlap(U):D[U.overscaledZ];qu(_,U,Z,h,J,he,ae)}}I.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,o,h,x,I,A){if(_.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;const D=_.transform.projection.name==="globe",N=h.paint.get("raster-elevation")!==0,U=N&&D;if(_.renderElevatedRasterBackface&&!U)return;const Z=_.context,J=Z.gl,ee=o.getSource(),ae=function(Pe,Ke,st,pt){const Tt=Ke.paint.get("raster-color"),Zt=Pe.type==="raster-array",xt=[],hr=Ke.paint.get("raster-resampling"),tr=Ke.paint.get("raster-color-mix");let Cr=Ke.paint.get("raster-color-range");const zt=[tr[0],tr[1],tr[2],0],ir=tr[3];let vt=hr==="nearest"?pt.NEAREST:pt.LINEAR;if(Zt&&(xt.push("RASTER_ARRAY"),Tt||xt.push("RASTER_COLOR"),hr==="linear"&&xt.push("RASTER_ARRAY_LINEAR"),vt=pt.NEAREST,!Cr&&Pe.rasterLayers)){const Ut=Pe.rasterLayers.find(({id:Lr})=>Lr===Ke.sourceLayer);Ut&&Ut.fields&&Ut.fields.range&&(Cr=Ut.fields.range)}if(Cr=Cr||[0,1],Tt){xt.push("RASTER_COLOR"),st.activeTexture.set(pt.TEXTURE2),Ke.updateColorRamp(Cr);let Ut=Ke.colorRampTexture;Ut||(Ut=Ke.colorRampTexture=new s.T(st,Ke.colorRamp,pt.RGBA)),Ut.bind(pt.LINEAR,pt.CLAMP_TO_EDGE)}return{mix:zt,range:Cr,offset:ir,defines:xt,resampling:vt}}(ee,h,Z,J);if(ee instanceof s.ap&&!x.length&&!D)return;const he=h.paint.get("raster-emissive-strength"),we=_.colorModeForDrapableLayerRenderPass(he),xe=_.terrain&&_.terrain.renderingToTexture,Ce=!_.options.moving,ge=h.paint.get("raster-resampling")==="nearest"?J.NEAREST:J.LINEAR;if(ee instanceof s.ap&&!x.length&&(ee.onNorthPole||ee.onSouthPole)){const Pe=N?_.stencilModeFor3D():ui.disabled;return void vr(!!ee.onNorthPole,null,_,o,h,he,ae,Dn.disabled,Pe)}if(!x.length)return;const[De,Xe]=ee instanceof s.ap||xe?[{},x]:_.stencilConfigForOverlap(x),Be=Xe[Xe.length-1].overscaledZ;U&&ae.defines.push("PROJECTION_GLOBE_VIEW"),N&&ae.defines.push("RENDER_CUTOFF");const We=(Pe,Ke,st)=>{for(const pt of Pe){const Tt=pt.toUnwrapped(),Zt=o.getTile(pt);if(xe&&(!Zt||!Zt.hasData()))continue;Z.activeTexture.set(J.TEXTURE0);const xt=wr(Zt,ee,h,ae);if(!xt||!xt.texture)continue;const{texture:hr,mix:tr,offset:Cr,tileSize:zt,buffer:ir}=xt;let vt,Ut;xe?(vt=Un.disabled,Ut=pt.projMatrix):N?(vt=new Un(J.LEQUAL,Un.ReadWrite,_.depthRangeFor3D),Ut=D?Float32Array.from(_.transform.expandedFarZProjMatrix):_.transform.calculateProjMatrix(Tt,Ce)):(vt=_.depthModeForSublayer(pt.overscaledZ-Be,h.paint.get("raster-opacity")===1?Un.ReadWrite:Un.ReadOnly,J.LESS),Ut=_.transform.calculateProjMatrix(Tt,Ce));const Lr=_.terrain&&xe?_.terrain.stencilModeForRTTOverlap(pt):De[pt.overscaledZ],Wr=A?0:h.paint.get("raster-fade-duration");Zt.registerFadeDuration(Wr);const Gr=o.findLoadedParent(pt,0),tn=Cs(Zt,Gr,o,_.transform,Wr);let _n,Fn;_.terrain&&_.terrain.prepareDrawTile(),Z.activeTexture.set(J.TEXTURE0),hr.bind(ge,J.CLAMP_TO_EDGE),Z.activeTexture.set(J.TEXTURE1),Gr?(Gr.texture&&Gr.texture.bind(ge,J.CLAMP_TO_EDGE),_n=Math.pow(2,Gr.tileID.overscaledZ-Zt.tileID.overscaledZ),Fn=[Zt.tileID.canonical.x*_n%1,Zt.tileID.canonical.y*_n%1]):hr.bind(ge,J.CLAMP_TO_EDGE),hr.useMipmap&&Z.extTextureFilterAnisotropic&&_.transform.pitch>20&&J.texParameterf(J.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const wn=_.transform;let Sn;const Mi=N?mr(wn):[0,0,0,0];let pi,Ci,Ti,ro,Ro,Vi=0;if(U&&ee instanceof s.ap&&ee.coordinates.length>3)pi=Float32Array.from(s.aT(s.ci(new s.bs(0,0,0)))),Ci=Float32Array.from(wn.globeMatrix),Ti=Float32Array.from(s.ce(wn)),ro=[s.a5(wn.center.lng),s.ae(wn.center.lat)],Sn=ee.elevatedGlobePerspectiveTransform,Ro=ee.elevatedGlobeGridMatrix||new Float32Array(9);else if(U){const oi=s.cf(pt.canonical);Vi=s.cg(oi.getCenter().lat),pi=Float32Array.from(s.aT(s.ci(pt.canonical))),Ci=Float32Array.from(wn.globeMatrix),Ti=Float32Array.from(s.ce(wn)),ro=[s.a5(wn.center.lng),s.ae(wn.center.lat)],Sn=[0,0],Ro=Float32Array.from(s.ch(pt.canonical,oi,Vi,wn.worldSize/wn._pixelsPerMercatorPixel))}else Sn=ee instanceof s.ap?ee.perspectiveTransform:[0,0],pi=new Float32Array(16),Ci=new Float32Array(9),Ti=new Float32Array(16),ro=[0,0],Ro=new Float32Array(9);const Zo=Xu(Ut,pi,Ci,Ti,Ro,Fn||[0,0],s.S(_.transform.zoom),ro,Mi,_n||1,tn,h,Sn,N?h.paint.get("raster-elevation"):0,2,tr,Cr,ae.range,zt,ir,he),fi=_.isTileAffectedByFog(pt),Ji=_.getOrCreateProgram("raster",{defines:ae.defines,overrideFog:fi});if(_.uploadCommonUniforms(Z,Ji,Tt),ee instanceof s.ap){const oi=ee.elevatedGlobeVertexBuffer,no=ee.elevatedGlobeIndexBuffer;if(xe||!D)ee.boundsBuffer&&ee.boundsSegments&&Ji.draw(_,J.TRIANGLES,vt,ui.disabled,we,Dn.disabled,Zo,h.id,ee.boundsBuffer,_.quadTriangleIndexBuffer,ee.boundsSegments);else if(oi&&no){const Bo=wn.zoom<=s.bG?ee.elevatedGlobeSegments:ee.getSegmentsForLongitude(wn.center.lng);Bo&&Ji.draw(_,J.TRIANGLES,vt,ui.disabled,we,Ke,Zo,h.id,oi,no,Bo)}}else if(U){vt=new Un(J.LEQUAL,Un.ReadOnly,_.depthRangeFor3D);const oi=_.globeSharedBuffers;if(oi){const[no,Bo,ji]=oi.getGridBuffers(Vi,!1);Ji.draw(_,J.TRIANGLES,vt,st||Lr,_.colorModeForRenderPass(),Ke,Zo,h.id,no,Bo,ji)}}else{const{tileBoundsBuffer:oi,tileBoundsIndexBuffer:no,tileBoundsSegments:Bo}=_.getTileBoundsBuffers(Zt);Ji.draw(_,J.TRIANGLES,vt,Lr,we,Dn.disabled,Zo,h.id,oi,no,Bo)}}if(!(ee instanceof s.ap)&&U)for(const pt of Pe){const Tt=pt.canonical.y===(1<<pt.canonical.z)-1;pt.canonical.y===0&&vr(!0,pt,_,o,h,he,ae,Ke,st||ui.disabled),Tt&&vr(!1,pt,_,o,h,he,ae,Ke===Dn.frontCW?Dn.backCW:Dn.frontCW,st||ui.disabled)}};U?We(Xe,_.renderElevatedRasterBackface?Dn.backCW:Dn.frontCW,_.stencilModeFor3D()):We(Xe,Dn.disabled,void 0),_.resetStencilClippingMasks()},"raster-particle":function(_,o,h,x,I,A){_.renderPass==="offscreen"&&function(D,N,U,Z){if(!Z.length)return;const J=D.context,ee=J.gl,ae=N.getSource();if(!(ae instanceof Rt))return;const he=[];for(const Ce of Z){const ge=N.getTile(Ce);if(!(ge instanceof iu))continue;const De=Ur(ge,ae,U);if(!De)continue;const Xe=[De.tileSize,De.tileSize];let Be=U.tileFramebuffer;Be||(Be=U.tileFramebuffer=J.createFramebuffer(Xe[0],Xe[1],!0,null));let We=ge.rasterParticleState;const Pe=U.paint.get("raster-particle-count");We||(We=ge.rasterParticleState=new ta(J,Ce,Xe,Pe));const Ke=We.update(U.lastInvalidatedAt);We.numParticles!==Pe&&We.setNumParticles(Ce,Pe);const st=We.targetColorTexture;We.targetColorTexture=We.backgroundColorTexture,We.backgroundColorTexture=st;const pt=We.particleVertices0;We.particleVertices0=We.particleVertices1,We.particleVertices1=pt,he.push([Ce,De,We,Ke])}if(he.length===0)return;const we=s.f.now(),xe=U.previousDrawTimestamp?.001*(we-U.previousDrawTimestamp):.0167;if(U.previousDrawTimestamp=we,U.hasColorMap()){J.activeTexture.set(ee.TEXTURE0+2);let Ce=U.colorRampTexture;Ce||(Ce=U.colorRampTexture=new s.T(J,U.colorRamp,ee.RGBA)),Ce.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}J.bindFramebuffer.set(U.tileFramebuffer.framebuffer),J.activeTexture.set(ee.TEXTURE0),function(Ce,ge,De){const Xe=Ce.context,Be=Xe.gl,We=ge.tileFramebuffer;Xe.activeTexture.set(Be.TEXTURE0);const Pe={u_texture:0,u_opacity:1.05*(st=ge.paint.get("raster-particle-fade-opacity-factor"))/(st+.05)},Ke=Ce.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var st;for(const pt of De){const[,,Tt,Zt]=pt;We.colorAttachment.set(Tt.targetColorTexture.texture),Xe.viewport.set([0,0,We.width,We.height]),Xe.clear({color:s.ax.transparent}),Zt&&(Tt.backgroundColorTexture.bind(Be.NEAREST,Be.CLAMP_TO_EDGE),Ke.draw(Ce,Be.TRIANGLES,Un.disabled,ui.disabled,Fi.alphaBlended,Dn.disabled,Pe,ge.id,Ce.viewportBuffer,Ce.quadTriangleIndexBuffer,Ce.viewportSegments))}}(D,U,he),function(Ce,ge,De,Xe){const Be=Ce.context.gl,We=De.tileFramebuffer,Pe=Ce.transform.projection.name==="globe",Ke=De.paint.get("raster-particle-max-speed");for(const st of Xe){const[pt,Tt,Zt]=st;Tt.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),We.colorAttachment.set(Zt.targetColorTexture.texture);const xt=Ce.getOrCreateProgram("rasterParticleDraw",{defines:Tt.defines,overrideFog:!1}),hr=Tt.scalarData?[]:[0,1,2,3].map(zt=>s.cG[zt](pt));hr.push(pt);const tr=pt.canonical.x,Cr=pt.canonical.y;for(const zt of hr){const ir=ge.getTile(Pe?zt.wrapped():zt);if(!ir)continue;const vt=ir.rasterParticleState;if(!vt)continue;const Ut=Yu([zt.canonical.x+(1<<zt.canonical.z)*(zt.wrap-pt.wrap)-tr,zt.canonical.y-Cr],0,Tt.texture.size,2,Ke,Tt.textureOffset,Tt.scale,Tt.offset);xt.draw(Ce,Be.POINTS,Un.disabled,ui.disabled,Fi.alphaBlended,Dn.disabled,Ut,De.id,vt.particleVertices0,void 0,vt.particleSegment)}}}(D,N,U,he),function(Ce,ge,De,Xe){const Be=Ce.context.gl;let We=ge.transformFeedbackObject;We||(We=ge.transformFeedbackObject=Be.createTransformFeedback()),Be.bindTransformFeedback(Be.TRANSFORM_FEEDBACK,ge.transformFeedbackObject);const Pe=ge.paint.get("raster-particle-max-speed"),Ke=Xe*ge.paint.get("raster-particle-speed-factor")*.3,st=(pt=ge.paint.get("raster-particle-reset-rate-factor"),Math.pow(pt,6));var pt;for(const Tt of De){const[,Zt,xt]=Tt;Zt.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE);const hr=yu(0,Zt.texture.size,Pe,Ke,st,Zt.textureOffset,Zt.scale,Zt.offset);Ce.getOrCreateProgram("rasterParticleUpdate",{defines:Zt.defines,transformFeedback:{bufferMode:Be.SEPARATE_ATTRIBS,shaderVaryings:["v_new_particle"]}}).draw(Ce,Be.POINTS,Un.disabled,ui.disabled,Fi.disabled,Dn.disabled,hr,ge.id,xt.particleVertices0,void 0,xt.particleSegment,{},void 0,void 0,void 0,void 0,[{buffer:xt.particleVertices1,targetIndex:0}])}Be.bindTransformFeedback(Be.TRANSFORM_FEEDBACK,null)}(D,U,he,xe)}(_,o,h,x),_.renderPass==="translucent"&&(function(D,N,U,Z,J){const ee=D.context,ae=ee.gl,he=!D.options.moving,we=D.transform.projection.name==="globe";if(!Z.length)return;const[xe,Ce]=D.stencilConfigForOverlap(Z),ge=[];we&&ge.push("PROJECTION_GLOBE_VIEW");for(const De of Ce){const Xe=De.toUnwrapped(),Be=N.getTile(De);if(!Be.rasterParticleState)continue;const We=Be.rasterParticleState,Pe=100;Be.registerFadeDuration(Pe);const Ke=N.findLoadedParent(De,0),st=Cs(Be,Ke,N,D.transform,Pe);let pt,Tt;D.terrain&&D.terrain.prepareDrawTile(),ee.activeTexture.set(ae.TEXTURE0),We.targetColorTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),ee.activeTexture.set(ae.TEXTURE1),Ke&&Ke.rasterParticleState?(Ke.rasterParticleState.targetColorTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),pt=Math.pow(2,Ke.tileID.overscaledZ-Be.tileID.overscaledZ),Tt=[Be.tileID.canonical.x*pt%1,Be.tileID.canonical.y*pt%1]):We.targetColorTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE);const Zt=we?Float32Array.from(D.transform.expandedFarZProjMatrix):D.transform.calculateProjMatrix(Xe,he),xt=D.transform,hr=on(xt),tr=s.cf(De.canonical),Cr=s.cg(tr.getCenter().lat);let zt,ir,vt,Ut,Lr;we?(zt=Float32Array.from(s.aT(s.ci(De.canonical))),ir=Float32Array.from(xt.globeMatrix),vt=Float32Array.from(s.ce(xt)),Ut=[s.a5(xt.center.lng),s.ae(xt.center.lat)],Lr=Float32Array.from(s.ch(De.canonical,tr,Cr,xt.worldSize/xt._pixelsPerMercatorPixel))):(zt=new Float32Array(16),ir=new Float32Array(9),vt=new Float32Array(16),Ut=[0,0],Lr=new Float32Array(9));const Wr=Ff(Zt,zt,ir,vt,Lr,Tt||[0,0],s.S(D.transform.zoom),Ut,hr,pt||1,st,250),Gr=D.isTileAffectedByFog(De),tn=D.getOrCreateProgram("rasterParticle",{defines:ge,overrideFog:Gr});if(D.uploadCommonUniforms(ee,tn,Xe),we){const _n=new Un(ae.LEQUAL,Un.ReadWrite,D.depthRangeFor3D),Fn=0,wn=D.globeSharedBuffers;if(wn){const[Sn,Mi,pi]=wn.getGridBuffers(Cr,Fn!==0);tn.draw(D,ae.TRIANGLES,_n,ui.disabled,Fi.alphaBlended,Dn.backCCW,Wr,U.id,Sn,Mi,pi)}}else{const _n=D.depthModeForSublayer(0,Un.ReadOnly),Fn=xe[De.overscaledZ],{tileBoundsBuffer:wn,tileBoundsIndexBuffer:Sn,tileBoundsSegments:Mi}=D.getTileBoundsBuffers(Be);tn.draw(D,ae.TRIANGLES,_n,Fn,Fi.alphaBlended,Dn.disabled,Wr,U.id,wn,Sn,Mi)}}D.resetStencilClippingMasks()}(_,o,h,x),_.style.map.triggerRepaint())},background:function(_,o,h,x){const I=h.paint.get("background-color"),A=h.paint.get("background-opacity"),D=h.paint.get("background-emissive-strength");if(A===0)return;const N=_.context,U=N.gl,Z=_.transform,J=Z.tileSize,ee=h.paint.get("background-pattern");if(_.isPatternMissing(ee,h.scope))return;const ae=!ee&&I.a===1&&A===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==ae)return;const he=ui.disabled,we=_.depthModeForSublayer(0,ae==="opaque"?Un.ReadWrite:Un.ReadOnly),xe=_.colorModeForDrapableLayerRenderPass(D),Ce=ee?"backgroundPattern":"background";let ge,De=x;De||(ge=_.getBackgroundTiles(),De=Object.values(ge).map(Xe=>Xe.tileID)),ee&&(N.activeTexture.set(U.TEXTURE0),_.imageManager.bind(_.context,h.scope));for(const Xe of De){const Be=_.isTileAffectedByFog(Xe),We=_.getOrCreateProgram(Ce,{overrideFog:Be}),Pe=Xe.toUnwrapped(),Ke=x?Xe.projMatrix:_.transform.calculateProjMatrix(Pe);_.prepareDrawTile();const st=o?o.getTile(Xe):ge?ge[Xe.key]:new hc(Xe,J,Z.zoom,_),pt=ee?Ch(Ke,D,A,_,ee,h.scope,{tileID:Xe,tileSize:J}):Ih(Ke,D,A,I);_.uploadCommonUniforms(N,We,Pe);const{tileBoundsBuffer:Tt,tileBoundsIndexBuffer:Zt,tileBoundsSegments:xt}=_.getTileBoundsBuffers(st);We.draw(_,U.TRIANGLES,we,he,xe,Dn.disabled,pt,h.id,Tt,Zt,xt)}},sky:function(_,o,h){const x=_._atmosphere?s.S(_.transform.zoom):1,I=h.paint.get("sky-opacity")*x;if(I===0)return;const A=_.context,D=h.paint.get("sky-type"),N=new Un(A.gl.LEQUAL,Un.ReadOnly,[0,1]),U=_.frameCounter/1e3%1;D==="atmosphere"?_.renderPass==="offscreen"?h.needsSkyboxCapture(_)&&(function(Z,J,ee,ae){const he=Z.context,we=he.gl;let xe=J.skyboxFbo;if(!xe){xe=J.skyboxFbo=he.createFramebuffer(32,32,!0,null),J.skyboxGeometry=new yi(he),J.skyboxTexture=he.gl.createTexture(),we.bindTexture(we.TEXTURE_CUBE_MAP,J.skyboxTexture),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_CUBE_MAP,we.TEXTURE_MAG_FILTER,we.LINEAR);for(let Xe=0;Xe<6;++Xe)we.texImage2D(we.TEXTURE_CUBE_MAP_POSITIVE_X+Xe,0,we.RGBA,32,32,0,we.RGBA,we.UNSIGNED_BYTE,null)}he.bindFramebuffer.set(xe.framebuffer),he.viewport.set([0,0,32,32]);const Ce=J.getCenter(Z,!0),ge=Z.getOrCreateProgram("skyboxCapture"),De=new Float64Array(16);s.a6.identity(De),s.a6.rotateY(De,De,.5*-Math.PI),ii(Z,J,ge,De,Ce,0),s.a6.identity(De),s.a6.rotateY(De,De,.5*Math.PI),ii(Z,J,ge,De,Ce,1),s.a6.identity(De),s.a6.rotateX(De,De,.5*-Math.PI),ii(Z,J,ge,De,Ce,2),s.a6.identity(De),s.a6.rotateX(De,De,.5*Math.PI),ii(Z,J,ge,De,Ce,3),s.a6.identity(De),ii(Z,J,ge,De,Ce,4),s.a6.identity(De),s.a6.rotateY(De,De,Math.PI),ii(Z,J,ge,De,Ce,5),he.viewport.set([0,0,Z.width,Z.height])}(_,h),h.markSkyboxValid(_)):_.renderPass==="sky"&&function(Z,J,ee,ae,he){const we=Z.context,xe=we.gl,Ce=Z.transform,ge=Z.getOrCreateProgram("skybox");we.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_CUBE_MAP,J.skyboxTexture);const De=((Xe,Be,We,Pe,Ke)=>({u_matrix:Xe,u_sun_direction:Be,u_cubemap:0,u_opacity:Pe,u_temporal_offset:Ke}))(Ce.skyboxMatrix,J.getCenter(Z,!1),0,ae,he);Z.uploadCommonUniforms(we,ge),ge.draw(Z,xe.TRIANGLES,ee,ui.disabled,Z.colorModeForRenderPass(),Dn.backCW,De,"skybox",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(_,h,N,I,U):D==="gradient"&&_.renderPass==="sky"&&function(Z,J,ee,ae,he){const we=Z.context,xe=we.gl,Ce=Z.transform,ge=Z.getOrCreateProgram("skyboxGradient");J.skyboxGeometry||(J.skyboxGeometry=new yi(we)),we.activeTexture.set(xe.TEXTURE0);let De=J.colorRampTexture;De||(De=J.colorRampTexture=new s.T(we,J.colorRamp,xe.RGBA)),De.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Xe=((Be,We,Pe,Ke,st)=>({u_matrix:Be,u_color_ramp:0,u_center_direction:We,u_radius:s.bj(Pe),u_opacity:Ke,u_temporal_offset:st}))(Ce.skyboxMatrix,J.getCenter(Z,!1),J.paint.get("sky-gradient-radius"),ae,he);Z.uploadCommonUniforms(we,ge),ge.draw(Z,xe.TRIANGLES,ee,ui.disabled,Z.colorModeForRenderPass(),Dn.backCW,Xe,"skyboxGradient",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)}(_,h,N,I,U)},debug:function(_,o,h,x,I,A){for(let D=0;D<h.length;D++)if(I){const Z=new s.ax(x.r*.8,x.g*.8,x.b*.8,1);io(_,o,h[D],x,-1,-1,A),io(_,o,h[D],x,-1,1,A),io(_,o,h[D],x,1,1,A),io(_,o,h[D],x,1,-1,A),io(_,o,h[D],Z,0,0,A)}else io(_,o,h[D],x,0,0,A)},custom:function(_,o,h,x){const I=_.context,A=h.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&h.isLayerDraped(o)){if(_.renderPass==="offscreen"){const D=A.prerender;if(D){if(_.setCustomLayerDefaults(),I.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const N=_.transform.pointMerc;D.call(A,I.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.S(_.transform.zoom),[N.x,N.y],_.transform.pixelsPerMeterRatio)}else D.call(A,I.gl,_.transform.customLayerMatrix());I.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const N=A.renderToTile;if(N){const U=x[0].canonical,Z=new s.L(U.x+x[0].wrap*(1<<U.z),U.y,U.z);I.setDepthMode(Un.disabled),I.setStencilMode(ui.disabled),I.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),N.call(A,I.gl,Z),I.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),I.setColorMode(_.colorModeForRenderPass()),I.setStencilMode(ui.disabled);const D=A.renderingMode==="3d"?new Un(_.context.gl.LEQUAL,Un.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,Un.ReadOnly);if(I.setDepthMode(D),_.transform.projection.name==="globe"){const N=_.transform.pointMerc;A.render(I.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.S(_.transform.zoom),[N.x,N.y],_.transform.pixelsPerMeterRatio)}else A.render(I.gl,_.transform.customLayerMatrix());I.setDirty(),_.setBaseState(),I.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(_,o,h,x){if(_.renderPass==="opaque")return;const I=h.paint.get("model-opacity");if(I===0)return;const A=h.paint.get("model-cast-shadows");if(_.renderPass==="shadow"&&(!A||_.terrain&&I<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof s.Z))return;const D=_.shadowRenderer,N=h.paint.get("model-receive-shadows");D&&(D.useNormalOffset=!0,N||(D.enabled=!1));const U=()=>{D&&(D.useNormalOffset=!0,N||(D.enabled=!0))},Z=o.getSource();if(_.renderPass==="light-beam"&&Z.type!=="batched-model")return;if(Z.type==="vector"||Z.type==="geojson")return function(ge,De,Xe,Be){const We=ge.transform;if(We.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${We.projection.name} projection is not yet implemented`);const Pe=We.getFreeCameraOptions().position;if(!ge.modelManager)return;const Ke=ge.modelManager;Xe.modelManager=Ke;const st=ge.shadowRenderer;if(!Xe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const pt=Xe._unevaluatedLayout._values["model-id"],Tt={...Xe.layout.get("model-id").parameters};for(const Zt of Be){const xt=De.getTile(Zt).getBucket(Xe);if(!xt||xt.projection.name!==We.projection.name)continue;const hr=wd(Zt,We);Tt.zoom=hr;const tr=pt.possiblyEvaluate(Tt);if(jl(ge,xt,Zt),Pa.shadowUniformsInitialized=!1,Pa.useSingleShadowCascade=!!st&&st.getMaxCascadeForTile(Zt.toUnwrapped())===0,ge.renderPass==="shadow"&&st){if(ge.currentShadowCascade===1&&xt.isInsideFirstShadowMapFrustum)continue;const ir=We.calculatePosMatrix(Zt.toUnwrapped(),We.worldSize);if(Pa.tileMatrix.set(ir),Pa.shadowTileMatrix=Float32Array.from(st.calculateShadowPassMatrixFromMatrix(ir)),Pa.aabb.min.fill(0),Pa.aabb.max[0]=Pa.aabb.max[1]=s.V,Pa.aabb.max[2]=0,Sd(xt,Pa,ge,Xe.scope))continue}const Cr=1<<Zt.canonical.z,zt=[((Pe.x-Zt.wrap)*Cr-Zt.canonical.x)*s.V,(Pe.y*Cr-Zt.canonical.y)*s.V,Pe.z*Cr*s.V];for(let ir in xt.instancesPerModel){const vt=xt.instancesPerModel[ir];vt.features.length>0&&(ir=tr.evaluate(vt.features[0].feature,{}));const Ut=Ke.getModel(ir,Xe.scope);if(Ut&&Ut.uploaded)for(const Lr of Ut.nodes)Ku(ge,Xe,Lr,vt,zt,Zt,Pa)}}}(_,o,h,x),void U();if(!Z.loaded())return;if(Z.type==="batched-model")return function(ge,De,Xe,Be){Xe.resetLayerRenderingStats(ge);const We=ge.context,Pe=ge.transform,Ke=ge.style.fog,st=ge.shadowRenderer;if(Pe.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${Pe.projection.name} projection is not yet implemented`);const pt=ge.transform.getFreeCameraOptions().position,Tt=s.N.scale([],[pt.x,pt.y,pt.z],ge.transform.worldSize);s.N.negate(Tt,Tt);const Zt=s.a6.identity([]),xt=s.cR(Pe.center.lat,Pe.zoom),hr=s.a6.fromScaling([],[1,1,1/xt]);s.a6.translate(Zt,Zt,Tt);const tr=Xe.paint.get("model-opacity"),Cr=new Un(We.gl.LEQUAL,Un.ReadWrite,ge.depthRangeFor3D),zt=new Un(We.gl.LEQUAL,Un.ReadOnly,ge.depthRangeFor3D),ir=new s.bS([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),vt=ge.renderPass==="shadow",Ut=vt&&st?st.getCurrentCascadeFrustum():Pe.getFrustum(Pe.scaleZoom(Pe.worldSize)),Lr=Xe.getLayerRenderingStats(),Wr=function(Gr,tn){for(const _n of Be){const Fn=De.getTile(_n).getBucket(Xe);if(!Fn||!Fn.uploaded)continue;let wn=!1;st&&(wn=st.getMaxCascadeForTile(_n.toUnwrapped())===0);const Sn=Pe.calculatePosMatrix(_n.toUnwrapped(),Pe.worldSize),Mi=Fn.modelTraits;for(const pi of Fn.getNodesInfo()){if(pi.hiddenByReplacement||!pi.node.meshes)continue;const Ci=pi.evaluatedScale,Ti=pi.node;let ro=0;if(ge.terrain&&Ti.elevation&&(ro=Ti.elevation*ge.terrain.exaggeration()),Ci[0]<=1&&Ci[1]<=1&&Ci[2]<=1&&(()=>{const Bo=pi.getLocalBounds();return ir.min=[...Bo.min],ir.max=[...Bo.max],ir.min[2]+=ro,ir.max[2]+=ro,s.N.transformMat4(ir.min,ir.min,Sn),s.N.transformMat4(ir.max,ir.max,Sn),ir})().intersects(Ut)===0)continue;const Ro=ge.renderPass==="light-beam",Vi=[...Sn];s.a6.translate(Vi,Vi,[(Ti.anchor?Ti.anchor[0]:0)*(Ci[0]-1),(Ti.anchor?Ti.anchor[1]:0)*(Ci[1]-1),ro]),s.N.exactEquals(Ci,s.cT)||s.a6.scale(Vi,Vi,Ci),s.a6.multiply(Vi,Vi,Ti.matrix);const Zo=s.a6.multiply([],hr,Vi);s.a6.multiply(Zo,Zt,Zo);const fi=s.a6.invert([],Zo);s.a6.transpose(fi,fi),s.a6.scale(fi,fi,Bl);const Ji=s.a6.multiply([],Pe.expandedFarZProjMatrix,Vi),oi=Mi&s.cV.HasMapboxMeshFeatures,no=oi?0:pi.evaluatedRMEA[0][2];for(let Bo=0;Bo<Ti.meshes.length;++Bo){const ji=Ti.meshes[Bo],vs=Bo===Ti.lightMeshIndex;if(vs){if(!Ro&&!ge.terrain&&ge.shadowRenderer){ge.currentLayer<ge.firstLightBeamLayer&&(ge.firstLightBeamLayer=ge.currentLayer);continue}}else if(Ro)continue;const js={defines:[]},ac=[];if(go(js.defines,ac,ji,ge),oi||js.defines.push("DIFFUSE_SHADED"),wn&&js.defines.push("SHADOWS_SINGLE_CASCADE"),Lr&&(vt?Lr.numRenderedVerticesInShadowPass+=ji.vertexArray.length:Lr.numRenderedVerticesInTransparentPass+=ji.vertexArray.length),vt){jt(ji,Vi,ge,Xe);continue}let bu=null;if(Ke){const Tl=na(Vi,ge.transform);if(bu=new Float32Array(Tl),Pe.projection.name!=="globe"){const wu=ji.aabb.min,Oh=ji.aabb.max,[gp,of]=Ke.getOpacityForBounds(Tl,wu[0],wu[1],Oh[0],Oh[1]);js.overrideFog=gp>=mi||of>=mi}}const Sl=ji.material;let ss;Sl.occlusionTexture&&Sl.occlusionTexture.offsetScale&&(ss=Sl.occlusionTexture.offsetScale,js.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!vt&&st&&(st.useNormalOffset=!!ji.normalBuffer);const ls=ge.getOrCreateProgram("model",js);!vt&&st&&st.setupShadowsFromMatrix(Vi,ls,st.useNormalOffset),ge.uploadCommonUniforms(We,ls,_n.toUnwrapped(),bu);const ul=Sl.pbrMetallicRoughness;ul.metallicFactor=.9,ul.roughnessFactor=.5;const Ps=Ah(new Float32Array(Ji),new Float32Array(Zo),new Float32Array(fi),ge,tr,ul.baseColorFactor,Sl.emissiveFactor,ul.metallicFactor,ul.roughnessFactor,Sl,no,Xe,[0,0,0],ss);ls.draw(ge,We.gl.TRIANGLES,tn&&!vs?Cr:zt,ui.disabled,Gr?vs||tr<1||pi.hasTranslucentParts?Fi.alphaBlended:Fi.unblended:Fi.disabled,Dn.backCCW,Ps,Xe.id,ji.vertexBuffer,ji.indexBuffer,ji.segments,Xe.paint,ge.transform.zoom,void 0,ac)}}}};(function(Gr,tn,_n,Fn){const wn=Gr.terrain?Gr.terrain.exaggeration():0,Sn=Gr.transform.zoom;for(const Mi of Fn){const pi=tn.getTile(Mi).getBucket(_n);pi&&(Gr.conflationActive&&pi.updateReplacement(Mi,Gr.replacementSource),pi.evaluateScale(Gr,_n),Gr.terrain&&wn>0&&pi.elevationUpdate(Gr.terrain,wn,Mi,_n.source),pi.needsReEvaluation(Gr,Sn,_n)&&pi.evaluate(_n))}})(ge,De,Xe,Be),tr===1?Wr(!0,!0):(Wr(!1,!0),Wr(!0,!1))}(_,o,h,x),void U();const J=Z.getModels(),ee=[],ae=_.transform.getFreeCameraOptions().position,he=s.N.scale([],[ae.x,ae.y,ae.z],_.transform.worldSize);s.N.negate(he,he);const we=[],xe=[];let Ce=0;for(const ge of J){const De=h.paint.get("model-rotation").constantOr(null),Xe=h.paint.get("model-scale").constantOr(null),Be=h.paint.get("model-translation").constantOr(null);ge.computeModelMatrix(_,De,Xe,Be,!0,!0,!1);const We=s.a6.identity([]),Pe=s.cR(ge.position.lat,_.transform.zoom),Ke=s.a6.fromScaling([],[1,1,1/Pe]);s.a6.translate(We,We,he),ee.push({zScaleMatrix:Ke,negCameraPosMatrix:We});for(const st of ge.nodes)rc(_.transform,st,ge.matrix,_.transform.expandedFarZProjMatrix,Ce,we,xe);Ce++}if(we.sort((ge,De)=>De.depth-ge.depth),_.renderPass!=="shadow"){if(I===1)for(const ge of xe)os(ge,_,h,ee[ge.modelIndex],ui.disabled,_.colorModeForRenderPass());else{for(const ge of xe)os(ge,_,h,ee[ge.modelIndex],ui.disabled,Fi.disabled);for(const ge of xe)os(ge,_,h,ee[ge.modelIndex],_.stencilModeFor3D(),_.colorModeForRenderPass());_.resetStencilClippingMasks()}for(const ge of we)os(ge,_,h,ee[ge.modelIndex],ui.disabled,_.colorModeForRenderPass());U()}else{for(const ge of xe)jt(ge.mesh,ge.nodeModelMatrix,_,h);for(const ge of we)jt(ge.mesh,ge.nodeModelMatrix,_,h);U()}}},qa={model:function(_,o,h){const x=_.scope,I=o.getSource();if(!I.loaded())return;if(I.type==="vector"||I.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,x));if(I.type==="batched-model")return;const A=I.getModels();for(const D of A)D.upload(h.context)},raster:function(_,o,h){const x=o.getSource();if(!(x instanceof Rt&&x.loaded()))return;const I=_.sourceLayer||x.rasterLayerIds&&x.rasterLayerIds[0];if(!I)return;const A=_.paint.get("raster-array-band")||x.getInitialBand(I);if(A==null)return;const D=o.getIds().map(N=>o.getTileByID(N));for(const N of D)N.updateNeeded(I,A)&&x.prepareTile(N,I,A)},"raster-particle":function(_,o,h){const x=o.getSource();if(!(x instanceof Rt&&x.loaded()))return;const I=_.sourceLayer||x.rasterLayerIds&&x.rasterLayerIds[0];if(!I)return;const A=_.paint.get("raster-particle-array-band")||x.getInitialBand(I);if(A==null)return;const D=o.getIds().map(N=>o.getTileByID(N));for(const N of D)N.updateNeeded(I,A)&&x.prepareTile(N,I,A)}};class Fc{constructor(o,h,x,I){this.context=new ru(o,h),this.transform=x,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=I,this._debugParams={showTerrainProxyTiles:!1},I.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),this.setup(),this.numSublayers=Dl.maxUnderzooming+Dl.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.cX,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new co(this),this._wireframeDebugCache=new bc,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(o,h){const x=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Qp(this,o));const I=this._terrain;this.transform.elevation=x?I:null,I.update(o,this.transform,h),this.transform.elevation&&!I.enabled&&(this.transform.elevation=null)}_updateFog(o){const h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,I]=h.getFovAdjustedRange(this.transform._fov);if(x>I)return void(this.transform.fogCullDistSq=null);const A=x+.78*(I-x);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,h){if(this.width=o*s.f.devicePixelRatio,this.height=h*s.f.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._mergedLayers[x].resize()}setup(){const o=this.context,h=new s.aN;h.emplaceBack(0,0),h.emplaceBack(s.V,0),h.emplaceBack(0,s.V),h.emplaceBack(s.V,s.V),this.tileExtentBuffer=o.createVertexBuffer(h,s.aP.members),this.tileExtentSegments=s.aB.simpleSegment(0,0,4,2);const x=new s.aN;x.emplaceBack(0,0),x.emplaceBack(s.V,0),x.emplaceBack(0,s.V),x.emplaceBack(s.V,s.V),this.debugBuffer=o.createVertexBuffer(x,s.aP.members),this.debugSegments=s.aB.simpleSegment(0,0,4,5);const I=new s.aN;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(-1,1),I.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(I,s.aP.members),this.viewportSegments=s.aB.simpleSegment(0,0,4,2);const A=new s.av;A.emplaceBack(0,0,0,0),A.emplaceBack(s.V,0,s.V,0),A.emplaceBack(0,s.V,0,s.V),A.emplaceBack(s.V,s.V,s.V,s.V),this.mercatorBoundsBuffer=o.createVertexBuffer(A,s.aR.members),this.mercatorBoundsSegments=s.aB.simpleSegment(0,0,4,2);const D=new s.aw;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(D);const N=new s.aO;for(const Z of[0,1,3,2,0])N.emplaceBack(Z);this.debugIndexBuffer=o.createIndexBuffer(N),this.emptyTexture=new s.T(o,new s.h({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=s.a6.create();const U=this.context.gl;this.stencilClearMode=new ui({func:U.ALWAYS,mask:0},0,255,U.ZERO,U.ZERO,U.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,Un.disabled,this.stencilClearMode,Fi.disabled,Dn.disabled,zl(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,x){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let N=!1;for(const U of x)if(this._tileClippingMaskIDs[U.key]===void 0){N=!0;break}if(!N)return}this.currentStencilSource=h.id;const I=this.context,A=I.gl;this.nextStencilID+x.length>256&&this.clearStencil(),I.setColorMode(Fi.disabled),I.setDepthMode(Un.disabled);const D=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const N of x){const U=h.getTile(N),Z=this._tileClippingMaskIDs[N.key]=this.nextStencilID++,{tileBoundsBuffer:J,tileBoundsIndexBuffer:ee,tileBoundsSegments:ae}=this.getTileBoundsBuffers(U);D.draw(this,A.TRIANGLES,Un.disabled,new ui({func:A.ALWAYS,mask:0},Z,255,A.KEEP,A.KEEP,A.REPLACE),Fi.disabled,Dn.disabled,zl(N.projMatrix),"$clipping",J,ee,ae)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new ui({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const h=this.context.gl;return new ui({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,x=o.sort((D,N)=>N.overscaledZ-D.overscaledZ),I=x[x.length-1].overscaledZ,A=x[0].overscaledZ-I+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const D={};for(let N=0;N<A;N++)D[N+I]=new ui({func:h.GEQUAL,mask:255},N+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=A,[D,x]}return[{[I]:ui.disabled},x]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Fi([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new s.ax(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Fi.unblended:Fi.alphaBlended}colorModeForDrapableLayerRenderPass(o){const h=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Fi([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new s.ax(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,h,x,I=!1){if(!this.opaquePassEnabledForLayer()&&!I)return Un.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Un(x||this.context.gl.LEQUAL,h,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this._wireframeDebugCache.update(this.frameCounter),this.style=o,this.options=h;const x=this.style._mergedLayers,I=this.style.order,A=I.map(Pe=>x[Pe]),D=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.f.now()),this.imageManager.beginFrame();let N=0,U=!1;for(const Pe in D){const Ke=D[Pe];Ke.used&&(Ke.prepare(this.context),Ke.getSource().usedInConflation&&++N)}for(const Pe of A)Pe.isHidden(this.transform.zoom)||this.prepareLayer(Pe);const Z={},J={},ee={},ae={},he={};for(const Pe in D){const Ke=D[Pe];Z[Pe]=Ke.getVisibleCoordinates(),J[Pe]=Z[Pe].slice().reverse(),ee[Pe]=Ke.getVisibleCoordinates(!0).reverse(),ae[Pe]=Ke.getShadowCasterCoordinates(),he[Pe]=Ke.sortCoordinatesByDistance(Z[Pe])}const we=Pe=>{const Ke=this.style.getLayerSourceCache(Pe);return Ke&&Ke.used?Ke.getSource():null};if(N){const Pe=[];for(const Ke of A)this.layerUsedInConflation(Ke,we(Ke))&&Pe.push(Ke);if(Pe&&Pe.length>1){const Ke=[];for(const st of Pe){const pt=this.style.getLayerSourceCache(st);pt&&pt.used&&pt.getSource().usedInConflation&&Ke.push({layer:st.fqid,cache:pt})}this.replacementSource.setSources(Ke),U=!0}}U||this.replacementSource.clear(),this.conflationActive=U,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const Pe of A){const Ke=Pe.cutoffRange();if(this.longestCutoffRange=Math.max(Ke,this.longestCutoffRange),Ke>0){const st=we(Pe);st&&(this.minCutoffZoom=Math.max(st.minzoom,this.minCutoffZoom)),Pe.minzoom&&(this.minCutoffZoom=Math.max(Pe.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let Pe=0;Pe<A.length;Pe++)if(A[Pe].is3D()){this.opaquePassCutoff=Pe;break}const xe=this.style&&this.style.fog;xe?(this._fogVisible=xe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=xe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ee),this.opaquePassCutoff=0);const Ce=this._shadowRenderer;if(Ce){Ce.updateShadowParameters(this.transform,this.style.directionalLight);for(const Pe in D)for(const Ke of Z[Pe]){let st={min:0,max:0};this.terrain&&(st=this.terrain.getMinMaxForTile(Ke)||st),Ce.addShadowReceiver(Ke.toUnwrapped(),st.min,st.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.cY(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new an(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!s.cZ(this.context.gl))return;this.renderPass="offscreen";for(const Pe of A){const Ke=o.getLayerSourceCache(Pe);if(!Pe.hasOffscreenPass()||Pe.isHidden(this.transform.zoom))continue;const st=Ke?J[Ke.id]:void 0;(Pe.type==="custom"||Pe.type==="raster"||Pe.type==="raster-particle"||Pe.isSky()||st&&st.length)&&this.renderLayer(this,Ke,Pe,st)}this.depthRangeFor3D=[0,1-(A.length+2)*this.numSublayers*this.depthEpsilon];const ge=this.terrain;ge&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&ge.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ae)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const De=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Xe=(()=>{if(h.showOverdrawInspector)return s.ax.black;if(this.style.fog&&this.transform.projection.supportsFog&&!De){const Pe=this.style.fog.properties.get("color").toArray01();return new s.ax(...Pe)}if(this.style.fog&&this.transform.projection.supportsFog&&De){const Pe=this.style.fog.properties.get("space-color").toArray01();return new s.ax(...Pe)}return s.ax.transparent})();if(this.context.clear({color:Xe,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&De&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){const Pe=A[this.currentLayer],Ke=o.getLayerSourceCache(Pe);if(Pe.isSky())continue;const st=Ke?(Pe.is3D()?he:J)[Ke.id]:void 0;this._renderTileClippingMasks(Pe,Ke,st),this.renderLayer(this,Ke,Pe,st)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&De&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.S(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){const Pe=A[this.currentLayer],Ke=o.getLayerSourceCache(Pe);Pe.isSky()&&this.renderLayer(this,Ke,Pe,Ke?J[Ke.id]:void 0)}function Be(Pe,Ke){let st;return Ke&&(st=(Pe.type==="symbol"?ee:Pe.is3D()?he:J)[Ke.id]),st}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<I.length;){const Pe=A[this.currentLayer];if(Pe.type==="raster"){const Ke=o.getLayerSourceCache(Pe);this.renderLayer(this,Ke,Pe,Be(Pe,Ke))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let We=0;for(Ce&&(We=Ce.getShadowCastingLayerCount());this.currentLayer<I.length;){const Pe=A[this.currentLayer],Ke=o.getLayerSourceCache(Pe);if(Pe.isSky())++this.currentLayer;else if(ge&&this.style.isLayerDraped(Pe)){if(Pe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=ge.renderBatch(this.currentLayer)}else{if(this._renderTileClippingMasks(Pe,Ke,Ke?Z[Ke.id]:void 0),this.renderLayer(this,Ke,Pe,Be(Pe,Ke)),!ge&&Ce&&We>0&&Pe.hasShadowPass()&&--We==0&&(Ce.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const st=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=st;this.currentLayer++){const pt=A[this.currentLayer];if(!pt.hasLightBeamPass())continue;const Tt=o.getLayerSourceCache(pt);this.renderLayer(this,Tt,pt,Tt?J[Tt.id]:void 0)}this.currentLayer=st,this.renderPass="translucent"}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Pe=null;A.forEach(Ke=>{const st=o.getLayerSourceCache(Ke);st&&!Ke.isHidden(this.transform.zoom)&&st.getVisibleCoordinates().length&&(!Pe||Pe.getSource().maxzoom<st.getSource().maxzoom)&&(Pe=st)}),Pe&&this.options.showTileBoundaries&&wl.debug(this,Pe,Pe.getVisibleCoordinates(),s.ax.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&wl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.ax(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Pe){const Ke=Pe.transform.padding;An(Pe,Pe.transform.height-(Ke.top||0),3,Hr),An(Pe,Ke.bottom||0,3,mn),Qn(Pe,Ke.left||0,3,Yn),Qn(Pe,Pe.transform.width-(Ke.right||0),3,ni);const st=Pe.transform.centerPoint;(function(pt,Tt,Zt,xt){$n(pt,Tt-1,Zt-10,2,20,xt),$n(pt,Tt-10,Zt-1,20,2,xt)})(Pe,st.x,Pe.transform.height-st.y,Jn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),U||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:h}=this.transform.projection,x=!h||!h.includes(o.type);if(qa[o.type]&&(x||this.terrain&&o.type==="custom")){const I=this.style.getLayerSourceCache(o);qa[o.type](o,I,this)}this.gpuTimingEnd()}renderLayer(o,h,x,I){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||x.type==="model"||x.type==="raster"||x.type==="raster-particle"||I&&I.length)&&(this.id=x.id,this.gpuTimingStart(x),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(x.type)||o.terrain&&x.type==="custom")&&wl[x.type](o,h,x,I,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery,x=this.context.gl;let I=this.gpuTimers[o.id];I||(I=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:x.createQuery()}),I.calls++,x.beginQuery(h.TIME_ELAPSED_EXT,I.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,h=this.context.gl,x=h.createQuery();this.deferredRenderGpuTimeQueries.push(x),h.beginQuery(o.TIME_ELAPSED_EXT,x)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const h={};for(const x in o){const I=o[x],A=this.context.extTimerQuery,D=A.getQueryParameter(I.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(I.query),h[x]=D}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery,x=this.context.gl;let I=0;for(const A of o)I+=h.getQueryParameter(A,x.QUERY_RESULT)/1e6,h.deleteQueryEXT(A);return I}translatePosMatrix(o,h,x,I,A){if(!x[0]&&!x[1])return o;const D=A?I==="map"?this.transform.angle:0:I==="viewport"?-this.transform.angle:0;if(D){const Z=Math.sin(D),J=Math.cos(D);x=[x[0]*J-x[1]*Z,x[0]*Z+x[1]*J]}const N=[A?x[0]:s.a3(h,x[0],this.transform.zoom),A?x[1]:s.a3(h,x[1],this.transform.zoom),0],U=new Float32Array(16);return s.a6.translate(U,o,N),U}saveTileTexture(o){const h=o.size[0],x=this._tileTextures[h];x?x.push(o):this._tileTextures[h]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o,h){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString(),h)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,h,x){const I=x===void 0?this.terrain&&this.terrain.renderingToTexture:x,A=this.terrain&&this.terrain.exaggeration()===0,D=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(D.push("LIGHTING_3D_MODE"),D.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):I||D.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||D.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?D.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):D.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(D.push("TERRAIN"),this.linearFloatFilteringSupported()&&D.push("TERRAIN_DEM_FLOAT_FORMAT"),A&&D.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&D.push("GLOBE"),!this._fogVisible||I||h!==void 0&&!h||D.push("FOG","FOG_DITHERING"),I&&D.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&D.push("OVERDRAW_INSPECTOR"),D}getOrCreateProgram(o,h){this.cache=this.cache||{};const x=h&&h.defines||[],I=h&&h.config,A=h&&h.transformFeedback,D=this.currentGlobalDefines(o,h&&h.overrideFog,h&&h.overrideRtt).concat(x),N=Ql.cacheKey(xd[o],o,D,I);return this.cache[N]||(this.cache[N]=new Ql(this.context,o,xd[o],I,T[o],D,A)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,h){if(this.style.enable3dLights()){const x=this.style.directionalLight,I=this.style.ambientLight;if(x&&I){const A=((D,N)=>{const U=D.properties.get("direction"),Z=D.properties.get("color").toArray01(),J=D.properties.get("intensity"),ee=N.properties.get("color").toArray01(),ae=N.properties.get("intensity"),he=[U.x,U.y,U.z],we=s.cn(ee,ae),xe=s.cn(Z,J);return{u_lighting_ambient_color:we,u_lighting_directional_dir:he,u_lighting_directional_color:xe,u_ground_radiance:As(he,xe,we)}})(x,I);h.setLightsUniformValues(o,A)}}}uploadCommonUniforms(o,h,x,I,A){if(this.uploadCommonLightUniforms(o,h),this.terrain&&this.terrain.renderingToTexture)return;const D=this.style.fog;if(D){const N=D.getOpacity(this.transform.pitch),U=((Z,J,ee,ae,he,we,xe,Ce,ge,De,Xe,Be)=>{const We=Z.transform,Pe=J.properties.get("color").toArray01();Pe[3]=ae;const Ke=Z.frameCounter/1e3%1,[st,pt]=J.properties.get("vertical-range");return{u_fog_matrix:ee?We.calculateFogTileMatrix(ee):Be||Z.identityMat,u_fog_range:J.getFovAdjustedRange(We._fov),u_fog_color:Pe,u_fog_horizon_blend:J.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(st,pt),pt],u_fog_temporal_offset:Ke,u_frustum_tl:he,u_frustum_tr:we,u_frustum_br:xe,u_frustum_bl:Ce,u_globe_pos:ge,u_globe_radius:De,u_viewport:Xe,u_globe_transition:s.S(We.zoom),u_is_globe:+(We.projection.name==="globe")}})(this,D,x,N,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.f.devicePixelRatio,this.transform.height*s.f.devicePixelRatio],I);h.setFogUniformValues(o,U)}A&&h.setCutoffUniformValues(o,A.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,h=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const I of x)h[I.key]=o[I.key]||new hc(I,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(o,h){return!(!o.is3D()||o.minzoom&&o.minzoom>this.transform.zoom||o.sourceLayer!=="building"&&(!h||h.type!=="batched-model"))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[o.key];return h||(this._cachedTileFogOpacities[o.key]=h=this.style.fog.getOpacityForTile(o)),h[0]>=mi||h[1]>=mi}}function nc(_,o){let h=!1,x=null;const I=()=>{x=null,h&&(_(),x=setTimeout(I,o),h=!1)};return()=>(h=!0,x||I(),x)}class Vc{constructor(o){this._hashName=o&&encodeURIComponent(o),s.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=nc(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const h=Co(o);if(this._hashName){const x=this._hashName;let I=!1;const A=location.hash.slice(1).split("&").map(D=>{const N=D.split("=")[0];return N===x?(I=!0,`${N}=${h}`):D}).filter(D=>D);return I||A.push(`${x}=${h}`),`#${A.join("&")}`}return`#${h}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(h=x)}),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(x=>isNaN(x))){const x=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:x,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Co(_,o){const h=_.getCenter(),x=Math.round(100*_.getZoom())/100,I=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,I),D=Math.round(h.lng*A)/A,N=Math.round(h.lat*A)/A,U=_.getBearing(),Z=_.getPitch();let J=o?`/${D}/${N}/${x}`:`${x}/${N}/${D}`;return(U||Z)&&(J+="/"+Math.round(10*U)/10),Z&&(J+=`/${Math.round(Z)}`),J}const Ns={linearity:.3,easing:s.c_(0,0,.3,1)},ia=s.e({deceleration:2500,maxSpeed:1400},Ns),Ph=s.e({deceleration:20,maxSpeed:1400},Ns),tf=s.e({deceleration:1e3,maxSpeed:360},Ns),jo=s.e({deceleration:1e3,maxSpeed:90},Ns);class bo{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.f.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=s.f.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)h.zoom+=A.zoomDelta||0,h.bearing+=A.bearingDelta||0,h.pitch+=A.pitchDelta||0,A.panDelta&&h.pan._add(A.panDelta),A.around&&(h.around=A.around),A.pinchAround&&(h.pinchAround=A.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(h.pan.mag()){const A=ic(h.pan.mag(),x,s.e({},ia,o||{}));I.offset=h.pan.mult(A.amount/h.pan.mag()),I.center=this._map.transform.center,xu(I,A)}if(h.zoom){const A=ic(h.zoom,x,Ph);I.zoom=this._map.transform.zoom+A.amount,xu(I,A)}if(h.bearing){const A=ic(h.bearing,x,tf);I.bearing=this._map.transform.bearing+s.aa(A.amount,-179,179),xu(I,A)}if(h.pitch){const A=ic(h.pitch,x,jo);I.pitch=this._map.transform.pitch+A.amount,xu(I,A)}if(I.zoom||I.bearing){const A=h.pinchAround===void 0?h.around:h.pinchAround;I.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),I.noMoveStart=!0,I}}function xu(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function ic(_,o,h){const{maxSpeed:x,linearity:I,deceleration:A}=h,D=s.aa(_*I/(o/1e3),-x,x),N=Math.abs(D)/(A*I);return{easing:h.easing,duration:1e3*N,amount:D*(N/2)}}class as extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x,I={}){const A=Ne(h.getCanvasContainer(),x),D=h.unproject(A);super(o,s.e({point:A,lngLat:D,originalEvent:x},I)),this._defaultPrevented=!1,this.target=h}}class oc extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x){const I=o==="touchend"?x.changedTouches:x.touches,A=rt(h.getCanvasContainer(),I),D=A.map(U=>h.unproject(U)),N=A.reduce((U,Z,J,ee)=>U.add(Z.div(ee.length)),new s.P(0,0));super(o,{points:A,point:N,lngLats:D,lngLat:h.unproject(N),originalEvent:x}),this._defaultPrevented=!1}}class Vf extends s.b{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x){super(o,{originalEvent:x}),this._defaultPrevented=!1}}class Mh{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Vf(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new as(o.type,this._map,o))}mouseup(o){this._map.fire(new as(o.type,this._map,o))}preclick(o){const h=s.e({},o);h.type="preclick",this._map.fire(new as(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new as(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new as(o.type,this._map,o))}mouseover(o){this._map.fire(new as(o.type,this._map,o))}mouseout(o){this._map.fire(new as(o.type,this._map,o))}touchstart(o){return this._firePreventable(new oc(o.type,this._map,o))}touchmove(o){this._map.fire(new oc(o.type,this._map,o))}touchend(o){this._map.fire(new oc(o.type,this._map,o))}touchcancel(o){this._map.fire(new oc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ja{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new as(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new as("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new as(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Td{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(ue(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const x=h,I=this._startPos,A=this._lastPos;if(!I||!A||A.equals(x)||!this._box&&x.dist(I)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=X("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const D=Math.min(I.x,x.x),N=Math.max(I.x,x.x),U=Math.min(I.y,x.y),Z=Math.max(I.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${U}px)`,this._box.style.width=N-D+"px",this._box.style.height=Z-U+"px")})}mouseupWindow(o,h){if(!this._active)return;const x=this._startPos,I=h;if(x&&o.button===0){if(this.reset(),Ee(),x.x!==I.x||x.y!==I.y)return this._map.fire(new s.b("boxzoomend",{originalEvent:o})),{cameraAnimation:A=>A.fitScreenCoordinates(x,I,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new s.b(o,{originalEvent:h}))}}function mp(_,o){const h={};for(let x=0;x<_.length;x++)h[_[x].identifier]=o[x];return h}class Um{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),x.length===this.numTouches&&(this.centroid=function(I){const A=new s.P(0,0);for(const D of I)A._add(D);return A.div(I.length)}(h),this.touches=mp(x,h)))}touchmove(o,h,x){if(this.aborted||!this.centroid)return;const I=mp(x,h);for(const A in this.touches){const D=I[A];(!D||D.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(o,h,x){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}class Uf{constructor(o){this.singleTap=new Um(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,x){this.singleTap.touchstart(o,h,x)}touchmove(o,h,x){this.singleTap.touchmove(o,h,x)}touchend(o,h,x){const I=this.singleTap.touchend(o,h,x);if(I){const A=o.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(I)<30;if(A&&D||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}class S_{constructor(){this._zoomIn=new Uf({numTouches:1,numTaps:2}),this._zoomOut=new Uf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,x){this._zoomIn.touchstart(o,h,x),this._zoomOut.touchstart(o,h,x)}touchmove(o,h,x){this._zoomIn.touchmove(o,h,x),this._zoomOut.touchmove(o,h,x)}touchend(o,h,x){const I=this._zoomIn.touchend(o,h,x),A=this._zoomOut.touchend(o,h,x);return I?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(I)},{originalEvent:o})}):A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(A)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const T_={0:1,2:2};class Uc{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const x=tt(o);this._correctButton(o,x)&&(this._lastPoint=h,this._eventButton=x)}mousemoveWindow(o,h){const x=this._lastPoint;if(x){if(o.preventDefault(),this._eventButton!=null&&function(I,A){const D=T_[A];return I.buttons===void 0||(I.buttons&D)!==D}(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(x,h)}}mouseupWindow(o){this._lastPoint&&tt(o)===this._eventButton&&(this._moved&&Ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class E_ extends Uc{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Ed extends Uc{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const x=.8*(h.x-o.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(o){o.preventDefault()}}class $f extends Uc{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const x=-.5*(h.y-o.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(o){o.preventDefault()}}class Ju{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),s.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(o,h,x){return this._calculateTransform(o,h,x)}touchmove(o,h,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!s.c$())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,x)}}touchend(o,h,x){this._calculateTransform(o,h,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,x){x.length>0&&(this._active=!0);const I=mp(x,h),A=new s.P(0,0),D=new s.P(0,0);let N=0;for(const Z in I){const J=I[Z],ee=this._touches[Z];ee&&(A._add(J),D._add(J.sub(ee)),N++,I[Z]=J)}if(this._touches=I,N<this._minTouches||!D.mag())return;const U=D.div(N);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(N),panDelta:U}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=X("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Wa{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,x){return{}}touchstart(o,h,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,x){const I=this._firstTwoTouches;if(!I)return;o.preventDefault();const[A,D]=I,N=rf(x,h,A),U=rf(x,h,D);if(!N||!U)return;const Z=this._aroundCenter?null:N.add(U).div(2);return this._move([N,U],Z,o)}touchend(o,h,x){if(!this._firstTwoTouches)return;const[I,A]=this._firstTwoTouches,D=rf(x,h,I),N=rf(x,h,A);D&&N||(this._active&&Ee(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rf(_,o,h){for(let x=0;x<_.length;x++)if(_[x].identifier===h)return o[x]}function $m(_,o){return Math.log(_/o)/Math.LN2}class Gf extends Wa{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const x=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs($m(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:$m(this._distance,x),pinchAround:h}}}function Id(_,o){return 180*_.angleWith(o)/Math.PI}class I_ extends Wa{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const x=this._vector;if(this._vector=o[0].sub(o[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Id(this._vector,x),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const I=Id(o,x);return Math.abs(I)<h}}function qf(_){return Math.abs(_.y)>Math.abs(_.x)}class C_ extends Wa{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,qf(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,x){const I=this._lastPoints;if(!I)return;const A=o[0].sub(I[0]),D=o[1].sub(I[1]);return this._map._cooperativeGestures&&!s.c$()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(A,D,x.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(A.y+D.y)/2*-.5})}gestureBeginsVertically(o,h,x){if(this._valid!==void 0)return this._valid;const I=o.mag()>=2,A=h.mag()>=2;if(!I&&!A)return;if(!I||!A)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const D=o.y>0==h.y>0;return qf(o)&&qf(h)&&D}}const kh={panStep:100,bearingStep:15,pitchStep:10};class Wf{constructor(){const o=kh;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,x=0,I=0,A=0,D=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?x=-1:(o.preventDefault(),A=-1);break;case 39:o.shiftKey?x=1:(o.preventDefault(),A=1);break;case 38:o.shiftKey?I=1:(o.preventDefault(),D=-1);break;case 40:o.shiftKey?I=-1:(o.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(x=0,I=0),{cameraAnimation:N=>{const U=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Cd,zoom:h?Math.round(U)+h*(o.shiftKey?2:1):U,bearing:N.getBearing()+x*this._bearingStep,pitch:N.getPitch()+I*this._pitchStep,offset:[-A*this._panStep,-D*this._panStep],center:N.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Cd(_){return _*(2-_)}const Hf=4.000244140625,Da=1/450;class Zf{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Da,s.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.c$()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const x=s.f.now(),I=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,h!==0&&h%Hf==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":I>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(I*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Ne(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>Hf?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&J!==0&&(J=1/J);const ee=h(),ae=Math.pow(2,ee),he=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):ae;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(he*J))),this._type==="wheel"&&(this._startZoom=ee,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:h(),I=this._startZoom,A=this._easing;let D,N=!1;if(this._type==="wheel"&&I&&A){const Z=Math.min((s.f.now()-this._lastWheelEventTime)/200,1),J=A(Z);D=s.U(I,x,J),Z<1?this._frameId||(this._frameId=!0):N=!0}else D=x,N=!0;this._active=!0,N&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let U=D-h();return U*this._lastDelta<0&&(U=0),{noInertia:!0,needsRenderFrame:!N,zoomDelta:U,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=s.d0;if(this._prevEase){const x=this._prevEase,I=(s.f.now()-x.start)/x.duration,A=x.easing(I+.01)-x.easing(I),D=.27/Math.sqrt(A*A+1e-4)*.01,N=Math.sqrt(.0729-D*D);h=s.c_(D,N,.25,1)}return this._prevEase={start:s.f.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=X("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class A_{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xf{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(o.shiftKey?-1:1),around:x.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yf{constructor(){this._tap=new Uf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,x){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=h[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(o,h,x))}touchmove(o,h,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const I=h[0],A=I.y-this._swipePoint.y;return this._swipePoint=I,o.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(o,h,x)}touchend(o,h,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(o,h,x)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nf{constructor(o,h,x){this._el=o,this._mousePan=h,this._touchPan=x}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class P_{constructor(o,h,x){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class M_{constructor(o,h,x,I){this._el=o,this._touchZoom=h,this._touchRotate=x,this._tapDragZoom=I,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rh=_=>_.zoom||_.drag||_.pitch||_.rotate;class Gm extends s.b{}class qm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){const x=s.N.sub([],h,o);this.radius=s.N.length(x[2]<0?s.N.div([],x,this.constants):[x[0],x[1],0])}projectRay(o){s.N.div(o,o,this.constants),s.N.normalize(o,o),s.N.mul(o,o,this.constants);const h=s.N.scale([],o,this.radius);if(h[2]>0){const x=s.N.scale([],[0,0,1],s.N.dot(h,[0,0,1])),I=s.N.scale([],s.N.normalize([],[h[0],h[1],0]),this.radius),A=s.N.add([],h,s.N.scale([],s.N.sub([],s.N.add([],I,x),h),2));h[0]=A[0],h[1]=A[1]}return h}}function Kf(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Jf{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bo(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),s.aY(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[window,"blur",void 0]];for(const[I,A,D]of this._listeners){const N=I===document?this.handleWindowEvent:this.handleEvent;I.addEventListener(A,N,D)}}destroy(){for(const[o,h,x]of this._listeners){const I=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(h,I,x)}}_addDefaultHandlers(o){const h=this._map,x=h.getCanvasContainer();this._add("mapEvent",new Mh(h,o));const I=h.boxZoom=new Td(h,o);this._add("boxZoom",I);const A=new S_,D=new Xf;h.doubleClickZoom=new A_(D,A),this._add("tapZoom",A),this._add("clickZoom",D);const N=new Yf;this._add("tapDragZoom",N);const U=h.touchPitch=new C_(h);this._add("touchPitch",U);const Z=new Ed(o),J=new $f(o);h.dragRotate=new P_(o,Z,J),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",J,["mouseRotate"]);const ee=new E_(o),ae=new Ju(h,o);h.dragPan=new nf(x,ee,ae),this._add("mousePan",ee),this._add("touchPan",ae,["touchZoom","touchRotate"]);const he=new I_,we=new Gf;h.touchZoomRotate=new M_(x,we,he,N),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",we,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ja(h));const xe=h.scrollZoom=new Zf(h,this);this._add("scrollZoom",xe,["mousePan"]);const Ce=h.keyboard=new Wf;this._add("keyboard",Ce);for(const ge of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ge]&&h[ge].enable(o[ge])}_add(o,h,x){this._handlers.push({handlerName:o,handler:h,allowed:x}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rh(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,x){for(const I in o)if(I!==x&&(!h||h.indexOf(I)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const x of o)this._el.contains(x.target)&&h.push(x);return h}handleEvent(o,h){this._updatingCamera=!0;const x=o.type==="renderFrame",I=x?void 0:o,A={needsRenderFrame:!1},D={},N={},U=o.touches?this._getMapTouches(o.touches):void 0,Z=U?rt(this._el,U):x?void 0:Ne(this._el,o);for(const{handlerName:ae,handler:he,allowed:we}of this._handlers){if(!he.isEnabled())continue;let xe;this._blockedByActive(N,we,ae)?he.reset():he[h||o.type]&&(xe=he[h||o.type](o,Z,U),this.mergeHandlerResult(A,D,xe,ae,I),xe&&xe.needsRenderFrame&&this._triggerRenderFrame()),(xe||he.isActive())&&(N[ae]=he)}const J={};for(const ae in this._previousActiveHandlers)N[ae]||(J[ae]=I);this._previousActiveHandlers=N,(Object.keys(J).length||Kf(A))&&(this._changes.push([A,D,J]),this._triggerRenderFrame()),(Object.keys(N).length||Kf(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ee}=A;ee&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ee(this._map))}mergeHandlerResult(o,h,x,I,A){if(!x)return;s.e(o,x);const D={handlerName:I,originalEvent:x.originalEvent||A};x.zoomDelta!==void 0&&(h.zoom=D),x.panDelta!==void 0&&(h.drag=D),x.pitchDelta!==void 0&&(h.pitch=D),x.bearingDelta!==void 0&&(h.rotate=D)}_applyChanges(){const o={},h={},x={};for(const[I,A,D]of this._changes)I.panDelta&&(o.panDelta=(o.panDelta||new s.P(0,0))._add(I.panDelta)),I.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+I.pitchDelta),I.around!==void 0&&(o.around=I.around),I.aroundCoord!==void 0&&(o.aroundCoord=I.aroundCoord),I.pinchAround!==void 0&&(o.pinchAround=I.pinchAround),I.noInertia&&(o.noInertia=I.noInertia),s.e(h,A),s.e(x,D);this._updateMapTransform(o,h,x),this._changes=[]}_updateMapTransform(o,h,x){const I=this._map,A=I.transform,D=De=>[De.x,De.y,De.z];if((De=>{const Xe=this._eventsInProgress.drag;return Xe&&!this._handlersById[Xe.handlerName].isActive()})()&&!Kf(o)){const De=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),De!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&I._stop(!0),!Kf(o))return void this._fireEvents(h,x,!0);let{panDelta:N,zoomDelta:U,bearingDelta:Z,pitchDelta:J,around:ee,aroundCoord:ae,pinchAround:he}=o;A._isCameraConstrained&&(U>0&&(U=0),A._isCameraConstrained=!1),he!==void 0&&(ee=he),(U||(De=>h[De]&&!this._eventsInProgress[De])("drag"))&&ee&&(this._dragOrigin=D(A.pointCoordinate3D(ee)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",I._stop(!0),ee=ee||I.transform.centerPoint,Z&&(A.bearing+=Z),J&&(A.pitch+=J),A._updateCameraState();const we=[0,0,0];if(N)if(A.projection.name==="mercator"){const De=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ee).dir),Xe=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(ee.sub(N)).dir);we[0]=Xe[0]-De[0],we[1]=Xe[1]-De[1]}else{const De=A.pointCoordinate(ee);if(A.projection.name==="globe"){N=N.rotate(-A.angle);const Xe=A._pixelsPerMercatorPixel/A.worldSize;we[0]=-N.x*s.d1(s.au(De.y))*Xe,we[1]=-N.y*s.d1(A.center.lat)*Xe}else{const Xe=A.pointCoordinate(ee.sub(N));De&&Xe&&(we[0]=Xe.x-De.x,we[1]=Xe.y-De.y)}}const xe=A.zoom,Ce=[0,0,0];if(U){const De=D(ae||A.pointCoordinate3D(ee)),Xe={dir:s.N.normalize([],s.N.sub([],De,A._camera.position))};if(Xe.dir[2]<0){const Be=A.zoomDeltaToMovement(De,U);s.N.scale(Ce,Xe.dir,Be)}}const ge=s.N.add(we,we,Ce);A._translateCameraConstrained(ge),U&&Math.abs(A.zoom-xe)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,x,!0)}_fireEvents(o,h,x){const I=Rh(this._eventsInProgress),A=Rh(o),D={};for(const J in o){const{originalEvent:ee}=o[J];this._eventsInProgress[J]||(D[`${J}start`]=ee),this._eventsInProgress[J]=o[J]}!I&&A&&this._fireEvent("movestart",A.originalEvent);for(const J in D)this._fireEvent(J,D[J]);A&&this._fireEvent("move",A.originalEvent);for(const J in o){const{originalEvent:ee}=o[J];this._fireEvent(J,ee)}const N={};let U;for(const J in this._eventsInProgress){const{handlerName:ee,originalEvent:ae}=this._eventsInProgress[J];this._handlersById[ee].isActive()||(delete this._eventsInProgress[J],U=h[ee]||ae,N[`${J}end`]=U)}for(const J in N)this._fireEvent(J,N[J]);const Z=Rh(this._eventsInProgress);if(x&&(I||A)&&!Z){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ee=ae=>ae!==0&&-this._bearingSnap<ae&&ae<this._bearingSnap;J?(ee(J.bearing||this._map.getBearing())&&(J.bearing=0),this._map.easeTo(J,{originalEvent:U})):(this._map.fire(new s.b("moveend",{originalEvent:U})),ee(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new s.b(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new Gm("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ly="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ua extends s.E{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,s.aY(["_renderFrameCallback"],this)}getCenter(){return new s.bn(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,x){return o=s.P.convert(o).mult(-1),this.panTo(this.transform.center,s.e({offset:o},h),x)}panTo(o,h,x){return this.easeTo(s.e({center:o},h),x)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,x){return this.easeTo(s.e({zoom:o},h),x)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,x){return this.easeTo(s.e({bearing:o},h),x)}resetNorth(o,h){return this.rotateTo(0,s.e({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(s.e({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=s.ad.convert(o);const x=h&&h.bearing||0,I=h&&h.pitch||0,A=o.getNorthWest(),D=o.getSouthEast();return this._cameraForBounds(this.transform,A,D,x,I,h)}_extendCameraOptions(o){const h={top:0,bottom:0,right:0,left:0};if(typeof(o=s.e({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const x=o.padding;o.padding={top:x,bottom:x,right:x,left:x}}return o.padding=s.e(h,o.padding),o}_minimumAABBFrustumDistance(o,h){const x=h.max[0]-h.min[0],I=h.max[1]-h.min[1];return x/I>o.aspect?x/(2*Math.tan(.5*o.fovX)*o.aspect):I/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,x,I,A,D){const N=o.clone(),U=this._extendCameraOptions(D);N.bearing=I,N.pitch=A;const Z=s.bn.convert(h),J=s.bn.convert(x),ee=.5*(Z.lat+J.lat),ae=.5*(Z.lng+J.lng),he=s.d2(ee,ae),we=s.N.normalize([],he),xe=s.N.normalize([],s.N.cross([],we,[0,1,0])),Ce=s.N.cross([],xe,we),ge=[xe[0],xe[1],xe[2],0,Ce[0],Ce[1],Ce[2],0,we[0],we[1],we[2],0,0,0,0,1],De=[he,s.d2(Z.lat,Z.lng),s.d2(J.lat,Z.lng),s.d2(J.lat,J.lng),s.d2(Z.lat,J.lng),s.d2(ee,Z.lng),s.d2(ee,J.lng),s.d2(Z.lat,ae),s.d2(J.lat,ae)];let Xe=s.bS.fromPoints(De.map(Ut=>[s.N.dot(xe,Ut),s.N.dot(Ce,Ut),s.N.dot(we,Ut)]));const Be=s.N.transformMat4([],Xe.center,ge);s.N.squaredLength(Be)===0&&s.N.set(Be,0,0,1),s.N.normalize(Be,Be),s.N.scale(Be,Be,s.ab),N.center=s.d3(Be);const We=N.getWorldToCameraMatrix(),Pe=s.a6.invert(new Float64Array(16),We);Xe=s.bS.applyTransform(Xe,s.a6.multiply([],We,ge)),s.N.transformMat4(Be,Be,We);const Ke=.5*(Xe.max[2]-Xe.min[2]),st=this._minimumAABBFrustumDistance(N,Xe),pt=s.N.scale([],[0,0,1],Ke),Tt=s.N.add(pt,Be,pt),Zt=st+(N.pitch===0?0:s.N.distance(Be,Tt)),xt=N.globeCenterInViewSpace,hr=s.N.sub([],Be,[xt[0],xt[1],xt[2]]);s.N.normalize(hr,hr),s.N.scale(hr,hr,Zt);const tr=s.N.add([],Be,hr);s.N.transformMat4(tr,tr,Pe);const Cr=s.d4/s.ab,zt=s.N.length(tr),ir=s.bl(Math.max(zt*Cr-s.d4,Number.EPSILON),0),vt=Math.min(N.zoomFromMercatorZAdjusted(ir),U.maxZoom);return vt>.5*(s.bG+s.bx)?(N.setProjection({name:"mercator"}),N.zoom=vt,this._cameraForBounds(N,h,x,I,A,D)):{center:N.center,zoom:vt,bearing:I,pitch:A}}queryTerrainElevation(o,h){const x=this.transform.elevation;return x?(h=s.e({},{exaggerated:!0},h),x.getAtPoint(s.L.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,x,I,A,D){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,x,I,A,D);const N=o.clone(),U=this._extendCameraOptions(D),Z=N.padding;N.bearing=I,N.pitch=A;const J=s.bn.convert(h),ee=s.bn.convert(x),ae=new s.bn(J.lng,ee.lat),he=new s.bn(ee.lng,J.lat),we=N.project(J),xe=N.project(ee),Ce=this.queryTerrainElevation(J),ge=this.queryTerrainElevation(ee),De=this.queryTerrainElevation(ae),Xe=this.queryTerrainElevation(he),Be=[[we.x,we.y,Math.min(Ce||0,ge||0,De||0,Xe||0)],[xe.x,xe.y,Math.max(Ce||0,ge||0,De||0,Xe||0)]];let We=s.bS.fromPoints(Be);const Pe=N.getWorldToCameraMatrix(),Ke=s.a6.invert(new Float64Array(16),Pe);We=s.bS.applyTransform(We,Pe);const st=s.N.sub([],We.max,We.min),pt=Z.left||0,Tt=Z.right||0,Zt=Z.bottom||0,xt=Z.top||0,{left:hr,right:tr,top:Cr,bottom:zt}=U.padding,ir=.5*(pt+Tt),vt=.5*(xt+Zt),Ut=Math.min(N.scaleZoom(N.scale*Math.min((N.width-(pt+Tt+hr+tr))/st[0],(N.height-(Zt+xt+zt+Cr))/st[1])),U.maxZoom),Lr=N.scale/N.zoomScale(Ut);We=new s.bS([We.min[0]-(hr+ir)*Lr,We.min[1]-(zt+vt)*Lr,We.min[2]],[We.max[0]+(tr+ir)*Lr,We.max[1]+(Cr+vt)*Lr,We.max[2]]);const Wr=.5*st[2],Gr=this._minimumAABBFrustumDistance(N,We),tn=[0,0,1,0];s.a7.transformMat4(tn,tn,Pe),s.a7.normalize(tn,tn);const _n=s.N.scale([],tn,Gr+Wr),Fn=s.N.add([],We.center,_n),wn=(typeof U.offset.x=="number"&&typeof U.offset.y=="number"?new s.P(U.offset.x,U.offset.y):s.P.convert(U.offset)).rotate(-s.bj(I));We.center[0]-=wn.x*Lr,We.center[1]+=wn.y*Lr,s.N.transformMat4(We.center,We.center,Ke),s.N.transformMat4(Fn,Fn,Ke);const Sn=[We.center[0],We.center[1],Fn[2]*N.pixelsPerMeter];s.N.scale(Sn,Sn,1/N.worldSize);const Mi=s.at(Sn[0]),pi=s.au(Sn[1]),Ci=Math.min(N._zoomFromMercatorZ(Sn[2]),U.maxZoom),Ti=new s.bn(Mi,pi);return N.mercatorFromTransition&&Ci<.5*(s.bG+s.bx)?(N.setProjection({name:"globe"}),N.zoom=Ci,this._cameraForBounds(N,h,x,I,A,D)):{center:Ti,zoom:Ci,bearing:I,pitch:A}}fitBounds(o,h,x){const I=this.cameraForBounds(o,h);return this._fitInternal(I,h,x)}fitScreenCoordinates(o,h,x,I,A){const D=s.P.convert(o),N=s.P.convert(h),U=new s.P(Math.min(D.x,N.x),Math.min(D.y,N.y)),Z=new s.P(Math.max(D.x,N.x),Math.max(D.y,N.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(D,N))return this;const J=this.transform.pointLocation3D(U),ee=this.transform.pointLocation3D(Z),ae=this.transform.pointLocation3D(new s.P(U.x,Z.y)),he=this.transform.pointLocation3D(new s.P(Z.x,U.y)),we=[Math.min(J.lng,ee.lng,ae.lng,he.lng),Math.min(J.lat,ee.lat,ae.lat,he.lat)],xe=[Math.max(J.lng,ee.lng,ae.lng,he.lng),Math.max(J.lat,ee.lat,ae.lat,he.lat)],Ce=I&&I.pitch?I.pitch:this.getPitch(),ge=this._cameraForBounds(this.transform,we,xe,x,Ce,I);return this._fitInternal(ge,I,A)}_fitInternal(o,h,x){return o?(delete(h=s.e(o,h)).padding,h.linear?this.easeTo(h,x):this.flyTo(h,x)):this}jumpTo(o,h){this.stop();const x=o.preloadOnly?this.transform.clone():this.transform;let I=!1,A=!1,D=!1;return"zoom"in o&&x.zoom!==+o.zoom&&(I=!0,x.zoom=+o.zoom),o.center!==void 0&&(x.center=s.bn.convert(o.center)),"bearing"in o&&x.bearing!==+o.bearing&&(A=!0,x.bearing=+o.bearing),"pitch"in o&&x.pitch!==+o.pitch&&(D=!0,x.pitch=+o.pitch),o.padding==null||x.isPaddingEqual(o.padding)||(x.padding=o.padding),o.preloadOnly?(this._preloadTiles(x),this):(this.fire(new s.b("movestart",h)).fire(new s.b("move",h)),I&&this.fire(new s.b("zoomstart",h)).fire(new s.b("zoom",h)).fire(new s.b("zoomend",h)),A&&this.fire(new s.b("rotatestart",h)).fire(new s.b("rotate",h)).fire(new s.b("rotateend",h)),D&&this.fire(new s.b("pitchstart",h)).fire(new s.b("pitch",h)).fire(new s.b("pitchend",h)),this.fire(new s.b("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(Ly),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){const x=this.transform;if(!x.projection.supportsFreeCamera)return s.w(Ly),this;this.stop();const I=x.zoom,A=x.pitch,D=x.bearing;x.setFreeCameraOptions(o);const N=I!==x.zoom,U=A!==x.pitch,Z=D!==x.bearing;return this.fire(new s.b("movestart",h)).fire(new s.b("move",h)),N&&this.fire(new s.b("zoomstart",h)).fire(new s.b("zoom",h)).fire(new s.b("zoomend",h)),Z&&this.fire(new s.b("rotatestart",h)).fire(new s.b("rotate",h)).fire(new s.b("rotateend",h)),U&&this.fire(new s.b("pitchstart",h)).fire(new s.b("pitch",h)).fire(new s.b("pitchend",h)),this.fire(new s.b("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=s.e({offset:[0,0],duration:500,easing:s.d0},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const x=this.transform,I=this.getZoom(),A=this.getBearing(),D=this.getPitch(),N=this.getPadding(),U="zoom"in o?+o.zoom:I,Z="bearing"in o?this._normalizeBearing(o.bearing,A):A,J="pitch"in o?+o.pitch:D,ee="padding"in o?o.padding:x.padding,ae=s.P.convert(o.offset);let he,we,xe;if(x.projection.name==="globe"){const pt=s.L.fromLngLat(x.center),Tt=ae.rotate(-x.angle);pt.x+=Tt.x/x.worldSize,pt.y+=Tt.y/x.worldSize;const Zt=pt.toLngLat(),xt=s.bn.convert(o.center||Zt);this._normalizeCenter(xt),he=x.centerPoint.add(Tt),we=new s.P(pt.x,pt.y).mult(x.worldSize),xe=new s.P(s.a5(xt.lng),s.ae(xt.lat)).mult(x.worldSize).sub(we)}else{he=x.centerPoint.add(ae);const pt=x.pointLocation(he),Tt=s.bn.convert(o.center||pt);this._normalizeCenter(Tt),we=x.project(pt),xe=x.project(Tt).sub(we)}const Ce=x.zoomScale(U-I);let ge,De;o.around&&(ge=s.bn.convert(o.around),De=x.locationPoint(ge));const Xe=this._zooming||U!==I,Be=this._rotating||A!==Z,We=this._pitching||J!==D,Pe=!x.isPaddingEqual(ee),Ke=pt=>Tt=>{if(Xe&&(pt.zoom=s.U(I,U,Tt)),Be&&(pt.bearing=s.U(A,Z,Tt)),We&&(pt.pitch=s.U(D,J,Tt)),Pe&&(pt.interpolatePadding(N,ee,Tt),he=pt.centerPoint.add(ae)),ge)pt.setLocationAtPoint(ge,De);else{const Zt=pt.zoomScale(pt.zoom-I),xt=U>I?Math.min(2,Ce):Math.max(.5,Ce),hr=Math.pow(xt,1-Tt),tr=pt.unproject(we.add(xe.mult(Tt*hr)).mult(Zt));pt.setLocationAtPoint(pt.renderWorldCopies?tr.wrap():tr,he)}return o.preloadOnly||this._fireMoveEvents(h),pt};if(o.preloadOnly){const pt=this._emulate(Ke,o.duration,x);return this._preloadTiles(pt),this}const st={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Xe,this._rotating=Be,this._pitching=We,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,st),this._ease(Ke(x),pt=>{x.cameraElevationReference==="sea"&&x.recenterOnTerrain(),this._afterEase(h,pt)},o),this}_prepareEase(o,h,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||x.moving||this.fire(new s.b("movestart",o)),this._zooming&&!x.zooming&&this.fire(new s.b("zoomstart",o)),this._rotating&&!x.rotating&&this.fire(new s.b("rotatestart",o)),this._pitching&&!x.pitching&&this.fire(new s.b("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.b("move",o)),this._zooming&&this.fire(new s.b("zoom",o)),this._rotating&&this.fire(new s.b("rotate",o)),this._pitching&&this.fire(new s.b("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,I=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,x&&this.fire(new s.b("zoomend",o)),I&&this.fire(new s.b("rotateend",o)),A&&this.fire(new s.b("pitchend",o)),this.fire(new s.b("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){const zt=s.ac(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(zt,h)}this.stop(),o=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.d0},o);const x=this.transform,I=this.getZoom(),A=this.getBearing(),D=this.getPitch(),N="zoom"in o?s.aa(+o.zoom,x.minZoom,x.maxZoom):I,U="bearing"in o?this._normalizeBearing(o.bearing,A):A,Z="pitch"in o?+o.pitch:D,J=x.zoomScale(N-I),ee=s.P.convert(o.offset),ae=x.centerPoint.add(ee),he=x.pointLocation(ae);let we=o.center;if(we&&o.padding){const zt=this._cameraForBounds(this.transform,we,we,U,Z,o);zt&&(we=zt.center)}we=s.bn.convert(we||he),this._normalizeCenter(we);const xe=x.project(he),Ce=x.project(we).sub(xe);let ge=o.curve;const De=Math.max(x.width,x.height),Xe=De/J,Be=Ce.mag();if("minZoom"in o){const zt=s.aa(Math.min(o.minZoom,I,N),x.minZoom,x.maxZoom),ir=De/x.zoomScale(zt-I);ge=Math.sqrt(ir/Be*2)}const We=ge*ge;function Pe(zt){const ir=(Xe*Xe-De*De+(zt?-1:1)*We*We*Be*Be)/(2*(zt?Xe:De)*We*Be);return Math.log(Math.sqrt(ir*ir+1)-ir)}function Ke(zt){return(Math.exp(zt)-Math.exp(-zt))/2}function st(zt){return(Math.exp(zt)+Math.exp(-zt))/2}const pt=Pe(0);let Tt=function(zt){return st(pt)/st(pt+ge*zt)},Zt=function(zt){return De*((st(pt)*(Ke(ir=pt+ge*zt)/st(ir))-Ke(pt))/We)/Be;var ir},xt=(Pe(1)-pt)/ge;if(Math.abs(Be)<1e-6||!isFinite(xt)){if(Math.abs(De-Xe)<1e-6)return this.easeTo(o,h);const zt=Xe<De?-1:1;xt=Math.abs(Math.log(Xe/De))/ge,Zt=function(){return 0},Tt=function(ir){return Math.exp(zt*ge*ir)}}o.duration="duration"in o?+o.duration:1e3*xt/("screenSpeed"in o?+o.screenSpeed/ge:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const hr=A!==U,tr=Z!==D,Cr=zt=>ir=>{const vt=ir*xt,Ut=1/Tt(vt);zt.zoom=ir===1?N:I+zt.scaleZoom(Ut),hr&&(zt.bearing=s.U(A,U,ir)),tr&&(zt.pitch=s.U(D,Z,ir));const Lr=ir===1?we:zt.unproject(xe.add(Ce.mult(Zt(vt))).mult(Ut));return zt.setLocationAtPoint(zt.renderWorldCopies?Lr.wrap():Lr,ae),zt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),zt};if(o.preloadOnly){const zt=this._emulate(Cr,o.duration,x);return this._preloadTiles(zt),this}return this._zooming=!0,this._rotating=hr,this._pitching=tr,this._prepareEase(h,!1),this._ease(Cr(x),()=>this._afterEase(h),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,h)}if(!o){const x=this.handlers;x&&x.stop(!1)}return this}_ease(o,h,x){x.animate===!1||x.duration===0?(o(1),h()):(this._easeStart=s.f.now(),this._easeOptions=x,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.f.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=s.bh(o,-180,180);const x=Math.abs(o-h);return Math.abs(o-360-h)<x&&(o-=360),Math.abs(o+360-h)<x&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;const x=o.lng-h.center.lng;o.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&s.f.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,x){const I=Math.ceil(15*h/1e3),A=[],D=o(x.clone());for(let N=0;N<=I;N++){const U=D(N/I);A.push(U.clone())}return A}}class k_{constructor(o={}){this.options=o,s.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const h=this.options&&this.options.compact;return this._map=o,this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=X("button","mapboxgl-ctrl-attrib-button",this._container),X("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=X("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const x=this._map._getUIString(`AttributionControl.${h}`);o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.d5.ACCESS_TOKEN}];if(o){const x=h.reduce((I,A,D)=>(A.value&&(I+=`${A.key}=${A.value}${D<h.length-1?"&":""}`),I),"?");o.href=`${s.d5.FEEDBACK_URL}/${x}#${Co(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}const h=this._map.style._mergedSourceCaches;for(const I in h){const A=h[I];if(A.used){const D=A.getSource();D.attribution&&o.indexOf(D.attribution)<0&&o.push(D.attribution)}}o.sort((I,A)=>I.length-A.length),o=o.filter((I,A)=>{for(let D=A+1;D<o.length;D++)if(o[D].indexOf(I)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const x=o.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,o.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Wm{constructor(){s.aY(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=X("div","mapboxgl-ctrl");const h=X("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const h in o){const x=o[h].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Hm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,x=h?this._queue.concat(h):this._queue;for(const I of x)if(I.id===o)return void(I.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const x of h)if(!x.cancelled&&(x.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Fl(_,o,h){if(_=new s.bn(_.lng,_.lat),o){const x=new s.bn(_.lng-360,_.lat),I=new s.bn(_.lng+360,_.lat),A=360*Math.ceil(Math.abs(_.lng-h.center.lng)/360),D=h.locationPoint(_).distSqr(o),N=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint(x).distSqr(o)<D&&(N||Math.abs(x.lng-h.center.lng)<A)?_=x:h.locationPoint(I).distSqr(o)<D&&(N||Math.abs(I.lng-h.center.lng)<A)&&(_=I)}for(;Math.abs(_.lng-h.center.lng)>180;){const x=h.locationPoint(_);if(x.x>=0&&x.y>=0&&x.x<=h.width&&x.y<=h.height)break;_.lng>h.center.lng?_.lng-=360:_.lng+=360}return _}const Zm={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class R_ extends s.E{constructor(o,h){if(super(),(o instanceof HTMLElement||h)&&(o=s.e({element:o},h)),s.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=s.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=X("div");const A=41,D=27,N=ne("svg",{display:"block",height:A*this._scale+"px",width:D*this._scale+"px",viewBox:`0 0 ${D} ${A}`},this._element),U=ne("radialGradient",{id:"shadowGradient"},ne("defs",{},N));ne("stop",{offset:"10%","stop-opacity":.4},U),ne("stop",{offset:"100%","stop-opacity":.05},U),ne("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},N),ne("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},N),ne("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},N),ne("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},N),this._offset=s.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()});const x=this._element.classList;for(const A in Zm)x.remove(`mapboxgl-marker-anchor-${A}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`);const I=o&&o.className?o.className.trim().split(/\s+/):[];x.add(...I),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.bn.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const I=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[I,-1*(38.1-13.5+I)],"bottom-right":[-I,-1*(38.1-13.5+I)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const h=o.code,x=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,x=this._element;this._popup&&(h===x||x.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,h=this._pos;if(!o||!h)return!1;const x=o.unproject(h),I=o.getFreeCameraOptions();if(!I.position)return!1;const A=I.position.toLngLat();return A.distanceTo(x)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();const x=o.unproject(h);let I;o._showingGlobe()&&s.d6(o.transform,this._lngLat)?I=0:(I=1-o._queryFogOpacity(x),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(I*=this._occludedOpacity)),this._element.style.opacity=`${I}`,this._element.style.pointerEvents=I>0?"auto":"none",this._popup&&this._popup._setOpacity(I),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Zm[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const o=this._pos,h=this._map,x=this.getPitchAlignment();if(!h||!o||x!=="map")return"";if(!h._showingGlobe()){const U=h.getPitch();return U?`rotateX(${U}deg)`:""}const I=s.bF(s.d7(h.transform,this._lngLat)),A=o.sub(s.d8(h.transform)),D=Math.abs(A.x)+Math.abs(A.y);if(D===0)return"";const N=I/D;return`rotateX(${-A.y*N}deg) rotateY(${A.x*N}deg)`}_calculateZTransform(){const o=this._pos,h=this._map;if(!h||!o)return"";let x=0;const I=this.getRotationAlignment();if(I==="map")if(h._showingGlobe()){const A=h.project(new s.bn(this._lngLat.lng,this._lngLat.lat+.001)),D=h.project(new s.bn(this._lngLat.lng,this._lngLat.lat-.001)).sub(A);x=s.bF(Math.atan2(D.y,D.x))-90}else x=-h.getBearing();else if(I==="horizon"){const A=s.O(4,6,h.getZoom()),D=s.d8(h.transform);D.y+=A*h.transform.height;const N=o.sub(D),U=s.bF(Math.atan2(N.y,N.x));x=(U>90?U-270:U+90)*(1-A)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Fl(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const h=this._map;if(!h)return;const x=this._pointerdownPos,I=this._positionDelta;if(x&&I){if(!this._isDragging){const A=this._clickTolerance||h._clickTolerance;if(o.point.dist(x)<A)return;this._isDragging=!0}this._pos=o.point.sub(I),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.b("dragstart"))),this.fire(new s.b("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.b("dragend")),this._state="inactive"}_addDragHandler(o){const h=this._map,x=this._pos;h&&x&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(x),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const zy={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ny=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function D_(_=new s.P(0,0),o="bottom"){if(typeof _=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(o){case"top":return new s.P(0,_);case"top-left":return new s.P(h,h);case"top-right":return new s.P(-h,h);case"bottom":return new s.P(0,-_);case"bottom-left":return new s.P(h,-h);case"bottom-right":return new s.P(-h,-h);case"left":return new s.P(_,0);case"right":return new s.P(-_,0)}return new s.P(0,0)}return _ instanceof s.P||Array.isArray(_)?s.P.convert(_):s.P.convert(_[o]||[0,0])}class Ad{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const h=s.cc((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,x){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+x}}const Qf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},jy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1};class Xm{constructor(){this.showOverdrawInspector=!1,this.showTileBoundaries=!1,this.showParseStatus=!1,this.continuousRedraw=!1,this.showTileAABBs=!1,this.showPadding=!1,this.showTerrainWireframe=!1,this.showLayers2DWireframe=!1,this.showLayers3DWireframe=!1}}const em={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dh{constructor(o,h,x=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Ed({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,x&&(this.mousePitch=new $f({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),ue()}move(o,h){const x=this.map,I=this.mouseRotate.mousemoveWindow(o,h),A=I&&I.bearingDelta;if(A&&x.setBearing(x.getBearing()+A),this.mousePitch){const D=this.mousePitch.mousemoveWindow(o,h),N=D&&D.pitchDelta;N&&x.setPitch(x.getPitch()+N)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.e({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ne(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Ne(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=rt(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=rt(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ym={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ys={maxWidth:100,unit:"metric"},Pd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:s.dk,supported:F,setRTLTextPlugin:s.dm,getRTLTextPluginStatus:s.dn,Map:class extends ua{constructor(_){const o=_;if((_=s.e({},jy,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&s.d9(window)&&(_.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new gd(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._repaint=!1,this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new Hm,this._domRenderTaskQueue=new Hm,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.aC(),this._locale=s.e({},Qf,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ad(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.da(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,this._contextCreateOptions=_.contextCreateOptions?{..._.contextCreateOptions}:{},typeof _.container=="string"){const h=document.getElementById(_.container);if(!h)throw new Error(`Container '${_.container.toString()}' not found.`);this._container=h}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),s.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._debugParams=new Xm,this._tp=_.devtools?new vu(this):new vu,this._tp.registerParameter(this._debugParams,["Debug"],"showOverdrawInspector",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileBoundaries",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"showParseStatus",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug"],"continuousRedraw",void 0,h=>{this.repaint=h}),this._tp.registerParameter(this._debugParams,["Debug"],"showTileAABBs",void 0,h=>{this.showTileAABBs=h}),this._tp.registerParameter(this._debugParams,["Debug"],"showPadding",void 0,h=>{this.showPadding=h}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showTerrainWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers2DWireframe",void 0,()=>{this._update()}),this._tp.registerParameter(this._debugParams,["Debug","Wireframe"],"showLayers3DWireframe",void 0,()=>{this._update()}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Jf(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,(_.style||!_.testMode)&&this.setStyle(_.style||s.d5.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),_.hash&&(this._hash=new Vc(typeof _.hash=="string"&&_.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch});const h=_.bounds;h&&(this.resize(),this.fitBounds(h,s.e({},_.fitBoundsOptions,{duration:0})))}this.resize(),_.attributionControl&&this.addControl(new k_({customAttribution:_.customAttribution})),this._logoControl=new Wm,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.b(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.b(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(_,o){if(o===void 0&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new s.a(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=_.onAdd(this);this._controls.push(_);const x=this._controlPositions[o];return o.indexOf("bottom")!==-1?x.insertBefore(h,x.firstChild):x.appendChild(h),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new s.a(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.b("movestart",_)).fire(new s.b("move",_)),this.fire(new s.b("resize",_)),o&&this.fire(new s.b("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(s.ad.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new s.b("zoomstart")).fire(new s.b("zoom")).fire(new s.b("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new s.b("zoomstart")).fire(new s.b("zoom")).fire(new s.b("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new s.b("pitchstart")).fire(new s.b("pitch")).fire(new s.b("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new s.b("pitchstart")).fire(new s.b("pitch")).fire(new s.b("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(o=>o==="auto"?navigator.language:o):_}setLanguage(_){const o=this._parseLanguage(_);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,o=_.projection.name;let h;o==="globe"&&_.zoom>=s.bx?(_.setMercatorFromTransition(),h=!0):o==="mercator"&&_.zoom<s.bx&&(_.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,o){return this._updateProjection(_||o||{name:"mercator"})}_updateProjection(_){let o;return o=_.name==="globe"&&this.transform.zoom>=s.bx?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(_){return this.transform.locationPoint3D(s.bn.convert(_))}unproject(_){return this.transform.pointLocation3D(s.P.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,o,h){if(_==="mouseenter"||_==="mouseover"){let x=!1;const I=D=>{const N=o.filter(Z=>this.getLayer(Z)),U=N.length?this.queryRenderedFeatures(D.point,{layers:N}):[];U.length?x||(x=!0,h.call(this,new as(_,this,D.originalEvent,{features:U}))):x=!1},A=()=>{x=!1};return{layers:new Set(o),listener:h,delegates:{mousemove:I,mouseout:A}}}if(_==="mouseleave"||_==="mouseout"){let x=!1;const I=D=>{const N=o.filter(U=>this.getLayer(U));(N.length?this.queryRenderedFeatures(D.point,{layers:N}):[]).length?x=!0:x&&(x=!1,h.call(this,new as(_,this,D.originalEvent)))},A=D=>{x&&(x=!1,h.call(this,new as(_,this,D.originalEvent)))};return{layers:new Set(o),listener:h,delegates:{mousemove:I,mouseout:A}}}{const x=I=>{const A=o.filter(N=>this.getLayer(N)),D=A.length?this.queryRenderedFeatures(I.point,{layers:A}):[];D.length&&(I.features=D,h.call(this,I),delete I.features)};return{layers:new Set(o),listener:h,delegates:{[_]:x}}}}on(_,o,h){if(h===void 0)return super.on(_,o);if(Array.isArray(o)||(o=[o]),o){for(const I of o)if(!this._isValidId(I))return this}const x=this._createDelegatedListener(_,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(x);for(const I in x.delegates)this.on(I,x.delegates[I]);return this}once(_,o,h){if(h===void 0)return super.once(_,o);if(Array.isArray(o)||(o=[o]),o){for(const I of o)if(!this._isValidId(I))return this}const x=this._createDelegatedListener(_,o,h);for(const I in x.delegates)this.once(I,x.delegates[I]);return this}off(_,o,h){if(h===void 0)return super.off(_,o);o=new Set(Array.isArray(o)?o:[o]);for(const A of o)if(!this._isValidId(A))return this;const x=(A,D)=>{if(A.size!==D.size)return!1;for(const N of A)if(!D.has(N))return!1;return!0},I=this._delegatedListeners?this._delegatedListeners[_]:void 0;return I&&(A=>{for(let D=0;D<A.length;D++){const N=A[D];if(N.listener===h&&x(N.layers,o)){for(const U in N.delegates)this.off(U,N.delegates[U]);return A.splice(D,1),this}}})(I),this}queryRenderedFeatures(_,o){if(!this.style)return[];if(o!==void 0||_===void 0||_ instanceof s.P||Array.isArray(_)||(o=_,_=void 0),_=_||[[0,0],[this.transform.width,this.transform.height]],(o=o||{}).layers&&Array.isArray(o.layers)){for(const h of o.layers)if(!this._isValidId(h))return[]}return this.style.queryRenderedFeatures(_,o,this.transform)}querySourceFeatures(_,o){return this._isValidId(_)?this.style.querySourceFeatures(_,o):[]}isPointOnSurface(_){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&s.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(_))}setStyle(_,o){return(o=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(_,o))}_getUIString(_){const o=this._locale[_];if(o==null)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new qo(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new qo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,o){if(typeof _=="string"){const h=this._requestManager.normalizeStyleURL(_),x=this._requestManager.transformRequest(h,s.R.Style);s.g(x,(I,A)=>{I?this.fire(new s.a(I)):A&&this._updateDiff(A,o)})}else typeof _=="object"&&this._updateDiff(_,o)}_updateDiff(_,o){try{this.style.setState(_)&&this._update(!0)}catch(h){s.w(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(_,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(_){return _==null?(this.fire(new s.a(new Error("IDs can't be empty."))),!1):!s.c4(_)||(this.fire(new s.a(new Error(`IDs can't contain special symbols: "${_}".`))),!1)}addSource(_,o){return this._isValidId(_)?(this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)):this}isSourceLoaded(_){return!!this._isValidId(_)&&!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(_,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,h)}removeSource(_){return this._isValidId(_)?(this.style.removeSource(_),this._updateTerrain(),this._update(!0)):this}getSource(_){return this._isValidId(_)?this.style.getOwnSource(_):null}addImage(_,o,{pixelRatio:h=1,sdf:x=!1,stretchX:I,stretchY:A,content:D}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:N,height:U,data:Z}=s.f.getImageData(o);this.style.addImage(_,{data:new s.h({width:N,height:U},Z),pixelRatio:h,stretchX:I,stretchY:A,content:D,sdf:x,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new s.a(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:U}=o,Z=o;this.style.addImage(_,{data:new s.h({width:N,height:U},new Uint8Array(Z.data)),pixelRatio:h,stretchX:I,stretchY:A,content:D,sdf:x,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,_)}}updateImage(_,o){this._lazyInitEmptyStyle();const h=this.style.getImage(_);if(!h)return void this.fire(new s.a(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?s.f.getImageData(o):o,{width:I,height:A}=x,D=x.data;if(I===void 0||A===void 0)return void this.fire(new s.a(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(I!==h.data.width||A!==h.data.height)return void this.fire(new s.a(new Error(`The width and height of the updated image (${I}, ${A})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`)));const N=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);h.data.replace(D,N),this.style.updateImage(_,h)}hasImage(_){return _?!!this.style&&!!this.style.getImage(_):(this.fire(new s.a(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,o){s.d(this._requestManager.transformRequest(_,s.R.Image),(h,x)=>{o(h,x instanceof HTMLImageElement?s.f.getImageData(x):x)})}listImages(){return this.style.listImages()}addModel(_,o){this._lazyInitEmptyStyle(),this.style.addModel(_,o)}hasModel(_){return _?this.style.hasModel(_):(this.fire(new s.a(new Error("Missing required model id"))),!1)}removeModel(_){this.style.removeModel(_)}listModels(){return this.style.listModels()}addLayer(_,o){return this._isValidId(_.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)):this}getSlot(_){const o=this.getLayer(_);return o&&o.slot||null}setSlot(_,o){return this.style.setSlot(_,o),this.style.mergeLayers(),this._update(!0)}addImport(_,o){return this.style.addImport(_,o),this}updateImport(_,o){return typeof o!="string"&&o.id!==_?(this.removeImport(_),this.addImport(o)):(this.style.updateImport(_,o),this._update(!0))}removeImport(_){return this.style.removeImport(_),this}moveImport(_,o){return this.style.moveImport(_,o),this._update(!0)}moveLayer(_,o){return this._isValidId(_)?(this.style.moveLayer(_,o),this._update(!0)):this}removeLayer(_){return this._isValidId(_)?(this.style.removeLayer(_),this._update(!0)):this}getLayer(_){return this._isValidId(_)?this.style.getOwnLayer(_):null}setLayerZoomRange(_,o,h){return this._isValidId(_)?(this.style.setLayerZoomRange(_,o,h),this._update(!0)):this}setFilter(_,o,h={}){return this._isValidId(_)?(this.style.setFilter(_,o,h),this._update(!0)):this}getFilter(_){return this._isValidId(_)?this.style.getFilter(_):null}setPaintProperty(_,o,h,x={}){return this._isValidId(_)?(this.style.setPaintProperty(_,o,h,x),this._update(!0)):this}getPaintProperty(_,o){return this._isValidId(_)?this.style.getPaintProperty(_,o):null}setLayoutProperty(_,o,h,x={}){return this._isValidId(_)?(this.style.setLayoutProperty(_,o,h,x),this._update(!0)):this}getLayoutProperty(_,o){return this._isValidId(_)?this.style.getLayoutProperty(_,o):null}getConfigProperty(_,o){return this.style.getConfigProperty(_,o)}setConfigProperty(_,o,h){return this.style.setConfigProperty(_,o,h),this._update(!0)}setLights(_){if(this._lazyInitEmptyStyle(),_&&_.length===1&&_[0].type==="flat"){const o=_[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(_),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const _=this.style.getLights()||[];return _.length===0&&_.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),_}setLight(_,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:_}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(_){return this.style.setCamera(_),this._triggerCameraUpdate(_)}_triggerCameraUpdate(_){return this._update(this.transform.setOrthographicProjectionAtLowPitch(_["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.bn.convert(_),this.transform):0}setFeatureState(_,o){return this._isValidId(_.source)?(this.style.setFeatureState(_,o),this._update()):this}removeFeatureState(_,o){return this._isValidId(_.source)?(this.style.removeFeatureState(_,o),this._update()):this}getFeatureState(_){return this._isValidId(_.source)?this.style.getFeatureState(_):null}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let h,x,I,A=this._container;for(;A&&(!x||!I);){const D=window.getComputedStyle(A).transform;D&&D!=="none"&&(h=D.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(x=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(I=h[3])),A=A.parentElement}this._containerWidth=x?Math.abs(_/x):_,this._containerHeight=I?Math.abs(o/I):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=X("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=X("div","mapboxgl-canvas-container",_);this._canvas=X("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=X("div","mapboxgl-control-container",_),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(I=>{x[I]=X("div",`mapboxgl-ctrl-${I}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,o){const h=s.f.devicePixelRatio||1;this._canvas.width=h*Math.ceil(_),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const o=this._markers.indexOf(_);o!==-1&&this._markers.splice(o,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const o=this._popups.indexOf(_);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const _=s.e({},F.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",_);o?(s.db(o,!0),this.painter=new Fc(o,this._contextCreateOptions,this.transform,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.dc.testSupport(o)):this.fire(new s.a(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.b("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new s.b("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let o;this.fire(new s.b("renderstart"));const h=this.painter.context.extTimerQuery,x=s.f.now(),I=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=I.createQuery(),I.beginQuery(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,Z=this.transform.pitch,J=s.f.now(),ee=new s.K(U,{now:J,fadeDuration:A,pitch:Z,transition:this.style.transition});this.style.update(ee)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(x),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries||this._debugParams.showTileBoundaries,showParseStatus:this.showParseStatus||this._debugParams.showParseStatus,wireframe:{terrain:this.showTerrainWireframe||this._debugParams.showTerrainWireframe,layers2D:this.showLayers2DWireframe||this._debugParams.showLayers2DWireframe,layers3D:this.showLayers3DWireframe||this._debugParams.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector||this._debugParams.showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs||this._debugParams.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding||this._debugParams.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.b("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.b("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const U=s.f.now()-x;I.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{const Z=I.getQueryParameter(o,I.QUERY_RESULT)/1e6;I.deleteQuery(o),this.fire(new s.b("gpu-timing-frame",{cpuTime:U,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(U);this.fire(new s.b("gpu-timing-layer",{layerTimes:Z}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Z=this.painter.queryGpuTimeDeferredRender(U);this.fire(new s.b("gpu-timing-deferred-render",{gpuTime:Z}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(N||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(D=this._updateAverageElevation(x,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new s.b("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new s.b("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,this._performanceMetricsCollection&&s.dd(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const o of this._markers)_&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!_||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(_,o=!1){const h=I=>(this.transform.averageElevation=I,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);const x=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(x||(o||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const I=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=_;const D=Math.abs(I-A);if(D>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(A),h(A);this._averageElevation.easeTo(A,_,300)}else if(D>1e-4)return this._averageElevation.jumpTo(A),h(A)}return!!this._averageElevation.isEasing(_)&&h(this._averageElevation.getValue(_))}_authenticate(){s.de(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===s.df||_.status===401)){const o=this.painter.context.gl;s.db(o,!1),this._logoControl instanceof Wm&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.a(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.dg(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const h=this.painter.context.gl,x=h.createFramebuffer();function I(A){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,A,0);const D=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,D),D}return h.bindFramebuffer(h.FRAMEBUFFER,x),this._canvasPixelComparison(I(_),o.canvasCopies.map(I),o.timeStamps)}_canvasPixelComparison(_,o,h){let x=h[1]-h[0];const I=_.length/4;for(let A=0;A<o.length;A++){const D=o[A];let N=0;for(let U=0;U<D.length;U+=4)D[U]===_[U]&&D[U+1]===_[U+1]&&D[U+2]===_[U+2]&&D[U+3]===_[U+3]&&(N+=1);x+=(h[A+2]-h[A+1])*(1-N/I)}return x}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.dh(this.painter.context.gl),s.di.remove(),s.dj.remove(),this._removed=!0,this.fire(new s.b("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=s.f.frame(o=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)}))}_preloadTiles(_){const o=this.style?Object.values(this.style._sourceCaches):[];return s.b1(o,(h,x)=>h._preloadTiles(_,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(_){this._showParseStatus!==_&&(this._showParseStatus=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(_){this._showLayers2DWireframe!==_&&(this._showLayers2DWireframe=_,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(_){this._showLayers3DWireframe!==_&&(this._showLayers3DWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,o){s.dl(_,o)}get version(){return s.dk}},NavigationControl:class{constructor(_){this.options=s.e({},em,_),this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),X("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),X("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))}),this._compassIcon=X("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const o=_.getZoom(),h=o===_.getMaxZoom(),x=o===_.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dh(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,o){const h=X("button",_,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(_,o){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${o}`);_.setAttribute("aria-label",h),_.firstElementChild&&_.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends s.E{constructor(_){super();const o=navigator.geolocation;this.options=s.e({geolocation:o},Ym,_),s.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=nc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,_(h)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>o(h.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),h=_.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new s.b("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.b("geolocate",_)),this._finish()}}_updateCamera(_){const o=new s.bn(_.coords.longitude,_.coords.latitude),h=_.coords.accuracy,x=this._map.getBearing(),I=s.e({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),I,{geolocateSource:!0})}_updateMarker(_){if(_){const o=new s.bn(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,o=s.bl(1,_._center.lat)*_.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.b("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=X("button","mapboxgl-ctrl-geolocate",this._container),X("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=X("div","mapboxgl-user-location"),this._dotElement.appendChild(X("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(X("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new R_({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=X("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new R_({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.b("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.b("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.b("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.b("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:k_,ScaleControl:class{constructor(_){this.options=s.e({},ys,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,x=o._containerWidth/2-_/2,I=o.unproject([x,h]),A=o.unproject([x+_,h]),D=I.distanceTo(A);if(this.options.unit==="imperial"){const N=3.2808*D;N>5280?this._setScale(_,N/5280,"mile"):this._setScale(_,N,"foot")}else this.options.unit==="nautical"?this._setScale(_,D/1852,"nautical-mile"):D>=1e3?this._setScale(_,D/1e3,"kilometer"):this._setScale(_,D,"meter")}_setScale(_,o,h){this._map._requestDomTask(()=>{const x=function(A){const D=Math.pow(10,`${Math.floor(A)}`.length-1);let N=A/D;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(U){const Z=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*Z)/Z}(N),D*N}(o),I=x/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(x):`${x}&nbsp;${Pd[h]}`,this._container.style.width=_*I+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:s.w("Full screen control 'container' must be a DOM element.")),s.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=X("button","mapboxgl-ctrl-fullscreen",this._controlContainer);X("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.E{constructor(_){super(),this.options=s.e(Object.create(zy),_),s.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new s.b("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new s.b("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=s.bn.convert(_),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const o=document.createDocumentFragment(),h=document.createElement("body");let x;for(h.innerHTML=_;x=h.firstChild,x;)o.appendChild(x);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=X("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(_),this.options.closeButton){const h=this._closeButton=X("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let o;return this._classList.delete(_)?o=!1:(this._classList.add(_),o=!0),this._updateClassList(),o}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const o=this._map,h=this._container,x=this._pos;if(!o||!h||!x)return"bottom";const I=h.offsetWidth,A=h.offsetHeight,D=x.x<I/2,N=x.x>o.transform.width-I/2;if(x.y+_<A)return D?"top-left":N?"top-right":"top";if(x.y>o.transform.height-A){if(D)return"bottom-left";if(N)return"bottom-right"}return D?"left":N?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),_.className=o.join(" ")}_update(_){const o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let x=this._container;if(x||(x=this._container=X("div","mapboxgl-popup",o.getContainer()),this._tip=X("div","mapboxgl-popup-tip",x),x.appendChild(h)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Fl(this._lngLat,this._pos,o.transform)),!this._trackPointer||_){const I=this._pos=this._trackPointer&&_?_:o.project(this._lngLat),A=D_(this.options.offset),D=this._anchor=this._getAnchor(A.y),N=D_(this.options.offset,D),U=I.add(N).round();o._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${Zm[D]} translate(${U.x}px,${U.y}px)`)})}if(!this._marker&&o._showingGlobe()){const I=s.d6(o.transform,this._lngLat)?0:1;this._setOpacity(I)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Ny);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:R_,Style:qo,LngLat:s.bn,LngLatBounds:s.ad,Point:s.P,MercatorCoordinate:s.L,FreeCameraOptions:wh,Evented:s.E,config:s.d5,prewarm:s.dp,clearPrewarmedResources:s.dq,get accessToken(){return s.d5.ACCESS_TOKEN},set accessToken(_){s.d5.ACCESS_TOKEN=_},get baseApiUrl(){return s.d5.API_URL},set baseApiUrl(_){s.d5.API_URL=_},get workerCount(){return s.dr.workerCount},set workerCount(_){s.dr.workerCount=_},get maxParallelImageRequests(){return s.d5.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){s.d5.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){s.ds(_)},get workerUrl(){return s.dt.workerUrl},set workerUrl(_){s.dt.workerUrl=_},get workerClass(){return s.dt.workerClass},set workerClass(_){s.dt.workerClass=_},get workerParams(){return s.dt.workerParams},set workerParams(_){s.dt.workerParams=_},get dracoUrl(){return s.du()},set dracoUrl(_){s.dv(_)},get meshoptUrl(){return s.dw()},set meshoptUrl(_){s.dx(_)},setNow:s.f.setNow,restoreNow:s.f.restoreNow}});var p=f;return p})})(vQ);function al(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function nL(e,n){for(var a=0;a<n.length;a++){var u=n[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,Yj(u.key),u)}}function $s(e,n,a){return n&&nL(e.prototype,n),a&&nL(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rc(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&YC(e,n)}function Dc(e,n){if(n&&(c_(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return On(e)}function zo(e){return zo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},zo(e)}function iL(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function $w(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?iL(Object(a),!0).forEach(function(u){pr(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):iL(Object(a)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function oL(e){if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(e=xQ(e))){var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(L){throw L},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,f=!0,w=!1,p;return{s:function(){u=e[Symbol.iterator]()},n:function(){var L=u.next();return f=L.done,L},e:function(L){w=!0,p=L},f:function(){try{!f&&u.return!=null&&u.return()}finally{if(w)throw p}}}}function xQ(e,n){if(e){if(typeof e=="string")return aL(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return aL(e,n)}}function aL(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,u=new Array(n);a<n;a++)u[a]=e[a];return u}var bQ=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function sL(e){if(!e)return null;if(typeof e=="string")return e;e.toJS&&(e=e.toJS());var n={},a=oL(e.layers),u;try{for(a.s();!(u=a.n()).done;){var f=u.value;n[f.id]=f}}catch(p){a.e(p)}finally{a.f()}var w=e.layers.map(function(p){var s=n[p.ref],L=null;if("interactive"in p&&(L=$w({},p),delete L.interactive),s){L=L||$w({},p),delete L.ref;var F=oL(bQ),G;try{for(F.s();!(G=F.n()).done;){var H=G.value;H in s&&(L[H]=s[H])}}catch(X){F.e(X)}finally{F.f()}}return L||p});return $w($w({},e),{},{layers:w})}var Xc=1e-6,x0=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function wQ(){var e=new x0(4);return x0!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function SQ(e,n,a){return e[0]=n[0]*a,e[1]=n[1]*a,e[2]=n[2]*a,e[3]=n[3]*a,e}function TQ(e,n,a){var u=n[0],f=n[1],w=n[2],p=n[3];return e[0]=a[0]*u+a[4]*f+a[8]*w+a[12]*p,e[1]=a[1]*u+a[5]*f+a[9]*w+a[13]*p,e[2]=a[2]*u+a[6]*f+a[10]*w+a[14]*p,e[3]=a[3]*u+a[7]*f+a[11]*w+a[15]*p,e}(function(){var e=wQ();return function(n,a,u,f,w,p){var s,L;for(a||(a=4),u||(u=0),f?L=Math.min(f*a+u,n.length):L=n.length,s=u;s<L;s+=a)e[0]=n[s],e[1]=n[s+1],e[2]=n[s+2],e[3]=n[s+3],w(e,e,p),n[s]=e[0],n[s+1]=e[1],n[s+2]=e[2],n[s+3]=e[3];return n}})();function b2(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function e0(e,n){const a=TQ([],n,e);return SQ(a,a,1/a[3]),a}function lL(e,n){const a=e%n;return a<0?n+a:a}function EQ(e,n,a){return a*n+(1-a)*e}function QC(e,n,a){return e<n?n:e>a?a:e}function IQ(e){return Math.log(e)*Math.LOG2E}const SM=Math.log2||IQ;function CQ(e,n){var a=n[0],u=n[1],f=n[2],w=n[3],p=n[4],s=n[5],L=n[6],F=n[7],G=n[8],H=n[9],X=n[10],ne=n[11],ie=n[12],se=n[13],Te=n[14],ue=n[15],ce=a*s-u*p,de=a*L-f*p,Ee=a*F-w*p,Ne=u*L-f*s,rt=u*F-w*s,tt=f*F-w*L,Ge=G*se-H*ie,_t=G*Te-X*ie,yt=G*ue-ne*ie,Et=H*Te-X*se,Wt=H*ue-ne*se,Ar=X*ue-ne*Te,mt=ce*Ar-de*Wt+Ee*Et+Ne*yt-rt*_t+tt*Ge;return mt?(mt=1/mt,e[0]=(s*Ar-L*Wt+F*Et)*mt,e[1]=(f*Wt-u*Ar-w*Et)*mt,e[2]=(se*tt-Te*rt+ue*Ne)*mt,e[3]=(X*rt-H*tt-ne*Ne)*mt,e[4]=(L*yt-p*Ar-F*_t)*mt,e[5]=(a*Ar-f*yt+w*_t)*mt,e[6]=(Te*Ee-ie*tt-ue*de)*mt,e[7]=(G*tt-X*Ee+ne*de)*mt,e[8]=(p*Wt-s*yt+F*Ge)*mt,e[9]=(u*yt-a*Wt-w*Ge)*mt,e[10]=(ie*rt-se*Ee+ue*ce)*mt,e[11]=(H*Ee-G*rt-ne*ce)*mt,e[12]=(s*_t-p*Et-L*Ge)*mt,e[13]=(a*Et-u*_t+f*Ge)*mt,e[14]=(se*de-ie*Ne-Te*ce)*mt,e[15]=(G*Ne-H*de+X*ce)*mt,e):null}function TI(e,n,a){var u=n[0],f=n[1],w=n[2],p=n[3],s=n[4],L=n[5],F=n[6],G=n[7],H=n[8],X=n[9],ne=n[10],ie=n[11],se=n[12],Te=n[13],ue=n[14],ce=n[15],de=a[0],Ee=a[1],Ne=a[2],rt=a[3];return e[0]=de*u+Ee*s+Ne*H+rt*se,e[1]=de*f+Ee*L+Ne*X+rt*Te,e[2]=de*w+Ee*F+Ne*ne+rt*ue,e[3]=de*p+Ee*G+Ne*ie+rt*ce,de=a[4],Ee=a[5],Ne=a[6],rt=a[7],e[4]=de*u+Ee*s+Ne*H+rt*se,e[5]=de*f+Ee*L+Ne*X+rt*Te,e[6]=de*w+Ee*F+Ne*ne+rt*ue,e[7]=de*p+Ee*G+Ne*ie+rt*ce,de=a[8],Ee=a[9],Ne=a[10],rt=a[11],e[8]=de*u+Ee*s+Ne*H+rt*se,e[9]=de*f+Ee*L+Ne*X+rt*Te,e[10]=de*w+Ee*F+Ne*ne+rt*ue,e[11]=de*p+Ee*G+Ne*ie+rt*ce,de=a[12],Ee=a[13],Ne=a[14],rt=a[15],e[12]=de*u+Ee*s+Ne*H+rt*se,e[13]=de*f+Ee*L+Ne*X+rt*Te,e[14]=de*w+Ee*F+Ne*ne+rt*ue,e[15]=de*p+Ee*G+Ne*ie+rt*ce,e}function eA(e,n,a){var u=a[0],f=a[1],w=a[2],p,s,L,F,G,H,X,ne,ie,se,Te,ue;return n===e?(e[12]=n[0]*u+n[4]*f+n[8]*w+n[12],e[13]=n[1]*u+n[5]*f+n[9]*w+n[13],e[14]=n[2]*u+n[6]*f+n[10]*w+n[14],e[15]=n[3]*u+n[7]*f+n[11]*w+n[15]):(p=n[0],s=n[1],L=n[2],F=n[3],G=n[4],H=n[5],X=n[6],ne=n[7],ie=n[8],se=n[9],Te=n[10],ue=n[11],e[0]=p,e[1]=s,e[2]=L,e[3]=F,e[4]=G,e[5]=H,e[6]=X,e[7]=ne,e[8]=ie,e[9]=se,e[10]=Te,e[11]=ue,e[12]=p*u+G*f+ie*w+n[12],e[13]=s*u+H*f+se*w+n[13],e[14]=L*u+X*f+Te*w+n[14],e[15]=F*u+ne*f+ue*w+n[15]),e}function hB(e,n,a){var u=a[0],f=a[1],w=a[2];return e[0]=n[0]*u,e[1]=n[1]*u,e[2]=n[2]*u,e[3]=n[3]*u,e[4]=n[4]*f,e[5]=n[5]*f,e[6]=n[6]*f,e[7]=n[7]*f,e[8]=n[8]*w,e[9]=n[9]*w,e[10]=n[10]*w,e[11]=n[11]*w,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function AQ(e,n,a){var u=Math.sin(a),f=Math.cos(a),w=n[4],p=n[5],s=n[6],L=n[7],F=n[8],G=n[9],H=n[10],X=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=w*f+F*u,e[5]=p*f+G*u,e[6]=s*f+H*u,e[7]=L*f+X*u,e[8]=F*f-w*u,e[9]=G*f-p*u,e[10]=H*f-s*u,e[11]=X*f-L*u,e}function PQ(e,n,a){var u=Math.sin(a),f=Math.cos(a),w=n[0],p=n[1],s=n[2],L=n[3],F=n[4],G=n[5],H=n[6],X=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=w*f+F*u,e[1]=p*f+G*u,e[2]=s*f+H*u,e[3]=L*f+X*u,e[4]=F*f-w*u,e[5]=G*f-p*u,e[6]=H*f-s*u,e[7]=X*f-L*u,e}function MQ(e,n,a,u,f){var w=1/Math.tan(n/2),p;return e[0]=w/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=w,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(p=1/(u-f),e[10]=(f+u)*p,e[14]=2*f*u*p):(e[10]=-1,e[14]=-2*u),e}var kQ=MQ;function cL(e,n){var a=e[0],u=e[1],f=e[2],w=e[3],p=e[4],s=e[5],L=e[6],F=e[7],G=e[8],H=e[9],X=e[10],ne=e[11],ie=e[12],se=e[13],Te=e[14],ue=e[15],ce=n[0],de=n[1],Ee=n[2],Ne=n[3],rt=n[4],tt=n[5],Ge=n[6],_t=n[7],yt=n[8],Et=n[9],Wt=n[10],Ar=n[11],mt=n[12],nr=n[13],Xt=n[14],Ht=n[15];return Math.abs(a-ce)<=Xc*Math.max(1,Math.abs(a),Math.abs(ce))&&Math.abs(u-de)<=Xc*Math.max(1,Math.abs(u),Math.abs(de))&&Math.abs(f-Ee)<=Xc*Math.max(1,Math.abs(f),Math.abs(Ee))&&Math.abs(w-Ne)<=Xc*Math.max(1,Math.abs(w),Math.abs(Ne))&&Math.abs(p-rt)<=Xc*Math.max(1,Math.abs(p),Math.abs(rt))&&Math.abs(s-tt)<=Xc*Math.max(1,Math.abs(s),Math.abs(tt))&&Math.abs(L-Ge)<=Xc*Math.max(1,Math.abs(L),Math.abs(Ge))&&Math.abs(F-_t)<=Xc*Math.max(1,Math.abs(F),Math.abs(_t))&&Math.abs(G-yt)<=Xc*Math.max(1,Math.abs(G),Math.abs(yt))&&Math.abs(H-Et)<=Xc*Math.max(1,Math.abs(H),Math.abs(Et))&&Math.abs(X-Wt)<=Xc*Math.max(1,Math.abs(X),Math.abs(Wt))&&Math.abs(ne-Ar)<=Xc*Math.max(1,Math.abs(ne),Math.abs(Ar))&&Math.abs(ie-mt)<=Xc*Math.max(1,Math.abs(ie),Math.abs(mt))&&Math.abs(se-nr)<=Xc*Math.max(1,Math.abs(se),Math.abs(nr))&&Math.abs(Te-Xt)<=Xc*Math.max(1,Math.abs(Te),Math.abs(Xt))&&Math.abs(ue-Ht)<=Xc*Math.max(1,Math.abs(ue),Math.abs(Ht))}function RQ(){var e=new x0(2);return x0!=Float32Array&&(e[0]=0,e[1]=0),e}function tA(e,n,a){return e[0]=n[0]+a[0],e[1]=n[1]+a[1],e}function DQ(e,n,a){return e[0]=n[0]-a[0],e[1]=n[1]-a[1],e}function OQ(e,n,a){return e[0]=n[0]*a,e[1]=n[1]*a,e}function LQ(e){var n=e[0],a=e[1];return Math.hypot(n,a)}function zQ(e,n){return e[0]=-n[0],e[1]=-n[1],e}function dB(e,n,a,u){var f=n[0],w=n[1];return e[0]=f+u*(a[0]-f),e[1]=w+u*(a[1]-w),e}var NQ=DQ;(function(){var e=RQ();return function(n,a,u,f,w,p){var s,L;for(a||(a=2),u||(u=0),f?L=Math.min(f*a+u,n.length):L=n.length,s=u;s<L;s+=a)e[0]=n[s],e[1]=n[s+1],w(e,e,p),n[s]=e[0],n[s+1]=e[1];return n}})();function jQ(){var e=new x0(3);return x0!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function BQ(e,n,a){return e[0]=n[0]+a[0],e[1]=n[1]+a[1],e[2]=n[2]+a[2],e}function FQ(e,n,a){return e[0]=n[0]*a[0],e[1]=n[1]*a[1],e[2]=n[2]*a[2],e}function VQ(e,n){return e[0]=-n[0],e[1]=-n[1],e[2]=-n[2],e}var UQ=FQ;(function(){var e=jQ();return function(n,a,u,f,w,p){var s,L;for(a||(a=3),u||(u=0),f?L=Math.min(f*a+u,n.length):L=n.length,s=u;s<L;s+=a)e[0]=n[s],e[1]=n[s+1],e[2]=n[s+2],w(e,e,p),n[s]=e[0],n[s+1]=e[1],n[s+2]=e[2];return n}})();function d_(e,n){if(!e)throw new Error(n||"@math.gl/web-mercator: assertion failed.")}const zp=Math.PI,pB=zp/4,Mf=zp/180,rA=180/zp,Q1=512,uL=4003e4,Gw=85.051129,fB=1.5;function nA(e){return Math.pow(2,e)}function $Q(e){return SM(e)}function Gg(e){const[n,a]=e;d_(Number.isFinite(n)),d_(Number.isFinite(a)&&a>=-90&&a<=90,"invalid latitude");const u=n*Mf,f=a*Mf,w=Q1*(u+zp)/(2*zp),p=Q1*(zp+Math.log(Math.tan(pB+f*.5)))/(2*zp);return[w,p]}function n_(e){const[n,a]=e,u=n/Q1*(2*zp)-zp,f=2*(Math.atan(Math.exp(a/Q1*(2*zp)-zp))-pB);return[u*rA,f*rA]}function GQ(e){const{latitude:n,longitude:a,highPrecision:u=!1}=e;d_(Number.isFinite(n)&&Number.isFinite(a));const f=Q1,w=Math.cos(n*Mf),p=f/360,s=p/w,L=f/uL/w,F={unitsPerMeter:[L,L,L],metersPerUnit:[1/L,1/L,1/L],unitsPerDegree:[p,s,L],degreesPerUnit:[1/p,1/s,1/L]};if(u){const G=Mf*Math.tan(n*Mf)/w,H=p*G/2,X=f/uL*G,ne=X/s*L;F.unitsPerDegree2=[0,H,X],F.unitsPerMeter2=[ne,0,ne]}return F}function qQ(e){const{height:n,pitch:a,bearing:u,altitude:f,scale:w,center:p}=e,s=b2();eA(s,s,[0,0,-f]),AQ(s,s,-a*Mf),PQ(s,s,u*Mf);const L=w/n;return hB(s,s,[L,L,L]),p&&eA(s,s,VQ([],p)),s}function WQ(e){const{width:n,height:a,altitude:u,pitch:f=0,offset:w,center:p,scale:s,nearZMultiplier:L=1,farZMultiplier:F=1}=e;let{fovy:G=yS(fB)}=e;u!==void 0&&(G=yS(u));const H=G*Mf,X=f*Mf,ne=mB(G);let ie=ne;p&&(ie+=p[2]*s/Math.cos(X)/a);const se=H*(.5+(w?w[1]:0)/a),Te=Math.sin(se)*ie/Math.sin(QC(Math.PI/2-X-se,.01,Math.PI-.01)),ue=Math.sin(X)*Te+ie,ce=ie*10,de=Math.min(ue*F,ce);return{fov:H,aspect:n/a,focalDistance:ne,near:L,far:de}}function HQ(e){const{fov:n,aspect:a,near:u,far:f}=WQ(e);return kQ([],n,a,u,f)}function yS(e){return 2*Math.atan(.5/e)*rA}function mB(e){return .5/Math.tan(.5*e*Mf)}function ZQ(e,n){const[a,u,f=0]=e;return d_(Number.isFinite(a)&&Number.isFinite(u)&&Number.isFinite(f)),e0(n,[a,u,f,1])}function hL(e,n,a=0){const[u,f,w]=e;if(d_(Number.isFinite(u)&&Number.isFinite(f),"invalid pixel coordinate"),Number.isFinite(w))return e0(n,[u,f,w,1]);const p=e0(n,[u,f,0,1]),s=e0(n,[u,f,1,1]),L=p[2],F=s[2],G=L===F?0:((a||0)-L)/(F-L);return dB([],p,s,G)}function XQ(e){const{width:n,height:a,bounds:u,minExtent:f=0,maxZoom:w=24,offset:p=[0,0]}=e,[[s,L],[F,G]]=u,H=YQ(e.padding),X=Gg([s,QC(G,-Gw,Gw)]),ne=Gg([F,QC(L,-Gw,Gw)]),ie=[Math.max(Math.abs(ne[0]-X[0]),f),Math.max(Math.abs(ne[1]-X[1]),f)],se=[n-H.left-H.right-Math.abs(p[0])*2,a-H.top-H.bottom-Math.abs(p[1])*2];d_(se[0]>0&&se[1]>0);const Te=se[0]/ie[0],ue=se[1]/ie[1],ce=(H.right-H.left)/2/Te,de=(H.top-H.bottom)/2/ue,Ee=[(ne[0]+X[0])/2+ce,(ne[1]+X[1])/2+de],Ne=n_(Ee),rt=Math.min(w,SM(Math.abs(Math.min(Te,ue))));return d_(Number.isFinite(rt)),{longitude:Ne[0],latitude:Ne[1],zoom:rt}}function YQ(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(d_(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}const dL=Math.PI/180;function KQ(e,n=0){const{width:a,height:u,unproject:f}=e,w={targetZ:n},p=f([0,u],w),s=f([a,u],w);let L,F;const G=e.fovy?.5*e.fovy*dL:Math.atan(.5/e.altitude),H=(90-e.pitch)*dL;return G>H-.01?(L=pL(e,0,n),F=pL(e,a,n)):(L=f([0,0],w),F=f([a,0],w)),[p,s,F,L]}function pL(e,n,a){const{pixelUnprojectionMatrix:u}=e,f=e0(u,[n,0,1,1]),w=e0(u,[n,e.height,1,1]),s=(a*e.distanceScales.unitsPerMeter[2]-f[2])/(w[2]-f[2]),L=dB([],f,w,s),F=n_(L);return F.push(a),F}class Zd{constructor(n={width:1,height:1}){pr(this,"latitude",void 0),pr(this,"longitude",void 0),pr(this,"zoom",void 0),pr(this,"pitch",void 0),pr(this,"bearing",void 0),pr(this,"altitude",void 0),pr(this,"fovy",void 0),pr(this,"meterOffset",void 0),pr(this,"center",void 0),pr(this,"width",void 0),pr(this,"height",void 0),pr(this,"scale",void 0),pr(this,"distanceScales",void 0),pr(this,"viewMatrix",void 0),pr(this,"projectionMatrix",void 0),pr(this,"viewProjectionMatrix",void 0),pr(this,"pixelProjectionMatrix",void 0),pr(this,"pixelUnprojectionMatrix",void 0),pr(this,"equals",ue=>ue instanceof Zd?ue.width===this.width&&ue.height===this.height&&cL(ue.projectionMatrix,this.projectionMatrix)&&cL(ue.viewMatrix,this.viewMatrix):!1),pr(this,"project",(ue,ce={})=>{const{topLeft:de=!0}=ce,Ee=this.projectPosition(ue),Ne=ZQ(Ee,this.pixelProjectionMatrix),[rt,tt]=Ne,Ge=de?tt:this.height-tt;return ue.length===2?[rt,Ge]:[rt,Ge,Ne[2]]}),pr(this,"unproject",(ue,ce={})=>{const{topLeft:de=!0,targetZ:Ee=void 0}=ce,[Ne,rt,tt]=ue,Ge=de?rt:this.height-rt,_t=Ee&&Ee*this.distanceScales.unitsPerMeter[2],yt=hL([Ne,Ge,tt],this.pixelUnprojectionMatrix,_t),[Et,Wt,Ar]=this.unprojectPosition(yt);return Number.isFinite(tt)?[Et,Wt,Ar]:Number.isFinite(Ee)?[Et,Wt,Ee]:[Et,Wt]}),pr(this,"projectPosition",ue=>{const[ce,de]=Gg(ue),Ee=(ue[2]||0)*this.distanceScales.unitsPerMeter[2];return[ce,de,Ee]}),pr(this,"unprojectPosition",ue=>{const[ce,de]=n_(ue),Ee=(ue[2]||0)*this.distanceScales.metersPerUnit[2];return[ce,de,Ee]});let{width:a,height:u,altitude:f=null,fovy:w=null}=n;const{latitude:p=0,longitude:s=0,zoom:L=0,pitch:F=0,bearing:G=0,position:H=null,nearZMultiplier:X=.02,farZMultiplier:ne=1.01}=n;a=a||1,u=u||1,w===null&&f===null?(f=fB,w=yS(f)):w===null?w=yS(f):f===null&&(f=mB(w));const ie=nA(L);f=Math.max(.75,f);const se=GQ({longitude:s,latitude:p}),Te=Gg([s,p]);Te.push(0),H&&BQ(Te,Te,UQ([],H,se.unitsPerMeter)),this.projectionMatrix=HQ({width:a,height:u,scale:ie,center:Te,pitch:F,fovy:w,nearZMultiplier:X,farZMultiplier:ne}),this.viewMatrix=qQ({height:u,scale:ie,center:Te,pitch:F,bearing:G,altitude:f}),this.width=a,this.height=u,this.scale=ie,this.latitude=p,this.longitude=s,this.zoom=L,this.pitch=F,this.bearing=G,this.altitude=f,this.fovy=w,this.center=Te,this.meterOffset=H||[0,0,0],this.distanceScales=se,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:n,height:a,projectionMatrix:u,viewMatrix:f}=this,w=b2();TI(w,w,u),TI(w,w,f),this.viewProjectionMatrix=w;const p=b2();hB(p,p,[n/2,-a/2,1]),eA(p,p,[1,-1,0]),TI(p,p,w);const s=CQ(b2(),p);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=s}projectFlat(n){return Gg(n)}unprojectFlat(n){return n_(n)}getMapCenterByLngLatPosition({lngLat:n,pos:a}){const u=hL(a,this.pixelUnprojectionMatrix),f=Gg(n),w=tA([],f,zQ([],u)),p=tA([],this.center,w);return n_(p)}fitBounds(n,a={}){const{width:u,height:f}=this,{longitude:w,latitude:p,zoom:s}=XQ(Object.assign({width:u,height:f,bounds:n},a));return new Zd({width:u,height:f,longitude:w,latitude:p,zoom:s})}getBounds(n){const a=this.getBoundingRegion(n),u=Math.min(...a.map(s=>s[0])),f=Math.max(...a.map(s=>s[0])),w=Math.min(...a.map(s=>s[1])),p=Math.max(...a.map(s=>s[1]));return[[u,w],[f,p]]}getBoundingRegion(n={}){return KQ(this,n.z||0)}getLocationAtPoint({lngLat:n,pos:a}){return this.getMapCenterByLngLatPosition({lngLat:n,pos:a})}}const fL=512;function JQ(e){const{width:n,height:a,pitch:u=0}=e;let{longitude:f,latitude:w,zoom:p,bearing:s=0}=e;(f<-180||f>180)&&(f=lL(f+180,360)-180),(s<-180||s>180)&&(s=lL(s+180,360)-180);const L=SM(a/fL);if(p<=L)p=L,w=0;else{const F=a/2/Math.pow(2,p),G=n_([0,F])[1];if(w<G)w=G;else{const H=n_([0,fL-F])[1];w>H&&(w=H)}}return{width:n,height:a,longitude:f,latitude:w,zoom:p,pitch:u,bearing:s}}const gB=.01,QQ=["longitude","latitude","zoom"],_B={curve:1.414,speed:1.2};function eee(e,n,a,u){const{startZoom:f,startCenterXY:w,uDelta:p,w0:s,u1:L,S:F,rho:G,rho2:H,r0:X}=yB(e,n,u);if(L<gB){const Ee={};for(const Ne of QQ){const rt=e[Ne],tt=n[Ne];Ee[Ne]=EQ(rt,tt,a)}return Ee}const ne=a*F,ie=Math.cosh(X)/Math.cosh(X+G*ne),se=s*((Math.cosh(X)*Math.tanh(X+G*ne)-Math.sinh(X))/H)/L,Te=1/ie,ue=f+$Q(Te),ce=OQ([],p,se);tA(ce,ce,w);const de=n_(ce);return{longitude:de[0],latitude:de[1],zoom:ue}}function tee(e,n,a){const u={..._B,...a},{screenSpeed:f,speed:w,maxDuration:p}=u,{S:s,rho:L}=yB(e,n,u),F=1e3*s;let G;return Number.isFinite(f)?G=F/(f/L):G=F/w,Number.isFinite(p)&&G>p?0:G}function yB(e,n,a){a=Object.assign({},_B,a);const u=a.curve,f=e.zoom,w=[e.longitude,e.latitude],p=nA(f),s=n.zoom,L=[n.longitude,n.latitude],F=nA(s-f),G=Gg(w),H=Gg(L),X=NQ([],H,G),ne=Math.max(e.width,e.height),ie=ne/F,se=LQ(X)*p,Te=Math.max(se,gB),ue=u*u,ce=(ie*ie-ne*ne+ue*ue*Te*Te)/(2*ne*ue*Te),de=(ie*ie-ne*ne-ue*ue*Te*Te)/(2*ie*ue*Te),Ee=Math.log(Math.sqrt(ce*ce+1)-ce),Ne=Math.log(Math.sqrt(de*de+1)-de),rt=(Ne-Ee)/u;return{startZoom:f,startCenterXY:G,uDelta:X,w0:ne,u1:se,S:rt,rho:u,rho2:ue,r0:Ee,r1:Ne}}let Xd;typeof window<"u"?Xd=window:typeof self<"u"?Xd=self:Xd=global;let iA=null,oA=null;const mL=20,EI=Xd.clearTimeout,gL=Xd.setTimeout,II=Xd.cancelAnimationFrame||Xd.mozCancelAnimationFrame||Xd.webkitCancelAnimationFrame,_L=Xd.requestAnimationFrame||Xd.mozRequestAnimationFrame||Xd.webkitRequestAnimationFrame;II==null||_L==null?(iA=EI,oA=function(n){return gL(n,mL)}):(iA=function([n,a]){II(n),EI(a)},oA=function(n){const a=_L(function(){EI(u),n()}),u=gL(function(){II(a),n()},mL);return[a,u]});function ree(e){let n,a,u,f,w,p,s;const L=typeof document<"u"&&document.attachEvent;if(!L){p=function(ue){const ce=ue.__resizeTriggers__,de=ce.firstElementChild,Ee=ce.lastElementChild,Ne=de.firstElementChild;Ee.scrollLeft=Ee.scrollWidth,Ee.scrollTop=Ee.scrollHeight,Ne.style.width=de.offsetWidth+1+"px",Ne.style.height=de.offsetHeight+1+"px",de.scrollLeft=de.scrollWidth,de.scrollTop=de.scrollHeight},w=function(ue){return ue.offsetWidth!==ue.__resizeLast__.width||ue.offsetHeight!==ue.__resizeLast__.height},s=function(ue){if(ue.target.className&&typeof ue.target.className.indexOf=="function"&&ue.target.className.indexOf("contract-trigger")<0&&ue.target.className.indexOf("expand-trigger")<0)return;const ce=this;p(this),this.__resizeRAF__&&iA(this.__resizeRAF__),this.__resizeRAF__=oA(function(){w(ce)&&(ce.__resizeLast__.width=ce.offsetWidth,ce.__resizeLast__.height=ce.offsetHeight,ce.__resizeListeners__.forEach(function(Ne){Ne.call(ce,ue)}))})};let X=!1,ne="";u="animationstart";const ie="Webkit Moz O ms".split(" ");let se="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),Te="";{const ue=document.createElement("fakeelement");if(ue.style.animationName!==void 0&&(X=!0),X===!1){for(let ce=0;ce<ie.length;ce++)if(ue.style[ie[ce]+"AnimationName"]!==void 0){Te=ie[ce],ne="-"+Te.toLowerCase()+"-",u=se[ce],X=!0;break}}}a="resizeanim",n="@"+ne+"keyframes "+a+" { from { opacity: 0; } to { opacity: 0; } } ",f=ne+"animation: 1ms "+a+"; "}const F=function(X){if(!X.getElementById("detectElementResize")){const ne=(n||"")+".resize-triggers { "+(f||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',ie=X.head||X.getElementsByTagName("head")[0],se=X.createElement("style");se.id="detectElementResize",se.type="text/css",e!=null&&se.setAttribute("nonce",e),se.styleSheet?se.styleSheet.cssText=ne:se.appendChild(X.createTextNode(ne)),ie.appendChild(se)}};return{addResizeListener:function(X,ne){if(L)X.attachEvent("onresize",ne);else{if(!X.__resizeTriggers__){const ie=X.ownerDocument,se=Xd.getComputedStyle(X);se&&se.position==="static"&&(X.style.position="relative"),F(ie),X.__resizeLast__={},X.__resizeListeners__=[],(X.__resizeTriggers__=ie.createElement("div")).className="resize-triggers";const Te=ie.createElement("div");Te.className="expand-trigger",Te.appendChild(ie.createElement("div"));const ue=ie.createElement("div");ue.className="contract-trigger",X.__resizeTriggers__.appendChild(Te),X.__resizeTriggers__.appendChild(ue),X.appendChild(X.__resizeTriggers__),p(X),X.addEventListener("scroll",s,!0),u&&(X.__resizeTriggers__.__animationListener__=function(de){de.animationName===a&&p(X)},X.__resizeTriggers__.addEventListener(u,X.__resizeTriggers__.__animationListener__))}X.__resizeListeners__.push(ne)}},removeResizeListener:function(X,ne){if(L)X.detachEvent("onresize",ne);else if(X.__resizeListeners__.splice(X.__resizeListeners__.indexOf(ne),1),!X.__resizeListeners__.length){X.removeEventListener("scroll",s,!0),X.__resizeTriggers__.__animationListener__&&(X.__resizeTriggers__.removeEventListener(u,X.__resizeTriggers__.__animationListener__),X.__resizeTriggers__.__animationListener__=null);try{X.__resizeTriggers__=!X.removeChild(X.__resizeTriggers__)}catch{}}}}}class nee extends fe.Component{constructor(...n){super(...n),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:a,disableWidth:u,onResize:f}=this.props;if(this._parentNode){const w=window.getComputedStyle(this._parentNode)||{},p=parseFloat(w.paddingLeft||"0"),s=parseFloat(w.paddingRight||"0"),L=parseFloat(w.paddingTop||"0"),F=parseFloat(w.paddingBottom||"0"),G=this._parentNode.getBoundingClientRect(),H=G.height-L-F,X=G.width-p-s,ne=this._parentNode.offsetHeight-L-F,ie=this._parentNode.offsetWidth-p-s;(!a&&(this.state.height!==ne||this.state.scaledHeight!==H)||!u&&(this.state.width!==ie||this.state.scaledWidth!==X))&&(this.setState({height:ne,width:ie,scaledHeight:H,scaledWidth:X}),typeof f=="function"&&f({height:ne,scaledHeight:H,scaledWidth:X,width:ie}))}},this._setRef=a=>{this._autoSizer=a}}componentDidMount(){const{nonce:n}=this.props,a=this._autoSizer?this._autoSizer.parentNode:null;if(a!=null&&a.ownerDocument&&a.ownerDocument.defaultView&&a instanceof a.ownerDocument.defaultView.HTMLElement){this._parentNode=a;const u=a.ownerDocument.defaultView.ResizeObserver;u!=null?(this._resizeObserver=new u(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(a)):(this._detectElementResize=ree(n),this._detectElementResize.addResizeListener(a,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:n,defaultHeight:a,defaultWidth:u,disableHeight:f=!1,disableWidth:w=!1,doNotBailOutOnEmptyChildren:p=!1,nonce:s,onResize:L,style:F={},tagName:G="div",...H}=this.props,{height:X,scaledHeight:ne,scaledWidth:ie,width:se}=this.state,Te={overflow:"visible"},ue={};let ce=!1;return f||(X===0&&(ce=!0),Te.height=0,ue.height=X,ue.scaledHeight=ne),w||(se===0&&(ce=!0),Te.width=0,ue.width=se,ue.scaledWidth=ie),p&&(ce=!1),fe.createElement(G,{ref:this._setRef,style:{...Te,...F},...H},!ce&&n(ue))}}var yL=typeof window<"u"?window:global,Bg=typeof document<"u"?document:{};function iee(){}function oee(e){e&&console.error(e.error)}var vB={container:Or.object,gl:Or.object,mapboxApiAccessToken:Or.string,mapboxApiUrl:Or.string,attributionControl:Or.bool,preserveDrawingBuffer:Or.bool,reuseMaps:Or.bool,transformRequest:Or.func,mapOptions:Or.object,mapStyle:Or.oneOfType([Or.string,Or.object]),visible:Or.bool,asyncRender:Or.bool,onLoad:Or.func,onError:Or.func,width:Or.number,height:Or.number,viewState:Or.object,longitude:Or.number,latitude:Or.number,zoom:Or.number,bearing:Or.number,pitch:Or.number,altitude:Or.number},w2={container:Bg.body,mapboxApiAccessToken:aee(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:iee,onError:oee,width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function aee(){var e=null;if(typeof window<"u"&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);e=n&&n[1]}return!e&&typeof process<"u"&&(e=e||{}.MapboxAccessToken||{}.REACT_APP_MAPBOX_ACCESS_TOKEN),e||"no-token"}function vL(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"component";e.debug&&Or.checkPropTypes(vB,e,"prop",n)}var ky=function(){function e(n){var a=this;if(al(this,e),pr(this,"mapboxgl",void 0),pr(this,"props",w2),pr(this,"_map",null),pr(this,"width",0),pr(this,"height",0),pr(this,"_fireLoadEvent",function(){a.props.onLoad({type:"load",target:a._map})}),!n.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=n.mapboxgl,e.initialized||(e.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(n)}return $s(e,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(a){return this._update(this.props,a),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var a=this._map;a.style&&(a._frame&&(a._frame.cancel(),a._frame=null),a._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(a){this._map=e.savedMap;var u=this._map.getContainer(),f=a.container;for(f.classList.add("mapboxgl-map");u.childNodes.length>0;)f.appendChild(u.childNodes[0]);this._map._container=f,e.savedMap=null,a.mapStyle&&this._map.setStyle(a.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(a){if(a.reuseMaps&&e.savedMap)this._reuse(a);else{if(a.gl){var u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=u,a.gl}}var f={container:a.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:a.mapStyle,interactive:!1,trackResize:!1,attributionControl:a.attributionControl,preserveDrawingBuffer:a.preserveDrawingBuffer};a.transformRequest&&(f.transformRequest=a.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},f,a.mapOptions)),this._map.once("load",a.onLoad),this._map.on("error",a.onError)}return this}},{key:"_destroy",value:function(){this._map&&(e.savedMap?this._map.remove():(e.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(a){var u=this;a=Object.assign({},w2,a),vL(a,"Mapbox"),this.mapboxgl.accessToken=a.mapboxApiAccessToken||w2.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=a.mapboxApiUrl,this._create(a);var f=a,w=f.container;Object.defineProperty(w,"offsetWidth",{get:function(){return u.width}}),Object.defineProperty(w,"clientWidth",{get:function(){return u.width}}),Object.defineProperty(w,"offsetHeight",{get:function(){return u.height}}),Object.defineProperty(w,"clientHeight",{get:function(){return u.height}});var p=this._map.getCanvas();p&&(p.style.outline="none"),this._updateMapViewport({},a),this._updateMapSize({},a),this.props=a}},{key:"_update",value:function(a,u){if(this._map){u=Object.assign({},this.props,u),vL(u,"Mapbox");var f=this._updateMapViewport(a,u),w=this._updateMapSize(a,u);!u.asyncRender&&(f||w)&&this.redraw(),this.props=u}}},{key:"_updateMapSize",value:function(a,u){var f=a.width!==u.width||a.height!==u.height;return f&&(this.width=u.width,this.height=u.height,this.resize()),f}},{key:"_updateMapViewport",value:function(a,u){var f=this._getViewState(a),w=this._getViewState(u),p=w.latitude!==f.latitude||w.longitude!==f.longitude||w.zoom!==f.zoom||w.pitch!==f.pitch||w.bearing!==f.bearing||w.altitude!==f.altitude;return p&&(this._map.jumpTo(this._viewStateToMapboxProps(w)),w.altitude!==f.altitude&&(this._map.transform.altitude=w.altitude)),p}},{key:"_getViewState",value:function(a){var u=a.viewState||a,f=u.longitude,w=u.latitude,p=u.zoom,s=u.pitch,L=s===void 0?0:s,F=u.bearing,G=F===void 0?0:F,H=u.altitude,X=H===void 0?1.5:H;return{longitude:f,latitude:w,zoom:p,pitch:L,bearing:G,altitude:X}}},{key:"_checkStyleSheet",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"0.47.0";if(!(typeof Bg>"u"))try{var u=Bg.createElement("div");u.className="mapboxgl-map",u.style.display="none",Bg.body.appendChild(u);var f=window.getComputedStyle(u).position!=="static";if(!f){var w=Bg.createElement("link");w.setAttribute("rel","stylesheet"),w.setAttribute("type","text/css"),w.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(a,"/mapbox-gl.css")),Bg.head.appendChild(w)}}catch{}}},{key:"_viewStateToMapboxProps",value:function(a){return{center:[a.longitude,a.latitude],zoom:a.zoom,bearing:a.bearing,pitch:a.pitch}}}]),e}();pr(ky,"initialized",!1);pr(ky,"propTypes",vB);pr(ky,"defaultProps",w2);pr(ky,"savedMap",null);var xB={exports:{}};(function(e,n){(function(a,u){e.exports=u()})(EA,function(){var a,u,f;function w(p,s){if(!a)a=s;else if(!u)u=s;else{var L="var sharedChunk = {}; ("+a+")(sharedChunk); ("+u+")(sharedChunk);",F={};a(F),f=s(F),typeof window<"u"&&(f.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}return w(["exports"],function(p){function s(l,d){return l(d={exports:{}},d.exports),d.exports}var L=F;function F(l,d,v,P){this.cx=3*l,this.bx=3*(v-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(P-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=P,this.p2x=v,this.p2y=P}F.prototype.sampleCurveX=function(l){return((this.ax*l+this.bx)*l+this.cx)*l},F.prototype.sampleCurveY=function(l){return((this.ay*l+this.by)*l+this.cy)*l},F.prototype.sampleCurveDerivativeX=function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},F.prototype.solveCurveX=function(l,d){var v,P,O,j,$;for(d===void 0&&(d=1e-6),O=l,$=0;$<8;$++){if(j=this.sampleCurveX(O)-l,Math.abs(j)<d)return O;var K=this.sampleCurveDerivativeX(O);if(Math.abs(K)<1e-6)break;O-=j/K}if((O=l)<(v=0))return v;if(O>(P=1))return P;for(;v<P;){if(j=this.sampleCurveX(O),Math.abs(j-l)<d)return O;l>j?v=O:P=O,O=.5*(P-v)+v}return O},F.prototype.solve=function(l,d){return this.sampleCurveY(this.solveCurveX(l,d))};var G=H;function H(l,d){this.x=l,this.y=d}H.prototype={clone:function(){return new H(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,d){return this.clone()._rotateAround(l,d)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var d=l.x-this.x,v=l.y-this.y;return d*d+v*v},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,d){return Math.atan2(this.x*d-this.y*l,this.x*l+this.y*d)},_matMult:function(l){var d=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=d,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var d=Math.cos(l),v=Math.sin(l),P=v*this.x+d*this.y;return this.x=d*this.x-v*this.y,this.y=P,this},_rotateAround:function(l,d){var v=Math.cos(l),P=Math.sin(l),O=d.y+P*(this.x-d.x)+v*(this.y-d.y);return this.x=d.x+v*(this.x-d.x)-P*(this.y-d.y),this.y=O,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(l){return l instanceof H?l:Array.isArray(l)?new H(l[0],l[1]):l};var X=typeof self<"u"?self:{},ne=Math.pow(2,53)-1;function ie(l,d,v,P){var O=new L(l,d,v,P);return function(j){return O.solve(j)}}var se=ie(.25,.1,.25,1);function Te(l,d,v){return Math.min(v,Math.max(d,l))}function ue(l,d,v){var P=v-d,O=((l-d)%P+P)%P+d;return O===d?v:O}function ce(l){for(var d=[],v=arguments.length-1;v-- >0;)d[v]=arguments[v+1];for(var P=0,O=d;P<O.length;P+=1){var j=O[P];for(var $ in j)l[$]=j[$]}return l}var de=1;function Ee(){return de++}function Ne(){return function l(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function rt(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function tt(l,d){l.forEach(function(v){d[v]&&(d[v]=d[v].bind(d))})}function Ge(l,d){return l.indexOf(d,l.length-d.length)!==-1}function _t(l,d,v){var P={};for(var O in l)P[O]=d.call(v||this,l[O],O,l);return P}function yt(l,d,v){var P={};for(var O in l)d.call(v||this,l[O],O,l)&&(P[O]=l[O]);return P}function Et(l){return Array.isArray(l)?l.map(Et):typeof l=="object"&&l?_t(l,Et):l}var Wt={};function Ar(l){Wt[l]||(typeof console<"u"&&console.warn(l),Wt[l]=!0)}function mt(l,d,v){return(v.y-l.y)*(d.x-l.x)>(d.y-l.y)*(v.x-l.x)}function nr(l){for(var d=0,v=0,P=l.length,O=P-1,j=void 0,$=void 0;v<P;O=v++)d+=(($=l[O]).x-(j=l[v]).x)*(j.y+$.y);return d}function Xt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ht(l){var d={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(P,O,j,$){var K=j||$;return d[O]=!K||K.toLowerCase(),""}),d["max-age"]){var v=parseInt(d["max-age"],10);isNaN(v)?delete d["max-age"]:d["max-age"]=v}return d}var Qt=null;function sr(l){if(Qt==null){var d=l.navigator?l.navigator.userAgent:null;Qt=!!l.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Qt}function Tr(l){try{var d=X[l];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch{return!1}}var ln,vn,wi,hi,Vn=X.performance&&X.performance.now?X.performance.now.bind(X.performance):Date.now.bind(Date),Oi=X.requestAnimationFrame||X.mozRequestAnimationFrame||X.webkitRequestAnimationFrame||X.msRequestAnimationFrame,fn=X.cancelAnimationFrame||X.mozCancelAnimationFrame||X.webkitCancelAnimationFrame||X.msCancelAnimationFrame,Nn={now:Vn,frame:function(l){var d=Oi(l);return{cancel:function(){return fn(d)}}},getImageData:function(l,d){d===void 0&&(d=0);var v=X.document.createElement("canvas"),P=v.getContext("2d");if(!P)throw new Error("failed to create canvas 2d context");return v.width=l.width,v.height=l.height,P.drawImage(l,0,0,l.width,l.height),P.getImageData(-d,-d,l.width+2*d,l.height+2*d)},resolveURL:function(l){return ln||(ln=X.document.createElement("a")),ln.href=l,ln.href},hardwareConcurrency:X.navigator&&X.navigator.hardwareConcurrency||4,get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(vn==null&&(vn=X.matchMedia("(prefers-reduced-motion: reduce)")),vn.matches)}},Pt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Dt={supported:!1,testSupport:function(l){!Ir&&hi&&(xr?Kt(l):wi=l)}},Ir=!1,xr=!1;function Kt(l){var d=l.createTexture();l.bindTexture(l.TEXTURE_2D,d);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,hi),l.isContextLost())return;Dt.supported=!0}catch{}l.deleteTexture(d),Ir=!0}X.document&&((hi=X.document.createElement("img")).onload=function(){wi&&Kt(wi),wi=null,xr=!0},hi.onerror=function(){Ir=!0,wi=null},hi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Cn="01",gn=function(l,d){this._transformRequestFn=l,this._customAccessToken=d,this._createSkuToken()};function fr(l){return l.indexOf("mapbox:")===0}gn.prototype._createSkuToken=function(){var l=function(){for(var d="",v=0;v<10;v++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Cn,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt},gn.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},gn.prototype.transformRequest=function(l,d){return this._transformRequestFn&&this._transformRequestFn(l,d)||{url:l}},gn.prototype.normalizeStyleURL=function(l,d){if(!fr(l))return l;var v=qn(l);return v.path="/styles/v1"+v.path,this._makeAPIURL(v,this._customAccessToken||d)},gn.prototype.normalizeGlyphsURL=function(l,d){if(!fr(l))return l;var v=qn(l);return v.path="/fonts/v1"+v.path,this._makeAPIURL(v,this._customAccessToken||d)},gn.prototype.normalizeSourceURL=function(l,d){if(!fr(l))return l;var v=qn(l);return v.path="/v4/"+v.authority+".json",v.params.push("secure"),this._makeAPIURL(v,this._customAccessToken||d)},gn.prototype.normalizeSpriteURL=function(l,d,v,P){var O=qn(l);return fr(l)?(O.path="/styles/v1"+O.path+"/sprite"+d+v,this._makeAPIURL(O,this._customAccessToken||P)):(O.path+=""+d+v,Li(O))},gn.prototype.normalizeTileURL=function(l,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!fr(l))return l;var v=qn(l);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Nn.devicePixelRatio>=2||d===512?"@2x":"")+(Dt.supported?".webp":"$1")),v.path=v.path.replace(/^.+\/v4\//,"/"),v.path="/v4"+v.path;var P=this._customAccessToken||function(O){for(var j=0,$=O;j<$.length;j+=1){var K=$[j].match(/^access_token=(.*)$/);if(K)return K[1]}return null}(v.params)||Pt.ACCESS_TOKEN;return Pt.REQUIRE_ACCESS_TOKEN&&P&&this._skuToken&&v.params.push("sku="+this._skuToken),this._makeAPIURL(v,P)},gn.prototype.canonicalizeTileURL=function(l,d){var v=qn(l);if(!v.path.match(/(^\/v4\/)/)||!v.path.match(/\.[\w]+$/))return l;var P="mapbox://tiles/";P+=v.path.replace("/v4/","");var O=v.params;return d&&(O=O.filter(function(j){return!j.match(/^access_token=/)})),O.length&&(P+="?"+O.join("&")),P},gn.prototype.canonicalizeTileset=function(l,d){for(var v=!!d&&fr(d),P=[],O=0,j=l.tiles||[];O<j.length;O+=1){var $=j[O];qr($)?P.push(this.canonicalizeTileURL($,v)):P.push($)}return P},gn.prototype._makeAPIURL=function(l,d){var v="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",P=qn(Pt.API_URL);if(l.protocol=P.protocol,l.authority=P.authority,l.protocol==="http"){var O=l.params.indexOf("secure");O>=0&&l.params.splice(O,1)}if(P.path!=="/"&&(l.path=""+P.path+l.path),!Pt.REQUIRE_ACCESS_TOKEN)return Li(l);if(!(d=d||Pt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+v);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+v);return l.params=l.params.filter(function(j){return j.indexOf("access_token")===-1}),l.params.push("access_token="+d),Li(l)};var Zr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function qr(l){return Zr.test(l)}var sn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function qn(l){var d=l.match(sn);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function Li(l){var d=l.params.length?"?"+l.params.join("&"):"";return l.protocol+"://"+l.authority+l.path+d}function _i(l){if(!l)return null;var d=l.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(d[1]).split("").map(function(v){return"%"+("00"+v.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var zi=function(l){this.type=l,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};zi.prototype.getStorageKey=function(l){var d,v=_i(Pt.ACCESS_TOKEN);return d=v&&v.u?X.btoa(encodeURIComponent(v.u).replace(/%([0-9A-F]{2})/g,function(P,O){return String.fromCharCode(+("0x"+O))})):Pt.ACCESS_TOKEN||"",l?"mapbox.eventData."+l+":"+d:"mapbox.eventData:"+d},zi.prototype.fetchEventData=function(){var l=Tr("localStorage"),d=this.getStorageKey(),v=this.getStorageKey("uuid");if(l)try{var P=X.localStorage.getItem(d);P&&(this.eventData=JSON.parse(P));var O=X.localStorage.getItem(v);O&&(this.anonId=O)}catch{Ar("Unable to read from LocalStorage")}},zi.prototype.saveEventData=function(){var l=Tr("localStorage"),d=this.getStorageKey(),v=this.getStorageKey("uuid");if(l)try{X.localStorage.setItem(v,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(d,JSON.stringify(this.eventData))}catch{Ar("Unable to write to LocalStorage")}},zi.prototype.processRequests=function(l){},zi.prototype.postEvent=function(l,d,v,P){var O=this;if(Pt.EVENTS_URL){var j=qn(Pt.EVENTS_URL);j.params.push("access_token="+(P||Pt.ACCESS_TOKEN||""));var $={event:this.type,created:new Date(l).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:Cn,userId:this.anonId},K=d?ce($,d):$,le={url:Li(j),headers:{"Content-Type":"text/plain"},body:JSON.stringify([K])};this.pendingRequest=eo(le,function(me){O.pendingRequest=null,v(me),O.saveEventData(),O.processRequests(P)})}},zi.prototype.queueRequest=function(l,d){this.queue.push(l),this.processRequests(d)};var Pi,rr,Me=function(l){function d(){l.call(this,"map.load"),this.success={},this.skuToken=""}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(v,P,O,j){this.skuToken=O;var $=!(!j&&!Pt.ACCESS_TOKEN),K=Array.isArray(v)&&v.some(function(le){return fr(le)||qr(le)});Pt.EVENTS_URL&&$&&K&&this.queueRequest({id:P,timestamp:Date.now()},j)},d.prototype.processRequests=function(v){var P=this;if(!this.pendingRequest&&this.queue.length!==0){var O=this.queue.shift(),j=O.id,$=O.timestamp;j&&this.success[j]||(this.anonId||this.fetchEventData(),rt(this.anonId)||(this.anonId=Ne()),this.postEvent($,{skuToken:this.skuToken},function(K){K||j&&(P.success[j]=!0)},v))}},d}(zi),qe=new(function(l){function d(v){l.call(this,"appUserTurnstile"),this._customAccessToken=v}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(v,P){Pt.EVENTS_URL&&Pt.ACCESS_TOKEN&&Array.isArray(v)&&v.some(function(O){return fr(O)||qr(O)})&&this.queueRequest(Date.now(),P)},d.prototype.processRequests=function(v){var P=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var O=_i(Pt.ACCESS_TOKEN),j=O?O.u:Pt.ACCESS_TOKEN,$=j!==this.eventData.tokenU;rt(this.anonId)||(this.anonId=Ne(),$=!0);var K=this.queue.shift();if(this.eventData.lastSuccess){var le=new Date(this.eventData.lastSuccess),me=new Date(K),be=(K-this.eventData.lastSuccess)/864e5;$=$||be>=1||be<-1||le.getDate()!==me.getDate()}else $=!0;if(!$)return this.processRequests();this.postEvent(K,{"enabled.telemetry":!1},function(Ie){Ie||(P.eventData.lastSuccess=K,P.eventData.tokenU=j)},v)}},d}(zi)),at=qe.postTurnstileEvent.bind(qe),$t=new Me,cr=$t.postMapLoadEvent.bind($t),br=500,en=50;function ur(){X.caches&&!Pi&&(Pi=X.caches.open("mapbox-tiles"))}function Kr(l){var d=l.indexOf("?");return d<0?l:l.slice(0,d)}var Vr,cn=1/0;function Xn(){return Vr==null&&(Vr=X.OffscreenCanvas&&new X.OffscreenCanvas(1,1).getContext("2d")&&typeof X.createImageBitmap=="function"),Vr}var Mr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Mr);var Fr=function(l){function d(v,P,O){P===401&&qr(O)&&(v+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),l.call(this,v),this.status=P,this.url=O,this.name=this.constructor.name,this.message=v}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),ri=Xt()?function(){return self.worker&&self.worker.referrer}:function(){return(X.location.protocol==="blob:"?X.parent:X).location.href},mi,gi,Xi=function(l,d){if(!(/^file:/.test(v=l.url)||/^file:/.test(ri())&&!/^\w+:/.test(v))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return function(P,O){var j,$=new X.AbortController,K=new X.Request(P.url,{method:P.method||"GET",body:P.body,credentials:P.credentials,headers:P.headers,referrer:ri(),signal:$.signal}),le=!1,me=!1,be=(j=K.url).indexOf("sku=")>0&&qr(j);P.type==="json"&&K.headers.set("Accept","application/json");var Ie=function(Ye,ct,dt){if(!me){if(Ye&&Ye.message!=="SecurityError"&&Ar(Ye),ct&&dt)return je(ct);var kt=Date.now();X.fetch(K).then(function(St){if(St.ok){var Gt=be?St.clone():null;return je(St,Gt,kt)}return O(new Fr(St.statusText,St.status,P.url))}).catch(function(St){St.code!==20&&O(new Error(St.message))})}},je=function(Ye,ct,dt){(P.type==="arrayBuffer"?Ye.arrayBuffer():P.type==="json"?Ye.json():Ye.text()).then(function(kt){me||(ct&&dt&&function(St,Gt,or){if(ur(),Pi){var gr={status:Gt.status,statusText:Gt.statusText,headers:new X.Headers};Gt.headers.forEach(function(zr,Qr){return gr.headers.set(Qr,zr)});var yr=Ht(Gt.headers.get("Cache-Control")||"");yr["no-store"]||(yr["max-age"]&&gr.headers.set("Expires",new Date(or+1e3*yr["max-age"]).toUTCString()),new Date(gr.headers.get("Expires")).getTime()-or<42e4||function(zr,Qr){if(rr===void 0)try{new Response(new ReadableStream),rr=!0}catch{rr=!1}rr?Qr(zr.body):zr.blob().then(Qr)}(Gt,function(zr){var Qr=new X.Response(zr,gr);ur(),Pi&&Pi.then(function(nn){return nn.put(Kr(St.url),Qr)}).catch(function(nn){return Ar(nn.message)})}))}}(K,ct,dt),le=!0,O(null,kt,Ye.headers.get("Cache-Control"),Ye.headers.get("Expires")))}).catch(function(kt){me||O(new Error(kt.message))})};return be?function(Ye,ct){if(ur(),!Pi)return ct(null);var dt=Kr(Ye.url);Pi.then(function(kt){kt.match(dt).then(function(St){var Gt=function(or){if(!or)return!1;var gr=new Date(or.headers.get("Expires")||0),yr=Ht(or.headers.get("Cache-Control")||"");return gr>Date.now()&&!yr["no-cache"]}(St);kt.delete(dt),Gt&&kt.put(dt,St.clone()),ct(null,St,Gt)}).catch(ct)}).catch(ct)}(K,Ie):Ie(null,null),{cancel:function(){me=!0,le||$.abort()}}}(l,d);if(Xt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,d,void 0,!0)}var v;return function(P,O){var j=new X.XMLHttpRequest;for(var $ in j.open(P.method||"GET",P.url,!0),P.type==="arrayBuffer"&&(j.responseType="arraybuffer"),P.headers)j.setRequestHeader($,P.headers[$]);return P.type==="json"&&(j.responseType="text",j.setRequestHeader("Accept","application/json")),j.withCredentials=P.credentials==="include",j.onerror=function(){O(new Error(j.statusText))},j.onload=function(){if((j.status>=200&&j.status<300||j.status===0)&&j.response!==null){var K=j.response;if(P.type==="json")try{K=JSON.parse(j.response)}catch(le){return O(le)}O(null,K,j.getResponseHeader("Cache-Control"),j.getResponseHeader("Expires"))}else O(new Fr(j.statusText,j.status,P.url))},j.send(P.body),{cancel:function(){return j.abort()}}}(l,d)},mo=function(l,d){return Xi(ce(l,{type:"arrayBuffer"}),d)},eo=function(l,d){return Xi(ce(l,{method:"POST"}),d)},Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";mi=[],gi=0;var Re=function(l,d){if(Dt.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),gi>=Pt.MAX_PARALLEL_IMAGE_REQUESTS){var v={requestParameters:l,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return mi.push(v),v}gi++;var P=!1,O=function(){if(!P)for(P=!0,gi--;mi.length&&gi<Pt.MAX_PARALLEL_IMAGE_REQUESTS;){var $=mi.shift();$.cancelled||($.cancel=Re($.requestParameters,$.callback).cancel)}},j=mo(l,function($,K,le,me){O(),$?d($):K&&(Xn()?function(be,Ie){var je=new X.Blob([new Uint8Array(be)],{type:"image/png"});X.createImageBitmap(je).then(function(Ye){Ie(null,Ye)}).catch(function(Ye){Ie(new Error("Could not load image because of "+Ye.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(K,d):function(be,Ie,je,Ye){var ct=new X.Image,dt=X.URL;ct.onload=function(){Ie(null,ct),dt.revokeObjectURL(ct.src),ct.onload=null,X.requestAnimationFrame(function(){ct.src=Se})},ct.onerror=function(){return Ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var kt=new X.Blob([new Uint8Array(be)],{type:"image/png"});ct.cacheControl=je,ct.expires=Ye,ct.src=be.byteLength?dt.createObjectURL(kt):Se}(K,d,le,me))});return{cancel:function(){j.cancel(),O()}}};function Fe(l,d,v){v[l]&&v[l].indexOf(d)!==-1||(v[l]=v[l]||[],v[l].push(d))}function et(l,d,v){if(v&&v[l]){var P=v[l].indexOf(d);P!==-1&&v[l].splice(P,1)}}var it=function(l,d){d===void 0&&(d={}),ce(this,d),this.type=l},wt=function(l){function d(v,P){P===void 0&&(P={}),l.call(this,"error",ce({error:v},P))}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(it),$e=function(){};$e.prototype.on=function(l,d){return this._listeners=this._listeners||{},Fe(l,d,this._listeners),this},$e.prototype.off=function(l,d){return et(l,d,this._listeners),et(l,d,this._oneTimeListeners),this},$e.prototype.once=function(l,d){return this._oneTimeListeners=this._oneTimeListeners||{},Fe(l,d,this._oneTimeListeners),this},$e.prototype.fire=function(l,d){typeof l=="string"&&(l=new it(l,d||{}));var v=l.type;if(this.listens(v)){l.target=this;for(var P=0,O=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];P<O.length;P+=1)O[P].call(this,l);for(var j=0,$=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];j<$.length;j+=1){var K=$[j];et(v,K,this._oneTimeListeners),K.call(this,l)}var le=this._eventedParent;le&&(ce(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),le.fire(l))}else l instanceof wt&&console.error(l.error);return this},$e.prototype.listens=function(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)},$e.prototype.setEventedParent=function(l,d){return this._eventedParent=l,this._eventedParentData=d,this};var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Le=function(l,d,v,P){this.message=(l?l+": ":"")+v,P&&(this.identifier=P),d!=null&&d.__line__&&(this.line=d.__line__)};function ot(l){var d=l.value;return d?[new Le(l.key,d,"constants have been deprecated as of v8")]:[]}function Mt(l){for(var d=[],v=arguments.length-1;v-- >0;)d[v]=arguments[v+1];for(var P=0,O=d;P<O.length;P+=1){var j=O[P];for(var $ in j)l[$]=j[$]}return l}function Ot(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function bt(l){if(Array.isArray(l))return l.map(bt);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){var d={};for(var v in l)d[v]=bt(l[v]);return d}return Ot(l)}var Rt=function(l){function d(v,P){l.call(this,P),this.message=P,this.key=v}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(Error),ar=function(l,d){d===void 0&&(d=[]),this.parent=l,this.bindings={};for(var v=0,P=d;v<P.length;v+=1){var O=P[v];this.bindings[O[0]]=O[1]}};ar.prototype.concat=function(l){return new ar(this,l)},ar.prototype.get=function(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(l+" not found in scope.")},ar.prototype.has=function(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)};var qt={kind:"null"},Nt={kind:"number"},Rr={kind:"string"},er={kind:"boolean"},Nr={kind:"color"},Ln={kind:"object"},$r={kind:"value"},si={kind:"collator"},Yi={kind:"formatted"},xn={kind:"resolvedImage"};function $i(l,d){return{kind:"array",itemType:l,N:d}}function di(l){if(l.kind==="array"){var d=di(l.itemType);return typeof l.N=="number"?"array<"+d+", "+l.N+">":l.itemType.kind==="value"?"array":"array<"+d+">"}return l.kind}var vo=[qt,Nt,Rr,er,Nr,Yi,Ln,$i($r),xn];function to(l,d){if(d.kind==="error")return null;if(l.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!to(l.itemType,d.itemType))&&(typeof l.N!="number"||l.N===d.N))return null}else{if(l.kind===d.kind)return null;if(l.kind==="value"){for(var v=0,P=vo;v<P.length;v+=1)if(!to(P[v],d))return null}}return"Expected "+di(l)+" but found "+di(d)+" instead."}function xo(l,d){return d.some(function(v){return v.kind===l.kind})}function so(l,d){return d.some(function(v){return v==="null"?l===null:v==="array"?Array.isArray(l):v==="object"?l&&!Array.isArray(l)&&typeof l=="object":v===typeof l})}var Ni=s(function(l,d){var v={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function P(K){return(K=Math.round(K))<0?0:K>255?255:K}function O(K){return P(K[K.length-1]==="%"?parseFloat(K)/100*255:parseInt(K))}function j(K){return(le=K[K.length-1]==="%"?parseFloat(K)/100:parseFloat(K))<0?0:le>1?1:le;var le}function $(K,le,me){return me<0?me+=1:me>1&&(me-=1),6*me<1?K+(le-K)*me*6:2*me<1?le:3*me<2?K+(le-K)*(2/3-me)*6:K}try{d.parseCSSColor=function(K){var le,me=K.replace(/ /g,"").toLowerCase();if(me in v)return v[me].slice();if(me[0]==="#")return me.length===4?(le=parseInt(me.substr(1),16))>=0&&le<=4095?[(3840&le)>>4|(3840&le)>>8,240&le|(240&le)>>4,15&le|(15&le)<<4,1]:null:me.length===7&&(le=parseInt(me.substr(1),16))>=0&&le<=16777215?[(16711680&le)>>16,(65280&le)>>8,255&le,1]:null;var be=me.indexOf("("),Ie=me.indexOf(")");if(be!==-1&&Ie+1===me.length){var je=me.substr(0,be),Ye=me.substr(be+1,Ie-(be+1)).split(","),ct=1;switch(je){case"rgba":if(Ye.length!==4)return null;ct=j(Ye.pop());case"rgb":return Ye.length!==3?null:[O(Ye[0]),O(Ye[1]),O(Ye[2]),ct];case"hsla":if(Ye.length!==4)return null;ct=j(Ye.pop());case"hsl":if(Ye.length!==3)return null;var dt=(parseFloat(Ye[0])%360+360)%360/360,kt=j(Ye[1]),St=j(Ye[2]),Gt=St<=.5?St*(kt+1):St+kt-St*kt,or=2*St-Gt;return[P(255*$(or,Gt,dt+1/3)),P(255*$(or,Gt,dt)),P(255*$(or,Gt,dt-1/3)),ct];default:return null}}return null}}catch{}}).parseCSSColor,qi=function(l,d,v,P){P===void 0&&(P=1),this.r=l,this.g=d,this.b=v,this.a=P};qi.parse=function(l){if(l){if(l instanceof qi)return l;if(typeof l=="string"){var d=Ni(l);if(d)return new qi(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},qi.prototype.toString=function(){var l=this.toArray(),d=l[1],v=l[2],P=l[3];return"rgba("+Math.round(l[0])+","+Math.round(d)+","+Math.round(v)+","+P+")"},qi.prototype.toArray=function(){var l=this.a;return l===0?[0,0,0,0]:[255*this.r/l,255*this.g/l,255*this.b/l,l]},qi.black=new qi(0,0,0,1),qi.white=new qi(1,1,1,1),qi.transparent=new qi(0,0,0,0),qi.red=new qi(1,0,0,1);var rs=function(l,d,v){this.sensitivity=l?d?"variant":"case":d?"accent":"base",this.locale=v,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};rs.prototype.compare=function(l,d){return this.collator.compare(l,d)},rs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var kl=function(l,d,v,P,O){this.text=l,this.image=d,this.scale=v,this.fontStack=P,this.textColor=O},ga=function(l){this.sections=l};ga.fromString=function(l){return new ga([new kl(l,null,null,null,null)])},ga.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(l){return l.text.length!==0||l.image&&l.image.name.length!==0})},ga.factory=function(l){return l instanceof ga?l:ga.fromString(l)},ga.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(l){return l.text}).join("")},ga.prototype.serialize=function(){for(var l=["format"],d=0,v=this.sections;d<v.length;d+=1){var P=v[d];if(P.image)l.push(["image",P.image.name]);else{l.push(P.text);var O={};P.fontStack&&(O["text-font"]=["literal",P.fontStack.split(",")]),P.scale&&(O["font-scale"]=P.scale),P.textColor&&(O["text-color"]=["rgba"].concat(P.textColor.toArray())),l.push(O)}}return l};var Ho=function(l){this.name=l.name,this.available=l.available};function Oc(l,d,v,P){return typeof l=="number"&&l>=0&&l<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof v=="number"&&v>=0&&v<=255?P===void 0||typeof P=="number"&&P>=0&&P<=1?null:"Invalid rgba value ["+[l,d,v,P].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof P=="number"?[l,d,v,P]:[l,d,v]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Wl(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof qi||l instanceof rs||l instanceof ga||l instanceof Ho)return!0;if(Array.isArray(l)){for(var d=0,v=l;d<v.length;d+=1)if(!Wl(v[d]))return!1;return!0}if(typeof l=="object"){for(var P in l)if(!Wl(l[P]))return!1;return!0}return!1}function Qo(l){if(l===null)return qt;if(typeof l=="string")return Rr;if(typeof l=="boolean")return er;if(typeof l=="number")return Nt;if(l instanceof qi)return Nr;if(l instanceof rs)return si;if(l instanceof ga)return Yi;if(l instanceof Ho)return xn;if(Array.isArray(l)){for(var d,v=l.length,P=0,O=l;P<O.length;P+=1){var j=Qo(O[P]);if(d){if(d===j)continue;d=$r;break}d=j}return $i(d||$r,v)}return Ln}function Va(l){var d=typeof l;return l===null?"":d==="string"||d==="number"||d==="boolean"?String(l):l instanceof qi||l instanceof ga||l instanceof Ho?l.toString():JSON.stringify(l)}Ho.prototype.toString=function(){return this.name},Ho.fromString=function(l){return l?new Ho({name:l,available:!1}):null},Ho.prototype.serialize=function(){return["image",this.name]};var po=function(l,d){this.type=l,this.value=d};po.parse=function(l,d){if(l.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(l.length-1)+" instead.");if(!Wl(l[1]))return d.error("invalid value");var v=l[1],P=Qo(v),O=d.expectedType;return P.kind!=="array"||P.N!==0||!O||O.kind!=="array"||typeof O.N=="number"&&O.N!==0||(P=O),new po(P,v)},po.prototype.evaluate=function(){return this.value},po.prototype.eachChild=function(){},po.prototype.outputDefined=function(){return!0},po.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof qi?["rgba"].concat(this.value.toArray()):this.value instanceof ga?this.value.serialize():this.value};var Hn=function(l){this.name="ExpressionEvaluationError",this.message=l};Hn.prototype.toJSON=function(){return this.message};var Ra={string:Rr,number:Nt,boolean:er,object:Ln},Uo=function(l,d){this.type=l,this.args=d};Uo.parse=function(l,d){if(l.length<2)return d.error("Expected at least one argument.");var v,P=1,O=l[0];if(O==="array"){var j,$;if(l.length>2){var K=l[1];if(typeof K!="string"||!(K in Ra)||K==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);j=Ra[K],P++}else j=$r;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return d.error('The length argument to "array" must be a positive integer literal',2);$=l[2],P++}v=$i(j,$)}else v=Ra[O];for(var le=[];P<l.length;P++){var me=d.parse(l[P],P,$r);if(!me)return null;le.push(me)}return new Uo(v,le)},Uo.prototype.evaluate=function(l){for(var d=0;d<this.args.length;d++){var v=this.args[d].evaluate(l);if(!to(this.type,Qo(v)))return v;if(d===this.args.length-1)throw new Hn("Expected value to be of type "+di(this.type)+", but found "+di(Qo(v))+" instead.")}return null},Uo.prototype.eachChild=function(l){this.args.forEach(l)},Uo.prototype.outputDefined=function(){return this.args.every(function(l){return l.outputDefined()})},Uo.prototype.serialize=function(){var l=this.type,d=[l.kind];if(l.kind==="array"){var v=l.itemType;if(v.kind==="string"||v.kind==="number"||v.kind==="boolean"){d.push(v.kind);var P=l.N;(typeof P=="number"||this.args.length>1)&&d.push(P)}}return d.concat(this.args.map(function(O){return O.serialize()}))};var Gs=function(l){this.type=Yi,this.sections=l};Gs.parse=function(l,d){if(l.length<2)return d.error("Expected at least one argument.");var v=l[1];if(!Array.isArray(v)&&typeof v=="object")return d.error("First argument must be an image or text section.");for(var P=[],O=!1,j=1;j<=l.length-1;++j){var $=l[j];if(O&&typeof $=="object"&&!Array.isArray($)){O=!1;var K=null;if($["font-scale"]&&!(K=d.parse($["font-scale"],1,Nt)))return null;var le=null;if($["text-font"]&&!(le=d.parse($["text-font"],1,$i(Rr))))return null;var me=null;if($["text-color"]&&!(me=d.parse($["text-color"],1,Nr)))return null;var be=P[P.length-1];be.scale=K,be.font=le,be.textColor=me}else{var Ie=d.parse(l[j],1,$r);if(!Ie)return null;var je=Ie.type.kind;if(je!=="string"&&je!=="value"&&je!=="null"&&je!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");O=!0,P.push({content:Ie,scale:null,font:null,textColor:null})}}return new Gs(P)},Gs.prototype.evaluate=function(l){return new ga(this.sections.map(function(d){var v=d.content.evaluate(l);return Qo(v)===xn?new kl("",v,null,null,null):new kl(Va(v),null,d.scale?d.scale.evaluate(l):null,d.font?d.font.evaluate(l).join(","):null,d.textColor?d.textColor.evaluate(l):null)}))},Gs.prototype.eachChild=function(l){for(var d=0,v=this.sections;d<v.length;d+=1){var P=v[d];l(P.content),P.scale&&l(P.scale),P.font&&l(P.font),P.textColor&&l(P.textColor)}},Gs.prototype.outputDefined=function(){return!1},Gs.prototype.serialize=function(){for(var l=["format"],d=0,v=this.sections;d<v.length;d+=1){var P=v[d];l.push(P.content.serialize());var O={};P.scale&&(O["font-scale"]=P.scale.serialize()),P.font&&(O["text-font"]=P.font.serialize()),P.textColor&&(O["text-color"]=P.textColor.serialize()),l.push(O)}return l};var Os=function(l){this.type=xn,this.input=l};Os.parse=function(l,d){if(l.length!==2)return d.error("Expected two arguments.");var v=d.parse(l[1],1,Rr);return v?new Os(v):d.error("No image name provided.")},Os.prototype.evaluate=function(l){var d=this.input.evaluate(l),v=Ho.fromString(d);return v&&l.availableImages&&(v.available=l.availableImages.indexOf(d)>-1),v},Os.prototype.eachChild=function(l){l(this.input)},Os.prototype.outputDefined=function(){return!1},Os.prototype.serialize=function(){return["image",this.input.serialize()]};var _l={"to-boolean":er,"to-color":Nr,"to-number":Nt,"to-string":Rr},qs=function(l,d){this.type=l,this.args=d};qs.parse=function(l,d){if(l.length<2)return d.error("Expected at least one argument.");var v=l[0];if((v==="to-boolean"||v==="to-string")&&l.length!==2)return d.error("Expected one argument.");for(var P=_l[v],O=[],j=1;j<l.length;j++){var $=d.parse(l[j],j,$r);if(!$)return null;O.push($)}return new qs(P,O)},qs.prototype.evaluate=function(l){if(this.type.kind==="boolean")return!!this.args[0].evaluate(l);if(this.type.kind==="color"){for(var d,v,P=0,O=this.args;P<O.length;P+=1){if(v=null,(d=O[P].evaluate(l))instanceof qi)return d;if(typeof d=="string"){var j=l.parseColor(d);if(j)return j}else if(Array.isArray(d)&&!(v=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":Oc(d[0],d[1],d[2],d[3])))return new qi(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Hn(v||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var $=null,K=0,le=this.args;K<le.length;K+=1){if(($=le[K].evaluate(l))===null)return 0;var me=Number($);if(!isNaN(me))return me}throw new Hn("Could not convert "+JSON.stringify($)+" to number.")}return this.type.kind==="formatted"?ga.fromString(Va(this.args[0].evaluate(l))):this.type.kind==="resolvedImage"?Ho.fromString(Va(this.args[0].evaluate(l))):Va(this.args[0].evaluate(l))},qs.prototype.eachChild=function(l){this.args.forEach(l)},qs.prototype.outputDefined=function(){return this.args.every(function(l){return l.outputDefined()})},qs.prototype.serialize=function(){if(this.type.kind==="formatted")return new Gs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Os(this.args[0]).serialize();var l=["to-"+this.type.kind];return this.eachChild(function(d){l.push(d.serialize())}),l};var zf=["Unknown","Point","LineString","Polygon"],He=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};He.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},He.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?zf[this.feature.type]:this.feature.type:null},He.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},He.prototype.canonicalID=function(){return this.canonical},He.prototype.properties=function(){return this.feature&&this.feature.properties||{}},He.prototype.parseColor=function(l){var d=this._parseColorCache[l];return d||(d=this._parseColorCache[l]=qi.parse(l)),d};var Oe=function(l,d,v,P){this.name=l,this.type=d,this._evaluate=v,this.args=P};Oe.prototype.evaluate=function(l){return this._evaluate(l,this.args)},Oe.prototype.eachChild=function(l){this.args.forEach(l)},Oe.prototype.outputDefined=function(){return!1},Oe.prototype.serialize=function(){return[this.name].concat(this.args.map(function(l){return l.serialize()}))},Oe.parse=function(l,d){var v,P=l[0],O=Oe.definitions[P];if(!O)return d.error('Unknown expression "'+P+'". If you wanted a literal array, use ["literal", [...]].',0);for(var j=Array.isArray(O)?O[0]:O.type,$=Array.isArray(O)?[[O[1],O[2]]]:O.overloads,K=$.filter(function(li){var En=li[0];return!Array.isArray(En)||En.length===l.length-1}),le=null,me=0,be=K;me<be.length;me+=1){var Ie=be[me],je=Ie[0],Ye=Ie[1];le=new ms(d.registry,d.path,null,d.scope);for(var ct=[],dt=!1,kt=1;kt<l.length;kt++){var St=l[kt],Gt=Array.isArray(je)?je[kt-1]:je.type,or=le.parse(St,1+ct.length,Gt);if(!or){dt=!0;break}ct.push(or)}if(!dt)if(Array.isArray(je)&&je.length!==ct.length)le.error("Expected "+je.length+" arguments, but found "+ct.length+" instead.");else{for(var gr=0;gr<ct.length;gr++){var yr=Array.isArray(je)?je[gr]:je.type,zr=ct[gr];le.concat(gr+1).checkSubtype(yr,zr.type)}if(le.errors.length===0)return new Oe(P,j,Ye,ct)}}if(K.length===1)(v=d.errors).push.apply(v,le.errors);else{for(var Qr=(K.length?K:$).map(function(li){var En;return En=li[0],Array.isArray(En)?"("+En.map(di).join(", ")+")":"("+di(En.type)+"...)"}).join(" | "),nn=[],Zn=1;Zn<l.length;Zn++){var Tn=d.parse(l[Zn],1+nn.length);if(!Tn)return null;nn.push(di(Tn.type))}d.error("Expected arguments of type "+Qr+", but found ("+nn.join(", ")+") instead.")}return null},Oe.register=function(l,d){for(var v in Oe.definitions=d,d)l[v]=Oe};var ft=function(l,d,v){this.type=si,this.locale=v,this.caseSensitive=l,this.diacriticSensitive=d};function Vt(l,d){l[0]=Math.min(l[0],d[0]),l[1]=Math.min(l[1],d[1]),l[2]=Math.max(l[2],d[0]),l[3]=Math.max(l[3],d[1])}function Xr(l,d){return!(l[0]<=d[0]||l[2]>=d[2]||l[1]<=d[1]||l[3]>=d[3])}function Gn(l,d){var v=(180+l[0])/360,P=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,O=Math.pow(2,d.z);return[Math.round(v*O*8192),Math.round(P*O*8192)]}function kn(l,d,v){return d[1]>l[1]!=v[1]>l[1]&&l[0]<(v[0]-d[0])*(l[1]-d[1])/(v[1]-d[1])+d[0]}function _a(l,d){for(var v,P,O,j,$,K,le,me=!1,be=0,Ie=d.length;be<Ie;be++)for(var je=d[be],Ye=0,ct=je.length;Ye<ct-1;Ye++){if((j=(v=l)[0]-(P=je[Ye])[0])*(le=v[1]-(O=je[Ye+1])[1])-(K=v[0]-O[0])*($=v[1]-P[1])==0&&j*K<=0&&$*le<=0)return!1;kn(l,je[Ye],je[Ye+1])&&(me=!me)}return me}function Ca(l,d){for(var v=0;v<d.length;v++)if(_a(l,d[v]))return!0;return!1}function Ua(l,d,v,P){var O=P[0]-v[0],j=P[1]-v[1],$=(l[0]-v[0])*j-O*(l[1]-v[1]),K=(d[0]-v[0])*j-O*(d[1]-v[1]);return $>0&&K<0||$<0&&K>0}function ya(l,d,v){for(var P=0,O=v;P<O.length;P+=1)for(var j=O[P],$=0;$<j.length-1;++$)if((Ie=[(be=j[$+1])[0]-(me=j[$])[0],be[1]-me[1]])[0]*(je=[(le=d)[0]-(K=l)[0],le[1]-K[1]])[1]-Ie[1]*je[0]!=0&&Ua(K,le,me,be)&&Ua(me,be,K,le))return!0;var K,le,me,be,Ie,je;return!1}function va(l,d){for(var v=0;v<l.length;++v)if(!_a(l[v],d))return!1;for(var P=0;P<l.length-1;++P)if(ya(l[P],l[P+1],d))return!1;return!0}function Un(l,d){for(var v=0;v<d.length;v++)if(va(l,d[v]))return!0;return!1}function Hl(l,d,v){for(var P=[],O=0;O<l.length;O++){for(var j=[],$=0;$<l[O].length;$++){var K=Gn(l[O][$],v);Vt(d,K),j.push(K)}P.push(j)}return P}function ui(l,d,v){for(var P=[],O=0;O<l.length;O++){var j=Hl(l[O],d,v);P.push(j)}return P}function Zl(l,d,v,P){if(l[0]<v[0]||l[0]>v[2]){var O=.5*P,j=l[0]-v[0]>O?-P:v[0]-l[0]>O?P:0;j===0&&(j=l[0]-v[2]>O?-P:v[2]-l[0]>O?P:0),l[0]+=j}Vt(d,l)}function Fi(l,d,v,P){for(var O=8192*Math.pow(2,P.z),j=[8192*P.x,8192*P.y],$=[],K=0,le=l;K<le.length;K+=1)for(var me=0,be=le[K];me<be.length;me+=1){var Ie=be[me],je=[Ie.x+j[0],Ie.y+j[1]];Zl(je,d,v,O),$.push(je)}return $}function tu(l,d,v,P){for(var O,j=8192*Math.pow(2,P.z),$=[8192*P.x,8192*P.y],K=[],le=0,me=l;le<me.length;le+=1){for(var be=[],Ie=0,je=me[le];Ie<je.length;Ie+=1){var Ye=je[Ie],ct=[Ye.x+$[0],Ye.y+$[1]];Vt(d,ct),be.push(ct)}K.push(be)}if(d[2]-d[0]<=j/2){(O=d)[0]=O[1]=1/0,O[2]=O[3]=-1/0;for(var dt=0,kt=K;dt<kt.length;dt+=1)for(var St=0,Gt=kt[dt];St<Gt.length;St+=1)Zl(Gt[St],d,v,j)}return K}ft.parse=function(l,d){if(l.length!==2)return d.error("Expected one argument.");var v=l[1];if(typeof v!="object"||Array.isArray(v))return d.error("Collator options argument must be an object.");var P=d.parse(v["case-sensitive"]!==void 0&&v["case-sensitive"],1,er);if(!P)return null;var O=d.parse(v["diacritic-sensitive"]!==void 0&&v["diacritic-sensitive"],1,er);if(!O)return null;var j=null;return v.locale&&!(j=d.parse(v.locale,1,Rr))?null:new ft(P,O,j)},ft.prototype.evaluate=function(l){return new rs(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)},ft.prototype.eachChild=function(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)},ft.prototype.outputDefined=function(){return!1},ft.prototype.serialize=function(){var l={};return l["case-sensitive"]=this.caseSensitive.serialize(),l["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(l.locale=this.locale.serialize()),["collator",l]};var ea=function(l,d){this.type=er,this.geojson=l,this.geometries=d};function Dn(l){if(l instanceof Oe&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof ea)return!1;var d=!0;return l.eachChild(function(v){d&&!Dn(v)&&(d=!1)}),d}function ru(l){if(l instanceof Oe&&l.name==="feature-state")return!1;var d=!0;return l.eachChild(function(v){d&&!ru(v)&&(d=!1)}),d}function Rl(l,d){if(l instanceof Oe&&d.indexOf(l.name)>=0)return!1;var v=!0;return l.eachChild(function(P){v&&!Rl(P,d)&&(v=!1)}),v}ea.parse=function(l,d){if(l.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(l.length-1)+" instead.");if(Wl(l[1])){var v=l[1];if(v.type==="FeatureCollection")for(var P=0;P<v.features.length;++P){var O=v.features[P].geometry.type;if(O==="Polygon"||O==="MultiPolygon")return new ea(v,v.features[P].geometry)}else if(v.type==="Feature"){var j=v.geometry.type;if(j==="Polygon"||j==="MultiPolygon")return new ea(v,v.geometry)}else if(v.type==="Polygon"||v.type==="MultiPolygon")return new ea(v,v)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ea.prototype.evaluate=function(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(d,v){var P=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],j=d.canonicalID();if(v.type==="Polygon"){var $=Hl(v.coordinates,O,j),K=Fi(d.geometry(),P,O,j);if(!Xr(P,O))return!1;for(var le=0,me=K;le<me.length;le+=1)if(!_a(me[le],$))return!1}if(v.type==="MultiPolygon"){var be=ui(v.coordinates,O,j),Ie=Fi(d.geometry(),P,O,j);if(!Xr(P,O))return!1;for(var je=0,Ye=Ie;je<Ye.length;je+=1)if(!Ca(Ye[je],be))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(d,v){var P=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],j=d.canonicalID();if(v.type==="Polygon"){var $=Hl(v.coordinates,O,j),K=tu(d.geometry(),P,O,j);if(!Xr(P,O))return!1;for(var le=0,me=K;le<me.length;le+=1)if(!va(me[le],$))return!1}if(v.type==="MultiPolygon"){var be=ui(v.coordinates,O,j),Ie=tu(d.geometry(),P,O,j);if(!Xr(P,O))return!1;for(var je=0,Ye=Ie;je<Ye.length;je+=1)if(!Un(Ye[je],be))return!1}return!0}(l,this.geometries)}return!1},ea.prototype.eachChild=function(){},ea.prototype.outputDefined=function(){return!0},ea.prototype.serialize=function(){return["within",this.geojson]};var ta=function(l,d){this.type=d.type,this.name=l,this.boundExpression=d};ta.parse=function(l,d){if(l.length!==2||typeof l[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var v=l[1];return d.scope.has(v)?new ta(v,d.scope.get(v)):d.error('Unknown variable "'+v+'". Make sure "'+v+'" has been bound in an enclosing "let" expression before using it.',1)},ta.prototype.evaluate=function(l){return this.boundExpression.evaluate(l)},ta.prototype.eachChild=function(){},ta.prototype.outputDefined=function(){return!1},ta.prototype.serialize=function(){return["var",this.name]};var ms=function(l,d,v,P,O){d===void 0&&(d=[]),P===void 0&&(P=new ar),O===void 0&&(O=[]),this.registry=l,this.path=d,this.key=d.map(function(j){return"["+j+"]"}).join(""),this.scope=P,this.errors=O,this.expectedType=v};function hc(l,d){for(var v,P=l.length-1,O=0,j=P,$=0;O<=j;)if((v=l[$=Math.floor((O+j)/2)])<=d){if($===P||d<l[$+1])return $;O=$+1}else{if(!(v>d))throw new Hn("Input is not a number.");j=$-1}return 0}ms.prototype.parse=function(l,d,v,P,O){return O===void 0&&(O={}),d?this.concat(d,v,P)._parse(l,O):this._parse(l,O)},ms.prototype._parse=function(l,d){function v(me,be,Ie){return Ie==="assert"?new Uo(be,[me]):Ie==="coerce"?new qs(be,[me]):me}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var P=l[0];if(typeof P!="string")return this.error("Expression name must be a string, but found "+typeof P+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var O=this.registry[P];if(O){var j=O.parse(l,this);if(!j)return null;if(this.expectedType){var $=this.expectedType,K=j.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||K.kind!=="value")if($.kind!=="color"&&$.kind!=="formatted"&&$.kind!=="resolvedImage"||K.kind!=="value"&&K.kind!=="string"){if(this.checkSubtype($,K))return null}else j=v(j,$,d.typeAnnotation||"coerce");else j=v(j,$,d.typeAnnotation||"assert")}if(!(j instanceof po)&&j.type.kind!=="resolvedImage"&&function me(be){if(be instanceof ta)return me(be.boundExpression);if(be instanceof Oe&&be.name==="error"||be instanceof ft||be instanceof ea)return!1;var Ie=be instanceof qs||be instanceof Uo,je=!0;return be.eachChild(function(Ye){je=Ie?je&&me(Ye):je&&Ye instanceof po}),!!je&&Dn(be)&&Rl(be,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(j)){var le=new He;try{j=new po(j.type,j.evaluate(le))}catch(me){return this.error(me.message),null}}return j}return this.error('Unknown expression "'+P+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof l+" instead.")},ms.prototype.concat=function(l,d,v){var P=typeof l=="number"?this.path.concat(l):this.path,O=v?this.scope.concat(v):this.scope;return new ms(this.registry,P,d||null,O,this.errors)},ms.prototype.error=function(l){for(var d=[],v=arguments.length-1;v-- >0;)d[v]=arguments[v+1];var P=""+this.key+d.map(function(O){return"["+O+"]"}).join("");this.errors.push(new Rt(P,l))},ms.prototype.checkSubtype=function(l,d){var v=to(l,d);return v&&this.error(v),v};var $a=function(l,d,v){this.type=l,this.input=d,this.labels=[],this.outputs=[];for(var P=0,O=v;P<O.length;P+=1){var j=O[P],$=j[1];this.labels.push(j[0]),this.outputs.push($)}};function lo(l,d,v){return l*(1-v)+d*v}$a.parse=function(l,d){if(l.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(l.length-1)+".");if((l.length-1)%2!=0)return d.error("Expected an even number of arguments.");var v=d.parse(l[1],1,Nt);if(!v)return null;var P=[],O=null;d.expectedType&&d.expectedType.kind!=="value"&&(O=d.expectedType);for(var j=1;j<l.length;j+=2){var $=j===1?-1/0:l[j],K=l[j+1],le=j,me=j+1;if(typeof $!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',le);if(P.length&&P[P.length-1][0]>=$)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',le);var be=d.parse(K,me,O);if(!be)return null;O=O||be.type,P.push([$,be])}return new $a(O,v,P)},$a.prototype.evaluate=function(l){var d=this.labels,v=this.outputs;if(d.length===1)return v[0].evaluate(l);var P=this.input.evaluate(l);if(P<=d[0])return v[0].evaluate(l);var O=d.length;return P>=d[O-1]?v[O-1].evaluate(l):v[hc(d,P)].evaluate(l)},$a.prototype.eachChild=function(l){l(this.input);for(var d=0,v=this.outputs;d<v.length;d+=1)l(v[d])},$a.prototype.outputDefined=function(){return this.outputs.every(function(l){return l.outputDefined()})},$a.prototype.serialize=function(){for(var l=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&l.push(this.labels[d]),l.push(this.outputs[d].serialize());return l};var Ru=Object.freeze({__proto__:null,number:lo,color:function(l,d,v){return new qi(lo(l.r,d.r,v),lo(l.g,d.g,v),lo(l.b,d.b,v),lo(l.a,d.a,v))},array:function(l,d,v){return l.map(function(P,O){return lo(P,d[O],v)})}}),Up=6/29*3*(6/29),nu=Math.PI/180,ed=180/Math.PI;function iu(l){return l>.008856451679035631?Math.pow(l,1/3):l/Up+4/29}function Du(l){return l>6/29?l*l*l:Up*(l-4/29)}function Dl(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function td(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Lc(l){var d=td(l.r),v=td(l.g),P=td(l.b),O=iu((.4124564*d+.3575761*v+.1804375*P)/.95047),j=iu((.2126729*d+.7151522*v+.072175*P)/1);return{l:116*j-16,a:500*(O-j),b:200*(j-iu((.0193339*d+.119192*v+.9503041*P)/1.08883)),alpha:l.a}}function rd(l){var d=(l.l+16)/116,v=isNaN(l.a)?d:d+l.a/500,P=isNaN(l.b)?d:d-l.b/200;return d=1*Du(d),v=.95047*Du(v),P=1.08883*Du(P),new qi(Dl(3.2404542*v-1.5371385*d-.4985314*P),Dl(-.969266*v+1.8760108*d+.041556*P),Dl(.0556434*v-.2040259*d+1.0572252*P),l.alpha)}function jm(l,d,v){var P=d-l;return l+v*(P>180||P<-180?P-360*Math.round(P/360):P)}var dc={forward:Lc,reverse:rd,interpolate:function(l,d,v){return{l:lo(l.l,d.l,v),a:lo(l.a,d.a,v),b:lo(l.b,d.b,v),alpha:lo(l.alpha,d.alpha,v)}}},nd={forward:function(l){var d=Lc(l),v=d.l,P=d.a,O=d.b,j=Math.atan2(O,P)*ed;return{h:j<0?j+360:j,c:Math.sqrt(P*P+O*O),l:v,alpha:l.a}},reverse:function(l){var d=l.h*nu,v=l.c;return rd({l:l.l,a:Math.cos(d)*v,b:Math.sin(d)*v,alpha:l.alpha})},interpolate:function(l,d,v){return{h:jm(l.h,d.h,v),c:lo(l.c,d.c,v),l:lo(l.l,d.l,v),alpha:lo(l.alpha,d.alpha,v)}}},Ki=Object.freeze({__proto__:null,lab:dc,hcl:nd}),Ga=function(l,d,v,P,O){this.type=l,this.operator=d,this.interpolation=v,this.input=P,this.labels=[],this.outputs=[];for(var j=0,$=O;j<$.length;j+=1){var K=$[j],le=K[1];this.labels.push(K[0]),this.outputs.push(le)}};function rp(l,d,v,P){var O=P-v,j=l-v;return O===0?0:d===1?j/O:(Math.pow(d,j)-1)/(Math.pow(d,O)-1)}Ga.interpolationFactor=function(l,d,v,P){var O=0;if(l.name==="exponential")O=rp(d,l.base,v,P);else if(l.name==="linear")O=rp(d,1,v,P);else if(l.name==="cubic-bezier"){var j=l.controlPoints;O=new L(j[0],j[1],j[2],j[3]).solve(rp(d,1,v,P))}return O},Ga.parse=function(l,d){var v=l[0],P=l[1],O=l[2],j=l.slice(3);if(!Array.isArray(P)||P.length===0)return d.error("Expected an interpolation type expression.",1);if(P[0]==="linear")P={name:"linear"};else if(P[0]==="exponential"){var $=P[1];if(typeof $!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);P={name:"exponential",base:$}}else{if(P[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(P[0]),1,0);var K=P.slice(1);if(K.length!==4||K.some(function(kt){return typeof kt!="number"||kt<0||kt>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);P={name:"cubic-bezier",controlPoints:K}}if(l.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(l.length-1)+".");if((l.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(O=d.parse(O,2,Nt)))return null;var le=[],me=null;v==="interpolate-hcl"||v==="interpolate-lab"?me=Nr:d.expectedType&&d.expectedType.kind!=="value"&&(me=d.expectedType);for(var be=0;be<j.length;be+=2){var Ie=j[be],je=j[be+1],Ye=be+3,ct=be+4;if(typeof Ie!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Ye);if(le.length&&le[le.length-1][0]>=Ie)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Ye);var dt=d.parse(je,ct,me);if(!dt)return null;me=me||dt.type,le.push([Ie,dt])}return me.kind==="number"||me.kind==="color"||me.kind==="array"&&me.itemType.kind==="number"&&typeof me.N=="number"?new Ga(me,v,P,O,le):d.error("Type "+di(me)+" is not interpolatable.")},Ga.prototype.evaluate=function(l){var d=this.labels,v=this.outputs;if(d.length===1)return v[0].evaluate(l);var P=this.input.evaluate(l);if(P<=d[0])return v[0].evaluate(l);var O=d.length;if(P>=d[O-1])return v[O-1].evaluate(l);var j=hc(d,P),$=Ga.interpolationFactor(this.interpolation,P,d[j],d[j+1]),K=v[j].evaluate(l),le=v[j+1].evaluate(l);return this.operator==="interpolate"?Ru[this.type.kind.toLowerCase()](K,le,$):this.operator==="interpolate-hcl"?nd.reverse(nd.interpolate(nd.forward(K),nd.forward(le),$)):dc.reverse(dc.interpolate(dc.forward(K),dc.forward(le),$))},Ga.prototype.eachChild=function(l){l(this.input);for(var d=0,v=this.outputs;d<v.length;d+=1)l(v[d])},Ga.prototype.outputDefined=function(){return this.outputs.every(function(l){return l.outputDefined()})},Ga.prototype.serialize=function(){var l;l=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,l,this.input.serialize()],v=0;v<this.labels.length;v++)d.push(this.labels[v],this.outputs[v].serialize());return d};var Ou=function(l,d){this.type=l,this.args=d};Ou.parse=function(l,d){if(l.length<2)return d.error("Expectected at least one argument.");var v=null,P=d.expectedType;P&&P.kind!=="value"&&(v=P);for(var O=[],j=0,$=l.slice(1);j<$.length;j+=1){var K=d.parse($[j],1+O.length,v,void 0,{typeAnnotation:"omit"});if(!K)return null;v=v||K.type,O.push(K)}var le=P&&O.some(function(me){return to(P,me.type)});return new Ou(le?$r:v,O)},Ou.prototype.evaluate=function(l){for(var d,v=null,P=0,O=0,j=this.args;O<j.length&&(P++,(v=j[O].evaluate(l))&&v instanceof Ho&&!v.available&&(d||(d=v.name),v=null,P===this.args.length&&(v=d)),v===null);O+=1);return v},Ou.prototype.eachChild=function(l){this.args.forEach(l)},Ou.prototype.outputDefined=function(){return this.args.every(function(l){return l.outputDefined()})},Ou.prototype.serialize=function(){var l=["coalesce"];return this.eachChild(function(d){l.push(d.serialize())}),l};var Lu=function(l,d){this.type=d.type,this.bindings=[].concat(l),this.result=d};Lu.prototype.evaluate=function(l){return this.result.evaluate(l)},Lu.prototype.eachChild=function(l){for(var d=0,v=this.bindings;d<v.length;d+=1)l(v[d][1]);l(this.result)},Lu.parse=function(l,d){if(l.length<4)return d.error("Expected at least 3 arguments, but found "+(l.length-1)+" instead.");for(var v=[],P=1;P<l.length-1;P+=2){var O=l[P];if(typeof O!="string")return d.error("Expected string, but found "+typeof O+" instead.",P);if(/[^a-zA-Z0-9_]/.test(O))return d.error("Variable names must contain only alphanumeric characters or '_'.",P);var j=d.parse(l[P+1],P+1);if(!j)return null;v.push([O,j])}var $=d.parse(l[l.length-1],l.length-1,d.expectedType,v);return $?new Lu(v,$):null},Lu.prototype.outputDefined=function(){return this.result.outputDefined()},Lu.prototype.serialize=function(){for(var l=["let"],d=0,v=this.bindings;d<v.length;d+=1){var P=v[d];l.push(P[0],P[1].serialize())}return l.push(this.result.serialize()),l};var yl=function(l,d,v){this.type=l,this.index=d,this.input=v};yl.parse=function(l,d){if(l.length!==3)return d.error("Expected 2 arguments, but found "+(l.length-1)+" instead.");var v=d.parse(l[1],1,Nt),P=d.parse(l[2],2,$i(d.expectedType||$r));return v&&P?new yl(P.type.itemType,v,P):null},yl.prototype.evaluate=function(l){var d=this.index.evaluate(l),v=this.input.evaluate(l);if(d<0)throw new Hn("Array index out of bounds: "+d+" < 0.");if(d>=v.length)throw new Hn("Array index out of bounds: "+d+" > "+(v.length-1)+".");if(d!==Math.floor(d))throw new Hn("Array index must be an integer, but found "+d+" instead.");return v[d]},yl.prototype.eachChild=function(l){l(this.index),l(this.input)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var vl=function(l,d){this.type=er,this.needle=l,this.haystack=d};vl.parse=function(l,d){if(l.length!==3)return d.error("Expected 2 arguments, but found "+(l.length-1)+" instead.");var v=d.parse(l[1],1,$r),P=d.parse(l[2],2,$r);return v&&P?xo(v.type,[er,Rr,Nt,qt,$r])?new vl(v,P):d.error("Expected first argument to be of type boolean, string, number or null, but found "+di(v.type)+" instead"):null},vl.prototype.evaluate=function(l){var d=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!v)return!1;if(!so(d,["boolean","string","number","null"]))throw new Hn("Expected first argument to be of type boolean, string, number or null, but found "+di(Qo(d))+" instead.");if(!so(v,["string","array"]))throw new Hn("Expected second argument to be of type array or string, but found "+di(Qo(v))+" instead.");return v.indexOf(d)>=0},vl.prototype.eachChild=function(l){l(this.needle),l(this.haystack)},vl.prototype.outputDefined=function(){return!0},vl.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var pc=function(l,d,v){this.type=Nt,this.needle=l,this.haystack=d,this.fromIndex=v};pc.parse=function(l,d){if(l.length<=2||l.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(l.length-1)+" instead.");var v=d.parse(l[1],1,$r),P=d.parse(l[2],2,$r);if(!v||!P)return null;if(!xo(v.type,[er,Rr,Nt,qt,$r]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+di(v.type)+" instead");if(l.length===4){var O=d.parse(l[3],3,Nt);return O?new pc(v,P,O):null}return new pc(v,P)},pc.prototype.evaluate=function(l){var d=this.needle.evaluate(l),v=this.haystack.evaluate(l);if(!so(d,["boolean","string","number","null"]))throw new Hn("Expected first argument to be of type boolean, string, number or null, but found "+di(Qo(d))+" instead.");if(!so(v,["string","array"]))throw new Hn("Expected second argument to be of type array or string, but found "+di(Qo(v))+" instead.");if(this.fromIndex){var P=this.fromIndex.evaluate(l);return v.indexOf(d,P)}return v.indexOf(d)},pc.prototype.eachChild=function(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)},pc.prototype.outputDefined=function(){return!1},pc.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var l=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),l]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Xl=function(l,d,v,P,O,j){this.inputType=l,this.type=d,this.input=v,this.cases=P,this.outputs=O,this.otherwise=j};Xl.parse=function(l,d){if(l.length<5)return d.error("Expected at least 4 arguments, but found only "+(l.length-1)+".");if(l.length%2!=1)return d.error("Expected an even number of arguments.");var v,P;d.expectedType&&d.expectedType.kind!=="value"&&(P=d.expectedType);for(var O={},j=[],$=2;$<l.length-1;$+=2){var K=l[$],le=l[$+1];Array.isArray(K)||(K=[K]);var me=d.concat($);if(K.length===0)return me.error("Expected at least one branch label.");for(var be=0,Ie=K;be<Ie.length;be+=1){var je=Ie[be];if(typeof je!="number"&&typeof je!="string")return me.error("Branch labels must be numbers or strings.");if(typeof je=="number"&&Math.abs(je)>Number.MAX_SAFE_INTEGER)return me.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof je=="number"&&Math.floor(je)!==je)return me.error("Numeric branch labels must be integer values.");if(v){if(me.checkSubtype(v,Qo(je)))return null}else v=Qo(je);if(O[String(je)]!==void 0)return me.error("Branch labels must be unique.");O[String(je)]=j.length}var Ye=d.parse(le,$,P);if(!Ye)return null;P=P||Ye.type,j.push(Ye)}var ct=d.parse(l[1],1,$r);if(!ct)return null;var dt=d.parse(l[l.length-1],l.length-1,P);return dt?ct.type.kind!=="value"&&d.concat(1).checkSubtype(v,ct.type)?null:new Xl(v,P,ct,O,j,dt):null},Xl.prototype.evaluate=function(l){var d=this.input.evaluate(l);return(Qo(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(l)},Xl.prototype.eachChild=function(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)},Xl.prototype.outputDefined=function(){return this.outputs.every(function(l){return l.outputDefined()})&&this.otherwise.outputDefined()},Xl.prototype.serialize=function(){for(var l=this,d=["match",this.input.serialize()],v=[],P={},O=0,j=Object.keys(this.cases).sort();O<j.length;O+=1){var $=j[O];(Ie=P[this.cases[$]])===void 0?(P[this.cases[$]]=v.length,v.push([this.cases[$],[$]])):v[Ie][1].push($)}for(var K=function(Ye){return l.inputType.kind==="number"?Number(Ye):Ye},le=0,me=v;le<me.length;le+=1){var be=me[le],Ie=be[0],je=be[1];d.push(je.length===1?K(je[0]):je.map(K)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var ou=function(l,d,v){this.type=l,this.branches=d,this.otherwise=v};ou.parse=function(l,d){if(l.length<4)return d.error("Expected at least 3 arguments, but found only "+(l.length-1)+".");if(l.length%2!=0)return d.error("Expected an odd number of arguments.");var v;d.expectedType&&d.expectedType.kind!=="value"&&(v=d.expectedType);for(var P=[],O=1;O<l.length-1;O+=2){var j=d.parse(l[O],O,er);if(!j)return null;var $=d.parse(l[O+1],O+1,v);if(!$)return null;P.push([j,$]),v=v||$.type}var K=d.parse(l[l.length-1],l.length-1,v);return K?new ou(v,P,K):null},ou.prototype.evaluate=function(l){for(var d=0,v=this.branches;d<v.length;d+=1){var P=v[d],O=P[1];if(P[0].evaluate(l))return O.evaluate(l)}return this.otherwise.evaluate(l)},ou.prototype.eachChild=function(l){for(var d=0,v=this.branches;d<v.length;d+=1){var P=v[d],O=P[1];l(P[0]),l(O)}l(this.otherwise)},ou.prototype.outputDefined=function(){return this.branches.every(function(l){return l[1].outputDefined()})&&this.otherwise.outputDefined()},ou.prototype.serialize=function(){var l=["case"];return this.eachChild(function(d){l.push(d.serialize())}),l};var Ws=function(l,d,v,P){this.type=l,this.input=d,this.beginIndex=v,this.endIndex=P};function au(l,d){return l==="=="||l==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function id(l,d,v,P){return P.compare(d,v)===0}function No(l,d,v){var P=l!=="=="&&l!=="!=";return function(){function O(j,$,K){this.type=er,this.lhs=j,this.rhs=$,this.collator=K,this.hasUntypedArgument=j.type.kind==="value"||$.type.kind==="value"}return O.parse=function(j,$){if(j.length!==3&&j.length!==4)return $.error("Expected two or three arguments.");var K=j[0],le=$.parse(j[1],1,$r);if(!le)return null;if(!au(K,le.type))return $.concat(1).error('"'+K+`" comparisons are not supported for type '`+di(le.type)+"'.");var me=$.parse(j[2],2,$r);if(!me)return null;if(!au(K,me.type))return $.concat(2).error('"'+K+`" comparisons are not supported for type '`+di(me.type)+"'.");if(le.type.kind!==me.type.kind&&le.type.kind!=="value"&&me.type.kind!=="value")return $.error("Cannot compare types '"+di(le.type)+"' and '"+di(me.type)+"'.");P&&(le.type.kind==="value"&&me.type.kind!=="value"?le=new Uo(me.type,[le]):le.type.kind!=="value"&&me.type.kind==="value"&&(me=new Uo(le.type,[me])));var be=null;if(j.length===4){if(le.type.kind!=="string"&&me.type.kind!=="string"&&le.type.kind!=="value"&&me.type.kind!=="value")return $.error("Cannot use collator to compare non-string types.");if(!(be=$.parse(j[3],3,si)))return null}return new O(le,me,be)},O.prototype.evaluate=function(j){var $=this.lhs.evaluate(j),K=this.rhs.evaluate(j);if(P&&this.hasUntypedArgument){var le=Qo($),me=Qo(K);if(le.kind!==me.kind||le.kind!=="string"&&le.kind!=="number")throw new Hn('Expected arguments for "'+l+'" to be (string, string) or (number, number), but found ('+le.kind+", "+me.kind+") instead.")}if(this.collator&&!P&&this.hasUntypedArgument){var be=Qo($),Ie=Qo(K);if(be.kind!=="string"||Ie.kind!=="string")return d(j,$,K)}return this.collator?v(j,$,K,this.collator.evaluate(j)):d(j,$,K)},O.prototype.eachChild=function(j){j(this.lhs),j(this.rhs),this.collator&&j(this.collator)},O.prototype.outputDefined=function(){return!0},O.prototype.serialize=function(){var j=[l];return this.eachChild(function($){j.push($.serialize())}),j},O}()}Ws.parse=function(l,d){if(l.length<=2||l.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(l.length-1)+" instead.");var v=d.parse(l[1],1,$r),P=d.parse(l[2],2,Nt);if(!v||!P)return null;if(!xo(v.type,[$i($r),Rr,$r]))return d.error("Expected first argument to be of type array or string, but found "+di(v.type)+" instead");if(l.length===4){var O=d.parse(l[3],3,Nt);return O?new Ws(v.type,v,P,O):null}return new Ws(v.type,v,P)},Ws.prototype.evaluate=function(l){var d=this.input.evaluate(l),v=this.beginIndex.evaluate(l);if(!so(d,["string","array"]))throw new Hn("Expected first argument to be of type array or string, but found "+di(Qo(d))+" instead.");if(this.endIndex){var P=this.endIndex.evaluate(l);return d.slice(v,P)}return d.slice(v)},Ws.prototype.eachChild=function(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)},Ws.prototype.outputDefined=function(){return!1},Ws.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var l=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),l]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Nf=No("==",function(l,d,v){return d===v},id),sl=No("!=",function(l,d,v){return d!==v},function(l,d,v,P){return!id(0,d,v,P)}),jf=No("<",function(l,d,v){return d<v},function(l,d,v,P){return P.compare(d,v)<0}),$p=No(">",function(l,d,v){return d>v},function(l,d,v,P){return P.compare(d,v)>0}),Gp=No("<=",function(l,d,v){return d<=v},function(l,d,v,P){return P.compare(d,v)<=0}),qp=No(">=",function(l,d,v){return d>=v},function(l,d,v,P){return P.compare(d,v)>=0}),su=function(l,d,v,P,O){this.type=Rr,this.number=l,this.locale=d,this.currency=v,this.minFractionDigits=P,this.maxFractionDigits=O};su.parse=function(l,d){if(l.length!==3)return d.error("Expected two arguments.");var v=d.parse(l[1],1,Nt);if(!v)return null;var P=l[2];if(typeof P!="object"||Array.isArray(P))return d.error("NumberFormat options argument must be an object.");var O=null;if(P.locale&&!(O=d.parse(P.locale,1,Rr)))return null;var j=null;if(P.currency&&!(j=d.parse(P.currency,1,Rr)))return null;var $=null;if(P["min-fraction-digits"]&&!($=d.parse(P["min-fraction-digits"],1,Nt)))return null;var K=null;return P["max-fraction-digits"]&&!(K=d.parse(P["max-fraction-digits"],1,Nt))?null:new su(v,O,j,$,K)},su.prototype.evaluate=function(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))},su.prototype.eachChild=function(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)},su.prototype.outputDefined=function(){return!1},su.prototype.serialize=function(){var l={};return this.locale&&(l.locale=this.locale.serialize()),this.currency&&(l.currency=this.currency.serialize()),this.minFractionDigits&&(l["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(l["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),l]};var zc=function(l){this.type=Nt,this.input=l};zc.parse=function(l,d){if(l.length!==2)return d.error("Expected 1 argument, but found "+(l.length-1)+" instead.");var v=d.parse(l[1],1);return v?v.type.kind!=="array"&&v.type.kind!=="string"&&v.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+di(v.type)+" instead."):new zc(v):null},zc.prototype.evaluate=function(l){var d=this.input.evaluate(l);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Hn("Expected value to be of type string or array, but found "+di(Qo(d))+" instead.")},zc.prototype.eachChild=function(l){l(this.input)},zc.prototype.outputDefined=function(){return!1},zc.prototype.serialize=function(){var l=["length"];return this.eachChild(function(d){l.push(d.serialize())}),l};var Yl={"==":Nf,"!=":sl,">":$p,"<":jf,">=":qp,"<=":Gp,array:Uo,at:yl,boolean:Uo,case:ou,coalesce:Ou,collator:ft,format:Gs,image:Os,in:vl,"index-of":pc,interpolate:Ga,"interpolate-hcl":Ga,"interpolate-lab":Ga,length:zc,let:Lu,literal:po,match:Xl,number:Uo,"number-format":su,object:Uo,slice:Ws,step:$a,string:Uo,"to-boolean":qs,"to-color":qs,"to-number":qs,"to-string":qs,var:ta,within:ea};function np(l,d){var v=d[0],P=d[1],O=d[2],j=d[3];v=v.evaluate(l),P=P.evaluate(l),O=O.evaluate(l);var $=j?j.evaluate(l):1,K=Oc(v,P,O,$);if(K)throw new Hn(K);return new qi(v/255*$,P/255*$,O/255*$,$)}function od(l,d){return l in d}function Nc(l,d){var v=d[l];return v===void 0?null:v}function lu(l){return{type:l}}function Ol(l){return{result:"success",value:l}}function Jr(l){return{result:"error",value:l}}function jc(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Wp(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function cu(l){return!!l.expression&&l.expression.interpolated}function Go(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function fc(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function mc(l){return l}function zu(l,d,v){return l!==void 0?l:d!==void 0?d:v!==void 0?v:void 0}function Nu(l,d,v,P,O){return zu(typeof v===O?P[v]:void 0,l.default,d.default)}function Hp(l,d,v){if(Go(v)!=="number")return zu(l.default,d.default);var P=l.stops.length;if(P===1||v<=l.stops[0][0])return l.stops[0][1];if(v>=l.stops[P-1][0])return l.stops[P-1][1];var O=hc(l.stops.map(function(j){return j[0]}),v);return l.stops[O][1]}function ju(l,d,v){var P=l.base!==void 0?l.base:1;if(Go(v)!=="number")return zu(l.default,d.default);var O=l.stops.length;if(O===1||v<=l.stops[0][0])return l.stops[0][1];if(v>=l.stops[O-1][0])return l.stops[O-1][1];var j=hc(l.stops.map(function(Ie){return Ie[0]}),v),$=function(Ie,je,Ye,ct){var dt=ct-Ye,kt=Ie-Ye;return dt===0?0:je===1?kt/dt:(Math.pow(je,kt)-1)/(Math.pow(je,dt)-1)}(v,P,l.stops[j][0],l.stops[j+1][0]),K=l.stops[j][1],le=l.stops[j+1][1],me=Ru[d.type]||mc;if(l.colorSpace&&l.colorSpace!=="rgb"){var be=Ki[l.colorSpace];me=function(Ie,je){return be.reverse(be.interpolate(be.forward(Ie),be.forward(je),$))}}return typeof K.evaluate=="function"?{evaluate:function(){for(var Ie=[],je=arguments.length;je--;)Ie[je]=arguments[je];var Ye=K.evaluate.apply(void 0,Ie),ct=le.evaluate.apply(void 0,Ie);if(Ye!==void 0&&ct!==void 0)return me(Ye,ct,$)}}:me(K,le,$)}function ad(l,d,v){return d.type==="color"?v=qi.parse(v):d.type==="formatted"?v=ga.fromString(v.toString()):d.type==="resolvedImage"?v=Ho.fromString(v.toString()):Go(v)===d.type||d.type==="enum"&&d.values[v]||(v=void 0),zu(v,l.default,d.default)}Oe.register(Yl,{error:[{kind:"error"},[Rr],function(l,d){throw new Hn(d[0].evaluate(l))}],typeof:[Rr,[$r],function(l,d){return di(Qo(d[0].evaluate(l)))}],"to-rgba":[$i(Nt,4),[Nr],function(l,d){return d[0].evaluate(l).toArray()}],rgb:[Nr,[Nt,Nt,Nt],np],rgba:[Nr,[Nt,Nt,Nt,Nt],np],has:{type:er,overloads:[[[Rr],function(l,d){return od(d[0].evaluate(l),l.properties())}],[[Rr,Ln],function(l,d){var v=d[1];return od(d[0].evaluate(l),v.evaluate(l))}]]},get:{type:$r,overloads:[[[Rr],function(l,d){return Nc(d[0].evaluate(l),l.properties())}],[[Rr,Ln],function(l,d){var v=d[1];return Nc(d[0].evaluate(l),v.evaluate(l))}]]},"feature-state":[$r,[Rr],function(l,d){return Nc(d[0].evaluate(l),l.featureState||{})}],properties:[Ln,[],function(l){return l.properties()}],"geometry-type":[Rr,[],function(l){return l.geometryType()}],id:[$r,[],function(l){return l.id()}],zoom:[Nt,[],function(l){return l.globals.zoom}],"heatmap-density":[Nt,[],function(l){return l.globals.heatmapDensity||0}],"line-progress":[Nt,[],function(l){return l.globals.lineProgress||0}],accumulated:[$r,[],function(l){return l.globals.accumulated===void 0?null:l.globals.accumulated}],"+":[Nt,lu(Nt),function(l,d){for(var v=0,P=0,O=d;P<O.length;P+=1)v+=O[P].evaluate(l);return v}],"*":[Nt,lu(Nt),function(l,d){for(var v=1,P=0,O=d;P<O.length;P+=1)v*=O[P].evaluate(l);return v}],"-":{type:Nt,overloads:[[[Nt,Nt],function(l,d){var v=d[1];return d[0].evaluate(l)-v.evaluate(l)}],[[Nt],function(l,d){return-d[0].evaluate(l)}]]},"/":[Nt,[Nt,Nt],function(l,d){var v=d[1];return d[0].evaluate(l)/v.evaluate(l)}],"%":[Nt,[Nt,Nt],function(l,d){var v=d[1];return d[0].evaluate(l)%v.evaluate(l)}],ln2:[Nt,[],function(){return Math.LN2}],pi:[Nt,[],function(){return Math.PI}],e:[Nt,[],function(){return Math.E}],"^":[Nt,[Nt,Nt],function(l,d){var v=d[1];return Math.pow(d[0].evaluate(l),v.evaluate(l))}],sqrt:[Nt,[Nt],function(l,d){return Math.sqrt(d[0].evaluate(l))}],log10:[Nt,[Nt],function(l,d){return Math.log(d[0].evaluate(l))/Math.LN10}],ln:[Nt,[Nt],function(l,d){return Math.log(d[0].evaluate(l))}],log2:[Nt,[Nt],function(l,d){return Math.log(d[0].evaluate(l))/Math.LN2}],sin:[Nt,[Nt],function(l,d){return Math.sin(d[0].evaluate(l))}],cos:[Nt,[Nt],function(l,d){return Math.cos(d[0].evaluate(l))}],tan:[Nt,[Nt],function(l,d){return Math.tan(d[0].evaluate(l))}],asin:[Nt,[Nt],function(l,d){return Math.asin(d[0].evaluate(l))}],acos:[Nt,[Nt],function(l,d){return Math.acos(d[0].evaluate(l))}],atan:[Nt,[Nt],function(l,d){return Math.atan(d[0].evaluate(l))}],min:[Nt,lu(Nt),function(l,d){return Math.min.apply(Math,d.map(function(v){return v.evaluate(l)}))}],max:[Nt,lu(Nt),function(l,d){return Math.max.apply(Math,d.map(function(v){return v.evaluate(l)}))}],abs:[Nt,[Nt],function(l,d){return Math.abs(d[0].evaluate(l))}],round:[Nt,[Nt],function(l,d){var v=d[0].evaluate(l);return v<0?-Math.round(-v):Math.round(v)}],floor:[Nt,[Nt],function(l,d){return Math.floor(d[0].evaluate(l))}],ceil:[Nt,[Nt],function(l,d){return Math.ceil(d[0].evaluate(l))}],"filter-==":[er,[Rr,$r],function(l,d){var v=d[0],P=d[1];return l.properties()[v.value]===P.value}],"filter-id-==":[er,[$r],function(l,d){var v=d[0];return l.id()===v.value}],"filter-type-==":[er,[Rr],function(l,d){var v=d[0];return l.geometryType()===v.value}],"filter-<":[er,[Rr,$r],function(l,d){var v=d[0],P=d[1],O=l.properties()[v.value],j=P.value;return typeof O==typeof j&&O<j}],"filter-id-<":[er,[$r],function(l,d){var v=d[0],P=l.id(),O=v.value;return typeof P==typeof O&&P<O}],"filter->":[er,[Rr,$r],function(l,d){var v=d[0],P=d[1],O=l.properties()[v.value],j=P.value;return typeof O==typeof j&&O>j}],"filter-id->":[er,[$r],function(l,d){var v=d[0],P=l.id(),O=v.value;return typeof P==typeof O&&P>O}],"filter-<=":[er,[Rr,$r],function(l,d){var v=d[0],P=d[1],O=l.properties()[v.value],j=P.value;return typeof O==typeof j&&O<=j}],"filter-id-<=":[er,[$r],function(l,d){var v=d[0],P=l.id(),O=v.value;return typeof P==typeof O&&P<=O}],"filter->=":[er,[Rr,$r],function(l,d){var v=d[0],P=d[1],O=l.properties()[v.value],j=P.value;return typeof O==typeof j&&O>=j}],"filter-id->=":[er,[$r],function(l,d){var v=d[0],P=l.id(),O=v.value;return typeof P==typeof O&&P>=O}],"filter-has":[er,[$r],function(l,d){return d[0].value in l.properties()}],"filter-has-id":[er,[],function(l){return l.id()!==null&&l.id()!==void 0}],"filter-type-in":[er,[$i(Rr)],function(l,d){return d[0].value.indexOf(l.geometryType())>=0}],"filter-id-in":[er,[$i($r)],function(l,d){return d[0].value.indexOf(l.id())>=0}],"filter-in-small":[er,[Rr,$i($r)],function(l,d){var v=d[0];return d[1].value.indexOf(l.properties()[v.value])>=0}],"filter-in-large":[er,[Rr,$i($r)],function(l,d){var v=d[0],P=d[1];return function(O,j,$,K){for(;$<=K;){var le=$+K>>1;if(j[le]===O)return!0;j[le]>O?K=le-1:$=le+1}return!1}(l.properties()[v.value],P.value,0,P.value.length-1)}],all:{type:er,overloads:[[[er,er],function(l,d){var v=d[1];return d[0].evaluate(l)&&v.evaluate(l)}],[lu(er),function(l,d){for(var v=0,P=d;v<P.length;v+=1)if(!P[v].evaluate(l))return!1;return!0}]]},any:{type:er,overloads:[[[er,er],function(l,d){var v=d[1];return d[0].evaluate(l)||v.evaluate(l)}],[lu(er),function(l,d){for(var v=0,P=d;v<P.length;v+=1)if(P[v].evaluate(l))return!0;return!1}]]},"!":[er,[er],function(l,d){return!d[0].evaluate(l)}],"is-supported-script":[er,[Rr],function(l,d){var v=l.globals&&l.globals.isSupportedScript;return!v||v(d[0].evaluate(l))}],upcase:[Rr,[Rr],function(l,d){return d[0].evaluate(l).toUpperCase()}],downcase:[Rr,[Rr],function(l,d){return d[0].evaluate(l).toLowerCase()}],concat:[Rr,lu($r),function(l,d){return d.map(function(v){return Va(v.evaluate(l))}).join("")}],"resolved-locale":[Rr,[si],function(l,d){return d[0].evaluate(l).resolvedLocale()}]});var sd=function(l,d){this.expression=l,this._warningHistory={},this._evaluator=new He,this._defaultValue=d?function(v){return v.type==="color"&&fc(v.default)?new qi(0,0,0,0):v.type==="color"?qi.parse(v.default)||null:v.default===void 0?null:v.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Bc(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Yl}function Zp(l,d){var v=new ms(Yl,[],d?function(O){var j={color:Nr,string:Rr,number:Nt,enum:Rr,boolean:er,formatted:Yi,resolvedImage:xn};return O.type==="array"?$i(j[O.value]||$r,O.length):j[O.type]}(d):void 0),P=v.parse(l,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return P?Ol(new sd(P,d)):Jr(v.errors)}sd.prototype.evaluateWithoutErrorHandling=function(l,d,v,P,O,j){return this._evaluator.globals=l,this._evaluator.feature=d,this._evaluator.featureState=v,this._evaluator.canonical=P,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=j,this.expression.evaluate(this._evaluator)},sd.prototype.evaluate=function(l,d,v,P,O,j){this._evaluator.globals=l,this._evaluator.feature=d||null,this._evaluator.featureState=v||null,this._evaluator.canonical=P,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=j||null;try{var $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Hn("Expected value to be one of "+Object.keys(this._enumValues).map(function(K){return JSON.stringify(K)}).join(", ")+", but found "+JSON.stringify($)+" instead.");return $}catch(K){return this._warningHistory[K.message]||(this._warningHistory[K.message]=!0,typeof console<"u"&&console.warn(K.message)),this._defaultValue}};var ld=function(l,d){this.kind=l,this._styleExpression=d,this.isStateDependent=l!=="constant"&&!ru(d.expression)};ld.prototype.evaluateWithoutErrorHandling=function(l,d,v,P,O,j){return this._styleExpression.evaluateWithoutErrorHandling(l,d,v,P,O,j)},ld.prototype.evaluate=function(l,d,v,P,O,j){return this._styleExpression.evaluate(l,d,v,P,O,j)};var xh=function(l,d,v,P){this.kind=l,this.zoomStops=v,this._styleExpression=d,this.isStateDependent=l!=="camera"&&!ru(d.expression),this.interpolationType=P};function Xp(l,d){if((l=Zp(l,d)).result==="error")return l;var v=l.value.expression,P=Dn(v);if(!P&&!jc(d))return Jr([new Rt("","data expressions not supported")]);var O=Rl(v,["zoom"]);if(!O&&!Wp(d))return Jr([new Rt("","zoom expressions not supported")]);var j=function $(K){var le=null;if(K instanceof Lu)le=$(K.result);else if(K instanceof Ou)for(var me=0,be=K.args;me<be.length&&!(le=$(be[me]));me+=1);else(K instanceof $a||K instanceof Ga)&&K.input instanceof Oe&&K.input.name==="zoom"&&(le=K);return le instanceof Rt||K.eachChild(function(Ie){var je=$(Ie);je instanceof Rt?le=je:!le&&je?le=new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):le&&je&&le!==je&&(le=new Rt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),le}(v);return j||O?j instanceof Rt?Jr([j]):j instanceof Ga&&!cu(d)?Jr([new Rt("",'"interpolate" expressions cannot be used with this property')]):Ol(j?new xh(P?"camera":"composite",l.value,j.labels,j instanceof Ga?j.interpolation:void 0):new ld(P?"constant":"source",l.value)):Jr([new Rt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}xh.prototype.evaluateWithoutErrorHandling=function(l,d,v,P,O,j){return this._styleExpression.evaluateWithoutErrorHandling(l,d,v,P,O,j)},xh.prototype.evaluate=function(l,d,v,P,O,j){return this._styleExpression.evaluate(l,d,v,P,O,j)},xh.prototype.interpolationFactor=function(l,d,v){return this.interpolationType?Ga.interpolationFactor(this.interpolationType,l,d,v):0};var cd=function(l,d){this._parameters=l,this._specification=d,Mt(this,function v(P,O){var j,$,K,le=O.type==="color",me=P.stops&&typeof P.stops[0][0]=="object",be=me||!(me||P.property!==void 0),Ie=P.type||(cu(O)?"exponential":"interval");if(le&&((P=Mt({},P)).stops&&(P.stops=P.stops.map(function(Tn){return[Tn[0],qi.parse(Tn[1])]})),P.default=qi.parse(P.default?P.default:O.default)),P.colorSpace&&P.colorSpace!=="rgb"&&!Ki[P.colorSpace])throw new Error("Unknown color space: "+P.colorSpace);if(Ie==="exponential")j=ju;else if(Ie==="interval")j=Hp;else if(Ie==="categorical"){j=Nu,$=Object.create(null);for(var je=0,Ye=P.stops;je<Ye.length;je+=1){var ct=Ye[je];$[ct[0]]=ct[1]}K=typeof P.stops[0][0]}else{if(Ie!=="identity")throw new Error('Unknown function type "'+Ie+'"');j=ad}if(me){for(var dt={},kt=[],St=0;St<P.stops.length;St++){var Gt=P.stops[St],or=Gt[0].zoom;dt[or]===void 0&&(dt[or]={zoom:or,type:P.type,property:P.property,default:P.default,stops:[]},kt.push(or)),dt[or].stops.push([Gt[0].value,Gt[1]])}for(var gr=[],yr=0,zr=kt;yr<zr.length;yr+=1){var Qr=zr[yr];gr.push([dt[Qr].zoom,v(dt[Qr],O)])}var nn={name:"linear"};return{kind:"composite",interpolationType:nn,interpolationFactor:Ga.interpolationFactor.bind(void 0,nn),zoomStops:gr.map(function(Tn){return Tn[0]}),evaluate:function(Tn,li){var En=Tn.zoom;return ju({stops:gr,base:P.base},O,En).evaluate(En,li)}}}if(be){var Zn=Ie==="exponential"?{name:"exponential",base:P.base!==void 0?P.base:1}:null;return{kind:"camera",interpolationType:Zn,interpolationFactor:Ga.interpolationFactor.bind(void 0,Zn),zoomStops:P.stops.map(function(Tn){return Tn[0]}),evaluate:function(Tn){return j(P,O,Tn.zoom,$,K)}}}return{kind:"source",evaluate:function(Tn,li){var En=li&&li.properties?li.properties[P.property]:void 0;return En===void 0?zu(P.default,O.default):j(P,O,En,$,K)}}}(this._parameters,this._specification))};function gc(l){var d=l.key,v=l.value,P=l.valueSpec||{},O=l.objectElementValidators||{},j=l.style,$=l.styleSpec,K=[],le=Go(v);if(le!=="object")return[new Le(d,v,"object expected, "+le+" found")];for(var me in v){var be=me.split(".")[0],Ie=P[be]||P["*"],je=void 0;if(O[be])je=O[be];else if(P[be])je=co;else if(O["*"])je=O["*"];else{if(!P["*"]){K.push(new Le(d,v[me],'unknown property "'+me+'"'));continue}je=co}K=K.concat(je({key:(d&&d+".")+me,value:v[me],valueSpec:Ie,style:j,styleSpec:$,object:v,objectKey:me},v))}for(var Ye in P)O[Ye]||P[Ye].required&&P[Ye].default===void 0&&v[Ye]===void 0&&K.push(new Le(d,v,'missing required property "'+Ye+'"'));return K}function Bm(l){var d=l.value,v=l.valueSpec,P=l.style,O=l.styleSpec,j=l.key,$=l.arrayElementValidator||co;if(Go(d)!=="array")return[new Le(j,d,"array expected, "+Go(d)+" found")];if(v.length&&d.length!==v.length)return[new Le(j,d,"array length "+v.length+" expected, length "+d.length+" found")];if(v["min-length"]&&d.length<v["min-length"])return[new Le(j,d,"array length at least "+v["min-length"]+" expected, length "+d.length+" found")];var K={type:v.value,values:v.values};O.$version<7&&(K.function=v.function),Go(v.value)==="object"&&(K=v.value);for(var le=[],me=0;me<d.length;me++)le=le.concat($({array:d,arrayIndex:me,value:d[me],valueSpec:K,style:P,styleSpec:O,key:j+"["+me+"]"}));return le}function Bf(l){var d=l.key,v=l.value,P=l.valueSpec,O=Go(v);return O==="number"&&v!=v&&(O="NaN"),O!=="number"?[new Le(d,v,"number expected, "+O+" found")]:"minimum"in P&&v<P.minimum?[new Le(d,v,v+" is less than the minimum value "+P.minimum)]:"maximum"in P&&v>P.maximum?[new Le(d,v,v+" is greater than the maximum value "+P.maximum)]:[]}function ud(l){var d,v,P,O=l.valueSpec,j=Ot(l.value.type),$={},K=j!=="categorical"&&l.value.property===void 0,le=!K,me=Go(l.value.stops)==="array"&&Go(l.value.stops[0])==="array"&&Go(l.value.stops[0][0])==="object",be=gc({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(Ye){if(j==="identity")return[new Le(Ye.key,Ye.value,'identity function may not have a "stops" property')];var ct=[],dt=Ye.value;return ct=ct.concat(Bm({key:Ye.key,value:dt,valueSpec:Ye.valueSpec,style:Ye.style,styleSpec:Ye.styleSpec,arrayElementValidator:Ie})),Go(dt)==="array"&&dt.length===0&&ct.push(new Le(Ye.key,dt,"array must have at least one stop")),ct},default:function(Ye){return co({key:Ye.key,value:Ye.value,valueSpec:O,style:Ye.style,styleSpec:Ye.styleSpec})}}});return j==="identity"&&K&&be.push(new Le(l.key,l.value,'missing required property "property"')),j==="identity"||l.value.stops||be.push(new Le(l.key,l.value,'missing required property "stops"')),j==="exponential"&&l.valueSpec.expression&&!cu(l.valueSpec)&&be.push(new Le(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(le&&!jc(l.valueSpec)?be.push(new Le(l.key,l.value,"property functions not supported")):K&&!Wp(l.valueSpec)&&be.push(new Le(l.key,l.value,"zoom functions not supported"))),j!=="categorical"&&!me||l.value.property!==void 0||be.push(new Le(l.key,l.value,'"property" property is required')),be;function Ie(Ye){var ct=[],dt=Ye.value,kt=Ye.key;if(Go(dt)!=="array")return[new Le(kt,dt,"array expected, "+Go(dt)+" found")];if(dt.length!==2)return[new Le(kt,dt,"array length 2 expected, length "+dt.length+" found")];if(me){if(Go(dt[0])!=="object")return[new Le(kt,dt,"object expected, "+Go(dt[0])+" found")];if(dt[0].zoom===void 0)return[new Le(kt,dt,"object stop key must have zoom")];if(dt[0].value===void 0)return[new Le(kt,dt,"object stop key must have value")];if(P&&P>Ot(dt[0].zoom))return[new Le(kt,dt[0].zoom,"stop zoom values must appear in ascending order")];Ot(dt[0].zoom)!==P&&(P=Ot(dt[0].zoom),v=void 0,$={}),ct=ct.concat(gc({key:kt+"[0]",value:dt[0],valueSpec:{zoom:{}},style:Ye.style,styleSpec:Ye.styleSpec,objectElementValidators:{zoom:Bf,value:je}}))}else ct=ct.concat(je({key:kt+"[0]",value:dt[0],valueSpec:{},style:Ye.style,styleSpec:Ye.styleSpec},dt));return Bc(bt(dt[1]))?ct.concat([new Le(kt+"[1]",dt[1],"expressions are not allowed in function stops.")]):ct.concat(co({key:kt+"[1]",value:dt[1],valueSpec:O,style:Ye.style,styleSpec:Ye.styleSpec}))}function je(Ye,ct){var dt=Go(Ye.value),kt=Ot(Ye.value),St=Ye.value!==null?Ye.value:ct;if(d){if(dt!==d)return[new Le(Ye.key,St,dt+" stop domain type must match previous stop domain type "+d)]}else d=dt;if(dt!=="number"&&dt!=="string"&&dt!=="boolean")return[new Le(Ye.key,St,"stop domain value must be a number, string, or boolean")];if(dt!=="number"&&j!=="categorical"){var Gt="number expected, "+dt+" found";return jc(O)&&j===void 0&&(Gt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Le(Ye.key,St,Gt)]}return j!=="categorical"||dt!=="number"||isFinite(kt)&&Math.floor(kt)===kt?j!=="categorical"&&dt==="number"&&v!==void 0&&kt<v?[new Le(Ye.key,St,"stop domain values must appear in ascending order")]:(v=kt,j==="categorical"&&kt in $?[new Le(Ye.key,St,"stop domain values must be unique")]:($[kt]=!0,[])):[new Le(Ye.key,St,"integer expected, found "+kt)]}}function bh(l){var d=(l.expressionContext==="property"?Xp:Zp)(bt(l.value),l.valueSpec);if(d.result==="error")return d.value.map(function(P){return new Le(""+l.key+P.key,l.value,P.message)});var v=d.value.expression||d.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!v.outputDefined())return[new Le(l.key,l.value,'Invalid data expression for "'+l.propertyKey+'". Output values must be contained as literals within the expression.')];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!ru(v))return[new Le(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!ru(v))return[new Le(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Rl(v,["zoom","feature-state"]))return[new Le(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Dn(v))return[new Le(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Bu(l){var d=l.key,v=l.value,P=l.valueSpec,O=[];return Array.isArray(P.values)?P.values.indexOf(Ot(v))===-1&&O.push(new Le(d,v,"expected one of ["+P.values.join(", ")+"], "+JSON.stringify(v)+" found")):Object.keys(P.values).indexOf(Ot(v))===-1&&O.push(new Le(d,v,"expected one of ["+Object.keys(P.values).join(", ")+"], "+JSON.stringify(v)+" found")),O}function hd(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(var d=0,v=l.slice(1);d<v.length;d+=1){var P=v[d];if(!hd(P)&&typeof P!="boolean")return!1}return!0;default:return!0}}cd.deserialize=function(l){return new cd(l._parameters,l._specification)},cd.serialize=function(l){return{_parameters:l._parameters,_specification:l._specification}};var Yp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function dd(l){if(l==null)return{filter:function(){return!0},needGeometry:!1};hd(l)||(l=pd(l));var d=Zp(l,Yp);if(d.result==="error")throw new Error(d.value.map(function(v){return v.key+": "+v.message}).join(", "));return{filter:function(v,P,O){return d.value.evaluate(v,P,{},O)},needGeometry:function v(P){if(!Array.isArray(P))return!1;if(P[0]==="within")return!0;for(var O=1;O<P.length;O++)if(v(P[O]))return!0;return!1}(l)}}function Kp(l,d){return l<d?-1:l>d?1:0}function pd(l){if(!l)return!0;var d,v=l[0];return l.length<=1?v!=="any":v==="=="?uu(l[1],l[2],"=="):v==="!="?md(uu(l[1],l[2],"==")):v==="<"||v===">"||v==="<="||v===">="?uu(l[1],l[2],v):v==="any"?(d=l.slice(1),["any"].concat(d.map(pd))):v==="all"?["all"].concat(l.slice(1).map(pd)):v==="none"?["all"].concat(l.slice(1).map(pd).map(md)):v==="in"?ip(l[1],l.slice(2)):v==="!in"?md(ip(l[1],l.slice(2))):v==="has"?fd(l[1]):v==="!has"?md(fd(l[1])):v!=="within"||l}function uu(l,d,v){switch(l){case"$type":return["filter-type-"+v,d];case"$id":return["filter-id-"+v,d];default:return["filter-"+v,l,d]}}function ip(l,d){if(d.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(v){return typeof v!=typeof d[0]})?["filter-in-large",l,["literal",d.sort(Kp)]]:["filter-in-small",l,["literal",d]]}}function fd(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function md(l){return["!",l]}function wh(l){return hd(bt(l.value))?bh(Mt({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(v){var P=v.value,O=v.key;if(Go(P)!=="array")return[new Le(O,P,"array expected, "+Go(P)+" found")];var j,$=v.styleSpec,K=[];if(P.length<1)return[new Le(O,P,"filter array must have at least 1 element")];switch(K=K.concat(Bu({key:O+"[0]",value:P[0],valueSpec:$.filter_operator,style:v.style,styleSpec:v.styleSpec})),Ot(P[0])){case"<":case"<=":case">":case">=":P.length>=2&&Ot(P[1])==="$type"&&K.push(new Le(O,P,'"$type" cannot be use with operator "'+P[0]+'"'));case"==":case"!=":P.length!==3&&K.push(new Le(O,P,'filter array for operator "'+P[0]+'" must have 3 elements'));case"in":case"!in":P.length>=2&&(j=Go(P[1]))!=="string"&&K.push(new Le(O+"[1]",P[1],"string expected, "+j+" found"));for(var le=2;le<P.length;le++)j=Go(P[le]),Ot(P[1])==="$type"?K=K.concat(Bu({key:O+"["+le+"]",value:P[le],valueSpec:$.geometry_type,style:v.style,styleSpec:v.styleSpec})):j!=="string"&&j!=="number"&&j!=="boolean"&&K.push(new Le(O+"["+le+"]",P[le],"string, number, or boolean expected, "+j+" found"));break;case"any":case"all":case"none":for(var me=1;me<P.length;me++)K=K.concat(d({key:O+"["+me+"]",value:P[me],style:v.style,styleSpec:v.styleSpec}));break;case"has":case"!has":j=Go(P[1]),P.length!==2?K.push(new Le(O,P,'filter array for "'+P[0]+'" operator must have 2 elements')):j!=="string"&&K.push(new Le(O+"[1]",P[1],"string expected, "+j+" found"));break;case"within":j=Go(P[1]),P.length!==2?K.push(new Le(O,P,'filter array for "'+P[0]+'" operator must have 2 elements')):j!=="object"&&K.push(new Le(O+"[1]",P[1],"object expected, "+j+" found"))}return K}(l)}function Fu(l,d){var v=l.key,P=l.style,O=l.styleSpec,j=l.value,$=l.objectKey,K=O[d+"_"+l.layerType];if(!K)return[];var le=$.match(/^(.*)-transition$/);if(d==="paint"&&le&&K[le[1]]&&K[le[1]].transition)return co({key:v,value:j,valueSpec:O.transition,style:P,styleSpec:O});var me,be=l.valueSpec||K[$];if(!be)return[new Le(v,j,'unknown property "'+$+'"')];if(Go(j)==="string"&&jc(be)&&!be.tokens&&(me=/^{([^}]+)}$/.exec(j)))return[new Le(v,j,'"'+$+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(me[1])+" }`.")];var Ie=[];return l.layerType==="symbol"&&($==="text-field"&&P&&!P.glyphs&&Ie.push(new Le(v,j,'use of "text-field" requires a style "glyphs" property')),$==="text-font"&&fc(bt(j))&&Ot(j.type)==="identity"&&Ie.push(new Le(v,j,'"text-font" does not support identity functions'))),Ie.concat(co({key:l.key,value:j,valueSpec:be,style:P,styleSpec:O,expressionContext:"property",propertyType:d,propertyKey:$}))}function Vu(l){return Fu(l,"paint")}function hu(l){return Fu(l,"layout")}function gd(l){var d=[],v=l.value,P=l.key,O=l.style,j=l.styleSpec;v.type||v.ref||d.push(new Le(P,v,'either "type" or "ref" is required'));var $,K=Ot(v.type),le=Ot(v.ref);if(v.id)for(var me=Ot(v.id),be=0;be<l.arrayIndex;be++){var Ie=O.layers[be];Ot(Ie.id)===me&&d.push(new Le(P,v.id,'duplicate layer id "'+v.id+'", previously used at line '+Ie.id.__line__))}if("ref"in v)["type","source","source-layer","filter","layout"].forEach(function(ct){ct in v&&d.push(new Le(P,v[ct],'"'+ct+'" is prohibited for ref layers'))}),O.layers.forEach(function(ct){Ot(ct.id)===le&&($=ct)}),$?$.ref?d.push(new Le(P,v.ref,"ref cannot reference another ref layer")):K=Ot($.type):d.push(new Le(P,v.ref,'ref layer "'+le+'" not found'));else if(K!=="background")if(v.source){var je=O.sources&&O.sources[v.source],Ye=je&&Ot(je.type);je?Ye==="vector"&&K==="raster"?d.push(new Le(P,v.source,'layer "'+v.id+'" requires a raster source')):Ye==="raster"&&K!=="raster"?d.push(new Le(P,v.source,'layer "'+v.id+'" requires a vector source')):Ye!=="vector"||v["source-layer"]?Ye==="raster-dem"&&K!=="hillshade"?d.push(new Le(P,v.source,"raster-dem source can only be used with layer type 'hillshade'.")):K!=="line"||!v.paint||!v.paint["line-gradient"]||Ye==="geojson"&&je.lineMetrics||d.push(new Le(P,v,'layer "'+v.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new Le(P,v,'layer "'+v.id+'" must specify a "source-layer"')):d.push(new Le(P,v.source,'source "'+v.source+'" not found'))}else d.push(new Le(P,v,'missing required property "source"'));return d=d.concat(gc({key:P,value:v,valueSpec:j.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return co({key:P+".type",value:v.type,valueSpec:j.layer.type,style:l.style,styleSpec:l.styleSpec,object:v,objectKey:"type"})},filter:wh,layout:function(ct){return gc({layer:v,key:ct.key,value:ct.value,style:ct.style,styleSpec:ct.styleSpec,objectElementValidators:{"*":function(dt){return hu(Mt({layerType:K},dt))}}})},paint:function(ct){return gc({layer:v,key:ct.key,value:ct.value,style:ct.style,styleSpec:ct.styleSpec,objectElementValidators:{"*":function(dt){return Vu(Mt({layerType:K},dt))}}})}}}))}function Aa(l){var d=l.value,v=l.key,P=Go(d);return P!=="string"?[new Le(v,d,"string expected, "+P+" found")]:[]}var Oo={promoteId:function(l){var d=l.key,v=l.value;if(Go(v)==="string")return Aa({key:d,value:v});var P=[];for(var O in v)P.push.apply(P,Aa({key:d+"."+O,value:v[O]}));return P}};function Is(l){var d=l.value,v=l.key,P=l.styleSpec,O=l.style;if(!d.type)return[new Le(v,d,'"type" is required')];var j,$=Ot(d.type);switch($){case"vector":case"raster":case"raster-dem":return gc({key:v,value:d,valueSpec:P["source_"+$.replace("-","_")],style:l.style,styleSpec:P,objectElementValidators:Oo});case"geojson":if(j=gc({key:v,value:d,valueSpec:P.source_geojson,style:O,styleSpec:P,objectElementValidators:Oo}),d.cluster)for(var K in d.clusterProperties){var le=d.clusterProperties[K],me=le[0],be=typeof me=="string"?[me,["accumulated"],["get",K]]:me;j.push.apply(j,bh({key:v+"."+K+".map",value:le[1],expressionContext:"cluster-map"})),j.push.apply(j,bh({key:v+"."+K+".reduce",value:be,expressionContext:"cluster-reduce"}))}return j;case"video":return gc({key:v,value:d,valueSpec:P.source_video,style:O,styleSpec:P});case"image":return gc({key:v,value:d,valueSpec:P.source_image,style:O,styleSpec:P});case"canvas":return[new Le(v,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bu({key:v+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:O,styleSpec:P})}}function du(l){var d=l.value,v=l.styleSpec,P=v.light,O=l.style,j=[],$=Go(d);if(d===void 0)return j;if($!=="object")return j.concat([new Le("light",d,"object expected, "+$+" found")]);for(var K in d){var le=K.match(/^(.*)-transition$/);j=j.concat(le&&P[le[1]]&&P[le[1]].transition?co({key:K,value:d[K],valueSpec:v.transition,style:O,styleSpec:v}):P[K]?co({key:K,value:d[K],valueSpec:P[K],style:O,styleSpec:v}):[new Le(K,d[K],'unknown property "'+K+'"')])}return j}var pu={"*":function(){return[]},array:Bm,boolean:function(l){var d=l.value,v=l.key,P=Go(d);return P!=="boolean"?[new Le(v,d,"boolean expected, "+P+" found")]:[]},number:Bf,color:function(l){var d=l.key,v=l.value,P=Go(v);return P!=="string"?[new Le(d,v,"color expected, "+P+" found")]:Ni(v)===null?[new Le(d,v,'color expected, "'+v+'" found')]:[]},constants:ot,enum:Bu,filter:wh,function:ud,layer:gd,object:gc,source:Is,light:du,string:Aa,formatted:function(l){return Aa(l).length===0?[]:bh(l)},resolvedImage:function(l){return Aa(l).length===0?[]:bh(l)}};function co(l){var d=l.value,v=l.valueSpec,P=l.styleSpec;return v.expression&&fc(Ot(d))?ud(l):v.expression&&Bc(bt(d))?bh(l):v.type&&pu[v.type]?pu[v.type](l):gc(Mt({},l,{valueSpec:v.type?P[v.type]:v}))}function ko(l){var d=l.value,v=l.key,P=Aa(l);return P.length||(d.indexOf("{fontstack}")===-1&&P.push(new Le(v,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&P.push(new Le(v,d,'"glyphs" url must include a "{range}" token'))),P}function Hs(l,d){d===void 0&&(d=ve);var v=[];return v=v.concat(co({key:"",value:l,valueSpec:d.$root,styleSpec:d,style:l,objectElementValidators:{glyphs:ko,"*":function(){return[]}}})),l.constants&&(v=v.concat(ot({key:"constants",value:l.constants,style:l,styleSpec:d}))),fu(v)}function fu(l){return[].concat(l).sort(function(d,v){return d.line-v.line})}function Sh(l){return function(){for(var d=[],v=arguments.length;v--;)d[v]=arguments[v];return fu(l.apply(this,d))}}Hs.source=Sh(Is),Hs.light=Sh(du),Hs.layer=Sh(gd),Hs.filter=Sh(wh),Hs.paintProperty=Sh(Vu),Hs.layoutProperty=Sh(hu);var Kl=Hs,Fm=Kl.light,_d=Kl.paintProperty,Th=Kl.layoutProperty;function yd(l,d){var v=!1;if(d&&d.length)for(var P=0,O=d;P<O.length;P+=1)l.fire(new wt(new Error(O[P].message))),v=!0;return v}var mu=qo;function qo(l,d,v){var P=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var O=new Int32Array(this.arrayBuffer);l=O[0],this.d=(d=O[1])+2*(v=O[2]);for(var j=0;j<this.d*this.d;j++){var $=O[3+j],K=O[3+j+1];P.push($===K?null:O.subarray($,K))}var le=O[3+P.length+1];this.keys=O.subarray(O[3+P.length],le),this.bboxes=O.subarray(le),this.insert=this._insertReadonly}else{this.d=d+2*v;for(var me=0;me<this.d*this.d;me++)P.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=l,this.padding=v,this.scale=d/l,this.uid=0;var be=v/d*l;this.min=-be,this.max=l+be}qo.prototype.insert=function(l,d,v,P,O){this._forEachCell(d,v,P,O,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(P),this.bboxes.push(O)},qo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},qo.prototype._insertCell=function(l,d,v,P,O,j){this.cells[O].push(j)},qo.prototype.query=function(l,d,v,P,O){var j=this.min,$=this.max;if(l<=j&&d<=j&&$<=v&&$<=P&&!O)return Array.prototype.slice.call(this.keys);var K=[];return this._forEachCell(l,d,v,P,this._queryCell,K,{},O),K},qo.prototype._queryCell=function(l,d,v,P,O,j,$,K){var le=this.cells[O];if(le!==null)for(var me=this.keys,be=this.bboxes,Ie=0;Ie<le.length;Ie++){var je=le[Ie];if($[je]===void 0){var Ye=4*je;(K?K(be[Ye+0],be[Ye+1],be[Ye+2],be[Ye+3]):l<=be[Ye+2]&&d<=be[Ye+3]&&v>=be[Ye+0]&&P>=be[Ye+1])?($[je]=!0,j.push(me[je])):$[je]=!1}}},qo.prototype._forEachCell=function(l,d,v,P,O,j,$,K){for(var le=this._convertToCellCoord(l),me=this._convertToCellCoord(d),be=this._convertToCellCoord(v),Ie=this._convertToCellCoord(P),je=le;je<=be;je++)for(var Ye=me;Ye<=Ie;Ye++){var ct=this.d*Ye+je;if((!K||K(this._convertFromCellCoord(je),this._convertFromCellCoord(Ye),this._convertFromCellCoord(je+1),this._convertFromCellCoord(Ye+1)))&&O.call(this,l,d,v,P,ct,j,$,K))return}},qo.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},qo.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},qo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,d=3+this.cells.length+1+1,v=0,P=0;P<this.cells.length;P++)v+=this.cells[P].length;var O=new Int32Array(d+v+this.keys.length+this.bboxes.length);O[0]=this.extent,O[1]=this.n,O[2]=this.padding;for(var j=d,$=0;$<l.length;$++){var K=l[$];O[3+$]=j,O.set(K,j),j+=K.length}return O[3+l.length]=j,O.set(this.keys,j),O[3+l.length+1]=j+=this.keys.length,O.set(this.bboxes,j),j+=this.bboxes.length,O.buffer};var Uu=X.ImageData,op=X.ImageBitmap,xa={};function Rn(l,d,v){v===void 0&&(v={}),Object.defineProperty(d,"_classRegistryKey",{value:l,writeable:!1}),xa[l]={klass:d,omit:v.omit||[],shallow:v.shallow||[]}}for(var Zs in Rn("Object",Object),mu.serialize=function(l,d){var v=l.toArrayBuffer();return d&&d.push(v),{buffer:v}},mu.deserialize=function(l){return new mu(l.buffer)},Rn("Grid",mu),Rn("Color",qi),Rn("Error",Error),Rn("ResolvedImage",Ho),Rn("StylePropertyFunction",cd),Rn("StyleExpression",sd,{omit:["_evaluator"]}),Rn("ZoomDependentExpression",xh),Rn("ZoomConstantExpression",ld),Rn("CompoundExpression",Oe,{omit:["_evaluate"]}),Yl)Yl[Zs]._classRegistryKey||Rn("Expression_"+Zs,Yl[Zs]);function vd(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Eh(l){return op&&l instanceof op}function Xs(l,d){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(vd(l)||Eh(l))return d&&d.push(l),l;if(ArrayBuffer.isView(l)){var v=l;return d&&d.push(v.buffer),v}if(l instanceof Uu)return d&&d.push(l.data.buffer),l;if(Array.isArray(l)){for(var P=[],O=0,j=l;O<j.length;O+=1)P.push(Xs(j[O],d));return P}if(typeof l=="object"){var $=l.constructor,K=$._classRegistryKey;if(!K)throw new Error("can't serialize object of unregistered class");var le=$.serialize?$.serialize(l,d):{};if(!$.serialize){for(var me in l)if(l.hasOwnProperty(me)&&!(xa[K].omit.indexOf(me)>=0)){var be=l[me];le[me]=xa[K].shallow.indexOf(me)>=0?be:Xs(be,d)}l instanceof Error&&(le.message=l.message)}if(le.$name)throw new Error("$name property is reserved for worker serialization logic.");return K!=="Object"&&(le.$name=K),le}throw new Error("can't serialize object of type "+typeof l)}function gs(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||vd(l)||Eh(l)||ArrayBuffer.isView(l)||l instanceof Uu)return l;if(Array.isArray(l))return l.map(gs);if(typeof l=="object"){var d=l.$name||"Object",v=xa[d].klass;if(!v)throw new Error("can't deserialize unregistered class "+d);if(v.deserialize)return v.deserialize(l);for(var P=Object.create(v.prototype),O=0,j=Object.keys(l);O<j.length;O+=1){var $=j[O];if($!=="$name"){var K=l[$];P[$]=xa[d].shallow.indexOf($)>=0?K:gs(K)}}return P}throw new Error("can't deserialize object of type "+typeof l)}var ap=function(){this.first=!0};ap.prototype.update=function(l,d){var v=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=v,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=v,!0):(this.lastFloorZoom>v?(this.lastIntegerZoom=v+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<v&&(this.lastIntegerZoom=v,this.lastIntegerZoomTime=d),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=v,!0))};var un={"Latin-1 Supplement":function(l){return l>=128&&l<=255},Arabic:function(l){return l>=1536&&l<=1791},"Arabic Supplement":function(l){return l>=1872&&l<=1919},"Arabic Extended-A":function(l){return l>=2208&&l<=2303},"Hangul Jamo":function(l){return l>=4352&&l<=4607},"Unified Canadian Aboriginal Syllabics":function(l){return l>=5120&&l<=5759},Khmer:function(l){return l>=6016&&l<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(l){return l>=6320&&l<=6399},"General Punctuation":function(l){return l>=8192&&l<=8303},"Letterlike Symbols":function(l){return l>=8448&&l<=8527},"Number Forms":function(l){return l>=8528&&l<=8591},"Miscellaneous Technical":function(l){return l>=8960&&l<=9215},"Control Pictures":function(l){return l>=9216&&l<=9279},"Optical Character Recognition":function(l){return l>=9280&&l<=9311},"Enclosed Alphanumerics":function(l){return l>=9312&&l<=9471},"Geometric Shapes":function(l){return l>=9632&&l<=9727},"Miscellaneous Symbols":function(l){return l>=9728&&l<=9983},"Miscellaneous Symbols and Arrows":function(l){return l>=11008&&l<=11263},"CJK Radicals Supplement":function(l){return l>=11904&&l<=12031},"Kangxi Radicals":function(l){return l>=12032&&l<=12255},"Ideographic Description Characters":function(l){return l>=12272&&l<=12287},"CJK Symbols and Punctuation":function(l){return l>=12288&&l<=12351},Hiragana:function(l){return l>=12352&&l<=12447},Katakana:function(l){return l>=12448&&l<=12543},Bopomofo:function(l){return l>=12544&&l<=12591},"Hangul Compatibility Jamo":function(l){return l>=12592&&l<=12687},Kanbun:function(l){return l>=12688&&l<=12703},"Bopomofo Extended":function(l){return l>=12704&&l<=12735},"CJK Strokes":function(l){return l>=12736&&l<=12783},"Katakana Phonetic Extensions":function(l){return l>=12784&&l<=12799},"Enclosed CJK Letters and Months":function(l){return l>=12800&&l<=13055},"CJK Compatibility":function(l){return l>=13056&&l<=13311},"CJK Unified Ideographs Extension A":function(l){return l>=13312&&l<=19903},"Yijing Hexagram Symbols":function(l){return l>=19904&&l<=19967},"CJK Unified Ideographs":function(l){return l>=19968&&l<=40959},"Yi Syllables":function(l){return l>=40960&&l<=42127},"Yi Radicals":function(l){return l>=42128&&l<=42191},"Hangul Jamo Extended-A":function(l){return l>=43360&&l<=43391},"Hangul Syllables":function(l){return l>=44032&&l<=55215},"Hangul Jamo Extended-B":function(l){return l>=55216&&l<=55295},"Private Use Area":function(l){return l>=57344&&l<=63743},"CJK Compatibility Ideographs":function(l){return l>=63744&&l<=64255},"Arabic Presentation Forms-A":function(l){return l>=64336&&l<=65023},"Vertical Forms":function(l){return l>=65040&&l<=65055},"CJK Compatibility Forms":function(l){return l>=65072&&l<=65103},"Small Form Variants":function(l){return l>=65104&&l<=65135},"Arabic Presentation Forms-B":function(l){return l>=65136&&l<=65279},"Halfwidth and Fullwidth Forms":function(l){return l>=65280&&l<=65519}};function $u(l){for(var d=0,v=l;d<v.length;d+=1)if(Ys(v[d].charCodeAt(0)))return!0;return!1}function Ys(l){return!(l!==746&&l!==747&&(l<4352||!(un["Bopomofo Extended"](l)||un.Bopomofo(l)||un["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||un["CJK Compatibility Ideographs"](l)||un["CJK Compatibility"](l)||un["CJK Radicals Supplement"](l)||un["CJK Strokes"](l)||!(!un["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||un["CJK Unified Ideographs Extension A"](l)||un["CJK Unified Ideographs"](l)||un["Enclosed CJK Letters and Months"](l)||un["Hangul Compatibility Jamo"](l)||un["Hangul Jamo Extended-A"](l)||un["Hangul Jamo Extended-B"](l)||un["Hangul Jamo"](l)||un["Hangul Syllables"](l)||un.Hiragana(l)||un["Ideographic Description Characters"](l)||un.Kanbun(l)||un["Kangxi Radicals"](l)||un["Katakana Phonetic Extensions"](l)||un.Katakana(l)&&l!==12540||!(!un["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!un["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||un["Unified Canadian Aboriginal Syllabics"](l)||un["Unified Canadian Aboriginal Syllabics Extended"](l)||un["Vertical Forms"](l)||un["Yijing Hexagram Symbols"](l)||un["Yi Syllables"](l)||un["Yi Radicals"](l))))}function Gu(l){return!(Ys(l)||function(d){return!!(un["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||un["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||un["Letterlike Symbols"](d)||un["Number Forms"](d)||un["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||un["Control Pictures"](d)&&d!==9251||un["Optical Character Recognition"](d)||un["Enclosed Alphanumerics"](d)||un["Geometric Shapes"](d)||un["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||un["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||un["CJK Symbols and Punctuation"](d)||un.Katakana(d)||un["Private Use Area"](d)||un["CJK Compatibility Forms"](d)||un["Small Form Variants"](d)||un["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(l))}function xl(l){return l>=1424&&l<=2303||un["Arabic Presentation Forms-A"](l)||un["Arabic Presentation Forms-B"](l)}function Ls(l,d){return!(!d&&xl(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||un.Khmer(l))}function xd(l){for(var d=0,v=l;d<v.length;d+=1)if(xl(v[d].charCodeAt(0)))return!0;return!1}var _c=null,Si="unavailable",yc=null,Vm=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(Si="error"),_c&&_c(l)};function qu(){Jp.fire(new it("pluginStateChange",{pluginStatus:Si,pluginURL:yc}))}var Jp=new $e,sp=function(){return Si},Jl=function(){if(Si!=="deferred"||!yc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Si="loading",qu(),yc&&mo({url:yc},function(l){l?Vm(l):(Si="loaded",qu())})},Ks={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Si==="loaded"||Ks.applyArabicShaping!=null},isLoading:function(){return Si==="loading"},setState:function(l){Si=l.pluginStatus,yc=l.pluginURL},isParsed:function(){return Ks.applyArabicShaping!=null&&Ks.processBidirectionalText!=null&&Ks.processStyledBidirectionalText!=null},getPluginURL:function(){return yc}},oo=function(l,d){this.zoom=l,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ap,this.transition={})};oo.prototype.isSupportedScript=function(l){return function(d,v){for(var P=0,O=d;P<O.length;P+=1)if(!Ls(O[P].charCodeAt(0),v))return!1;return!0}(l,Ks.isLoaded())},oo.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},oo.prototype.getCrossfadeParameters=function(){var l=this.zoom,d=l-Math.floor(l),v=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*v}:{fromScale:.5,toScale:1,t:1-(1-v)*d}};var bl=function(l,d){this.property=l,this.value=d,this.expression=function(v,P){if(fc(v))return new cd(v,P);if(Bc(v)){var O=Xp(v,P);if(O.result==="error")throw new Error(O.value.map(function($){return $.key+": "+$.message}).join(", "));return O.value}var j=v;return typeof v=="string"&&P.type==="color"&&(j=qi.parse(v)),{kind:"constant",evaluate:function(){return j}}}(d===void 0?l.specification.default:d,l.specification)};bl.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},bl.prototype.possiblyEvaluate=function(l,d,v){return this.property.possiblyEvaluate(this,l,d,v)};var zs=function(l){this.property=l,this.value=new bl(l,void 0)};zs.prototype.transitioned=function(l,d){return new gu(this.property,this.value,d,ce({},l.transition,this.transition),l.now)},zs.prototype.untransitioned=function(){return new gu(this.property,this.value,null,{},0)};var ns=function(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)};ns.prototype.getValue=function(l){return Et(this._values[l].value.value)},ns.prototype.setValue=function(l,d){this._values.hasOwnProperty(l)||(this._values[l]=new zs(this._values[l].property)),this._values[l].value=new bl(this._values[l].property,d===null?void 0:Et(d))},ns.prototype.getTransition=function(l){return Et(this._values[l].transition)},ns.prototype.setTransition=function(l,d){this._values.hasOwnProperty(l)||(this._values[l]=new zs(this._values[l].property)),this._values[l].transition=Et(d)||void 0},ns.prototype.serialize=function(){for(var l={},d=0,v=Object.keys(this._values);d<v.length;d+=1){var P=v[d],O=this.getValue(P);O!==void 0&&(l[P]=O);var j=this.getTransition(P);j!==void 0&&(l[P+"-transition"]=j)}return l},ns.prototype.transitioned=function(l,d){for(var v=new Ll(this._properties),P=0,O=Object.keys(this._values);P<O.length;P+=1){var j=O[P];v._values[j]=this._values[j].transitioned(l,d._values[j])}return v},ns.prototype.untransitioned=function(){for(var l=new Ll(this._properties),d=0,v=Object.keys(this._values);d<v.length;d+=1){var P=v[d];l._values[P]=this._values[P].untransitioned()}return l};var gu=function(l,d,v,P,O){this.property=l,this.value=d,this.begin=O+P.delay||0,this.end=this.begin+P.duration||0,l.specification.transition&&(P.delay||P.duration)&&(this.prior=v)};gu.prototype.possiblyEvaluate=function(l,d,v){var P=l.now||0,O=this.value.possiblyEvaluate(l,d,v),j=this.prior;if(j){if(P>this.end)return this.prior=null,O;if(this.value.isDataDriven())return this.prior=null,O;if(P<this.begin)return j.possiblyEvaluate(l,d,v);var $=(P-this.begin)/(this.end-this.begin);return this.property.interpolate(j.possiblyEvaluate(l,d,v),O,function(K){if(K<=0)return 0;if(K>=1)return 1;var le=K*K,me=le*K;return 4*(K<.5?me:3*(K-le)+me-.75)}($))}return O};var Ll=function(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)};Ll.prototype.possiblyEvaluate=function(l,d,v){for(var P=new lp(this._properties),O=0,j=Object.keys(this._values);O<j.length;O+=1){var $=j[O];P._values[$]=this._values[$].possiblyEvaluate(l,d,v)}return P},Ll.prototype.hasTransition=function(){for(var l=0,d=Object.keys(this._values);l<d.length;l+=1)if(this._values[d[l]].prior)return!0;return!1};var zl=function(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)};zl.prototype.getValue=function(l){return Et(this._values[l].value)},zl.prototype.setValue=function(l,d){this._values[l]=new bl(this._values[l].property,d===null?void 0:Et(d))},zl.prototype.serialize=function(){for(var l={},d=0,v=Object.keys(this._values);d<v.length;d+=1){var P=v[d],O=this.getValue(P);O!==void 0&&(l[P]=O)}return l},zl.prototype.possiblyEvaluate=function(l,d,v){for(var P=new lp(this._properties),O=0,j=Object.keys(this._values);O<j.length;O+=1){var $=j[O];P._values[$]=this._values[$].possiblyEvaluate(l,d,v)}return P};var Cs=function(l,d,v){this.property=l,this.value=d,this.parameters=v};Cs.prototype.isConstant=function(){return this.value.kind==="constant"},Cs.prototype.constantOr=function(l){return this.value.kind==="constant"?this.value.value:l},Cs.prototype.evaluate=function(l,d,v,P){return this.property.evaluate(this.value,this.parameters,l,d,v,P)};var lp=function(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)};lp.prototype.get=function(l){return this._values[l]};var Kn=function(l){this.specification=l};Kn.prototype.possiblyEvaluate=function(l,d){return l.expression.evaluate(d)},Kn.prototype.interpolate=function(l,d,v){var P=Ru[this.specification.type];return P?P(l,d,v):l};var Bn=function(l,d){this.specification=l,this.overrides=d};Bn.prototype.possiblyEvaluate=function(l,d,v,P){return new Cs(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(d,null,{},v,P)}:l.expression,d)},Bn.prototype.interpolate=function(l,d,v){if(l.value.kind!=="constant"||d.value.kind!=="constant")return l;if(l.value.value===void 0||d.value.value===void 0)return new Cs(this,{kind:"constant",value:void 0},l.parameters);var P=Ru[this.specification.type];return P?new Cs(this,{kind:"constant",value:P(l.value.value,d.value.value,v)},l.parameters):l},Bn.prototype.evaluate=function(l,d,v,P,O,j){return l.kind==="constant"?l.value:l.evaluate(d,v,P,O,j)};var Qp=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(v,P,O,j){if(v.value===void 0)return new Cs(this,{kind:"constant",value:void 0},P);if(v.expression.kind==="constant"){var $=v.expression.evaluate(P,null,{},O,j),K=v.property.specification.type==="resolvedImage"&&typeof $!="string"?$.name:$,le=this._calculate(K,K,K,P);return new Cs(this,{kind:"constant",value:le},P)}if(v.expression.kind==="camera"){var me=this._calculate(v.expression.evaluate({zoom:P.zoom-1}),v.expression.evaluate({zoom:P.zoom}),v.expression.evaluate({zoom:P.zoom+1}),P);return new Cs(this,{kind:"constant",value:me},P)}return new Cs(this,v.expression,P)},d.prototype.evaluate=function(v,P,O,j,$,K){if(v.kind==="source"){var le=v.evaluate(P,O,j,$,K);return this._calculate(le,le,le,P)}return v.kind==="composite"?this._calculate(v.evaluate({zoom:Math.floor(P.zoom)-1},O,j),v.evaluate({zoom:Math.floor(P.zoom)},O,j),v.evaluate({zoom:Math.floor(P.zoom)+1},O,j),P):v.value},d.prototype._calculate=function(v,P,O,j){return j.zoom>j.zoomHistory.lastIntegerZoom?{from:v,to:P}:{from:O,to:P}},d.prototype.interpolate=function(v){return v},d}(Bn),As=function(l){this.specification=l};As.prototype.possiblyEvaluate=function(l,d,v,P){if(l.value!==void 0){if(l.expression.kind==="constant"){var O=l.expression.evaluate(d,null,{},v,P);return this._calculate(O,O,O,d)}return this._calculate(l.expression.evaluate(new oo(Math.floor(d.zoom-1),d)),l.expression.evaluate(new oo(Math.floor(d.zoom),d)),l.expression.evaluate(new oo(Math.floor(d.zoom+1),d)),d)}},As.prototype._calculate=function(l,d,v,P){return P.zoom>P.zoomHistory.lastIntegerZoom?{from:l,to:d}:{from:v,to:d}},As.prototype.interpolate=function(l){return l};var Nl=function(l){this.specification=l};Nl.prototype.possiblyEvaluate=function(l,d,v,P){return!!l.expression.evaluate(d,null,{},v,P)},Nl.prototype.interpolate=function(){return!1};var _s=function(l){for(var d in this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],l){var v=l[d];v.specification.overridable&&this.overridableProperties.push(d);var P=this.defaultPropertyValues[d]=new bl(v,void 0),O=this.defaultTransitionablePropertyValues[d]=new zs(v);this.defaultTransitioningPropertyValues[d]=O.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=P.possiblyEvaluate({})}};Rn("DataDrivenProperty",Bn),Rn("DataConstantProperty",Kn),Rn("CrossFadedDataDrivenProperty",Qp),Rn("CrossFadedProperty",As),Rn("ColorRampProperty",Nl);var Ql=function(l){function d(v,P){if(l.call(this),this.id=v.id,this.type=v.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},v.type!=="custom"&&(this.metadata=(v=v).metadata,this.minzoom=v.minzoom,this.maxzoom=v.maxzoom,v.type!=="background"&&(this.source=v.source,this.sourceLayer=v["source-layer"],this.filter=v.filter),P.layout&&(this._unevaluatedLayout=new zl(P.layout)),P.paint)){for(var O in this._transitionablePaint=new ns(P.paint),v.paint)this.setPaintProperty(O,v.paint[O],{validate:!1});for(var j in v.layout)this.setLayoutProperty(j,v.layout[j],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lp(P.paint)}}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(v){return v==="visibility"?this.visibility:this._unevaluatedLayout.getValue(v)},d.prototype.setLayoutProperty=function(v,P,O){O===void 0&&(O={}),P!=null&&this._validate(Th,"layers."+this.id+".layout."+v,v,P,O)||(v!=="visibility"?this._unevaluatedLayout.setValue(v,P):this.visibility=P)},d.prototype.getPaintProperty=function(v){return Ge(v,"-transition")?this._transitionablePaint.getTransition(v.slice(0,-11)):this._transitionablePaint.getValue(v)},d.prototype.setPaintProperty=function(v,P,O){if(O===void 0&&(O={}),P!=null&&this._validate(_d,"layers."+this.id+".paint."+v,v,P,O))return!1;if(Ge(v,"-transition"))return this._transitionablePaint.setTransition(v.slice(0,-11),P||void 0),!1;var j=this._transitionablePaint._values[v],$=j.property.specification["property-type"]==="cross-faded-data-driven",K=j.value.isDataDriven(),le=j.value;this._transitionablePaint.setValue(v,P),this._handleSpecialPaintPropertyUpdate(v);var me=this._transitionablePaint._values[v].value;return me.isDataDriven()||K||$||this._handleOverridablePaintPropertyUpdate(v,le,me)},d.prototype._handleSpecialPaintPropertyUpdate=function(v){},d.prototype._handleOverridablePaintPropertyUpdate=function(v,P,O){return!1},d.prototype.isHidden=function(v){return!!(this.minzoom&&v<this.minzoom)||!!(this.maxzoom&&v>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(v){this._transitioningPaint=this._transitionablePaint.transitioned(v,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(v,P){v.getCrossfadeParameters&&(this._crossfadeParameters=v.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(v,void 0,P)),this.paint=this._transitioningPaint.possiblyEvaluate(v,void 0,P)},d.prototype.serialize=function(){var v={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(v.layout=v.layout||{},v.layout.visibility=this.visibility),yt(v,function(P,O){return!(P===void 0||O==="layout"&&!Object.keys(P).length||O==="paint"&&!Object.keys(P).length)})},d.prototype._validate=function(v,P,O,j,$){return $===void 0&&($={}),(!$||$.validate!==!1)&&yd(this,v.call(Kl,{key:P,layerType:this.type,objectKey:O,value:j,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var v in this.paint._values){var P=this.paint.get(v);if(P instanceof Cs&&jc(P.property.specification)&&(P.value.kind==="source"||P.value.kind==="composite")&&P.value.isStateDependent)return!0}return!1},d}($e),cp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},up=function(l,d){this._structArray=l,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Mo=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ya(l,d){d===void 0&&(d=1);var v=0,P=0;return{members:l.map(function(O){var j=cp[O.type].BYTES_PER_ELEMENT,$=v=Wu(v,Math.max(d,j)),K=O.components||1;return P=Math.max(P,j),v+=j*K,{name:O.name,type:O.type,components:K,offset:$}}),size:Wu(v,Math.max(P,d)),alignment:d}}function Wu(l,d){return Math.ceil(l/d)*d}Mo.serialize=function(l,d){return l._trim(),d&&(l.isTransferred=!0,d.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}},Mo.deserialize=function(l){var d=Object.create(this.prototype);return d.arrayBuffer=l.arrayBuffer,d.length=l.length,d.capacity=l.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},Mo.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Mo.prototype.clear=function(){this.length=0},Mo.prototype.resize=function(l){this.reserve(l),this.length=l},Mo.prototype.reserve=function(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},Mo.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var ec=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P){var O=this.length;return this.resize(O+1),this.emplace(O,v,P)},d.prototype.emplace=function(v,P,O){var j=2*v;return this.int16[j+0]=P,this.int16[j+1]=O,v},d}(Mo);ec.prototype.bytesPerElement=4,Rn("StructArrayLayout2i4",ec);var hp=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j){var $=this.length;return this.resize($+1),this.emplace($,v,P,O,j)},d.prototype.emplace=function(v,P,O,j,$){var K=4*v;return this.int16[K+0]=P,this.int16[K+1]=O,this.int16[K+2]=j,this.int16[K+3]=$,v},d}(Mo);hp.prototype.bytesPerElement=8,Rn("StructArrayLayout4i8",hp);var ll=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K){var le=this.length;return this.resize(le+1),this.emplace(le,v,P,O,j,$,K)},d.prototype.emplace=function(v,P,O,j,$,K,le){var me=6*v;return this.int16[me+0]=P,this.int16[me+1]=O,this.int16[me+2]=j,this.int16[me+3]=$,this.int16[me+4]=K,this.int16[me+5]=le,v},d}(Mo);ll.prototype.bytesPerElement=12,Rn("StructArrayLayout2i4i12",ll);var cl=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K){var le=this.length;return this.resize(le+1),this.emplace(le,v,P,O,j,$,K)},d.prototype.emplace=function(v,P,O,j,$,K,le){var me=4*v,be=8*v;return this.int16[me+0]=P,this.int16[me+1]=O,this.uint8[be+4]=j,this.uint8[be+5]=$,this.uint8[be+6]=K,this.uint8[be+7]=le,v},d}(Mo);cl.prototype.bytesPerElement=8,Rn("StructArrayLayout2i4ub8",cl);var _u=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P){var O=this.length;return this.resize(O+1),this.emplace(O,v,P)},d.prototype.emplace=function(v,P,O){var j=2*v;return this.float32[j+0]=P,this.float32[j+1]=O,v},d}(Mo);_u.prototype.bytesPerElement=8,Rn("StructArrayLayout2f8",_u);var tc=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K,le,me,be,Ie){var je=this.length;return this.resize(je+1),this.emplace(je,v,P,O,j,$,K,le,me,be,Ie)},d.prototype.emplace=function(v,P,O,j,$,K,le,me,be,Ie,je){var Ye=10*v;return this.uint16[Ye+0]=P,this.uint16[Ye+1]=O,this.uint16[Ye+2]=j,this.uint16[Ye+3]=$,this.uint16[Ye+4]=K,this.uint16[Ye+5]=le,this.uint16[Ye+6]=me,this.uint16[Ye+7]=be,this.uint16[Ye+8]=Ie,this.uint16[Ye+9]=je,v},d}(Mo);tc.prototype.bytesPerElement=20,Rn("StructArrayLayout10ui20",tc);var dp=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye){var ct=this.length;return this.resize(ct+1),this.emplace(ct,v,P,O,j,$,K,le,me,be,Ie,je,Ye)},d.prototype.emplace=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct){var dt=12*v;return this.int16[dt+0]=P,this.int16[dt+1]=O,this.int16[dt+2]=j,this.int16[dt+3]=$,this.uint16[dt+4]=K,this.uint16[dt+5]=le,this.uint16[dt+6]=me,this.uint16[dt+7]=be,this.int16[dt+8]=Ie,this.int16[dt+9]=je,this.int16[dt+10]=Ye,this.int16[dt+11]=ct,v},d}(Mo);dp.prototype.bytesPerElement=24,Rn("StructArrayLayout4i4ui4i24",dp);var Hu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O){var j=this.length;return this.resize(j+1),this.emplace(j,v,P,O)},d.prototype.emplace=function(v,P,O,j){var $=3*v;return this.float32[$+0]=P,this.float32[$+1]=O,this.float32[$+2]=j,v},d}(Mo);Hu.prototype.bytesPerElement=12,Rn("StructArrayLayout3f12",Hu);var Zu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v){var P=this.length;return this.resize(P+1),this.emplace(P,v)},d.prototype.emplace=function(v,P){return this.uint32[1*v+0]=P,v},d}(Mo);Zu.prototype.bytesPerElement=4,Rn("StructArrayLayout1ul4",Zu);var ef=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K,le,me,be){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,v,P,O,j,$,K,le,me,be)},d.prototype.emplace=function(v,P,O,j,$,K,le,me,be,Ie){var je=10*v,Ye=5*v;return this.int16[je+0]=P,this.int16[je+1]=O,this.int16[je+2]=j,this.int16[je+3]=$,this.int16[je+4]=K,this.int16[je+5]=le,this.uint32[Ye+3]=me,this.uint16[je+8]=be,this.uint16[je+9]=Ie,v},d}(Mo);ef.prototype.bytesPerElement=20,Rn("StructArrayLayout6i1ul2ui20",ef);var Xu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K){var le=this.length;return this.resize(le+1),this.emplace(le,v,P,O,j,$,K)},d.prototype.emplace=function(v,P,O,j,$,K,le){var me=6*v;return this.int16[me+0]=P,this.int16[me+1]=O,this.int16[me+2]=j,this.int16[me+3]=$,this.int16[me+4]=K,this.int16[me+5]=le,v},d}(Mo);Xu.prototype.bytesPerElement=12,Rn("StructArrayLayout2i2i2i12",Xu);var vc=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$){var K=this.length;return this.resize(K+1),this.emplace(K,v,P,O,j,$)},d.prototype.emplace=function(v,P,O,j,$,K){var le=4*v,me=8*v;return this.float32[le+0]=P,this.float32[le+1]=O,this.float32[le+2]=j,this.int16[me+6]=$,this.int16[me+7]=K,v},d}(Mo);vc.prototype.bytesPerElement=16,Rn("StructArrayLayout2f1f2i16",vc);var Ff=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j){var $=this.length;return this.resize($+1),this.emplace($,v,P,O,j)},d.prototype.emplace=function(v,P,O,j,$){var K=12*v,le=3*v;return this.uint8[K+0]=P,this.uint8[K+1]=O,this.float32[le+1]=j,this.float32[le+2]=$,v},d}(Mo);Ff.prototype.bytesPerElement=12,Rn("StructArrayLayout2ub2f12",Ff);var Yu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O){var j=this.length;return this.resize(j+1),this.emplace(j,v,P,O)},d.prototype.emplace=function(v,P,O,j){var $=3*v;return this.uint16[$+0]=P,this.uint16[$+1]=O,this.uint16[$+2]=j,v},d}(Mo);Yu.prototype.bytesPerElement=6,Rn("StructArrayLayout3ui6",Yu);var yu=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt){var or=this.length;return this.resize(or+1),this.emplace(or,v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt)},d.prototype.emplace=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt,or){var gr=24*v,yr=12*v,zr=48*v;return this.int16[gr+0]=P,this.int16[gr+1]=O,this.uint16[gr+2]=j,this.uint16[gr+3]=$,this.uint32[yr+2]=K,this.uint32[yr+3]=le,this.uint32[yr+4]=me,this.uint16[gr+10]=be,this.uint16[gr+11]=Ie,this.uint16[gr+12]=je,this.float32[yr+7]=Ye,this.float32[yr+8]=ct,this.uint8[zr+36]=dt,this.uint8[zr+37]=kt,this.uint8[zr+38]=St,this.uint32[yr+10]=Gt,this.int16[gr+22]=or,v},d}(Mo);yu.prototype.bytesPerElement=48,Rn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yu);var pp=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt,or,gr,yr,zr,Qr,nn,Zn,Tn,li,En,Qi){var Ai=this.length;return this.resize(Ai+1),this.emplace(Ai,v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt,or,gr,yr,zr,Qr,nn,Zn,Tn,li,En,Qi)},d.prototype.emplace=function(v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt,kt,St,Gt,or,gr,yr,zr,Qr,nn,Zn,Tn,li,En,Qi,Ai){var Mn=34*v,uo=17*v;return this.int16[Mn+0]=P,this.int16[Mn+1]=O,this.int16[Mn+2]=j,this.int16[Mn+3]=$,this.int16[Mn+4]=K,this.int16[Mn+5]=le,this.int16[Mn+6]=me,this.int16[Mn+7]=be,this.uint16[Mn+8]=Ie,this.uint16[Mn+9]=je,this.uint16[Mn+10]=Ye,this.uint16[Mn+11]=ct,this.uint16[Mn+12]=dt,this.uint16[Mn+13]=kt,this.uint16[Mn+14]=St,this.uint16[Mn+15]=Gt,this.uint16[Mn+16]=or,this.uint16[Mn+17]=gr,this.uint16[Mn+18]=yr,this.uint16[Mn+19]=zr,this.uint16[Mn+20]=Qr,this.uint16[Mn+21]=nn,this.uint16[Mn+22]=Zn,this.uint32[uo+12]=Tn,this.float32[uo+13]=li,this.float32[uo+14]=En,this.float32[uo+15]=Qi,this.float32[uo+16]=Ai,v},d}(Mo);pp.prototype.bytesPerElement=68,Rn("StructArrayLayout8i15ui1ul4f68",pp);var xc=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v){var P=this.length;return this.resize(P+1),this.emplace(P,v)},d.prototype.emplace=function(v,P){return this.float32[1*v+0]=P,v},d}(Mo);xc.prototype.bytesPerElement=4,Rn("StructArrayLayout1f4",xc);var Js=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O){var j=this.length;return this.resize(j+1),this.emplace(j,v,P,O)},d.prototype.emplace=function(v,P,O,j){var $=3*v;return this.int16[$+0]=P,this.int16[$+1]=O,this.int16[$+2]=j,v},d}(Mo);Js.prototype.bytesPerElement=6,Rn("StructArrayLayout3i6",Js);var bd=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O){var j=this.length;return this.resize(j+1),this.emplace(j,v,P,O)},d.prototype.emplace=function(v,P,O,j){var $=4*v;return this.uint32[2*v+0]=P,this.uint16[$+2]=O,this.uint16[$+3]=j,v},d}(Mo);bd.prototype.bytesPerElement=8,Rn("StructArrayLayout1ul2ui8",bd);var Ih=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P){var O=this.length;return this.resize(O+1),this.emplace(O,v,P)},d.prototype.emplace=function(v,P,O){var j=2*v;return this.uint16[j+0]=P,this.uint16[j+1]=O,v},d}(Mo);Ih.prototype.bytesPerElement=4,Rn("StructArrayLayout2ui4",Ih);var Ch=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v){var P=this.length;return this.resize(P+1),this.emplace(P,v)},d.prototype.emplace=function(v,P){return this.uint16[1*v+0]=P,v},d}(Mo);Ch.prototype.bytesPerElement=2,Rn("StructArrayLayout1ui2",Ch);var Ah=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(v,P,O,j){var $=this.length;return this.resize($+1),this.emplace($,v,P,O,j)},d.prototype.emplace=function(v,P,O,j,$){var K=4*v;return this.float32[K+0]=P,this.float32[K+1]=O,this.float32[K+2]=j,this.float32[K+3]=$,v},d}(Mo);Ah.prototype.bytesPerElement=16,Rn("StructArrayLayout4f16",Ah);var S=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var v={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return v.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},v.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},v.x1.get=function(){return this._structArray.int16[this._pos2+2]},v.y1.get=function(){return this._structArray.int16[this._pos2+3]},v.x2.get=function(){return this._structArray.int16[this._pos2+4]},v.y2.get=function(){return this._structArray.int16[this._pos2+5]},v.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},v.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},v.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},v.anchorPoint.get=function(){return new G(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,v),d}(up);S.prototype.size=20;var E=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(v){return new S(this,v)},d}(ef);Rn("CollisionBoxArray",E);var T=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var v={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return v.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},v.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},v.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},v.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},v.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},v.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},v.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},v.segment.get=function(){return this._structArray.uint16[this._pos2+10]},v.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},v.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},v.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},v.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},v.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},v.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},v.placedOrientation.set=function(P){this._structArray.uint8[this._pos1+37]=P},v.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},v.hidden.set=function(P){this._structArray.uint8[this._pos1+38]=P},v.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},v.crossTileID.set=function(P){this._structArray.uint32[this._pos4+10]=P},v.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,v),d}(up);T.prototype.size=48;var M=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(v){return new T(this,v)},d}(yu);Rn("PlacedSymbolArray",M);var B=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var v={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return v.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},v.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},v.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},v.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},v.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},v.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},v.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},v.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},v.key.get=function(){return this._structArray.uint16[this._pos2+8]},v.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},v.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},v.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},v.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},v.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},v.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},v.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},v.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},v.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},v.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},v.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},v.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},v.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},v.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},v.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},v.crossTileID.set=function(P){this._structArray.uint32[this._pos4+12]=P},v.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},v.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},v.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},v.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,v),d}(up);B.prototype.size=68;var W=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(v){return new B(this,v)},d}(pp);Rn("SymbolInstanceArray",W);var Y=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getoffsetX=function(v){return this.float32[1*v+0]},d}(xc);Rn("GlyphOffsetArray",Y);var re=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.getx=function(v){return this.int16[3*v+0]},d.prototype.gety=function(v){return this.int16[3*v+1]},d.prototype.gettileUnitDistanceFromAnchor=function(v){return this.int16[3*v+2]},d}(Js);Rn("SymbolLineVertexArray",re);var ye=function(l){function d(){l.apply(this,arguments)}l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d;var v={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return v.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},v.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},v.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,v),d}(up);ye.prototype.size=8;var Ae=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.get=function(v){return new ye(this,v)},d}(bd);Rn("FeatureIndexArray",Ae);var Ze=Ya([{name:"a_pos",components:2,type:"Int16"}],4).members,Je=function(l){l===void 0&&(l=[]),this.segments=l};function ke(l,d){return 256*(l=Te(Math.floor(l),0,255))+Te(Math.floor(d),0,255)}Je.prototype.prepareSegment=function(l,d,v,P){var O=this.segments[this.segments.length-1];return l>Je.MAX_VERTEX_ARRAY_LENGTH&&Ar("Max vertices per segment is "+Je.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+l),(!O||O.vertexLength+l>Je.MAX_VERTEX_ARRAY_LENGTH||O.sortKey!==P)&&(O={vertexOffset:d.length,primitiveOffset:v.length,vertexLength:0,primitiveLength:0},P!==void 0&&(O.sortKey=P),this.segments.push(O)),O},Je.prototype.get=function(){return this.segments},Je.prototype.destroy=function(){for(var l=0,d=this.segments;l<d.length;l+=1){var v=d[l];for(var P in v.vaos)v.vaos[P].destroy()}},Je.simpleSegment=function(l,d,v,P){return new Je([{vertexOffset:l,primitiveOffset:d,vertexLength:v,primitiveLength:P,vaos:{},sortKey:0}])},Je.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn("SegmentVector",Je);var ut=Ya([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ht=s(function(l){l.exports=function(d,v){var P,O,j,$,K,le,me,be;for(O=d.length-(P=3&d.length),j=v,K=3432918353,le=461845907,be=0;be<O;)me=255&d.charCodeAt(be)|(255&d.charCodeAt(++be))<<8|(255&d.charCodeAt(++be))<<16|(255&d.charCodeAt(++be))<<24,++be,j=27492+(65535&($=5*(65535&(j=(j^=me=(65535&(me=(me=(65535&me)*K+(((me>>>16)*K&65535)<<16)&4294967295)<<15|me>>>17))*le+(((me>>>16)*le&65535)<<16)&4294967295)<<13|j>>>19))+((5*(j>>>16)&65535)<<16)&4294967295))+((58964+($>>>16)&65535)<<16);switch(me=0,P){case 3:me^=(255&d.charCodeAt(be+2))<<16;case 2:me^=(255&d.charCodeAt(be+1))<<8;case 1:j^=me=(65535&(me=(me=(65535&(me^=255&d.charCodeAt(be)))*K+(((me>>>16)*K&65535)<<16)&4294967295)<<15|me>>>17))*le+(((me>>>16)*le&65535)<<16)&4294967295}return j^=d.length,j=2246822507*(65535&(j^=j>>>16))+((2246822507*(j>>>16)&65535)<<16)&4294967295,j=3266489909*(65535&(j^=j>>>13))+((3266489909*(j>>>16)&65535)<<16)&4294967295,(j^=j>>>16)>>>0}}),Ct=s(function(l){l.exports=function(d,v){for(var P,O=d.length,j=v^O,$=0;O>=4;)P=1540483477*(65535&(P=255&d.charCodeAt($)|(255&d.charCodeAt(++$))<<8|(255&d.charCodeAt(++$))<<16|(255&d.charCodeAt(++$))<<24))+((1540483477*(P>>>16)&65535)<<16),j=1540483477*(65535&j)+((1540483477*(j>>>16)&65535)<<16)^(P=1540483477*(65535&(P^=P>>>24))+((1540483477*(P>>>16)&65535)<<16)),O-=4,++$;switch(O){case 3:j^=(255&d.charCodeAt($+2))<<16;case 2:j^=(255&d.charCodeAt($+1))<<8;case 1:j=1540483477*(65535&(j^=255&d.charCodeAt($)))+((1540483477*(j>>>16)&65535)<<16)}return j=1540483477*(65535&(j^=j>>>13))+((1540483477*(j>>>16)&65535)<<16),(j^=j>>>15)>>>0}}),lt=ht,It=Ct;lt.murmur3=ht,lt.murmur2=It;var Lt=function(){this.ids=[],this.positions=[],this.indexed=!1};Lt.prototype.add=function(l,d,v,P){this.ids.push(vr(l)),this.positions.push(d,v,P)},Lt.prototype.getPositions=function(l){for(var d=vr(l),v=0,P=this.ids.length-1;v<P;){var O=v+P>>1;this.ids[O]>=d?P=O:v=O+1}for(var j=[];this.ids[v]===d;)j.push({index:this.positions[3*v],start:this.positions[3*v+1],end:this.positions[3*v+2]}),v++;return j},Lt.serialize=function(l,d){var v=new Float64Array(l.ids),P=new Uint32Array(l.positions);return function O(j,$,K,le){for(;K<le;){for(var me=j[K+le>>1],be=K-1,Ie=le+1;;){do be++;while(j[be]<me);do Ie--;while(j[Ie]>me);if(be>=Ie)break;mr(j,be,Ie),mr($,3*be,3*Ie),mr($,3*be+1,3*Ie+1),mr($,3*be+2,3*Ie+2)}Ie-K<le-Ie?(O(j,$,K,Ie),K=Ie+1):(O(j,$,Ie+1,le),le=Ie)}}(v,P,0,v.length-1),d&&d.push(v.buffer,P.buffer),{ids:v,positions:P}},Lt.deserialize=function(l){var d=new Lt;return d.ids=l.ids,d.positions=l.positions,d.indexed=!0,d};var Jt=Math.pow(2,53)-1;function vr(l){var d=+l;return!isNaN(d)&&d<=Jt?d:lt(String(l))}function mr(l,d,v){var P=l[d];l[d]=l[v],l[v]=P}Rn("FeaturePositionMap",Lt);var wr=function(l,d){this.gl=l.gl,this.location=d},Ur=function(l){function d(v,P){l.call(this,v,P),this.current=0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){this.current!==v&&(this.current=v,this.gl.uniform1i(this.location,v))},d}(wr),on=function(l){function d(v,P){l.call(this,v,P),this.current=0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){this.current!==v&&(this.current=v,this.gl.uniform1f(this.location,v))},d}(wr),Hr=function(l){function d(v,P){l.call(this,v,P),this.current=[0,0]}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){v[0]===this.current[0]&&v[1]===this.current[1]||(this.current=v,this.gl.uniform2f(this.location,v[0],v[1]))},d}(wr),mn=function(l){function d(v,P){l.call(this,v,P),this.current=[0,0,0]}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){v[0]===this.current[0]&&v[1]===this.current[1]&&v[2]===this.current[2]||(this.current=v,this.gl.uniform3f(this.location,v[0],v[1],v[2]))},d}(wr),Yn=function(l){function d(v,P){l.call(this,v,P),this.current=[0,0,0,0]}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){v[0]===this.current[0]&&v[1]===this.current[1]&&v[2]===this.current[2]&&v[3]===this.current[3]||(this.current=v,this.gl.uniform4f(this.location,v[0],v[1],v[2],v[3]))},d}(wr),ni=function(l){function d(v,P){l.call(this,v,P),this.current=qi.transparent}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){v.r===this.current.r&&v.g===this.current.g&&v.b===this.current.b&&v.a===this.current.a||(this.current=v,this.gl.uniform4f(this.location,v.r,v.g,v.b,v.a))},d}(wr),Jn=new Float32Array(16),io=function(l){function d(v,P){l.call(this,v,P),this.current=Jn}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.set=function(v){if(v[12]!==this.current[12]||v[0]!==this.current[0])return this.current=v,void this.gl.uniformMatrix4fv(this.location,!1,v);for(var P=1;P<16;P++)if(v[P]!==this.current[P]){this.current=v,this.gl.uniformMatrix4fv(this.location,!1,v);break}},d}(wr);function An(l){return[ke(255*l.r,255*l.g),ke(255*l.b,255*l.a)]}var Qn=function(l,d,v){this.value=l,this.uniformNames=d.map(function(P){return"u_"+P}),this.type=v};Qn.prototype.setUniform=function(l,d,v){l.set(v.constantOr(this.value))},Qn.prototype.getBinding=function(l,d,v){return this.type==="color"?new ni(l,d):new on(l,d)};var $n=function(l,d){this.uniformNames=d.map(function(v){return"u_"+v}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};$n.prototype.setConstantPatternPositions=function(l,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=l.tlbr},$n.prototype.setUniform=function(l,d,v,P){var O=P==="u_pattern_to"?this.patternTo:P==="u_pattern_from"?this.patternFrom:P==="u_pixel_ratio_to"?this.pixelRatioTo:P==="u_pixel_ratio_from"?this.pixelRatioFrom:null;O&&l.set(O)},$n.prototype.getBinding=function(l,d,v){return v.substr(0,9)==="u_pattern"?new Yn(l,d):new on(l,d)};var vi=function(l,d,v,P){this.expression=l,this.type=v,this.maxValue=0,this.paintVertexAttributes=d.map(function(O){return{name:"a_"+O,type:"Float32",components:v==="color"?2:1,offset:0}}),this.paintVertexArray=new P};vi.prototype.populatePaintArray=function(l,d,v,P,O){var j=this.paintVertexArray.length,$=this.expression.evaluate(new oo(0),d,{},P,[],O);this.paintVertexArray.resize(l),this._setPaintValue(j,l,$)},vi.prototype.updatePaintArray=function(l,d,v,P){var O=this.expression.evaluate({zoom:0},v,P);this._setPaintValue(l,d,O)},vi.prototype._setPaintValue=function(l,d,v){if(this.type==="color")for(var P=An(v),O=l;O<d;O++)this.paintVertexArray.emplace(O,P[0],P[1]);else{for(var j=l;j<d;j++)this.paintVertexArray.emplace(j,v);this.maxValue=Math.max(this.maxValue,Math.abs(v))}},vi.prototype.upload=function(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},vi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var xi=function(l,d,v,P,O,j){this.expression=l,this.uniformNames=d.map(function($){return"u_"+$+"_t"}),this.type=v,this.useIntegerZoom=P,this.zoom=O,this.maxValue=0,this.paintVertexAttributes=d.map(function($){return{name:"a_"+$,type:"Float32",components:v==="color"?4:2,offset:0}}),this.paintVertexArray=new j};xi.prototype.populatePaintArray=function(l,d,v,P,O){var j=this.expression.evaluate(new oo(this.zoom),d,{},P,[],O),$=this.expression.evaluate(new oo(this.zoom+1),d,{},P,[],O),K=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(K,l,j,$)},xi.prototype.updatePaintArray=function(l,d,v,P){var O=this.expression.evaluate({zoom:this.zoom},v,P),j=this.expression.evaluate({zoom:this.zoom+1},v,P);this._setPaintValue(l,d,O,j)},xi.prototype._setPaintValue=function(l,d,v,P){if(this.type==="color")for(var O=An(v),j=An(P),$=l;$<d;$++)this.paintVertexArray.emplace($,O[0],O[1],j[0],j[1]);else{for(var K=l;K<d;K++)this.paintVertexArray.emplace(K,v,P);this.maxValue=Math.max(this.maxValue,Math.abs(v),Math.abs(P))}},xi.prototype.upload=function(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},xi.prototype.setUniform=function(l,d){var v=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,P=Te(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);l.set(P)},xi.prototype.getBinding=function(l,d,v){return new on(l,d)};var Ii=function(l,d,v,P,O,j){this.expression=l,this.type=d,this.useIntegerZoom=v,this.zoom=P,this.layerId=j,this.zoomInPaintVertexArray=new O,this.zoomOutPaintVertexArray=new O};Ii.prototype.populatePaintArray=function(l,d,v){var P=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(P,l,d.patterns&&d.patterns[this.layerId],v)},Ii.prototype.updatePaintArray=function(l,d,v,P,O){this._setPaintValues(l,d,v.patterns&&v.patterns[this.layerId],O)},Ii.prototype._setPaintValues=function(l,d,v,P){if(P&&v){var O=P[v.min],j=P[v.mid],$=P[v.max];if(O&&j&&$)for(var K=l;K<d;K++)this.zoomInPaintVertexArray.emplace(K,j.tl[0],j.tl[1],j.br[0],j.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],j.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(K,j.tl[0],j.tl[1],j.br[0],j.br[1],$.tl[0],$.tl[1],$.br[0],$.br[1],j.pixelRatio,$.pixelRatio)}},Ii.prototype.upload=function(l){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,ut.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,ut.members,this.expression.isStateDependent))},Ii.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var yi=function(l,d,v){this.binders={},this._buffers=[];var P=[];for(var O in l.paint._values)if(v(O)){var j=l.paint.get(O);if(j instanceof Cs&&jc(j.property.specification)){var $=is(O,l.type),K=j.value,le=j.property.specification.type,me=j.property.useIntegerZoom,be=j.property.specification["property-type"],Ie=be==="cross-faded"||be==="cross-faded-data-driven";if(K.kind==="constant")this.binders[O]=Ie?new $n(K.value,$):new Qn(K.value,$,le),P.push("/u_"+O);else if(K.kind==="source"||Ie){var je=ra(O,le,"source");this.binders[O]=Ie?new Ii(K,le,me,d,je,l.id):new vi(K,$,le,je),P.push("/a_"+O)}else{var Ye=ra(O,le,"composite");this.binders[O]=new xi(K,$,le,me,d,Ye),P.push("/z_"+O)}}}this.cacheKey=P.sort().join("")};yi.prototype.getMaxValue=function(l){var d=this.binders[l];return d instanceof vi||d instanceof xi?d.maxValue:0},yi.prototype.populatePaintArrays=function(l,d,v,P,O){for(var j in this.binders){var $=this.binders[j];($ instanceof vi||$ instanceof xi||$ instanceof Ii)&&$.populatePaintArray(l,d,v,P,O)}},yi.prototype.setConstantPatternPositions=function(l,d){for(var v in this.binders){var P=this.binders[v];P instanceof $n&&P.setConstantPatternPositions(l,d)}},yi.prototype.updatePaintArrays=function(l,d,v,P,O){var j=!1;for(var $ in l)for(var K=0,le=d.getPositions($);K<le.length;K+=1){var me=le[K],be=v.feature(me.index);for(var Ie in this.binders){var je=this.binders[Ie];if((je instanceof vi||je instanceof xi||je instanceof Ii)&&je.expression.isStateDependent===!0){var Ye=P.paint.get(Ie);je.expression=Ye.value,je.updatePaintArray(me.start,me.end,be,l[$],O),j=!0}}}return j},yi.prototype.defines=function(){var l=[];for(var d in this.binders){var v=this.binders[d];(v instanceof Qn||v instanceof $n)&&l.push.apply(l,v.uniformNames.map(function(P){return"#define HAS_UNIFORM_"+P}))}return l},yi.prototype.getBinderAttributes=function(){var l=[];for(var d in this.binders){var v=this.binders[d];if(v instanceof vi||v instanceof xi)for(var P=0;P<v.paintVertexAttributes.length;P++)l.push(v.paintVertexAttributes[P].name);else if(v instanceof Ii)for(var O=0;O<ut.members.length;O++)l.push(ut.members[O].name)}return l},yi.prototype.getBinderUniforms=function(){var l=[];for(var d in this.binders){var v=this.binders[d];if(v instanceof Qn||v instanceof $n||v instanceof xi)for(var P=0,O=v.uniformNames;P<O.length;P+=1)l.push(O[P])}return l},yi.prototype.getPaintVertexBuffers=function(){return this._buffers},yi.prototype.getUniforms=function(l,d){var v=[];for(var P in this.binders){var O=this.binders[P];if(O instanceof Qn||O instanceof $n||O instanceof xi)for(var j=0,$=O.uniformNames;j<$.length;j+=1){var K=$[j];if(d[K]){var le=O.getBinding(l,d[K],K);v.push({name:K,property:P,binding:le})}}}return v},yi.prototype.setUniforms=function(l,d,v,P){for(var O=0,j=d;O<j.length;O+=1){var $=j[O],K=$.name,le=$.property;this.binders[le].setUniform($.binding,P,v.get(le),K)}},yi.prototype.updatePaintBuffers=function(l){for(var d in this._buffers=[],this.binders){var v=this.binders[d];if(l&&v instanceof Ii){var P=l.fromScale===2?v.zoomInPaintVertexBuffer:v.zoomOutPaintVertexBuffer;P&&this._buffers.push(P)}else(v instanceof vi||v instanceof xi)&&v.paintVertexBuffer&&this._buffers.push(v.paintVertexBuffer)}},yi.prototype.upload=function(l){for(var d in this.binders){var v=this.binders[d];(v instanceof vi||v instanceof xi||v instanceof Ii)&&v.upload(l)}this.updatePaintBuffers()},yi.prototype.destroy=function(){for(var l in this.binders){var d=this.binders[l];(d instanceof vi||d instanceof xi||d instanceof Ii)&&d.destroy()}};var ii=function(l,d,v){v===void 0&&(v=function(){return!0}),this.programConfigurations={};for(var P=0,O=l;P<O.length;P+=1){var j=O[P];this.programConfigurations[j.id]=new yi(j,d,v)}this.needsUpload=!1,this._featureMap=new Lt,this._bufferOffset=0};function is(l,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(d+"-","").replace(/-/g,"_")]}function ra(l,d,v){var P={color:{source:_u,composite:Ah},number:{source:xc,composite:_u}},O=function(j){return{"line-pattern":{source:tc,composite:tc},"fill-pattern":{source:tc,composite:tc},"fill-extrusion-pattern":{source:tc,composite:tc}}[j]}(l);return O&&O[v]||P[d][v]}ii.prototype.populatePaintArrays=function(l,d,v,P,O,j){for(var $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(l,d,P,O,j);d.id!==void 0&&this._featureMap.add(d.id,v,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0},ii.prototype.updatePaintArrays=function(l,d,v,P){for(var O=0,j=v;O<j.length;O+=1){var $=j[O];this.needsUpload=this.programConfigurations[$.id].updatePaintArrays(l,this._featureMap,d,$,P)||this.needsUpload}},ii.prototype.get=function(l){return this.programConfigurations[l]},ii.prototype.upload=function(l){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(l);this.needsUpload=!1}},ii.prototype.destroy=function(){for(var l in this.programConfigurations)this.programConfigurations[l].destroy()},Rn("ConstantBinder",Qn),Rn("CrossFadedConstantBinder",$n),Rn("SourceExpressionBinder",vi),Rn("CrossFadedCompositeBinder",Ii),Rn("CompositeExpressionBinder",xi),Rn("ProgramConfiguration",yi,{omit:["_buffers"]}),Rn("ProgramConfigurationSet",ii);var Ka=Math.pow(2,14)-1,Dr=-Ka-1;function an(l){for(var d=8192/l.extent,v=l.loadGeometry(),P=0;P<v.length;P++)for(var O=v[P],j=0;j<O.length;j++){var $=O[j],K=Math.round($.x*d),le=Math.round($.y*d);$.x=Te(K,Dr,Ka),$.y=Te(le,Dr,Ka),(K<$.x||K>$.x+1||le<$.y||le>$.y+1)&&Ar("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return v}function na(l,d){return{type:l.type,id:l.id,properties:l.properties,geometry:d?an(l):[]}}function go(l,d,v,P,O){l.emplaceBack(2*d+(P+1)/2,2*v+(O+1)/2)}var os=function(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new ec,this.indexArray=new Yu,this.segments=new Je,this.programConfigurations=new ii(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function rc(l,d){for(var v=0;v<l.length;v++)if(bc(d,l[v]))return!0;for(var P=0;P<d.length;P++)if(bc(l,d[P]))return!0;return!!wd(l,d)}function jt(l,d,v){return!!bc(l,d)||!!Bl(d,l,v)}function jl(l,d){if(l.length===1)return fp(d,l[0]);for(var v=0;v<d.length;v++)for(var P=d[v],O=0;O<P.length;O++)if(bc(l,P[O]))return!0;for(var j=0;j<l.length;j++)if(fp(d,l[j]))return!0;for(var $=0;$<d.length;$++)if(wd(l,d[$]))return!0;return!1}function Pa(l,d,v){if(l.length>1){if(wd(l,d))return!0;for(var P=0;P<d.length;P++)if(Bl(d[P],l,v))return!0}for(var O=0;O<l.length;O++)if(Bl(l[O],d,v))return!0;return!1}function wd(l,d){if(l.length===0||d.length===0)return!1;for(var v=0;v<l.length-1;v++)for(var P=l[v],O=l[v+1],j=0;j<d.length-1;j++)if(Ku(P,O,d[j],d[j+1]))return!0;return!1}function Ku(l,d,v,P){return mt(l,v,P)!==mt(d,v,P)&&mt(l,d,v)!==mt(l,d,P)}function Bl(l,d,v){var P=v*v;if(d.length===1)return l.distSqr(d[0])<P;for(var O=1;O<d.length;O++)if(Sd(l,d[O-1],d[O])<P)return!0;return!1}function Sd(l,d,v){var P=d.distSqr(v);if(P===0)return l.distSqr(d);var O=((l.x-d.x)*(v.x-d.x)+(l.y-d.y)*(v.y-d.y))/P;return l.distSqr(O<0?d:O>1?v:v.sub(d)._mult(O)._add(d))}function fp(l,d){for(var v,P,O,j=!1,$=0;$<l.length;$++)for(var K=0,le=(v=l[$]).length-1;K<v.length;le=K++)(P=v[K]).y>d.y!=(O=v[le]).y>d.y&&d.x<(O.x-P.x)*(d.y-P.y)/(O.y-P.y)+P.x&&(j=!j);return j}function bc(l,d){for(var v=!1,P=0,O=l.length-1;P<l.length;O=P++){var j=l[P],$=l[O];j.y>d.y!=$.y>d.y&&d.x<($.x-j.x)*(d.y-j.y)/($.y-j.y)+j.x&&(v=!v)}return v}function vu(l,d,v){var P=v[0],O=v[2];if(l.x<P.x&&d.x<P.x||l.x>O.x&&d.x>O.x||l.y<P.y&&d.y<P.y||l.y>O.y&&d.y>O.y)return!1;var j=mt(l,d,v[0]);return j!==mt(l,d,v[1])||j!==mt(l,d,v[2])||j!==mt(l,d,v[3])}function wl(l,d,v){var P=d.paint.get(l).value;return P.kind==="constant"?P.value:v.programConfigurations.get(d.id).getMaxValue(l)}function qa(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Fc(l,d,v,P,O){if(!d[0]&&!d[1])return l;var j=G.convert(d)._mult(O);v==="viewport"&&j._rotate(-P);for(var $=[],K=0;K<l.length;K++)$.push(l[K].sub(j));return $}os.prototype.populate=function(l,d,v){var P=this.layers[0],O=[],j=null;P.type==="circle"&&(j=P.layout.get("circle-sort-key"));for(var $=0,K=l;$<K.length;$+=1){var le=K[$],me=le.feature,be=le.id,Ie=le.index,je=le.sourceLayerIndex,Ye=this.layers[0]._featureFilter.needGeometry,ct=na(me,Ye);if(this.layers[0]._featureFilter.filter(new oo(this.zoom),ct,v)){var dt=j?j.evaluate(ct,{},v):void 0,kt={id:be,properties:me.properties,type:me.type,sourceLayerIndex:je,index:Ie,geometry:Ye?ct.geometry:an(me),patterns:{},sortKey:dt};O.push(kt)}}j&&O.sort(function(nn,Zn){return nn.sortKey-Zn.sortKey});for(var St=0,Gt=O;St<Gt.length;St+=1){var or=Gt[St],gr=or.geometry,yr=or.index,zr=or.sourceLayerIndex,Qr=l[yr].feature;this.addFeature(or,gr,yr,v),d.featureIndex.insert(Qr,gr,yr,zr,this.index)}},os.prototype.update=function(l,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,v)},os.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},os.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},os.prototype.upload=function(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Ze),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0},os.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},os.prototype.addFeature=function(l,d,v,P){for(var O=0,j=d;O<j.length;O+=1)for(var $=0,K=j[O];$<K.length;$+=1){var le=K[$],me=le.x,be=le.y;if(!(me<0||me>=8192||be<0||be>=8192)){var Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),je=Ie.vertexLength;go(this.layoutVertexArray,me,be,-1,-1),go(this.layoutVertexArray,me,be,1,-1),go(this.layoutVertexArray,me,be,1,1),go(this.layoutVertexArray,me,be,-1,1),this.indexArray.emplaceBack(je,je+1,je+2),this.indexArray.emplaceBack(je,je+3,je+2),Ie.vertexLength+=4,Ie.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,{},P)},Rn("CircleBucket",os,{omit:["layers"]});var nc=new _s({"circle-sort-key":new Bn(ve.layout_circle["circle-sort-key"])}),Vc={paint:new _s({"circle-radius":new Bn(ve.paint_circle["circle-radius"]),"circle-color":new Bn(ve.paint_circle["circle-color"]),"circle-blur":new Bn(ve.paint_circle["circle-blur"]),"circle-opacity":new Bn(ve.paint_circle["circle-opacity"]),"circle-translate":new Kn(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new Kn(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kn(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kn(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bn(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bn(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bn(ve.paint_circle["circle-stroke-opacity"])}),layout:nc},Co=typeof Float32Array<"u"?Float32Array:Array;function Ns(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function ia(l,d,v){var P=d[0],O=d[1],j=d[2],$=d[3],K=d[4],le=d[5],me=d[6],be=d[7],Ie=d[8],je=d[9],Ye=d[10],ct=d[11],dt=d[12],kt=d[13],St=d[14],Gt=d[15],or=v[0],gr=v[1],yr=v[2],zr=v[3];return l[0]=or*P+gr*K+yr*Ie+zr*dt,l[1]=or*O+gr*le+yr*je+zr*kt,l[2]=or*j+gr*me+yr*Ye+zr*St,l[3]=or*$+gr*be+yr*ct+zr*Gt,l[4]=(or=v[4])*P+(gr=v[5])*K+(yr=v[6])*Ie+(zr=v[7])*dt,l[5]=or*O+gr*le+yr*je+zr*kt,l[6]=or*j+gr*me+yr*Ye+zr*St,l[7]=or*$+gr*be+yr*ct+zr*Gt,l[8]=(or=v[8])*P+(gr=v[9])*K+(yr=v[10])*Ie+(zr=v[11])*dt,l[9]=or*O+gr*le+yr*je+zr*kt,l[10]=or*j+gr*me+yr*Ye+zr*St,l[11]=or*$+gr*be+yr*ct+zr*Gt,l[12]=(or=v[12])*P+(gr=v[13])*K+(yr=v[14])*Ie+(zr=v[15])*dt,l[13]=or*O+gr*le+yr*je+zr*kt,l[14]=or*j+gr*me+yr*Ye+zr*St,l[15]=or*$+gr*be+yr*ct+zr*Gt,l}Math.hypot||(Math.hypot=function(){for(var l=arguments,d=0,v=arguments.length;v--;)d+=l[v]*l[v];return Math.sqrt(d)});var Ph,tf=ia;function jo(l,d,v){var P=d[0],O=d[1],j=d[2],$=d[3];return l[0]=v[0]*P+v[4]*O+v[8]*j+v[12]*$,l[1]=v[1]*P+v[5]*O+v[9]*j+v[13]*$,l[2]=v[2]*P+v[6]*O+v[10]*j+v[14]*$,l[3]=v[3]*P+v[7]*O+v[11]*j+v[15]*$,l}Ph=new Co(3),Co!=Float32Array&&(Ph[0]=0,Ph[1]=0,Ph[2]=0),function(){var l=new Co(4);Co!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0)}();var bo=(function(){var l=new Co(2);Co!=Float32Array&&(l[0]=0,l[1]=0)}(),function(l){function d(v){l.call(this,v,Vc)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.createBucket=function(v){return new os(v)},d.prototype.queryRadius=function(v){var P=v;return wl("circle-radius",this,P)+wl("circle-stroke-width",this,P)+qa(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(v,P,O,j,$,K,le,me){for(var be=Fc(v,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),K.angle,le),Ie=this.paint.get("circle-radius").evaluate(P,O)+this.paint.get("circle-stroke-width").evaluate(P,O),je=this.paint.get("circle-pitch-alignment")==="map",Ye=je?be:function(Qr,nn){return Qr.map(function(Zn){return xu(Zn,nn)})}(be,me),ct=je?Ie*le:Ie,dt=0,kt=j;dt<kt.length;dt+=1)for(var St=0,Gt=kt[dt];St<Gt.length;St+=1){var or=Gt[St],gr=je?or:xu(or,me),yr=ct,zr=jo([],[or.x,or.y,0,1],me);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?yr*=zr[3]/K.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(yr*=K.cameraToCenterDistance/zr[3]),jt(Ye,gr,yr))return!0}return!1},d}(Ql));function xu(l,d){var v=jo([],[l.x,l.y,0,1],d);return new G(v[0]/v[3],v[1]/v[3])}var ic=function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(os);function as(l,d,v,P){var O=d.width,j=d.height;if(P){if(P instanceof Uint8ClampedArray)P=new Uint8Array(P.buffer);else if(P.length!==O*j*v)throw new RangeError("mismatched image size")}else P=new Uint8Array(O*j*v);return l.width=O,l.height=j,l.data=P,l}function oc(l,d,v){var P=d.width,O=d.height;if(P!==l.width||O!==l.height){var j=as({},{width:P,height:O},v);Vf(l,j,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,P),height:Math.min(l.height,O)},v),l.width=P,l.height=O,l.data=j.data}}function Vf(l,d,v,P,O,j){if(O.width===0||O.height===0)return d;if(O.width>l.width||O.height>l.height||v.x>l.width-O.width||v.y>l.height-O.height)throw new RangeError("out of range source coordinates for image copy");if(O.width>d.width||O.height>d.height||P.x>d.width-O.width||P.y>d.height-O.height)throw new RangeError("out of range destination coordinates for image copy");for(var $=l.data,K=d.data,le=0;le<O.height;le++)for(var me=((v.y+le)*l.width+v.x)*j,be=((P.y+le)*d.width+P.x)*j,Ie=0;Ie<O.width*j;Ie++)K[be+Ie]=$[me+Ie];return d}Rn("HeatmapBucket",ic,{omit:["layers"]});var Mh=function(l,d){as(this,l,1,d)};Mh.prototype.resize=function(l){oc(this,l,1)},Mh.prototype.clone=function(){return new Mh({width:this.width,height:this.height},new Uint8Array(this.data))},Mh.copy=function(l,d,v,P,O){Vf(l,d,v,P,O,1)};var Ja=function(l,d){as(this,l,4,d)};Ja.prototype.resize=function(l){oc(this,l,4)},Ja.prototype.replace=function(l,d){d?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l},Ja.prototype.clone=function(){return new Ja({width:this.width,height:this.height},new Uint8Array(this.data))},Ja.copy=function(l,d,v,P,O){Vf(l,d,v,P,O,4)},Rn("AlphaImage",Mh),Rn("RGBAImage",Ja);var Td={paint:new _s({"heatmap-radius":new Bn(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bn(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kn(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nl(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kn(ve.paint_heatmap["heatmap-opacity"])})};function mp(l){var d={},v=l.resolution||256,P=l.clips?l.clips.length:1,O=l.image||new Ja({width:v,height:P}),j=function(ct,dt,kt){d[l.evaluationKey]=kt;var St=l.expression.evaluate(d);O.data[ct+dt+0]=Math.floor(255*St.r/St.a),O.data[ct+dt+1]=Math.floor(255*St.g/St.a),O.data[ct+dt+2]=Math.floor(255*St.b/St.a),O.data[ct+dt+3]=Math.floor(255*St.a)};if(l.clips)for(var $=0,K=0;$<P;++$,K+=4*v)for(var le=0,me=0;le<v;le++,me+=4){var be=le/(v-1),Ie=l.clips[$];j(K,me,Ie.start*(1-be)+Ie.end*be)}else for(var je=0,Ye=0;je<v;je++,Ye+=4)j(0,Ye,je/(v-1));return O}var Um=function(l){function d(v){l.call(this,v,Td),this._updateColorRamp()}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.createBucket=function(v){return new ic(v)},d.prototype._handleSpecialPaintPropertyUpdate=function(v){v==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=mp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(Ql),Uf={paint:new _s({"hillshade-illumination-direction":new Kn(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kn(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kn(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kn(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kn(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kn(ve.paint_hillshade["hillshade-accent-color"])})},S_=function(l){function d(v){l.call(this,v,Uf)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(Ql),T_=Ya([{name:"a_pos",components:2,type:"Int16"}],4).members,Uc=Ed,E_=Ed;function Ed(l,d,v){v=v||2;var P,O,j,$,K,le,me,be=d&&d.length,Ie=be?d[0]*v:l.length,je=$f(l,0,Ie,v,!0),Ye=[];if(!je||je.next===je.prev)return Ye;if(be&&(je=function(dt,kt,St,Gt){var or,gr,yr,zr=[];for(or=0,gr=kt.length;or<gr;or++)(yr=$f(dt,kt[or]*Gt,or<gr-1?kt[or+1]*Gt:dt.length,Gt,!1))===yr.next&&(yr.steiner=!0),zr.push(Wf(yr));for(zr.sort(I_),or=0;or<zr.length;or++)qf(zr[or],St),St=Ju(St,St.next);return St}(l,d,je,v)),l.length>80*v){P=j=l[0],O=$=l[1];for(var ct=v;ct<Ie;ct+=v)(K=l[ct])<P&&(P=K),(le=l[ct+1])<O&&(O=le),K>j&&(j=K),le>$&&($=le);me=(me=Math.max(j-P,$-O))!==0?1/me:0}return Wa(je,Ye,v,P,O,me),Ye}function $f(l,d,v,P,O){var j,$;if(O===qm(l,d,v,P)>0)for(j=d;j<v;j+=P)$=M_(j,l[j],l[j+1],$);else for(j=v-P;j>=d;j-=P)$=M_(j,l[j],l[j+1],$);return $&&Zf($,$.next)&&(Rh($),$=$.next),$}function Ju(l,d){if(!l)return l;d||(d=l);var v,P=l;do if(v=!1,P.steiner||!Zf(P,P.next)&&Da(P.prev,P,P.next)!==0)P=P.next;else{if(Rh(P),(P=d=P.prev)===P.next)break;v=!0}while(v||P!==d);return d}function Wa(l,d,v,P,O,j,$){if(l){!$&&j&&function(be,Ie,je,Ye){var ct=be;do ct.z===null&&(ct.z=kh(ct.x,ct.y,Ie,je,Ye)),ct.prevZ=ct.prev,ct.nextZ=ct.next,ct=ct.next;while(ct!==be);ct.prevZ.nextZ=null,ct.prevZ=null,function(dt){var kt,St,Gt,or,gr,yr,zr,Qr,nn=1;do{for(St=dt,dt=null,gr=null,yr=0;St;){for(yr++,Gt=St,zr=0,kt=0;kt<nn&&(zr++,Gt=Gt.nextZ);kt++);for(Qr=nn;zr>0||Qr>0&&Gt;)zr!==0&&(Qr===0||!Gt||St.z<=Gt.z)?(or=St,St=St.nextZ,zr--):(or=Gt,Gt=Gt.nextZ,Qr--),gr?gr.nextZ=or:dt=or,or.prevZ=gr,gr=or;St=Gt}gr.nextZ=null,nn*=2}while(yr>1)}(ct)}(l,P,O,j);for(var K,le,me=l;l.prev!==l.next;)if(K=l.prev,le=l.next,j?$m(l,P,O,j):rf(l))d.push(K.i/v),d.push(l.i/v),d.push(le.i/v),Rh(l),l=le.next,me=le.next;else if((l=le)===me){$?$===1?Wa(l=Gf(Ju(l),d,v),d,v,P,O,j,2):$===2&&Id(l,d,v,P,O,j):Wa(Ju(l),d,v,P,O,j,1);break}}}function rf(l){var d=l.prev,v=l,P=l.next;if(Da(d,v,P)>=0)return!1;for(var O=l.next.next;O!==l.prev;){if(Cd(d.x,d.y,v.x,v.y,P.x,P.y,O.x,O.y)&&Da(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function $m(l,d,v,P){var O=l.prev,j=l,$=l.next;if(Da(O,j,$)>=0)return!1;for(var K=O.x>j.x?O.x>$.x?O.x:$.x:j.x>$.x?j.x:$.x,le=O.y>j.y?O.y>$.y?O.y:$.y:j.y>$.y?j.y:$.y,me=kh(O.x<j.x?O.x<$.x?O.x:$.x:j.x<$.x?j.x:$.x,O.y<j.y?O.y<$.y?O.y:$.y:j.y<$.y?j.y:$.y,d,v,P),be=kh(K,le,d,v,P),Ie=l.prevZ,je=l.nextZ;Ie&&Ie.z>=me&&je&&je.z<=be;){if(Ie!==l.prev&&Ie!==l.next&&Cd(O.x,O.y,j.x,j.y,$.x,$.y,Ie.x,Ie.y)&&Da(Ie.prev,Ie,Ie.next)>=0||(Ie=Ie.prevZ,je!==l.prev&&je!==l.next&&Cd(O.x,O.y,j.x,j.y,$.x,$.y,je.x,je.y)&&Da(je.prev,je,je.next)>=0))return!1;je=je.nextZ}for(;Ie&&Ie.z>=me;){if(Ie!==l.prev&&Ie!==l.next&&Cd(O.x,O.y,j.x,j.y,$.x,$.y,Ie.x,Ie.y)&&Da(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.prevZ}for(;je&&je.z<=be;){if(je!==l.prev&&je!==l.next&&Cd(O.x,O.y,j.x,j.y,$.x,$.y,je.x,je.y)&&Da(je.prev,je,je.next)>=0)return!1;je=je.nextZ}return!0}function Gf(l,d,v){var P=l;do{var O=P.prev,j=P.next.next;!Zf(O,j)&&A_(O,P,P.next,j)&&nf(O,j)&&nf(j,O)&&(d.push(O.i/v),d.push(P.i/v),d.push(j.i/v),Rh(P),Rh(P.next),P=l=j),P=P.next}while(P!==l);return Ju(P)}function Id(l,d,v,P,O,j){var $=l;do{for(var K=$.next.next;K!==$.prev;){if($.i!==K.i&&Hf($,K)){var le=P_($,K);return $=Ju($,$.next),le=Ju(le,le.next),Wa($,d,v,P,O,j),void Wa(le,d,v,P,O,j)}K=K.next}$=$.next}while($!==l)}function I_(l,d){return l.x-d.x}function qf(l,d){if(d=function(P,O){var j,$=O,K=P.x,le=P.y,me=-1/0;do{if(le<=$.y&&le>=$.next.y&&$.next.y!==$.y){var be=$.x+(le-$.y)*($.next.x-$.x)/($.next.y-$.y);if(be<=K&&be>me){if(me=be,be===K){if(le===$.y)return $;if(le===$.next.y)return $.next}j=$.x<$.next.x?$:$.next}}$=$.next}while($!==O);if(!j)return null;if(K===me)return j;var Ie,je=j,Ye=j.x,ct=j.y,dt=1/0;$=j;do K>=$.x&&$.x>=Ye&&K!==$.x&&Cd(le<ct?K:me,le,Ye,ct,le<ct?me:K,le,$.x,$.y)&&(Ie=Math.abs(le-$.y)/(K-$.x),nf($,P)&&(Ie<dt||Ie===dt&&($.x>j.x||$.x===j.x&&C_(j,$)))&&(j=$,dt=Ie)),$=$.next;while($!==je);return j}(l,d)){var v=P_(d,l);Ju(d,d.next),Ju(v,v.next)}}function C_(l,d){return Da(l.prev,l,d.prev)<0&&Da(d.next,l,l.next)<0}function kh(l,d,v,P,O){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-v)*O)|l<<8))|l<<4))|l<<2))|l<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-P)*O)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function Wf(l){var d=l,v=l;do(d.x<v.x||d.x===v.x&&d.y<v.y)&&(v=d),d=d.next;while(d!==l);return v}function Cd(l,d,v,P,O,j,$,K){return(O-$)*(d-K)-(l-$)*(j-K)>=0&&(l-$)*(P-K)-(v-$)*(d-K)>=0&&(v-$)*(j-K)-(O-$)*(P-K)>=0}function Hf(l,d){return l.next.i!==d.i&&l.prev.i!==d.i&&!function(v,P){var O=v;do{if(O.i!==v.i&&O.next.i!==v.i&&O.i!==P.i&&O.next.i!==P.i&&A_(O,O.next,v,P))return!0;O=O.next}while(O!==v);return!1}(l,d)&&(nf(l,d)&&nf(d,l)&&function(v,P){var O=v,j=!1,$=(v.x+P.x)/2,K=(v.y+P.y)/2;do O.y>K!=O.next.y>K&&O.next.y!==O.y&&$<(O.next.x-O.x)*(K-O.y)/(O.next.y-O.y)+O.x&&(j=!j),O=O.next;while(O!==v);return j}(l,d)&&(Da(l.prev,l,d.prev)||Da(l,d.prev,d))||Zf(l,d)&&Da(l.prev,l,l.next)>0&&Da(d.prev,d,d.next)>0)}function Da(l,d,v){return(d.y-l.y)*(v.x-d.x)-(d.x-l.x)*(v.y-d.y)}function Zf(l,d){return l.x===d.x&&l.y===d.y}function A_(l,d,v,P){var O=Yf(Da(l,d,v)),j=Yf(Da(l,d,P)),$=Yf(Da(v,P,l)),K=Yf(Da(v,P,d));return O!==j&&$!==K||!(O!==0||!Xf(l,v,d))||!(j!==0||!Xf(l,P,d))||!($!==0||!Xf(v,l,P))||!(K!==0||!Xf(v,d,P))}function Xf(l,d,v){return d.x<=Math.max(l.x,v.x)&&d.x>=Math.min(l.x,v.x)&&d.y<=Math.max(l.y,v.y)&&d.y>=Math.min(l.y,v.y)}function Yf(l){return l>0?1:l<0?-1:0}function nf(l,d){return Da(l.prev,l,l.next)<0?Da(l,d,l.next)>=0&&Da(l,l.prev,d)>=0:Da(l,d,l.prev)<0||Da(l,l.next,d)<0}function P_(l,d){var v=new Gm(l.i,l.x,l.y),P=new Gm(d.i,d.x,d.y),O=l.next,j=d.prev;return l.next=d,d.prev=l,v.next=O,O.prev=v,P.next=v,v.prev=P,j.next=P,P.prev=j,P}function M_(l,d,v,P){var O=new Gm(l,d,v);return P?(O.next=P.next,O.prev=P,P.next.prev=O,P.next=O):(O.prev=O,O.next=O),O}function Rh(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Gm(l,d,v){this.i=l,this.x=d,this.y=v,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qm(l,d,v,P){for(var O=0,j=d,$=v-P;j<v;j+=P)O+=(l[$]-l[j])*(l[j+1]+l[$+1]),$=j;return O}function Kf(l,d,v,P,O){(function j($,K,le,me,be){for(;me>le;){if(me-le>600){var Ie=me-le+1,je=K-le+1,Ye=Math.log(Ie),ct=.5*Math.exp(2*Ye/3),dt=.5*Math.sqrt(Ye*ct*(Ie-ct)/Ie)*(je-Ie/2<0?-1:1);j($,K,Math.max(le,Math.floor(K-je*ct/Ie+dt)),Math.min(me,Math.floor(K+(Ie-je)*ct/Ie+dt)),be)}var kt=$[K],St=le,Gt=me;for(Jf($,le,K),be($[me],kt)>0&&Jf($,le,me);St<Gt;){for(Jf($,St,Gt),St++,Gt--;be($[St],kt)<0;)St++;for(;be($[Gt],kt)>0;)Gt--}be($[le],kt)===0?Jf($,le,Gt):Jf($,++Gt,me),Gt<=K&&(le=Gt+1),K<=Gt&&(me=Gt-1)}})(l,d,v||0,P||l.length-1,O||Ly)}function Jf(l,d,v){var P=l[d];l[d]=l[v],l[v]=P}function Ly(l,d){return l<d?-1:l>d?1:0}function ua(l,d){var v=l.length;if(v<=1)return[l];for(var P,O,j=[],$=0;$<v;$++){var K=nr(l[$]);K!==0&&(l[$].area=Math.abs(K),O===void 0&&(O=K<0),O===K<0?(P&&j.push(P),P=[l[$]]):P.push(l[$]))}if(P&&j.push(P),d>1)for(var le=0;le<j.length;le++)j[le].length<=d||(Kf(j[le],d,1,j[le].length-1,k_),j[le]=j[le].slice(0,d));return j}function k_(l,d){return d.area-l.area}function Wm(l,d,v){for(var P=v.patternDependencies,O=!1,j=0,$=d;j<$.length;j+=1){var K=$[j].paint.get(l+"-pattern");K.isConstant()||(O=!0);var le=K.constantOr(null);le&&(O=!0,P[le.to]=!0,P[le.from]=!0)}return O}function Hm(l,d,v,P,O){for(var j=O.patternDependencies,$=0,K=d;$<K.length;$+=1){var le=K[$],me=le.paint.get(l+"-pattern").value;if(me.kind!=="constant"){var be=me.evaluate({zoom:P-1},v,{},O.availableImages),Ie=me.evaluate({zoom:P},v,{},O.availableImages),je=me.evaluate({zoom:P+1},v,{},O.availableImages);Ie=Ie&&Ie.name?Ie.name:Ie,je=je&&je.name?je.name:je,j[be=be&&be.name?be.name:be]=!0,j[Ie]=!0,j[je]=!0,v.patterns[le.id]={min:be,mid:Ie,max:je}}}return v}Ed.deviation=function(l,d,v,P){var O=d&&d.length,j=Math.abs(qm(l,0,O?d[0]*v:l.length,v));if(O)for(var $=0,K=d.length;$<K;$++)j-=Math.abs(qm(l,d[$]*v,$<K-1?d[$+1]*v:l.length,v));var le=0;for($=0;$<P.length;$+=3){var me=P[$]*v,be=P[$+1]*v,Ie=P[$+2]*v;le+=Math.abs((l[me]-l[Ie])*(l[be+1]-l[me+1])-(l[me]-l[be])*(l[Ie+1]-l[me+1]))}return j===0&&le===0?0:Math.abs((le-j)/j)},Ed.flatten=function(l){for(var d=l[0][0].length,v={vertices:[],holes:[],dimensions:d},P=0,O=0;O<l.length;O++){for(var j=0;j<l[O].length;j++)for(var $=0;$<d;$++)v.vertices.push(l[O][j][$]);O>0&&v.holes.push(P+=l[O-1].length)}return v},Uc.default=E_;var Fl=function(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ec,this.indexArray=new Yu,this.indexArray2=new Ih,this.programConfigurations=new ii(l.layers,l.zoom),this.segments=new Je,this.segments2=new Je,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Fl.prototype.populate=function(l,d,v){this.hasPattern=Wm("fill",this.layers,d);for(var P=this.layers[0].layout.get("fill-sort-key"),O=[],j=0,$=l;j<$.length;j+=1){var K=$[j],le=K.feature,me=K.id,be=K.index,Ie=K.sourceLayerIndex,je=this.layers[0]._featureFilter.needGeometry,Ye=na(le,je);if(this.layers[0]._featureFilter.filter(new oo(this.zoom),Ye,v)){var ct=P?P.evaluate(Ye,{},v,d.availableImages):void 0,dt={id:me,properties:le.properties,type:le.type,sourceLayerIndex:Ie,index:be,geometry:je?Ye.geometry:an(le),patterns:{},sortKey:ct};O.push(dt)}}P&&O.sort(function(Qr,nn){return Qr.sortKey-nn.sortKey});for(var kt=0,St=O;kt<St.length;kt+=1){var Gt=St[kt],or=Gt.geometry,gr=Gt.index,yr=Gt.sourceLayerIndex;if(this.hasPattern){var zr=Hm("fill",this.layers,Gt,this.zoom,d);this.patternFeatures.push(zr)}else this.addFeature(Gt,or,gr,v,{});d.featureIndex.insert(l[gr].feature,or,gr,yr,this.index)}},Fl.prototype.update=function(l,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,v)},Fl.prototype.addFeatures=function(l,d,v){for(var P=0,O=this.patternFeatures;P<O.length;P+=1){var j=O[P];this.addFeature(j,j.geometry,j.index,d,v)}},Fl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Fl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fl.prototype.upload=function(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,T_),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0},Fl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Fl.prototype.addFeature=function(l,d,v,P,O){for(var j=0,$=ua(d,500);j<$.length;j+=1){for(var K=$[j],le=0,me=0,be=K;me<be.length;me+=1)le+=be[me].length;for(var Ie=this.segments.prepareSegment(le,this.layoutVertexArray,this.indexArray),je=Ie.vertexLength,Ye=[],ct=[],dt=0,kt=K;dt<kt.length;dt+=1){var St=kt[dt];if(St.length!==0){St!==K[0]&&ct.push(Ye.length/2);var Gt=this.segments2.prepareSegment(St.length,this.layoutVertexArray,this.indexArray2),or=Gt.vertexLength;this.layoutVertexArray.emplaceBack(St[0].x,St[0].y),this.indexArray2.emplaceBack(or+St.length-1,or),Ye.push(St[0].x),Ye.push(St[0].y);for(var gr=1;gr<St.length;gr++)this.layoutVertexArray.emplaceBack(St[gr].x,St[gr].y),this.indexArray2.emplaceBack(or+gr-1,or+gr),Ye.push(St[gr].x),Ye.push(St[gr].y);Gt.vertexLength+=St.length,Gt.primitiveLength+=St.length}}for(var yr=Uc(Ye,ct),zr=0;zr<yr.length;zr+=3)this.indexArray.emplaceBack(je+yr[zr],je+yr[zr+1],je+yr[zr+2]);Ie.vertexLength+=le,Ie.primitiveLength+=yr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,O,P)},Rn("FillBucket",Fl,{omit:["layers","patternFeatures"]});var Zm=new _s({"fill-sort-key":new Bn(ve.layout_fill["fill-sort-key"])}),R_={paint:new _s({"fill-antialias":new Kn(ve.paint_fill["fill-antialias"]),"fill-opacity":new Bn(ve.paint_fill["fill-opacity"]),"fill-color":new Bn(ve.paint_fill["fill-color"]),"fill-outline-color":new Bn(ve.paint_fill["fill-outline-color"]),"fill-translate":new Kn(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new Kn(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qp(ve.paint_fill["fill-pattern"])}),layout:Zm},zy=function(l){function d(v){l.call(this,v,R_)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.recalculate=function(v,P){l.prototype.recalculate.call(this,v,P);var O=this.paint._values["fill-outline-color"];O.value.kind==="constant"&&O.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(v){return new Fl(v)},d.prototype.queryRadius=function(){return qa(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(v,P,O,j,$,K,le){return jl(Fc(v,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),K.angle,le),j)},d.prototype.isTileClipped=function(){return!0},d}(Ql),Ny=Ya([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,D_=Ad;function Ad(l,d,v,P,O){this.properties={},this.extent=v,this.type=0,this._pbf=l,this._geometry=-1,this._keys=P,this._values=O,l.readFields(Qf,this,d)}function Qf(l,d,v){l==1?d.id=v.readVarint():l==2?function(P,O){for(var j=P.readVarint()+P.pos;P.pos<j;){var $=O._keys[P.readVarint()],K=O._values[P.readVarint()];O.properties[$]=K}}(v,d):l==3?d.type=v.readVarint():l==4&&(d._geometry=v.pos)}function jy(l){for(var d,v,P=0,O=0,j=l.length,$=j-1;O<j;$=O++)P+=((v=l[$]).x-(d=l[O]).x)*(d.y+v.y);return P}Ad.types=["Unknown","Point","LineString","Polygon"],Ad.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var d,v=l.readVarint()+l.pos,P=1,O=0,j=0,$=0,K=[];l.pos<v;){if(O<=0){var le=l.readVarint();P=7&le,O=le>>3}if(O--,P===1||P===2)j+=l.readSVarint(),$+=l.readSVarint(),P===1&&(d&&K.push(d),d=[]),d.push(new G(j,$));else{if(P!==7)throw new Error("unknown command "+P);d&&d.push(d[0].clone())}}return d&&K.push(d),K},Ad.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var d=l.readVarint()+l.pos,v=1,P=0,O=0,j=0,$=1/0,K=-1/0,le=1/0,me=-1/0;l.pos<d;){if(P<=0){var be=l.readVarint();v=7&be,P=be>>3}if(P--,v===1||v===2)(O+=l.readSVarint())<$&&($=O),O>K&&(K=O),(j+=l.readSVarint())<le&&(le=j),j>me&&(me=j);else if(v!==7)throw new Error("unknown command "+v)}return[$,le,K,me]},Ad.prototype.toGeoJSON=function(l,d,v){var P,O,j=this.extent*Math.pow(2,v),$=this.extent*l,K=this.extent*d,le=this.loadGeometry(),me=Ad.types[this.type];function be(Ye){for(var ct=0;ct<Ye.length;ct++){var dt=Ye[ct];Ye[ct]=[360*(dt.x+$)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(dt.y+K)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var Ie=[];for(P=0;P<le.length;P++)Ie[P]=le[P][0];be(le=Ie);break;case 2:for(P=0;P<le.length;P++)be(le[P]);break;case 3:for(le=function(Ye){var ct=Ye.length;if(ct<=1)return[Ye];for(var dt,kt,St=[],Gt=0;Gt<ct;Gt++){var or=jy(Ye[Gt]);or!==0&&(kt===void 0&&(kt=or<0),kt===or<0?(dt&&St.push(dt),dt=[Ye[Gt]]):dt.push(Ye[Gt]))}return dt&&St.push(dt),St}(le),P=0;P<le.length;P++)for(O=0;O<le[P].length;O++)be(le[P][O])}le.length===1?le=le[0]:me="Multi"+me;var je={type:"Feature",geometry:{type:me,coordinates:le},properties:this.properties};return"id"in this&&(je.id=this.id),je};var Xm=em;function em(l,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(Dh,this,d),this.length=this._features.length}function Dh(l,d,v){l===15?d.version=v.readVarint():l===1?d.name=v.readString():l===5?d.extent=v.readVarint():l===2?d._features.push(v.pos):l===3?d._keys.push(v.readString()):l===4&&d._values.push(function(P){for(var O=null,j=P.readVarint()+P.pos;P.pos<j;){var $=P.readVarint()>>3;O=$===1?P.readString():$===2?P.readFloat():$===3?P.readDouble():$===4?P.readVarint64():$===5?P.readVarint():$===6?P.readSVarint():$===7?P.readBoolean():null}return O}(v))}function Ym(l,d,v){if(l===3){var P=new Xm(v,v.readVarint()+v.pos);P.length&&(d[P.name]=P)}}em.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var d=this._pbf.readVarint()+this._pbf.pos;return new D_(this._pbf,d,this.extent,this._keys,this._values)};var ys={VectorTile:function(l,d){this.layers=l.readFields(Ym,{},d)},VectorTileFeature:D_,VectorTileLayer:Xm},Pd=ys.VectorTileFeature.types,Km=Math.pow(2,13);function _(l,d,v,P,O,j,$,K){l.emplaceBack(d,v,2*Math.floor(P*Km)+$,O*Km*2,j*Km*2,Math.round(K))}var o=function(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new ll,this.indexArray=new Yu,this.programConfigurations=new ii(l.layers,l.zoom),this.segments=new Je,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function h(l,d){return l.x===d.x&&(l.x<0||l.x>8192)||l.y===d.y&&(l.y<0||l.y>8192)}o.prototype.populate=function(l,d,v){this.features=[],this.hasPattern=Wm("fill-extrusion",this.layers,d);for(var P=0,O=l;P<O.length;P+=1){var j=O[P],$=j.feature,K=j.id,le=j.index,me=j.sourceLayerIndex,be=this.layers[0]._featureFilter.needGeometry,Ie=na($,be);if(this.layers[0]._featureFilter.filter(new oo(this.zoom),Ie,v)){var je={id:K,sourceLayerIndex:me,index:le,geometry:be?Ie.geometry:an($),properties:$.properties,type:$.type,patterns:{}};this.hasPattern?this.features.push(Hm("fill-extrusion",this.layers,je,this.zoom,d)):this.addFeature(je,je.geometry,le,v,{}),d.featureIndex.insert($,je.geometry,le,me,this.index,!0)}}},o.prototype.addFeatures=function(l,d,v){for(var P=0,O=this.features;P<O.length;P+=1){var j=O[P];this.addFeature(j,j.geometry,j.index,d,v)}},o.prototype.update=function(l,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,v)},o.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},o.prototype.upload=function(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Ny),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0},o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},o.prototype.addFeature=function(l,d,v,P,O){for(var j=0,$=ua(d,500);j<$.length;j+=1){for(var K=$[j],le=0,me=0,be=K;me<be.length;me+=1)le+=be[me].length;for(var Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),je=0,Ye=K;je<Ye.length;je+=1){var ct=Ye[je];if(ct.length!==0&&!((uo=ct).every(function(hn){return hn.x<0})||uo.every(function(hn){return hn.x>8192})||uo.every(function(hn){return hn.y<0})||uo.every(function(hn){return hn.y>8192})))for(var dt=0,kt=0;kt<ct.length;kt++){var St=ct[kt];if(kt>=1){var Gt=ct[kt-1];if(!h(St,Gt)){Ie.vertexLength+4>Je.MAX_VERTEX_ARRAY_LENGTH&&(Ie=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var or=St.sub(Gt)._perp()._unit(),gr=Gt.dist(St);dt+gr>32768&&(dt=0),_(this.layoutVertexArray,St.x,St.y,or.x,or.y,0,0,dt),_(this.layoutVertexArray,St.x,St.y,or.x,or.y,0,1,dt),_(this.layoutVertexArray,Gt.x,Gt.y,or.x,or.y,0,0,dt+=gr),_(this.layoutVertexArray,Gt.x,Gt.y,or.x,or.y,0,1,dt);var yr=Ie.vertexLength;this.indexArray.emplaceBack(yr,yr+2,yr+1),this.indexArray.emplaceBack(yr+1,yr+2,yr+3),Ie.vertexLength+=4,Ie.primitiveLength+=2}}}}if(Ie.vertexLength+le>Je.MAX_VERTEX_ARRAY_LENGTH&&(Ie=this.segments.prepareSegment(le,this.layoutVertexArray,this.indexArray)),Pd[l.type]==="Polygon"){for(var zr=[],Qr=[],nn=Ie.vertexLength,Zn=0,Tn=K;Zn<Tn.length;Zn+=1){var li=Tn[Zn];if(li.length!==0){li!==K[0]&&Qr.push(zr.length/2);for(var En=0;En<li.length;En++){var Qi=li[En];_(this.layoutVertexArray,Qi.x,Qi.y,0,0,1,1,0),zr.push(Qi.x),zr.push(Qi.y)}}}for(var Ai=Uc(zr,Qr),Mn=0;Mn<Ai.length;Mn+=3)this.indexArray.emplaceBack(nn+Ai[Mn],nn+Ai[Mn+2],nn+Ai[Mn+1]);Ie.primitiveLength+=Ai.length/3,Ie.vertexLength+=le}}var uo;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,O,P)},Rn("FillExtrusionBucket",o,{omit:["layers","features"]});var x={paint:new _s({"fill-extrusion-opacity":new Kn(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bn(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kn(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kn(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qp(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bn(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bn(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kn(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},I=function(l){function d(v){l.call(this,v,x)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.createBucket=function(v){return new o(v)},d.prototype.queryRadius=function(){return qa(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(v,P,O,j,$,K,le,me){var be=Fc(v,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),K.angle,le),Ie=this.paint.get("fill-extrusion-height").evaluate(P,O),je=this.paint.get("fill-extrusion-base").evaluate(P,O),Ye=function(dt,kt,St,Gt){for(var or=[],gr=0,yr=dt;gr<yr.length;gr+=1){var zr=yr[gr],Qr=[zr.x,zr.y,0,1];jo(Qr,Qr,kt),or.push(new G(Qr[0]/Qr[3],Qr[1]/Qr[3]))}return or}(be,me),ct=function(dt,kt,St,Gt){for(var or=[],gr=[],yr=Gt[8]*kt,zr=Gt[9]*kt,Qr=Gt[10]*kt,nn=Gt[11]*kt,Zn=Gt[8]*St,Tn=Gt[9]*St,li=Gt[10]*St,En=Gt[11]*St,Qi=0,Ai=dt;Qi<Ai.length;Qi+=1){for(var Mn=[],uo=[],hn=0,wo=Ai[Qi];hn<wo.length;hn+=1){var jn=wo[hn],ho=jn.x,da=jn.y,Oa=Gt[0]*ho+Gt[4]*da+Gt[12],ba=Gt[1]*ho+Gt[5]*da+Gt[13],pa=Gt[2]*ho+Gt[6]*da+Gt[14],La=Gt[3]*ho+Gt[7]*da+Gt[15],bs=pa+Qr,ws=La+nn,hl=Oa+Zn,hs=ba+Tn,ei=pa+li,za=La+En,Na=new G((Oa+yr)/ws,(ba+zr)/ws);Na.z=bs/ws,Mn.push(Na);var fo=new G(hl/za,hs/za);fo.z=ei/za,uo.push(fo)}or.push(Mn),gr.push(uo)}return[or,gr]}(j,je,Ie,me);return function(dt,kt,St){var Gt=1/0;jl(St,kt)&&(Gt=D(St,kt[0]));for(var or=0;or<kt.length;or++)for(var gr=kt[or],yr=dt[or],zr=0;zr<gr.length-1;zr++){var Qr=gr[zr],nn=[Qr,gr[zr+1],yr[zr+1],yr[zr],Qr];rc(St,nn)&&(Gt=Math.min(Gt,D(St,nn)))}return Gt!==1/0&&Gt}(ct[0],ct[1],Ye)},d}(Ql);function A(l,d){return l.x*d.x+l.y*d.y}function D(l,d){if(l.length===1){for(var v,P=0,O=d[P++];!v||O.equals(v);)if(!(v=d[P++]))return 1/0;for(;P<d.length;P++){var j=d[P],$=l[0],K=v.sub(O),le=j.sub(O),me=$.sub(O),be=A(K,K),Ie=A(K,le),je=A(le,le),Ye=A(me,K),ct=A(me,le),dt=be*je-Ie*Ie,kt=(je*Ye-Ie*ct)/dt,St=(be*ct-Ie*Ye)/dt,Gt=O.z*(1-kt-St)+v.z*kt+j.z*St;if(isFinite(Gt))return Gt}return 1/0}for(var or=1/0,gr=0,yr=d;gr<yr.length;gr+=1)or=Math.min(or,yr[gr].z);return or}var N=Ya([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,U=Ya([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Z=ys.VectorTileFeature.types,J=Math.cos(Math.PI/180*37.5),ee=Math.pow(2,14)/.5,ae=function(l){var d=this;this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(function(v){return v.id}),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(v){d.gradients[v.id]={}}),this.layoutVertexArray=new cl,this.layoutVertexArray2=new _u,this.indexArray=new Yu,this.programConfigurations=new ii(l.layers,l.zoom),this.segments=new Je,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(v){return v.isStateDependent()}).map(function(v){return v.id})};ae.prototype.populate=function(l,d,v){this.hasPattern=Wm("line",this.layers,d);for(var P=this.layers[0].layout.get("line-sort-key"),O=[],j=0,$=l;j<$.length;j+=1){var K=$[j],le=K.feature,me=K.id,be=K.index,Ie=K.sourceLayerIndex,je=this.layers[0]._featureFilter.needGeometry,Ye=na(le,je);if(this.layers[0]._featureFilter.filter(new oo(this.zoom),Ye,v)){var ct=P?P.evaluate(Ye,{},v):void 0,dt={id:me,properties:le.properties,type:le.type,sourceLayerIndex:Ie,index:be,geometry:je?Ye.geometry:an(le),patterns:{},sortKey:ct};O.push(dt)}}P&&O.sort(function(Qr,nn){return Qr.sortKey-nn.sortKey});for(var kt=0,St=O;kt<St.length;kt+=1){var Gt=St[kt],or=Gt.geometry,gr=Gt.index,yr=Gt.sourceLayerIndex;if(this.hasPattern){var zr=Hm("line",this.layers,Gt,this.zoom,d);this.patternFeatures.push(zr)}else this.addFeature(Gt,or,gr,v,{});d.featureIndex.insert(l[gr].feature,or,gr,yr,this.index)}},ae.prototype.update=function(l,d,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,d,this.stateDependentLayers,v)},ae.prototype.addFeatures=function(l,d,v){for(var P=0,O=this.patternFeatures;P<O.length;P+=1){var j=O[P];this.addFeature(j,j.geometry,j.index,d,v)}},ae.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ae.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ae.prototype.upload=function(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,U)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,N),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0},ae.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ae.prototype.lineFeatureClips=function(l){if(l.properties&&l.properties.hasOwnProperty("mapbox_clip_start")&&l.properties.hasOwnProperty("mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}},ae.prototype.addFeature=function(l,d,v,P,O){var j=this.layers[0].layout,$=j.get("line-join").evaluate(l,{}),K=j.get("line-cap"),le=j.get("line-miter-limit"),me=j.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(var be=0,Ie=d;be<Ie.length;be+=1)this.addLine(Ie[be],l,$,K,le,me);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,v,O,P)},ae.prototype.addLine=function(l,d,v,P,O,j){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var $=0;$<l.length-1;$++)this.totalDistance+=l[$].dist(l[$+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var K=Z[d.type]==="Polygon",le=l.length;le>=2&&l[le-1].equals(l[le-2]);)le--;for(var me=0;me<le-1&&l[me].equals(l[me+1]);)me++;if(!(le<(K?3:2))){v==="bevel"&&(O=1.05);var be,Ie=this.overscaling<=16?122880/(512*this.overscaling):0,je=this.segments.prepareSegment(10*le,this.layoutVertexArray,this.indexArray),Ye=void 0,ct=void 0,dt=void 0,kt=void 0;this.e1=this.e2=-1,K&&(kt=l[me].sub(be=l[le-2])._unit()._perp());for(var St=me;St<le;St++)if(!(ct=St===le-1?K?l[me+1]:void 0:l[St+1])||!l[St].equals(ct)){kt&&(dt=kt),be&&(Ye=be),be=l[St],kt=ct?ct.sub(be)._unit()._perp():dt;var Gt=(dt=dt||kt).add(kt);Gt.x===0&&Gt.y===0||Gt._unit();var or=dt.x*kt.x+dt.y*kt.y,gr=Gt.x*kt.x+Gt.y*kt.y,yr=gr!==0?1/gr:1/0,zr=2*Math.sqrt(2-2*gr),Qr=gr<J&&Ye&&ct,nn=dt.x*kt.y-dt.y*kt.x>0;if(Qr&&St>me){var Zn=be.dist(Ye);if(Zn>2*Ie){var Tn=be.sub(be.sub(Ye)._mult(Ie/Zn)._round());this.updateDistance(Ye,Tn),this.addCurrentVertex(Tn,dt,0,0,je),Ye=Tn}}var li=Ye&&ct,En=li?v:K?"butt":P;if(li&&En==="round"&&(yr<j?En="miter":yr<=2&&(En="fakeround")),En==="miter"&&yr>O&&(En="bevel"),En==="bevel"&&(yr>2&&(En="flipbevel"),yr<O&&(En="miter")),Ye&&this.updateDistance(Ye,be),En==="miter")Gt._mult(yr),this.addCurrentVertex(be,Gt,0,0,je);else if(En==="flipbevel"){if(yr>100)Gt=kt.mult(-1);else{var Qi=yr*dt.add(kt).mag()/dt.sub(kt).mag();Gt._perp()._mult(Qi*(nn?-1:1))}this.addCurrentVertex(be,Gt,0,0,je),this.addCurrentVertex(be,Gt.mult(-1),0,0,je)}else if(En==="bevel"||En==="fakeround"){var Ai=-Math.sqrt(yr*yr-1),Mn=nn?Ai:0,uo=nn?0:Ai;if(Ye&&this.addCurrentVertex(be,dt,Mn,uo,je),En==="fakeround")for(var hn=Math.round(180*zr/Math.PI/20),wo=1;wo<hn;wo++){var jn=wo/hn;if(jn!==.5){var ho=jn-.5;jn+=jn*ho*(jn-1)*((1.0904+or*(or*(3.55645-1.43519*or)-3.2452))*ho*ho+(.848013+or*(.215638*or-1.06021)))}var da=kt.sub(dt)._mult(jn)._add(dt)._unit()._mult(nn?-1:1);this.addHalfVertex(be,da.x,da.y,!1,nn,0,je)}ct&&this.addCurrentVertex(be,kt,-Mn,-uo,je)}else if(En==="butt")this.addCurrentVertex(be,Gt,0,0,je);else if(En==="square"){var Oa=Ye?1:-1;this.addCurrentVertex(be,Gt,Oa,Oa,je)}else En==="round"&&(Ye&&(this.addCurrentVertex(be,dt,0,0,je),this.addCurrentVertex(be,dt,1,1,je,!0)),ct&&(this.addCurrentVertex(be,kt,-1,-1,je,!0),this.addCurrentVertex(be,kt,0,0,je)));if(Qr&&St<le-1){var ba=be.dist(ct);if(ba>2*Ie){var pa=be.add(ct.sub(be)._mult(Ie/ba)._round());this.updateDistance(be,pa),this.addCurrentVertex(pa,kt,0,0,je),be=pa}}}}},ae.prototype.addCurrentVertex=function(l,d,v,P,O,j){j===void 0&&(j=!1);var $=d.y*P-d.x,K=-d.y-d.x*P;this.addHalfVertex(l,d.x+d.y*v,d.y-d.x*v,j,!1,v,O),this.addHalfVertex(l,$,K,j,!0,-P,O),this.distance>ee/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(l,d,v,P,O,j))},ae.prototype.addHalfVertex=function(l,d,v,P,O,j,$){var K=.5*(this.lineClips?this.scaledDistance*(ee-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l.x<<1)+(P?1:0),(l.y<<1)+(O?1:0),Math.round(63*d)+128,Math.round(63*v)+128,1+(j===0?0:j<0?-1:1)|(63&K)<<2,K>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var le=$.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,le),$.primitiveLength++),O?this.e2=le:this.e1=le},ae.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ae.prototype.updateDistance=function(l,d){this.distance+=l.dist(d),this.updateScaledDistance()},Rn("LineBucket",ae,{omit:["layers","patternFeatures"]});var he=new _s({"line-cap":new Kn(ve.layout_line["line-cap"]),"line-join":new Bn(ve.layout_line["line-join"]),"line-miter-limit":new Kn(ve.layout_line["line-miter-limit"]),"line-round-limit":new Kn(ve.layout_line["line-round-limit"]),"line-sort-key":new Bn(ve.layout_line["line-sort-key"])}),we={paint:new _s({"line-opacity":new Bn(ve.paint_line["line-opacity"]),"line-color":new Bn(ve.paint_line["line-color"]),"line-translate":new Kn(ve.paint_line["line-translate"]),"line-translate-anchor":new Kn(ve.paint_line["line-translate-anchor"]),"line-width":new Bn(ve.paint_line["line-width"]),"line-gap-width":new Bn(ve.paint_line["line-gap-width"]),"line-offset":new Bn(ve.paint_line["line-offset"]),"line-blur":new Bn(ve.paint_line["line-blur"]),"line-dasharray":new As(ve.paint_line["line-dasharray"]),"line-pattern":new Qp(ve.paint_line["line-pattern"]),"line-gradient":new Nl(ve.paint_line["line-gradient"])}),layout:he},xe=new(function(l){function d(){l.apply(this,arguments)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(v,P){return P=new oo(Math.floor(P.zoom),{now:P.now,fadeDuration:P.fadeDuration,zoomHistory:P.zoomHistory,transition:P.transition}),l.prototype.possiblyEvaluate.call(this,v,P)},d.prototype.evaluate=function(v,P,O,j){return P=ce({},P,{zoom:Math.floor(P.zoom)}),l.prototype.evaluate.call(this,v,P,O,j)},d}(Bn))(we.paint.properties["line-width"].specification);xe.useIntegerZoom=!0;var Ce=function(l){function d(v){l.call(this,v,we),this.gradientVersion=0}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(v){v==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof $a,this.gradientVersion=(this.gradientVersion+1)%ne)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(v,P){l.prototype.recalculate.call(this,v,P),this.paint._values["line-floorwidth"]=xe.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,v)},d.prototype.createBucket=function(v){return new ae(v)},d.prototype.queryRadius=function(v){var P=v,O=ge(wl("line-width",this,P),wl("line-gap-width",this,P)),j=wl("line-offset",this,P);return O/2+Math.abs(j)+qa(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(v,P,O,j,$,K,le){var me=Fc(v,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),K.angle,le),be=le/2*ge(this.paint.get("line-width").evaluate(P,O),this.paint.get("line-gap-width").evaluate(P,O)),Ie=this.paint.get("line-offset").evaluate(P,O);return Ie&&(j=function(je,Ye){for(var ct=[],dt=new G(0,0),kt=0;kt<je.length;kt++){for(var St=je[kt],Gt=[],or=0;or<St.length;or++){var gr=St[or],yr=St[or+1],zr=or===0?dt:gr.sub(St[or-1])._unit()._perp(),Qr=or===St.length-1?dt:yr.sub(gr)._unit()._perp(),nn=zr._add(Qr)._unit();nn._mult(1/(nn.x*Qr.x+nn.y*Qr.y)),Gt.push(nn._mult(Ye)._add(gr))}ct.push(Gt)}return ct}(j,Ie*le)),function(je,Ye,ct){for(var dt=0;dt<Ye.length;dt++){var kt=Ye[dt];if(je.length>=3){for(var St=0;St<kt.length;St++)if(bc(je,kt[St]))return!0}if(Pa(je,kt,ct))return!0}return!1}(me,j,be)},d.prototype.isTileClipped=function(){return!0},d}(Ql);function ge(l,d){return d>0?d+2*l:l}var De=Ya([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xe=Ya([{name:"a_projected_pos",components:3,type:"Float32"}],4),Be=(Ya([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ya([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),We=(Ya([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ya([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Pe=Ya([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ke(l,d,v){return l.sections.forEach(function(P){P.text=function(O,j,$){var K=j.layout.get("text-transform").evaluate($,{});return K==="uppercase"?O=O.toLocaleUpperCase():K==="lowercase"&&(O=O.toLocaleLowerCase()),Ks.applyArabicShaping&&(O=Ks.applyArabicShaping(O)),O}(P.text,d,v)}),l}Ya([{name:"triangle",components:3,type:"Uint16"}]),Ya([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ya([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ya([{type:"Float32",name:"offsetX"}]),Ya([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var st={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},pt=function(l,d,v,P,O){var j,$,K=8*O-P-1,le=(1<<K)-1,me=le>>1,be=-7,Ie=v?O-1:0,je=v?-1:1,Ye=l[d+Ie];for(Ie+=je,j=Ye&(1<<-be)-1,Ye>>=-be,be+=K;be>0;j=256*j+l[d+Ie],Ie+=je,be-=8);for($=j&(1<<-be)-1,j>>=-be,be+=P;be>0;$=256*$+l[d+Ie],Ie+=je,be-=8);if(j===0)j=1-me;else{if(j===le)return $?NaN:1/0*(Ye?-1:1);$+=Math.pow(2,P),j-=me}return(Ye?-1:1)*$*Math.pow(2,j-P)},Tt=function(l,d,v,P,O,j){var $,K,le,me=8*j-O-1,be=(1<<me)-1,Ie=be>>1,je=O===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ye=P?0:j-1,ct=P?1:-1,dt=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(K=isNaN(d)?1:0,$=be):($=Math.floor(Math.log(d)/Math.LN2),d*(le=Math.pow(2,-$))<1&&($--,le*=2),(d+=$+Ie>=1?je/le:je*Math.pow(2,1-Ie))*le>=2&&($++,le/=2),$+Ie>=be?(K=0,$=be):$+Ie>=1?(K=(d*le-1)*Math.pow(2,O),$+=Ie):(K=d*Math.pow(2,Ie-1)*Math.pow(2,O),$=0));O>=8;l[v+Ye]=255&K,Ye+=ct,K/=256,O-=8);for($=$<<O|K,me+=O;me>0;l[v+Ye]=255&$,Ye+=ct,$/=256,me-=8);l[v+Ye-ct]|=128*dt},Zt=xt;function xt(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}xt.Varint=0,xt.Fixed64=1,xt.Bytes=2,xt.Fixed32=5;var hr=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function tr(l){return l.type===xt.Bytes?l.readVarint()+l.pos:l.pos+1}function Cr(l,d,v){return v?4294967296*d+(l>>>0):4294967296*(d>>>0)+(l>>>0)}function zt(l,d,v){var P=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));v.realloc(P);for(var O=v.pos-1;O>=l;O--)v.buf[O+P]=v.buf[O]}function ir(l,d){for(var v=0;v<l.length;v++)d.writeVarint(l[v])}function vt(l,d){for(var v=0;v<l.length;v++)d.writeSVarint(l[v])}function Ut(l,d){for(var v=0;v<l.length;v++)d.writeFloat(l[v])}function Lr(l,d){for(var v=0;v<l.length;v++)d.writeDouble(l[v])}function Wr(l,d){for(var v=0;v<l.length;v++)d.writeBoolean(l[v])}function Gr(l,d){for(var v=0;v<l.length;v++)d.writeFixed32(l[v])}function tn(l,d){for(var v=0;v<l.length;v++)d.writeSFixed32(l[v])}function _n(l,d){for(var v=0;v<l.length;v++)d.writeFixed64(l[v])}function Fn(l,d){for(var v=0;v<l.length;v++)d.writeSFixed64(l[v])}function wn(l,d){return(l[d]|l[d+1]<<8|l[d+2]<<16)+16777216*l[d+3]}function Sn(l,d,v){l[v]=d,l[v+1]=d>>>8,l[v+2]=d>>>16,l[v+3]=d>>>24}function Mi(l,d){return(l[d]|l[d+1]<<8|l[d+2]<<16)+(l[d+3]<<24)}function pi(l,d,v){l===1&&v.readMessage(Ci,d)}function Ci(l,d,v){if(l===3){var P=v.readMessage(Ti,{}),O=P.width,j=P.height,$=P.left,K=P.top,le=P.advance;d.push({id:P.id,bitmap:new Mh({width:O+6,height:j+6},P.bitmap),metrics:{width:O,height:j,left:$,top:K,advance:le}})}}function Ti(l,d,v){l===1?d.id=v.readVarint():l===2?d.bitmap=v.readBytes():l===3?d.width=v.readVarint():l===4?d.height=v.readVarint():l===5?d.left=v.readSVarint():l===6?d.top=v.readSVarint():l===7&&(d.advance=v.readVarint())}function ro(l){for(var d=0,v=0,P=0,O=l;P<O.length;P+=1){var j=O[P];d+=j.w*j.h,v=Math.max(v,j.w)}l.sort(function(dt,kt){return kt.h-dt.h});for(var $=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),v),h:1/0}],K=0,le=0,me=0,be=l;me<be.length;me+=1)for(var Ie=be[me],je=$.length-1;je>=0;je--){var Ye=$[je];if(!(Ie.w>Ye.w||Ie.h>Ye.h)){if(Ie.x=Ye.x,Ie.y=Ye.y,le=Math.max(le,Ie.y+Ie.h),K=Math.max(K,Ie.x+Ie.w),Ie.w===Ye.w&&Ie.h===Ye.h){var ct=$.pop();je<$.length&&($[je]=ct)}else Ie.h===Ye.h?(Ye.x+=Ie.w,Ye.w-=Ie.w):Ie.w===Ye.w?(Ye.y+=Ie.h,Ye.h-=Ie.h):($.push({x:Ye.x+Ie.w,y:Ye.y,w:Ye.w-Ie.w,h:Ie.h}),Ye.y+=Ie.h,Ye.h-=Ie.h);break}}return{w:K,h:le,fill:d/(K*le)||0}}xt.prototype={destroy:function(){this.buf=null},readFields:function(l,d,v){for(v=v||this.length;this.pos<v;){var P=this.readVarint(),O=P>>3,j=this.pos;this.type=7&P,l(O,d,this),this.pos===j&&this.skip(P)}return d},readMessage:function(l,d){return this.readFields(l,d,this.readVarint()+this.pos)},readFixed32:function(){var l=wn(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=Mi(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=wn(this.buf,this.pos)+4294967296*wn(this.buf,this.pos+4);return this.pos+=8,l},readSFixed64:function(){var l=wn(this.buf,this.pos)+4294967296*Mi(this.buf,this.pos+4);return this.pos+=8,l},readFloat:function(){var l=pt(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=pt(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var d,v,P=this.buf;return d=127&(v=P[this.pos++]),v<128?d:(d|=(127&(v=P[this.pos++]))<<7,v<128?d:(d|=(127&(v=P[this.pos++]))<<14,v<128?d:(d|=(127&(v=P[this.pos++]))<<21,v<128?d:function(O,j,$){var K,le,me=$.buf;if(K=(112&(le=me[$.pos++]))>>4,le<128||(K|=(127&(le=me[$.pos++]))<<3,le<128)||(K|=(127&(le=me[$.pos++]))<<10,le<128)||(K|=(127&(le=me[$.pos++]))<<17,le<128)||(K|=(127&(le=me[$.pos++]))<<24,le<128)||(K|=(1&(le=me[$.pos++]))<<31,le<128))return Cr(O,K,j);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(v=P[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,d=this.pos;return this.pos=l,l-d>=12&&hr?function(v,P,O){return hr.decode(v.subarray(P,O))}(this.buf,d,l):function(v,P,O){for(var j="",$=P;$<O;){var K,le,me,be=v[$],Ie=null,je=be>239?4:be>223?3:be>191?2:1;if($+je>O)break;je===1?be<128&&(Ie=be):je===2?(192&(K=v[$+1]))==128&&(Ie=(31&be)<<6|63&K)<=127&&(Ie=null):je===3?(le=v[$+2],(192&(K=v[$+1]))==128&&(192&le)==128&&((Ie=(15&be)<<12|(63&K)<<6|63&le)<=2047||Ie>=55296&&Ie<=57343)&&(Ie=null)):je===4&&(le=v[$+2],me=v[$+3],(192&(K=v[$+1]))==128&&(192&le)==128&&(192&me)==128&&((Ie=(15&be)<<18|(63&K)<<12|(63&le)<<6|63&me)<=65535||Ie>=1114112)&&(Ie=null)),Ie===null?(Ie=65533,je=1):Ie>65535&&(Ie-=65536,j+=String.fromCharCode(Ie>>>10&1023|55296),Ie=56320|1023&Ie),j+=String.fromCharCode(Ie),$+=je}return j}(this.buf,d,l)},readBytes:function(){var l=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,l);return this.pos=l,d},readPackedVarint:function(l,d){if(this.type!==xt.Bytes)return l.push(this.readVarint(d));var v=tr(this);for(l=l||[];this.pos<v;)l.push(this.readVarint(d));return l},readPackedSVarint:function(l){if(this.type!==xt.Bytes)return l.push(this.readSVarint());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==xt.Bytes)return l.push(this.readBoolean());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==xt.Bytes)return l.push(this.readFloat());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==xt.Bytes)return l.push(this.readDouble());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==xt.Bytes)return l.push(this.readFixed32());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==xt.Bytes)return l.push(this.readSFixed32());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==xt.Bytes)return l.push(this.readFixed64());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==xt.Bytes)return l.push(this.readSFixed64());var d=tr(this);for(l=l||[];this.pos<d;)l.push(this.readSFixed64());return l},skip:function(l){var d=7&l;if(d===xt.Varint)for(;this.buf[this.pos++]>127;);else if(d===xt.Bytes)this.pos=this.readVarint()+this.pos;else if(d===xt.Fixed32)this.pos+=4;else{if(d!==xt.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(l,d){this.writeVarint(l<<3|d)},realloc:function(l){for(var d=this.length||16;d<this.pos+l;)d*=2;if(d!==this.length){var v=new Uint8Array(d);v.set(this.buf),this.buf=v,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),Sn(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),Sn(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),Sn(this.buf,-1&l,this.pos),Sn(this.buf,Math.floor(l*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),Sn(this.buf,-1&l,this.pos),Sn(this.buf,Math.floor(l*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(d,v){var P,O;if(d>=0?(P=d%4294967296|0,O=d/4294967296|0):(O=~(-d/4294967296),4294967295^(P=~(-d%4294967296))?P=P+1|0:(P=0,O=O+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");v.realloc(10),function(j,$,K){K.buf[K.pos++]=127&j|128,j>>>=7,K.buf[K.pos++]=127&j|128,j>>>=7,K.buf[K.pos++]=127&j|128,j>>>=7,K.buf[K.pos++]=127&j|128,K.buf[K.pos]=127&(j>>>=7)}(P,0,v),function(j,$){var K=(7&j)<<4;$.buf[$.pos++]|=K|((j>>>=3)?128:0),j&&($.buf[$.pos++]=127&j|((j>>>=7)?128:0),j&&($.buf[$.pos++]=127&j|((j>>>=7)?128:0),j&&($.buf[$.pos++]=127&j|((j>>>=7)?128:0),j&&($.buf[$.pos++]=127&j|((j>>>=7)?128:0),j&&($.buf[$.pos++]=127&j)))))}(O,v)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var d=this.pos;this.pos=function(P,O,j){for(var $,K,le=0;le<O.length;le++){if(($=O.charCodeAt(le))>55295&&$<57344){if(!K){$>56319||le+1===O.length?(P[j++]=239,P[j++]=191,P[j++]=189):K=$;continue}if($<56320){P[j++]=239,P[j++]=191,P[j++]=189,K=$;continue}$=K-55296<<10|$-56320|65536,K=null}else K&&(P[j++]=239,P[j++]=191,P[j++]=189,K=null);$<128?P[j++]=$:($<2048?P[j++]=$>>6|192:($<65536?P[j++]=$>>12|224:(P[j++]=$>>18|240,P[j++]=$>>12&63|128),P[j++]=$>>6&63|128),P[j++]=63&$|128)}return j}(this.buf,l,this.pos);var v=this.pos-d;v>=128&&zt(d,v,this),this.pos=d-1,this.writeVarint(v),this.pos+=v},writeFloat:function(l){this.realloc(4),Tt(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),Tt(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var d=l.length;this.writeVarint(d),this.realloc(d);for(var v=0;v<d;v++)this.buf[this.pos++]=l[v]},writeRawMessage:function(l,d){this.pos++;var v=this.pos;l(d,this);var P=this.pos-v;P>=128&&zt(v,P,this),this.pos=v-1,this.writeVarint(P),this.pos+=P},writeMessage:function(l,d,v){this.writeTag(l,xt.Bytes),this.writeRawMessage(d,v)},writePackedVarint:function(l,d){d.length&&this.writeMessage(l,ir,d)},writePackedSVarint:function(l,d){d.length&&this.writeMessage(l,vt,d)},writePackedBoolean:function(l,d){d.length&&this.writeMessage(l,Wr,d)},writePackedFloat:function(l,d){d.length&&this.writeMessage(l,Ut,d)},writePackedDouble:function(l,d){d.length&&this.writeMessage(l,Lr,d)},writePackedFixed32:function(l,d){d.length&&this.writeMessage(l,Gr,d)},writePackedSFixed32:function(l,d){d.length&&this.writeMessage(l,tn,d)},writePackedFixed64:function(l,d){d.length&&this.writeMessage(l,_n,d)},writePackedSFixed64:function(l,d){d.length&&this.writeMessage(l,Fn,d)},writeBytesField:function(l,d){this.writeTag(l,xt.Bytes),this.writeBytes(d)},writeFixed32Field:function(l,d){this.writeTag(l,xt.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(l,d){this.writeTag(l,xt.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(l,d){this.writeTag(l,xt.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(l,d){this.writeTag(l,xt.Fixed64),this.writeSFixed64(d)},writeVarintField:function(l,d){this.writeTag(l,xt.Varint),this.writeVarint(d)},writeSVarintField:function(l,d){this.writeTag(l,xt.Varint),this.writeSVarint(d)},writeStringField:function(l,d){this.writeTag(l,xt.Bytes),this.writeString(d)},writeFloatField:function(l,d){this.writeTag(l,xt.Fixed32),this.writeFloat(d)},writeDoubleField:function(l,d){this.writeTag(l,xt.Fixed64),this.writeDouble(d)},writeBooleanField:function(l,d){this.writeVarintField(l,!!d)}};var Ro=function(l,d){var v=d.pixelRatio,P=d.version,O=d.stretchX,j=d.stretchY,$=d.content;this.paddedRect=l,this.pixelRatio=v,this.stretchX=O,this.stretchY=j,this.content=$,this.version=P},Vi={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Vi.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Vi.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Vi.tlbr.get=function(){return this.tl.concat(this.br)},Vi.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Ro.prototype,Vi);var Zo=function(l,d){var v={},P={};this.haveRenderCallbacks=[];var O=[];this.addImages(l,v,O),this.addImages(d,P,O);var j=ro(O),$=new Ja({width:j.w||1,height:j.h||1});for(var K in l){var le=l[K],me=v[K].paddedRect;Ja.copy(le.data,$,{x:0,y:0},{x:me.x+1,y:me.y+1},le.data)}for(var be in d){var Ie=d[be],je=P[be].paddedRect,Ye=je.x+1,ct=je.y+1,dt=Ie.data.width,kt=Ie.data.height;Ja.copy(Ie.data,$,{x:0,y:0},{x:Ye,y:ct},Ie.data),Ja.copy(Ie.data,$,{x:0,y:kt-1},{x:Ye,y:ct-1},{width:dt,height:1}),Ja.copy(Ie.data,$,{x:0,y:0},{x:Ye,y:ct+kt},{width:dt,height:1}),Ja.copy(Ie.data,$,{x:dt-1,y:0},{x:Ye-1,y:ct},{width:1,height:kt}),Ja.copy(Ie.data,$,{x:0,y:0},{x:Ye+dt,y:ct},{width:1,height:kt})}this.image=$,this.iconPositions=v,this.patternPositions=P};Zo.prototype.addImages=function(l,d,v){for(var P in l){var O=l[P],j={x:0,y:0,w:O.data.width+2,h:O.data.height+2};v.push(j),d[P]=new Ro(j,O),O.hasRenderCallback&&this.haveRenderCallbacks.push(P)}},Zo.prototype.patchUpdatedImages=function(l,d){for(var v in l.dispatchRenderCallbacks(this.haveRenderCallbacks),l.updatedImages)this.patchUpdatedImage(this.iconPositions[v],l.getImage(v),d),this.patchUpdatedImage(this.patternPositions[v],l.getImage(v),d)},Zo.prototype.patchUpdatedImage=function(l,d,v){if(l&&d&&l.version!==d.version){l.version=d.version;var P=l.tl;v.update(d.data,void 0,{x:P[0],y:P[1]})}},Rn("ImagePosition",Ro),Rn("ImageAtlas",Zo);var fi={horizontal:1,vertical:2,horizontalOnly:3},Ji=function(){this.scale=1,this.fontStack="",this.imageName=null};Ji.forText=function(l,d){var v=new Ji;return v.scale=l||1,v.fontStack=d,v},Ji.forImage=function(l){var d=new Ji;return d.imageName=l,d};var oi=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function no(l,d,v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt){var kt,St=oi.fromFeature(l,O);Ie===fi.vertical&&St.verticalizePunctuation();var Gt=Ks.processBidirectionalText,or=Ks.processStyledBidirectionalText;if(Gt&&St.sections.length===1){kt=[];for(var gr=0,yr=Gt(St.toString(),Sl(St,me,j,d,P,Ye,ct));gr<yr.length;gr+=1){var zr=yr[gr],Qr=new oi;Qr.text=zr,Qr.sections=St.sections;for(var nn=0;nn<zr.length;nn++)Qr.sectionIndex.push(0);kt.push(Qr)}}else if(or){kt=[];for(var Zn=0,Tn=or(St.text,St.sectionIndex,Sl(St,me,j,d,P,Ye,ct));Zn<Tn.length;Zn+=1){var li=Tn[Zn],En=new oi;En.text=li[0],En.sectionIndex=li[1],En.sections=St.sections,kt.push(En)}}else kt=function(Mn,uo){for(var hn=[],wo=Mn.text,jn=0,ho=0,da=uo;ho<da.length;ho+=1){var Oa=da[ho];hn.push(Mn.substring(jn,Oa)),jn=Oa}return jn<wo.length&&hn.push(Mn.substring(jn,wo.length)),hn}(St,Sl(St,me,j,d,P,Ye,ct));var Qi=[],Ai={positionedLines:Qi,text:St.toString(),top:be[1],bottom:be[1],left:be[0],right:be[0],writingMode:Ie,iconsInText:!1,verticalizable:!1};return function(Mn,uo,hn,wo,jn,ho,da,Oa,ba,pa,La,bs){for(var ws=0,hl=-17,hs=0,ei=0,za=Oa==="right"?1:Oa==="left"?0:.5,Na=0,fo=0,Yo=jn;fo<Yo.length;fo+=1){var $o=Yo[fo];$o.trim();var Ao=$o.getMaxScale(),El=24*(Ao-1),Qs={positionedGlyphs:[],lineOffset:0};Mn.positionedLines[Na]=Qs;var la=Qs.positionedGlyphs,Qa=0;if($o.length()){for(var el=0;el<$o.length();el++){var Do=$o.getSection(el),th=$o.getSectionIndex(el),$c=$o.getCharCode(el),Rd=0,es=null,Dd=null,rh=null,rg=24,sm=!(ba===fi.horizontal||!La&&!Ys($c)||La&&(Bo[$c]||(Od=$c,un.Arabic(Od)||un["Arabic Supplement"](Od)||un["Arabic Extended-A"](Od)||un["Arabic Presentation Forms-A"](Od)||un["Arabic Presentation Forms-B"](Od))));if(Do.imageName){var ng=wo[Do.imageName];if(!ng)continue;rh=Do.imageName,Mn.iconsInText=Mn.iconsInText||!0,Dd=ng.paddedRect;var vp=ng.displaySize;Do.scale=24*Do.scale/bs,Rd=El+(24-vp[1]*Do.scale),rg=(es={width:vp[0],height:vp[1],left:1,top:-3,advance:sm?vp[1]:vp[0]}).advance;var ig=sm?vp[0]*Do.scale-24*Ao:vp[1]*Do.scale-24*Ao;ig>0&&ig>Qa&&(Qa=ig)}else{var N_=hn[Do.fontStack],wc=N_&&N_[$c];if(wc&&wc.rect)Dd=wc.rect,es=wc.metrics;else{var lm=uo[Do.fontStack],og=lm&&lm[$c];if(!og)continue;es=og.metrics}Rd=24*(Ao-Do.scale)}sm?(Mn.verticalizable=!0,la.push({glyph:$c,imageName:rh,x:ws,y:hl+Rd,vertical:sm,scale:Do.scale,fontStack:Do.fontStack,sectionIndex:th,metrics:es,rect:Dd}),ws+=rg*Do.scale+pa):(la.push({glyph:$c,imageName:rh,x:ws,y:hl+Rd,vertical:sm,scale:Do.scale,fontStack:Do.fontStack,sectionIndex:th,metrics:es,rect:Dd}),ws+=es.advance*Do.scale+pa)}la.length!==0&&(hs=Math.max(ws-pa,hs),ls(la,0,la.length-1,za,Qa)),ws=0;var pf=ho*Ao+Qa;Qs.lineOffset=Math.max(Qa,El),hl+=pf,ei=Math.max(pf,ei),++Na}else hl+=ho,++Na}var Od,ag=hl- -17,cm=ss(da),Ld=cm.horizontalAlign,Ko=cm.verticalAlign;(function(Hy,um,j_,sg,hm,B_,lg,F_,cg){var Sc,nh=(um-j_)*hm;Sc=B_!==lg?-F_*sg- -17:(-sg*cg+.5)*lg;for(var dm=0,ug=Hy;dm<ug.length;dm+=1)for(var zd=0,pm=ug[dm].positionedGlyphs;zd<pm.length;zd+=1){var Nd=pm[zd];Nd.x+=nh,Nd.y+=Sc}})(Mn.positionedLines,za,Ld,Ko,hs,ei,ho,ag,jn.length),Mn.top+=-Ko*ag,Mn.bottom=Mn.top+ag,Mn.left+=-Ld*hs,Mn.right=Mn.left+hs}(Ai,d,v,P,kt,$,K,le,Ie,me,je,dt),!function(Mn){for(var uo=0,hn=Mn;uo<hn.length;uo+=1)if(hn[uo].positionedGlyphs.length!==0)return!1;return!0}(Qi)&&Ai}oi.fromFeature=function(l,d){for(var v=new oi,P=0;P<l.sections.length;P++){var O=l.sections[P];O.image?v.addImageSection(O):v.addTextSection(O,d)}return v},oi.prototype.length=function(){return this.text.length},oi.prototype.getSection=function(l){return this.sections[this.sectionIndex[l]]},oi.prototype.getSectionIndex=function(l){return this.sectionIndex[l]},oi.prototype.getCharCode=function(l){return this.text.charCodeAt(l)},oi.prototype.verticalizePunctuation=function(){this.text=function(l){for(var d="",v=0;v<l.length;v++){var P=l.charCodeAt(v+1)||null,O=l.charCodeAt(v-1)||null;d+=P&&Gu(P)&&!st[l[v+1]]||O&&Gu(O)&&!st[l[v-1]]||!st[l[v]]?l[v]:st[l[v]]}return d}(this.text)},oi.prototype.trim=function(){for(var l=0,d=0;d<this.text.length&&Bo[this.text.charCodeAt(d)];d++)l++;for(var v=this.text.length,P=this.text.length-1;P>=0&&P>=l&&Bo[this.text.charCodeAt(P)];P--)v--;this.text=this.text.substring(l,v),this.sectionIndex=this.sectionIndex.slice(l,v)},oi.prototype.substring=function(l,d){var v=new oi;return v.text=this.text.substring(l,d),v.sectionIndex=this.sectionIndex.slice(l,d),v.sections=this.sections,v},oi.prototype.toString=function(){return this.text},oi.prototype.getMaxScale=function(){var l=this;return this.sectionIndex.reduce(function(d,v){return Math.max(d,l.sections[v].scale)},0)},oi.prototype.addTextSection=function(l,d){this.text+=l.text,this.sections.push(Ji.forText(l.scale,l.fontStack||d));for(var v=this.sections.length-1,P=0;P<l.text.length;++P)this.sectionIndex.push(v)},oi.prototype.addImageSection=function(l){var d=l.image?l.image.name:"";if(d.length!==0){var v=this.getNextImageSectionCharCode();v?(this.text+=String.fromCharCode(v),this.sections.push(Ji.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Ar("Reached maximum number of images 6401")}else Ar("Can't add FormattedSection with an empty image.")},oi.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Bo={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ji={};function vs(l,d,v,P,O,j){if(d.imageName){var $=P[d.imageName];return $?$.displaySize[0]*d.scale*24/j+O:0}var K=v[d.fontStack],le=K&&K[l];return le?le.metrics.advance*d.scale+O:0}function js(l,d,v,P){var O=Math.pow(l-d,2);return P?l<d?O/2:2*O:O+Math.abs(v)*v}function ac(l,d,v){var P=0;return l===10&&(P-=1e4),v&&(P+=150),l!==40&&l!==65288||(P+=50),d!==41&&d!==65289||(P+=50),P}function bu(l,d,v,P,O,j){for(var $=null,K=js(d,v,O,j),le=0,me=P;le<me.length;le+=1){var be=me[le],Ie=js(d-be.x,v,O,j)+be.badness;Ie<=K&&($=be,K=Ie)}return{index:l,x:d,priorBreak:$,badness:K}}function Sl(l,d,v,P,O,j,$){if(j!=="point")return[];if(!l)return[];for(var K,le=[],me=function(kt,St,Gt,or,gr,yr){for(var zr=0,Qr=0;Qr<kt.length();Qr++){var nn=kt.getSection(Qr);zr+=vs(kt.getCharCode(Qr),nn,or,gr,St,yr)}return zr/Math.max(1,Math.ceil(zr/Gt))}(l,d,v,P,O,$),be=l.text.indexOf("​")>=0,Ie=0,je=0;je<l.length();je++){var Ye=l.getSection(je),ct=l.getCharCode(je);if(Bo[ct]||(Ie+=vs(ct,Ye,P,O,d,$)),je<l.length()-1){var dt=!((K=ct)<11904||!(un["Bopomofo Extended"](K)||un.Bopomofo(K)||un["CJK Compatibility Forms"](K)||un["CJK Compatibility Ideographs"](K)||un["CJK Compatibility"](K)||un["CJK Radicals Supplement"](K)||un["CJK Strokes"](K)||un["CJK Symbols and Punctuation"](K)||un["CJK Unified Ideographs Extension A"](K)||un["CJK Unified Ideographs"](K)||un["Enclosed CJK Letters and Months"](K)||un["Halfwidth and Fullwidth Forms"](K)||un.Hiragana(K)||un["Ideographic Description Characters"](K)||un["Kangxi Radicals"](K)||un["Katakana Phonetic Extensions"](K)||un.Katakana(K)||un["Vertical Forms"](K)||un["Yi Radicals"](K)||un["Yi Syllables"](K)));(ji[ct]||dt||Ye.imageName)&&le.push(bu(je+1,Ie,me,le,ac(ct,l.getCharCode(je+1),dt&&be),!1))}}return function kt(St){return St?kt(St.priorBreak).concat(St.index):[]}(bu(l.length(),Ie,me,le,0,!0))}function ss(l){var d=.5,v=.5;switch(l){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":v=1;break;case"top":case"top-right":case"top-left":v=0}return{horizontalAlign:d,verticalAlign:v}}function ls(l,d,v,P,O){if(P||O)for(var j=l[v],$=(l[v].x+j.metrics.advance*j.scale)*P,K=d;K<=v;K++)l[K].x-=$,l[K].y+=O}function ul(l,d,v,P,O,j){var $,K=l.image;if(K.content){var le=K.content,me=K.pixelRatio||1;$=[le[0]/me,le[1]/me,K.displaySize[0]-le[2]/me,K.displaySize[1]-le[3]/me]}var be,Ie,je,Ye,ct=d.left*j,dt=d.right*j;v==="width"||v==="both"?(Ye=O[0]+ct-P[3],Ie=O[0]+dt+P[1]):Ie=(Ye=O[0]+(ct+dt-K.displaySize[0])/2)+K.displaySize[0];var kt=d.top*j,St=d.bottom*j;return v==="height"||v==="both"?(be=O[1]+kt-P[0],je=O[1]+St+P[2]):je=(be=O[1]+(kt+St-K.displaySize[1])/2)+K.displaySize[1],{image:K,top:be,right:Ie,bottom:je,left:Ye,collisionPadding:$}}ji[10]=!0,ji[32]=!0,ji[38]=!0,ji[40]=!0,ji[41]=!0,ji[43]=!0,ji[45]=!0,ji[47]=!0,ji[173]=!0,ji[183]=!0,ji[8203]=!0,ji[8208]=!0,ji[8211]=!0,ji[8231]=!0;var Ps=function(l){function d(v,P,O,j){l.call(this,v,P),this.angle=O,j!==void 0&&(this.segment=j)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(G);function Tl(l,d){var v=d.expression;if(v.kind==="constant")return{kind:"constant",layoutSize:v.evaluate(new oo(l+1))};if(v.kind==="source")return{kind:"source"};for(var P=v.zoomStops,O=v.interpolationType,j=0;j<P.length&&P[j]<=l;)j++;for(var $=j=Math.max(0,j-1);$<P.length&&P[$]<l+1;)$++;$=Math.min(P.length-1,$);var K=P[j],le=P[$];return v.kind==="composite"?{kind:"composite",minZoom:K,maxZoom:le,interpolationType:O}:{kind:"camera",minZoom:K,maxZoom:le,minSize:v.evaluate(new oo(K)),maxSize:v.evaluate(new oo(le)),interpolationType:O}}function wu(l,d,v){var P=d.uSize,O=v.lowerSize;return l.kind==="source"?O/128:l.kind==="composite"?lo(O/128,v.upperSize/128,d.uSizeT):P}function Oh(l,d){var v=0,P=0;if(l.kind==="constant")P=l.layoutSize;else if(l.kind!=="source"){var O=l.interpolationType,j=O?Te(Ga.interpolationFactor(O,d,l.minZoom,l.maxZoom),0,1):0;l.kind==="camera"?P=lo(l.minSize,l.maxSize,j):v=j}return{uSizeT:v,uSize:P}}Rn("Anchor",Ps);var gp=Object.freeze({__proto__:null,getSizeData:Tl,evaluateSizeForFeature:wu,evaluateSizeForZoom:Oh,SIZE_PACK_FACTOR:128});function of(l,d,v,P,O){if(d.segment===void 0)return!0;for(var j=d,$=d.segment+1,K=0;K>-v/2;){if(--$<0)return!1;K-=l[$].dist(j),j=l[$]}K+=l[$].dist(l[$+1]),$++;for(var le=[],me=0;K<v/2;){var be=l[$],Ie=l[$+1];if(!Ie)return!1;var je=l[$-1].angleTo(be)-be.angleTo(Ie);for(je=Math.abs((je+3*Math.PI)%(2*Math.PI)-Math.PI),le.push({distance:K,angleDelta:je}),me+=je;K-le[0].distance>P;)me-=le.shift().angleDelta;if(me>O)return!1;$++,K+=be.dist(Ie)}return!0}function af(l){for(var d=0,v=0;v<l.length-1;v++)d+=l[v].dist(l[v+1]);return d}function Jm(l,d,v){return l?.6*d*v:0}function sf(l,d){return Math.max(l?l.right-l.left:0,d?d.right-d.left:0)}function lf(l,d,v,P,O,j){for(var $=Jm(v,O,j),K=sf(v,P)*j,le=0,me=af(l)/2,be=0;be<l.length-1;be++){var Ie=l[be],je=l[be+1],Ye=Ie.dist(je);if(le+Ye>me){var ct=(me-le)/Ye,dt=lo(Ie.x,je.x,ct),kt=lo(Ie.y,je.y,ct),St=new Ps(dt,kt,je.angleTo(Ie),be);return St._round(),!$||of(l,St,K,$,d)?St:void 0}le+=Ye}}function Qm(l,d,v,P,O,j,$,K,le){var me=Jm(P,j,$),be=sf(P,O),Ie=be*$,je=l[0].x===0||l[0].x===le||l[0].y===0||l[0].y===le;return d-Ie<d/4&&(d=Ie+d/4),function Ye(ct,dt,kt,St,Gt,or,gr,yr,zr){for(var Qr=or/2,nn=af(ct),Zn=0,Tn=dt-kt,li=[],En=0;En<ct.length-1;En++){for(var Qi=ct[En],Ai=ct[En+1],Mn=Qi.dist(Ai),uo=Ai.angleTo(Qi);Tn+kt<Zn+Mn;){var hn=((Tn+=kt)-Zn)/Mn,wo=lo(Qi.x,Ai.x,hn),jn=lo(Qi.y,Ai.y,hn);if(wo>=0&&wo<zr&&jn>=0&&jn<zr&&Tn-Qr>=0&&Tn+Qr<=nn){var ho=new Ps(wo,jn,uo,En);ho._round(),St&&!of(ct,ho,or,St,Gt)||li.push(ho)}}Zn+=Mn}return yr||li.length||gr||(li=Ye(ct,Zn/2,kt,St,Gt,or,gr,!0,zr)),li}(l,je?d/2*K%d:(be/2+2*j)*$*K%d,d,me,v,Ie,je,!1,le)}function Qu(l,d,v,P,O){for(var j=[],$=0;$<l.length;$++)for(var K=l[$],le=void 0,me=0;me<K.length-1;me++){var be=K[me],Ie=K[me+1];be.x<d&&Ie.x<d||(be.x<d?be=new G(d,be.y+(d-be.x)/(Ie.x-be.x)*(Ie.y-be.y))._round():Ie.x<d&&(Ie=new G(d,be.y+(d-be.x)/(Ie.x-be.x)*(Ie.y-be.y))._round()),be.y<v&&Ie.y<v||(be.y<v?be=new G(be.x+(v-be.y)/(Ie.y-be.y)*(Ie.x-be.x),v)._round():Ie.y<v&&(Ie=new G(be.x+(v-be.y)/(Ie.y-be.y)*(Ie.x-be.x),v)._round()),be.x>=P&&Ie.x>=P||(be.x>=P?be=new G(P,be.y+(P-be.x)/(Ie.x-be.x)*(Ie.y-be.y))._round():Ie.x>=P&&(Ie=new G(P,be.y+(P-be.x)/(Ie.x-be.x)*(Ie.y-be.y))._round()),be.y>=O&&Ie.y>=O||(be.y>=O?be=new G(be.x+(O-be.y)/(Ie.y-be.y)*(Ie.x-be.x),O)._round():Ie.y>=O&&(Ie=new G(be.x+(O-be.y)/(Ie.y-be.y)*(Ie.x-be.x),O)._round()),le&&be.equals(le[le.length-1])||j.push(le=[be]),le.push(Ie)))))}return j}function L0(l,d,v,P){var O=[],j=l.image,$=j.pixelRatio,K=j.paddedRect.w-2,le=j.paddedRect.h-2,me=l.right-l.left,be=l.bottom-l.top,Ie=j.stretchX||[[0,K]],je=j.stretchY||[[0,le]],Ye=function(wo,jn){return wo+jn[1]-jn[0]},ct=Ie.reduce(Ye,0),dt=je.reduce(Ye,0),kt=K-ct,St=le-dt,Gt=0,or=ct,gr=0,yr=dt,zr=0,Qr=kt,nn=0,Zn=St;if(j.content&&P){var Tn=j.content;Gt=By(Ie,0,Tn[0]),gr=By(je,0,Tn[1]),or=By(Ie,Tn[0],Tn[2]),yr=By(je,Tn[1],Tn[3]),zr=Tn[0]-Gt,nn=Tn[1]-gr,Qr=Tn[2]-Tn[0]-or,Zn=Tn[3]-Tn[1]-yr}var li=function(wo,jn,ho,da){var Oa=eg(wo.stretch-Gt,or,me,l.left),ba=_p(wo.fixed-zr,Qr,wo.stretch,ct),pa=eg(jn.stretch-gr,yr,be,l.top),La=_p(jn.fixed-nn,Zn,jn.stretch,dt),bs=eg(ho.stretch-Gt,or,me,l.left),ws=_p(ho.fixed-zr,Qr,ho.stretch,ct),hl=eg(da.stretch-gr,yr,be,l.top),hs=_p(da.fixed-nn,Zn,da.stretch,dt),ei=new G(Oa,pa),za=new G(bs,pa),Na=new G(bs,hl),fo=new G(Oa,hl),Yo=new G(ba/$,La/$),$o=new G(ws/$,hs/$),Ao=d*Math.PI/180;if(Ao){var El=Math.sin(Ao),Qs=Math.cos(Ao),la=[Qs,-El,El,Qs];ei._matMult(la),za._matMult(la),fo._matMult(la),Na._matMult(la)}var Qa=wo.stretch+wo.fixed,el=jn.stretch+jn.fixed;return{tl:ei,tr:za,bl:fo,br:Na,tex:{x:j.paddedRect.x+1+Qa,y:j.paddedRect.y+1+el,w:ho.stretch+ho.fixed-Qa,h:da.stretch+da.fixed-el},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yo,pixelOffsetBR:$o,minFontScaleX:Qr/$/me,minFontScaleY:Zn/$/be,isSDF:v}};if(P&&(j.stretchX||j.stretchY))for(var En=tm(Ie,kt,ct),Qi=tm(je,St,dt),Ai=0;Ai<En.length-1;Ai++)for(var Mn=En[Ai],uo=En[Ai+1],hn=0;hn<Qi.length-1;hn++)O.push(li(Mn,Qi[hn],uo,Qi[hn+1]));else O.push(li({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:K+1},{fixed:0,stretch:le+1}));return O}function By(l,d,v){for(var P=0,O=0,j=l;O<j.length;O+=1){var $=j[O];P+=Math.max(d,Math.min(v,$[1]))-Math.max(d,Math.min(v,$[0]))}return P}function tm(l,d,v){for(var P=[{fixed:-1,stretch:0}],O=0,j=l;O<j.length;O+=1){var $=j[O],K=$[0],le=$[1],me=P[P.length-1];P.push({fixed:K-me.stretch,stretch:me.stretch}),P.push({fixed:K-me.stretch,stretch:me.stretch+(le-K)})}return P.push({fixed:d+1,stretch:v}),P}function eg(l,d,v,P){return l/d*v+P}function _p(l,d,v,P){return l-d*v/P}var rm=function(l,d,v,P,O,j,$,K,le,me){if(this.boxStartIndex=l.length,le){var be=j.top,Ie=j.bottom,je=j.collisionPadding;je&&(be-=je[1],Ie+=je[3]);var Ye=Ie-be;Ye>0&&(Ye=Math.max(10,Ye),this.circleDiameter=Ye)}else{var ct=j.top*$-K,dt=j.bottom*$+K,kt=j.left*$-K,St=j.right*$+K,Gt=j.collisionPadding;if(Gt&&(kt-=Gt[0]*$,ct-=Gt[1]*$,St+=Gt[2]*$,dt+=Gt[3]*$),me){var or=new G(kt,ct),gr=new G(St,ct),yr=new G(kt,dt),zr=new G(St,dt),Qr=me*Math.PI/180;or._rotate(Qr),gr._rotate(Qr),yr._rotate(Qr),zr._rotate(Qr),kt=Math.min(or.x,gr.x,yr.x,zr.x),St=Math.max(or.x,gr.x,yr.x,zr.x),ct=Math.min(or.y,gr.y,yr.y,zr.y),dt=Math.max(or.y,gr.y,yr.y,zr.y)}l.emplaceBack(d.x,d.y,kt,ct,St,dt,v,P,O)}this.boxEndIndex=l.length},nm=function(l,d){if(l===void 0&&(l=[]),d===void 0&&(d=wb),this.data=l,this.length=this.data.length,this.compare=d,this.length>0)for(var v=(this.length>>1)-1;v>=0;v--)this._down(v)};function wb(l,d){return l<d?-1:l>d?1:0}function jT(l,d,v){d===void 0&&(d=1),v===void 0&&(v=!1);for(var P=1/0,O=1/0,j=-1/0,$=-1/0,K=l[0],le=0;le<K.length;le++){var me=K[le];(!le||me.x<P)&&(P=me.x),(!le||me.y<O)&&(O=me.y),(!le||me.x>j)&&(j=me.x),(!le||me.y>$)&&($=me.y)}var be=Math.min(j-P,$-O),Ie=be/2,je=new nm([],BT);if(be===0)return new G(P,O);for(var Ye=P;Ye<j;Ye+=be)for(var ct=O;ct<$;ct+=be)je.push(new Ha(Ye+Ie,ct+Ie,Ie,l));for(var dt=function(Gt){for(var or=0,gr=0,yr=0,zr=Gt[0],Qr=0,nn=zr.length,Zn=nn-1;Qr<nn;Zn=Qr++){var Tn=zr[Qr],li=zr[Zn],En=Tn.x*li.y-li.x*Tn.y;gr+=(Tn.x+li.x)*En,yr+=(Tn.y+li.y)*En,or+=3*En}return new Ha(gr/or,yr/or,0,Gt)}(l),kt=je.length;je.length;){var St=je.pop();(St.d>dt.d||!dt.d)&&(dt=St,v&&console.log("found best %d after %d probes",Math.round(1e4*St.d)/1e4,kt)),St.max-dt.d<=d||(je.push(new Ha(St.p.x-(Ie=St.h/2),St.p.y-Ie,Ie,l)),je.push(new Ha(St.p.x+Ie,St.p.y-Ie,Ie,l)),je.push(new Ha(St.p.x-Ie,St.p.y+Ie,Ie,l)),je.push(new Ha(St.p.x+Ie,St.p.y+Ie,Ie,l)),kt+=4)}return v&&(console.log("num probes: "+kt),console.log("best distance: "+dt.d)),dt.p}function BT(l,d){return d.max-l.max}function Ha(l,d,v,P){this.p=new G(l,d),this.h=v,this.d=function(O,j){for(var $=!1,K=1/0,le=0;le<j.length;le++)for(var me=j[le],be=0,Ie=me.length,je=Ie-1;be<Ie;je=be++){var Ye=me[be],ct=me[je];Ye.y>O.y!=ct.y>O.y&&O.x<(ct.x-Ye.x)*(O.y-Ye.y)/(ct.y-Ye.y)+Ye.x&&($=!$),K=Math.min(K,Sd(O,Ye,ct))}return($?1:-1)*Math.sqrt(K)}(this.p,P),this.max=this.d+this.h*Math.SQRT2}nm.prototype.push=function(l){this.data.push(l),this.length++,this._up(this.length-1)},nm.prototype.pop=function(){if(this.length!==0){var l=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),l}},nm.prototype.peek=function(){return this.data[0]},nm.prototype._up=function(l){for(var d=this.data,v=this.compare,P=d[l];l>0;){var O=l-1>>1,j=d[O];if(v(P,j)>=0)break;d[l]=j,l=O}d[l]=P},nm.prototype._down=function(l){for(var d=this.data,v=this.compare,P=this.length>>1,O=d[l];l<P;){var j=1+(l<<1),$=d[j],K=j+1;if(K<this.length&&v(d[K],$)<0&&(j=K,$=d[K]),v($,O)>=0)break;d[l]=$,l=j}d[l]=O};var xs=Number.POSITIVE_INFINITY;function z0(l,d){return d[1]!==xs?function(v,P,O){var j=0,$=0;switch(P=Math.abs(P),O=Math.abs(O),v){case"top-right":case"top-left":case"top":$=O-7;break;case"bottom-right":case"bottom-left":case"bottom":$=7-O}switch(v){case"top-right":case"bottom-right":case"right":j=-P;break;case"top-left":case"bottom-left":case"left":j=P}return[j,$]}(l,d[0],d[1]):function(v,P){var O=0,j=0;P<0&&(P=0);var $=P/Math.sqrt(2);switch(v){case"top-right":case"top-left":j=$-7;break;case"bottom-right":case"bottom-left":j=7-$;break;case"bottom":j=7-P;break;case"top":j=P-7}switch(v){case"top-right":case"bottom-right":O=-$;break;case"top-left":case"bottom-left":O=$;break;case"left":O=P;break;case"right":O=-P}return[O,j]}(l,d[0])}function Fy(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Sb(l,d,v,P,O,j,$,K,le,me,be,Ie,je,Ye,ct){var dt=function(gr,yr,zr,Qr,nn,Zn,Tn,li){for(var En=Qr.layout.get("text-rotate").evaluate(Zn,{})*Math.PI/180,Qi=[],Ai=0,Mn=yr.positionedLines;Ai<Mn.length;Ai+=1)for(var uo=Mn[Ai],hn=0,wo=uo.positionedGlyphs;hn<wo.length;hn+=1){var jn=wo[hn];if(jn.rect){var ho=jn.rect||{},da=4,Oa=!0,ba=1,pa=0,La=(nn||li)&&jn.vertical,bs=jn.metrics.advance*jn.scale/2;if(li&&yr.verticalizable&&(pa=uo.lineOffset/2-(jn.imageName?-(24-jn.metrics.width*jn.scale)/2:24*(jn.scale-1))),jn.imageName){var ws=Tn[jn.imageName];Oa=ws.sdf,da=1/(ba=ws.pixelRatio)}var hl=nn?[jn.x+bs,jn.y]:[0,0],hs=nn?[0,0]:[jn.x+bs+zr[0],jn.y+zr[1]-pa],ei=[0,0];La&&(ei=hs,hs=[0,0]);var za=(jn.metrics.left-da)*jn.scale-bs+hs[0],Na=(-jn.metrics.top-da)*jn.scale+hs[1],fo=za+ho.w*jn.scale/ba,Yo=Na+ho.h*jn.scale/ba,$o=new G(za,Na),Ao=new G(fo,Na),El=new G(za,Yo),Qs=new G(fo,Yo);if(La){var la=new G(-bs,bs- -17),Qa=-Math.PI/2,el=12-bs,Do=new G(22-el,-(jn.imageName?el:0)),th=new(Function.prototype.bind.apply(G,[null].concat(ei)));$o._rotateAround(Qa,la)._add(Do)._add(th),Ao._rotateAround(Qa,la)._add(Do)._add(th),El._rotateAround(Qa,la)._add(Do)._add(th),Qs._rotateAround(Qa,la)._add(Do)._add(th)}if(En){var $c=Math.sin(En),Rd=Math.cos(En),es=[Rd,-$c,$c,Rd];$o._matMult(es),Ao._matMult(es),El._matMult(es),Qs._matMult(es)}var Dd=new G(0,0),rh=new G(0,0);Qi.push({tl:$o,tr:Ao,bl:El,br:Qs,tex:ho,writingMode:yr.writingMode,glyphOffset:hl,sectionIndex:jn.sectionIndex,isSDF:Oa,pixelOffsetTL:Dd,pixelOffsetBR:rh,minFontScaleX:0,minFontScaleY:0})}}return Qi}(0,v,K,O,j,$,P,l.allowVerticalPlacement),kt=l.textSizeData,St=null;kt.kind==="source"?(St=[128*O.layout.get("text-size").evaluate($,{})])[0]>32640&&Ar(l.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):kt.kind==="composite"&&((St=[128*Ye.compositeTextSizes[0].evaluate($,{},ct),128*Ye.compositeTextSizes[1].evaluate($,{},ct)])[0]>32640||St[1]>32640)&&Ar(l.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),l.addSymbols(l.text,dt,St,K,j,$,me,d,le.lineStartIndex,le.lineLength,je,ct);for(var Gt=0,or=be;Gt<or.length;Gt+=1)Ie[or[Gt]]=l.text.placedSymbolArray.length-1;return 4*dt.length}function Tb(l){for(var d in l)return l[d];return null}function ha(l,d,v,P){var O=l.compareText;if(d in O){for(var j=O[d],$=j.length-1;$>=0;$--)if(P.dist(j[$])<v)return!0}else O[d]=[];return O[d].push(P),!1}var N0=ys.VectorTileFeature.types,cf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function O_(l,d,v,P,O,j,$,K,le,me,be,Ie,je){var Ye=K?Math.min(32640,Math.round(K[0])):0,ct=K?Math.min(32640,Math.round(K[1])):0;l.emplaceBack(d,v,Math.round(32*P),Math.round(32*O),j,$,(Ye<<1)+(le?1:0),ct,16*me,16*be,256*Ie,256*je)}function Vy(l,d,v){l.emplaceBack(d.x,d.y,v),l.emplaceBack(d.x,d.y,v),l.emplaceBack(d.x,d.y,v),l.emplaceBack(d.x,d.y,v)}function Eb(l){for(var d=0,v=l.sections;d<v.length;d+=1)if(xd(v[d].text))return!0;return!1}var Xo=function(l){this.layoutVertexArray=new dp,this.indexArray=new Yu,this.programConfigurations=l,this.segments=new Je,this.dynamicLayoutVertexArray=new Hu,this.opacityVertexArray=new Zu,this.placedSymbolArray=new M};Xo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Xo.prototype.upload=function(l,d,v,P){this.isEmpty()||(v&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,De.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Xe.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,cf,!0),this.opacityVertexBuffer.itemSize=1),(v||P)&&this.programConfigurations.upload(l))},Xo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Rn("SymbolBuffers",Xo);var im=function(l,d,v){this.layoutVertexArray=new l,this.layoutAttributes=d,this.indexArray=new v,this.segments=new Je,this.collisionVertexArray=new Ff};im.prototype.upload=function(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,Be.members,!0)},im.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Rn("CollisionBuffers",im);var To=function(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(function(j){return j.id}),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ns([]),this.placementViewportMatrix=Ns([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tl(this.zoom,d["text-size"]),this.iconSizeData=Tl(this.zoom,d["icon-size"]);var v=this.layers[0].layout,P=v.get("symbol-sort-key"),O=v.get("symbol-z-order");this.canOverlap=v.get("text-allow-overlap")||v.get("icon-allow-overlap")||v.get("text-ignore-placement")||v.get("icon-ignore-placement"),this.sortFeaturesByKey=O!=="viewport-y"&&P.constantOr(1)!==void 0,this.sortFeaturesByY=(O==="viewport-y"||O==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,v.get("symbol-placement")==="point"&&(this.writingModes=v.get("text-writing-mode").map(function(j){return fi[j]})),this.stateDependentLayerIds=this.layers.filter(function(j){return j.isStateDependent()}).map(function(j){return j.id}),this.sourceID=l.sourceID};To.prototype.createArrays=function(){this.text=new Xo(new ii(this.layers,this.zoom,function(l){return/^text/.test(l)})),this.icon=new Xo(new ii(this.layers,this.zoom,function(l){return/^icon/.test(l)})),this.glyphOffsetArray=new Y,this.lineVertexArray=new re,this.symbolInstances=new W},To.prototype.calculateGlyphDependencies=function(l,d,v,P,O){for(var j=0;j<l.length;j++)if(d[l.charCodeAt(j)]=!0,(v||P)&&O){var $=st[l.charAt(j)];$&&(d[$.charCodeAt(0)]=!0)}},To.prototype.populate=function(l,d,v){var P=this.layers[0],O=P.layout,j=O.get("text-font"),$=O.get("text-field"),K=O.get("icon-image"),le=($.value.kind!=="constant"||$.value.value instanceof ga&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(j.value.kind!=="constant"||j.value.value.length>0),me=K.value.kind!=="constant"||!!K.value.value||Object.keys(K.parameters).length>0,be=O.get("symbol-sort-key");if(this.features=[],le||me){for(var Ie=d.iconDependencies,je=d.glyphDependencies,Ye=d.availableImages,ct=new oo(this.zoom),dt=0,kt=l;dt<kt.length;dt+=1){var St=kt[dt],Gt=St.feature,or=St.id,gr=St.index,yr=St.sourceLayerIndex,zr=P._featureFilter.needGeometry,Qr=na(Gt,zr);if(P._featureFilter.filter(ct,Qr,v)){zr||(Qr.geometry=an(Gt));var nn=void 0;if(le){var Zn=P.getValueAndResolveTokens("text-field",Qr,v,Ye),Tn=ga.factory(Zn);Eb(Tn)&&(this.hasRTLText=!0),(!this.hasRTLText||sp()==="unavailable"||this.hasRTLText&&Ks.isParsed())&&(nn=Ke(Tn,P,Qr))}var li=void 0;if(me){var En=P.getValueAndResolveTokens("icon-image",Qr,v,Ye);li=En instanceof Ho?En:Ho.fromString(En)}if(nn||li){var Qi=this.sortFeaturesByKey?be.evaluate(Qr,{},v):void 0;if(this.features.push({id:or,text:nn,icon:li,index:gr,sourceLayerIndex:yr,geometry:Qr.geometry,properties:Gt.properties,type:N0[Gt.type],sortKey:Qi}),li&&(Ie[li.name]=!0),nn){var Ai=j.evaluate(Qr,{},v).join(","),Mn=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(fi.vertical)>=0;for(var uo=0,hn=nn.sections;uo<hn.length;uo+=1){var wo=hn[uo];if(wo.image)Ie[wo.image.name]=!0;else{var jn=$u(nn.toString()),ho=wo.fontStack||Ai,da=je[ho]=je[ho]||{};this.calculateGlyphDependencies(wo.text,da,Mn,this.allowVerticalPlacement,jn)}}}}}}O.get("symbol-placement")==="line"&&(this.features=function(Oa){var ba={},pa={},La=[],bs=0;function ws(la){La.push(Oa[la]),bs++}function hl(la,Qa,el){var Do=pa[la];return delete pa[la],pa[Qa]=Do,La[Do].geometry[0].pop(),La[Do].geometry[0]=La[Do].geometry[0].concat(el[0]),Do}function hs(la,Qa,el){var Do=ba[Qa];return delete ba[Qa],ba[la]=Do,La[Do].geometry[0].shift(),La[Do].geometry[0]=el[0].concat(La[Do].geometry[0]),Do}function ei(la,Qa,el){var Do=el?Qa[0][Qa[0].length-1]:Qa[0][0];return la+":"+Do.x+":"+Do.y}for(var za=0;za<Oa.length;za++){var Na=Oa[za],fo=Na.geometry,Yo=Na.text?Na.text.toString():null;if(Yo){var $o=ei(Yo,fo),Ao=ei(Yo,fo,!0);if($o in pa&&Ao in ba&&pa[$o]!==ba[Ao]){var El=hs($o,Ao,fo),Qs=hl($o,Ao,La[El].geometry);delete ba[$o],delete pa[Ao],pa[ei(Yo,La[Qs].geometry,!0)]=Qs,La[El].geometry=null}else $o in pa?hl($o,Ao,fo):Ao in ba?hs($o,Ao,fo):(ws(za),ba[$o]=bs-1,pa[Ao]=bs-1)}else ws(za)}return La.filter(function(la){return la.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Oa,ba){return Oa.sortKey-ba.sortKey})}},To.prototype.update=function(l,d,v){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,d,this.layers,v),this.icon.programConfigurations.updatePaintArrays(l,d,this.layers,v))},To.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},To.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},To.prototype.upload=function(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},To.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},To.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},To.prototype.addToLineVertexArray=function(l,d){var v=this.lineVertexArray.length;if(l.segment!==void 0){for(var P=l.dist(d[l.segment+1]),O=l.dist(d[l.segment]),j={},$=l.segment+1;$<d.length;$++)j[$]={x:d[$].x,y:d[$].y,tileUnitDistanceFromAnchor:P},$<d.length-1&&(P+=d[$+1].dist(d[$]));for(var K=l.segment||0;K>=0;K--)j[K]={x:d[K].x,y:d[K].y,tileUnitDistanceFromAnchor:O},K>0&&(O+=d[K-1].dist(d[K]));for(var le=0;le<d.length;le++){var me=j[le];this.lineVertexArray.emplaceBack(me.x,me.y,me.tileUnitDistanceFromAnchor)}}return{lineStartIndex:v,lineLength:this.lineVertexArray.length-v}},To.prototype.addSymbols=function(l,d,v,P,O,j,$,K,le,me,be,Ie){for(var je=l.indexArray,Ye=l.layoutVertexArray,ct=l.segments.prepareSegment(4*d.length,Ye,je,this.canOverlap?j.sortKey:void 0),dt=this.glyphOffsetArray.length,kt=ct.vertexLength,St=this.allowVerticalPlacement&&$===fi.vertical?Math.PI/2:0,Gt=j.text&&j.text.sections,or=0;or<d.length;or++){var gr=d[or],yr=gr.tl,zr=gr.tr,Qr=gr.bl,nn=gr.br,Zn=gr.tex,Tn=gr.pixelOffsetTL,li=gr.pixelOffsetBR,En=gr.minFontScaleX,Qi=gr.minFontScaleY,Ai=gr.glyphOffset,Mn=gr.isSDF,uo=gr.sectionIndex,hn=ct.vertexLength,wo=Ai[1];O_(Ye,K.x,K.y,yr.x,wo+yr.y,Zn.x,Zn.y,v,Mn,Tn.x,Tn.y,En,Qi),O_(Ye,K.x,K.y,zr.x,wo+zr.y,Zn.x+Zn.w,Zn.y,v,Mn,li.x,Tn.y,En,Qi),O_(Ye,K.x,K.y,Qr.x,wo+Qr.y,Zn.x,Zn.y+Zn.h,v,Mn,Tn.x,li.y,En,Qi),O_(Ye,K.x,K.y,nn.x,wo+nn.y,Zn.x+Zn.w,Zn.y+Zn.h,v,Mn,li.x,li.y,En,Qi),Vy(l.dynamicLayoutVertexArray,K,St),je.emplaceBack(hn,hn+1,hn+2),je.emplaceBack(hn+1,hn+2,hn+3),ct.vertexLength+=4,ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ai[0]),or!==d.length-1&&uo===d[or+1].sectionIndex||l.programConfigurations.populatePaintArrays(Ye.length,j,j.index,{},Ie,Gt&&Gt[uo])}l.placedSymbolArray.emplaceBack(K.x,K.y,dt,this.glyphOffsetArray.length-dt,kt,le,me,K.segment,v?v[0]:0,v?v[1]:0,P[0],P[1],$,0,!1,0,be)},To.prototype._addCollisionDebugVertex=function(l,d,v,P,O,j){return d.emplaceBack(0,0),l.emplaceBack(v.x,v.y,P,O,Math.round(j.x),Math.round(j.y))},To.prototype.addCollisionDebugVertices=function(l,d,v,P,O,j,$){var K=O.segments.prepareSegment(4,O.layoutVertexArray,O.indexArray),le=K.vertexLength,me=O.layoutVertexArray,be=O.collisionVertexArray,Ie=$.anchorX,je=$.anchorY;this._addCollisionDebugVertex(me,be,j,Ie,je,new G(l,d)),this._addCollisionDebugVertex(me,be,j,Ie,je,new G(v,d)),this._addCollisionDebugVertex(me,be,j,Ie,je,new G(v,P)),this._addCollisionDebugVertex(me,be,j,Ie,je,new G(l,P)),K.vertexLength+=4;var Ye=O.indexArray;Ye.emplaceBack(le,le+1),Ye.emplaceBack(le+1,le+2),Ye.emplaceBack(le+2,le+3),Ye.emplaceBack(le+3,le),K.primitiveLength+=4},To.prototype.addDebugCollisionBoxes=function(l,d,v,P){for(var O=l;O<d;O++){var j=this.collisionBoxArray.get(O);this.addCollisionDebugVertices(j.x1,j.y1,j.x2,j.y2,P?this.textCollisionBox:this.iconCollisionBox,j.anchorPoint,v)}},To.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new im(Xu,We.members,Ih),this.iconCollisionBox=new im(Xu,We.members,Ih);for(var l=0;l<this.symbolInstances.length;l++){var d=this.symbolInstances.get(l);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},To.prototype._deserializeCollisionBoxesForSymbol=function(l,d,v,P,O,j,$,K,le){for(var me={},be=d;be<v;be++){var Ie=l.get(be);me.textBox={x1:Ie.x1,y1:Ie.y1,x2:Ie.x2,y2:Ie.y2,anchorPointX:Ie.anchorPointX,anchorPointY:Ie.anchorPointY},me.textFeatureIndex=Ie.featureIndex;break}for(var je=P;je<O;je++){var Ye=l.get(je);me.verticalTextBox={x1:Ye.x1,y1:Ye.y1,x2:Ye.x2,y2:Ye.y2,anchorPointX:Ye.anchorPointX,anchorPointY:Ye.anchorPointY},me.verticalTextFeatureIndex=Ye.featureIndex;break}for(var ct=j;ct<$;ct++){var dt=l.get(ct);me.iconBox={x1:dt.x1,y1:dt.y1,x2:dt.x2,y2:dt.y2,anchorPointX:dt.anchorPointX,anchorPointY:dt.anchorPointY},me.iconFeatureIndex=dt.featureIndex;break}for(var kt=K;kt<le;kt++){var St=l.get(kt);me.verticalIconBox={x1:St.x1,y1:St.y1,x2:St.x2,y2:St.y2,anchorPointX:St.anchorPointX,anchorPointY:St.anchorPointY},me.verticalIconFeatureIndex=St.featureIndex;break}return me},To.prototype.deserializeCollisionBoxes=function(l){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var v=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,v.textBoxStartIndex,v.textBoxEndIndex,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v.iconBoxStartIndex,v.iconBoxEndIndex,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex))}},To.prototype.hasTextData=function(){return this.text.segments.get().length>0},To.prototype.hasIconData=function(){return this.icon.segments.get().length>0},To.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},To.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},To.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},To.prototype.addIndicesForPlacedSymbol=function(l,d){for(var v=l.placedSymbolArray.get(d),P=v.vertexStartIndex+4*v.numGlyphs,O=v.vertexStartIndex;O<P;O+=4)l.indexArray.emplaceBack(O,O+1,O+2),l.indexArray.emplaceBack(O+1,O+2,O+3)},To.prototype.getSortedSymbolIndexes=function(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(l),v=Math.cos(l),P=[],O=[],j=[],$=0;$<this.symbolInstances.length;++$){j.push($);var K=this.symbolInstances.get($);P.push(0|Math.round(d*K.anchorX+v*K.anchorY)),O.push(K.featureIndex)}return j.sort(function(le,me){return P[le]-P[me]||O[me]-O[le]}),j},To.prototype.addToSortKeyRanges=function(l,d){var v=this.sortKeyRanges[this.sortKeyRanges.length-1];v&&v.sortKey===d?v.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:l,symbolInstanceEnd:l+1})},To.prototype.sortFeatures=function(l){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var v=0,P=this.symbolInstanceIndexes;v<P.length;v+=1){var O=this.symbolInstances.get(P[v]);this.featureSortOrder.push(O.featureIndex),[O.rightJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.leftJustifiedTextSymbolIndex].forEach(function(j,$,K){j>=0&&K.indexOf(j)===$&&d.addIndicesForPlacedSymbol(d.text,j)}),O.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,O.verticalPlacedTextSymbolIndex),O.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.placedIconSymbolIndex),O.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Rn("SymbolBucket",To,{omit:["layers","collisionBoxArray","features","compareText"]}),To.MAX_GLYPHS=65535,To.addDynamicAttributes=Vy;var Ib=new _s({"symbol-placement":new Kn(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new Kn(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kn(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bn(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kn(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kn(ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kn(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kn(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kn(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bn(ve.layout_symbol["icon-size"]),"icon-text-fit":new Kn(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kn(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bn(ve.layout_symbol["icon-image"]),"icon-rotate":new Bn(ve.layout_symbol["icon-rotate"]),"icon-padding":new Kn(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new Kn(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new Bn(ve.layout_symbol["icon-offset"]),"icon-anchor":new Bn(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kn(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kn(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kn(ve.layout_symbol["text-rotation-alignment"]),"text-field":new Bn(ve.layout_symbol["text-field"]),"text-font":new Bn(ve.layout_symbol["text-font"]),"text-size":new Bn(ve.layout_symbol["text-size"]),"text-max-width":new Bn(ve.layout_symbol["text-max-width"]),"text-line-height":new Kn(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new Bn(ve.layout_symbol["text-letter-spacing"]),"text-justify":new Bn(ve.layout_symbol["text-justify"]),"text-radial-offset":new Bn(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kn(ve.layout_symbol["text-variable-anchor"]),"text-anchor":new Bn(ve.layout_symbol["text-anchor"]),"text-max-angle":new Kn(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new Kn(ve.layout_symbol["text-writing-mode"]),"text-rotate":new Bn(ve.layout_symbol["text-rotate"]),"text-padding":new Kn(ve.layout_symbol["text-padding"]),"text-keep-upright":new Kn(ve.layout_symbol["text-keep-upright"]),"text-transform":new Bn(ve.layout_symbol["text-transform"]),"text-offset":new Bn(ve.layout_symbol["text-offset"]),"text-allow-overlap":new Kn(ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kn(ve.layout_symbol["text-ignore-placement"]),"text-optional":new Kn(ve.layout_symbol["text-optional"])}),Uy={paint:new _s({"icon-opacity":new Bn(ve.paint_symbol["icon-opacity"]),"icon-color":new Bn(ve.paint_symbol["icon-color"]),"icon-halo-color":new Bn(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bn(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bn(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new Kn(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kn(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bn(ve.paint_symbol["text-opacity"]),"text-color":new Bn(ve.paint_symbol["text-color"],{runtimeType:Nr,getOverride:function(l){return l.textColor},hasOverride:function(l){return!!l.textColor}}),"text-halo-color":new Bn(ve.paint_symbol["text-halo-color"]),"text-halo-width":new Bn(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new Bn(ve.paint_symbol["text-halo-blur"]),"text-translate":new Kn(ve.paint_symbol["text-translate"]),"text-translate-anchor":new Kn(ve.paint_symbol["text-translate-anchor"])}),layout:Ib},om=function(l){this.type=l.property.overrides?l.property.overrides.runtimeType:qt,this.defaultValue=l};om.prototype.evaluate=function(l){if(l.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(l.formattedSection))return d.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default},om.prototype.eachChild=function(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)},om.prototype.outputDefined=function(){return!1},om.prototype.serialize=function(){return null},Rn("FormatSectionOverride",om,{omit:["defaultValue"]});var Fo=function(l){function d(v){l.call(this,v,Uy)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.recalculate=function(v,P){if(l.prototype.recalculate.call(this,v,P),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var O=this.layout.get("text-writing-mode");if(O){for(var j=[],$=0,K=O;$<K.length;$+=1){var le=K[$];j.indexOf(le)<0&&j.push(le)}this.layout._values["text-writing-mode"]=j}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(v,P,O,j){var $=this.layout.get(v).evaluate(P,{},O,j),K=this._unevaluatedLayout._values[v];return K.isDataDriven()||Bc(K.value)||!$?$:function(le,me){return me.replace(/{([^{}]+)}/g,function(be,Ie){return Ie in le?String(le[Ie]):""})}(P.properties,$)},d.prototype.createBucket=function(v){return new To(v)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var v=0,P=Uy.paint.overridableProperties;v<P.length;v+=1){var O=P[v];if(d.hasPaintOverride(this.layout,O)){var j,$=this.paint.get(O),K=new om($),le=new sd(K,$.property.specification);j=$.value.kind==="constant"||$.value.kind==="source"?new ld("source",le):new xh("composite",le,$.value.zoomStops,$.value._interpolationType),this.paint._values[O]=new Cs($.property,j,$.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(v,P,O){return!(!this.layout||P.isDataDriven()||O.isDataDriven())&&d.hasPaintOverride(this.layout,v)},d.hasPaintOverride=function(v,P){var O=v.get("text-field"),j=Uy.paint.properties[P],$=!1,K=function(be){for(var Ie=0,je=be;Ie<je.length;Ie+=1)if(j.overrides&&j.overrides.hasOverride(je[Ie]))return void($=!0)};if(O.value.kind==="constant"&&O.value.value instanceof ga)K(O.value.value.sections);else if(O.value.kind==="source"){var le=function(be){$||(be instanceof po&&Qo(be.value)===Yi?K(be.value.sections):be instanceof Gs?K(be.sections):be.eachChild(le))},me=O.value;me._styleExpression&&le(me._styleExpression.expression)}return $},d}(Ql),j0={paint:new _s({"background-color":new Kn(ve.paint_background["background-color"]),"background-pattern":new As(ve.paint_background["background-pattern"]),"background-opacity":new Kn(ve.paint_background["background-opacity"])})},Su=function(l){function d(v){l.call(this,v,j0)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(Ql),Cb={paint:new _s({"raster-opacity":new Kn(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kn(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kn(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kn(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new Kn(ve.paint_raster["raster-saturation"]),"raster-contrast":new Kn(ve.paint_raster["raster-contrast"]),"raster-resampling":new Kn(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new Kn(ve.paint_raster["raster-fade-duration"])})},Ab=function(l){function d(v){l.call(this,v,Cb)}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d}(Ql),Pb=function(l){function d(v){l.call(this,v,{}),this.implementation=v}return l&&(d.__proto__=l),(d.prototype=Object.create(l&&l.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(v){this.implementation.onAdd&&this.implementation.onAdd(v,v.painter.context.gl)},d.prototype.onRemove=function(v){this.implementation.onRemove&&this.implementation.onRemove(v,v.painter.context.gl)},d}(Ql),Ui={circle:bo,heatmap:Um,hillshade:S_,fill:zy,"fill-extrusion":I,line:Ce,symbol:Fo,background:Su,raster:Ab},$y=X.HTMLImageElement,Ma=X.HTMLCanvasElement,B0=X.HTMLVideoElement,F0=X.ImageData,L_=X.ImageBitmap,uf=function(l,d,v,P){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(d,P)};uf.prototype.update=function(l,d,v){var P=l.width,O=l.height,j=!(this.size&&this.size[0]===P&&this.size[1]===O||v),$=this.context,K=$.gl;if(this.useMipmap=!!(d&&d.useMipmap),K.bindTexture(K.TEXTURE_2D,this.texture),$.pixelStoreUnpackFlipY.set(!1),$.pixelStoreUnpack.set(1),$.pixelStoreUnpackPremultiplyAlpha.set(this.format===K.RGBA&&(!d||d.premultiply!==!1)),j)this.size=[P,O],l instanceof $y||l instanceof Ma||l instanceof B0||l instanceof F0||L_&&l instanceof L_?K.texImage2D(K.TEXTURE_2D,0,this.format,this.format,K.UNSIGNED_BYTE,l):K.texImage2D(K.TEXTURE_2D,0,this.format,P,O,0,this.format,K.UNSIGNED_BYTE,l.data);else{var le=v||{x:0,y:0},me=le.x,be=le.y;l instanceof $y||l instanceof Ma||l instanceof B0||l instanceof F0||L_&&l instanceof L_?K.texSubImage2D(K.TEXTURE_2D,0,me,be,K.RGBA,K.UNSIGNED_BYTE,l):K.texSubImage2D(K.TEXTURE_2D,0,me,be,P,O,K.RGBA,K.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&K.generateMipmap(K.TEXTURE_2D)},uf.prototype.bind=function(l,d,v){var P=this.context.gl;P.bindTexture(P.TEXTURE_2D,this.texture),v!==P.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=P.LINEAR),l!==this.filter&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,l),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,v||l),this.filter=l),d!==this.wrap&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,d),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,d),this.wrap=d)},uf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},uf.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Gy=function(l){var d=this;this._callback=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};Gy.prototype.trigger=function(){var l=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){l._triggered=!1,l._callback()},0))},Gy.prototype.remove=function(){delete this._channel,this._callback=function(){}};var am=function(l,d,v){this.target=l,this.parent=d,this.mapId=v,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},tt(["receive","process"],this),this.invoker=new Gy(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Xt()?l:X};function V0(l,d,v){var P=2*Math.PI*6378137/256/Math.pow(2,v);return[l*P-2*Math.PI*6378137/2,d*P-2*Math.PI*6378137/2]}am.prototype.send=function(l,d,v,P,O){var j=this;O===void 0&&(O=!1);var $=Math.round(1e18*Math.random()).toString(36).substring(0,10);v&&(this.callbacks[$]=v);var K=sr(this.globalScope)?void 0:[];return this.target.postMessage({id:$,type:l,hasCallback:!!v,targetMapId:P,mustQueue:O,sourceMapId:this.mapId,data:Xs(d,K)},K),{cancel:function(){v&&delete j.callbacks[$],j.target.postMessage({id:$,type:"<cancel>",targetMapId:P,sourceMapId:j.mapId})}}},am.prototype.receive=function(l){var d=l.data,v=d.id;if(v&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[v];var P=this.cancelCallbacks[v];delete this.cancelCallbacks[v],P&&P()}else Xt()||d.mustQueue?(this.tasks[v]=d,this.taskQueue.push(v),this.invoker.trigger()):this.processTask(v,d)},am.prototype.process=function(){if(this.taskQueue.length){var l=this.taskQueue.shift(),d=this.tasks[l];delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(l,d)}},am.prototype.processTask=function(l,d){var v=this;if(d.type==="<response>"){var P=this.callbacks[l];delete this.callbacks[l],P&&(d.error?P(gs(d.error)):P(null,gs(d.data)))}else{var O=!1,j=sr(this.globalScope)?void 0:[],$=d.hasCallback?function(be,Ie){O=!0,delete v.cancelCallbacks[l],v.target.postMessage({id:l,type:"<response>",sourceMapId:v.mapId,error:be?Xs(be):null,data:Xs(Ie,j)},j)}:function(be){O=!0},K=null,le=gs(d.data);if(this.parent[d.type])K=this.parent[d.type](d.sourceMapId,le,$);else if(this.parent.getWorkerSource){var me=d.type.split(".");K=this.parent.getWorkerSource(d.sourceMapId,me[0],le.source)[me[1]](le,$)}else $(new Error("Could not find function "+d.type));!O&&K&&K.cancel&&(this.cancelCallbacks[l]=K.cancel)}},am.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var cs=function(l,d){l&&(d?this.setSouthWest(l).setNorthEast(d):l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1]))};cs.prototype.setNorthEast=function(l){return this._ne=l instanceof Pn?new Pn(l.lng,l.lat):Pn.convert(l),this},cs.prototype.setSouthWest=function(l){return this._sw=l instanceof Pn?new Pn(l.lng,l.lat):Pn.convert(l),this},cs.prototype.extend=function(l){var d,v,P=this._sw,O=this._ne;if(l instanceof Pn)d=l,v=l;else{if(!(l instanceof cs))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(cs.convert(l)):this.extend(Pn.convert(l)):this;if(v=l._ne,!(d=l._sw)||!v)return this}return P||O?(P.lng=Math.min(d.lng,P.lng),P.lat=Math.min(d.lat,P.lat),O.lng=Math.max(v.lng,O.lng),O.lat=Math.max(v.lat,O.lat)):(this._sw=new Pn(d.lng,d.lat),this._ne=new Pn(v.lng,v.lat)),this},cs.prototype.getCenter=function(){return new Pn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},cs.prototype.getSouthWest=function(){return this._sw},cs.prototype.getNorthEast=function(){return this._ne},cs.prototype.getNorthWest=function(){return new Pn(this.getWest(),this.getNorth())},cs.prototype.getSouthEast=function(){return new Pn(this.getEast(),this.getSouth())},cs.prototype.getWest=function(){return this._sw.lng},cs.prototype.getSouth=function(){return this._sw.lat},cs.prototype.getEast=function(){return this._ne.lng},cs.prototype.getNorth=function(){return this._ne.lat},cs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},cs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},cs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},cs.prototype.contains=function(l){var d=Pn.convert(l),v=d.lng,P=d.lat,O=this._sw.lng<=v&&v<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=v&&v>=this._ne.lng),this._sw.lat<=P&&P<=this._ne.lat&&O},cs.convert=function(l){return!l||l instanceof cs?l:new cs(l)};var Pn=function(l,d){if(isNaN(l)||isNaN(d))throw new Error("Invalid LngLat object: ("+l+", "+d+")");if(this.lng=+l,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Pn.prototype.wrap=function(){return new Pn(ue(this.lng,-180,180),this.lat)},Pn.prototype.toArray=function(){return[this.lng,this.lat]},Pn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Pn.prototype.distanceTo=function(l){var d=Math.PI/180,v=this.lat*d,P=l.lat*d,O=Math.sin(v)*Math.sin(P)+Math.cos(v)*Math.cos(P)*Math.cos((l.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(O,1))},Pn.prototype.toBounds=function(l){l===void 0&&(l=0);var d=360*l/40075017,v=d/Math.cos(Math.PI/180*this.lat);return new cs(new Pn(this.lng-v,this.lat-d),new Pn(this.lng+v,this.lat+d))},Pn.convert=function(l){if(l instanceof Pn)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Pn(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Pn(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ki=2*Math.PI*63710088e-1;function qy(l){return ki*Math.cos(l*Math.PI/180)}function Md(l){return(180+l)/360}function U0(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function $0(l,d){return l/qy(d)}function Wy(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}var hf=function(l,d,v){v===void 0&&(v=0),this.x=+l,this.y=+d,this.z=+v};hf.fromLngLat=function(l,d){d===void 0&&(d=0);var v=Pn.convert(l);return new hf(Md(v.lng),U0(v.lat),$0(d,v.lat))},hf.prototype.toLngLat=function(){return new Pn(360*this.x-180,Wy(this.y))},hf.prototype.toAltitude=function(){return this.z*qy(Wy(this.y))},hf.prototype.meterInMercatorCoordinateUnits=function(){return 1/ki*(l=Wy(this.y),1/Math.cos(l*Math.PI/180));var l};var df=function(l,d,v){this.z=l,this.x=d,this.y=v,this.key=tg(0,l,l,d,v)};df.prototype.equals=function(l){return this.z===l.z&&this.x===l.x&&this.y===l.y},df.prototype.url=function(l,d){var v,P,O,j,$,K=(P=this.y,O=this.z,j=V0(256*(v=this.x),256*(P=Math.pow(2,O)-P-1),O),$=V0(256*(v+1),256*(P+1),O),j[0]+","+j[1]+","+$[0]+","+$[1]),le=function(me,be,Ie){for(var je,Ye="",ct=me;ct>0;ct--)Ye+=(be&(je=1<<ct-1)?1:0)+(Ie&je?2:0);return Ye}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",le).replace("{bbox-epsg-3857}",K)},df.prototype.getTilePoint=function(l){var d=Math.pow(2,this.z);return new G(8192*(l.x*d-this.x),8192*(l.y*d-this.y))},df.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var G0=function(l,d){this.wrap=l,this.canonical=d,this.key=tg(l,d.z,d.z,d.x,d.y)},us=function(l,d,v,P,O){this.overscaledZ=l,this.wrap=d,this.canonical=new df(v,+P,+O),this.key=tg(d,l,v,P,O)};function tg(l,d,v,P,O){(l*=2)<0&&(l=-1*l-1);var j=1<<v;return(j*j*l+j*O+P).toString(36)+v.toString(36)+d.toString(36)}us.prototype.equals=function(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)},us.prototype.scaledTo=function(l){var d=this.canonical.z-l;return l>this.canonical.z?new us(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new us(l,this.wrap,l,this.canonical.x>>d,this.canonical.y>>d)},us.prototype.calculateScaledKey=function(l,d){var v=this.canonical.z-l;return l>this.canonical.z?tg(this.wrap*+d,l,this.canonical.z,this.canonical.x,this.canonical.y):tg(this.wrap*+d,l,l,this.canonical.x>>v,this.canonical.y>>v)},us.prototype.isChildOf=function(l){if(l.wrap!==this.wrap)return!1;var d=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>d&&l.canonical.y===this.canonical.y>>d},us.prototype.children=function(l){if(this.overscaledZ>=l)return[new us(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,v=2*this.canonical.x,P=2*this.canonical.y;return[new us(d,this.wrap,d,v,P),new us(d,this.wrap,d,v+1,P),new us(d,this.wrap,d,v,P+1),new us(d,this.wrap,d,v+1,P+1)]},us.prototype.isLessThan=function(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))},us.prototype.wrapped=function(){return new us(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},us.prototype.unwrapTo=function(l){return new us(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)},us.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},us.prototype.toUnwrapped=function(){return new G0(this.wrap,this.canonical)},us.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},us.prototype.getTilePoint=function(l){return this.canonical.getTilePoint(new hf(l.x-this.wrap,l.y))},Rn("CanonicalTileID",df),Rn("OverscaledTileID",us,{omit:["posMatrix"]});var kd=function(l,d,v){if(this.uid=l,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(v&&v!=="mapbox"&&v!=="terrarium")return Ar('"'+v+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var P=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=v||"mapbox";for(var O=0;O<P;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(P,O)]=this.data[this._idx(P-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,P)]=this.data[this._idx(O,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)]};kd.prototype.get=function(l,d){var v=new Uint8Array(this.data.buffer),P=4*this._idx(l,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(v[P],v[P+1],v[P+2])},kd.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},kd.prototype._idx=function(l,d){if(l<-1||l>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(l+1)},kd.prototype._unpackMapbox=function(l,d,v){return(256*l*256+256*d+v)/10-1e4},kd.prototype._unpackTerrarium=function(l,d,v){return 256*l+d+v/256-32768},kd.prototype.getPixels=function(){return new Ja({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},kd.prototype.backfillBorder=function(l,d,v){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");var P=d*this.dim,O=d*this.dim+this.dim,j=v*this.dim,$=v*this.dim+this.dim;switch(d){case-1:P=O-1;break;case 1:O=P+1}switch(v){case-1:j=$-1;break;case 1:$=j+1}for(var K=-d*this.dim,le=-v*this.dim,me=j;me<$;me++)for(var be=P;be<O;be++)this.data[this._idx(be,me)]=l.data[this._idx(be+K,me+le)]},Rn("DEMData",kd);var z_=function(l){this._stringToNumber={},this._numberToString=[];for(var d=0;d<l.length;d++){var v=l[d];this._stringToNumber[v]=d,this._numberToString[d]=v}};z_.prototype.encode=function(l){return this._stringToNumber[l]},z_.prototype.decode=function(l){return this._numberToString[l]};var eh=function(l,d,v,P,O){this.type="Feature",this._vectorTileFeature=l,l._z=d,l._x=v,l._y=P,this.properties=l.properties,this.id=O},q0={geometry:{configurable:!0}};q0.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},q0.geometry.set=function(l){this._geometry=l},eh.prototype.toJSON=function(){var l={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(l[d]=this[d]);return l},Object.defineProperties(eh.prototype,q0);var Gi=function(){this.state={},this.stateChanges={},this.deletedStates={}};Gi.prototype.updateState=function(l,d,v){var P=String(d);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][P]=this.stateChanges[l][P]||{},ce(this.stateChanges[l][P],v),this.deletedStates[l]===null)for(var O in this.deletedStates[l]={},this.state[l])O!==P&&(this.deletedStates[l][O]=null);else if(this.deletedStates[l]&&this.deletedStates[l][P]===null)for(var j in this.deletedStates[l][P]={},this.state[l][P])v[j]||(this.deletedStates[l][P][j]=null);else for(var $ in v)this.deletedStates[l]&&this.deletedStates[l][P]&&this.deletedStates[l][P][$]===null&&delete this.deletedStates[l][P][$]},Gi.prototype.removeFeatureState=function(l,d,v){if(this.deletedStates[l]!==null){var P=String(d);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&d!==void 0)this.deletedStates[l][P]!==null&&(this.deletedStates[l][P]=this.deletedStates[l][P]||{},this.deletedStates[l][P][v]=null);else if(d!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][P])for(v in this.deletedStates[l][P]={},this.stateChanges[l][P])this.deletedStates[l][P][v]=null;else this.deletedStates[l][P]=null;else this.deletedStates[l]=null}},Gi.prototype.getState=function(l,d){var v=String(d),P=ce({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){var O=this.deletedStates[l][d];if(O===null)return{};for(var j in O)delete P[j]}return P},Gi.prototype.initializeTileState=function(l,d){l.setFeatureState(this.state,d)},Gi.prototype.coalesceChanges=function(l,d){var v={};for(var P in this.stateChanges){this.state[P]=this.state[P]||{};var O={};for(var j in this.stateChanges[P])this.state[P][j]||(this.state[P][j]={}),ce(this.state[P][j],this.stateChanges[P][j]),O[j]=this.state[P][j];v[P]=O}for(var $ in this.deletedStates){this.state[$]=this.state[$]||{};var K={};if(this.deletedStates[$]===null)for(var le in this.state[$])K[le]={},this.state[$][le]={};else for(var me in this.deletedStates[$]){if(this.deletedStates[$][me]===null)this.state[$][me]={};else for(var be=0,Ie=Object.keys(this.deletedStates[$][me]);be<Ie.length;be+=1)delete this.state[$][me][Ie[be]];K[me]=this.state[$][me]}v[$]=v[$]||{},ce(v[$],K)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(var je in l)l[je].setFeatureState(v,d)};var Lh=function(l,d){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new mu(8192,16,0),this.grid3D=new mu(8192,16,0),this.featureIndexArray=new Ae,this.promoteId=d};function Tu(l,d,v,P,O){return _t(l,function(j,$){var K=d instanceof lp?d.get($):null;return K&&K.evaluate?K.evaluate(v,P,O):K})}function W0(l){for(var d=1/0,v=1/0,P=-1/0,O=-1/0,j=0,$=l;j<$.length;j+=1){var K=$[j];d=Math.min(d,K.x),v=Math.min(v,K.y),P=Math.max(P,K.x),O=Math.max(O,K.y)}return{minX:d,minY:v,maxX:P,maxY:O}}function Mb(l,d){return d-l}Lh.prototype.insert=function(l,d,v,P,O,j){var $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(v,P,O);for(var K=j?this.grid3D:this.grid,le=0;le<d.length;le++){for(var me=d[le],be=[1/0,1/0,-1/0,-1/0],Ie=0;Ie<me.length;Ie++){var je=me[Ie];be[0]=Math.min(be[0],je.x),be[1]=Math.min(be[1],je.y),be[2]=Math.max(be[2],je.x),be[3]=Math.max(be[3],je.y)}be[0]<8192&&be[1]<8192&&be[2]>=0&&be[3]>=0&&K.insert($,be[0],be[1],be[2],be[3])}},Lh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ys.VectorTile(new Zt(this.rawTileData)).layers,this.sourceLayerCoder=new z_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Lh.prototype.query=function(l,d,v,P){var O=this;this.loadVTLayers();for(var j=l.params||{},$=8192/l.tileSize/l.scale,K=dd(j.filter),le=l.queryGeometry,me=l.queryPadding*$,be=W0(le),Ie=this.grid.query(be.minX-me,be.minY-me,be.maxX+me,be.maxY+me),je=W0(l.cameraQueryGeometry),Ye=this.grid3D.query(je.minX-me,je.minY-me,je.maxX+me,je.maxY+me,function(gr,yr,zr,Qr){return function(nn,Zn,Tn,li,En){for(var Qi=0,Ai=nn;Qi<Ai.length;Qi+=1){var Mn=Ai[Qi];if(Zn<=Mn.x&&Tn<=Mn.y&&li>=Mn.x&&En>=Mn.y)return!0}var uo=[new G(Zn,Tn),new G(Zn,En),new G(li,En),new G(li,Tn)];if(nn.length>2){for(var hn=0,wo=uo;hn<wo.length;hn+=1)if(bc(nn,wo[hn]))return!0}for(var jn=0;jn<nn.length-1;jn++)if(vu(nn[jn],nn[jn+1],uo))return!0;return!1}(l.cameraQueryGeometry,gr-me,yr-me,zr+me,Qr+me)}),ct=0,dt=Ye;ct<dt.length;ct+=1)Ie.push(dt[ct]);Ie.sort(Mb);for(var kt,St={},Gt=function(gr){var yr=Ie[gr];if(yr!==kt){kt=yr;var zr=O.featureIndexArray.get(yr),Qr=null;O.loadMatchingFeature(St,zr.bucketIndex,zr.sourceLayerIndex,zr.featureIndex,K,j.layers,j.availableImages,d,v,P,function(nn,Zn,Tn){return Qr||(Qr=an(nn)),Zn.queryIntersectsFeature(le,nn,Tn,Qr,O.z,l.transform,$,l.pixelPosMatrix)})}},or=0;or<Ie.length;or++)Gt(or);return St},Lh.prototype.loadMatchingFeature=function(l,d,v,P,O,j,$,K,le,me,be){var Ie=this.bucketLayerIDs[d];if(!j||function(nn,Zn){for(var Tn=0;Tn<nn.length;Tn++)if(Zn.indexOf(nn[Tn])>=0)return!0;return!1}(j,Ie)){var je=this.sourceLayerCoder.decode(v),Ye=this.vtLayers[je].feature(P);if(O.needGeometry){var ct=na(Ye,!0);if(!O.filter(new oo(this.tileID.overscaledZ),ct,this.tileID.canonical))return}else if(!O.filter(new oo(this.tileID.overscaledZ),Ye))return;for(var dt=this.getId(Ye,je),kt=0;kt<Ie.length;kt++){var St=Ie[kt];if(!(j&&j.indexOf(St)<0)){var Gt=K[St];if(Gt){var or={};dt!==void 0&&me&&(or=me.getState(Gt.sourceLayer||"_geojsonTileLayer",dt));var gr=ce({},le[St]);gr.paint=Tu(gr.paint,Gt.paint,Ye,or,$),gr.layout=Tu(gr.layout,Gt.layout,Ye,or,$);var yr=!be||be(Ye,Gt,or);if(yr){var zr=new eh(Ye,this.z,this.x,this.y,dt);zr.layer=gr;var Qr=l[St];Qr===void 0&&(Qr=l[St]=[]),Qr.push({featureIndex:P,feature:zr,intersectionZ:yr})}}}}}},Lh.prototype.lookupSymbolFeatures=function(l,d,v,P,O,j,$,K){var le={};this.loadVTLayers();for(var me=dd(O),be=0,Ie=l;be<Ie.length;be+=1)this.loadMatchingFeature(le,v,P,Ie[be],me,j,$,K,d);return le},Lh.prototype.hasLayer=function(l){for(var d=0,v=this.bucketLayerIDs;d<v.length;d+=1)for(var P=0,O=v[d];P<O.length;P+=1)if(l===O[P])return!0;return!1},Lh.prototype.getId=function(l,d){var v=l.id;return this.promoteId&&typeof(v=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(v=Number(v)),v},Rn("FeatureIndex",Lh,{omit:["rawTileData","sourceLayerCoder"]});var Ms=function(l,d){this.tileID=l,this.uid=Ee(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ms.prototype.registerFadeDuration=function(l){var d=l+this.timeAdded;d<Nn.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},Ms.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Ms.prototype.loadVectorData=function(l,d,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){for(var P in l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(me,be){var Ie={};if(!be)return Ie;for(var je=function(){var dt=ct[Ye],kt=dt.layerIds.map(function(or){return be.getLayer(or)}).filter(Boolean);if(kt.length!==0){dt.layers=kt,dt.stateDependentLayerIds&&(dt.stateDependentLayers=dt.stateDependentLayerIds.map(function(or){return kt.filter(function(gr){return gr.id===or})[0]}));for(var St=0,Gt=kt;St<Gt.length;St+=1)Ie[Gt[St].id]=dt}},Ye=0,ct=me;Ye<ct.length;Ye+=1)je();return Ie}(l.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var O=this.buckets[P];if(O instanceof To){if(this.hasSymbolBuckets=!0,!v)break;O.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var j in this.buckets){var $=this.buckets[j];if($ instanceof To&&$.hasRTLText){this.hasRTLText=!0,Ks.isLoading()||Ks.isLoaded()||sp()!=="deferred"||Jl();break}}for(var K in this.queryPadding=0,this.buckets){var le=this.buckets[K];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(K).queryRadius(le))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new E},Ms.prototype.unloadVectorData=function(){for(var l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ms.prototype.getBucket=function(l){return this.buckets[l.id]},Ms.prototype.upload=function(l){for(var d in this.buckets){var v=this.buckets[d];v.uploadPending()&&v.upload(l)}var P=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new uf(l,this.imageAtlas.image,P.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new uf(l,this.glyphAtlasImage,P.ALPHA),this.glyphAtlasImage=null)},Ms.prototype.prepare=function(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)},Ms.prototype.queryRenderedFeatures=function(l,d,v,P,O,j,$,K,le,me){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:P,cameraQueryGeometry:O,scale:j,tileSize:this.tileSize,pixelPosMatrix:me,transform:K,params:$,queryPadding:this.queryPadding*le},l,d,v):{}},Ms.prototype.querySourceFeatures=function(l,d){var v=this.latestFeatureIndex;if(v&&v.rawTileData){var P=v.loadVTLayers(),O=d?d.sourceLayer:"",j=P._geojsonTileLayer||P[O];if(j)for(var $=dd(d&&d.filter),K=this.tileID.canonical,le=K.z,me=K.x,be=K.y,Ie={z:le,x:me,y:be},je=0;je<j.length;je++){var Ye=j.feature(je);if($.needGeometry){var ct=na(Ye,!0);if(!$.filter(new oo(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!$.filter(new oo(this.tileID.overscaledZ),Ye))continue;var dt=v.getId(Ye,O),kt=new eh(Ye,le,me,be,dt);kt.tile=Ie,l.push(kt)}}},Ms.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Ms.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ms.prototype.setExpiryData=function(l){var d=this.expirationTime;if(l.cacheControl){var v=Ht(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){var P=Date.now(),O=!1;if(this.expirationTime>P)O=!1;else if(d)if(this.expirationTime<d)O=!0;else{var j=this.expirationTime-d;j?this.expirationTime=P+Math.max(j,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ms.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Ms.prototype.setFeatureState=function(l,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(l).length!==0){var v=this.latestFeatureIndex.loadVTLayers();for(var P in this.buckets)if(d.style.hasLayer(P)){var O=this.buckets[P],j=O.layers[0].sourceLayer||"_geojsonTileLayer",$=v[j],K=l[j];if($&&K&&Object.keys(K).length!==0){O.update(K,$,this.imageAtlas&&this.imageAtlas.patternPositions||{});var le=d&&d.style&&d.style.getLayer(P);le&&(this.queryPadding=Math.max(this.queryPadding,le.queryRadius(O)))}}}},Ms.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Ms.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Nn.now()},Ms.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ms.prototype.setHoldDuration=function(l){this.symbolFadeHoldUntil=Nn.now()+l},Ms.prototype.setDependencies=function(l,d){for(var v={},P=0,O=d;P<O.length;P+=1)v[O[P]]=!0;this.dependencies[l]=v},Ms.prototype.hasDependency=function(l,d){for(var v=0,P=l;v<P.length;v+=1){var O=this.dependencies[P[v]];if(O){for(var j=0,$=d;j<$.length;j+=1)if(O[$[j]])return!0}}return!1};var yp=X.performance,H0=function(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},yp.mark(this._marks.start)};H0.prototype.finish=function(){yp.mark(this._marks.end);var l=yp.getEntriesByName(this._marks.measure);return l.length===0&&(yp.measure(this._marks.measure,this._marks.start,this._marks.end),l=yp.getEntriesByName(this._marks.measure),yp.clearMarks(this._marks.start),yp.clearMarks(this._marks.end),yp.clearMeasures(this._marks.measure)),l},p.Actor=am,p.AlphaImage=Mh,p.CanonicalTileID=df,p.CollisionBoxArray=E,p.Color=qi,p.DEMData=kd,p.DataConstantProperty=Kn,p.DictionaryCoder=z_,p.EXTENT=8192,p.ErrorEvent=wt,p.EvaluationParameters=oo,p.Event=it,p.Evented=$e,p.FeatureIndex=Lh,p.FillBucket=Fl,p.FillExtrusionBucket=o,p.ImageAtlas=Zo,p.ImagePosition=Ro,p.LineBucket=ae,p.LngLat=Pn,p.LngLatBounds=cs,p.MercatorCoordinate=hf,p.ONE_EM=24,p.OverscaledTileID=us,p.Point=G,p.Point$1=G,p.Properties=_s,p.Protobuf=Zt,p.RGBAImage=Ja,p.RequestManager=gn,p.RequestPerformance=H0,p.ResourceType=Mr,p.SegmentVector=Je,p.SourceFeatureState=Gi,p.StructArrayLayout1ui2=Ch,p.StructArrayLayout2f1f2i16=vc,p.StructArrayLayout2i4=ec,p.StructArrayLayout3ui6=Yu,p.StructArrayLayout4i8=hp,p.SymbolBucket=To,p.Texture=uf,p.Tile=Ms,p.Transitionable=ns,p.Uniform1f=on,p.Uniform1i=Ur,p.Uniform2f=Hr,p.Uniform3f=mn,p.Uniform4f=Yn,p.UniformColor=ni,p.UniformMatrix4f=io,p.UnwrappedTileID=G0,p.ValidationError=Le,p.WritingMode=fi,p.ZoomHistory=ap,p.add=function(l,d,v){return l[0]=d[0]+v[0],l[1]=d[1]+v[1],l[2]=d[2]+v[2],l},p.addDynamicAttributes=Vy,p.asyncAll=function(l,d,v){if(!l.length)return v(null,[]);var P=l.length,O=new Array(l.length),j=null;l.forEach(function($,K){d($,function(le,me){le&&(j=le),O[K]=me,--P==0&&v(j,O)})})},p.bezier=ie,p.bindAll=tt,p.browser=Nn,p.cacheEntryPossiblyAdded=function(l){++cn>en&&(l.getActor().send("enforceCacheSizeLimit",br),cn=0)},p.clamp=Te,p.clearTileCache=function(l){var d=X.caches.delete("mapbox-tiles");l&&d.catch(l).then(function(){return l()})},p.clipLine=Qu,p.clone=function(l){var d=new Co(16);return d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},p.clone$1=Et,p.clone$2=function(l){var d=new Co(3);return d[0]=l[0],d[1]=l[1],d[2]=l[2],d},p.collisionCircleLayout=Pe,p.config=Pt,p.create=function(){var l=new Co(16);return Co!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},p.create$1=function(){var l=new Co(9);return Co!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l},p.create$2=function(){var l=new Co(4);return Co!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l},p.createCommonjsModule=s,p.createExpression=Zp,p.createLayout=Ya,p.createStyleLayer=function(l){return l.type==="custom"?new Pb(l):new Ui[l.type](l)},p.cross=function(l,d,v){var P=d[0],O=d[1],j=d[2],$=v[0],K=v[1],le=v[2];return l[0]=O*le-j*K,l[1]=j*$-P*le,l[2]=P*K-O*$,l},p.deepEqual=function l(d,v){if(Array.isArray(d)){if(!Array.isArray(v)||d.length!==v.length)return!1;for(var P=0;P<d.length;P++)if(!l(d[P],v[P]))return!1;return!0}if(typeof d=="object"&&d!==null&&v!==null){if(typeof v!="object"||Object.keys(d).length!==Object.keys(v).length)return!1;for(var O in d)if(!l(d[O],v[O]))return!1;return!0}return d===v},p.dot=function(l,d){return l[0]*d[0]+l[1]*d[1]+l[2]*d[2]},p.dot$1=function(l,d){return l[0]*d[0]+l[1]*d[1]+l[2]*d[2]+l[3]*d[3]},p.ease=se,p.emitValidationErrors=yd,p.endsWith=Ge,p.enforceCacheSizeLimit=function(l){ur(),Pi&&Pi.then(function(d){d.keys().then(function(v){for(var P=0;P<v.length-l;P++)d.delete(v[P])})})},p.evaluateSizeForFeature=wu,p.evaluateSizeForZoom=Oh,p.evaluateVariableOffset=z0,p.evented=Jp,p.extend=ce,p.featureFilter=dd,p.filterObject=yt,p.fromRotation=function(l,d){var v=Math.sin(d),P=Math.cos(d);return l[0]=P,l[1]=v,l[2]=0,l[3]=-v,l[4]=P,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},p.getAnchorAlignment=ss,p.getAnchorJustification=Fy,p.getArrayBuffer=mo,p.getImage=Re,p.getJSON=function(l,d){return Xi(ce(l,{type:"json"}),d)},p.getRTLTextPluginStatus=sp,p.getReferrer=ri,p.getVideo=function(l,d){var v,P,O=X.document.createElement("video");O.muted=!0,O.onloadstart=function(){d(null,O)};for(var j=0;j<l.length;j++){var $=X.document.createElement("source");v=l[j],P=void 0,(P=X.document.createElement("a")).href=v,(P.protocol!==X.document.location.protocol||P.host!==X.document.location.host)&&(O.crossOrigin="Anonymous"),$.src=l[j],O.appendChild($)}return{cancel:function(){}}},p.identity=Ns,p.invert=function(l,d){var v=d[0],P=d[1],O=d[2],j=d[3],$=d[4],K=d[5],le=d[6],me=d[7],be=d[8],Ie=d[9],je=d[10],Ye=d[11],ct=d[12],dt=d[13],kt=d[14],St=d[15],Gt=v*K-P*$,or=v*le-O*$,gr=v*me-j*$,yr=P*le-O*K,zr=P*me-j*K,Qr=O*me-j*le,nn=be*dt-Ie*ct,Zn=be*kt-je*ct,Tn=be*St-Ye*ct,li=Ie*kt-je*dt,En=Ie*St-Ye*dt,Qi=je*St-Ye*kt,Ai=Gt*Qi-or*En+gr*li+yr*Tn-zr*Zn+Qr*nn;return Ai?(l[0]=(K*Qi-le*En+me*li)*(Ai=1/Ai),l[1]=(O*En-P*Qi-j*li)*Ai,l[2]=(dt*Qr-kt*zr+St*yr)*Ai,l[3]=(je*zr-Ie*Qr-Ye*yr)*Ai,l[4]=(le*Tn-$*Qi-me*Zn)*Ai,l[5]=(v*Qi-O*Tn+j*Zn)*Ai,l[6]=(kt*gr-ct*Qr-St*or)*Ai,l[7]=(be*Qr-je*gr+Ye*or)*Ai,l[8]=($*En-K*Tn+me*nn)*Ai,l[9]=(P*Tn-v*En-j*nn)*Ai,l[10]=(ct*zr-dt*gr+St*Gt)*Ai,l[11]=(Ie*gr-be*zr-Ye*Gt)*Ai,l[12]=(K*Zn-$*li-le*nn)*Ai,l[13]=(v*li-P*Zn+O*nn)*Ai,l[14]=(dt*or-ct*yr-kt*Gt)*Ai,l[15]=(be*yr-Ie*or+je*Gt)*Ai,l):null},p.isChar=un,p.isMapboxURL=fr,p.keysDifference=function(l,d){var v=[];for(var P in l)P in d||v.push(P);return v},p.makeRequest=Xi,p.mapObject=_t,p.mercatorXfromLng=Md,p.mercatorYfromLat=U0,p.mercatorZfromAltitude=$0,p.mul=tf,p.multiply=ia,p.mvt=ys,p.nextPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},p.normalize=function(l,d){var v=d[0],P=d[1],O=d[2],j=v*v+P*P+O*O;return j>0&&(j=1/Math.sqrt(j)),l[0]=d[0]*j,l[1]=d[1]*j,l[2]=d[2]*j,l},p.number=lo,p.offscreenCanvasSupported=Xn,p.ortho=function(l,d,v,P,O,j,$){var K=1/(d-v),le=1/(P-O),me=1/(j-$);return l[0]=-2*K,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*le,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*me,l[11]=0,l[12]=(d+v)*K,l[13]=(O+P)*le,l[14]=($+j)*me,l[15]=1,l},p.parseGlyphPBF=function(l){return new Zt(l).readFields(pi,[])},p.pbf=Zt,p.performSymbolLayout=function(l,d,v,P,O,j,$){l.createArrays(),l.tilePixelRatio=8192/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;var K=l.layers[0].layout,le=l.layers[0]._unevaluatedLayout._values,me={};if(l.textSizeData.kind==="composite"){var be=l.textSizeData,Ie=be.maxZoom;me.compositeTextSizes=[le["text-size"].possiblyEvaluate(new oo(be.minZoom),$),le["text-size"].possiblyEvaluate(new oo(Ie),$)]}if(l.iconSizeData.kind==="composite"){var je=l.iconSizeData,Ye=je.maxZoom;me.compositeIconSizes=[le["icon-size"].possiblyEvaluate(new oo(je.minZoom),$),le["icon-size"].possiblyEvaluate(new oo(Ye),$)]}me.layoutTextSize=le["text-size"].possiblyEvaluate(new oo(l.zoom+1),$),me.layoutIconSize=le["icon-size"].possiblyEvaluate(new oo(l.zoom+1),$),me.textMaxSize=le["text-size"].possiblyEvaluate(new oo(18));for(var ct=24*K.get("text-line-height"),dt=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",kt=K.get("text-keep-upright"),St=K.get("text-size"),Gt=function(){var yr=gr[or],zr=K.get("text-font").evaluate(yr,{},$).join(","),Qr=St.evaluate(yr,{},$),nn=me.layoutTextSize.evaluate(yr,{},$),Zn=me.layoutIconSize.evaluate(yr,{},$),Tn={horizontal:{},vertical:void 0},li=yr.text,En=[0,0];if(li){var Qi=li.toString(),Ai=24*K.get("text-letter-spacing").evaluate(yr,{},$),Mn=function(fo){for(var Yo=0,$o=fo;Yo<$o.length;Yo+=1)if(Ao=$o[Yo].charCodeAt(0),un.Arabic(Ao)||un["Arabic Supplement"](Ao)||un["Arabic Extended-A"](Ao)||un["Arabic Presentation Forms-A"](Ao)||un["Arabic Presentation Forms-B"](Ao))return!1;var Ao;return!0}(Qi)?Ai:0,uo=K.get("text-anchor").evaluate(yr,{},$),hn=K.get("text-variable-anchor");if(!hn){var wo=K.get("text-radial-offset").evaluate(yr,{},$);En=wo?z0(uo,[24*wo,xs]):K.get("text-offset").evaluate(yr,{},$).map(function(fo){return 24*fo})}var jn=dt?"center":K.get("text-justify").evaluate(yr,{},$),ho=K.get("symbol-placement"),da=ho==="point"?24*K.get("text-max-width").evaluate(yr,{},$):0,Oa=function(){l.allowVerticalPlacement&&$u(Qi)&&(Tn.vertical=no(li,d,v,O,zr,da,ct,uo,"left",Mn,En,fi.vertical,!0,ho,nn,Qr))};if(!dt&&hn){for(var ba=jn==="auto"?hn.map(function(fo){return Fy(fo)}):[jn],pa=!1,La=0;La<ba.length;La++){var bs=ba[La];if(!Tn.horizontal[bs])if(pa)Tn.horizontal[bs]=Tn.horizontal[0];else{var ws=no(li,d,v,O,zr,da,ct,"center",bs,Mn,En,fi.horizontal,!1,ho,nn,Qr);ws&&(Tn.horizontal[bs]=ws,pa=ws.positionedLines.length===1)}}Oa()}else{jn==="auto"&&(jn=Fy(uo));var hl=no(li,d,v,O,zr,da,ct,uo,jn,Mn,En,fi.horizontal,!1,ho,nn,Qr);hl&&(Tn.horizontal[jn]=hl),Oa(),$u(Qi)&&dt&&kt&&(Tn.vertical=no(li,d,v,O,zr,da,ct,uo,jn,Mn,En,fi.vertical,!1,ho,nn,Qr))}}var hs=void 0,ei=!1;if(yr.icon&&yr.icon.name){var za=P[yr.icon.name];za&&(hs=function(fo,Yo,$o){var Ao=ss($o),El=Yo[0]-fo.displaySize[0]*Ao.horizontalAlign,Qs=Yo[1]-fo.displaySize[1]*Ao.verticalAlign;return{image:fo,top:Qs,bottom:Qs+fo.displaySize[1],left:El,right:El+fo.displaySize[0]}}(O[yr.icon.name],K.get("icon-offset").evaluate(yr,{},$),K.get("icon-anchor").evaluate(yr,{},$)),ei=za.sdf,l.sdfIcons===void 0?l.sdfIcons=za.sdf:l.sdfIcons!==za.sdf&&Ar("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(za.pixelRatio!==l.pixelRatio||K.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}var Na=Tb(Tn.horizontal)||Tn.vertical;l.iconsInText=!!Na&&Na.iconsInText,(Na||hs)&&function(fo,Yo,$o,Ao,El,Qs,la,Qa,el,Do,th){var $c=Qs.textMaxSize.evaluate(Yo,{});$c===void 0&&($c=la);var Rd,es=fo.layers[0].layout,Dd=es.get("icon-offset").evaluate(Yo,{},th),rh=Tb($o.horizontal),rg=la/24,sm=fo.tilePixelRatio*rg,ng=fo.tilePixelRatio*$c/24,vp=fo.tilePixelRatio*Qa,ig=fo.tilePixelRatio*es.get("symbol-spacing"),N_=es.get("text-padding")*fo.tilePixelRatio,wc=es.get("icon-padding")*fo.tilePixelRatio,lm=es.get("text-max-angle")/180*Math.PI,og=es.get("text-rotation-alignment")==="map"&&es.get("symbol-placement")!=="point",pf=es.get("icon-rotation-alignment")==="map"&&es.get("symbol-placement")!=="point",Od=es.get("symbol-placement"),ag=ig/2,cm=es.get("icon-text-fit");Ao&&cm!=="none"&&(fo.allowVerticalPlacement&&$o.vertical&&(Rd=ul(Ao,$o.vertical,cm,es.get("icon-text-fit-padding"),Dd,rg)),rh&&(Ao=ul(Ao,rh,cm,es.get("icon-text-fit-padding"),Dd,rg)));var Ld=function(kb,pg){pg.x<0||pg.x>=8192||pg.y<0||pg.y>=8192||function(oa,ih,X0,xp,Y0,Rb,Xy,zh,U_,$_,G_,Yy,K0,J0,fg,Q0,Ky,bp,Gc,ex,qc,Jy,mg,jd,FT){var Db,fm,ff,wp,mm,oh=oa.addToLineVertexArray(ih,X0),gg=0,Ob=0,Lb=0,zb=0,tx=-1,rx=-1,Sp={},Nb=lt(""),q_=0,nx=0;if(zh._unevaluatedLayout.getValue("text-radial-offset")===void 0?(q_=(Db=zh.layout.get("text-offset").evaluate(qc,{},jd).map(function(X_){return 24*X_}))[0],nx=Db[1]):(q_=24*zh.layout.get("text-radial-offset").evaluate(qc,{},jd),nx=xs),oa.allowVerticalPlacement&&xp.vertical){var gm=zh.layout.get("text-rotate").evaluate(qc,{},jd)+90;wp=new rm(U_,ih,$_,G_,Yy,xp.vertical,K0,J0,fg,gm),Xy&&(mm=new rm(U_,ih,$_,G_,Yy,Xy,Ky,bp,fg,gm))}if(Y0){var ix=zh.layout.get("icon-rotate").evaluate(qc,{}),ds=zh.layout.get("icon-text-fit")!=="none",W_=L0(Y0,ix,mg,ds),Qy=Xy?L0(Xy,ix,mg,ds):void 0;ff=new rm(U_,ih,$_,G_,Yy,Y0,Ky,bp,!1,ix),gg=4*W_.length;var H_=oa.iconSizeData,mf=null;H_.kind==="source"?(mf=[128*zh.layout.get("icon-size").evaluate(qc,{})])[0]>32640&&Ar(oa.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):H_.kind==="composite"&&((mf=[128*Jy.compositeIconSizes[0].evaluate(qc,{},jd),128*Jy.compositeIconSizes[1].evaluate(qc,{},jd)])[0]>32640||mf[1]>32640)&&Ar(oa.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),oa.addSymbols(oa.icon,W_,mf,ex,Gc,qc,!1,ih,oh.lineStartIndex,oh.lineLength,-1,jd),tx=oa.icon.placedSymbolArray.length-1,Qy&&(Ob=4*Qy.length,oa.addSymbols(oa.icon,Qy,mf,ex,Gc,qc,fi.vertical,ih,oh.lineStartIndex,oh.lineLength,-1,jd),rx=oa.icon.placedSymbolArray.length-1)}for(var _g in xp.horizontal){var Z_=xp.horizontal[_g];if(!fm){Nb=lt(Z_.text);var jb=zh.layout.get("text-rotate").evaluate(qc,{},jd);fm=new rm(U_,ih,$_,G_,Yy,Z_,K0,J0,fg,jb)}var yg=Z_.positionedLines.length===1;if(Lb+=Sb(oa,ih,Z_,Rb,zh,fg,qc,Q0,oh,xp.vertical?fi.horizontal:fi.horizontalOnly,yg?Object.keys(xp.horizontal):[_g],Sp,tx,Jy,jd),yg)break}xp.vertical&&(zb+=Sb(oa,ih,xp.vertical,Rb,zh,fg,qc,Q0,oh,fi.vertical,["vertical"],Sp,rx,Jy,jd));var ox=fm?fm.boxStartIndex:oa.collisionBoxArray.length,ax=fm?fm.boxEndIndex:oa.collisionBoxArray.length,ev=wp?wp.boxStartIndex:oa.collisionBoxArray.length,sx=wp?wp.boxEndIndex:oa.collisionBoxArray.length,VT=ff?ff.boxStartIndex:oa.collisionBoxArray.length,lx=ff?ff.boxEndIndex:oa.collisionBoxArray.length,cx=mm?mm.boxStartIndex:oa.collisionBoxArray.length,ux=mm?mm.boxEndIndex:oa.collisionBoxArray.length,Bd=-1,tv=function(X_,Fb){return X_&&X_.circleDiameter?Math.max(X_.circleDiameter,Fb):Fb};Bd=tv(fm,Bd),Bd=tv(wp,Bd),Bd=tv(ff,Bd);var Bb=(Bd=tv(mm,Bd))>-1?1:0;Bb&&(Bd*=FT/24),oa.glyphOffsetArray.length>=To.MAX_GLYPHS&&Ar("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),qc.sortKey!==void 0&&oa.addToSortKeyRanges(oa.symbolInstances.length,qc.sortKey),oa.symbolInstances.emplaceBack(ih.x,ih.y,Sp.right>=0?Sp.right:-1,Sp.center>=0?Sp.center:-1,Sp.left>=0?Sp.left:-1,Sp.vertical||-1,tx,rx,Nb,ox,ax,ev,sx,VT,lx,cx,ux,$_,Lb,zb,gg,Ob,Bb,0,K0,q_,nx,Bd)}(fo,pg,kb,$o,Ao,El,Rd,fo.layers[0],fo.collisionBoxArray,Yo.index,Yo.sourceLayerIndex,fo.index,sm,N_,og,el,vp,wc,pf,Dd,Yo,Qs,Do,th,la)};if(Od==="line")for(var Ko=0,Hy=Qu(Yo.geometry,0,0,8192,8192);Ko<Hy.length;Ko+=1)for(var um=Hy[Ko],j_=0,sg=Qm(um,ig,lm,$o.vertical||rh,Ao,24,ng,fo.overscaling,8192);j_<sg.length;j_+=1){var hm=sg[j_];rh&&ha(fo,rh.text,ag,hm)||Ld(um,hm)}else if(Od==="line-center")for(var B_=0,lg=Yo.geometry;B_<lg.length;B_+=1){var F_=lg[B_];if(F_.length>1){var cg=lf(F_,lm,$o.vertical||rh,Ao,24,ng);cg&&Ld(F_,cg)}}else if(Yo.type==="Polygon")for(var Sc=0,nh=ua(Yo.geometry,0);Sc<nh.length;Sc+=1){var dm=nh[Sc],ug=jT(dm,16);Ld(dm[0],new Ps(ug.x,ug.y,0))}else if(Yo.type==="LineString")for(var zd=0,pm=Yo.geometry;zd<pm.length;zd+=1){var Nd=pm[zd];Ld(Nd,new Ps(Nd[0].x,Nd[0].y,0))}else if(Yo.type==="Point")for(var hg=0,Z0=Yo.geometry;hg<Z0.length;hg+=1)for(var dg=0,Zy=Z0[hg];dg<Zy.length;dg+=1){var V_=Zy[dg];Ld([V_],new Ps(V_.x,V_.y,0))}}(l,yr,Tn,hs,P,me,nn,Zn,En,ei,$)},or=0,gr=l.features;or<gr.length;or+=1)Gt();j&&l.generateCollisionDebugBuffers()},p.perspective=function(l,d,v,P,O){var j,$=1/Math.tan(d/2);return l[0]=$/v,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=$,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,O!=null&&O!==1/0?(l[10]=(O+P)*(j=1/(P-O)),l[14]=2*O*P*j):(l[10]=-1,l[14]=-2*P),l},p.pick=function(l,d){for(var v={},P=0;P<d.length;P++){var O=d[P];O in l&&(v[O]=l[O])}return v},p.plugin=Ks,p.polygonIntersectsPolygon=rc,p.postMapLoadEvent=cr,p.postTurnstileEvent=at,p.potpack=ro,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.register=Rn,p.registerForPluginStateChange=function(l){return l({pluginStatus:Si,pluginURL:yc}),Jp.on("pluginStateChange",l),l},p.renderColorRamp=mp,p.rotate=function(l,d,v){var P=d[0],O=d[1],j=d[2],$=d[3],K=Math.sin(v),le=Math.cos(v);return l[0]=P*le+j*K,l[1]=O*le+$*K,l[2]=P*-K+j*le,l[3]=O*-K+$*le,l},p.rotateX=function(l,d,v){var P=Math.sin(v),O=Math.cos(v),j=d[4],$=d[5],K=d[6],le=d[7],me=d[8],be=d[9],Ie=d[10],je=d[11];return d!==l&&(l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15]),l[4]=j*O+me*P,l[5]=$*O+be*P,l[6]=K*O+Ie*P,l[7]=le*O+je*P,l[8]=me*O-j*P,l[9]=be*O-$*P,l[10]=Ie*O-K*P,l[11]=je*O-le*P,l},p.rotateZ=function(l,d,v){var P=Math.sin(v),O=Math.cos(v),j=d[0],$=d[1],K=d[2],le=d[3],me=d[4],be=d[5],Ie=d[6],je=d[7];return d!==l&&(l[8]=d[8],l[9]=d[9],l[10]=d[10],l[11]=d[11],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15]),l[0]=j*O+me*P,l[1]=$*O+be*P,l[2]=K*O+Ie*P,l[3]=le*O+je*P,l[4]=me*O-j*P,l[5]=be*O-$*P,l[6]=Ie*O-K*P,l[7]=je*O-le*P,l},p.scale=function(l,d,v){var P=v[0],O=v[1],j=v[2];return l[0]=d[0]*P,l[1]=d[1]*P,l[2]=d[2]*P,l[3]=d[3]*P,l[4]=d[4]*O,l[5]=d[5]*O,l[6]=d[6]*O,l[7]=d[7]*O,l[8]=d[8]*j,l[9]=d[9]*j,l[10]=d[10]*j,l[11]=d[11]*j,l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15],l},p.scale$1=function(l,d,v){return l[0]=d[0]*v,l[1]=d[1]*v,l[2]=d[2]*v,l[3]=d[3]*v,l},p.scale$2=function(l,d,v){return l[0]=d[0]*v,l[1]=d[1]*v,l[2]=d[2]*v,l},p.setCacheLimits=function(l,d){br=l,en=d},p.setRTLTextPlugin=function(l,d,v){if(v===void 0&&(v=!1),Si==="deferred"||Si==="loading"||Si==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");yc=Nn.resolveURL(l),Si="deferred",_c=d,qu(),v||Jl()},p.sphericalToCartesian=function(l){var d=l[0],v=l[1],P=l[2];return v+=90,v*=Math.PI/180,P*=Math.PI/180,{x:d*Math.cos(v)*Math.sin(P),y:d*Math.sin(v)*Math.sin(P),z:d*Math.cos(P)}},p.sqrLen=function(l){var d=l[0],v=l[1];return d*d+v*v},p.styleSpec=ve,p.sub=function(l,d,v){return l[0]=d[0]-v[0],l[1]=d[1]-v[1],l[2]=d[2]-v[2],l},p.symbolSize=gp,p.transformMat3=function(l,d,v){var P=d[0],O=d[1],j=d[2];return l[0]=P*v[0]+O*v[3]+j*v[6],l[1]=P*v[1]+O*v[4]+j*v[7],l[2]=P*v[2]+O*v[5]+j*v[8],l},p.transformMat4=jo,p.translate=function(l,d,v){var P,O,j,$,K,le,me,be,Ie,je,Ye,ct,dt=v[0],kt=v[1],St=v[2];return d===l?(l[12]=d[0]*dt+d[4]*kt+d[8]*St+d[12],l[13]=d[1]*dt+d[5]*kt+d[9]*St+d[13],l[14]=d[2]*dt+d[6]*kt+d[10]*St+d[14],l[15]=d[3]*dt+d[7]*kt+d[11]*St+d[15]):(O=d[1],j=d[2],$=d[3],K=d[4],le=d[5],me=d[6],be=d[7],Ie=d[8],je=d[9],Ye=d[10],ct=d[11],l[0]=P=d[0],l[1]=O,l[2]=j,l[3]=$,l[4]=K,l[5]=le,l[6]=me,l[7]=be,l[8]=Ie,l[9]=je,l[10]=Ye,l[11]=ct,l[12]=P*dt+K*kt+Ie*St+d[12],l[13]=O*dt+le*kt+je*St+d[13],l[14]=j*dt+me*kt+Ye*St+d[14],l[15]=$*dt+be*kt+ct*St+d[15]),l},p.triggerPluginCompletionEvent=Vm,p.uniqueId=Ee,p.validateCustomStyleLayer=function(l){var d=[],v=l.id;return v===void 0&&d.push({message:"layers."+v+': missing required property "id"'}),l.render===void 0&&d.push({message:"layers."+v+': missing required method "render"'}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&d.push({message:"layers."+v+': property "renderingMode" must be either "2d" or "3d"'}),d},p.validateLight=Fm,p.validateStyle=Kl,p.values=function(l){var d=[];for(var v in l)d.push(l[v]);return d},p.vectorTile=ys,p.version="1.13.3",p.warnOnce=Ar,p.webpSupported=Dt,p.window=X,p.wrap=ue}),w(["./shared"],function(p){function s(Se){var Re=typeof Se;if(Re==="number"||Re==="boolean"||Re==="string"||Se==null)return JSON.stringify(Se);if(Array.isArray(Se)){for(var Fe="[",et=0,it=Se;et<it.length;et+=1)Fe+=s(it[et])+",";return Fe+"]"}for(var wt=Object.keys(Se).sort(),$e="{",ve=0;ve<wt.length;ve++)$e+=JSON.stringify(wt[ve])+":"+s(Se[wt[ve]])+",";return $e+"}"}function L(Se){for(var Re="",Fe=0,et=p.refProperties;Fe<et.length;Fe+=1)Re+="/"+s(Se[et[Fe]]);return Re}var F=function(Se){this.keyCache={},Se&&this.replace(Se)};F.prototype.replace=function(Se){this._layerConfigs={},this._layers={},this.update(Se,[])},F.prototype.update=function(Se,Re){for(var Fe=this,et=0,it=Se;et<it.length;et+=1){var wt=it[et];this._layerConfigs[wt.id]=wt;var $e=this._layers[wt.id]=p.createStyleLayer(wt);$e._featureFilter=p.featureFilter($e.filter),this.keyCache[wt.id]&&delete this.keyCache[wt.id]}for(var ve=0,Le=Re;ve<Le.length;ve+=1){var ot=Le[ve];delete this.keyCache[ot],delete this._layerConfigs[ot],delete this._layers[ot]}this.familiesBySource={};for(var Mt=0,Ot=function(er,Nr){for(var Ln={},$r=0;$r<er.length;$r++){var si=Nr&&Nr[er[$r].id]||L(er[$r]);Nr&&(Nr[er[$r].id]=si);var Yi=Ln[si];Yi||(Yi=Ln[si]=[]),Yi.push(er[$r])}var xn=[];for(var $i in Ln)xn.push(Ln[$i]);return xn}(p.values(this._layerConfigs),this.keyCache);Mt<Ot.length;Mt+=1){var bt=Ot[Mt].map(function(er){return Fe._layers[er.id]}),Rt=bt[0];if(Rt.visibility!=="none"){var ar=Rt.source||"",qt=this.familiesBySource[ar];qt||(qt=this.familiesBySource[ar]={});var Nt=Rt.sourceLayer||"_geojsonTileLayer",Rr=qt[Nt];Rr||(Rr=qt[Nt]=[]),Rr.push(bt)}}};var G=function(Se){var Re={},Fe=[];for(var et in Se){var it=Se[et],wt=Re[et]={};for(var $e in it){var ve=it[+$e];if(ve&&ve.bitmap.width!==0&&ve.bitmap.height!==0){var Le={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};Fe.push(Le),wt[$e]={rect:Le,metrics:ve.metrics}}}}var ot=p.potpack(Fe),Mt=new p.AlphaImage({width:ot.w||1,height:ot.h||1});for(var Ot in Se){var bt=Se[Ot];for(var Rt in bt){var ar=bt[+Rt];if(ar&&ar.bitmap.width!==0&&ar.bitmap.height!==0){var qt=Re[Ot][Rt].rect;p.AlphaImage.copy(ar.bitmap,Mt,{x:0,y:0},{x:qt.x+1,y:qt.y+1},ar.bitmap)}}}this.image=Mt,this.positions=Re};p.register("GlyphAtlas",G);var H=function(Se){this.tileID=new p.OverscaledTileID(Se.tileID.overscaledZ,Se.tileID.wrap,Se.tileID.canonical.z,Se.tileID.canonical.x,Se.tileID.canonical.y),this.uid=Se.uid,this.zoom=Se.zoom,this.pixelRatio=Se.pixelRatio,this.tileSize=Se.tileSize,this.source=Se.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Se.showCollisionBoxes,this.collectResourceTiming=!!Se.collectResourceTiming,this.returnDependencies=!!Se.returnDependencies,this.promoteId=Se.promoteId};function X(Se,Re,Fe){for(var et=new p.EvaluationParameters(Re),it=0,wt=Se;it<wt.length;it+=1)wt[it].recalculate(et,Fe)}function ne(Se,Re){var Fe=p.getArrayBuffer(Se.request,function(et,it,wt,$e){et?Re(et):it&&Re(null,{vectorTile:new p.vectorTile.VectorTile(new p.pbf(it)),rawData:it,cacheControl:wt,expires:$e})});return function(){Fe.cancel(),Re()}}H.prototype.parse=function(Se,Re,Fe,et,it){var wt=this;this.status="parsing",this.data=Se,this.collisionBoxArray=new p.CollisionBoxArray;var $e=new p.DictionaryCoder(Object.keys(Se.layers).sort()),ve=new p.FeatureIndex(this.tileID,this.promoteId);ve.bucketLayerIDs=[];var Le,ot,Mt,Ot,bt={},Rt={featureIndex:ve,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Fe},ar=Re.familiesBySource[this.source];for(var qt in ar){var Nt=Se.layers[qt];if(Nt){Nt.version===1&&p.warnOnce('Vector tile source "'+this.source+'" layer "'+qt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Rr=$e.encode(qt),er=[],Nr=0;Nr<Nt.length;Nr++){var Ln=Nt.feature(Nr),$r=ve.getId(Ln,qt);er.push({feature:Ln,id:$r,index:Nr,sourceLayerIndex:Rr})}for(var si=0,Yi=ar[qt];si<Yi.length;si+=1){var xn=Yi[si],$i=xn[0];$i.minzoom&&this.zoom<Math.floor($i.minzoom)||$i.maxzoom&&this.zoom>=$i.maxzoom||$i.visibility!=="none"&&(X(xn,this.zoom,Fe),(bt[$i.id]=$i.createBucket({index:ve.bucketLayerIDs.length,layers:xn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rr,sourceID:this.source})).populate(er,Rt,this.tileID.canonical),ve.bucketLayerIDs.push(xn.map(function(so){return so.id})))}}}var di=p.mapObject(Rt.glyphDependencies,function(so){return Object.keys(so).map(Number)});Object.keys(di).length?et.send("getGlyphs",{uid:this.uid,stacks:di},function(so,Ni){Le||(Le=so,ot=Ni,xo.call(wt))}):ot={};var vo=Object.keys(Rt.iconDependencies);vo.length?et.send("getImages",{icons:vo,source:this.source,tileID:this.tileID,type:"icons"},function(so,Ni){Le||(Le=so,Mt=Ni,xo.call(wt))}):Mt={};var to=Object.keys(Rt.patternDependencies);function xo(){if(Le)return it(Le);if(ot&&Mt&&Ot){var so=new G(ot),Ni=new p.ImageAtlas(Mt,Ot);for(var qi in bt){var rs=bt[qi];rs instanceof p.SymbolBucket?(X(rs.layers,this.zoom,Fe),p.performSymbolLayout(rs,ot,so.positions,Mt,Ni.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):rs.hasPattern&&(rs instanceof p.LineBucket||rs instanceof p.FillBucket||rs instanceof p.FillExtrusionBucket)&&(X(rs.layers,this.zoom,Fe),rs.addFeatures(Rt,this.tileID.canonical,Ni.patternPositions))}this.status="done",it(null,{buckets:p.values(bt).filter(function(kl){return!kl.isEmpty()}),featureIndex:ve,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:so.image,imageAtlas:Ni,glyphMap:this.returnDependencies?ot:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?so.positions:null})}}to.length?et.send("getImages",{icons:to,source:this.source,tileID:this.tileID,type:"patterns"},function(so,Ni){Le||(Le=so,Ot=Ni,xo.call(wt))}):Ot={},xo.call(this)};var ie=function(Se,Re,Fe,et){this.actor=Se,this.layerIndex=Re,this.availableImages=Fe,this.loadVectorData=et||ne,this.loading={},this.loaded={}};ie.prototype.loadTile=function(Se,Re){var Fe=this,et=Se.uid;this.loading||(this.loading={});var it=!!(Se&&Se.request&&Se.request.collectResourceTiming)&&new p.RequestPerformance(Se.request),wt=this.loading[et]=new H(Se);wt.abort=this.loadVectorData(Se,function($e,ve){if(delete Fe.loading[et],$e||!ve)return wt.status="done",Fe.loaded[et]=wt,Re($e);var Le=ve.rawData,ot={};ve.expires&&(ot.expires=ve.expires),ve.cacheControl&&(ot.cacheControl=ve.cacheControl);var Mt={};if(it){var Ot=it.finish();Ot&&(Mt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}wt.vectorTile=ve.vectorTile,wt.parse(ve.vectorTile,Fe.layerIndex,Fe.availableImages,Fe.actor,function(bt,Rt){if(bt||!Rt)return Re(bt);Re(null,p.extend({rawTileData:Le.slice(0)},Rt,ot,Mt))}),Fe.loaded=Fe.loaded||{},Fe.loaded[et]=wt})},ie.prototype.reloadTile=function(Se,Re){var Fe=this,et=this.loaded,it=Se.uid,wt=this;if(et&&et[it]){var $e=et[it];$e.showCollisionBoxes=Se.showCollisionBoxes;var ve=function(Le,ot){var Mt=$e.reloadCallback;Mt&&(delete $e.reloadCallback,$e.parse($e.vectorTile,wt.layerIndex,Fe.availableImages,wt.actor,Mt)),Re(Le,ot)};$e.status==="parsing"?$e.reloadCallback=ve:$e.status==="done"&&($e.vectorTile?$e.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,ve):ve())}},ie.prototype.abortTile=function(Se,Re){var Fe=this.loading,et=Se.uid;Fe&&Fe[et]&&Fe[et].abort&&(Fe[et].abort(),delete Fe[et]),Re()},ie.prototype.removeTile=function(Se,Re){var Fe=this.loaded,et=Se.uid;Fe&&Fe[et]&&delete Fe[et],Re()};var se=p.window.ImageBitmap,Te=function(){this.loaded={}};function ue(Se,Re){if(Se.length!==0){ce(Se[0],Re);for(var Fe=1;Fe<Se.length;Fe++)ce(Se[Fe],!Re)}}function ce(Se,Re){for(var Fe=0,et=0,it=0,wt=Se.length,$e=wt-1;it<wt;$e=it++){var ve=(Se[it][0]-Se[$e][0])*(Se[$e][1]+Se[it][1]),Le=Fe+ve;et+=Math.abs(Fe)>=Math.abs(ve)?Fe-Le+ve:ve-Le+Fe,Fe=Le}Fe+et>=0!=!!Re&&Se.reverse()}Te.prototype.loadTile=function(Se,Re){var Fe=Se.uid,et=Se.encoding,it=Se.rawImageData,wt=se&&it instanceof se?this.getImageData(it):it,$e=new p.DEMData(Fe,wt,et);this.loaded=this.loaded||{},this.loaded[Fe]=$e,Re(null,$e)},Te.prototype.getImageData=function(Se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Se.width,Se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Se.width,this.offscreenCanvas.height=Se.height,this.offscreenCanvasContext.drawImage(Se,0,0,Se.width,Se.height);var Re=this.offscreenCanvasContext.getImageData(-1,-1,Se.width+2,Se.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new p.RGBAImage({width:Re.width,height:Re.height},Re.data)},Te.prototype.removeTile=function(Se){var Re=this.loaded,Fe=Se.uid;Re&&Re[Fe]&&delete Re[Fe]};var de=p.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ee=function(Se){this._feature=Se,this.extent=p.EXTENT,this.type=Se.type,this.properties=Se.tags,"id"in Se&&!isNaN(Se.id)&&(this.id=parseInt(Se.id,10))};Ee.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Se=[],Re=0,Fe=this._feature.geometry;Re<Fe.length;Re+=1){var et=Fe[Re];Se.push([new p.Point$1(et[0],et[1])])}return Se}for(var it=[],wt=0,$e=this._feature.geometry;wt<$e.length;wt+=1){for(var ve=[],Le=0,ot=$e[wt];Le<ot.length;Le+=1){var Mt=ot[Le];ve.push(new p.Point$1(Mt[0],Mt[1]))}it.push(ve)}return it},Ee.prototype.toGeoJSON=function(Se,Re,Fe){return de.call(this,Se,Re,Fe)};var Ne=function(Se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=Se.length,this._features=Se};Ne.prototype.feature=function(Se){return new Ee(this._features[Se])};var rt=p.vectorTile.VectorTileFeature,tt=Ge;function Ge(Se,Re){this.options=Re||{},this.features=Se,this.length=Se.length}function _t(Se,Re){this.id=typeof Se.id=="number"?Se.id:void 0,this.type=Se.type,this.rawGeometry=Se.type===1?[Se.geometry]:Se.geometry,this.properties=Se.tags,this.extent=Re||4096}Ge.prototype.feature=function(Se){return new _t(this.features[Se],this.options.extent)},_t.prototype.loadGeometry=function(){var Se=this.rawGeometry;this.geometry=[];for(var Re=0;Re<Se.length;Re++){for(var Fe=Se[Re],et=[],it=0;it<Fe.length;it++)et.push(new p.Point$1(Fe[it][0],Fe[it][1]));this.geometry.push(et)}return this.geometry},_t.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Se=this.geometry,Re=1/0,Fe=-1/0,et=1/0,it=-1/0,wt=0;wt<Se.length;wt++)for(var $e=Se[wt],ve=0;ve<$e.length;ve++){var Le=$e[ve];Re=Math.min(Re,Le.x),Fe=Math.max(Fe,Le.x),et=Math.min(et,Le.y),it=Math.max(it,Le.y)}return[Re,et,Fe,it]},_t.prototype.toGeoJSON=rt.prototype.toGeoJSON;var yt=Wt,Et=tt;function Wt(Se){var Re=new p.pbf;return function(Fe,et){for(var it in Fe.layers)et.writeMessage(3,Ar,Fe.layers[it])}(Se,Re),Re.finish()}function Ar(Se,Re){var Fe;Re.writeVarintField(15,Se.version||1),Re.writeStringField(1,Se.name||""),Re.writeVarintField(5,Se.extent||4096);var et={keys:[],values:[],keycache:{},valuecache:{}};for(Fe=0;Fe<Se.length;Fe++)et.feature=Se.feature(Fe),Re.writeMessage(2,mt,et);var it=et.keys;for(Fe=0;Fe<it.length;Fe++)Re.writeStringField(3,it[Fe]);var wt=et.values;for(Fe=0;Fe<wt.length;Fe++)Re.writeMessage(4,sr,wt[Fe])}function mt(Se,Re){var Fe=Se.feature;Fe.id!==void 0&&Re.writeVarintField(1,Fe.id),Re.writeMessage(2,nr,Se),Re.writeVarintField(3,Fe.type),Re.writeMessage(4,Qt,Fe)}function nr(Se,Re){var Fe=Se.feature,et=Se.keys,it=Se.values,wt=Se.keycache,$e=Se.valuecache;for(var ve in Fe.properties){var Le=wt[ve];Le===void 0&&(et.push(ve),wt[ve]=Le=et.length-1),Re.writeVarint(Le);var ot=Fe.properties[ve],Mt=typeof ot;Mt!=="string"&&Mt!=="boolean"&&Mt!=="number"&&(ot=JSON.stringify(ot));var Ot=Mt+":"+ot,bt=$e[Ot];bt===void 0&&(it.push(ot),$e[Ot]=bt=it.length-1),Re.writeVarint(bt)}}function Xt(Se,Re){return(Re<<3)+(7&Se)}function Ht(Se){return Se<<1^Se>>31}function Qt(Se,Re){for(var Fe=Se.loadGeometry(),et=Se.type,it=0,wt=0,$e=Fe.length,ve=0;ve<$e;ve++){var Le=Fe[ve],ot=1;et===1&&(ot=Le.length),Re.writeVarint(Xt(1,ot));for(var Mt=et===3?Le.length-1:Le.length,Ot=0;Ot<Mt;Ot++){Ot===1&&et!==1&&Re.writeVarint(Xt(2,Mt-1));var bt=Le[Ot].x-it,Rt=Le[Ot].y-wt;Re.writeVarint(Ht(bt)),Re.writeVarint(Ht(Rt)),it+=bt,wt+=Rt}et===3&&Re.writeVarint(Xt(7,1))}}function sr(Se,Re){var Fe=typeof Se;Fe==="string"?Re.writeStringField(1,Se):Fe==="boolean"?Re.writeBooleanField(7,Se):Fe==="number"&&(Se%1!=0?Re.writeDoubleField(3,Se):Se<0?Re.writeSVarintField(6,Se):Re.writeVarintField(5,Se))}function Tr(Se,Re,Fe,et){ln(Se,Fe,et),ln(Re,2*Fe,2*et),ln(Re,2*Fe+1,2*et+1)}function ln(Se,Re,Fe){var et=Se[Re];Se[Re]=Se[Fe],Se[Fe]=et}function vn(Se,Re,Fe,et){var it=Se-Fe,wt=Re-et;return it*it+wt*wt}yt.fromVectorTileJs=Wt,yt.fromGeojsonVt=function(Se,Re){Re=Re||{};var Fe={};for(var et in Se)Fe[et]=new tt(Se[et].features,Re),Fe[et].name=et,Fe[et].version=Re.version,Fe[et].extent=Re.extent;return Wt({layers:Fe})},yt.GeoJSONWrapper=Et;var wi=function(Se){return Se[0]},hi=function(Se){return Se[1]},Vn=function(Se,Re,Fe,et,it){Re===void 0&&(Re=wi),Fe===void 0&&(Fe=hi),et===void 0&&(et=64),it===void 0&&(it=Float64Array),this.nodeSize=et,this.points=Se;for(var wt=Se.length<65536?Uint16Array:Uint32Array,$e=this.ids=new wt(Se.length),ve=this.coords=new it(2*Se.length),Le=0;Le<Se.length;Le++)$e[Le]=Le,ve[2*Le]=Re(Se[Le]),ve[2*Le+1]=Fe(Se[Le]);(function ot(Mt,Ot,bt,Rt,ar,qt){if(!(ar-Rt<=bt)){var Nt=Rt+ar>>1;(function Rr(er,Nr,Ln,$r,si,Yi){for(;si>$r;){if(si-$r>600){var xn=si-$r+1,$i=Ln-$r+1,di=Math.log(xn),vo=.5*Math.exp(2*di/3),to=.5*Math.sqrt(di*vo*(xn-vo)/xn)*($i-xn/2<0?-1:1);Rr(er,Nr,Ln,Math.max($r,Math.floor(Ln-$i*vo/xn+to)),Math.min(si,Math.floor(Ln+(xn-$i)*vo/xn+to)),Yi)}var xo=Nr[2*Ln+Yi],so=$r,Ni=si;for(Tr(er,Nr,$r,Ln),Nr[2*si+Yi]>xo&&Tr(er,Nr,$r,si);so<Ni;){for(Tr(er,Nr,so,Ni),so++,Ni--;Nr[2*so+Yi]<xo;)so++;for(;Nr[2*Ni+Yi]>xo;)Ni--}Nr[2*$r+Yi]===xo?Tr(er,Nr,$r,Ni):Tr(er,Nr,++Ni,si),Ni<=Ln&&($r=Ni+1),Ln<=Ni&&(si=Ni-1)}})(Mt,Ot,Nt,Rt,ar,qt%2),ot(Mt,Ot,bt,Rt,Nt-1,qt+1),ot(Mt,Ot,bt,Nt+1,ar,qt+1)}})($e,ve,et,0,$e.length-1,0)};Vn.prototype.range=function(Se,Re,Fe,et){return function(it,wt,$e,ve,Le,ot,Mt){for(var Ot,bt,Rt=[0,it.length-1,0],ar=[];Rt.length;){var qt=Rt.pop(),Nt=Rt.pop(),Rr=Rt.pop();if(Nt-Rr<=Mt)for(var er=Rr;er<=Nt;er++)bt=wt[2*er+1],(Ot=wt[2*er])>=$e&&Ot<=Le&&bt>=ve&&bt<=ot&&ar.push(it[er]);else{var Nr=Math.floor((Rr+Nt)/2);bt=wt[2*Nr+1],(Ot=wt[2*Nr])>=$e&&Ot<=Le&&bt>=ve&&bt<=ot&&ar.push(it[Nr]);var Ln=(qt+1)%2;(qt===0?$e<=Ot:ve<=bt)&&(Rt.push(Rr),Rt.push(Nr-1),Rt.push(Ln)),(qt===0?Le>=Ot:ot>=bt)&&(Rt.push(Nr+1),Rt.push(Nt),Rt.push(Ln))}}return ar}(this.ids,this.coords,Se,Re,Fe,et,this.nodeSize)},Vn.prototype.within=function(Se,Re,Fe){return function(et,it,wt,$e,ve,Le){for(var ot=[0,et.length-1,0],Mt=[],Ot=ve*ve;ot.length;){var bt=ot.pop(),Rt=ot.pop(),ar=ot.pop();if(Rt-ar<=Le)for(var qt=ar;qt<=Rt;qt++)vn(it[2*qt],it[2*qt+1],wt,$e)<=Ot&&Mt.push(et[qt]);else{var Nt=Math.floor((ar+Rt)/2),Rr=it[2*Nt],er=it[2*Nt+1];vn(Rr,er,wt,$e)<=Ot&&Mt.push(et[Nt]);var Nr=(bt+1)%2;(bt===0?wt-ve<=Rr:$e-ve<=er)&&(ot.push(ar),ot.push(Nt-1),ot.push(Nr)),(bt===0?wt+ve>=Rr:$e+ve>=er)&&(ot.push(Nt+1),ot.push(Rt),ot.push(Nr))}}return Mt}(this.ids,this.coords,Se,Re,Fe,this.nodeSize)};var Oi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Se){return Se}},fn=function(Se){this.options=Cn(Object.create(Oi),Se),this.trees=new Array(this.options.maxZoom+1)};function Nn(Se,Re,Fe,et,it){return{x:Se,y:Re,zoom:1/0,id:Fe,parentId:-1,numPoints:et,properties:it}}function Pt(Se,Re){var Fe=Se.geometry.coordinates,et=Fe[1];return{x:xr(Fe[0]),y:Kt(et),zoom:1/0,index:Re,parentId:-1}}function Dt(Se){return{type:"Feature",id:Se.id,properties:Ir(Se),geometry:{type:"Point",coordinates:[(et=Se.x,360*(et-.5)),(Re=Se.y,Fe=(180-360*Re)*Math.PI/180,360*Math.atan(Math.exp(Fe))/Math.PI-90)]}};var Re,Fe,et}function Ir(Se){var Re=Se.numPoints,Fe=Re>=1e4?Math.round(Re/1e3)+"k":Re>=1e3?Math.round(Re/100)/10+"k":Re;return Cn(Cn({},Se.properties),{cluster:!0,cluster_id:Se.id,point_count:Re,point_count_abbreviated:Fe})}function xr(Se){return Se/360+.5}function Kt(Se){var Re=Math.sin(Se*Math.PI/180),Fe=.5-.25*Math.log((1+Re)/(1-Re))/Math.PI;return Fe<0?0:Fe>1?1:Fe}function Cn(Se,Re){for(var Fe in Re)Se[Fe]=Re[Fe];return Se}function gn(Se){return Se.x}function fr(Se){return Se.y}function Zr(Se,Re,Fe,et,it,wt){var $e=it-Fe,ve=wt-et;if($e!==0||ve!==0){var Le=((Se-Fe)*$e+(Re-et)*ve)/($e*$e+ve*ve);Le>1?(Fe=it,et=wt):Le>0&&(Fe+=$e*Le,et+=ve*Le)}return($e=Se-Fe)*$e+(ve=Re-et)*ve}function qr(Se,Re,Fe,et){var it={id:Se===void 0?null:Se,type:Re,geometry:Fe,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(wt){var $e=wt.geometry,ve=wt.type;if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")sn(wt,$e);else if(ve==="Polygon"||ve==="MultiLineString")for(var Le=0;Le<$e.length;Le++)sn(wt,$e[Le]);else if(ve==="MultiPolygon")for(Le=0;Le<$e.length;Le++)for(var ot=0;ot<$e[Le].length;ot++)sn(wt,$e[Le][ot])}(it),it}function sn(Se,Re){for(var Fe=0;Fe<Re.length;Fe+=3)Se.minX=Math.min(Se.minX,Re[Fe]),Se.minY=Math.min(Se.minY,Re[Fe+1]),Se.maxX=Math.max(Se.maxX,Re[Fe]),Se.maxY=Math.max(Se.maxY,Re[Fe+1])}function qn(Se,Re,Fe,et){if(Re.geometry){var it=Re.geometry.coordinates,wt=Re.geometry.type,$e=Math.pow(Fe.tolerance/((1<<Fe.maxZoom)*Fe.extent),2),ve=[],Le=Re.id;if(Fe.promoteId?Le=Re.properties[Fe.promoteId]:Fe.generateId&&(Le=et||0),wt==="Point")Li(it,ve);else if(wt==="MultiPoint")for(var ot=0;ot<it.length;ot++)Li(it[ot],ve);else if(wt==="LineString")_i(it,ve,$e,!1);else if(wt==="MultiLineString"){if(Fe.lineMetrics){for(ot=0;ot<it.length;ot++)_i(it[ot],ve=[],$e,!1),Se.push(qr(Le,"LineString",ve,Re.properties));return}zi(it,ve,$e,!1)}else if(wt==="Polygon")zi(it,ve,$e,!0);else{if(wt!=="MultiPolygon"){if(wt==="GeometryCollection"){for(ot=0;ot<Re.geometry.geometries.length;ot++)qn(Se,{id:Le,geometry:Re.geometry.geometries[ot],properties:Re.properties},Fe,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ot=0;ot<it.length;ot++){var Mt=[];zi(it[ot],Mt,$e,!0),ve.push(Mt)}}Se.push(qr(Le,wt,ve,Re.properties))}}function Li(Se,Re){Re.push(Pi(Se[0])),Re.push(rr(Se[1])),Re.push(0)}function _i(Se,Re,Fe,et){for(var it,wt,$e=0,ve=0;ve<Se.length;ve++){var Le=Pi(Se[ve][0]),ot=rr(Se[ve][1]);Re.push(Le),Re.push(ot),Re.push(0),ve>0&&($e+=et?(it*ot-Le*wt)/2:Math.sqrt(Math.pow(Le-it,2)+Math.pow(ot-wt,2))),it=Le,wt=ot}var Mt=Re.length-3;Re[2]=1,function Ot(bt,Rt,ar,qt){for(var Nt,Rr=qt,er=ar-Rt>>1,Nr=ar-Rt,Ln=bt[Rt],$r=bt[Rt+1],si=bt[ar],Yi=bt[ar+1],xn=Rt+3;xn<ar;xn+=3){var $i=Zr(bt[xn],bt[xn+1],Ln,$r,si,Yi);if($i>Rr)Nt=xn,Rr=$i;else if($i===Rr){var di=Math.abs(xn-er);di<Nr&&(Nt=xn,Nr=di)}}Rr>qt&&(Nt-Rt>3&&Ot(bt,Rt,Nt,qt),bt[Nt+2]=Rr,ar-Nt>3&&Ot(bt,Nt,ar,qt))}(Re,0,Mt,Fe),Re[Mt+2]=1,Re.size=Math.abs($e),Re.start=0,Re.end=Re.size}function zi(Se,Re,Fe,et){for(var it=0;it<Se.length;it++){var wt=[];_i(Se[it],wt,Fe,et),Re.push(wt)}}function Pi(Se){return Se/360+.5}function rr(Se){var Re=Math.sin(Se*Math.PI/180),Fe=.5-.25*Math.log((1+Re)/(1-Re))/Math.PI;return Fe<0?0:Fe>1?1:Fe}function Me(Se,Re,Fe,et,it,wt,$e,ve){if(et/=Re,wt>=(Fe/=Re)&&$e<et)return Se;if($e<Fe||wt>=et)return null;for(var Le=[],ot=0;ot<Se.length;ot++){var Mt=Se[ot],Ot=Mt.geometry,bt=Mt.type,Rt=it===0?Mt.minX:Mt.minY,ar=it===0?Mt.maxX:Mt.maxY;if(Rt>=Fe&&ar<et)Le.push(Mt);else if(!(ar<Fe||Rt>=et)){var qt=[];if(bt==="Point"||bt==="MultiPoint")qe(Ot,qt,Fe,et,it);else if(bt==="LineString")at(Ot,qt,Fe,et,it,!1,ve.lineMetrics);else if(bt==="MultiLineString")cr(Ot,qt,Fe,et,it,!1);else if(bt==="Polygon")cr(Ot,qt,Fe,et,it,!0);else if(bt==="MultiPolygon")for(var Nt=0;Nt<Ot.length;Nt++){var Rr=[];cr(Ot[Nt],Rr,Fe,et,it,!0),Rr.length&&qt.push(Rr)}if(qt.length){if(ve.lineMetrics&&bt==="LineString"){for(Nt=0;Nt<qt.length;Nt++)Le.push(qr(Mt.id,bt,qt[Nt],Mt.tags));continue}bt!=="LineString"&&bt!=="MultiLineString"||(qt.length===1?(bt="LineString",qt=qt[0]):bt="MultiLineString"),bt!=="Point"&&bt!=="MultiPoint"||(bt=qt.length===3?"Point":"MultiPoint"),Le.push(qr(Mt.id,bt,qt,Mt.tags))}}}return Le.length?Le:null}function qe(Se,Re,Fe,et,it){for(var wt=0;wt<Se.length;wt+=3){var $e=Se[wt+it];$e>=Fe&&$e<=et&&(Re.push(Se[wt]),Re.push(Se[wt+1]),Re.push(Se[wt+2]))}}function at(Se,Re,Fe,et,it,wt,$e){for(var ve,Le,ot=$t(Se),Mt=it===0?en:ur,Ot=Se.start,bt=0;bt<Se.length-3;bt+=3){var Rt=Se[bt],ar=Se[bt+1],qt=Se[bt+2],Nt=Se[bt+3],Rr=Se[bt+4],er=it===0?Rt:ar,Nr=it===0?Nt:Rr,Ln=!1;$e&&(ve=Math.sqrt(Math.pow(Rt-Nt,2)+Math.pow(ar-Rr,2))),er<Fe?Nr>Fe&&(Le=Mt(ot,Rt,ar,Nt,Rr,Fe),$e&&(ot.start=Ot+ve*Le)):er>et?Nr<et&&(Le=Mt(ot,Rt,ar,Nt,Rr,et),$e&&(ot.start=Ot+ve*Le)):br(ot,Rt,ar,qt),Nr<Fe&&er>=Fe&&(Le=Mt(ot,Rt,ar,Nt,Rr,Fe),Ln=!0),Nr>et&&er<=et&&(Le=Mt(ot,Rt,ar,Nt,Rr,et),Ln=!0),!wt&&Ln&&($e&&(ot.end=Ot+ve*Le),Re.push(ot),ot=$t(Se)),$e&&(Ot+=ve)}var $r=Se.length-3;Rt=Se[$r],ar=Se[$r+1],qt=Se[$r+2],(er=it===0?Rt:ar)>=Fe&&er<=et&&br(ot,Rt,ar,qt),$r=ot.length-3,wt&&$r>=3&&(ot[$r]!==ot[0]||ot[$r+1]!==ot[1])&&br(ot,ot[0],ot[1],ot[2]),ot.length&&Re.push(ot)}function $t(Se){var Re=[];return Re.size=Se.size,Re.start=Se.start,Re.end=Se.end,Re}function cr(Se,Re,Fe,et,it,wt){for(var $e=0;$e<Se.length;$e++)at(Se[$e],Re,Fe,et,it,wt,!1)}function br(Se,Re,Fe,et){Se.push(Re),Se.push(Fe),Se.push(et)}function en(Se,Re,Fe,et,it,wt){var $e=(wt-Re)/(et-Re);return Se.push(wt),Se.push(Fe+(it-Fe)*$e),Se.push(1),$e}function ur(Se,Re,Fe,et,it,wt){var $e=(wt-Fe)/(it-Fe);return Se.push(Re+(et-Re)*$e),Se.push(wt),Se.push(1),$e}function Kr(Se,Re){for(var Fe=[],et=0;et<Se.length;et++){var it,wt=Se[et],$e=wt.type;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")it=Vr(wt.geometry,Re);else if($e==="MultiLineString"||$e==="Polygon"){it=[];for(var ve=0;ve<wt.geometry.length;ve++)it.push(Vr(wt.geometry[ve],Re))}else if($e==="MultiPolygon")for(it=[],ve=0;ve<wt.geometry.length;ve++){for(var Le=[],ot=0;ot<wt.geometry[ve].length;ot++)Le.push(Vr(wt.geometry[ve][ot],Re));it.push(Le)}Fe.push(qr(wt.id,$e,it,wt.tags))}return Fe}function Vr(Se,Re){var Fe=[];Fe.size=Se.size,Se.start!==void 0&&(Fe.start=Se.start,Fe.end=Se.end);for(var et=0;et<Se.length;et+=3)Fe.push(Se[et]+Re,Se[et+1],Se[et+2]);return Fe}function cn(Se,Re){if(Se.transformed)return Se;var Fe,et,it,wt=1<<Se.z,$e=Se.x,ve=Se.y;for(Fe=0;Fe<Se.features.length;Fe++){var Le=Se.features[Fe],ot=Le.geometry,Mt=Le.type;if(Le.geometry=[],Mt===1)for(et=0;et<ot.length;et+=2)Le.geometry.push(Xn(ot[et],ot[et+1],Re,wt,$e,ve));else for(et=0;et<ot.length;et++){var Ot=[];for(it=0;it<ot[et].length;it+=2)Ot.push(Xn(ot[et][it],ot[et][it+1],Re,wt,$e,ve));Le.geometry.push(Ot)}}return Se.transformed=!0,Se}function Xn(Se,Re,Fe,et,it,wt){return[Math.round(Fe*(Se*et-it)),Math.round(Fe*(Re*et-wt))]}function Mr(Se,Re,Fe,et,it){for(var wt=Re===it.maxZoom?0:it.tolerance/((1<<Re)*it.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Fe,y:et,z:Re,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ve=0;ve<Se.length;ve++){$e.numFeatures++,Fr($e,Se[ve],wt,it);var Le=Se[ve].minX,ot=Se[ve].minY,Mt=Se[ve].maxX,Ot=Se[ve].maxY;Le<$e.minX&&($e.minX=Le),ot<$e.minY&&($e.minY=ot),Mt>$e.maxX&&($e.maxX=Mt),Ot>$e.maxY&&($e.maxY=Ot)}return $e}function Fr(Se,Re,Fe,et){var it=Re.geometry,wt=Re.type,$e=[];if(wt==="Point"||wt==="MultiPoint")for(var ve=0;ve<it.length;ve+=3)$e.push(it[ve]),$e.push(it[ve+1]),Se.numPoints++,Se.numSimplified++;else if(wt==="LineString")ri($e,it,Se,Fe,!1,!1);else if(wt==="MultiLineString"||wt==="Polygon")for(ve=0;ve<it.length;ve++)ri($e,it[ve],Se,Fe,wt==="Polygon",ve===0);else if(wt==="MultiPolygon")for(var Le=0;Le<it.length;Le++){var ot=it[Le];for(ve=0;ve<ot.length;ve++)ri($e,ot[ve],Se,Fe,!0,ve===0)}if($e.length){var Mt=Re.tags||null;if(wt==="LineString"&&et.lineMetrics){for(var Ot in Mt={},Re.tags)Mt[Ot]=Re.tags[Ot];Mt.mapbox_clip_start=it.start/it.size,Mt.mapbox_clip_end=it.end/it.size}var bt={geometry:$e,type:wt==="Polygon"||wt==="MultiPolygon"?3:wt==="LineString"||wt==="MultiLineString"?2:1,tags:Mt};Re.id!==null&&(bt.id=Re.id),Se.features.push(bt)}}function ri(Se,Re,Fe,et,it,wt){var $e=et*et;if(et>0&&Re.size<(it?$e:et))Fe.numPoints+=Re.length/3;else{for(var ve=[],Le=0;Le<Re.length;Le+=3)(et===0||Re[Le+2]>$e)&&(Fe.numSimplified++,ve.push(Re[Le]),ve.push(Re[Le+1])),Fe.numPoints++;it&&function(ot,Mt){for(var Ot=0,bt=0,Rt=ot.length,ar=Rt-2;bt<Rt;ar=bt,bt+=2)Ot+=(ot[bt]-ot[ar])*(ot[bt+1]+ot[ar+1]);if(Ot>0===Mt)for(bt=0,Rt=ot.length;bt<Rt/2;bt+=2){var qt=ot[bt],Nt=ot[bt+1];ot[bt]=ot[Rt-2-bt],ot[bt+1]=ot[Rt-1-bt],ot[Rt-2-bt]=qt,ot[Rt-1-bt]=Nt}}(ve,wt),Se.push(ve)}}function mi(Se,Re){var Fe=(Re=this.options=function(it,wt){for(var $e in wt)it[$e]=wt[$e];return it}(Object.create(this.options),Re)).debug;if(Fe&&console.time("preprocess data"),Re.maxZoom<0||Re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Re.promoteId&&Re.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(it,wt){var $e=[];if(it.type==="FeatureCollection")for(var ve=0;ve<it.features.length;ve++)qn($e,it.features[ve],wt,ve);else qn($e,it.type==="Feature"?it:{geometry:it},wt);return $e}(Se,Re);this.tiles={},this.tileCoords=[],Fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Re.indexMaxZoom,Re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(et=function(it,wt){var $e=wt.buffer/wt.extent,ve=it,Le=Me(it,1,-1-$e,$e,0,-1,2,wt),ot=Me(it,1,1-$e,2+$e,0,-1,2,wt);return(Le||ot)&&(ve=Me(it,1,-$e,1+$e,0,-1,2,wt)||[],Le&&(ve=Kr(Le,1).concat(ve)),ot&&(ve=ve.concat(Kr(ot,-1)))),ve}(et,Re)).length&&this.splitTile(et,0,0,0),Fe&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gi(Se,Re,Fe){return 32*((1<<Se)*Fe+Re)+Se}function Xi(Se,Re){var Fe=Se.tileID.canonical;if(!this._geoJSONIndex)return Re(null,null);var et=this._geoJSONIndex.getTile(Fe.z,Fe.x,Fe.y);if(!et)return Re(null,null);var it=new Ne(et.features),wt=yt(it);wt.byteOffset===0&&wt.byteLength===wt.buffer.byteLength||(wt=new Uint8Array(wt)),Re(null,{vectorTile:it,rawData:wt.buffer})}fn.prototype.load=function(Se){var Re=this.options,Fe=Re.log,et=Re.minZoom,it=Re.maxZoom,wt=Re.nodeSize;Fe&&console.time("total time");var $e="prepare "+Se.length+" points";Fe&&console.time($e),this.points=Se;for(var ve=[],Le=0;Le<Se.length;Le++)Se[Le].geometry&&ve.push(Pt(Se[Le],Le));this.trees[it+1]=new Vn(ve,gn,fr,wt,Float32Array),Fe&&console.timeEnd($e);for(var ot=it;ot>=et;ot--){var Mt=+Date.now();ve=this._cluster(ve,ot),this.trees[ot]=new Vn(ve,gn,fr,wt,Float32Array),Fe&&console.log("z%d: %d clusters in %dms",ot,ve.length,+Date.now()-Mt)}return Fe&&console.timeEnd("total time"),this},fn.prototype.getClusters=function(Se,Re){var Fe=((Se[0]+180)%360+360)%360-180,et=Math.max(-90,Math.min(90,Se[1])),it=Se[2]===180?180:((Se[2]+180)%360+360)%360-180,wt=Math.max(-90,Math.min(90,Se[3]));if(Se[2]-Se[0]>=360)Fe=-180,it=180;else if(Fe>it){var $e=this.getClusters([Fe,et,180,wt],Re),ve=this.getClusters([-180,et,it,wt],Re);return $e.concat(ve)}for(var Le=this.trees[this._limitZoom(Re)],ot=[],Mt=0,Ot=Le.range(xr(Fe),Kt(wt),xr(it),Kt(et));Mt<Ot.length;Mt+=1){var bt=Le.points[Ot[Mt]];ot.push(bt.numPoints?Dt(bt):this.points[bt.index])}return ot},fn.prototype.getChildren=function(Se){var Re=this._getOriginId(Se),Fe=this._getOriginZoom(Se),et="No cluster with the specified id.",it=this.trees[Fe];if(!it)throw new Error(et);var wt=it.points[Re];if(!wt)throw new Error(et);for(var $e=this.options.radius/(this.options.extent*Math.pow(2,Fe-1)),ve=[],Le=0,ot=it.within(wt.x,wt.y,$e);Le<ot.length;Le+=1){var Mt=it.points[ot[Le]];Mt.parentId===Se&&ve.push(Mt.numPoints?Dt(Mt):this.points[Mt.index])}if(ve.length===0)throw new Error(et);return ve},fn.prototype.getLeaves=function(Se,Re,Fe){var et=[];return this._appendLeaves(et,Se,Re=Re||10,Fe=Fe||0,0),et},fn.prototype.getTile=function(Se,Re,Fe){var et=this.trees[this._limitZoom(Se)],it=Math.pow(2,Se),wt=this.options,$e=wt.radius/wt.extent,ve=(Fe-$e)/it,Le=(Fe+1+$e)/it,ot={features:[]};return this._addTileFeatures(et.range((Re-$e)/it,ve,(Re+1+$e)/it,Le),et.points,Re,Fe,it,ot),Re===0&&this._addTileFeatures(et.range(1-$e/it,ve,1,Le),et.points,it,Fe,it,ot),Re===it-1&&this._addTileFeatures(et.range(0,ve,$e/it,Le),et.points,-1,Fe,it,ot),ot.features.length?ot:null},fn.prototype.getClusterExpansionZoom=function(Se){for(var Re=this._getOriginZoom(Se)-1;Re<=this.options.maxZoom;){var Fe=this.getChildren(Se);if(Re++,Fe.length!==1)break;Se=Fe[0].properties.cluster_id}return Re},fn.prototype._appendLeaves=function(Se,Re,Fe,et,it){for(var wt=0,$e=this.getChildren(Re);wt<$e.length;wt+=1){var ve=$e[wt],Le=ve.properties;if(Le&&Le.cluster?it+Le.point_count<=et?it+=Le.point_count:it=this._appendLeaves(Se,Le.cluster_id,Fe,et,it):it<et?it++:Se.push(ve),Se.length===Fe)break}return it},fn.prototype._addTileFeatures=function(Se,Re,Fe,et,it,wt){for(var $e=0,ve=Se;$e<ve.length;$e+=1){var Le=Re[ve[$e]],ot=Le.numPoints,Mt={type:1,geometry:[[Math.round(this.options.extent*(Le.x*it-Fe)),Math.round(this.options.extent*(Le.y*it-et))]],tags:ot?Ir(Le):this.points[Le.index].properties},Ot=void 0;ot?Ot=Le.id:this.options.generateId?Ot=Le.index:this.points[Le.index].id&&(Ot=this.points[Le.index].id),Ot!==void 0&&(Mt.id=Ot),wt.features.push(Mt)}},fn.prototype._limitZoom=function(Se){return Math.max(this.options.minZoom,Math.min(+Se,this.options.maxZoom+1))},fn.prototype._cluster=function(Se,Re){for(var Fe=[],et=this.options,it=et.reduce,wt=et.minPoints,$e=et.radius/(et.extent*Math.pow(2,Re)),ve=0;ve<Se.length;ve++){var Le=Se[ve];if(!(Le.zoom<=Re)){Le.zoom=Re;for(var ot=this.trees[Re+1],Mt=ot.within(Le.x,Le.y,$e),Ot=Le.numPoints||1,bt=Ot,Rt=0,ar=Mt;Rt<ar.length;Rt+=1){var qt=ot.points[ar[Rt]];qt.zoom>Re&&(bt+=qt.numPoints||1)}if(bt>=wt){for(var Nt=Le.x*Ot,Rr=Le.y*Ot,er=it&&Ot>1?this._map(Le,!0):null,Nr=(ve<<5)+(Re+1)+this.points.length,Ln=0,$r=Mt;Ln<$r.length;Ln+=1){var si=ot.points[$r[Ln]];if(!(si.zoom<=Re)){si.zoom=Re;var Yi=si.numPoints||1;Nt+=si.x*Yi,Rr+=si.y*Yi,si.parentId=Nr,it&&(er||(er=this._map(Le,!0)),it(er,this._map(si)))}}Le.parentId=Nr,Fe.push(Nn(Nt/bt,Rr/bt,Nr,bt,er))}else if(Fe.push(Le),bt>1)for(var xn=0,$i=Mt;xn<$i.length;xn+=1){var di=ot.points[$i[xn]];di.zoom<=Re||(di.zoom=Re,Fe.push(di))}}}return Fe},fn.prototype._getOriginId=function(Se){return Se-this.points.length>>5},fn.prototype._getOriginZoom=function(Se){return(Se-this.points.length)%32},fn.prototype._map=function(Se,Re){if(Se.numPoints)return Re?Cn({},Se.properties):Se.properties;var Fe=this.points[Se.index].properties,et=this.options.map(Fe);return Re&&et===Fe?Cn({},et):et},mi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},mi.prototype.splitTile=function(Se,Re,Fe,et,it,wt,$e){for(var ve=[Se,Re,Fe,et],Le=this.options,ot=Le.debug;ve.length;){et=ve.pop(),Fe=ve.pop(),Re=ve.pop(),Se=ve.pop();var Mt=1<<Re,Ot=gi(Re,Fe,et),bt=this.tiles[Ot];if(!bt&&(ot>1&&console.time("creation"),bt=this.tiles[Ot]=Mr(Se,Re,Fe,et,Le),this.tileCoords.push({z:Re,x:Fe,y:et}),ot)){ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Re,Fe,et,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));var Rt="z"+Re;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(bt.source=Se,it){if(Re===Le.maxZoom||Re===it)continue;var ar=1<<it-Re;if(Fe!==Math.floor(wt/ar)||et!==Math.floor($e/ar))continue}else if(Re===Le.indexMaxZoom||bt.numPoints<=Le.indexMaxPoints)continue;if(bt.source=null,Se.length!==0){ot>1&&console.time("clipping");var qt,Nt,Rr,er,Nr,Ln,$r=.5*Le.buffer/Le.extent,si=.5-$r,Yi=.5+$r,xn=1+$r;qt=Nt=Rr=er=null,Nr=Me(Se,Mt,Fe-$r,Fe+Yi,0,bt.minX,bt.maxX,Le),Ln=Me(Se,Mt,Fe+si,Fe+xn,0,bt.minX,bt.maxX,Le),Se=null,Nr&&(qt=Me(Nr,Mt,et-$r,et+Yi,1,bt.minY,bt.maxY,Le),Nt=Me(Nr,Mt,et+si,et+xn,1,bt.minY,bt.maxY,Le),Nr=null),Ln&&(Rr=Me(Ln,Mt,et-$r,et+Yi,1,bt.minY,bt.maxY,Le),er=Me(Ln,Mt,et+si,et+xn,1,bt.minY,bt.maxY,Le),Ln=null),ot>1&&console.timeEnd("clipping"),ve.push(qt||[],Re+1,2*Fe,2*et),ve.push(Nt||[],Re+1,2*Fe,2*et+1),ve.push(Rr||[],Re+1,2*Fe+1,2*et),ve.push(er||[],Re+1,2*Fe+1,2*et+1)}}},mi.prototype.getTile=function(Se,Re,Fe){var et=this.options,it=et.extent,wt=et.debug;if(Se<0||Se>24)return null;var $e=1<<Se,ve=gi(Se,Re=(Re%$e+$e)%$e,Fe);if(this.tiles[ve])return cn(this.tiles[ve],it);wt>1&&console.log("drilling down to z%d-%d-%d",Se,Re,Fe);for(var Le,ot=Se,Mt=Re,Ot=Fe;!Le&&ot>0;)ot--,Mt=Math.floor(Mt/2),Ot=Math.floor(Ot/2),Le=this.tiles[gi(ot,Mt,Ot)];return Le&&Le.source?(wt>1&&console.log("found parent tile z%d-%d-%d",ot,Mt,Ot),wt>1&&console.time("drilling down"),this.splitTile(Le.source,ot,Mt,Ot,Se,Re,Fe),wt>1&&console.timeEnd("drilling down"),this.tiles[ve]?cn(this.tiles[ve],it):null):null};var mo=function(Se){function Re(Fe,et,it,wt){Se.call(this,Fe,et,it,Xi),wt&&(this.loadGeoJSON=wt)}return Se&&(Re.__proto__=Se),(Re.prototype=Object.create(Se&&Se.prototype)).constructor=Re,Re.prototype.loadData=function(Fe,et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=et,this._pendingLoadDataParams=Fe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Re.prototype._loadData=function(){var Fe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var et=this._pendingCallback,it=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var wt=!!(it&&it.request&&it.request.collectResourceTiming)&&new p.RequestPerformance(it.request);this.loadGeoJSON(it,function($e,ve){if($e||!ve)return et($e);if(typeof ve!="object")return et(new Error("Input data given to '"+it.source+"' is not a valid GeoJSON object."));(function bt(Rt,ar){var qt,Nt=Rt&&Rt.type;if(Nt==="FeatureCollection")for(qt=0;qt<Rt.features.length;qt++)bt(Rt.features[qt],ar);else if(Nt==="GeometryCollection")for(qt=0;qt<Rt.geometries.length;qt++)bt(Rt.geometries[qt],ar);else if(Nt==="Feature")bt(Rt.geometry,ar);else if(Nt==="Polygon")ue(Rt.coordinates,ar);else if(Nt==="MultiPolygon")for(qt=0;qt<Rt.coordinates.length;qt++)ue(Rt.coordinates[qt],ar);return Rt})(ve,!0);try{if(it.filter){var Le=p.createExpression(it.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Le.result==="error")throw new Error(Le.value.map(function(bt){return bt.key+": "+bt.message}).join(", "));var ot=ve.features.filter(function(bt){return Le.value.evaluate({zoom:0},bt)});ve={type:"FeatureCollection",features:ot}}Fe._geoJSONIndex=it.cluster?new fn(function(bt){var Rt=bt.superclusterOptions,ar=bt.clusterProperties;if(!ar||!Rt)return Rt;for(var qt={},Nt={},Rr={accumulated:null,zoom:0},er={properties:null},Nr=Object.keys(ar),Ln=0,$r=Nr;Ln<$r.length;Ln+=1){var si=$r[Ln],Yi=ar[si],xn=Yi[0],$i=p.createExpression(Yi[1]),di=p.createExpression(typeof xn=="string"?[xn,["accumulated"],["get",si]]:xn);qt[si]=$i.value,Nt[si]=di.value}return Rt.map=function(vo){er.properties=vo;for(var to={},xo=0,so=Nr;xo<so.length;xo+=1){var Ni=so[xo];to[Ni]=qt[Ni].evaluate(Rr,er)}return to},Rt.reduce=function(vo,to){er.properties=to;for(var xo=0,so=Nr;xo<so.length;xo+=1){var Ni=so[xo];Rr.accumulated=vo[Ni],vo[Ni]=Nt[Ni].evaluate(Rr,er)}},Rt}(it)).load(ve.features):function(bt,Rt){return new mi(bt,Rt)}(ve,it.geojsonVtOptions)}catch(bt){return et(bt)}Fe.loaded={};var Mt={};if(wt){var Ot=wt.finish();Ot&&(Mt.resourceTiming={},Mt.resourceTiming[it.source]=JSON.parse(JSON.stringify(Ot)))}et(null,Mt)})}},Re.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Re.prototype.reloadTile=function(Fe,et){var it=this.loaded;return it&&it[Fe.uid]?Se.prototype.reloadTile.call(this,Fe,et):this.loadTile(Fe,et)},Re.prototype.loadGeoJSON=function(Fe,et){if(Fe.request)p.getJSON(Fe.request,et);else{if(typeof Fe.data!="string")return et(new Error("Input data given to '"+Fe.source+"' is not a valid GeoJSON object."));try{return et(null,JSON.parse(Fe.data))}catch{return et(new Error("Input data given to '"+Fe.source+"' is not a valid GeoJSON object."))}}},Re.prototype.removeSource=function(Fe,et){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),et()},Re.prototype.getClusterExpansionZoom=function(Fe,et){try{et(null,this._geoJSONIndex.getClusterExpansionZoom(Fe.clusterId))}catch(it){et(it)}},Re.prototype.getClusterChildren=function(Fe,et){try{et(null,this._geoJSONIndex.getChildren(Fe.clusterId))}catch(it){et(it)}},Re.prototype.getClusterLeaves=function(Fe,et){try{et(null,this._geoJSONIndex.getLeaves(Fe.clusterId,Fe.limit,Fe.offset))}catch(it){et(it)}},Re}(ie),eo=function(Se){var Re=this;this.self=Se,this.actor=new p.Actor(Se,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ie,geojson:mo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Fe,et){if(Re.workerSourceTypes[Fe])throw new Error('Worker source with name "'+Fe+'" already registered.');Re.workerSourceTypes[Fe]=et},this.self.registerRTLTextPlugin=function(Fe){if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=Fe.applyArabicShaping,p.plugin.processBidirectionalText=Fe.processBidirectionalText,p.plugin.processStyledBidirectionalText=Fe.processStyledBidirectionalText}};return eo.prototype.setReferrer=function(Se,Re){this.referrer=Re},eo.prototype.setImages=function(Se,Re,Fe){for(var et in this.availableImages[Se]=Re,this.workerSources[Se]){var it=this.workerSources[Se][et];for(var wt in it)it[wt].availableImages=Re}Fe()},eo.prototype.setLayers=function(Se,Re,Fe){this.getLayerIndex(Se).replace(Re),Fe()},eo.prototype.updateLayers=function(Se,Re,Fe){this.getLayerIndex(Se).update(Re.layers,Re.removedIds),Fe()},eo.prototype.loadTile=function(Se,Re,Fe){this.getWorkerSource(Se,Re.type,Re.source).loadTile(Re,Fe)},eo.prototype.loadDEMTile=function(Se,Re,Fe){this.getDEMWorkerSource(Se,Re.source).loadTile(Re,Fe)},eo.prototype.reloadTile=function(Se,Re,Fe){this.getWorkerSource(Se,Re.type,Re.source).reloadTile(Re,Fe)},eo.prototype.abortTile=function(Se,Re,Fe){this.getWorkerSource(Se,Re.type,Re.source).abortTile(Re,Fe)},eo.prototype.removeTile=function(Se,Re,Fe){this.getWorkerSource(Se,Re.type,Re.source).removeTile(Re,Fe)},eo.prototype.removeDEMTile=function(Se,Re){this.getDEMWorkerSource(Se,Re.source).removeTile(Re)},eo.prototype.removeSource=function(Se,Re,Fe){if(this.workerSources[Se]&&this.workerSources[Se][Re.type]&&this.workerSources[Se][Re.type][Re.source]){var et=this.workerSources[Se][Re.type][Re.source];delete this.workerSources[Se][Re.type][Re.source],et.removeSource!==void 0?et.removeSource(Re,Fe):Fe()}},eo.prototype.loadWorkerSource=function(Se,Re,Fe){try{this.self.importScripts(Re.url),Fe()}catch(et){Fe(et.toString())}},eo.prototype.syncRTLPluginState=function(Se,Re,Fe){try{p.plugin.setState(Re);var et=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&et!=null){this.self.importScripts(et);var it=p.plugin.isParsed();Fe(it?void 0:new Error("RTL Text Plugin failed to import scripts from "+et),it)}}catch(wt){Fe(wt.toString())}},eo.prototype.getAvailableImages=function(Se){var Re=this.availableImages[Se];return Re||(Re=[]),Re},eo.prototype.getLayerIndex=function(Se){var Re=this.layerIndexes[Se];return Re||(Re=this.layerIndexes[Se]=new F),Re},eo.prototype.getWorkerSource=function(Se,Re,Fe){var et=this;return this.workerSources[Se]||(this.workerSources[Se]={}),this.workerSources[Se][Re]||(this.workerSources[Se][Re]={}),this.workerSources[Se][Re][Fe]||(this.workerSources[Se][Re][Fe]=new this.workerSourceTypes[Re]({send:function(it,wt,$e){et.actor.send(it,wt,$e,Se)}},this.getLayerIndex(Se),this.getAvailableImages(Se))),this.workerSources[Se][Re][Fe]},eo.prototype.getDEMWorkerSource=function(Se,Re){return this.demWorkerSources[Se]||(this.demWorkerSources[Se]={}),this.demWorkerSources[Se][Re]||(this.demWorkerSources[Se][Re]=new Te),this.demWorkerSources[Se][Re]},eo.prototype.enforceCacheSizeLimit=function(Se,Re){p.enforceCacheSizeLimit(Re)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new eo(self)),eo}),w(["./shared"],function(p){var s=p.createCommonjsModule(function(S){function E(B){return!T(B)}function T(B){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Y,re,ye=new Blob([""],{type:"text/javascript"}),Ae=URL.createObjectURL(ye);try{re=new Worker(Ae),Y=!0}catch{Y=!1}return re&&re.terminate(),URL.revokeObjectURL(Ae),Y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var Y=document.createElement("canvas");Y.width=Y.height=1;var re=Y.getContext("2d");if(!re)return!1;var ye=re.getImageData(0,0,1,1);return ye&&ye.width===Y.width}()?(M[W=B&&B.failIfMajorPerformanceCaveat]===void 0&&(M[W]=function(Y){var re=function(Ae){var Ze=document.createElement("canvas"),Je=Object.create(E.webGLContextAttributes);return Je.failIfMajorPerformanceCaveat=Ae,Ze.probablySupportsContext?Ze.probablySupportsContext("webgl",Je)||Ze.probablySupportsContext("experimental-webgl",Je):Ze.supportsContext?Ze.supportsContext("webgl",Je)||Ze.supportsContext("experimental-webgl",Je):Ze.getContext("webgl",Je)||Ze.getContext("experimental-webgl",Je)}(Y);if(!re)return!1;var ye=re.createShader(re.VERTEX_SHADER);return!(!ye||re.isContextLost())&&(re.shaderSource(ye,"void main() {}"),re.compileShader(ye),re.getShaderParameter(ye,re.COMPILE_STATUS)===!0)}(W)),M[W]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var W}S.exports?S.exports=E:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=E,window.mapboxgl.notSupportedReason=T);var M={};E.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),L={create:function(S,E,T){var M=p.window.document.createElement(S);return E!==void 0&&(M.className=E),T&&T.appendChild(M),M},createNS:function(S,E){return p.window.document.createElementNS(S,E)}},F=p.window.document&&p.window.document.documentElement.style;function G(S){if(!F)return S[0];for(var E=0;E<S.length;E++)if(S[E]in F)return S[E];return S[0]}var H,X=G(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);L.disableDrag=function(){F&&X&&(H=F[X],F[X]="none")},L.enableDrag=function(){F&&X&&(F[X]=H)};var ne=G(["transform","WebkitTransform"]);L.setTransform=function(S,E){S.style[ne]=E};var ie=!1;try{var se=Object.defineProperty({},"passive",{get:function(){ie=!0}});p.window.addEventListener("test",se,se),p.window.removeEventListener("test",se,se)}catch{ie=!1}L.addEventListener=function(S,E,T,M){M===void 0&&(M={}),S.addEventListener(E,T,"passive"in M&&ie?M:M.capture)},L.removeEventListener=function(S,E,T,M){M===void 0&&(M={}),S.removeEventListener(E,T,"passive"in M&&ie?M:M.capture)};var Te=function(S){S.preventDefault(),S.stopPropagation(),p.window.removeEventListener("click",Te,!0)};function ue(S){var E=S.userImage;return!!(E&&E.render&&E.render())&&(S.data.replace(new Uint8Array(E.data.buffer)),!0)}L.suppressClick=function(){p.window.addEventListener("click",Te,!0),p.window.setTimeout(function(){p.window.removeEventListener("click",Te,!0)},0)},L.mousePos=function(S,E){var T=S.getBoundingClientRect();return new p.Point(E.clientX-T.left-S.clientLeft,E.clientY-T.top-S.clientTop)},L.touchPos=function(S,E){for(var T=S.getBoundingClientRect(),M=[],B=0;B<E.length;B++)M.push(new p.Point(E[B].clientX-T.left-S.clientLeft,E[B].clientY-T.top-S.clientTop));return M},L.mouseButton=function(S){return p.window.InstallTrigger!==void 0&&S.button===2&&S.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:S.button},L.remove=function(S){S.parentNode&&S.parentNode.removeChild(S)};var ce=function(S){function E(){S.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.isLoaded=function(){return this.loaded},E.prototype.setLoaded=function(T){if(this.loaded!==T&&(this.loaded=T,T)){for(var M=0,B=this.requestors;M<B.length;M+=1){var W=B[M];this._notify(W.ids,W.callback)}this.requestors=[]}},E.prototype.getImage=function(T){return this.images[T]},E.prototype.addImage=function(T,M){this._validate(T,M)&&(this.images[T]=M)},E.prototype._validate=function(T,M){var B=!0;return this._validateStretch(M.stretchX,M.data&&M.data.width)||(this.fire(new p.ErrorEvent(new Error('Image "'+T+'" has invalid "stretchX" value'))),B=!1),this._validateStretch(M.stretchY,M.data&&M.data.height)||(this.fire(new p.ErrorEvent(new Error('Image "'+T+'" has invalid "stretchY" value'))),B=!1),this._validateContent(M.content,M)||(this.fire(new p.ErrorEvent(new Error('Image "'+T+'" has invalid "content" value'))),B=!1),B},E.prototype._validateStretch=function(T,M){if(!T)return!0;for(var B=0,W=0,Y=T;W<Y.length;W+=1){var re=Y[W];if(re[0]<B||re[1]<re[0]||M<re[1])return!1;B=re[1]}return!0},E.prototype._validateContent=function(T,M){return!(T&&(T.length!==4||T[0]<0||M.data.width<T[0]||T[1]<0||M.data.height<T[1]||T[2]<0||M.data.width<T[2]||T[3]<0||M.data.height<T[3]||T[2]<T[0]||T[3]<T[1]))},E.prototype.updateImage=function(T,M){M.version=this.images[T].version+1,this.images[T]=M,this.updatedImages[T]=!0},E.prototype.removeImage=function(T){var M=this.images[T];delete this.images[T],delete this.patterns[T],M.userImage&&M.userImage.onRemove&&M.userImage.onRemove()},E.prototype.listImages=function(){return Object.keys(this.images)},E.prototype.getImages=function(T,M){var B=!0;if(!this.isLoaded())for(var W=0,Y=T;W<Y.length;W+=1)this.images[Y[W]]||(B=!1);this.isLoaded()||B?this._notify(T,M):this.requestors.push({ids:T,callback:M})},E.prototype._notify=function(T,M){for(var B={},W=0,Y=T;W<Y.length;W+=1){var re=Y[W];this.images[re]||this.fire(new p.Event("styleimagemissing",{id:re}));var ye=this.images[re];ye?B[re]={data:ye.data.clone(),pixelRatio:ye.pixelRatio,sdf:ye.sdf,version:ye.version,stretchX:ye.stretchX,stretchY:ye.stretchY,content:ye.content,hasRenderCallback:!!(ye.userImage&&ye.userImage.render)}:p.warnOnce('Image "'+re+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}M(null,B)},E.prototype.getPixelSize=function(){var T=this.atlasImage;return{width:T.width,height:T.height}},E.prototype.getPattern=function(T){var M=this.patterns[T],B=this.getImage(T);if(!B)return null;if(M&&M.position.version===B.version)return M.position;if(M)M.position.version=B.version;else{var W={w:B.data.width+2,h:B.data.height+2,x:0,y:0},Y=new p.ImagePosition(W,B);this.patterns[T]={bin:W,position:Y}}return this._updatePatternAtlas(),this.patterns[T].position},E.prototype.bind=function(T){var M=T.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(T,this.atlasImage,M.RGBA),this.atlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE)},E.prototype._updatePatternAtlas=function(){var T=[];for(var M in this.patterns)T.push(this.patterns[M].bin);var B=p.potpack(T),W=B.w,Y=B.h,re=this.atlasImage;for(var ye in re.resize({width:W||1,height:Y||1}),this.patterns){var Ae=this.patterns[ye].bin,Ze=Ae.x+1,Je=Ae.y+1,ke=this.images[ye].data,ut=ke.width,ht=ke.height;p.RGBAImage.copy(ke,re,{x:0,y:0},{x:Ze,y:Je},{width:ut,height:ht}),p.RGBAImage.copy(ke,re,{x:0,y:ht-1},{x:Ze,y:Je-1},{width:ut,height:1}),p.RGBAImage.copy(ke,re,{x:0,y:0},{x:Ze,y:Je+ht},{width:ut,height:1}),p.RGBAImage.copy(ke,re,{x:ut-1,y:0},{x:Ze-1,y:Je},{width:1,height:ht}),p.RGBAImage.copy(ke,re,{x:0,y:0},{x:Ze+ut,y:Je},{width:1,height:ht})}this.dirty=!0},E.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},E.prototype.dispatchRenderCallbacks=function(T){for(var M=0,B=T;M<B.length;M+=1){var W=B[M];if(!this.callbackDispatchedThisFrame[W]){this.callbackDispatchedThisFrame[W]=!0;var Y=this.images[W];ue(Y)&&this.updateImage(W,Y)}}},E}(p.Evented),de=rt,Ee=rt,Ne=1e20;function rt(S,E,T,M,B,W){this.fontSize=S||24,this.buffer=E===void 0?3:E,this.cutoff=M||.25,this.fontFamily=B||"sans-serif",this.fontWeight=W||"normal",this.radius=T||8;var Y=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function tt(S,E,T,M,B,W,Y){for(var re=0;re<E;re++){for(var ye=0;ye<T;ye++)M[ye]=S[ye*E+re];for(Ge(M,B,W,Y,T),ye=0;ye<T;ye++)S[ye*E+re]=B[ye]}for(ye=0;ye<T;ye++){for(re=0;re<E;re++)M[re]=S[ye*E+re];for(Ge(M,B,W,Y,E),re=0;re<E;re++)S[ye*E+re]=Math.sqrt(B[re])}}function Ge(S,E,T,M,B){T[0]=0,M[0]=-Ne,M[1]=+Ne;for(var W=1,Y=0;W<B;W++){for(var re=(S[W]+W*W-(S[T[Y]]+T[Y]*T[Y]))/(2*W-2*T[Y]);re<=M[Y];)Y--,re=(S[W]+W*W-(S[T[Y]]+T[Y]*T[Y]))/(2*W-2*T[Y]);T[++Y]=W,M[Y]=re,M[Y+1]=+Ne}for(W=0,Y=0;W<B;W++){for(;M[Y+1]<W;)Y++;E[W]=(W-T[Y])*(W-T[Y])+S[T[Y]]}}rt.prototype.draw=function(S){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(S,this.buffer,this.middle);for(var E=this.ctx.getImageData(0,0,this.size,this.size),T=new Uint8ClampedArray(this.size*this.size),M=0;M<this.size*this.size;M++){var B=E.data[4*M+3]/255;this.gridOuter[M]=B===1?0:B===0?Ne:Math.pow(Math.max(0,.5-B),2),this.gridInner[M]=B===1?Ne:B===0?0:Math.pow(Math.max(0,B-.5),2)}for(tt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),tt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),M=0;M<this.size*this.size;M++)T[M]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[M]-this.gridInner[M])/this.radius+this.cutoff))));return T},de.default=Ee;var _t=function(S,E){this.requestManager=S,this.localIdeographFontFamily=E,this.entries={}};_t.prototype.setURL=function(S){this.url=S},_t.prototype.getGlyphs=function(S,E){var T=this,M=[];for(var B in S)for(var W=0,Y=S[B];W<Y.length;W+=1)M.push({stack:B,id:Y[W]});p.asyncAll(M,function(re,ye){var Ae=re.stack,Ze=re.id,Je=T.entries[Ae];Je||(Je=T.entries[Ae]={glyphs:{},requests:{},ranges:{}});var ke=Je.glyphs[Ze];if(ke===void 0){if(ke=T._tinySDF(Je,Ae,Ze))return Je.glyphs[Ze]=ke,void ye(null,{stack:Ae,id:Ze,glyph:ke});var ut=Math.floor(Ze/256);if(256*ut>65535)ye(new Error("glyphs > 65535 not supported"));else if(Je.ranges[ut])ye(null,{stack:Ae,id:Ze,glyph:ke});else{var ht=Je.requests[ut];ht||(ht=Je.requests[ut]=[],_t.loadGlyphRange(Ae,ut,T.url,T.requestManager,function(Ct,lt){if(lt){for(var It in lt)T._doesCharSupportLocalGlyph(+It)||(Je.glyphs[+It]=lt[+It]);Je.ranges[ut]=!0}for(var Lt=0,Jt=ht;Lt<Jt.length;Lt+=1)(0,Jt[Lt])(Ct,lt);delete Je.requests[ut]})),ht.push(function(Ct,lt){Ct?ye(Ct):lt&&ye(null,{stack:Ae,id:Ze,glyph:lt[Ze]||null})})}}else ye(null,{stack:Ae,id:Ze,glyph:ke})},function(re,ye){if(re)E(re);else if(ye){for(var Ae={},Ze=0,Je=ye;Ze<Je.length;Ze+=1){var ke=Je[Ze],ut=ke.stack,ht=ke.id,Ct=ke.glyph;(Ae[ut]||(Ae[ut]={}))[ht]=Ct&&{id:Ct.id,bitmap:Ct.bitmap.clone(),metrics:Ct.metrics}}E(null,Ae)}})},_t.prototype._doesCharSupportLocalGlyph=function(S){return!!this.localIdeographFontFamily&&(p.isChar["CJK Unified Ideographs"](S)||p.isChar["Hangul Syllables"](S)||p.isChar.Hiragana(S)||p.isChar.Katakana(S))},_t.prototype._tinySDF=function(S,E,T){var M=this.localIdeographFontFamily;if(M&&this._doesCharSupportLocalGlyph(T)){var B=S.tinySDF;if(!B){var W="400";/bold/i.test(E)?W="900":/medium/i.test(E)?W="500":/light/i.test(E)&&(W="200"),B=S.tinySDF=new _t.TinySDF(24,3,8,.25,M,W)}return{id:T,bitmap:new p.AlphaImage({width:30,height:30},B.draw(String.fromCharCode(T))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_t.loadGlyphRange=function(S,E,T,M,B){var W=256*E,Y=W+255,re=M.transformRequest(M.normalizeGlyphsURL(T).replace("{fontstack}",S).replace("{range}",W+"-"+Y),p.ResourceType.Glyphs);p.getArrayBuffer(re,function(ye,Ae){if(ye)B(ye);else if(Ae){for(var Ze={},Je=0,ke=p.parseGlyphPBF(Ae);Je<ke.length;Je+=1){var ut=ke[Je];Ze[ut.id]=ut}B(null,Ze)}})},_t.TinySDF=de;var yt=function(){this.specification=p.styleSpec.light.position};yt.prototype.possiblyEvaluate=function(S,E){return p.sphericalToCartesian(S.expression.evaluate(E))},yt.prototype.interpolate=function(S,E,T){return{x:p.number(S.x,E.x,T),y:p.number(S.y,E.y,T),z:p.number(S.z,E.z,T)}};var Et=new p.Properties({anchor:new p.DataConstantProperty(p.styleSpec.light.anchor),position:new yt,color:new p.DataConstantProperty(p.styleSpec.light.color),intensity:new p.DataConstantProperty(p.styleSpec.light.intensity)}),Wt=function(S){function E(T){S.call(this),this._transitionable=new p.Transitionable(Et),this.setLight(T),this._transitioning=this._transitionable.untransitioned()}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getLight=function(){return this._transitionable.serialize()},E.prototype.setLight=function(T,M){if(M===void 0&&(M={}),!this._validate(p.validateLight,T,M))for(var B in T){var W=T[B];p.endsWith(B,"-transition")?this._transitionable.setTransition(B.slice(0,-11),W):this._transitionable.setValue(B,W)}},E.prototype.updateTransitions=function(T){this._transitioning=this._transitionable.transitioned(T,this._transitioning)},E.prototype.hasTransition=function(){return this._transitioning.hasTransition()},E.prototype.recalculate=function(T){this.properties=this._transitioning.possiblyEvaluate(T)},E.prototype._validate=function(T,M,B){return(!B||B.validate!==!1)&&p.emitValidationErrors(this,T.call(p.validateStyle,p.extend({value:M,style:{glyphs:!0,sprite:!0},styleSpec:p.styleSpec})))},E}(p.Evented),Ar=function(S,E){this.width=S,this.height=E,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ar.prototype.getDash=function(S,E){var T=S.join(",")+String(E);return this.dashEntry[T]||(this.dashEntry[T]=this.addDash(S,E)),this.dashEntry[T]},Ar.prototype.getDashRanges=function(S,E,T){var M=[],B=S.length%2==1?-S[S.length-1]*T:0,W=S[0]*T,Y=!0;M.push({left:B,right:W,isDash:Y,zeroLength:S[0]===0});for(var re=S[0],ye=1;ye<S.length;ye++){var Ae=S[ye];M.push({left:B=re*T,right:W=(re+=Ae)*T,isDash:Y=!Y,zeroLength:Ae===0})}return M},Ar.prototype.addRoundDash=function(S,E,T){for(var M=E/2,B=-T;B<=T;B++)for(var W=this.width*(this.nextRow+T+B),Y=0,re=S[Y],ye=0;ye<this.width;ye++){ye/re.right>1&&(re=S[++Y]);var Ae=Math.abs(ye-re.left),Ze=Math.abs(ye-re.right),Je=Math.min(Ae,Ze),ke=void 0,ut=B/T*(M+1);if(re.isDash){var ht=M-Math.abs(ut);ke=Math.sqrt(Je*Je+ht*ht)}else ke=M-Math.sqrt(Je*Je+ut*ut);this.data[W+ye]=Math.max(0,Math.min(255,ke+128))}},Ar.prototype.addRegularDash=function(S){for(var E=S.length-1;E>=0;--E){var T=S[E],M=S[E+1];T.zeroLength?S.splice(E,1):M&&M.isDash===T.isDash&&(M.left=T.left,S.splice(E,1))}var B=S[0],W=S[S.length-1];B.isDash===W.isDash&&(B.left=W.left-this.width,W.right=B.right+this.width);for(var Y=this.width*this.nextRow,re=0,ye=S[re],Ae=0;Ae<this.width;Ae++){Ae/ye.right>1&&(ye=S[++re]);var Ze=Math.abs(Ae-ye.left),Je=Math.abs(Ae-ye.right),ke=Math.min(Ze,Je);this.data[Y+Ae]=Math.max(0,Math.min(255,(ye.isDash?ke:-ke)+128))}},Ar.prototype.addDash=function(S,E){var T=E?7:0,M=2*T+1;if(this.nextRow+M>this.height)return p.warnOnce("LineAtlas out of space"),null;for(var B=0,W=0;W<S.length;W++)B+=S[W];if(B!==0){var Y=this.width/B,re=this.getDashRanges(S,this.width,Y);E?this.addRoundDash(re,Y,T):this.addRegularDash(re)}var ye={y:(this.nextRow+T+.5)/this.height,height:2*T/this.height,width:B};return this.nextRow+=M,this.dirty=!0,ye},Ar.prototype.bind=function(S){var E=S.gl;this.texture?(E.bindTexture(E.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,E.texSubImage2D(E.TEXTURE_2D,0,0,0,this.width,this.height,E.ALPHA,E.UNSIGNED_BYTE,this.data))):(this.texture=E.createTexture(),E.bindTexture(E.TEXTURE_2D,this.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.REPEAT),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_2D,0,E.ALPHA,this.width,this.height,0,E.ALPHA,E.UNSIGNED_BYTE,this.data))};var mt=function S(E,T){this.workerPool=E,this.actors=[],this.currentActor=0,this.id=p.uniqueId();for(var M=this.workerPool.acquire(this.id),B=0;B<M.length;B++){var W=new S.Actor(M[B],T,this.id);W.name="Worker "+B,this.actors.push(W)}};function nr(S,E,T){var M=function(B,W){if(B)return T(B);if(W){var Y=p.pick(p.extend(W,S),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);W.vector_layers&&(Y.vectorLayers=W.vector_layers,Y.vectorLayerIds=Y.vectorLayers.map(function(re){return re.id})),Y.tiles=E.canonicalizeTileset(Y,S.url),T(null,Y)}};return S.url?p.getJSON(E.transformRequest(E.normalizeSourceURL(S.url),p.ResourceType.Source),M):p.browser.frame(function(){return M(null,S)})}mt.prototype.broadcast=function(S,E,T){p.asyncAll(this.actors,function(M,B){M.send(S,E,B)},T=T||function(){})},mt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},mt.prototype.remove=function(){this.actors.forEach(function(S){S.remove()}),this.actors=[],this.workerPool.release(this.id)},mt.Actor=p.Actor;var Xt=function(S,E,T){this.bounds=p.LngLatBounds.convert(this.validateBounds(S)),this.minzoom=E||0,this.maxzoom=T||24};Xt.prototype.validateBounds=function(S){return Array.isArray(S)&&S.length===4?[Math.max(-180,S[0]),Math.max(-90,S[1]),Math.min(180,S[2]),Math.min(90,S[3])]:[-180,-90,180,90]},Xt.prototype.contains=function(S){var E=Math.pow(2,S.z),T=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*E),M=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*E),B=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*E),W=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*E);return S.x>=T&&S.x<B&&S.y>=M&&S.y<W};var Ht=function(S){function E(T,M,B,W){if(S.call(this),this.id=T,this.dispatcher=B,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(M,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},M),this._collectResourceTiming=M.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(W)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(){var T=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nr(this._options,this.map._requestManager,function(M,B){T._tileJSONRequest=null,T._loaded=!0,M?T.fire(new p.ErrorEvent(M)):B&&(p.extend(T,B),B.bounds&&(T.tileBounds=new Xt(B.bounds,T.minzoom,T.maxzoom)),p.postTurnstileEvent(B.tiles,T.map._requestManager._customAccessToken),p.postMapLoadEvent(B.tiles,T.map._getMapId(),T.map._requestManager._skuToken,T.map._requestManager._customAccessToken),T.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),T.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},E.prototype.loaded=function(){return this._loaded},E.prototype.hasTile=function(T){return!this.tileBounds||this.tileBounds.contains(T.canonical)},E.prototype.onAdd=function(T){this.map=T,this.load()},E.prototype.setSourceProperty=function(T){this._tileJSONRequest&&this._tileJSONRequest.cancel(),T(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},E.prototype.setTiles=function(T){var M=this;return this.setSourceProperty(function(){M._options.tiles=T}),this},E.prototype.setUrl=function(T){var M=this;return this.setSourceProperty(function(){M.url=T,M._options.url=T}),this},E.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},E.prototype.serialize=function(){return p.extend({},this._options)},E.prototype.loadTile=function(T,M){var B=this.map._requestManager.normalizeTileURL(T.tileID.canonical.url(this.tiles,this.scheme)),W={request:this.map._requestManager.transformRequest(B,p.ResourceType.Tile),uid:T.uid,tileID:T.tileID,zoom:T.tileID.overscaledZ,tileSize:this.tileSize*T.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function Y(re,ye){return delete T.request,T.aborted?M(null):re&&re.status!==404?M(re):(ye&&ye.resourceTiming&&(T.resourceTiming=ye.resourceTiming),this.map._refreshExpiredTiles&&ye&&T.setExpiryData(ye),T.loadVectorData(ye,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),M(null),void(T.reloadCallback&&(this.loadTile(T,T.reloadCallback),T.reloadCallback=null)))}W.request.collectResourceTiming=this._collectResourceTiming,T.actor&&T.state!=="expired"?T.state==="loading"?T.reloadCallback=M:T.request=T.actor.send("reloadTile",W,Y.bind(this)):(T.actor=this.dispatcher.getActor(),T.request=T.actor.send("loadTile",W,Y.bind(this)))},E.prototype.abortTile=function(T){T.request&&(T.request.cancel(),delete T.request),T.actor&&T.actor.send("abortTile",{uid:T.uid,type:this.type,source:this.id},void 0)},E.prototype.unloadTile=function(T){T.unloadVectorData(),T.actor&&T.actor.send("removeTile",{uid:T.uid,type:this.type,source:this.id},void 0)},E.prototype.hasTransition=function(){return!1},E}(p.Evented),Qt=function(S){function E(T,M,B,W){S.call(this),this.id=T,this.dispatcher=B,this.setEventedParent(W),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},M),p.extend(this,p.pick(M,["url","scheme","tileSize"]))}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(){var T=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=nr(this._options,this.map._requestManager,function(M,B){T._tileJSONRequest=null,T._loaded=!0,M?T.fire(new p.ErrorEvent(M)):B&&(p.extend(T,B),B.bounds&&(T.tileBounds=new Xt(B.bounds,T.minzoom,T.maxzoom)),p.postTurnstileEvent(B.tiles),p.postMapLoadEvent(B.tiles,T.map._getMapId(),T.map._requestManager._skuToken),T.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),T.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},E.prototype.loaded=function(){return this._loaded},E.prototype.onAdd=function(T){this.map=T,this.load()},E.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},E.prototype.serialize=function(){return p.extend({},this._options)},E.prototype.hasTile=function(T){return!this.tileBounds||this.tileBounds.contains(T.canonical)},E.prototype.loadTile=function(T,M){var B=this,W=this.map._requestManager.normalizeTileURL(T.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);T.request=p.getImage(this.map._requestManager.transformRequest(W,p.ResourceType.Tile),function(Y,re){if(delete T.request,T.aborted)T.state="unloaded",M(null);else if(Y)T.state="errored",M(Y);else if(re){B.map._refreshExpiredTiles&&T.setExpiryData(re),delete re.cacheControl,delete re.expires;var ye=B.map.painter.context,Ae=ye.gl;T.texture=B.map.painter.getTileTexture(re.width),T.texture?T.texture.update(re,{useMipmap:!0}):(T.texture=new p.Texture(ye,re,Ae.RGBA,{useMipmap:!0}),T.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),ye.extTextureFilterAnisotropic&&Ae.texParameterf(Ae.TEXTURE_2D,ye.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ye.extTextureFilterAnisotropicMax)),T.state="loaded",p.cacheEntryPossiblyAdded(B.dispatcher),M(null)}})},E.prototype.abortTile=function(T,M){T.request&&(T.request.cancel(),delete T.request),M()},E.prototype.unloadTile=function(T,M){T.texture&&this.map.painter.saveTileTexture(T.texture),M()},E.prototype.hasTransition=function(){return!1},E}(p.Evented),sr=function(S){function E(T,M,B,W){S.call(this,T,M,B,W),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},M),this.encoding=M.encoding||"mapbox"}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},E.prototype.loadTile=function(T,M){var B=this.map._requestManager.normalizeTileURL(T.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function W(Y,re){Y&&(T.state="errored",M(Y)),re&&(T.dem=re,T.needsHillshadePrepare=!0,T.state="loaded",M(null))}T.request=p.getImage(this.map._requestManager.transformRequest(B,p.ResourceType.Tile),(function(Y,re){if(delete T.request,T.aborted)T.state="unloaded",M(null);else if(Y)T.state="errored",M(Y);else if(re){this.map._refreshExpiredTiles&&T.setExpiryData(re),delete re.cacheControl,delete re.expires;var ye=p.window.ImageBitmap&&re instanceof p.window.ImageBitmap&&p.offscreenCanvasSupported()?re:p.browser.getImageData(re,1),Ae={uid:T.uid,coord:T.tileID,source:this.id,rawImageData:ye,encoding:this.encoding};T.actor&&T.state!=="expired"||(T.actor=this.dispatcher.getActor(),T.actor.send("loadDEMTile",Ae,W.bind(this)))}}).bind(this)),T.neighboringTiles=this._getNeighboringTiles(T.tileID)},E.prototype._getNeighboringTiles=function(T){var M=T.canonical,B=Math.pow(2,M.z),W=(M.x-1+B)%B,Y=M.x===0?T.wrap-1:T.wrap,re=(M.x+1+B)%B,ye=M.x+1===B?T.wrap+1:T.wrap,Ae={};return Ae[new p.OverscaledTileID(T.overscaledZ,Y,M.z,W,M.y).key]={backfilled:!1},Ae[new p.OverscaledTileID(T.overscaledZ,ye,M.z,re,M.y).key]={backfilled:!1},M.y>0&&(Ae[new p.OverscaledTileID(T.overscaledZ,Y,M.z,W,M.y-1).key]={backfilled:!1},Ae[new p.OverscaledTileID(T.overscaledZ,T.wrap,M.z,M.x,M.y-1).key]={backfilled:!1},Ae[new p.OverscaledTileID(T.overscaledZ,ye,M.z,re,M.y-1).key]={backfilled:!1}),M.y+1<B&&(Ae[new p.OverscaledTileID(T.overscaledZ,Y,M.z,W,M.y+1).key]={backfilled:!1},Ae[new p.OverscaledTileID(T.overscaledZ,T.wrap,M.z,M.x,M.y+1).key]={backfilled:!1},Ae[new p.OverscaledTileID(T.overscaledZ,ye,M.z,re,M.y+1).key]={backfilled:!1}),Ae},E.prototype.unloadTile=function(T){T.demTexture&&this.map.painter.saveTileTexture(T.demTexture),T.fbo&&(T.fbo.destroy(),delete T.fbo),T.dem&&delete T.dem,delete T.neighboringTiles,T.state="unloaded",T.actor&&T.actor.send("removeDEMTile",{uid:T.uid,source:this.id})},E}(Qt),Tr=function(S){function E(T,M,B,W){S.call(this),this.id=T,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=B.getActor(),this.setEventedParent(W),this._data=M.data,this._options=p.extend({},M),this._collectResourceTiming=M.collectResourceTiming,this._resourceTiming=[],M.maxzoom!==void 0&&(this.maxzoom=M.maxzoom),M.type&&(this.type=M.type),M.attribution&&(this.attribution=M.attribution),this.promoteId=M.promoteId;var Y=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:M.cluster||!1,geojsonVtOptions:{buffer:(M.buffer!==void 0?M.buffer:128)*Y,tolerance:(M.tolerance!==void 0?M.tolerance:.375)*Y,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:M.lineMetrics||!1,generateId:M.generateId||!1},superclusterOptions:{maxZoom:M.clusterMaxZoom!==void 0?Math.min(M.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,M.clusterMinPoints||2),extent:p.EXTENT,radius:(M.clusterRadius||50)*Y,log:!1,generateId:M.generateId||!1},clusterProperties:M.clusterProperties,filter:M.filter},M.workerOptions)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(){var T=this;this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(M){if(M)T.fire(new p.ErrorEvent(M));else{var B={dataType:"source",sourceDataType:"metadata"};T._collectResourceTiming&&T._resourceTiming&&T._resourceTiming.length>0&&(B.resourceTiming=T._resourceTiming,T._resourceTiming=[]),T.fire(new p.Event("data",B))}})},E.prototype.onAdd=function(T){this.map=T,this.load()},E.prototype.setData=function(T){var M=this;return this._data=T,this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(B){if(B)M.fire(new p.ErrorEvent(B));else{var W={dataType:"source",sourceDataType:"content"};M._collectResourceTiming&&M._resourceTiming&&M._resourceTiming.length>0&&(W.resourceTiming=M._resourceTiming,M._resourceTiming=[]),M.fire(new p.Event("data",W))}}),this},E.prototype.getClusterExpansionZoom=function(T,M){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:T,source:this.id},M),this},E.prototype.getClusterChildren=function(T,M){return this.actor.send("geojson.getClusterChildren",{clusterId:T,source:this.id},M),this},E.prototype.getClusterLeaves=function(T,M,B,W){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:T,limit:M,offset:B},W),this},E.prototype._updateWorkerData=function(T){var M=this;this._loaded=!1;var B=p.extend({},this.workerOptions),W=this._data;typeof W=="string"?(B.request=this.map._requestManager.transformRequest(p.browser.resolveURL(W),p.ResourceType.Source),B.request.collectResourceTiming=this._collectResourceTiming):B.data=JSON.stringify(W),this.actor.send(this.type+".loadData",B,function(Y,re){M._removed||re&&re.abandoned||(M._loaded=!0,re&&re.resourceTiming&&re.resourceTiming[M.id]&&(M._resourceTiming=re.resourceTiming[M.id].slice(0)),M.actor.send(M.type+".coalesce",{source:B.source},null),T(Y))})},E.prototype.loaded=function(){return this._loaded},E.prototype.loadTile=function(T,M){var B=this,W=T.actor?"reloadTile":"loadTile";T.actor=this.actor,T.request=this.actor.send(W,{type:this.type,uid:T.uid,tileID:T.tileID,zoom:T.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(Y,re){return delete T.request,T.unloadVectorData(),T.aborted?M(null):Y?M(Y):(T.loadVectorData(re,B.map.painter,W==="reloadTile"),M(null))})},E.prototype.abortTile=function(T){T.request&&(T.request.cancel(),delete T.request),T.aborted=!0},E.prototype.unloadTile=function(T){T.unloadVectorData(),this.actor.send("removeTile",{uid:T.uid,type:this.type,source:this.id})},E.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},E.prototype.serialize=function(){return p.extend({},this._options,{type:this.type,data:this._data})},E.prototype.hasTransition=function(){return!1},E}(p.Evented),ln=p.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),vn=function(S){function E(T,M,B,W){S.call(this),this.id=T,this.dispatcher=B,this.coordinates=M.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(W),this.options=M}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(T,M){var B=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),function(W,Y){B._loaded=!0,W?B.fire(new p.ErrorEvent(W)):Y&&(B.image=Y,T&&(B.coordinates=T),M&&M(),B._finishLoading())})},E.prototype.loaded=function(){return this._loaded},E.prototype.updateImage=function(T){var M=this;return this.image&&T.url?(this.options.url=T.url,this.load(T.coordinates,function(){M.texture=null}),this):this},E.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))},E.prototype.onAdd=function(T){this.map=T,this.load()},E.prototype.setCoordinates=function(T){var M=this;this.coordinates=T;var B=T.map(p.MercatorCoordinate.fromLngLat);this.tileID=function(Y){for(var re=1/0,ye=1/0,Ae=-1/0,Ze=-1/0,Je=0,ke=Y;Je<ke.length;Je+=1){var ut=ke[Je];re=Math.min(re,ut.x),ye=Math.min(ye,ut.y),Ae=Math.max(Ae,ut.x),Ze=Math.max(Ze,ut.y)}var ht=Math.max(Ae-re,Ze-ye),Ct=Math.max(0,Math.floor(-Math.log(ht)/Math.LN2)),lt=Math.pow(2,Ct);return new p.CanonicalTileID(Ct,Math.floor((re+Ae)/2*lt),Math.floor((ye+Ze)/2*lt))}(B),this.minzoom=this.maxzoom=this.tileID.z;var W=B.map(function(Y){return M.tileID.getTilePoint(Y)._round()});return this._boundsArray=new p.StructArrayLayout4i8,this._boundsArray.emplaceBack(W[0].x,W[0].y,0,0),this._boundsArray.emplaceBack(W[1].x,W[1].y,p.EXTENT,0),this._boundsArray.emplaceBack(W[3].x,W[3].y,0,p.EXTENT),this._boundsArray.emplaceBack(W[2].x,W[2].y,p.EXTENT,p.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this},E.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var T=this.map.painter.context,M=T.gl;for(var B in this.boundsBuffer||(this.boundsBuffer=T.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new p.Texture(T,this.image,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var W=this.tiles[B];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}}},E.prototype.loadTile=function(T,M){this.tileID&&this.tileID.equals(T.tileID.canonical)?(this.tiles[String(T.tileID.wrap)]=T,T.buckets={},M(null)):(T.state="errored",M(null))},E.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},E.prototype.hasTransition=function(){return!1},E}(p.Evented),wi=function(S){function E(T,M,B,W){S.call(this,T,M,B,W),this.roundZoom=!0,this.type="video",this.options=M}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(){var T=this;this._loaded=!1;var M=this.options;this.urls=[];for(var B=0,W=M.urls;B<W.length;B+=1)this.urls.push(this.map._requestManager.transformRequest(W[B],p.ResourceType.Source).url);p.getVideo(this.urls,function(Y,re){T._loaded=!0,Y?T.fire(new p.ErrorEvent(Y)):re&&(T.video=re,T.video.loop=!0,T.video.setAttribute("playsinline",""),T.video.addEventListener("playing",function(){T.map.triggerRepaint()}),T.map&&T.video.play(),T._finishLoading())})},E.prototype.pause=function(){this.video&&this.video.pause()},E.prototype.play=function(){this.video&&this.video.play()},E.prototype.seek=function(T){if(this.video){var M=this.video.seekable;T<M.start(0)||T>M.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+M.start(0)+" and "+M.end(0)+"-second mark."))):this.video.currentTime=T}},E.prototype.getVideo=function(){return this.video},E.prototype.onAdd=function(T){this.map||(this.map=T,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},E.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var T=this.map.painter.context,M=T.gl;for(var B in this.boundsBuffer||(this.boundsBuffer=T.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.texSubImage2D(M.TEXTURE_2D,0,0,0,M.RGBA,M.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(T,this.video,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var W=this.tiles[B];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}}},E.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},E.prototype.hasTransition=function(){return this.video&&!this.video.paused},E}(vn),hi=function(S){function E(T,M,B,W){S.call(this,T,M,B,W),M.coordinates?Array.isArray(M.coordinates)&&M.coordinates.length===4&&!M.coordinates.some(function(Y){return!Array.isArray(Y)||Y.length!==2||Y.some(function(re){return typeof re!="number"})})||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+T,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+T,null,'missing required property "coordinates"'))),M.animate&&typeof M.animate!="boolean"&&this.fire(new p.ErrorEvent(new p.ValidationError("sources."+T,null,'optional "animate" property must be a boolean value'))),M.canvas?typeof M.canvas=="string"||M.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+T,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+T,null,'missing required property "canvas"'))),this.options=M,this.animate=M.animate===void 0||M.animate}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},E.prototype.getCanvas=function(){return this.canvas},E.prototype.onAdd=function(T){this.map=T,this.load(),this.canvas&&this.animate&&this.play()},E.prototype.onRemove=function(){this.pause()},E.prototype.prepare=function(){var T=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,T=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,T=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var M=this.map.painter.context,B=M.gl;for(var W in this.boundsBuffer||(this.boundsBuffer=M.createVertexBuffer(this._boundsArray,ln.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(T||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(M,this.canvas,B.RGBA,{premultiply:!0}),this.tiles){var Y=this.tiles[W];Y.state!=="loaded"&&(Y.state="loaded",Y.texture=this.texture)}}},E.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},E.prototype.hasTransition=function(){return this._playing},E.prototype._hasInvalidDimensions=function(){for(var T=0,M=[this.canvas.width,this.canvas.height];T<M.length;T+=1){var B=M[T];if(isNaN(B)||B<=0)return!0}return!1},E}(vn),Vn={vector:Ht,raster:Qt,"raster-dem":sr,geojson:Tr,video:wi,image:vn,canvas:hi};function Oi(S,E){var T=p.identity([]);return p.translate(T,T,[1,1,0]),p.scale(T,T,[.5*S.width,.5*S.height,1]),p.multiply(T,T,S.calculatePosMatrix(E.toUnwrapped()))}function fn(S,E,T,M,B,W){var Y=function(Ct,lt,It){if(Ct)for(var Lt=0,Jt=Ct;Lt<Jt.length;Lt+=1){var vr=lt[Jt[Lt]];if(vr&&vr.source===It&&vr.type==="fill-extrusion")return!0}else for(var mr in lt){var wr=lt[mr];if(wr.source===It&&wr.type==="fill-extrusion")return!0}return!1}(B&&B.layers,E,S.id),re=W.maxPitchScaleFactor(),ye=S.tilesIn(M,re,Y);ye.sort(Nn);for(var Ae=[],Ze=0,Je=ye;Ze<Je.length;Ze+=1){var ke=Je[Ze];Ae.push({wrappedTileID:ke.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(E,T,S._state,ke.queryGeometry,ke.cameraQueryGeometry,ke.scale,B,W,re,Oi(S.transform,ke.tileID))})}var ut=function(Ct){for(var lt={},It={},Lt=0,Jt=Ct;Lt<Jt.length;Lt+=1){var vr=Jt[Lt],mr=vr.queryResults,wr=vr.wrappedTileID,Ur=It[wr]=It[wr]||{};for(var on in mr)for(var Hr=mr[on],mn=Ur[on]=Ur[on]||{},Yn=lt[on]=lt[on]||[],ni=0,Jn=Hr;ni<Jn.length;ni+=1){var io=Jn[ni];mn[io.featureIndex]||(mn[io.featureIndex]=!0,Yn.push(io))}}return lt}(Ae);for(var ht in ut)ut[ht].forEach(function(Ct){var lt=Ct.feature,It=S.getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=It});return ut}function Nn(S,E){var T=S.tileID,M=E.tileID;return T.overscaledZ-M.overscaledZ||T.canonical.y-M.canonical.y||T.wrap-M.wrap||T.canonical.x-M.canonical.x}var Pt=function(S,E){this.max=S,this.onRemove=E,this.reset()};Pt.prototype.reset=function(){for(var S in this.data)for(var E=0,T=this.data[S];E<T.length;E+=1){var M=T[E];M.timeout&&clearTimeout(M.timeout),this.onRemove(M.value)}return this.data={},this.order=[],this},Pt.prototype.add=function(S,E,T){var M=this,B=S.wrapped().key;this.data[B]===void 0&&(this.data[B]=[]);var W={value:E,timeout:void 0};if(T!==void 0&&(W.timeout=setTimeout(function(){M.remove(S,W)},T)),this.data[B].push(W),this.order.push(B),this.order.length>this.max){var Y=this._getAndRemoveByKey(this.order[0]);Y&&this.onRemove(Y)}return this},Pt.prototype.has=function(S){return S.wrapped().key in this.data},Pt.prototype.getAndRemove=function(S){return this.has(S)?this._getAndRemoveByKey(S.wrapped().key):null},Pt.prototype._getAndRemoveByKey=function(S){var E=this.data[S].shift();return E.timeout&&clearTimeout(E.timeout),this.data[S].length===0&&delete this.data[S],this.order.splice(this.order.indexOf(S),1),E.value},Pt.prototype.getByKey=function(S){var E=this.data[S];return E?E[0].value:null},Pt.prototype.get=function(S){return this.has(S)?this.data[S.wrapped().key][0].value:null},Pt.prototype.remove=function(S,E){if(!this.has(S))return this;var T=S.wrapped().key,M=E===void 0?0:this.data[T].indexOf(E),B=this.data[T][M];return this.data[T].splice(M,1),B.timeout&&clearTimeout(B.timeout),this.data[T].length===0&&delete this.data[T],this.onRemove(B.value),this.order.splice(this.order.indexOf(T),1),this},Pt.prototype.setMaxSize=function(S){for(this.max=S;this.order.length>this.max;){var E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this},Pt.prototype.filter=function(S){var E=[];for(var T in this.data)for(var M=0,B=this.data[T];M<B.length;M+=1){var W=B[M];S(W.value)||E.push(W)}for(var Y=0,re=E;Y<re.length;Y+=1){var ye=re[Y];this.remove(ye.value.tileID,ye)}};var Dt=function(S,E,T){this.context=S;var M=S.gl;this.buffer=M.createBuffer(),this.dynamicDraw=!!T,this.context.unbindVAO(),S.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer};Dt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Dt.prototype.updateData=function(S){var E=this.context.gl;this.context.unbindVAO(),this.bind(),E.bufferSubData(E.ELEMENT_ARRAY_BUFFER,0,S.arrayBuffer)},Dt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ir={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},xr=function(S,E,T,M){this.length=E.length,this.attributes=T,this.itemSize=E.bytesPerElement,this.dynamicDraw=M,this.context=S;var B=S.gl;this.buffer=B.createBuffer(),S.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,E.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||delete E.arrayBuffer};xr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},xr.prototype.updateData=function(S){var E=this.context.gl;this.bind(),E.bufferSubData(E.ARRAY_BUFFER,0,S.arrayBuffer)},xr.prototype.enableAttributes=function(S,E){for(var T=0;T<this.attributes.length;T++){var M=E.attributes[this.attributes[T].name];M!==void 0&&S.enableVertexAttribArray(M)}},xr.prototype.setVertexAttribPointers=function(S,E,T){for(var M=0;M<this.attributes.length;M++){var B=this.attributes[M],W=E.attributes[B.name];W!==void 0&&S.vertexAttribPointer(W,B.components,S[Ir[B.type]],!1,this.itemSize,B.offset+this.itemSize*(T||0))}},xr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Kt=function(S){this.gl=S.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Kt.prototype.get=function(){return this.current},Kt.prototype.set=function(S){},Kt.prototype.getDefault=function(){return this.default},Kt.prototype.setDefault=function(){this.set(this.default)};var Cn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return p.Color.transparent},E.prototype.set=function(T){var M=this.current;(T.r!==M.r||T.g!==M.g||T.b!==M.b||T.a!==M.a||this.dirty)&&(this.gl.clearColor(T.r,T.g,T.b,T.a),this.current=T,this.dirty=!1)},E}(Kt),gn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return 1},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.clearDepth(T),this.current=T,this.dirty=!1)},E}(Kt),fr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return 0},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.clearStencil(T),this.current=T,this.dirty=!1)},E}(Kt),Zr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return[!0,!0,!0,!0]},E.prototype.set=function(T){var M=this.current;(T[0]!==M[0]||T[1]!==M[1]||T[2]!==M[2]||T[3]!==M[3]||this.dirty)&&(this.gl.colorMask(T[0],T[1],T[2],T[3]),this.current=T,this.dirty=!1)},E}(Kt),qr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!0},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.depthMask(T),this.current=T,this.dirty=!1)},E}(Kt),sn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return 255},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.stencilMask(T),this.current=T,this.dirty=!1)},E}(Kt),qn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},E.prototype.set=function(T){var M=this.current;(T.func!==M.func||T.ref!==M.ref||T.mask!==M.mask||this.dirty)&&(this.gl.stencilFunc(T.func,T.ref,T.mask),this.current=T,this.dirty=!1)},E}(Kt),Li=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){var T=this.gl;return[T.KEEP,T.KEEP,T.KEEP]},E.prototype.set=function(T){var M=this.current;(T[0]!==M[0]||T[1]!==M[1]||T[2]!==M[2]||this.dirty)&&(this.gl.stencilOp(T[0],T[1],T[2]),this.current=T,this.dirty=!1)},E}(Kt),_i=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;T?M.enable(M.STENCIL_TEST):M.disable(M.STENCIL_TEST),this.current=T,this.dirty=!1}},E}(Kt),zi=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return[0,1]},E.prototype.set=function(T){var M=this.current;(T[0]!==M[0]||T[1]!==M[1]||this.dirty)&&(this.gl.depthRange(T[0],T[1]),this.current=T,this.dirty=!1)},E}(Kt),Pi=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;T?M.enable(M.DEPTH_TEST):M.disable(M.DEPTH_TEST),this.current=T,this.dirty=!1}},E}(Kt),rr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.LESS},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.depthFunc(T),this.current=T,this.dirty=!1)},E}(Kt),Me=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;T?M.enable(M.BLEND):M.disable(M.BLEND),this.current=T,this.dirty=!1}},E}(Kt),qe=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){var T=this.gl;return[T.ONE,T.ZERO]},E.prototype.set=function(T){var M=this.current;(T[0]!==M[0]||T[1]!==M[1]||this.dirty)&&(this.gl.blendFunc(T[0],T[1]),this.current=T,this.dirty=!1)},E}(Kt),at=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return p.Color.transparent},E.prototype.set=function(T){var M=this.current;(T.r!==M.r||T.g!==M.g||T.b!==M.b||T.a!==M.a||this.dirty)&&(this.gl.blendColor(T.r,T.g,T.b,T.a),this.current=T,this.dirty=!1)},E}(Kt),$t=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.FUNC_ADD},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.blendEquation(T),this.current=T,this.dirty=!1)},E}(Kt),cr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;T?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),this.current=T,this.dirty=!1}},E}(Kt),br=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.BACK},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.cullFace(T),this.current=T,this.dirty=!1)},E}(Kt),en=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.CCW},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.frontFace(T),this.current=T,this.dirty=!1)},E}(Kt),ur=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.useProgram(T),this.current=T,this.dirty=!1)},E}(Kt),Kr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return this.gl.TEXTURE0},E.prototype.set=function(T){(T!==this.current||this.dirty)&&(this.gl.activeTexture(T),this.current=T,this.dirty=!1)},E}(Kt),Vr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){var T=this.gl;return[0,0,T.drawingBufferWidth,T.drawingBufferHeight]},E.prototype.set=function(T){var M=this.current;(T[0]!==M[0]||T[1]!==M[1]||T[2]!==M[2]||T[3]!==M[3]||this.dirty)&&(this.gl.viewport(T[0],T[1],T[2],T[3]),this.current=T,this.dirty=!1)},E}(Kt),cn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.bindFramebuffer(M.FRAMEBUFFER,T),this.current=T,this.dirty=!1}},E}(Kt),Xn=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.bindRenderbuffer(M.RENDERBUFFER,T),this.current=T,this.dirty=!1}},E}(Kt),Mr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.bindTexture(M.TEXTURE_2D,T),this.current=T,this.dirty=!1}},E}(Kt),Fr=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.bindBuffer(M.ARRAY_BUFFER,T),this.current=T,this.dirty=!1}},E}(Kt),ri=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){var M=this.gl;M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,T),this.current=T,this.dirty=!1},E}(Kt),mi=function(S){function E(T){S.call(this,T),this.vao=T.extVertexArrayObject}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E.prototype.set=function(T){this.vao&&(T!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(T),this.current=T,this.dirty=!1)},E}(Kt),gi=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return 4},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_ALIGNMENT,T),this.current=T,this.dirty=!1}},E}(Kt),Xi=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T),this.current=T,this.dirty=!1}},E}(Kt),mo=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return!1},E.prototype.set=function(T){if(T!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,T),this.current=T,this.dirty=!1}},E}(Kt),eo=function(S){function E(T,M){S.call(this,T),this.context=T,this.parent=M}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getDefault=function(){return null},E}(Kt),Se=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.setDirty=function(){this.dirty=!0},E.prototype.set=function(T){if(T!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,T,0),this.current=T,this.dirty=!1}},E}(eo),Re=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.set=function(T){if(T!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,T),this.current=T,this.dirty=!1}},E}(eo),Fe=function(S,E,T,M){this.context=S,this.width=E,this.height=T;var B=this.framebuffer=S.gl.createFramebuffer();this.colorAttachment=new Se(S,B),M&&(this.depthAttachment=new Re(S,B))};Fe.prototype.destroy=function(){var S=this.context.gl,E=this.colorAttachment.get();if(E&&S.deleteTexture(E),this.depthAttachment){var T=this.depthAttachment.get();T&&S.deleteRenderbuffer(T)}S.deleteFramebuffer(this.framebuffer)};var et=function(S,E,T){this.func=S,this.mask=E,this.range=T};et.ReadOnly=!1,et.ReadWrite=!0,et.disabled=new et(519,et.ReadOnly,[0,1]);var it=function(S,E,T,M,B,W){this.test=S,this.ref=E,this.mask=T,this.fail=M,this.depthFail=B,this.pass=W};it.disabled=new it({func:519,mask:0},0,0,7680,7680,7680);var wt=function(S,E,T){this.blendFunction=S,this.blendColor=E,this.mask=T};wt.disabled=new wt(wt.Replace=[1,0],p.Color.transparent,[!1,!1,!1,!1]),wt.unblended=new wt(wt.Replace,p.Color.transparent,[!0,!0,!0,!0]),wt.alphaBlended=new wt([1,771],p.Color.transparent,[!0,!0,!0,!0]);var $e=function(S,E,T){this.enable=S,this.mode=E,this.frontFace=T};$e.disabled=new $e(!1,1029,2305),$e.backCCW=new $e(!0,1029,2305);var ve=function(S){this.gl=S,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Cn(this),this.clearDepth=new gn(this),this.clearStencil=new fr(this),this.colorMask=new Zr(this),this.depthMask=new qr(this),this.stencilMask=new sn(this),this.stencilFunc=new qn(this),this.stencilOp=new Li(this),this.stencilTest=new _i(this),this.depthRange=new zi(this),this.depthTest=new Pi(this),this.depthFunc=new rr(this),this.blend=new Me(this),this.blendFunc=new qe(this),this.blendColor=new at(this),this.blendEquation=new $t(this),this.cullFace=new cr(this),this.cullFaceSide=new br(this),this.frontFace=new en(this),this.program=new ur(this),this.activeTexture=new Kr(this),this.viewport=new Vr(this),this.bindFramebuffer=new cn(this),this.bindRenderbuffer=new Xn(this),this.bindTexture=new Mr(this),this.bindVertexBuffer=new Fr(this),this.bindElementBuffer=new ri(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new mi(this),this.pixelStoreUnpack=new gi(this),this.pixelStoreUnpackPremultiplyAlpha=new Xi(this),this.pixelStoreUnpackFlipY=new mo(this),this.extTextureFilterAnisotropic=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=S.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=S.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(S.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=S.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=S.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=S.getParameter(S.MAX_TEXTURE_SIZE)};ve.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ve.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ve.prototype.createIndexBuffer=function(S,E){return new Dt(this,S,E)},ve.prototype.createVertexBuffer=function(S,E,T){return new xr(this,S,E,T)},ve.prototype.createRenderbuffer=function(S,E,T){var M=this.gl,B=M.createRenderbuffer();return this.bindRenderbuffer.set(B),M.renderbufferStorage(M.RENDERBUFFER,S,E,T),this.bindRenderbuffer.set(null),B},ve.prototype.createFramebuffer=function(S,E,T){return new Fe(this,S,E,T)},ve.prototype.clear=function(S){var E=S.color,T=S.depth,M=this.gl,B=0;E&&(B|=M.COLOR_BUFFER_BIT,this.clearColor.set(E),this.colorMask.set([!0,!0,!0,!0])),T!==void 0&&(B|=M.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(T),this.depthMask.set(!0)),M.clear(B)},ve.prototype.setCullFace=function(S){S.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(S.mode),this.frontFace.set(S.frontFace))},ve.prototype.setDepthMode=function(S){S.func!==this.gl.ALWAYS||S.mask?(this.depthTest.set(!0),this.depthFunc.set(S.func),this.depthMask.set(S.mask),this.depthRange.set(S.range)):this.depthTest.set(!1)},ve.prototype.setStencilMode=function(S){S.test.func!==this.gl.ALWAYS||S.mask?(this.stencilTest.set(!0),this.stencilMask.set(S.mask),this.stencilOp.set([S.fail,S.depthFail,S.pass]),this.stencilFunc.set({func:S.test.func,ref:S.ref,mask:S.test.mask})):this.stencilTest.set(!1)},ve.prototype.setColorMode=function(S){p.deepEqual(S.blendFunction,wt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(S.blendFunction),this.blendColor.set(S.blendColor)),this.colorMask.set(S.mask)},ve.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Le=function(S){function E(T,M,B){var W=this;S.call(this),this.id=T,this.dispatcher=B,this.on("data",function(Y){Y.dataType==="source"&&Y.sourceDataType==="metadata"&&(W._sourceLoaded=!0),W._sourceLoaded&&!W._paused&&Y.dataType==="source"&&Y.sourceDataType==="content"&&(W.reload(),W.transform&&W.update(W.transform))}),this.on("error",function(){W._sourceErrored=!0}),this._source=function(Y,re,ye,Ae){var Ze=new Vn[re.type](Y,re,ye,Ae);if(Ze.id!==Y)throw new Error("Expected Source id to be "+Y+" instead of "+Ze.id);return p.bindAll(["load","abort","unload","serialize","prepare"],Ze),Ze}(T,M,B,this),this._tiles={},this._cache=new Pt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new p.SourceFeatureState}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.onAdd=function(T){this.map=T,this._maxTileCacheSize=T?T._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(T)},E.prototype.onRemove=function(T){this._source&&this._source.onRemove&&this._source.onRemove(T)},E.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var T in this._tiles){var M=this._tiles[T];if(M.state!=="loaded"&&M.state!=="errored")return!1}return!0},E.prototype.getSource=function(){return this._source},E.prototype.pause=function(){this._paused=!0},E.prototype.resume=function(){if(this._paused){var T=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,T&&this.reload(),this.transform&&this.update(this.transform)}},E.prototype._loadTile=function(T,M){return this._source.loadTile(T,M)},E.prototype._unloadTile=function(T){if(this._source.unloadTile)return this._source.unloadTile(T,function(){})},E.prototype._abortTile=function(T){if(this._source.abortTile)return this._source.abortTile(T,function(){})},E.prototype.serialize=function(){return this._source.serialize()},E.prototype.prepare=function(T){for(var M in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var B=this._tiles[M];B.upload(T),B.prepare(this.map.style.imageManager)}},E.prototype.getIds=function(){return p.values(this._tiles).map(function(T){return T.tileID}).sort(ot).map(function(T){return T.key})},E.prototype.getRenderableIds=function(T){var M=this,B=[];for(var W in this._tiles)this._isIdRenderable(W,T)&&B.push(this._tiles[W]);return T?B.sort(function(Y,re){var ye=Y.tileID,Ae=re.tileID,Ze=new p.Point(ye.canonical.x,ye.canonical.y)._rotate(M.transform.angle),Je=new p.Point(Ae.canonical.x,Ae.canonical.y)._rotate(M.transform.angle);return ye.overscaledZ-Ae.overscaledZ||Je.y-Ze.y||Je.x-Ze.x}).map(function(Y){return Y.tileID.key}):B.map(function(Y){return Y.tileID}).sort(ot).map(function(Y){return Y.key})},E.prototype.hasRenderableParent=function(T){var M=this.findLoadedParent(T,0);return!!M&&this._isIdRenderable(M.tileID.key)},E.prototype._isIdRenderable=function(T,M){return this._tiles[T]&&this._tiles[T].hasData()&&!this._coveredTiles[T]&&(M||!this._tiles[T].holdingForFade())},E.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var T in this._cache.reset(),this._tiles)this._tiles[T].state!=="errored"&&this._reloadTile(T,"reloading")},E.prototype._reloadTile=function(T,M){var B=this._tiles[T];B&&(B.state!=="loading"&&(B.state=M),this._loadTile(B,this._tileLoaded.bind(this,B,T,M)))},E.prototype._tileLoaded=function(T,M,B,W){if(W)return T.state="errored",void(W.status!==404?this._source.fire(new p.ErrorEvent(W,{tile:T})):this.update(this.transform));T.timeAdded=p.browser.now(),B==="expired"&&(T.refreshedUponExpiration=!0),this._setTileReloadTimer(M,T),this.getSource().type==="raster-dem"&&T.dem&&this._backfillDEM(T),this._state.initializeTileState(T,this.map?this.map.painter:null),this._source.fire(new p.Event("data",{dataType:"source",tile:T,coord:T.tileID}))},E.prototype._backfillDEM=function(T){for(var M=this.getRenderableIds(),B=0;B<M.length;B++){var W=M[B];if(T.neighboringTiles&&T.neighboringTiles[W]){var Y=this.getTileByID(W);re(T,Y),re(Y,T)}}function re(ye,Ae){ye.needsHillshadePrepare=!0;var Ze=Ae.tileID.canonical.x-ye.tileID.canonical.x,Je=Ae.tileID.canonical.y-ye.tileID.canonical.y,ke=Math.pow(2,ye.tileID.canonical.z),ut=Ae.tileID.key;Ze===0&&Je===0||Math.abs(Je)>1||(Math.abs(Ze)>1&&(Math.abs(Ze+ke)===1?Ze+=ke:Math.abs(Ze-ke)===1&&(Ze-=ke)),Ae.dem&&ye.dem&&(ye.dem.backfillBorder(Ae.dem,Ze,Je),ye.neighboringTiles&&ye.neighboringTiles[ut]&&(ye.neighboringTiles[ut].backfilled=!0)))}},E.prototype.getTile=function(T){return this.getTileByID(T.key)},E.prototype.getTileByID=function(T){return this._tiles[T]},E.prototype._retainLoadedChildren=function(T,M,B,W){for(var Y in this._tiles){var re=this._tiles[Y];if(!(W[Y]||!re.hasData()||re.tileID.overscaledZ<=M||re.tileID.overscaledZ>B)){for(var ye=re.tileID;re&&re.tileID.overscaledZ>M+1;){var Ae=re.tileID.scaledTo(re.tileID.overscaledZ-1);(re=this._tiles[Ae.key])&&re.hasData()&&(ye=Ae)}for(var Ze=ye;Ze.overscaledZ>M;)if(T[(Ze=Ze.scaledTo(Ze.overscaledZ-1)).key]){W[ye.key]=ye;break}}}},E.prototype.findLoadedParent=function(T,M){if(T.key in this._loadedParentTiles){var B=this._loadedParentTiles[T.key];return B&&B.tileID.overscaledZ>=M?B:null}for(var W=T.overscaledZ-1;W>=M;W--){var Y=T.scaledTo(W),re=this._getLoadedTile(Y);if(re)return re}},E.prototype._getLoadedTile=function(T){var M=this._tiles[T.key];return M&&M.hasData()?M:this._cache.getByKey(T.wrapped().key)},E.prototype.updateCacheSize=function(T){var M=Math.ceil(T.width/this._source.tileSize)+1,B=Math.ceil(T.height/this._source.tileSize)+1,W=Math.floor(M*B*5),Y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,W):W;this._cache.setMaxSize(Y)},E.prototype.handleWrapJump=function(T){var M=Math.round((T-(this._prevLng===void 0?T:this._prevLng))/360);if(this._prevLng=T,M){var B={};for(var W in this._tiles){var Y=this._tiles[W];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+M),B[Y.tileID.key]=Y}for(var re in this._tiles=B,this._timers)clearTimeout(this._timers[re]),delete this._timers[re];for(var ye in this._tiles)this._setTileReloadTimer(ye,this._tiles[ye])}},E.prototype.update=function(T){var M=this;if(this.transform=T,this._sourceLoaded&&!this._paused){var B;this.updateCacheSize(T),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?B=T.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Ur){return new p.OverscaledTileID(Ur.canonical.z,Ur.wrap,Ur.canonical.z,Ur.canonical.x,Ur.canonical.y)}):(B=T.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(B=B.filter(function(Ur){return M._source.hasTile(Ur)}))):B=[];var W=T.coveringZoomLevel(this._source),Y=Math.max(W-E.maxOverzooming,this._source.minzoom),re=Math.max(W+E.maxUnderzooming,this._source.minzoom),ye=this._updateRetainedTiles(B,W);if(Mt(this._source.type)){for(var Ae={},Ze={},Je=0,ke=Object.keys(ye);Je<ke.length;Je+=1){var ut=ke[Je],ht=ye[ut],Ct=this._tiles[ut];if(Ct&&!(Ct.fadeEndTime&&Ct.fadeEndTime<=p.browser.now())){var lt=this.findLoadedParent(ht,Y);lt&&(this._addTile(lt.tileID),Ae[lt.tileID.key]=lt.tileID),Ze[ut]=ht}}for(var It in this._retainLoadedChildren(Ze,W,re,ye),Ae)ye[It]||(this._coveredTiles[It]=!0,ye[It]=Ae[It])}for(var Lt in ye)this._tiles[Lt].clearFadeHold();for(var Jt=0,vr=p.keysDifference(this._tiles,ye);Jt<vr.length;Jt+=1){var mr=vr[Jt],wr=this._tiles[mr];wr.hasSymbolBuckets&&!wr.holdingForFade()?wr.setHoldDuration(this.map._fadeDuration):wr.hasSymbolBuckets&&!wr.symbolFadeFinished()||this._removeTile(mr)}this._updateLoadedParentTileCache()}},E.prototype.releaseSymbolFadeTiles=function(){for(var T in this._tiles)this._tiles[T].holdingForFade()&&this._removeTile(T)},E.prototype._updateRetainedTiles=function(T,M){for(var B={},W={},Y=Math.max(M-E.maxOverzooming,this._source.minzoom),re=Math.max(M+E.maxUnderzooming,this._source.minzoom),ye={},Ae=0,Ze=T;Ae<Ze.length;Ae+=1){var Je=Ze[Ae],ke=this._addTile(Je);B[Je.key]=Je,ke.hasData()||M<this._source.maxzoom&&(ye[Je.key]=Je)}this._retainLoadedChildren(ye,M,re,B);for(var ut=0,ht=T;ut<ht.length;ut+=1){var Ct=ht[ut],lt=this._tiles[Ct.key];if(!lt.hasData()){if(M+1>this._source.maxzoom){var It=Ct.children(this._source.maxzoom)[0],Lt=this.getTile(It);if(Lt&&Lt.hasData()){B[It.key]=It;continue}}else{var Jt=Ct.children(this._source.maxzoom);if(B[Jt[0].key]&&B[Jt[1].key]&&B[Jt[2].key]&&B[Jt[3].key])continue}for(var vr=lt.wasRequested(),mr=Ct.overscaledZ-1;mr>=Y;--mr){var wr=Ct.scaledTo(mr);if(W[wr.key]||(W[wr.key]=!0,!(lt=this.getTile(wr))&&vr&&(lt=this._addTile(wr)),lt&&(B[wr.key]=wr,vr=lt.wasRequested(),lt.hasData())))break}}}return B},E.prototype._updateLoadedParentTileCache=function(){for(var T in this._loadedParentTiles={},this._tiles){for(var M=[],B=void 0,W=this._tiles[T].tileID;W.overscaledZ>0;){if(W.key in this._loadedParentTiles){B=this._loadedParentTiles[W.key];break}M.push(W.key);var Y=W.scaledTo(W.overscaledZ-1);if(B=this._getLoadedTile(Y))break;W=Y}for(var re=0,ye=M;re<ye.length;re+=1)this._loadedParentTiles[ye[re]]=B}},E.prototype._addTile=function(T){var M=this._tiles[T.key];if(M)return M;(M=this._cache.getAndRemove(T))&&(this._setTileReloadTimer(T.key,M),M.tileID=T,this._state.initializeTileState(M,this.map?this.map.painter:null),this._cacheTimers[T.key]&&(clearTimeout(this._cacheTimers[T.key]),delete this._cacheTimers[T.key],this._setTileReloadTimer(T.key,M)));var B=!!M;return B||(M=new p.Tile(T,this._source.tileSize*T.overscaleFactor()),this._loadTile(M,this._tileLoaded.bind(this,M,T.key,M.state))),M?(M.uses++,this._tiles[T.key]=M,B||this._source.fire(new p.Event("dataloading",{tile:M,coord:M.tileID,dataType:"source"})),M):null},E.prototype._setTileReloadTimer=function(T,M){var B=this;T in this._timers&&(clearTimeout(this._timers[T]),delete this._timers[T]);var W=M.getExpiryTimeout();W&&(this._timers[T]=setTimeout(function(){B._reloadTile(T,"expired"),delete B._timers[T]},W))},E.prototype._removeTile=function(T){var M=this._tiles[T];M&&(M.uses--,delete this._tiles[T],this._timers[T]&&(clearTimeout(this._timers[T]),delete this._timers[T]),M.uses>0||(M.hasData()&&M.state!=="reloading"?this._cache.add(M.tileID,M,M.getExpiryTimeout()):(M.aborted=!0,this._abortTile(M),this._unloadTile(M))))},E.prototype.clearTiles=function(){for(var T in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(T);this._cache.reset()},E.prototype.tilesIn=function(T,M,B){var W=this,Y=[],re=this.transform;if(!re)return Y;for(var ye=B?re.getCameraQueryGeometry(T):T,Ae=T.map(function(mr){return re.pointCoordinate(mr)}),Ze=ye.map(function(mr){return re.pointCoordinate(mr)}),Je=this.getIds(),ke=1/0,ut=1/0,ht=-1/0,Ct=-1/0,lt=0,It=Ze;lt<It.length;lt+=1){var Lt=It[lt];ke=Math.min(ke,Lt.x),ut=Math.min(ut,Lt.y),ht=Math.max(ht,Lt.x),Ct=Math.max(Ct,Lt.y)}for(var Jt=function(mr){var wr=W._tiles[Je[mr]];if(!wr.holdingForFade()){var Ur=wr.tileID,on=Math.pow(2,re.zoom-wr.tileID.overscaledZ),Hr=M*wr.queryPadding*p.EXTENT/wr.tileSize/on,mn=[Ur.getTilePoint(new p.MercatorCoordinate(ke,ut)),Ur.getTilePoint(new p.MercatorCoordinate(ht,Ct))];if(mn[0].x-Hr<p.EXTENT&&mn[0].y-Hr<p.EXTENT&&mn[1].x+Hr>=0&&mn[1].y+Hr>=0){var Yn=Ae.map(function(Jn){return Ur.getTilePoint(Jn)}),ni=Ze.map(function(Jn){return Ur.getTilePoint(Jn)});Y.push({tile:wr,tileID:Ur,queryGeometry:Yn,cameraQueryGeometry:ni,scale:on})}}},vr=0;vr<Je.length;vr++)Jt(vr);return Y},E.prototype.getVisibleCoordinates=function(T){for(var M=this,B=this.getRenderableIds(T).map(function(ye){return M._tiles[ye].tileID}),W=0,Y=B;W<Y.length;W+=1){var re=Y[W];re.posMatrix=this.transform.calculatePosMatrix(re.toUnwrapped())}return B},E.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var T in this._tiles){var M=this._tiles[T];if(M.fadeEndTime!==void 0&&M.fadeEndTime>=p.browser.now())return!0}return!1},E.prototype.setFeatureState=function(T,M,B){this._state.updateState(T=T||"_geojsonTileLayer",M,B)},E.prototype.removeFeatureState=function(T,M,B){this._state.removeFeatureState(T=T||"_geojsonTileLayer",M,B)},E.prototype.getFeatureState=function(T,M){return this._state.getState(T=T||"_geojsonTileLayer",M)},E.prototype.setDependencies=function(T,M,B){var W=this._tiles[T];W&&W.setDependencies(M,B)},E.prototype.reloadTilesForDependencies=function(T,M){for(var B in this._tiles)this._tiles[B].hasDependency(T,M)&&this._reloadTile(B,"reloading");this._cache.filter(function(W){return!W.hasDependency(T,M)})},E}(p.Evented);function ot(S,E){var T=Math.abs(2*S.wrap)-+(S.wrap<0),M=Math.abs(2*E.wrap)-+(E.wrap<0);return S.overscaledZ-E.overscaledZ||M-T||E.canonical.y-S.canonical.y||E.canonical.x-S.canonical.x}function Mt(S){return S==="raster"||S==="image"||S==="video"}function Ot(){return new p.window.Worker(Ah.workerUrl)}Le.maxOverzooming=10,Le.maxUnderzooming=3;var bt="mapboxgl_preloaded_worker_pool",Rt=function(){this.active={}};Rt.prototype.acquire=function(S){if(!this.workers)for(this.workers=[];this.workers.length<Rt.workerCount;)this.workers.push(new Ot);return this.active[S]=!0,this.workers.slice()},Rt.prototype.release=function(S){delete this.active[S],this.numActive()===0&&(this.workers.forEach(function(E){E.terminate()}),this.workers=null)},Rt.prototype.isPreloaded=function(){return!!this.active[bt]},Rt.prototype.numActive=function(){return Object.keys(this.active).length};var ar,qt=Math.floor(p.browser.hardwareConcurrency/2);function Nt(){return ar||(ar=new Rt),ar}function Rr(S,E){var T={};for(var M in S)M!=="ref"&&(T[M]=S[M]);return p.refProperties.forEach(function(B){B in E&&(T[B]=E[B])}),T}function er(S){S=S.slice();for(var E=Object.create(null),T=0;T<S.length;T++)E[S[T].id]=S[T];for(var M=0;M<S.length;M++)"ref"in S[M]&&(S[M]=Rr(S[M],E[S[M].ref]));return S}Rt.workerCount=Math.max(Math.min(qt,6),1);var Nr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ln(S,E,T){T.push({command:Nr.addSource,args:[S,E[S]]})}function $r(S,E,T){E.push({command:Nr.removeSource,args:[S]}),T[S]=!0}function si(S,E,T,M){$r(S,T,M),Ln(S,E,T)}function Yi(S,E,T){var M;for(M in S[T])if(S[T].hasOwnProperty(M)&&M!=="data"&&!p.deepEqual(S[T][M],E[T][M]))return!1;for(M in E[T])if(E[T].hasOwnProperty(M)&&M!=="data"&&!p.deepEqual(S[T][M],E[T][M]))return!1;return!0}function xn(S,E,T,M,B,W){var Y;for(Y in E=E||{},S=S||{})S.hasOwnProperty(Y)&&(p.deepEqual(S[Y],E[Y])||T.push({command:W,args:[M,Y,E[Y],B]}));for(Y in E)E.hasOwnProperty(Y)&&!S.hasOwnProperty(Y)&&(p.deepEqual(S[Y],E[Y])||T.push({command:W,args:[M,Y,E[Y],B]}))}function $i(S){return S.id}function di(S,E){return S[E.id]=E,S}var vo=function(S,E){this.reset(S,E)};vo.prototype.reset=function(S,E){this.points=S||[],this._distances=[0];for(var T=1;T<this.points.length;T++)this._distances[T]=this._distances[T-1]+this.points[T].dist(this.points[T-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(E||0,.5*this.length),this.paddedLength=this.length-2*this.padding},vo.prototype.lerp=function(S){if(this.points.length===1)return this.points[0];S=p.clamp(S,0,1);for(var E=1,T=this._distances[E],M=S*this.paddedLength+this.padding;T<M&&E<this._distances.length;)T=this._distances[++E];var B=E-1,W=this._distances[B],Y=T-W,re=Y>0?(M-W)/Y:0;return this.points[B].mult(1-re).add(this.points[E].mult(re))};var to=function(S,E,T){var M=this.boxCells=[],B=this.circleCells=[];this.xCellCount=Math.ceil(S/T),this.yCellCount=Math.ceil(E/T);for(var W=0;W<this.xCellCount*this.yCellCount;W++)M.push([]),B.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=S,this.height=E,this.xScale=this.xCellCount/S,this.yScale=this.yCellCount/E,this.boxUid=0,this.circleUid=0};function xo(S,E,T,M,B){var W=p.create();return E?(p.scale(W,W,[1/B,1/B,1]),T||p.rotateZ(W,W,M.angle)):p.multiply(W,M.labelPlaneMatrix,S),W}function so(S,E,T,M,B){if(E){var W=p.clone(S);return p.scale(W,W,[B,B,1]),T||p.rotateZ(W,W,-M.angle),W}return M.glCoordMatrix}function Ni(S,E){var T=[S.x,S.y,0,1];Hn(T,T,E);var M=T[3];return{point:new p.Point(T[0]/M,T[1]/M),signedDistanceFromCamera:M}}function qi(S,E){return .5+S/E*.5}function rs(S,E){var T=S[0]/S[3],M=S[1]/S[3];return T>=-E[0]&&T<=E[0]&&M>=-E[1]&&M<=E[1]}function kl(S,E,T,M,B,W,Y,re){var ye=M?S.textSizeData:S.iconSizeData,Ae=p.evaluateSizeForZoom(ye,T.transform.zoom),Ze=[256/T.width*2+1,256/T.height*2+1],Je=M?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;Je.clear();for(var ke=S.lineVertexArray,ut=M?S.text.placedSymbolArray:S.icon.placedSymbolArray,ht=T.transform.width/T.transform.height,Ct=!1,lt=0;lt<ut.length;lt++){var It=ut.get(lt);if(It.hidden||It.writingMode===p.WritingMode.vertical&&!Ct)po(It.numGlyphs,Je);else{Ct=!1;var Lt=[It.anchorX,It.anchorY,0,1];if(p.transformMat4(Lt,Lt,E),rs(Lt,Ze)){var Jt=qi(T.transform.cameraToCenterDistance,Lt[3]),vr=p.evaluateSizeForFeature(ye,Ae,It),mr=Y?vr/Jt:vr*Jt,wr=new p.Point(It.anchorX,It.anchorY),Ur=Ni(wr,B).point,on={},Hr=Oc(It,mr,!1,re,E,B,W,S.glyphOffsetArray,ke,Je,Ur,wr,on,ht);Ct=Hr.useVertical,(Hr.notEnoughRoom||Ct||Hr.needsFlipping&&Oc(It,mr,!0,re,E,B,W,S.glyphOffsetArray,ke,Je,Ur,wr,on,ht).notEnoughRoom)&&po(It.numGlyphs,Je)}else po(It.numGlyphs,Je)}}M?S.text.dynamicLayoutVertexBuffer.updateData(Je):S.icon.dynamicLayoutVertexBuffer.updateData(Je)}function ga(S,E,T,M,B,W,Y,re,ye,Ae,Ze){var Je=re.glyphStartIndex+re.numGlyphs,ke=re.lineStartIndex,ut=re.lineStartIndex+re.lineLength,ht=E.getoffsetX(re.glyphStartIndex),Ct=E.getoffsetX(Je-1),lt=Qo(S*ht,T,M,B,W,Y,re.segment,ke,ut,ye,Ae,Ze);if(!lt)return null;var It=Qo(S*Ct,T,M,B,W,Y,re.segment,ke,ut,ye,Ae,Ze);return It?{first:lt,last:It}:null}function Ho(S,E,T,M){return S===p.WritingMode.horizontal&&Math.abs(T.y-E.y)>Math.abs(T.x-E.x)*M?{useVertical:!0}:(S===p.WritingMode.vertical?E.y<T.y:E.x>T.x)?{needsFlipping:!0}:null}function Oc(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je,ke,ut){var ht,Ct=E/24,lt=S.lineOffsetX*Ct,It=S.lineOffsetY*Ct;if(S.numGlyphs>1){var Lt=S.glyphStartIndex+S.numGlyphs,Jt=S.lineStartIndex,vr=S.lineStartIndex+S.lineLength,mr=ga(Ct,re,lt,It,T,Ze,Je,S,ye,W,ke);if(!mr)return{notEnoughRoom:!0};var wr=Ni(mr.first.point,Y).point,Ur=Ni(mr.last.point,Y).point;if(M&&!T){var on=Ho(S.writingMode,wr,Ur,ut);if(on)return on}ht=[mr.first];for(var Hr=S.glyphStartIndex+1;Hr<Lt-1;Hr++)ht.push(Qo(Ct*re.getoffsetX(Hr),lt,It,T,Ze,Je,S.segment,Jt,vr,ye,W,ke));ht.push(mr.last)}else{if(M&&!T){var mn=Ni(Je,B).point,Yn=S.lineStartIndex+S.segment+1,ni=new p.Point(ye.getx(Yn),ye.gety(Yn)),Jn=Ni(ni,B),io=Jn.signedDistanceFromCamera>0?Jn.point:Wl(Je,ni,mn,1,B),An=Ho(S.writingMode,mn,io,ut);if(An)return An}var Qn=Qo(Ct*re.getoffsetX(S.glyphStartIndex),lt,It,T,Ze,Je,S.segment,S.lineStartIndex,S.lineStartIndex+S.lineLength,ye,W,ke);if(!Qn)return{notEnoughRoom:!0};ht=[Qn]}for(var $n=0,vi=ht;$n<vi.length;$n+=1){var xi=vi[$n];p.addDynamicAttributes(Ae,xi.point,xi.angle)}return{}}function Wl(S,E,T,M,B){var W=Ni(S.add(S.sub(E)._unit()),B).point,Y=T.sub(W);return T.add(Y._mult(M/Y.mag()))}function Qo(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je){var ke=M?S-E:S+E,ut=ke>0?1:-1,ht=0;M&&(ut*=-1,ht=Math.PI),ut<0&&(ht+=Math.PI);for(var Ct=ut>0?re+Y:re+Y+1,lt=B,It=B,Lt=0,Jt=0,vr=Math.abs(ke),mr=[];Lt+Jt<=vr;){if((Ct+=ut)<re||Ct>=ye)return null;if(It=lt,mr.push(lt),(lt=Je[Ct])===void 0){var wr=new p.Point(Ae.getx(Ct),Ae.gety(Ct)),Ur=Ni(wr,Ze);if(Ur.signedDistanceFromCamera>0)lt=Je[Ct]=Ur.point;else{var on=Ct-ut;lt=Wl(Lt===0?W:new p.Point(Ae.getx(on),Ae.gety(on)),wr,It,vr-Lt+1,Ze)}}Lt+=Jt,Jt=It.dist(lt)}var Hr=(vr-Lt)/Jt,mn=lt.sub(It),Yn=mn.mult(Hr)._add(It);Yn._add(mn._unit()._perp()._mult(T*ut));var ni=ht+Math.atan2(lt.y-It.y,lt.x-It.x);return mr.push(Yn),{point:Yn,angle:ni,path:mr}}to.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},to.prototype.insert=function(S,E,T,M,B){this._forEachCell(E,T,M,B,this._insertBoxCell,this.boxUid++),this.boxKeys.push(S),this.bboxes.push(E),this.bboxes.push(T),this.bboxes.push(M),this.bboxes.push(B)},to.prototype.insertCircle=function(S,E,T,M){this._forEachCell(E-M,T-M,E+M,T+M,this._insertCircleCell,this.circleUid++),this.circleKeys.push(S),this.circles.push(E),this.circles.push(T),this.circles.push(M)},to.prototype._insertBoxCell=function(S,E,T,M,B,W){this.boxCells[B].push(W)},to.prototype._insertCircleCell=function(S,E,T,M,B,W){this.circleCells[B].push(W)},to.prototype._query=function(S,E,T,M,B,W){if(T<0||S>this.width||M<0||E>this.height)return!B&&[];var Y=[];if(S<=0&&E<=0&&this.width<=T&&this.height<=M){if(B)return!0;for(var re=0;re<this.boxKeys.length;re++)Y.push({key:this.boxKeys[re],x1:this.bboxes[4*re],y1:this.bboxes[4*re+1],x2:this.bboxes[4*re+2],y2:this.bboxes[4*re+3]});for(var ye=0;ye<this.circleKeys.length;ye++){var Ae=this.circles[3*ye],Ze=this.circles[3*ye+1],Je=this.circles[3*ye+2];Y.push({key:this.circleKeys[ye],x1:Ae-Je,y1:Ze-Je,x2:Ae+Je,y2:Ze+Je})}return W?Y.filter(W):Y}return this._forEachCell(S,E,T,M,this._queryCell,Y,{hitTest:B,seenUids:{box:{},circle:{}}},W),B?Y.length>0:Y},to.prototype._queryCircle=function(S,E,T,M,B){var W=S-T,Y=S+T,re=E-T,ye=E+T;if(Y<0||W>this.width||ye<0||re>this.height)return!M&&[];var Ae=[];return this._forEachCell(W,re,Y,ye,this._queryCellCircle,Ae,{hitTest:M,circle:{x:S,y:E,radius:T},seenUids:{box:{},circle:{}}},B),M?Ae.length>0:Ae},to.prototype.query=function(S,E,T,M,B){return this._query(S,E,T,M,!1,B)},to.prototype.hitTest=function(S,E,T,M,B){return this._query(S,E,T,M,!0,B)},to.prototype.hitTestCircle=function(S,E,T,M){return this._queryCircle(S,E,T,!0,M)},to.prototype._queryCell=function(S,E,T,M,B,W,Y,re){var ye=Y.seenUids,Ae=this.boxCells[B];if(Ae!==null)for(var Ze=this.bboxes,Je=0,ke=Ae;Je<ke.length;Je+=1){var ut=ke[Je];if(!ye.box[ut]){ye.box[ut]=!0;var ht=4*ut;if(S<=Ze[ht+2]&&E<=Ze[ht+3]&&T>=Ze[ht+0]&&M>=Ze[ht+1]&&(!re||re(this.boxKeys[ut]))){if(Y.hitTest)return W.push(!0),!0;W.push({key:this.boxKeys[ut],x1:Ze[ht],y1:Ze[ht+1],x2:Ze[ht+2],y2:Ze[ht+3]})}}}var Ct=this.circleCells[B];if(Ct!==null)for(var lt=this.circles,It=0,Lt=Ct;It<Lt.length;It+=1){var Jt=Lt[It];if(!ye.circle[Jt]){ye.circle[Jt]=!0;var vr=3*Jt;if(this._circleAndRectCollide(lt[vr],lt[vr+1],lt[vr+2],S,E,T,M)&&(!re||re(this.circleKeys[Jt]))){if(Y.hitTest)return W.push(!0),!0;var mr=lt[vr],wr=lt[vr+1],Ur=lt[vr+2];W.push({key:this.circleKeys[Jt],x1:mr-Ur,y1:wr-Ur,x2:mr+Ur,y2:wr+Ur})}}}},to.prototype._queryCellCircle=function(S,E,T,M,B,W,Y,re){var ye=Y.circle,Ae=Y.seenUids,Ze=this.boxCells[B];if(Ze!==null)for(var Je=this.bboxes,ke=0,ut=Ze;ke<ut.length;ke+=1){var ht=ut[ke];if(!Ae.box[ht]){Ae.box[ht]=!0;var Ct=4*ht;if(this._circleAndRectCollide(ye.x,ye.y,ye.radius,Je[Ct+0],Je[Ct+1],Je[Ct+2],Je[Ct+3])&&(!re||re(this.boxKeys[ht])))return W.push(!0),!0}}var lt=this.circleCells[B];if(lt!==null)for(var It=this.circles,Lt=0,Jt=lt;Lt<Jt.length;Lt+=1){var vr=Jt[Lt];if(!Ae.circle[vr]){Ae.circle[vr]=!0;var mr=3*vr;if(this._circlesCollide(It[mr],It[mr+1],It[mr+2],ye.x,ye.y,ye.radius)&&(!re||re(this.circleKeys[vr])))return W.push(!0),!0}}},to.prototype._forEachCell=function(S,E,T,M,B,W,Y,re){for(var ye=this._convertToXCellCoord(S),Ae=this._convertToYCellCoord(E),Ze=this._convertToXCellCoord(T),Je=this._convertToYCellCoord(M),ke=ye;ke<=Ze;ke++)for(var ut=Ae;ut<=Je;ut++)if(B.call(this,S,E,T,M,this.xCellCount*ut+ke,W,Y,re))return},to.prototype._convertToXCellCoord=function(S){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(S*this.xScale)))},to.prototype._convertToYCellCoord=function(S){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(S*this.yScale)))},to.prototype._circlesCollide=function(S,E,T,M,B,W){var Y=M-S,re=B-E,ye=T+W;return ye*ye>Y*Y+re*re},to.prototype._circleAndRectCollide=function(S,E,T,M,B,W,Y){var re=(W-M)/2,ye=Math.abs(S-(M+re));if(ye>re+T)return!1;var Ae=(Y-B)/2,Ze=Math.abs(E-(B+Ae));if(Ze>Ae+T)return!1;if(ye<=re||Ze<=Ae)return!0;var Je=ye-re,ke=Ze-Ae;return Je*Je+ke*ke<=T*T};var Va=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function po(S,E){for(var T=0;T<S;T++){var M=E.length;E.resize(M+4),E.float32.set(Va,3*M)}}function Hn(S,E,T){var M=E[0],B=E[1];return S[0]=T[0]*M+T[4]*B+T[12],S[1]=T[1]*M+T[5]*B+T[13],S[3]=T[3]*M+T[7]*B+T[15],S}var Ra=function(S,E,T){E===void 0&&(E=new to(S.width+200,S.height+200,25)),T===void 0&&(T=new to(S.width+200,S.height+200,25)),this.transform=S,this.grid=E,this.ignoredGrid=T,this.pitchfactor=Math.cos(S._pitch)*S.cameraToCenterDistance,this.screenRightBoundary=S.width+100,this.screenBottomBoundary=S.height+100,this.gridRightBoundary=S.width+200,this.gridBottomBoundary=S.height+200};function Uo(S,E,T){return E*(p.EXTENT/(S.tileSize*Math.pow(2,T-S.tileID.overscaledZ)))}Ra.prototype.placeCollisionBox=function(S,E,T,M,B){var W=this.projectAndGetPerspectiveRatio(M,S.anchorPointX,S.anchorPointY),Y=T*W.perspectiveRatio,re=S.x1*Y+W.point.x,ye=S.y1*Y+W.point.y,Ae=S.x2*Y+W.point.x,Ze=S.y2*Y+W.point.y;return!this.isInsideGrid(re,ye,Ae,Ze)||!E&&this.grid.hitTest(re,ye,Ae,Ze,B)?{box:[],offscreen:!1}:{box:[re,ye,Ae,Ze],offscreen:this.isOffscreen(re,ye,Ae,Ze)}},Ra.prototype.placeCollisionCircles=function(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je,ke){var ut=[],ht=new p.Point(E.anchorX,E.anchorY),Ct=Ni(ht,W),lt=qi(this.transform.cameraToCenterDistance,Ct.signedDistanceFromCamera),It=(Ae?B/lt:B*lt)/p.ONE_EM,Lt=Ni(ht,Y).point,Jt=ga(It,M,E.lineOffsetX*It,E.lineOffsetY*It,!1,Lt,ht,E,T,Y,{}),vr=!1,mr=!1,wr=!0;if(Jt){for(var Ur=.5*Je*lt+ke,on=new p.Point(-100,-100),Hr=new p.Point(this.screenRightBoundary,this.screenBottomBoundary),mn=new vo,Yn=Jt.first,ni=Jt.last,Jn=[],io=Yn.path.length-1;io>=1;io--)Jn.push(Yn.path[io]);for(var An=1;An<ni.path.length;An++)Jn.push(ni.path[An]);var Qn=2.5*Ur;if(re){var $n=Jn.map(function(Pa){return Ni(Pa,re)});Jn=$n.some(function(Pa){return Pa.signedDistanceFromCamera<=0})?[]:$n.map(function(Pa){return Pa.point})}var vi=[];if(Jn.length>0){for(var xi=Jn[0].clone(),Ii=Jn[0].clone(),yi=1;yi<Jn.length;yi++)xi.x=Math.min(xi.x,Jn[yi].x),xi.y=Math.min(xi.y,Jn[yi].y),Ii.x=Math.max(Ii.x,Jn[yi].x),Ii.y=Math.max(Ii.y,Jn[yi].y);vi=xi.x>=on.x&&Ii.x<=Hr.x&&xi.y>=on.y&&Ii.y<=Hr.y?[Jn]:Ii.x<on.x||xi.x>Hr.x||Ii.y<on.y||xi.y>Hr.y?[]:p.clipLine([Jn],on.x,on.y,Hr.x,Hr.y)}for(var ii=0,is=vi;ii<is.length;ii+=1){var ra;mn.reset(is[ii],.25*Ur),ra=mn.length<=.5*Ur?1:Math.ceil(mn.paddedLength/Qn)+1;for(var Ka=0;Ka<ra;Ka++){var Dr=Ka/Math.max(ra-1,1),an=mn.lerp(Dr),na=an.x+100,go=an.y+100;ut.push(na,go,Ur,0);var os=na-Ur,rc=go-Ur,jt=na+Ur,jl=go+Ur;if(wr=wr&&this.isOffscreen(os,rc,jt,jl),mr=mr||this.isInsideGrid(os,rc,jt,jl),!S&&this.grid.hitTestCircle(na,go,Ur,Ze)&&(vr=!0,!ye))return{circles:[],offscreen:!1,collisionDetected:vr}}}}return{circles:!ye&&vr||!mr?[]:ut,offscreen:wr,collisionDetected:vr}},Ra.prototype.queryRenderedSymbols=function(S){if(S.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var E=[],T=1/0,M=1/0,B=-1/0,W=-1/0,Y=0,re=S;Y<re.length;Y+=1){var ye=re[Y],Ae=new p.Point(ye.x+100,ye.y+100);T=Math.min(T,Ae.x),M=Math.min(M,Ae.y),B=Math.max(B,Ae.x),W=Math.max(W,Ae.y),E.push(Ae)}for(var Ze={},Je={},ke=0,ut=this.grid.query(T,M,B,W).concat(this.ignoredGrid.query(T,M,B,W));ke<ut.length;ke+=1){var ht=ut[ke],Ct=ht.key;if(Ze[Ct.bucketInstanceId]===void 0&&(Ze[Ct.bucketInstanceId]={}),!Ze[Ct.bucketInstanceId][Ct.featureIndex]){var lt=[new p.Point(ht.x1,ht.y1),new p.Point(ht.x2,ht.y1),new p.Point(ht.x2,ht.y2),new p.Point(ht.x1,ht.y2)];p.polygonIntersectsPolygon(E,lt)&&(Ze[Ct.bucketInstanceId][Ct.featureIndex]=!0,Je[Ct.bucketInstanceId]===void 0&&(Je[Ct.bucketInstanceId]=[]),Je[Ct.bucketInstanceId].push(Ct.featureIndex))}}return Je},Ra.prototype.insertCollisionBox=function(S,E,T,M,B){(E?this.ignoredGrid:this.grid).insert({bucketInstanceId:T,featureIndex:M,collisionGroupID:B},S[0],S[1],S[2],S[3])},Ra.prototype.insertCollisionCircles=function(S,E,T,M,B){for(var W=E?this.ignoredGrid:this.grid,Y={bucketInstanceId:T,featureIndex:M,collisionGroupID:B},re=0;re<S.length;re+=4)W.insertCircle(Y,S[re],S[re+1],S[re+2])},Ra.prototype.projectAndGetPerspectiveRatio=function(S,E,T){var M=[E,T,0,1];return Hn(M,M,S),{point:new p.Point((M[0]/M[3]+1)/2*this.transform.width+100,(-M[1]/M[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}},Ra.prototype.isOffscreen=function(S,E,T,M){return T<100||S>=this.screenRightBoundary||M<100||E>this.screenBottomBoundary},Ra.prototype.isInsideGrid=function(S,E,T,M){return T>=0&&S<this.gridRightBoundary&&M>=0&&E<this.gridBottomBoundary},Ra.prototype.getViewportMatrix=function(){var S=p.identity([]);return p.translate(S,S,[-100,-100,0]),S};var Gs=function(S,E,T,M){this.opacity=S?Math.max(0,Math.min(1,S.opacity+(S.placed?E:-E))):M&&T?1:0,this.placed=T};Gs.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Os=function(S,E,T,M,B){this.text=new Gs(S?S.text:null,E,T,B),this.icon=new Gs(S?S.icon:null,E,M,B)};Os.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var _l=function(S,E,T){this.text=S,this.icon=E,this.skipFade=T},qs=function(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]},zf=function(S,E,T,M,B){this.bucketInstanceId=S,this.featureIndex=E,this.sourceLayerIndex=T,this.bucketIndex=M,this.tileID=B},He=function(S){this.crossSourceCollisions=S,this.maxGroupID=0,this.collisionGroups={}};function Oe(S,E,T,M,B){var W=p.getAnchorAlignment(S),Y=-(W.horizontalAlign-.5)*E,re=-(W.verticalAlign-.5)*T,ye=p.evaluateVariableOffset(S,M);return new p.Point(Y+ye[0]*B,re+ye[1]*B)}function ft(S,E,T,M,B,W){var Y=S.x1,re=S.x2,ye=S.y1,Ae=S.y2,Ze=S.anchorPointX,Je=S.anchorPointY,ke=new p.Point(E,T);return M&&ke._rotate(B?W:-W),{x1:Y+ke.x,y1:ye+ke.y,x2:re+ke.x,y2:Ae+ke.y,anchorPointX:Ze,anchorPointY:Je}}He.prototype.get=function(S){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[S]){var E=++this.maxGroupID;this.collisionGroups[S]={ID:E,predicate:function(T){return T.collisionGroupID===E}}}return this.collisionGroups[S]};var Vt=function(S,E,T,M){this.transform=S.clone(),this.collisionIndex=new Ra(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=E,this.retainedQueryData={},this.collisionGroups=new He(T),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}};function Xr(S,E,T,M,B){S.emplaceBack(E?1:0,T?1:0,M||0,B||0),S.emplaceBack(E?1:0,T?1:0,M||0,B||0),S.emplaceBack(E?1:0,T?1:0,M||0,B||0),S.emplaceBack(E?1:0,T?1:0,M||0,B||0)}Vt.prototype.getBucketParts=function(S,E,T,M){var B=T.getBucket(E),W=T.latestFeatureIndex;if(B&&W&&E.id===B.layerIds[0]){var Y=T.collisionBoxArray,re=B.layers[0].layout,ye=Math.pow(2,this.transform.zoom-T.tileID.overscaledZ),Ae=T.tileSize/p.EXTENT,Ze=this.transform.calculatePosMatrix(T.tileID.toUnwrapped()),Je=re.get("text-pitch-alignment")==="map",ke=re.get("text-rotation-alignment")==="map",ut=Uo(T,1,this.transform.zoom),ht=xo(Ze,Je,ke,this.transform,ut),Ct=null;if(Je){var lt=so(Ze,Je,ke,this.transform,ut);Ct=p.multiply([],this.transform.labelPlaneMatrix,lt)}this.retainedQueryData[B.bucketInstanceId]=new zf(B.bucketInstanceId,W,B.sourceLayerIndex,B.index,T.tileID);var It={bucket:B,layout:re,posMatrix:Ze,textLabelPlaneMatrix:ht,labelToScreenMatrix:Ct,scale:ye,textPixelRatio:Ae,holdingForFade:T.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(B.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(B.sourceID)};if(M)for(var Lt=0,Jt=B.sortKeyRanges;Lt<Jt.length;Lt+=1){var vr=Jt[Lt];S.push({sortKey:vr.sortKey,symbolInstanceStart:vr.symbolInstanceStart,symbolInstanceEnd:vr.symbolInstanceEnd,parameters:It})}else S.push({symbolInstanceStart:0,symbolInstanceEnd:B.symbolInstances.length,parameters:It})}},Vt.prototype.attemptAnchorPlacement=function(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je,ke,ut,ht){var Ct,lt=[Je.textOffset0,Je.textOffset1],It=Oe(S,T,M,lt,B),Lt=this.collisionIndex.placeCollisionBox(ft(E,It.x,It.y,W,Y,this.transform.angle),Ze,re,ye,Ae.predicate);if(!ht||this.collisionIndex.placeCollisionBox(ft(ht,It.x,It.y,W,Y,this.transform.angle),Ze,re,ye,Ae.predicate).box.length!==0)return Lt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID]&&this.prevPlacement.placements[Je.crossTileID].text&&(Ct=this.prevPlacement.variableOffsets[Je.crossTileID].anchor),this.variableOffsets[Je.crossTileID]={textOffset:lt,width:T,height:M,anchor:S,textBoxScale:B,prevAnchor:Ct},this.markUsedJustification(ke,S,Je,ut),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,ut,Je),this.placedOrientations[Je.crossTileID]=ut),{shift:It,placedGlyphBoxes:Lt}):void 0},Vt.prototype.placeLayerBucketPart=function(S,E,T){var M=this,B=S.parameters,W=B.bucket,Y=B.layout,re=B.posMatrix,ye=B.textLabelPlaneMatrix,Ae=B.labelToScreenMatrix,Ze=B.textPixelRatio,Je=B.holdingForFade,ke=B.collisionBoxArray,ut=B.partiallyEvaluatedTextSize,ht=B.collisionGroup,Ct=Y.get("text-optional"),lt=Y.get("icon-optional"),It=Y.get("text-allow-overlap"),Lt=Y.get("icon-allow-overlap"),Jt=Y.get("text-rotation-alignment")==="map",vr=Y.get("text-pitch-alignment")==="map",mr=Y.get("icon-text-fit")!=="none",wr=Y.get("symbol-z-order")==="viewport-y",Ur=It&&(Lt||!W.hasIconData()||lt),on=Lt&&(It||!W.hasTextData()||Ct);!W.collisionArrays&&ke&&W.deserializeCollisionBoxes(ke);var Hr=function(An,Qn){if(!E[An.crossTileID])if(Je)M.placements[An.crossTileID]=new _l(!1,!1,!1);else{var $n,vi=!1,xi=!1,Ii=!0,yi=null,ii={box:null,offscreen:null},is={box:null,offscreen:null},ra=null,Ka=null,Dr=0,an=0,na=0;Qn.textFeatureIndex?Dr=Qn.textFeatureIndex:An.useRuntimeCollisionCircles&&(Dr=An.featureIndex),Qn.verticalTextFeatureIndex&&(an=Qn.verticalTextFeatureIndex);var go=Qn.textBox;if(go){var os=function(Co){var Ns=p.WritingMode.horizontal;if(W.allowVerticalPlacement&&!Co&&M.prevPlacement){var ia=M.prevPlacement.placedOrientations[An.crossTileID];ia&&(M.placedOrientations[An.crossTileID]=ia,M.markUsedOrientation(W,Ns=ia,An))}return Ns},rc=function(Co,Ns){if(W.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&Qn.verticalTextBox)for(var ia=0,Ph=W.writingModes;ia<Ph.length&&(Ph[ia]===p.WritingMode.vertical?(ii=Ns(),is=ii):ii=Co(),!(ii&&ii.box&&ii.box.length));ia+=1);else ii=Co()};if(Y.get("text-variable-anchor")){var jt=Y.get("text-variable-anchor");if(M.prevPlacement&&M.prevPlacement.variableOffsets[An.crossTileID]){var jl=M.prevPlacement.variableOffsets[An.crossTileID];jt.indexOf(jl.anchor)>0&&(jt=jt.filter(function(Co){return Co!==jl.anchor})).unshift(jl.anchor)}var Pa=function(Co,Ns,ia){for(var Ph=Co.x2-Co.x1,tf=Co.y2-Co.y1,jo=An.textBoxScale,bo=mr&&!Lt?Ns:null,xu={box:[],offscreen:!1},ic=It?2*jt.length:jt.length,as=0;as<ic;++as){var oc=M.attemptAnchorPlacement(jt[as%jt.length],Co,Ph,tf,jo,Jt,vr,Ze,re,ht,as>=jt.length,An,W,ia,bo);if(oc&&(xu=oc.placedGlyphBoxes)&&xu.box&&xu.box.length){vi=!0,yi=oc.shift;break}}return xu};rc(function(){return Pa(go,Qn.iconBox,p.WritingMode.horizontal)},function(){var Co=Qn.verticalTextBox;return W.allowVerticalPlacement&&!(ii&&ii.box&&ii.box.length)&&An.numVerticalGlyphVertices>0&&Co?Pa(Co,Qn.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null}}),ii&&(vi=ii.box,Ii=ii.offscreen);var wd=os(ii&&ii.box);if(!vi&&M.prevPlacement){var Ku=M.prevPlacement.variableOffsets[An.crossTileID];Ku&&(M.variableOffsets[An.crossTileID]=Ku,M.markUsedJustification(W,Ku.anchor,An,wd))}}else{var Bl=function(Co,Ns){var ia=M.collisionIndex.placeCollisionBox(Co,It,Ze,re,ht.predicate);return ia&&ia.box&&ia.box.length&&(M.markUsedOrientation(W,Ns,An),M.placedOrientations[An.crossTileID]=Ns),ia};rc(function(){return Bl(go,p.WritingMode.horizontal)},function(){var Co=Qn.verticalTextBox;return W.allowVerticalPlacement&&An.numVerticalGlyphVertices>0&&Co?Bl(Co,p.WritingMode.vertical):{box:null,offscreen:null}}),os(ii&&ii.box&&ii.box.length)}}if(vi=($n=ii)&&$n.box&&$n.box.length>0,Ii=$n&&$n.offscreen,An.useRuntimeCollisionCircles){var Sd=W.text.placedSymbolArray.get(An.centerJustifiedTextSymbolIndex),fp=p.evaluateSizeForFeature(W.textSizeData,ut,Sd),bc=Y.get("text-padding");ra=M.collisionIndex.placeCollisionCircles(It,Sd,W.lineVertexArray,W.glyphOffsetArray,fp,re,ye,Ae,T,vr,ht.predicate,An.collisionCircleDiameter,bc),vi=It||ra.circles.length>0&&!ra.collisionDetected,Ii=Ii&&ra.offscreen}if(Qn.iconFeatureIndex&&(na=Qn.iconFeatureIndex),Qn.iconBox){var vu=function(Co){var Ns=mr&&yi?ft(Co,yi.x,yi.y,Jt,vr,M.transform.angle):Co;return M.collisionIndex.placeCollisionBox(Ns,Lt,Ze,re,ht.predicate)};xi=is&&is.box&&is.box.length&&Qn.verticalIconBox?(Ka=vu(Qn.verticalIconBox)).box.length>0:(Ka=vu(Qn.iconBox)).box.length>0,Ii=Ii&&Ka.offscreen}var wl=Ct||An.numHorizontalGlyphVertices===0&&An.numVerticalGlyphVertices===0,qa=lt||An.numIconVertices===0;if(wl||qa?qa?wl||(xi=xi&&vi):vi=xi&&vi:xi=vi=xi&&vi,vi&&$n&&$n.box&&M.collisionIndex.insertCollisionBox($n.box,Y.get("text-ignore-placement"),W.bucketInstanceId,is&&is.box&&an?an:Dr,ht.ID),xi&&Ka&&M.collisionIndex.insertCollisionBox(Ka.box,Y.get("icon-ignore-placement"),W.bucketInstanceId,na,ht.ID),ra&&(vi&&M.collisionIndex.insertCollisionCircles(ra.circles,Y.get("text-ignore-placement"),W.bucketInstanceId,Dr,ht.ID),T)){var Fc=W.bucketInstanceId,nc=M.collisionCircleArrays[Fc];nc===void 0&&(nc=M.collisionCircleArrays[Fc]=new qs);for(var Vc=0;Vc<ra.circles.length;Vc+=4)nc.circles.push(ra.circles[Vc+0]),nc.circles.push(ra.circles[Vc+1]),nc.circles.push(ra.circles[Vc+2]),nc.circles.push(ra.collisionDetected?1:0)}M.placements[An.crossTileID]=new _l(vi||Ur,xi||on,Ii||W.justReloaded),E[An.crossTileID]=!0}};if(wr)for(var mn=W.getSortedSymbolIndexes(this.transform.angle),Yn=mn.length-1;Yn>=0;--Yn){var ni=mn[Yn];Hr(W.symbolInstances.get(ni),W.collisionArrays[ni])}else for(var Jn=S.symbolInstanceStart;Jn<S.symbolInstanceEnd;Jn++)Hr(W.symbolInstances.get(Jn),W.collisionArrays[Jn]);if(T&&W.bucketInstanceId in this.collisionCircleArrays){var io=this.collisionCircleArrays[W.bucketInstanceId];p.invert(io.invProjMatrix,re),io.viewportMatrix=this.collisionIndex.getViewportMatrix()}W.justReloaded=!1},Vt.prototype.markUsedJustification=function(S,E,T,M){var B;B=M===p.WritingMode.vertical?T.verticalPlacedTextSymbolIndex:{left:T.leftJustifiedTextSymbolIndex,center:T.centerJustifiedTextSymbolIndex,right:T.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(E)];for(var W=0,Y=[T.leftJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.rightJustifiedTextSymbolIndex,T.verticalPlacedTextSymbolIndex];W<Y.length;W+=1){var re=Y[W];re>=0&&(S.text.placedSymbolArray.get(re).crossTileID=B>=0&&re!==B?0:T.crossTileID)}},Vt.prototype.markUsedOrientation=function(S,E,T){for(var M=E===p.WritingMode.horizontal||E===p.WritingMode.horizontalOnly?E:0,B=E===p.WritingMode.vertical?E:0,W=0,Y=[T.leftJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.rightJustifiedTextSymbolIndex];W<Y.length;W+=1)S.text.placedSymbolArray.get(Y[W]).placedOrientation=M;T.verticalPlacedTextSymbolIndex&&(S.text.placedSymbolArray.get(T.verticalPlacedTextSymbolIndex).placedOrientation=B)},Vt.prototype.commit=function(S){this.commitTime=S,this.zoomAtLastRecencyCheck=this.transform.zoom;var E=this.prevPlacement,T=!1;this.prevZoomAdjustment=E?E.zoomAdjustment(this.transform.zoom):0;var M=E?E.symbolFadeChange(S):1,B=E?E.opacities:{},W=E?E.variableOffsets:{},Y=E?E.placedOrientations:{};for(var re in this.placements){var ye=this.placements[re],Ae=B[re];Ae?(this.opacities[re]=new Os(Ae,M,ye.text,ye.icon),T=T||ye.text!==Ae.text.placed||ye.icon!==Ae.icon.placed):(this.opacities[re]=new Os(null,M,ye.text,ye.icon,ye.skipFade),T=T||ye.text||ye.icon)}for(var Ze in B){var Je=B[Ze];if(!this.opacities[Ze]){var ke=new Os(Je,M,!1,!1);ke.isHidden()||(this.opacities[Ze]=ke,T=T||Je.text.placed||Je.icon.placed)}}for(var ut in W)this.variableOffsets[ut]||!this.opacities[ut]||this.opacities[ut].isHidden()||(this.variableOffsets[ut]=W[ut]);for(var ht in Y)this.placedOrientations[ht]||!this.opacities[ht]||this.opacities[ht].isHidden()||(this.placedOrientations[ht]=Y[ht]);T?this.lastPlacementChangeTime=S:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=E?E.lastPlacementChangeTime:S)},Vt.prototype.updateLayerOpacities=function(S,E){for(var T={},M=0,B=E;M<B.length;M+=1){var W=B[M],Y=W.getBucket(S);Y&&W.latestFeatureIndex&&S.id===Y.layerIds[0]&&this.updateBucketOpacities(Y,T,W.collisionBoxArray)}},Vt.prototype.updateBucketOpacities=function(S,E,T){var M=this;S.hasTextData()&&S.text.opacityVertexArray.clear(),S.hasIconData()&&S.icon.opacityVertexArray.clear(),S.hasIconCollisionBoxData()&&S.iconCollisionBox.collisionVertexArray.clear(),S.hasTextCollisionBoxData()&&S.textCollisionBox.collisionVertexArray.clear();var B=S.layers[0].layout,W=new Os(null,0,!1,!1,!0),Y=B.get("text-allow-overlap"),re=B.get("icon-allow-overlap"),ye=B.get("text-variable-anchor"),Ae=B.get("text-rotation-alignment")==="map",Ze=B.get("text-pitch-alignment")==="map",Je=B.get("icon-text-fit")!=="none",ke=new Os(null,0,Y&&(re||!S.hasIconData()||B.get("icon-optional")),re&&(Y||!S.hasTextData()||B.get("text-optional")),!0);!S.collisionArrays&&T&&(S.hasIconCollisionBoxData()||S.hasTextCollisionBoxData())&&S.deserializeCollisionBoxes(T);for(var ut=function(It,Lt,Jt){for(var vr=0;vr<Lt/4;vr++)It.opacityVertexArray.emplaceBack(Jt)},ht=function(It){var Lt=S.symbolInstances.get(It),Jt=Lt.numHorizontalGlyphVertices,vr=Lt.numVerticalGlyphVertices,mr=Lt.crossTileID,wr=M.opacities[mr];E[mr]?wr=W:wr||(M.opacities[mr]=wr=ke),E[mr]=!0;var Ur=Lt.numIconVertices>0,on=M.placedOrientations[Lt.crossTileID],Hr=on===p.WritingMode.vertical,mn=on===p.WritingMode.horizontal||on===p.WritingMode.horizontalOnly;if(Jt>0||vr>0){var Yn=Un(wr.text);ut(S.text,Jt,Hr?Hl:Yn),ut(S.text,vr,mn?Hl:Yn);var ni=wr.text.isHidden();[Lt.rightJustifiedTextSymbolIndex,Lt.centerJustifiedTextSymbolIndex,Lt.leftJustifiedTextSymbolIndex].forEach(function(ii){ii>=0&&(S.text.placedSymbolArray.get(ii).hidden=ni||Hr?1:0)}),Lt.verticalPlacedTextSymbolIndex>=0&&(S.text.placedSymbolArray.get(Lt.verticalPlacedTextSymbolIndex).hidden=ni||mn?1:0);var Jn=M.variableOffsets[Lt.crossTileID];Jn&&M.markUsedJustification(S,Jn.anchor,Lt,on);var io=M.placedOrientations[Lt.crossTileID];io&&(M.markUsedJustification(S,"left",Lt,io),M.markUsedOrientation(S,io,Lt))}if(Ur){var An=Un(wr.icon),Qn=!(Je&&Lt.verticalPlacedIconSymbolIndex&&Hr);Lt.placedIconSymbolIndex>=0&&(ut(S.icon,Lt.numIconVertices,Qn?An:Hl),S.icon.placedSymbolArray.get(Lt.placedIconSymbolIndex).hidden=wr.icon.isHidden()),Lt.verticalPlacedIconSymbolIndex>=0&&(ut(S.icon,Lt.numVerticalIconVertices,Qn?Hl:An),S.icon.placedSymbolArray.get(Lt.verticalPlacedIconSymbolIndex).hidden=wr.icon.isHidden())}if(S.hasIconCollisionBoxData()||S.hasTextCollisionBoxData()){var $n=S.collisionArrays[It];if($n){var vi=new p.Point(0,0);if($n.textBox||$n.verticalTextBox){var xi=!0;if(ye){var Ii=M.variableOffsets[mr];Ii?(vi=Oe(Ii.anchor,Ii.width,Ii.height,Ii.textOffset,Ii.textBoxScale),Ae&&vi._rotate(Ze?M.transform.angle:-M.transform.angle)):xi=!1}$n.textBox&&Xr(S.textCollisionBox.collisionVertexArray,wr.text.placed,!xi||Hr,vi.x,vi.y),$n.verticalTextBox&&Xr(S.textCollisionBox.collisionVertexArray,wr.text.placed,!xi||mn,vi.x,vi.y)}var yi=!!(!mn&&$n.verticalIconBox);$n.iconBox&&Xr(S.iconCollisionBox.collisionVertexArray,wr.icon.placed,yi,Je?vi.x:0,Je?vi.y:0),$n.verticalIconBox&&Xr(S.iconCollisionBox.collisionVertexArray,wr.icon.placed,!yi,Je?vi.x:0,Je?vi.y:0)}}},Ct=0;Ct<S.symbolInstances.length;Ct++)ht(Ct);if(S.sortFeatures(this.transform.angle),this.retainedQueryData[S.bucketInstanceId]&&(this.retainedQueryData[S.bucketInstanceId].featureSortOrder=S.featureSortOrder),S.hasTextData()&&S.text.opacityVertexBuffer&&S.text.opacityVertexBuffer.updateData(S.text.opacityVertexArray),S.hasIconData()&&S.icon.opacityVertexBuffer&&S.icon.opacityVertexBuffer.updateData(S.icon.opacityVertexArray),S.hasIconCollisionBoxData()&&S.iconCollisionBox.collisionVertexBuffer&&S.iconCollisionBox.collisionVertexBuffer.updateData(S.iconCollisionBox.collisionVertexArray),S.hasTextCollisionBoxData()&&S.textCollisionBox.collisionVertexBuffer&&S.textCollisionBox.collisionVertexBuffer.updateData(S.textCollisionBox.collisionVertexArray),S.bucketInstanceId in this.collisionCircleArrays){var lt=this.collisionCircleArrays[S.bucketInstanceId];S.placementInvProjMatrix=lt.invProjMatrix,S.placementViewportMatrix=lt.viewportMatrix,S.collisionCircleArray=lt.circles,delete this.collisionCircleArrays[S.bucketInstanceId]}},Vt.prototype.symbolFadeChange=function(S){return this.fadeDuration===0?1:(S-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Vt.prototype.zoomAdjustment=function(S){return Math.max(0,(this.transform.zoom-S)/1.5)},Vt.prototype.hasTransitions=function(S){return this.stale||S-this.lastPlacementChangeTime<this.fadeDuration},Vt.prototype.stillRecent=function(S,E){var T=this.zoomAtLastRecencyCheck===E?1-this.zoomAdjustment(E):1;return this.zoomAtLastRecencyCheck=E,this.commitTime+this.fadeDuration*T>S},Vt.prototype.setStale=function(){this.stale=!0};var Gn=Math.pow(2,25),kn=Math.pow(2,24),_a=Math.pow(2,17),Ca=Math.pow(2,16),Ua=Math.pow(2,9),ya=Math.pow(2,8),va=Math.pow(2,1);function Un(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;var E=S.placed?1:0,T=Math.floor(127*S.opacity);return T*Gn+E*kn+T*_a+E*Ca+T*Ua+E*ya+T*va+E}var Hl=0,ui=function(S){this._sortAcrossTiles=S.layout.get("symbol-z-order")!=="viewport-y"&&S.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ui.prototype.continuePlacement=function(S,E,T,M,B){for(var W=this._bucketParts;this._currentTileIndex<S.length;)if(E.getBucketParts(W,M,S[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,B())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,W.sort(function(Y,re){return Y.sortKey-re.sortKey}));this._currentPartIndex<W.length;)if(E.placeLayerBucketPart(W[this._currentPartIndex],this._seenCrossTileIDs,T),this._currentPartIndex++,B())return!0;return!1};var Zl=function(S,E,T,M,B,W,Y){this.placement=new Vt(S,B,W,Y),this._currentPlacementIndex=E.length-1,this._forceFullPlacement=T,this._showCollisionBoxes=M,this._done=!1};Zl.prototype.isDone=function(){return this._done},Zl.prototype.continuePlacement=function(S,E,T){for(var M=this,B=p.browser.now(),W=function(){var ye=p.browser.now()-B;return!M._forceFullPlacement&&ye>2};this._currentPlacementIndex>=0;){var Y=E[S[this._currentPlacementIndex]],re=this.placement.collisionIndex.transform.zoom;if(Y.type==="symbol"&&(!Y.minzoom||Y.minzoom<=re)&&(!Y.maxzoom||Y.maxzoom>re)){if(this._inProgressLayer||(this._inProgressLayer=new ui(Y)),this._inProgressLayer.continuePlacement(T[Y.source],this.placement,this._showCollisionBoxes,Y,W))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Zl.prototype.commit=function(S){return this.placement.commit(S),this.placement};var Fi=512/p.EXTENT/2,tu=function(S,E,T){this.tileID=S,this.indexedSymbolInstances={},this.bucketInstanceId=T;for(var M=0;M<E.length;M++){var B=E.get(M),W=B.key;this.indexedSymbolInstances[W]||(this.indexedSymbolInstances[W]=[]),this.indexedSymbolInstances[W].push({crossTileID:B.crossTileID,coord:this.getScaledCoordinates(B,S)})}};tu.prototype.getScaledCoordinates=function(S,E){var T=Fi/Math.pow(2,E.canonical.z-this.tileID.canonical.z);return{x:Math.floor((E.canonical.x*p.EXTENT+S.anchorX)*T),y:Math.floor((E.canonical.y*p.EXTENT+S.anchorY)*T)}},tu.prototype.findMatches=function(S,E,T){for(var M=this.tileID.canonical.z<E.canonical.z?1:Math.pow(2,this.tileID.canonical.z-E.canonical.z),B=0;B<S.length;B++){var W=S.get(B);if(!W.crossTileID){var Y=this.indexedSymbolInstances[W.key];if(Y)for(var re=this.getScaledCoordinates(W,E),ye=0,Ae=Y;ye<Ae.length;ye+=1){var Ze=Ae[ye];if(Math.abs(Ze.coord.x-re.x)<=M&&Math.abs(Ze.coord.y-re.y)<=M&&!T[Ze.crossTileID]){T[Ze.crossTileID]=!0,W.crossTileID=Ze.crossTileID;break}}}}};var ea=function(){this.maxCrossTileID=0};ea.prototype.generate=function(){return++this.maxCrossTileID};var Dn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Dn.prototype.handleWrapJump=function(S){var E=Math.round((S-this.lng)/360);if(E!==0)for(var T in this.indexes){var M=this.indexes[T],B={};for(var W in M){var Y=M[W];Y.tileID=Y.tileID.unwrapTo(Y.tileID.wrap+E),B[Y.tileID.key]=Y}this.indexes[T]=B}this.lng=S},Dn.prototype.addBucket=function(S,E,T){if(this.indexes[S.overscaledZ]&&this.indexes[S.overscaledZ][S.key]){if(this.indexes[S.overscaledZ][S.key].bucketInstanceId===E.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(S.overscaledZ,this.indexes[S.overscaledZ][S.key])}for(var M=0;M<E.symbolInstances.length;M++)E.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[S.overscaledZ]||(this.usedCrossTileIDs[S.overscaledZ]={});var B=this.usedCrossTileIDs[S.overscaledZ];for(var W in this.indexes){var Y=this.indexes[W];if(Number(W)>S.overscaledZ)for(var re in Y){var ye=Y[re];ye.tileID.isChildOf(S)&&ye.findMatches(E.symbolInstances,S,B)}else{var Ae=Y[S.scaledTo(Number(W)).key];Ae&&Ae.findMatches(E.symbolInstances,S,B)}}for(var Ze=0;Ze<E.symbolInstances.length;Ze++){var Je=E.symbolInstances.get(Ze);Je.crossTileID||(Je.crossTileID=T.generate(),B[Je.crossTileID]=!0)}return this.indexes[S.overscaledZ]===void 0&&(this.indexes[S.overscaledZ]={}),this.indexes[S.overscaledZ][S.key]=new tu(S,E.symbolInstances,E.bucketInstanceId),!0},Dn.prototype.removeBucketCrossTileIDs=function(S,E){for(var T in E.indexedSymbolInstances)for(var M=0,B=E.indexedSymbolInstances[T];M<B.length;M+=1)delete this.usedCrossTileIDs[S][B[M].crossTileID]},Dn.prototype.removeStaleBuckets=function(S){var E=!1;for(var T in this.indexes){var M=this.indexes[T];for(var B in M)S[M[B].bucketInstanceId]||(this.removeBucketCrossTileIDs(T,M[B]),delete M[B],E=!0)}return E};var ru=function(){this.layerIndexes={},this.crossTileIDs=new ea,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ru.prototype.addLayer=function(S,E,T){var M=this.layerIndexes[S.id];M===void 0&&(M=this.layerIndexes[S.id]=new Dn);var B=!1,W={};M.handleWrapJump(T);for(var Y=0,re=E;Y<re.length;Y+=1){var ye=re[Y],Ae=ye.getBucket(S);Ae&&S.id===Ae.layerIds[0]&&(Ae.bucketInstanceId||(Ae.bucketInstanceId=++this.maxBucketInstanceId),M.addBucket(ye.tileID,Ae,this.crossTileIDs)&&(B=!0),W[Ae.bucketInstanceId]=!0)}return M.removeStaleBuckets(W)&&(B=!0),B},ru.prototype.pruneUnusedLayers=function(S){var E={};for(var T in S.forEach(function(M){E[M]=!0}),this.layerIndexes)E[T]||delete this.layerIndexes[T]};var Rl=function(S,E){return p.emitValidationErrors(S,E&&E.filter(function(T){return T.identifier!=="source.canvas"}))},ta=p.pick(Nr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ms=p.pick(Nr,["setCenter","setZoom","setBearing","setPitch"]),hc=function(){var S={},E=p.styleSpec.$version;for(var T in p.styleSpec.$root){var M,B=p.styleSpec.$root[T];B.required&&(M=T==="version"?E:B.type==="array"?[]:{})!=null&&(S[T]=M)}return S}(),$a=function(S){function E(T,M){var B=this;M===void 0&&(M={}),S.call(this),this.map=T,this.dispatcher=new mt(Nt(),this),this.imageManager=new ce,this.imageManager.setEventedParent(this),this.glyphManager=new _t(T._requestManager,M.localIdeographFontFamily),this.lineAtlas=new Ar(256,512),this.crossTileSymbolIndex=new ru,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());var W=this;this._rtlTextPluginCallback=E.registerForPluginStateChange(function(Y){W.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Y.pluginStatus,pluginURL:Y.pluginURL},function(re,ye){if(p.triggerPluginCompletionEvent(re),ye&&ye.every(function(Ze){return Ze}))for(var Ae in W.sourceCaches)W.sourceCaches[Ae].reload()})}),this.on("data",function(Y){if(Y.dataType==="source"&&Y.sourceDataType==="metadata"){var re=B.sourceCaches[Y.sourceId];if(re){var ye=re.getSource();if(ye&&ye.vectorLayerIds)for(var Ae in B._layers){var Ze=B._layers[Ae];Ze.source===ye.id&&B._validateLayer(Ze)}}}})}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.loadURL=function(T,M){var B=this;M===void 0&&(M={}),this.fire(new p.Event("dataloading",{dataType:"style"}));var W=typeof M.validate=="boolean"?M.validate:!p.isMapboxURL(T);T=this.map._requestManager.normalizeStyleURL(T,M.accessToken);var Y=this.map._requestManager.transformRequest(T,p.ResourceType.Style);this._request=p.getJSON(Y,function(re,ye){B._request=null,re?B.fire(new p.ErrorEvent(re)):ye&&B._load(ye,W)})},E.prototype.loadJSON=function(T,M){var B=this;M===void 0&&(M={}),this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.browser.frame(function(){B._request=null,B._load(T,M.validate!==!1)})},E.prototype.loadEmpty=function(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(hc,!1)},E.prototype._load=function(T,M){if(!M||!Rl(this,p.validateStyle(T))){for(var B in this._loaded=!0,this.stylesheet=T,T.sources)this.addSource(B,T.sources[B],{validate:!1});T.sprite?this._loadSprite(T.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(T.glyphs);var W=er(this.stylesheet.layers);this._order=W.map(function(Ae){return Ae.id}),this._layers={},this._serializedLayers={};for(var Y=0,re=W;Y<re.length;Y+=1){var ye=re[Y];(ye=p.createStyleLayer(ye)).setEventedParent(this,{layer:{id:ye.id}}),this._layers[ye.id]=ye,this._serializedLayers[ye.id]=ye.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Wt(this.stylesheet.light),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}},E.prototype._loadSprite=function(T){var M=this;this._spriteRequest=function(B,W,Y){var re,ye,Ae,Ze=p.browser.devicePixelRatio>1?"@2x":"",Je=p.getJSON(W.transformRequest(W.normalizeSpriteURL(B,Ze,".json"),p.ResourceType.SpriteJSON),function(ht,Ct){Je=null,Ae||(Ae=ht,re=Ct,ut())}),ke=p.getImage(W.transformRequest(W.normalizeSpriteURL(B,Ze,".png"),p.ResourceType.SpriteImage),function(ht,Ct){ke=null,Ae||(Ae=ht,ye=Ct,ut())});function ut(){if(Ae)Y(Ae);else if(re&&ye){var ht=p.browser.getImageData(ye),Ct={};for(var lt in re){var It=re[lt],Lt=It.width,Jt=It.height,vr=It.x,mr=It.y,wr=It.sdf,Ur=It.pixelRatio,on=It.stretchX,Hr=It.stretchY,mn=It.content,Yn=new p.RGBAImage({width:Lt,height:Jt});p.RGBAImage.copy(ht,Yn,{x:vr,y:mr},{x:0,y:0},{width:Lt,height:Jt}),Ct[lt]={data:Yn,pixelRatio:Ur,sdf:wr,stretchX:on,stretchY:Hr,content:mn}}Y(null,Ct)}}return{cancel:function(){Je&&(Je.cancel(),Je=null),ke&&(ke.cancel(),ke=null)}}}(T,this.map._requestManager,function(B,W){if(M._spriteRequest=null,B)M.fire(new p.ErrorEvent(B));else if(W)for(var Y in W)M.imageManager.addImage(Y,W[Y]);M.imageManager.setLoaded(!0),M._availableImages=M.imageManager.listImages(),M.dispatcher.broadcast("setImages",M._availableImages),M.fire(new p.Event("data",{dataType:"style"}))})},E.prototype._validateLayer=function(T){var M=this.sourceCaches[T.source];if(M){var B=T.sourceLayer;if(B){var W=M.getSource();(W.type==="geojson"||W.vectorLayerIds&&W.vectorLayerIds.indexOf(B)===-1)&&this.fire(new p.ErrorEvent(new Error('Source layer "'+B+'" does not exist on source "'+W.id+'" as specified by style layer "'+T.id+'"')))}}},E.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var T in this.sourceCaches)if(!this.sourceCaches[T].loaded())return!1;return!!this.imageManager.isLoaded()},E.prototype._serializeLayers=function(T){for(var M=[],B=0,W=T;B<W.length;B+=1){var Y=this._layers[W[B]];Y.type!=="custom"&&M.push(Y.serialize())}return M},E.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var T in this.sourceCaches)if(this.sourceCaches[T].hasTransition())return!0;for(var M in this._layers)if(this._layers[M].hasTransition())return!0;return!1},E.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},E.prototype.update=function(T){if(this._loaded){var M=this._changed;if(this._changed){var B=Object.keys(this._updatedLayers),W=Object.keys(this._removedLayers);for(var Y in(B.length||W.length)&&this._updateWorkerLayers(B,W),this._updatedSources){var re=this._updatedSources[Y];re==="reload"?this._reloadSource(Y):re==="clear"&&this._clearSource(Y)}for(var ye in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ye].updateTransitions(T);this.light.updateTransitions(T),this._resetUpdates()}var Ae={};for(var Ze in this.sourceCaches){var Je=this.sourceCaches[Ze];Ae[Ze]=Je.used,Je.used=!1}for(var ke=0,ut=this._order;ke<ut.length;ke+=1){var ht=this._layers[ut[ke]];ht.recalculate(T,this._availableImages),!ht.isHidden(T.zoom)&&ht.source&&(this.sourceCaches[ht.source].used=!0)}for(var Ct in Ae){var lt=this.sourceCaches[Ct];Ae[Ct]!==lt.used&&lt.fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Ct}))}this.light.recalculate(T),this.z=T.zoom,M&&this.fire(new p.Event("data",{dataType:"style"}))}},E.prototype._updateTilesForChangedImages=function(){var T=Object.keys(this._changedImages);if(T.length){for(var M in this.sourceCaches)this.sourceCaches[M].reloadTilesForDependencies(["icons","patterns"],T);this._changedImages={}}},E.prototype._updateWorkerLayers=function(T,M){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(T),removedIds:M})},E.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},E.prototype.setState=function(T){var M=this;if(this._checkLoaded(),Rl(this,p.validateStyle(T)))return!1;(T=p.clone$1(T)).layers=er(T.layers);var B=function(Y,re){if(!Y)return[{command:Nr.setStyle,args:[re]}];var ye=[];try{if(!p.deepEqual(Y.version,re.version))return[{command:Nr.setStyle,args:[re]}];p.deepEqual(Y.center,re.center)||ye.push({command:Nr.setCenter,args:[re.center]}),p.deepEqual(Y.zoom,re.zoom)||ye.push({command:Nr.setZoom,args:[re.zoom]}),p.deepEqual(Y.bearing,re.bearing)||ye.push({command:Nr.setBearing,args:[re.bearing]}),p.deepEqual(Y.pitch,re.pitch)||ye.push({command:Nr.setPitch,args:[re.pitch]}),p.deepEqual(Y.sprite,re.sprite)||ye.push({command:Nr.setSprite,args:[re.sprite]}),p.deepEqual(Y.glyphs,re.glyphs)||ye.push({command:Nr.setGlyphs,args:[re.glyphs]}),p.deepEqual(Y.transition,re.transition)||ye.push({command:Nr.setTransition,args:[re.transition]}),p.deepEqual(Y.light,re.light)||ye.push({command:Nr.setLight,args:[re.light]});var Ae={},Ze=[];(function(ke,ut,ht,Ct){var lt;for(lt in ut=ut||{},ke=ke||{})ke.hasOwnProperty(lt)&&(ut.hasOwnProperty(lt)||$r(lt,ht,Ct));for(lt in ut)ut.hasOwnProperty(lt)&&(ke.hasOwnProperty(lt)?p.deepEqual(ke[lt],ut[lt])||(ke[lt].type==="geojson"&&ut[lt].type==="geojson"&&Yi(ke,ut,lt)?ht.push({command:Nr.setGeoJSONSourceData,args:[lt,ut[lt].data]}):si(lt,ut,ht,Ct)):Ln(lt,ut,ht))})(Y.sources,re.sources,Ze,Ae);var Je=[];Y.layers&&Y.layers.forEach(function(ke){Ae[ke.source]?ye.push({command:Nr.removeLayer,args:[ke.id]}):Je.push(ke)}),ye=ye.concat(Ze),function(ke,ut,ht){ut=ut||[];var Ct,lt,It,Lt,Jt,vr,mr,wr=(ke=ke||[]).map($i),Ur=ut.map($i),on=ke.reduce(di,{}),Hr=ut.reduce(di,{}),mn=wr.slice(),Yn=Object.create(null);for(Ct=0,lt=0;Ct<wr.length;Ct++)Hr.hasOwnProperty(It=wr[Ct])?lt++:(ht.push({command:Nr.removeLayer,args:[It]}),mn.splice(mn.indexOf(It,lt),1));for(Ct=0,lt=0;Ct<Ur.length;Ct++)mn[mn.length-1-Ct]!==(It=Ur[Ur.length-1-Ct])&&(on.hasOwnProperty(It)?(ht.push({command:Nr.removeLayer,args:[It]}),mn.splice(mn.lastIndexOf(It,mn.length-lt),1)):lt++,ht.push({command:Nr.addLayer,args:[Hr[It],vr=mn[mn.length-Ct]]}),mn.splice(mn.length-Ct,0,It),Yn[It]=!0);for(Ct=0;Ct<Ur.length;Ct++)if(Lt=on[It=Ur[Ct]],Jt=Hr[It],!Yn[It]&&!p.deepEqual(Lt,Jt))if(p.deepEqual(Lt.source,Jt.source)&&p.deepEqual(Lt["source-layer"],Jt["source-layer"])&&p.deepEqual(Lt.type,Jt.type)){for(mr in xn(Lt.layout,Jt.layout,ht,It,null,Nr.setLayoutProperty),xn(Lt.paint,Jt.paint,ht,It,null,Nr.setPaintProperty),p.deepEqual(Lt.filter,Jt.filter)||ht.push({command:Nr.setFilter,args:[It,Jt.filter]}),p.deepEqual(Lt.minzoom,Jt.minzoom)&&p.deepEqual(Lt.maxzoom,Jt.maxzoom)||ht.push({command:Nr.setLayerZoomRange,args:[It,Jt.minzoom,Jt.maxzoom]}),Lt)Lt.hasOwnProperty(mr)&&mr!=="layout"&&mr!=="paint"&&mr!=="filter"&&mr!=="metadata"&&mr!=="minzoom"&&mr!=="maxzoom"&&(mr.indexOf("paint.")===0?xn(Lt[mr],Jt[mr],ht,It,mr.slice(6),Nr.setPaintProperty):p.deepEqual(Lt[mr],Jt[mr])||ht.push({command:Nr.setLayerProperty,args:[It,mr,Jt[mr]]}));for(mr in Jt)Jt.hasOwnProperty(mr)&&!Lt.hasOwnProperty(mr)&&mr!=="layout"&&mr!=="paint"&&mr!=="filter"&&mr!=="metadata"&&mr!=="minzoom"&&mr!=="maxzoom"&&(mr.indexOf("paint.")===0?xn(Lt[mr],Jt[mr],ht,It,mr.slice(6),Nr.setPaintProperty):p.deepEqual(Lt[mr],Jt[mr])||ht.push({command:Nr.setLayerProperty,args:[It,mr,Jt[mr]]}))}else ht.push({command:Nr.removeLayer,args:[It]}),vr=mn[mn.lastIndexOf(It)+1],ht.push({command:Nr.addLayer,args:[Jt,vr]})}(Je,re.layers,ye)}catch(ke){console.warn("Unable to compute style diff:",ke),ye=[{command:Nr.setStyle,args:[re]}]}return ye}(this.serialize(),T).filter(function(Y){return!(Y.command in ms)});if(B.length===0)return!1;var W=B.filter(function(Y){return!(Y.command in ta)});if(W.length>0)throw new Error("Unimplemented: "+W.map(function(Y){return Y.command}).join(", ")+".");return B.forEach(function(Y){Y.command!=="setTransition"&&M[Y.command].apply(M,Y.args)}),this.stylesheet=T,!0},E.prototype.addImage=function(T,M){if(this.getImage(T))return this.fire(new p.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(T,M),this._afterImageUpdated(T)},E.prototype.updateImage=function(T,M){this.imageManager.updateImage(T,M)},E.prototype.getImage=function(T){return this.imageManager.getImage(T)},E.prototype.removeImage=function(T){if(!this.getImage(T))return this.fire(new p.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(T),this._afterImageUpdated(T)},E.prototype._afterImageUpdated=function(T){this._availableImages=this.imageManager.listImages(),this._changedImages[T]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))},E.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},E.prototype.addSource=function(T,M,B){var W=this;if(B===void 0&&(B={}),this._checkLoaded(),this.sourceCaches[T]!==void 0)throw new Error("There is already a source with this ID");if(!M.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(M).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(M.type)>=0&&this._validate(p.validateStyle.source,"sources."+T,M,null,B))){this.map&&this.map._collectResourceTiming&&(M.collectResourceTiming=!0);var Y=this.sourceCaches[T]=new Le(T,M,this.dispatcher);Y.style=this,Y.setEventedParent(this,function(){return{isSourceLoaded:W.loaded(),source:Y.serialize(),sourceId:T}}),Y.onAdd(this.map),this._changed=!0}},E.prototype.removeSource=function(T){if(this._checkLoaded(),this.sourceCaches[T]===void 0)throw new Error("There is no source with this ID");for(var M in this._layers)if(this._layers[M].source===T)return this.fire(new p.ErrorEvent(new Error('Source "'+T+'" cannot be removed while layer "'+M+'" is using it.')));var B=this.sourceCaches[T];delete this.sourceCaches[T],delete this._updatedSources[T],B.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T})),B.setEventedParent(null),B.clearTiles(),B.onRemove&&B.onRemove(this.map),this._changed=!0},E.prototype.setGeoJSONSourceData=function(T,M){this._checkLoaded(),this.sourceCaches[T].getSource().setData(M),this._changed=!0},E.prototype.getSource=function(T){return this.sourceCaches[T]&&this.sourceCaches[T].getSource()},E.prototype.addLayer=function(T,M,B){B===void 0&&(B={}),this._checkLoaded();var W=T.id;if(this.getLayer(W))this.fire(new p.ErrorEvent(new Error('Layer with id "'+W+'" already exists on this map')));else{var Y;if(T.type==="custom"){if(Rl(this,p.validateCustomStyleLayer(T)))return;Y=p.createStyleLayer(T)}else{if(typeof T.source=="object"&&(this.addSource(W,T.source),T=p.clone$1(T),T=p.extend(T,{source:W})),this._validate(p.validateStyle.layer,"layers."+W,T,{arrayIndex:-1},B))return;Y=p.createStyleLayer(T),this._validateLayer(Y),Y.setEventedParent(this,{layer:{id:W}}),this._serializedLayers[Y.id]=Y.serialize()}var re=M?this._order.indexOf(M):this._order.length;if(M&&re===-1)this.fire(new p.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.')));else{if(this._order.splice(re,0,W),this._layerOrderChanged=!0,this._layers[W]=Y,this._removedLayers[W]&&Y.source&&Y.type!=="custom"){var ye=this._removedLayers[W];delete this._removedLayers[W],ye.type!==Y.type?this._updatedSources[Y.source]="clear":(this._updatedSources[Y.source]="reload",this.sourceCaches[Y.source].pause())}this._updateLayer(Y),Y.onAdd&&Y.onAdd(this.map)}}},E.prototype.moveLayer=function(T,M){if(this._checkLoaded(),this._changed=!0,this._layers[T]){if(T!==M){var B=this._order.indexOf(T);this._order.splice(B,1);var W=M?this._order.indexOf(M):this._order.length;M&&W===-1?this.fire(new p.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.'))):(this._order.splice(W,0,T),this._layerOrderChanged=!0)}}else this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be moved.")))},E.prototype.removeLayer=function(T){this._checkLoaded();var M=this._layers[T];if(M){M.setEventedParent(null);var B=this._order.indexOf(T);this._order.splice(B,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[T]=M,delete this._layers[T],delete this._serializedLayers[T],delete this._updatedLayers[T],delete this._updatedPaintProps[T],M.onRemove&&M.onRemove(this.map)}else this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be removed.")))},E.prototype.getLayer=function(T){return this._layers[T]},E.prototype.hasLayer=function(T){return T in this._layers},E.prototype.setLayerZoomRange=function(T,M,B){this._checkLoaded();var W=this.getLayer(T);W?W.minzoom===M&&W.maxzoom===B||(M!=null&&(W.minzoom=M),B!=null&&(W.maxzoom=B),this._updateLayer(W)):this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot have zoom extent.")))},E.prototype.setFilter=function(T,M,B){B===void 0&&(B={}),this._checkLoaded();var W=this.getLayer(T);if(W){if(!p.deepEqual(W.filter,M))return M==null?(W.filter=void 0,void this._updateLayer(W)):void(this._validate(p.validateStyle.filter,"layers."+W.id+".filter",M,null,B)||(W.filter=p.clone$1(M),this._updateLayer(W)))}else this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be filtered.")))},E.prototype.getFilter=function(T){return p.clone$1(this.getLayer(T).filter)},E.prototype.setLayoutProperty=function(T,M,B,W){W===void 0&&(W={}),this._checkLoaded();var Y=this.getLayer(T);Y?p.deepEqual(Y.getLayoutProperty(M),B)||(Y.setLayoutProperty(M,B,W),this._updateLayer(Y)):this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be styled.")))},E.prototype.getLayoutProperty=function(T,M){var B=this.getLayer(T);if(B)return B.getLayoutProperty(M);this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style.")))},E.prototype.setPaintProperty=function(T,M,B,W){W===void 0&&(W={}),this._checkLoaded();var Y=this.getLayer(T);Y?p.deepEqual(Y.getPaintProperty(M),B)||(Y.setPaintProperty(M,B,W)&&this._updateLayer(Y),this._changed=!0,this._updatedPaintProps[T]=!0):this.fire(new p.ErrorEvent(new Error("The layer '"+T+"' does not exist in the map's style and cannot be styled.")))},E.prototype.getPaintProperty=function(T,M){return this.getLayer(T).getPaintProperty(M)},E.prototype.setFeatureState=function(T,M){this._checkLoaded();var B=T.source,W=T.sourceLayer,Y=this.sourceCaches[B];if(Y!==void 0){var re=Y.getSource().type;re==="geojson"&&W?this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):re!=="vector"||W?(T.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),Y.setFeatureState(W,T.id,M)):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+B+"' does not exist in the map's style.")))},E.prototype.removeFeatureState=function(T,M){this._checkLoaded();var B=T.source,W=this.sourceCaches[B];if(W!==void 0){var Y=W.getSource().type,re=Y==="vector"?T.sourceLayer:void 0;Y!=="vector"||re?M&&typeof T.id!="string"&&typeof T.id!="number"?this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):W.removeFeatureState(re,T.id,M):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+B+"' does not exist in the map's style.")))},E.prototype.getFeatureState=function(T){this._checkLoaded();var M=T.source,B=T.sourceLayer,W=this.sourceCaches[M];if(W!==void 0){if(W.getSource().type!=="vector"||B)return T.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),W.getFeatureState(B,T.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+M+"' does not exist in the map's style.")))},E.prototype.getTransition=function(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},E.prototype.serialize=function(){return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:p.mapObject(this.sourceCaches,function(T){return T.serialize()}),layers:this._serializeLayers(this._order)},function(T){return T!==void 0})},E.prototype._updateLayer=function(T){this._updatedLayers[T.id]=!0,T.source&&!this._updatedSources[T.source]&&this.sourceCaches[T.source].getSource().type!=="raster"&&(this._updatedSources[T.source]="reload",this.sourceCaches[T.source].pause()),this._changed=!0},E.prototype._flattenAndSortRenderedFeatures=function(T){for(var M=this,B=function(on){return M._layers[on].type==="fill-extrusion"},W={},Y=[],re=this._order.length-1;re>=0;re--){var ye=this._order[re];if(B(ye)){W[ye]=re;for(var Ae=0,Ze=T;Ae<Ze.length;Ae+=1){var Je=Ze[Ae][ye];if(Je)for(var ke=0,ut=Je;ke<ut.length;ke+=1)Y.push(ut[ke])}}}Y.sort(function(on,Hr){return Hr.intersectionZ-on.intersectionZ});for(var ht=[],Ct=this._order.length-1;Ct>=0;Ct--){var lt=this._order[Ct];if(B(lt))for(var It=Y.length-1;It>=0;It--){var Lt=Y[It].feature;if(W[Lt.layer.id]<Ct)break;ht.push(Lt),Y.pop()}else for(var Jt=0,vr=T;Jt<vr.length;Jt+=1){var mr=vr[Jt][lt];if(mr)for(var wr=0,Ur=mr;wr<Ur.length;wr+=1)ht.push(Ur[wr].feature)}}return ht},E.prototype.queryRenderedFeatures=function(T,M,B){M&&M.filter&&this._validate(p.validateStyle.filter,"queryRenderedFeatures.filter",M.filter,null,M);var W={};if(M&&M.layers){if(!Array.isArray(M.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Y=0,re=M.layers;Y<re.length;Y+=1){var ye=re[Y],Ae=this._layers[ye];if(!Ae)return this.fire(new p.ErrorEvent(new Error("The layer '"+ye+"' does not exist in the map's style and cannot be queried for features."))),[];W[Ae.source]=!0}}var Ze=[];for(var Je in M.availableImages=this._availableImages,this.sourceCaches)M.layers&&!W[Je]||Ze.push(fn(this.sourceCaches[Je],this._layers,this._serializedLayers,T,M,B));return this.placement&&Ze.push(function(ke,ut,ht,Ct,lt,It,Lt){for(var Jt={},vr=It.queryRenderedSymbols(Ct),mr=[],wr=0,Ur=Object.keys(vr).map(Number);wr<Ur.length;wr+=1)mr.push(Lt[Ur[wr]]);mr.sort(Nn);for(var on=function(){var Jn=mn[Hr],io=Jn.featureIndex.lookupSymbolFeatures(vr[Jn.bucketInstanceId],ut,Jn.bucketIndex,Jn.sourceLayerIndex,lt.filter,lt.layers,lt.availableImages,ke);for(var An in io){var Qn=Jt[An]=Jt[An]||[],$n=io[An];$n.sort(function(Ii,yi){var ii=Jn.featureSortOrder;if(ii){var is=ii.indexOf(Ii.featureIndex);return ii.indexOf(yi.featureIndex)-is}return yi.featureIndex-Ii.featureIndex});for(var vi=0,xi=$n;vi<xi.length;vi+=1)Qn.push(xi[vi])}},Hr=0,mn=mr;Hr<mn.length;Hr+=1)on();var Yn=function(Jn){Jt[Jn].forEach(function(io){var An=io.feature,Qn=ht[ke[Jn].source].getFeatureState(An.layer["source-layer"],An.id);An.source=An.layer.source,An.layer["source-layer"]&&(An.sourceLayer=An.layer["source-layer"]),An.state=Qn})};for(var ni in Jt)Yn(ni);return Jt}(this._layers,this._serializedLayers,this.sourceCaches,T,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ze)},E.prototype.querySourceFeatures=function(T,M){M&&M.filter&&this._validate(p.validateStyle.filter,"querySourceFeatures.filter",M.filter,null,M);var B=this.sourceCaches[T];return B?function(W,Y){for(var re=W.getRenderableIds().map(function(ut){return W.getTileByID(ut)}),ye=[],Ae={},Ze=0;Ze<re.length;Ze++){var Je=re[Ze],ke=Je.tileID.canonical.key;Ae[ke]||(Ae[ke]=!0,Je.querySourceFeatures(ye,Y))}return ye}(B,M):[]},E.prototype.addSourceType=function(T,M,B){return E.getSourceType(T)?B(new Error('A source type called "'+T+'" already exists.')):(E.setSourceType(T,M),M.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:T,url:M.workerSourceURL},B):B(null,null))},E.prototype.getLight=function(){return this.light.getLight()},E.prototype.setLight=function(T,M){M===void 0&&(M={}),this._checkLoaded();var B=this.light.getLight(),W=!1;for(var Y in T)if(!p.deepEqual(T[Y],B[Y])){W=!0;break}if(W){var re={now:p.browser.now(),transition:p.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(T,M),this.light.updateTransitions(re)}},E.prototype._validate=function(T,M,B,W,Y){return Y===void 0&&(Y={}),(!Y||Y.validate!==!1)&&Rl(this,T.call(p.validateStyle,p.extend({key:M,style:this.serialize(),value:B,styleSpec:p.styleSpec},W)))},E.prototype._remove=function(){for(var T in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[T].setEventedParent(null);for(var M in this.sourceCaches)this.sourceCaches[M].clearTiles(),this.sourceCaches[M].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},E.prototype._clearSource=function(T){this.sourceCaches[T].clearTiles()},E.prototype._reloadSource=function(T){this.sourceCaches[T].resume(),this.sourceCaches[T].reload()},E.prototype._updateSources=function(T){for(var M in this.sourceCaches)this.sourceCaches[M].update(T)},E.prototype._generateCollisionBoxes=function(){for(var T in this.sourceCaches)this._reloadSource(T)},E.prototype._updatePlacement=function(T,M,B,W,Y){Y===void 0&&(Y=!1);for(var re=!1,ye=!1,Ae={},Ze=0,Je=this._order;Ze<Je.length;Ze+=1){var ke=this._layers[Je[Ze]];if(ke.type==="symbol"){if(!Ae[ke.source]){var ut=this.sourceCaches[ke.source];Ae[ke.source]=ut.getRenderableIds(!0).map(function(Lt){return ut.getTileByID(Lt)}).sort(function(Lt,Jt){return Jt.tileID.overscaledZ-Lt.tileID.overscaledZ||(Lt.tileID.isLessThan(Jt.tileID)?-1:1)})}var ht=this.crossTileSymbolIndex.addLayer(ke,Ae[ke.source],T.center.lng);re=re||ht}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((Y=Y||this._layerOrderChanged||B===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.browser.now(),T.zoom))&&(this.pauseablePlacement=new Zl(T,this._order,Y,M,B,W,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ae),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.browser.now()),ye=!0),re&&this.pauseablePlacement.placement.setStale()),ye||re)for(var Ct=0,lt=this._order;Ct<lt.length;Ct+=1){var It=this._layers[lt[Ct]];It.type==="symbol"&&this.placement.updateLayerOpacities(It,Ae[It.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.browser.now())},E.prototype._releaseSymbolFadeTiles=function(){for(var T in this.sourceCaches)this.sourceCaches[T].releaseSymbolFadeTiles()},E.prototype.getImages=function(T,M,B){this.imageManager.getImages(M.icons,B),this._updateTilesForChangedImages();var W=this.sourceCaches[M.source];W&&W.setDependencies(M.tileID.key,M.type,M.icons)},E.prototype.getGlyphs=function(T,M,B){this.glyphManager.getGlyphs(M.stacks,B)},E.prototype.getResource=function(T,M,B){return p.makeRequest(M,B)},E}(p.Evented);$a.getSourceType=function(S){return Vn[S]},$a.setSourceType=function(S,E){Vn[S]=E},$a.registerForPluginStateChange=p.registerForPluginStateChange;var lo=p.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ru=No(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Up=No(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),nu=No(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),ed=No(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),iu=No("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Du=No(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Dl=No(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),td=No("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Lc=No("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),rd=No("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),jm=No(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),dc=No(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),nd=No(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ki=No(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ga=No(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),rp=No(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ou=No(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Lu=No(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),yl=No(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),vl=No(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),pc=No(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Xl=No(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ou=No(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ws=No(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),au=No(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),id=No(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function No(S,E){var T=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,M=E.match(/attribute ([\w]+) ([\w]+)/g),B=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),W=E.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Y=W?W.concat(B):B,re={};return{fragmentSource:S=S.replace(T,function(ye,Ae,Ze,Je,ke){return re[ke]=!0,Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
varying `+Ze+" "+Je+" "+ke+`;
#else
uniform `+Ze+" "+Je+" u_"+ke+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ke+`
    `+Ze+" "+Je+" "+ke+" = u_"+ke+`;
#endif
`}),vertexSource:E=E.replace(T,function(ye,Ae,Ze,Je,ke){var ut=Je==="float"?"vec2":"vec4",ht=ke.match(/color/)?"color":ut;return re[ke]?Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
uniform lowp float u_`+ke+`_t;
attribute `+Ze+" "+ut+" a_"+ke+`;
varying `+Ze+" "+Je+" "+ke+`;
#else
uniform `+Ze+" "+Je+" u_"+ke+`;
#endif
`:ht==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+ke+" = a_"+ke+`;
#else
    `+Ze+" "+Je+" "+ke+" = u_"+ke+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+ke+" = unpack_mix_"+ht+"(a_"+ke+", u_"+ke+`_t);
#else
    `+Ze+" "+Je+" "+ke+" = u_"+ke+`;
#endif
`:Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+ke+`
uniform lowp float u_`+ke+`_t;
attribute `+Ze+" "+ut+" a_"+ke+`;
#else
uniform `+Ze+" "+Je+" u_"+ke+`;
#endif
`:ht==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+Ze+" "+Je+" "+ke+" = a_"+ke+`;
#else
    `+Ze+" "+Je+" "+ke+" = u_"+ke+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ke+`
    `+Ze+" "+Je+" "+ke+" = unpack_mix_"+ht+"(a_"+ke+", u_"+ke+`_t);
#else
    `+Ze+" "+Je+" "+ke+" = u_"+ke+`;
#endif
`}),staticAttributes:M,staticUniforms:Y}}var Nf=Object.freeze({__proto__:null,prelude:Ru,background:Up,backgroundPattern:nu,circle:ed,clippingMask:iu,heatmap:Du,heatmapTexture:Dl,collisionBox:td,collisionCircle:Lc,debug:rd,fill:jm,fillOutline:dc,fillOutlinePattern:nd,fillPattern:Ki,fillExtrusion:Ga,fillExtrusionPattern:rp,hillshadePrepare:Ou,hillshade:Lu,line:yl,lineGradient:vl,linePattern:pc,lineSDF:Xl,raster:ou,symbolIcon:Ws,symbolSDF:au,symbolTextAndIcon:id}),sl=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function jf(S){for(var E=[],T=0;T<S.length;T++)if(S[T]!==null){var M=S[T].split(" ");E.push(M.pop())}return E}sl.prototype.bind=function(S,E,T,M,B,W,Y,re){this.context=S;for(var ye=this.boundPaintVertexBuffers.length!==M.length,Ae=0;!ye&&Ae<M.length;Ae++)this.boundPaintVertexBuffers[Ae]!==M[Ae]&&(ye=!0);S.extVertexArrayObject&&this.vao&&this.boundProgram===E&&this.boundLayoutVertexBuffer===T&&!ye&&this.boundIndexBuffer===B&&this.boundVertexOffset===W&&this.boundDynamicVertexBuffer===Y&&this.boundDynamicVertexBuffer2===re?(S.bindVertexArrayOES.set(this.vao),Y&&Y.bind(),B&&B.dynamicDraw&&B.bind(),re&&re.bind()):this.freshBind(E,T,M,B,W,Y,re)},sl.prototype.freshBind=function(S,E,T,M,B,W,Y){var re,ye=S.numAttributes,Ae=this.context,Ze=Ae.gl;if(Ae.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ae.extVertexArrayObject.createVertexArrayOES(),Ae.bindVertexArrayOES.set(this.vao),re=0,this.boundProgram=S,this.boundLayoutVertexBuffer=E,this.boundPaintVertexBuffers=T,this.boundIndexBuffer=M,this.boundVertexOffset=B,this.boundDynamicVertexBuffer=W,this.boundDynamicVertexBuffer2=Y;else{re=Ae.currentNumAttributes||0;for(var Je=ye;Je<re;Je++)Ze.disableVertexAttribArray(Je)}E.enableAttributes(Ze,S);for(var ke=0,ut=T;ke<ut.length;ke+=1)ut[ke].enableAttributes(Ze,S);W&&W.enableAttributes(Ze,S),Y&&Y.enableAttributes(Ze,S),E.bind(),E.setVertexAttribPointers(Ze,S,B);for(var ht=0,Ct=T;ht<Ct.length;ht+=1){var lt=Ct[ht];lt.bind(),lt.setVertexAttribPointers(Ze,S,B)}W&&(W.bind(),W.setVertexAttribPointers(Ze,S,B)),M&&M.bind(),Y&&(Y.bind(),Y.setVertexAttribPointers(Ze,S,B)),Ae.currentNumAttributes=ye},sl.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var $p=function(S,E,T,M,B,W){var Y=S.gl;this.program=Y.createProgram();for(var re=jf(T.staticAttributes),ye=M?M.getBinderAttributes():[],Ae=re.concat(ye),Ze=T.staticUniforms?jf(T.staticUniforms):[],Je=M?M.getBinderUniforms():[],ke=[],ut=0,ht=Ze.concat(Je);ut<ht.length;ut+=1){var Ct=ht[ut];ke.indexOf(Ct)<0&&ke.push(Ct)}var lt=M?M.defines():[];W&&lt.push("#define OVERDRAW_INSPECTOR;");var It=lt.concat(Ru.fragmentSource,T.fragmentSource).join(`
`),Lt=lt.concat(Ru.vertexSource,T.vertexSource).join(`
`),Jt=Y.createShader(Y.FRAGMENT_SHADER);if(Y.isContextLost())this.failedToCreate=!0;else{Y.shaderSource(Jt,It),Y.compileShader(Jt),Y.attachShader(this.program,Jt);var vr=Y.createShader(Y.VERTEX_SHADER);if(Y.isContextLost())this.failedToCreate=!0;else{Y.shaderSource(vr,Lt),Y.compileShader(vr),Y.attachShader(this.program,vr),this.attributes={};var mr={};this.numAttributes=Ae.length;for(var wr=0;wr<this.numAttributes;wr++)Ae[wr]&&(Y.bindAttribLocation(this.program,wr,Ae[wr]),this.attributes[Ae[wr]]=wr);Y.linkProgram(this.program),Y.deleteShader(vr),Y.deleteShader(Jt);for(var Ur=0;Ur<ke.length;Ur++){var on=ke[Ur];if(on&&!mr[on]){var Hr=Y.getUniformLocation(this.program,on);Hr&&(mr[on]=Hr)}}this.fixedUniforms=B(S,mr),this.binderUniforms=M?M.getUniforms(S,mr):[]}}};function Gp(S,E,T){var M=1/Uo(T,1,E.transform.tileZoom),B=Math.pow(2,T.tileID.overscaledZ),W=T.tileSize*Math.pow(2,E.transform.tileZoom)/B,Y=W*(T.tileID.canonical.x+T.tileID.wrap*B),re=W*T.tileID.canonical.y;return{u_image:0,u_texsize:T.imageAtlasTexture.size,u_scale:[M,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[Y>>16,re>>16],u_pixel_coord_lower:[65535&Y,65535&re]}}$p.prototype.draw=function(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je,ke,ut,ht,Ct){var lt,It=S.gl;if(!this.failedToCreate){for(var Lt in S.program.set(this.program),S.setDepthMode(T),S.setStencilMode(M),S.setColorMode(B),S.setCullFace(W),this.fixedUniforms)this.fixedUniforms[Lt].set(Y[Lt]);ut&&ut.setUniforms(S,this.binderUniforms,Je,{zoom:ke});for(var Jt=(lt={},lt[It.LINES]=2,lt[It.TRIANGLES]=3,lt[It.LINE_STRIP]=1,lt)[E],vr=0,mr=Ze.get();vr<mr.length;vr+=1){var wr=mr[vr],Ur=wr.vaos||(wr.vaos={});(Ur[re]||(Ur[re]=new sl)).bind(S,this,ye,ut?ut.getPaintVertexBuffers():[],Ae,wr.vertexOffset,ht,Ct),It.drawElements(E,wr.primitiveLength*Jt,It.UNSIGNED_SHORT,wr.primitiveOffset*Jt*2)}}};var qp=function(S,E,T,M){var B=E.style.light,W=B.properties.get("position"),Y=[W.x,W.y,W.z],re=p.create$1();B.properties.get("anchor")==="viewport"&&p.fromRotation(re,-E.transform.angle),p.transformMat3(Y,Y,re);var ye=B.properties.get("color");return{u_matrix:S,u_lightpos:Y,u_lightintensity:B.properties.get("intensity"),u_lightcolor:[ye.r,ye.g,ye.b],u_vertical_gradient:+T,u_opacity:M}},su=function(S,E,T,M,B,W,Y){return p.extend(qp(S,E,T,M),Gp(W,E,Y),{u_height_factor:-Math.pow(2,B.overscaledZ)/Y.tileSize/8})},zc=function(S){return{u_matrix:S}},Yl=function(S,E,T,M){return p.extend(zc(S),Gp(T,E,M))},np=function(S,E){return{u_matrix:S,u_world:E}},od=function(S,E,T,M,B){return p.extend(Yl(S,E,T,M),{u_world:B})},Nc=function(S,E,T,M){var B,W,Y=S.transform;if(M.paint.get("circle-pitch-alignment")==="map"){var re=Uo(T,1,Y.zoom);B=!0,W=[re,re]}else B=!1,W=Y.pixelsToGLUnits;return{u_camera_to_center_distance:Y.cameraToCenterDistance,u_scale_with_map:+(M.paint.get("circle-pitch-scale")==="map"),u_matrix:S.translatePosMatrix(E.posMatrix,T,M.paint.get("circle-translate"),M.paint.get("circle-translate-anchor")),u_pitch_with_map:+B,u_device_pixel_ratio:p.browser.devicePixelRatio,u_extrude_scale:W}},lu=function(S,E,T){var M=Uo(T,1,E.zoom),B=Math.pow(2,E.zoom-T.tileID.overscaledZ),W=T.tileID.overscaleFactor();return{u_matrix:S,u_camera_to_center_distance:E.cameraToCenterDistance,u_pixels_to_tile_units:M,u_extrude_scale:[E.pixelsToGLUnits[0]/(M*B),E.pixelsToGLUnits[1]/(M*B)],u_overscale_factor:W}},Ol=function(S,E,T){return{u_matrix:S,u_inv_matrix:E,u_camera_to_center_distance:T.cameraToCenterDistance,u_viewport_size:[T.width,T.height]}},Jr=function(S,E,T){return T===void 0&&(T=1),{u_matrix:S,u_color:E,u_overlay:0,u_overlay_scale:T}},jc=function(S){return{u_matrix:S}},Wp=function(S,E,T,M){return{u_matrix:S,u_extrude_scale:Uo(E,1,T),u_intensity:M}},cu=function(S,E,T){var M=S.transform;return{u_matrix:Nu(S,E,T),u_ratio:1/Uo(E,1,M.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},Go=function(S,E,T,M){return p.extend(cu(S,E,T),{u_image:0,u_image_height:M})},fc=function(S,E,T,M){var B=S.transform,W=zu(E,B);return{u_matrix:Nu(S,E,T),u_texsize:E.imageAtlasTexture.size,u_ratio:1/Uo(E,1,B.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_image:0,u_scale:[W,M.fromScale,M.toScale],u_fade:M.t,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]]}},mc=function(S,E,T,M,B){var W=S.lineAtlas,Y=zu(E,S.transform),re=T.layout.get("line-cap")==="round",ye=W.getDash(M.from,re),Ae=W.getDash(M.to,re),Ze=ye.width*B.fromScale,Je=Ae.width*B.toScale;return p.extend(cu(S,E,T),{u_patternscale_a:[Y/Ze,-ye.height/2],u_patternscale_b:[Y/Je,-Ae.height/2],u_sdfgamma:W.width/(256*Math.min(Ze,Je)*p.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:ye.y,u_tex_y_b:Ae.y,u_mix:B.t})};function zu(S,E){return 1/Uo(S,1,E.tileZoom)}function Nu(S,E,T){return S.translatePosMatrix(E.tileID.posMatrix,E,T.paint.get("line-translate"),T.paint.get("line-translate-anchor"))}var Hp=function(S,E,T,M,B){return{u_matrix:S,u_tl_parent:E,u_scale_parent:T,u_buffer_scale:1,u_fade_t:M.mix,u_opacity:M.opacity*B.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:B.paint.get("raster-brightness-min"),u_brightness_high:B.paint.get("raster-brightness-max"),u_saturation_factor:(Y=B.paint.get("raster-saturation"),Y>0?1-1/(1.001-Y):-Y),u_contrast_factor:(W=B.paint.get("raster-contrast"),W>0?1/(1-W):1+W),u_spin_weights:ju(B.paint.get("raster-hue-rotate"))};var W,Y};function ju(S){S*=Math.PI/180;var E=Math.sin(S),T=Math.cos(S);return[(2*T+1)/3,(-Math.sqrt(3)*E-T+1)/3,(Math.sqrt(3)*E-T+1)/3]}var ad,sd=function(S,E,T,M,B,W,Y,re,ye,Ae){var Ze=B.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:E?E.uSizeT:0,u_size:E?E.uSize:0,u_camera_to_center_distance:Ze.cameraToCenterDistance,u_pitch:Ze.pitch/360*2*Math.PI,u_rotate_symbol:+T,u_aspect_ratio:Ze.width/Ze.height,u_fade_change:B.options.fadeDuration?B.symbolFadeChange:1,u_matrix:W,u_label_plane_matrix:Y,u_coord_matrix:re,u_is_text:+ye,u_pitch_with_map:+M,u_texsize:Ae,u_texture:0}},Bc=function(S,E,T,M,B,W,Y,re,ye,Ae,Ze){var Je=B.transform;return p.extend(sd(S,E,T,M,B,W,Y,re,ye,Ae),{u_gamma_scale:M?Math.cos(Je._pitch)*Je.cameraToCenterDistance:1,u_device_pixel_ratio:p.browser.devicePixelRatio,u_is_halo:+Ze})},Zp=function(S,E,T,M,B,W,Y,re,ye,Ae){return p.extend(Bc(S,E,T,M,B,W,Y,re,!0,ye,!0),{u_texsize_icon:Ae,u_texture_icon:1})},ld=function(S,E,T){return{u_matrix:S,u_opacity:E,u_color:T}},xh=function(S,E,T,M,B,W){return p.extend(function(Y,re,ye,Ae){var Ze=ye.imageManager.getPattern(Y.from.toString()),Je=ye.imageManager.getPattern(Y.to.toString()),ke=ye.imageManager.getPixelSize(),ut=ke.width,ht=ke.height,Ct=Math.pow(2,Ae.tileID.overscaledZ),lt=Ae.tileSize*Math.pow(2,ye.transform.tileZoom)/Ct,It=lt*(Ae.tileID.canonical.x+Ae.tileID.wrap*Ct),Lt=lt*Ae.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ze.tl,u_pattern_br_a:Ze.br,u_pattern_tl_b:Je.tl,u_pattern_br_b:Je.br,u_texsize:[ut,ht],u_mix:re.t,u_pattern_size_a:Ze.displaySize,u_pattern_size_b:Je.displaySize,u_scale_a:re.fromScale,u_scale_b:re.toScale,u_tile_units_to_pixels:1/Uo(Ae,1,ye.transform.tileZoom),u_pixel_coord_upper:[It>>16,Lt>>16],u_pixel_coord_lower:[65535&It,65535&Lt]}}(M,W,T,B),{u_matrix:S,u_opacity:E})},Xp={fillExtrusion:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_lightpos:new p.Uniform3f(S,E.u_lightpos),u_lightintensity:new p.Uniform1f(S,E.u_lightintensity),u_lightcolor:new p.Uniform3f(S,E.u_lightcolor),u_vertical_gradient:new p.Uniform1f(S,E.u_vertical_gradient),u_opacity:new p.Uniform1f(S,E.u_opacity)}},fillExtrusionPattern:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_lightpos:new p.Uniform3f(S,E.u_lightpos),u_lightintensity:new p.Uniform1f(S,E.u_lightintensity),u_lightcolor:new p.Uniform3f(S,E.u_lightcolor),u_vertical_gradient:new p.Uniform1f(S,E.u_vertical_gradient),u_height_factor:new p.Uniform1f(S,E.u_height_factor),u_image:new p.Uniform1i(S,E.u_image),u_texsize:new p.Uniform2f(S,E.u_texsize),u_pixel_coord_upper:new p.Uniform2f(S,E.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(S,E.u_pixel_coord_lower),u_scale:new p.Uniform3f(S,E.u_scale),u_fade:new p.Uniform1f(S,E.u_fade),u_opacity:new p.Uniform1f(S,E.u_opacity)}},fill:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix)}},fillPattern:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_image:new p.Uniform1i(S,E.u_image),u_texsize:new p.Uniform2f(S,E.u_texsize),u_pixel_coord_upper:new p.Uniform2f(S,E.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(S,E.u_pixel_coord_lower),u_scale:new p.Uniform3f(S,E.u_scale),u_fade:new p.Uniform1f(S,E.u_fade)}},fillOutline:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_world:new p.Uniform2f(S,E.u_world)}},fillOutlinePattern:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_world:new p.Uniform2f(S,E.u_world),u_image:new p.Uniform1i(S,E.u_image),u_texsize:new p.Uniform2f(S,E.u_texsize),u_pixel_coord_upper:new p.Uniform2f(S,E.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(S,E.u_pixel_coord_lower),u_scale:new p.Uniform3f(S,E.u_scale),u_fade:new p.Uniform1f(S,E.u_fade)}},circle:function(S,E){return{u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_scale_with_map:new p.Uniform1i(S,E.u_scale_with_map),u_pitch_with_map:new p.Uniform1i(S,E.u_pitch_with_map),u_extrude_scale:new p.Uniform2f(S,E.u_extrude_scale),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_matrix:new p.UniformMatrix4f(S,E.u_matrix)}},collisionBox:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_pixels_to_tile_units:new p.Uniform1f(S,E.u_pixels_to_tile_units),u_extrude_scale:new p.Uniform2f(S,E.u_extrude_scale),u_overscale_factor:new p.Uniform1f(S,E.u_overscale_factor)}},collisionCircle:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_inv_matrix:new p.UniformMatrix4f(S,E.u_inv_matrix),u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_viewport_size:new p.Uniform2f(S,E.u_viewport_size)}},debug:function(S,E){return{u_color:new p.UniformColor(S,E.u_color),u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_overlay:new p.Uniform1i(S,E.u_overlay),u_overlay_scale:new p.Uniform1f(S,E.u_overlay_scale)}},clippingMask:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix)}},heatmap:function(S,E){return{u_extrude_scale:new p.Uniform1f(S,E.u_extrude_scale),u_intensity:new p.Uniform1f(S,E.u_intensity),u_matrix:new p.UniformMatrix4f(S,E.u_matrix)}},heatmapTexture:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_world:new p.Uniform2f(S,E.u_world),u_image:new p.Uniform1i(S,E.u_image),u_color_ramp:new p.Uniform1i(S,E.u_color_ramp),u_opacity:new p.Uniform1f(S,E.u_opacity)}},hillshade:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_image:new p.Uniform1i(S,E.u_image),u_latrange:new p.Uniform2f(S,E.u_latrange),u_light:new p.Uniform2f(S,E.u_light),u_shadow:new p.UniformColor(S,E.u_shadow),u_highlight:new p.UniformColor(S,E.u_highlight),u_accent:new p.UniformColor(S,E.u_accent)}},hillshadePrepare:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_image:new p.Uniform1i(S,E.u_image),u_dimension:new p.Uniform2f(S,E.u_dimension),u_zoom:new p.Uniform1f(S,E.u_zoom),u_unpack:new p.Uniform4f(S,E.u_unpack)}},line:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_ratio:new p.Uniform1f(S,E.u_ratio),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(S,E.u_units_to_pixels)}},lineGradient:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_ratio:new p.Uniform1f(S,E.u_ratio),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(S,E.u_units_to_pixels),u_image:new p.Uniform1i(S,E.u_image),u_image_height:new p.Uniform1f(S,E.u_image_height)}},linePattern:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_texsize:new p.Uniform2f(S,E.u_texsize),u_ratio:new p.Uniform1f(S,E.u_ratio),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_image:new p.Uniform1i(S,E.u_image),u_units_to_pixels:new p.Uniform2f(S,E.u_units_to_pixels),u_scale:new p.Uniform3f(S,E.u_scale),u_fade:new p.Uniform1f(S,E.u_fade)}},lineSDF:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_ratio:new p.Uniform1f(S,E.u_ratio),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(S,E.u_units_to_pixels),u_patternscale_a:new p.Uniform2f(S,E.u_patternscale_a),u_patternscale_b:new p.Uniform2f(S,E.u_patternscale_b),u_sdfgamma:new p.Uniform1f(S,E.u_sdfgamma),u_image:new p.Uniform1i(S,E.u_image),u_tex_y_a:new p.Uniform1f(S,E.u_tex_y_a),u_tex_y_b:new p.Uniform1f(S,E.u_tex_y_b),u_mix:new p.Uniform1f(S,E.u_mix)}},raster:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_tl_parent:new p.Uniform2f(S,E.u_tl_parent),u_scale_parent:new p.Uniform1f(S,E.u_scale_parent),u_buffer_scale:new p.Uniform1f(S,E.u_buffer_scale),u_fade_t:new p.Uniform1f(S,E.u_fade_t),u_opacity:new p.Uniform1f(S,E.u_opacity),u_image0:new p.Uniform1i(S,E.u_image0),u_image1:new p.Uniform1i(S,E.u_image1),u_brightness_low:new p.Uniform1f(S,E.u_brightness_low),u_brightness_high:new p.Uniform1f(S,E.u_brightness_high),u_saturation_factor:new p.Uniform1f(S,E.u_saturation_factor),u_contrast_factor:new p.Uniform1f(S,E.u_contrast_factor),u_spin_weights:new p.Uniform3f(S,E.u_spin_weights)}},symbolIcon:function(S,E){return{u_is_size_zoom_constant:new p.Uniform1i(S,E.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(S,E.u_is_size_feature_constant),u_size_t:new p.Uniform1f(S,E.u_size_t),u_size:new p.Uniform1f(S,E.u_size),u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_pitch:new p.Uniform1f(S,E.u_pitch),u_rotate_symbol:new p.Uniform1i(S,E.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(S,E.u_aspect_ratio),u_fade_change:new p.Uniform1f(S,E.u_fade_change),u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(S,E.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(S,E.u_coord_matrix),u_is_text:new p.Uniform1i(S,E.u_is_text),u_pitch_with_map:new p.Uniform1i(S,E.u_pitch_with_map),u_texsize:new p.Uniform2f(S,E.u_texsize),u_texture:new p.Uniform1i(S,E.u_texture)}},symbolSDF:function(S,E){return{u_is_size_zoom_constant:new p.Uniform1i(S,E.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(S,E.u_is_size_feature_constant),u_size_t:new p.Uniform1f(S,E.u_size_t),u_size:new p.Uniform1f(S,E.u_size),u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_pitch:new p.Uniform1f(S,E.u_pitch),u_rotate_symbol:new p.Uniform1i(S,E.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(S,E.u_aspect_ratio),u_fade_change:new p.Uniform1f(S,E.u_fade_change),u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(S,E.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(S,E.u_coord_matrix),u_is_text:new p.Uniform1i(S,E.u_is_text),u_pitch_with_map:new p.Uniform1i(S,E.u_pitch_with_map),u_texsize:new p.Uniform2f(S,E.u_texsize),u_texture:new p.Uniform1i(S,E.u_texture),u_gamma_scale:new p.Uniform1f(S,E.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(S,E.u_is_halo)}},symbolTextAndIcon:function(S,E){return{u_is_size_zoom_constant:new p.Uniform1i(S,E.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(S,E.u_is_size_feature_constant),u_size_t:new p.Uniform1f(S,E.u_size_t),u_size:new p.Uniform1f(S,E.u_size),u_camera_to_center_distance:new p.Uniform1f(S,E.u_camera_to_center_distance),u_pitch:new p.Uniform1f(S,E.u_pitch),u_rotate_symbol:new p.Uniform1i(S,E.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(S,E.u_aspect_ratio),u_fade_change:new p.Uniform1f(S,E.u_fade_change),u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(S,E.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(S,E.u_coord_matrix),u_is_text:new p.Uniform1i(S,E.u_is_text),u_pitch_with_map:new p.Uniform1i(S,E.u_pitch_with_map),u_texsize:new p.Uniform2f(S,E.u_texsize),u_texsize_icon:new p.Uniform2f(S,E.u_texsize_icon),u_texture:new p.Uniform1i(S,E.u_texture),u_texture_icon:new p.Uniform1i(S,E.u_texture_icon),u_gamma_scale:new p.Uniform1f(S,E.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(S,E.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(S,E.u_is_halo)}},background:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_opacity:new p.Uniform1f(S,E.u_opacity),u_color:new p.UniformColor(S,E.u_color)}},backgroundPattern:function(S,E){return{u_matrix:new p.UniformMatrix4f(S,E.u_matrix),u_opacity:new p.Uniform1f(S,E.u_opacity),u_image:new p.Uniform1i(S,E.u_image),u_pattern_tl_a:new p.Uniform2f(S,E.u_pattern_tl_a),u_pattern_br_a:new p.Uniform2f(S,E.u_pattern_br_a),u_pattern_tl_b:new p.Uniform2f(S,E.u_pattern_tl_b),u_pattern_br_b:new p.Uniform2f(S,E.u_pattern_br_b),u_texsize:new p.Uniform2f(S,E.u_texsize),u_mix:new p.Uniform1f(S,E.u_mix),u_pattern_size_a:new p.Uniform2f(S,E.u_pattern_size_a),u_pattern_size_b:new p.Uniform2f(S,E.u_pattern_size_b),u_scale_a:new p.Uniform1f(S,E.u_scale_a),u_scale_b:new p.Uniform1f(S,E.u_scale_b),u_pixel_coord_upper:new p.Uniform2f(S,E.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(S,E.u_pixel_coord_lower),u_tile_units_to_pixels:new p.Uniform1f(S,E.u_tile_units_to_pixels)}}};function cd(S,E,T,M,B,W,Y){for(var re=S.context,ye=re.gl,Ae=S.useProgram("collisionBox"),Ze=[],Je=0,ke=0,ut=0;ut<M.length;ut++){var ht=M[ut],Ct=E.getTile(ht),lt=Ct.getBucket(T);if(lt){var It=ht.posMatrix;B[0]===0&&B[1]===0||(It=S.translatePosMatrix(ht.posMatrix,Ct,B,W));var Lt=Y?lt.textCollisionBox:lt.iconCollisionBox,Jt=lt.collisionCircleArray;if(Jt.length>0){var vr=p.create(),mr=It;p.mul(vr,lt.placementInvProjMatrix,S.transform.glCoordMatrix),p.mul(vr,vr,lt.placementViewportMatrix),Ze.push({circleArray:Jt,circleOffset:ke,transform:mr,invTransform:vr}),ke=Je+=Jt.length/4}Lt&&Ae.draw(re,ye.LINES,et.disabled,it.disabled,S.colorModeForRenderPass(),$e.disabled,lu(It,S.transform,Ct),T.id,Lt.layoutVertexBuffer,Lt.indexBuffer,Lt.segments,null,S.transform.zoom,null,null,Lt.collisionVertexBuffer)}}if(Y&&Ze.length){var wr=S.useProgram("collisionCircle"),Ur=new p.StructArrayLayout2f1f2i16;Ur.resize(4*Je),Ur._trim();for(var on=0,Hr=0,mn=Ze;Hr<mn.length;Hr+=1)for(var Yn=mn[Hr],ni=0;ni<Yn.circleArray.length/4;ni++){var Jn=4*ni,io=Yn.circleArray[Jn+0],An=Yn.circleArray[Jn+1],Qn=Yn.circleArray[Jn+2],$n=Yn.circleArray[Jn+3];Ur.emplace(on++,io,An,Qn,$n,0),Ur.emplace(on++,io,An,Qn,$n,1),Ur.emplace(on++,io,An,Qn,$n,2),Ur.emplace(on++,io,An,Qn,$n,3)}(!ad||ad.length<2*Je)&&(ad=function(ra){var Ka=2*ra,Dr=new p.StructArrayLayout3ui6;Dr.resize(Ka),Dr._trim();for(var an=0;an<Ka;an++){var na=6*an;Dr.uint16[na+0]=4*an+0,Dr.uint16[na+1]=4*an+1,Dr.uint16[na+2]=4*an+2,Dr.uint16[na+3]=4*an+2,Dr.uint16[na+4]=4*an+3,Dr.uint16[na+5]=4*an+0}return Dr}(Je));for(var vi=re.createIndexBuffer(ad,!0),xi=re.createVertexBuffer(Ur,p.collisionCircleLayout.members,!0),Ii=0,yi=Ze;Ii<yi.length;Ii+=1){var ii=yi[Ii],is=Ol(ii.transform,ii.invTransform,S.transform);wr.draw(re,ye.TRIANGLES,et.disabled,it.disabled,S.colorModeForRenderPass(),$e.disabled,is,T.id,xi,vi,p.SegmentVector.simpleSegment(0,2*ii.circleOffset,ii.circleArray.length,ii.circleArray.length/2),null,S.transform.zoom,null,null,null)}xi.destroy(),vi.destroy()}}var gc=p.identity(new Float32Array(16));function Bm(S,E,T,M,B,W){var Y=p.getAnchorAlignment(S),re=-(Y.horizontalAlign-.5)*E,ye=-(Y.verticalAlign-.5)*T,Ae=p.evaluateVariableOffset(S,M);return new p.Point((re/B+Ae[0])*W,(ye/B+Ae[1])*W)}function Bf(S,E,T,M,B,W,Y,re,ye,Ae,Ze){var Je=S.text.placedSymbolArray,ke=S.text.dynamicLayoutVertexArray,ut=S.icon.dynamicLayoutVertexArray,ht={};ke.clear();for(var Ct=0;Ct<Je.length;Ct++){var lt=Je.get(Ct),It=lt.hidden||!lt.crossTileID||S.allowVerticalPlacement&&!lt.placedOrientation?null:M[lt.crossTileID];if(It){var Lt=new p.Point(lt.anchorX,lt.anchorY),Jt=Ni(Lt,T?re:Y),vr=qi(W.cameraToCenterDistance,Jt.signedDistanceFromCamera),mr=B.evaluateSizeForFeature(S.textSizeData,Ae,lt)*vr/p.ONE_EM;T&&(mr*=S.tilePixelRatio/ye);for(var wr=Bm(It.anchor,It.width,It.height,It.textOffset,It.textBoxScale,mr),Ur=T?Ni(Lt.add(wr),Y).point:Jt.point.add(E?wr.rotate(-W.angle):wr),on=S.allowVerticalPlacement&&lt.placedOrientation===p.WritingMode.vertical?Math.PI/2:0,Hr=0;Hr<lt.numGlyphs;Hr++)p.addDynamicAttributes(ke,Ur,on);Ze&&lt.associatedIconIndex>=0&&(ht[lt.associatedIconIndex]={shiftedAnchor:Ur,angle:on})}else po(lt.numGlyphs,ke)}if(Ze){ut.clear();for(var mn=S.icon.placedSymbolArray,Yn=0;Yn<mn.length;Yn++){var ni=mn.get(Yn);if(ni.hidden)po(ni.numGlyphs,ut);else{var Jn=ht[Yn];if(Jn)for(var io=0;io<ni.numGlyphs;io++)p.addDynamicAttributes(ut,Jn.shiftedAnchor,Jn.angle);else po(ni.numGlyphs,ut)}}S.icon.dynamicLayoutVertexBuffer.updateData(ut)}S.text.dynamicLayoutVertexBuffer.updateData(ke)}function ud(S,E,T){return T.iconsInText&&E?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function bh(S,E,T,M,B,W,Y,re,ye,Ae,Ze,Je){for(var ke=S.context,ut=ke.gl,ht=S.transform,Ct=re==="map",lt=ye==="map",It=Ct&&T.layout.get("symbol-placement")!=="point",Lt=Ct&&!lt&&!It,Jt=T.layout.get("symbol-sort-key").constantOr(1)!==void 0,vr=!1,mr=S.depthModeForSublayer(0,et.ReadOnly),wr=T.layout.get("text-variable-anchor"),Ur=[],on=0,Hr=M;on<Hr.length;on+=1){var mn=Hr[on],Yn=E.getTile(mn),ni=Yn.getBucket(T);if(ni){var Jn=B?ni.text:ni.icon;if(Jn&&Jn.segments.get().length){var io=Jn.programConfigurations.get(T.id),An=B||ni.sdfIcons,Qn=B?ni.textSizeData:ni.iconSizeData,$n=lt||ht.pitch!==0,vi=S.useProgram(ud(An,B,ni),io),xi=p.evaluateSizeForZoom(Qn,ht.zoom),Ii=void 0,yi=[0,0],ii=void 0,is=void 0,ra=null,Ka=void 0;if(B)ii=Yn.glyphAtlasTexture,is=ut.LINEAR,Ii=Yn.glyphAtlasTexture.size,ni.iconsInText&&(yi=Yn.imageAtlasTexture.size,ra=Yn.imageAtlasTexture,Ka=$n||S.options.rotating||S.options.zooming||Qn.kind==="composite"||Qn.kind==="camera"?ut.LINEAR:ut.NEAREST);else{var Dr=T.layout.get("icon-size").constantOr(0)!==1||ni.iconsNeedLinear;ii=Yn.imageAtlasTexture,is=An||S.options.rotating||S.options.zooming||Dr||$n?ut.LINEAR:ut.NEAREST,Ii=Yn.imageAtlasTexture.size}var an=Uo(Yn,1,S.transform.zoom),na=xo(mn.posMatrix,lt,Ct,S.transform,an),go=so(mn.posMatrix,lt,Ct,S.transform,an),os=wr&&ni.hasTextData(),rc=T.layout.get("icon-text-fit")!=="none"&&os&&ni.hasIconData();It&&kl(ni,mn.posMatrix,S,B,na,go,lt,Ae);var jt=S.translatePosMatrix(mn.posMatrix,Yn,W,Y),jl=It||B&&wr||rc?gc:na,Pa=S.translatePosMatrix(go,Yn,W,Y,!0),wd=An&&T.paint.get(B?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ku={program:vi,buffers:Jn,uniformValues:An?ni.iconsInText?Zp(Qn.kind,xi,Lt,lt,S,jt,jl,Pa,Ii,yi):Bc(Qn.kind,xi,Lt,lt,S,jt,jl,Pa,B,Ii,!0):sd(Qn.kind,xi,Lt,lt,S,jt,jl,Pa,B,Ii),atlasTexture:ii,atlasTextureIcon:ra,atlasInterpolation:is,atlasInterpolationIcon:Ka,isSDF:An,hasHalo:wd};if(Jt&&ni.canOverlap){vr=!0;for(var Bl=0,Sd=Jn.segments.get();Bl<Sd.length;Bl+=1){var fp=Sd[Bl];Ur.push({segments:new p.SegmentVector([fp]),sortKey:fp.sortKey,state:Ku})}}else Ur.push({segments:Jn.segments,sortKey:0,state:Ku})}}}vr&&Ur.sort(function(nc,Vc){return nc.sortKey-Vc.sortKey});for(var bc=0,vu=Ur;bc<vu.length;bc+=1){var wl=vu[bc],qa=wl.state;if(ke.activeTexture.set(ut.TEXTURE0),qa.atlasTexture.bind(qa.atlasInterpolation,ut.CLAMP_TO_EDGE),qa.atlasTextureIcon&&(ke.activeTexture.set(ut.TEXTURE1),qa.atlasTextureIcon&&qa.atlasTextureIcon.bind(qa.atlasInterpolationIcon,ut.CLAMP_TO_EDGE)),qa.isSDF){var Fc=qa.uniformValues;qa.hasHalo&&(Fc.u_is_halo=1,Bu(qa.buffers,wl.segments,T,S,qa.program,mr,Ze,Je,Fc)),Fc.u_is_halo=0}Bu(qa.buffers,wl.segments,T,S,qa.program,mr,Ze,Je,qa.uniformValues)}}function Bu(S,E,T,M,B,W,Y,re,ye){var Ae=M.context;B.draw(Ae,Ae.gl.TRIANGLES,W,Y,re,$e.disabled,ye,T.id,S.layoutVertexBuffer,S.indexBuffer,E,T.paint,M.transform.zoom,S.programConfigurations.get(T.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function hd(S,E,T,M,B,W,Y){var re,ye,Ae,Ze,Je,ke=S.context.gl,ut=T.paint.get("fill-pattern"),ht=ut&&ut.constantOr(1),Ct=T.getCrossfadeParameters();Y?(ye=ht&&!T.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",re=ke.LINES):(ye=ht?"fillPattern":"fill",re=ke.TRIANGLES);for(var lt=0,It=M;lt<It.length;lt+=1){var Lt=It[lt],Jt=E.getTile(Lt);if(!ht||Jt.patternsLoaded()){var vr=Jt.getBucket(T);if(vr){var mr=vr.programConfigurations.get(T.id),wr=S.useProgram(ye,mr);ht&&(S.context.activeTexture.set(ke.TEXTURE0),Jt.imageAtlasTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),mr.updatePaintBuffers(Ct));var Ur=ut.constantOr(null);if(Ur&&Jt.imageAtlas){var on=Jt.imageAtlas,Hr=on.patternPositions[Ur.to.toString()],mn=on.patternPositions[Ur.from.toString()];Hr&&mn&&mr.setConstantPatternPositions(Hr,mn)}var Yn=S.translatePosMatrix(Lt.posMatrix,Jt,T.paint.get("fill-translate"),T.paint.get("fill-translate-anchor"));if(Y){Ze=vr.indexBuffer2,Je=vr.segments2;var ni=[ke.drawingBufferWidth,ke.drawingBufferHeight];Ae=ye==="fillOutlinePattern"&&ht?od(Yn,S,Ct,Jt,ni):np(Yn,ni)}else Ze=vr.indexBuffer,Je=vr.segments,Ae=ht?Yl(Yn,S,Ct,Jt):zc(Yn);wr.draw(S.context,re,B,S.stencilModeForClipping(Lt),W,$e.disabled,Ae,T.id,vr.layoutVertexBuffer,Ze,Je,T.paint,S.transform.zoom,mr)}}}}function Yp(S,E,T,M,B,W,Y){for(var re=S.context,ye=re.gl,Ae=T.paint.get("fill-extrusion-pattern"),Ze=Ae.constantOr(1),Je=T.getCrossfadeParameters(),ke=T.paint.get("fill-extrusion-opacity"),ut=0,ht=M;ut<ht.length;ut+=1){var Ct=ht[ut],lt=E.getTile(Ct),It=lt.getBucket(T);if(It){var Lt=It.programConfigurations.get(T.id),Jt=S.useProgram(Ze?"fillExtrusionPattern":"fillExtrusion",Lt);Ze&&(S.context.activeTexture.set(ye.TEXTURE0),lt.imageAtlasTexture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Lt.updatePaintBuffers(Je));var vr=Ae.constantOr(null);if(vr&&lt.imageAtlas){var mr=lt.imageAtlas,wr=mr.patternPositions[vr.to.toString()],Ur=mr.patternPositions[vr.from.toString()];wr&&Ur&&Lt.setConstantPatternPositions(wr,Ur)}var on=S.translatePosMatrix(Ct.posMatrix,lt,T.paint.get("fill-extrusion-translate"),T.paint.get("fill-extrusion-translate-anchor")),Hr=T.paint.get("fill-extrusion-vertical-gradient"),mn=Ze?su(on,S,Hr,ke,Ct,Je,lt):qp(on,S,Hr,ke);Jt.draw(re,re.gl.TRIANGLES,B,W,Y,$e.backCCW,mn,T.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,T.paint,S.transform.zoom,Lt)}}}function dd(S,E,T,M,B,W){var Y=S.context,re=Y.gl,ye=E.fbo;if(ye){var Ae=S.useProgram("hillshade");Y.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,ye.colorAttachment.get());var Ze=function(Je,ke,ut){var ht=ut.paint.get("hillshade-shadow-color"),Ct=ut.paint.get("hillshade-highlight-color"),lt=ut.paint.get("hillshade-accent-color"),It=ut.paint.get("hillshade-illumination-direction")*(Math.PI/180);ut.paint.get("hillshade-illumination-anchor")==="viewport"&&(It-=Je.transform.angle);var Lt,Jt,vr,mr=!Je.options.moving;return{u_matrix:Je.transform.calculatePosMatrix(ke.tileID.toUnwrapped(),mr),u_image:0,u_latrange:(Lt=ke.tileID,Jt=Math.pow(2,Lt.canonical.z),vr=Lt.canonical.y,[new p.MercatorCoordinate(0,vr/Jt).toLngLat().lat,new p.MercatorCoordinate(0,(vr+1)/Jt).toLngLat().lat]),u_light:[ut.paint.get("hillshade-exaggeration"),It],u_shadow:ht,u_highlight:Ct,u_accent:lt}}(S,E,T);Ae.draw(Y,re.TRIANGLES,M,B,W,$e.disabled,Ze,T.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}}function Kp(S,E,T,M,B,W){var Y=S.context,re=Y.gl,ye=E.dem;if(ye&&ye.data){var Ae=ye.dim,Ze=ye.stride,Je=ye.getPixels();if(Y.activeTexture.set(re.TEXTURE1),Y.pixelStoreUnpackPremultiplyAlpha.set(!1),E.demTexture=E.demTexture||S.getTileTexture(Ze),E.demTexture){var ke=E.demTexture;ke.update(Je,{premultiply:!1}),ke.bind(re.NEAREST,re.CLAMP_TO_EDGE)}else E.demTexture=new p.Texture(Y,Je,re.RGBA,{premultiply:!1}),E.demTexture.bind(re.NEAREST,re.CLAMP_TO_EDGE);Y.activeTexture.set(re.TEXTURE0);var ut=E.fbo;if(!ut){var ht=new p.Texture(Y,{width:Ae,height:Ae,data:null},re.RGBA);ht.bind(re.LINEAR,re.CLAMP_TO_EDGE),(ut=E.fbo=Y.createFramebuffer(Ae,Ae,!0)).colorAttachment.set(ht.texture)}Y.bindFramebuffer.set(ut.framebuffer),Y.viewport.set([0,0,Ae,Ae]),S.useProgram("hillshadePrepare").draw(Y,re.TRIANGLES,M,B,W,$e.disabled,function(Ct,lt){var It=lt.stride,Lt=p.create();return p.ortho(Lt,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(Lt,Lt,[0,-p.EXTENT,0]),{u_matrix:Lt,u_image:1,u_dimension:[It,It],u_zoom:Ct.overscaledZ,u_unpack:lt.getUnpackVector()}}(E.tileID,ye),T.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments),E.needsHillshadePrepare=!1}}function pd(S,E,T,M,B){var W=M.paint.get("raster-fade-duration");if(W>0){var Y=p.browser.now(),re=(Y-S.timeAdded)/W,ye=E?(Y-E.timeAdded)/W:-1,Ae=T.getSource(),Ze=B.coveringZoomLevel({tileSize:Ae.tileSize,roundZoom:Ae.roundZoom}),Je=!E||Math.abs(E.tileID.overscaledZ-Ze)>Math.abs(S.tileID.overscaledZ-Ze),ke=Je&&S.refreshedUponExpiration?1:p.clamp(Je?re:1-ye,0,1);return S.refreshedUponExpiration&&re>=1&&(S.refreshedUponExpiration=!1),E?{opacity:1,mix:1-ke}:{opacity:ke,mix:0}}return{opacity:1,mix:0}}var uu=new p.Color(1,0,0,1),ip=new p.Color(0,1,0,1),fd=new p.Color(0,0,1,1),md=new p.Color(1,0,1,1),wh=new p.Color(0,1,1,1);function Fu(S,E,T,M){hu(S,0,E+T/2,S.transform.width,T,M)}function Vu(S,E,T,M){hu(S,E-T/2,0,T,S.transform.height,M)}function hu(S,E,T,M,B,W){var Y=S.context,re=Y.gl;re.enable(re.SCISSOR_TEST),re.scissor(E*p.browser.devicePixelRatio,T*p.browser.devicePixelRatio,M*p.browser.devicePixelRatio,B*p.browser.devicePixelRatio),Y.clear({color:W}),re.disable(re.SCISSOR_TEST)}function gd(S,E,T){var M=S.context,B=M.gl,W=T.posMatrix,Y=S.useProgram("debug"),re=et.disabled,ye=it.disabled,Ae=S.colorModeForRenderPass();M.activeTexture.set(B.TEXTURE0),S.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Y.draw(M,B.LINE_STRIP,re,ye,Ae,$e.disabled,Jr(W,p.Color.red),"$debug",S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments);var Ze=E.getTileByID(T.key).latestRawTileData,Je=Math.floor((Ze&&Ze.byteLength||0)/1024),ke=E.getTile(T).tileSize,ut=512/Math.min(ke,512)*(T.overscaledZ/S.transform.zoom)*.5,ht=T.canonical.toString();T.overscaledZ!==T.canonical.z&&(ht+=" => "+T.overscaledZ),function(Ct,lt){Ct.initDebugOverlayCanvas();var It=Ct.debugOverlayCanvas,Lt=Ct.context.gl,Jt=Ct.debugOverlayCanvas.getContext("2d");Jt.clearRect(0,0,It.width,It.height),Jt.shadowColor="white",Jt.shadowBlur=2,Jt.lineWidth=1.5,Jt.strokeStyle="white",Jt.textBaseline="top",Jt.font="bold 36px Open Sans, sans-serif",Jt.fillText(lt,5,5),Jt.strokeText(lt,5,5),Ct.debugOverlayTexture.update(It),Ct.debugOverlayTexture.bind(Lt.LINEAR,Lt.CLAMP_TO_EDGE)}(S,ht+" "+Je+"kb"),Y.draw(M,B.TRIANGLES,re,ye,wt.alphaBlended,$e.disabled,Jr(W,p.Color.transparent,ut),"$debug",S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments)}var Aa={symbol:function(S,E,T,M,B){if(S.renderPass==="translucent"){var W=it.disabled,Y=S.colorModeForRenderPass();T.layout.get("text-variable-anchor")&&function(re,ye,Ae,Ze,Je,ke,ut){for(var ht=ye.transform,Ct=Je==="map",lt=ke==="map",It=0,Lt=re;It<Lt.length;It+=1){var Jt=Lt[It],vr=Ze.getTile(Jt),mr=vr.getBucket(Ae);if(mr&&mr.text&&mr.text.segments.get().length){var wr=p.evaluateSizeForZoom(mr.textSizeData,ht.zoom),Ur=Uo(vr,1,ye.transform.zoom),on=xo(Jt.posMatrix,lt,Ct,ye.transform,Ur),Hr=Ae.layout.get("icon-text-fit")!=="none"&&mr.hasIconData();if(wr){var mn=Math.pow(2,ht.zoom-vr.tileID.overscaledZ);Bf(mr,Ct,lt,ut,p.symbolSize,ht,on,Jt.posMatrix,mn,wr,Hr)}}}}(M,S,T,E,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),B),T.paint.get("icon-opacity").constantOr(1)!==0&&bh(S,E,T,M,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),W,Y),T.paint.get("text-opacity").constantOr(1)!==0&&bh(S,E,T,M,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),W,Y),E.map.showCollisionBoxes&&(cd(S,E,T,M,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),!0),cd(S,E,T,M,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),!1))}},circle:function(S,E,T,M){if(S.renderPass==="translucent"){var B=T.paint.get("circle-opacity"),W=T.paint.get("circle-stroke-width"),Y=T.paint.get("circle-stroke-opacity"),re=T.layout.get("circle-sort-key").constantOr(1)!==void 0;if(B.constantOr(1)!==0||W.constantOr(1)!==0&&Y.constantOr(1)!==0){for(var ye=S.context,Ae=ye.gl,Ze=S.depthModeForSublayer(0,et.ReadOnly),Je=it.disabled,ke=S.colorModeForRenderPass(),ut=[],ht=0;ht<M.length;ht++){var Ct=M[ht],lt=E.getTile(Ct),It=lt.getBucket(T);if(It){var Lt=It.programConfigurations.get(T.id),Jt={programConfiguration:Lt,program:S.useProgram("circle",Lt),layoutVertexBuffer:It.layoutVertexBuffer,indexBuffer:It.indexBuffer,uniformValues:Nc(S,Ct,lt,T)};if(re)for(var vr=0,mr=It.segments.get();vr<mr.length;vr+=1){var wr=mr[vr];ut.push({segments:new p.SegmentVector([wr]),sortKey:wr.sortKey,state:Jt})}else ut.push({segments:It.segments,sortKey:0,state:Jt})}}re&&ut.sort(function(Yn,ni){return Yn.sortKey-ni.sortKey});for(var Ur=0,on=ut;Ur<on.length;Ur+=1){var Hr=on[Ur],mn=Hr.state;mn.program.draw(ye,Ae.TRIANGLES,Ze,Je,ke,$e.disabled,mn.uniformValues,T.id,mn.layoutVertexBuffer,mn.indexBuffer,Hr.segments,T.paint,S.transform.zoom,mn.programConfiguration)}}}},heatmap:function(S,E,T,M){if(T.paint.get("heatmap-opacity")!==0)if(S.renderPass==="offscreen"){var B=S.context,W=B.gl,Y=it.disabled,re=new wt([W.ONE,W.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(ut,ht,Ct){var lt=ut.gl;ut.activeTexture.set(lt.TEXTURE1),ut.viewport.set([0,0,ht.width/4,ht.height/4]);var It=Ct.heatmapFbo;if(It)lt.bindTexture(lt.TEXTURE_2D,It.colorAttachment.get()),ut.bindFramebuffer.set(It.framebuffer);else{var Lt=lt.createTexture();lt.bindTexture(lt.TEXTURE_2D,Lt),lt.texParameteri(lt.TEXTURE_2D,lt.TEXTURE_WRAP_S,lt.CLAMP_TO_EDGE),lt.texParameteri(lt.TEXTURE_2D,lt.TEXTURE_WRAP_T,lt.CLAMP_TO_EDGE),lt.texParameteri(lt.TEXTURE_2D,lt.TEXTURE_MIN_FILTER,lt.LINEAR),lt.texParameteri(lt.TEXTURE_2D,lt.TEXTURE_MAG_FILTER,lt.LINEAR),It=Ct.heatmapFbo=ut.createFramebuffer(ht.width/4,ht.height/4,!1),function(Jt,vr,mr,wr){var Ur=Jt.gl;Ur.texImage2D(Ur.TEXTURE_2D,0,Ur.RGBA,vr.width/4,vr.height/4,0,Ur.RGBA,Jt.extRenderToTextureHalfFloat?Jt.extTextureHalfFloat.HALF_FLOAT_OES:Ur.UNSIGNED_BYTE,null),wr.colorAttachment.set(mr)}(ut,ht,Lt,It)}})(B,S,T),B.clear({color:p.Color.transparent});for(var ye=0;ye<M.length;ye++){var Ae=M[ye];if(!E.hasRenderableParent(Ae)){var Ze=E.getTile(Ae),Je=Ze.getBucket(T);if(Je){var ke=Je.programConfigurations.get(T.id);S.useProgram("heatmap",ke).draw(B,W.TRIANGLES,et.disabled,Y,re,$e.disabled,Wp(Ae.posMatrix,Ze,S.transform.zoom,T.paint.get("heatmap-intensity")),T.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,T.paint,S.transform.zoom,ke)}}}B.viewport.set([0,0,S.width,S.height])}else S.renderPass==="translucent"&&(S.context.setColorMode(S.colorModeForRenderPass()),function(ut,ht){var Ct=ut.context,lt=Ct.gl,It=ht.heatmapFbo;if(It){Ct.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,It.colorAttachment.get()),Ct.activeTexture.set(lt.TEXTURE1);var Lt=ht.colorRampTexture;Lt||(Lt=ht.colorRampTexture=new p.Texture(Ct,ht.colorRamp,lt.RGBA)),Lt.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),ut.useProgram("heatmapTexture").draw(Ct,lt.TRIANGLES,et.disabled,it.disabled,ut.colorModeForRenderPass(),$e.disabled,function(Jt,vr,mr,wr){var Ur=p.create();p.ortho(Ur,0,Jt.width,Jt.height,0,0,1);var on=Jt.context.gl;return{u_matrix:Ur,u_world:[on.drawingBufferWidth,on.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:vr.paint.get("heatmap-opacity")}}(ut,ht),ht.id,ut.viewportBuffer,ut.quadTriangleIndexBuffer,ut.viewportSegments,ht.paint,ut.transform.zoom)}}(S,T))},line:function(S,E,T,M){if(S.renderPass==="translucent"){var B=T.paint.get("line-opacity"),W=T.paint.get("line-width");if(B.constantOr(1)!==0&&W.constantOr(1)!==0)for(var Y=S.depthModeForSublayer(0,et.ReadOnly),re=S.colorModeForRenderPass(),ye=T.paint.get("line-dasharray"),Ae=T.paint.get("line-pattern"),Ze=Ae.constantOr(1),Je=T.paint.get("line-gradient"),ke=T.getCrossfadeParameters(),ut=Ze?"linePattern":ye?"lineSDF":Je?"lineGradient":"line",ht=S.context,Ct=ht.gl,lt=!0,It=0,Lt=M;It<Lt.length;It+=1){var Jt=Lt[It],vr=E.getTile(Jt);if(!Ze||vr.patternsLoaded()){var mr=vr.getBucket(T);if(mr){var wr=mr.programConfigurations.get(T.id),Ur=S.context.program.get(),on=S.useProgram(ut,wr),Hr=lt||on.program!==Ur,mn=Ae.constantOr(null);if(mn&&vr.imageAtlas){var Yn=vr.imageAtlas,ni=Yn.patternPositions[mn.to.toString()],Jn=Yn.patternPositions[mn.from.toString()];ni&&Jn&&wr.setConstantPatternPositions(ni,Jn)}var io=Ze?fc(S,vr,T,ke):ye?mc(S,vr,T,ye,ke):Je?Go(S,vr,T,mr.lineClipsArray.length):cu(S,vr,T);if(Ze)ht.activeTexture.set(Ct.TEXTURE0),vr.imageAtlasTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE),wr.updatePaintBuffers(ke);else if(ye&&(Hr||S.lineAtlas.dirty))ht.activeTexture.set(Ct.TEXTURE0),S.lineAtlas.bind(ht);else if(Je){var An=mr.gradients[T.id],Qn=An.texture;if(T.gradientVersion!==An.version){var $n=256;if(T.stepInterpolant){var vi=E.getSource().maxzoom,xi=Jt.canonical.z===vi?Math.ceil(1<<S.transform.maxZoom-Jt.canonical.z):1;$n=p.clamp(p.nextPowerOfTwo(mr.maxLineLength/p.EXTENT*1024*xi),256,ht.maxTextureSize)}An.gradient=p.renderColorRamp({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:$n,image:An.gradient||void 0,clips:mr.lineClipsArray}),An.texture?An.texture.update(An.gradient):An.texture=new p.Texture(ht,An.gradient,Ct.RGBA),An.version=T.gradientVersion,Qn=An.texture}ht.activeTexture.set(Ct.TEXTURE0),Qn.bind(T.stepInterpolant?Ct.NEAREST:Ct.LINEAR,Ct.CLAMP_TO_EDGE)}on.draw(ht,Ct.TRIANGLES,Y,S.stencilModeForClipping(Jt),re,$e.disabled,io,T.id,mr.layoutVertexBuffer,mr.indexBuffer,mr.segments,T.paint,S.transform.zoom,wr,mr.layoutVertexBuffer2),lt=!1}}}}},fill:function(S,E,T,M){var B=T.paint.get("fill-color"),W=T.paint.get("fill-opacity");if(W.constantOr(1)!==0){var Y=S.colorModeForRenderPass(),re=T.paint.get("fill-pattern"),ye=S.opaquePassEnabledForLayer()&&!re.constantOr(1)&&B.constantOr(p.Color.transparent).a===1&&W.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ye){var Ae=S.depthModeForSublayer(1,S.renderPass==="opaque"?et.ReadWrite:et.ReadOnly);hd(S,E,T,M,Ae,Y,!1)}if(S.renderPass==="translucent"&&T.paint.get("fill-antialias")){var Ze=S.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,et.ReadOnly);hd(S,E,T,M,Ze,Y,!0)}}},"fill-extrusion":function(S,E,T,M){var B=T.paint.get("fill-extrusion-opacity");if(B!==0&&S.renderPass==="translucent"){var W=new et(S.context.gl.LEQUAL,et.ReadWrite,S.depthRangeFor3D);if(B!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))Yp(S,E,T,M,W,it.disabled,wt.disabled),Yp(S,E,T,M,W,S.stencilModeFor3D(),S.colorModeForRenderPass());else{var Y=S.colorModeForRenderPass();Yp(S,E,T,M,W,it.disabled,Y)}}},hillshade:function(S,E,T,M){if(S.renderPass==="offscreen"||S.renderPass==="translucent"){for(var B=S.context,W=S.depthModeForSublayer(0,et.ReadOnly),Y=S.colorModeForRenderPass(),re=S.renderPass==="translucent"?S.stencilConfigForOverlap(M):[{},M],ye=re[0],Ae=0,Ze=re[1];Ae<Ze.length;Ae+=1){var Je=Ze[Ae],ke=E.getTile(Je);ke.needsHillshadePrepare&&S.renderPass==="offscreen"?Kp(S,ke,T,W,it.disabled,Y):S.renderPass==="translucent"&&dd(S,ke,T,W,ye[Je.overscaledZ],Y)}B.viewport.set([0,0,S.width,S.height])}},raster:function(S,E,T,M){if(S.renderPass==="translucent"&&T.paint.get("raster-opacity")!==0&&M.length)for(var B=S.context,W=B.gl,Y=E.getSource(),re=S.useProgram("raster"),ye=S.colorModeForRenderPass(),Ae=Y instanceof vn?[{},M]:S.stencilConfigForOverlap(M),Ze=Ae[0],Je=Ae[1],ke=Je[Je.length-1].overscaledZ,ut=!S.options.moving,ht=0,Ct=Je;ht<Ct.length;ht+=1){var lt=Ct[ht],It=S.depthModeForSublayer(lt.overscaledZ-ke,T.paint.get("raster-opacity")===1?et.ReadWrite:et.ReadOnly,W.LESS),Lt=E.getTile(lt),Jt=S.transform.calculatePosMatrix(lt.toUnwrapped(),ut);Lt.registerFadeDuration(T.paint.get("raster-fade-duration"));var vr=E.findLoadedParent(lt,0),mr=pd(Lt,vr,E,T,S.transform),wr=void 0,Ur=void 0,on=T.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR;B.activeTexture.set(W.TEXTURE0),Lt.texture.bind(on,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(W.TEXTURE1),vr?(vr.texture.bind(on,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST),wr=Math.pow(2,vr.tileID.overscaledZ-Lt.tileID.overscaledZ),Ur=[Lt.tileID.canonical.x*wr%1,Lt.tileID.canonical.y*wr%1]):Lt.texture.bind(on,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);var Hr=Hp(Jt,Ur||[0,0],wr||1,mr,T);Y instanceof vn?re.draw(B,W.TRIANGLES,It,it.disabled,ye,$e.disabled,Hr,T.id,Y.boundsBuffer,S.quadTriangleIndexBuffer,Y.boundsSegments):re.draw(B,W.TRIANGLES,It,Ze[lt.overscaledZ],ye,$e.disabled,Hr,T.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}},background:function(S,E,T){var M=T.paint.get("background-color"),B=T.paint.get("background-opacity");if(B!==0){var W=S.context,Y=W.gl,re=S.transform,ye=re.tileSize,Ae=T.paint.get("background-pattern");if(!S.isPatternMissing(Ae)){var Ze=!Ae&&M.a===1&&B===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass===Ze){var Je=it.disabled,ke=S.depthModeForSublayer(0,Ze==="opaque"?et.ReadWrite:et.ReadOnly),ut=S.colorModeForRenderPass(),ht=S.useProgram(Ae?"backgroundPattern":"background"),Ct=re.coveringTiles({tileSize:ye});Ae&&(W.activeTexture.set(Y.TEXTURE0),S.imageManager.bind(S.context));for(var lt=T.getCrossfadeParameters(),It=0,Lt=Ct;It<Lt.length;It+=1){var Jt=Lt[It],vr=S.transform.calculatePosMatrix(Jt.toUnwrapped()),mr=Ae?xh(vr,B,S,Ae,{tileID:Jt,tileSize:ye},lt):ld(vr,B,M);ht.draw(W,Y.TRIANGLES,ke,Je,ut,$e.disabled,mr,T.id,S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}}}}},debug:function(S,E,T){for(var M=0;M<T.length;M++)gd(S,E,T[M])},custom:function(S,E,T){var M=S.context,B=T.implementation;if(S.renderPass==="offscreen"){var W=B.prerender;W&&(S.setCustomLayerDefaults(),M.setColorMode(S.colorModeForRenderPass()),W.call(B,M.gl,S.transform.customLayerMatrix()),M.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),M.setColorMode(S.colorModeForRenderPass()),M.setStencilMode(it.disabled);var Y=B.renderingMode==="3d"?new et(S.context.gl.LEQUAL,et.ReadWrite,S.depthRangeFor3D):S.depthModeForSublayer(0,et.ReadOnly);M.setDepthMode(Y),B.render(M.gl,S.transform.customLayerMatrix()),M.setDirty(),S.setBaseState(),M.bindFramebuffer.set(null)}}},Oo=function(S,E){this.context=new ve(S),this.transform=E,this._tileTextures={},this.setup(),this.numSublayers=Le.maxUnderzooming+Le.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ru,this.gpuTimers={}};Oo.prototype.resize=function(S,E){if(this.width=S*p.browser.devicePixelRatio,this.height=E*p.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var T=0,M=this.style._order;T<M.length;T+=1)this.style._layers[M[T]].resize()},Oo.prototype.setup=function(){var S=this.context,E=new p.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(p.EXTENT,0),E.emplaceBack(0,p.EXTENT),E.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=S.createVertexBuffer(E,lo.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);var T=new p.StructArrayLayout2i4;T.emplaceBack(0,0),T.emplaceBack(p.EXTENT,0),T.emplaceBack(0,p.EXTENT),T.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=S.createVertexBuffer(T,lo.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);var M=new p.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(p.EXTENT,0,p.EXTENT,0),M.emplaceBack(0,p.EXTENT,0,p.EXTENT),M.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.rasterBoundsBuffer=S.createVertexBuffer(M,ln.members),this.rasterBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);var B=new p.StructArrayLayout2i4;B.emplaceBack(0,0),B.emplaceBack(1,0),B.emplaceBack(0,1),B.emplaceBack(1,1),this.viewportBuffer=S.createVertexBuffer(B,lo.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);var W=new p.StructArrayLayout1ui2;W.emplaceBack(0),W.emplaceBack(1),W.emplaceBack(3),W.emplaceBack(2),W.emplaceBack(0),this.tileBorderIndexBuffer=S.createIndexBuffer(W);var Y=new p.StructArrayLayout3ui6;Y.emplaceBack(0,1,2),Y.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=S.createIndexBuffer(Y),this.emptyTexture=new p.Texture(S,{width:1,height:1,data:new Uint8Array([0,0,0,0])},S.gl.RGBA);var re=this.context.gl;this.stencilClearMode=new it({func:re.ALWAYS,mask:0},0,255,re.ZERO,re.ZERO,re.ZERO)},Oo.prototype.clearStencil=function(){var S=this.context,E=S.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var T=p.create();p.ortho(T,0,this.width,this.height,0,0,1),p.scale(T,T,[E.drawingBufferWidth,E.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(S,E.TRIANGLES,et.disabled,this.stencilClearMode,wt.disabled,$e.disabled,jc(T),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Oo.prototype._renderTileClippingMasks=function(S,E){if(this.currentStencilSource!==S.source&&S.isTileClipped()&&E&&E.length){this.currentStencilSource=S.source;var T=this.context,M=T.gl;this.nextStencilID+E.length>256&&this.clearStencil(),T.setColorMode(wt.disabled),T.setDepthMode(et.disabled);var B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var W=0,Y=E;W<Y.length;W+=1){var re=Y[W],ye=this._tileClippingMaskIDs[re.key]=this.nextStencilID++;B.draw(T,M.TRIANGLES,et.disabled,new it({func:M.ALWAYS,mask:0},ye,255,M.KEEP,M.KEEP,M.REPLACE),wt.disabled,$e.disabled,jc(re.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Oo.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var S=this.nextStencilID++,E=this.context.gl;return new it({func:E.NOTEQUAL,mask:255},S,255,E.KEEP,E.KEEP,E.REPLACE)},Oo.prototype.stencilModeForClipping=function(S){var E=this.context.gl;return new it({func:E.EQUAL,mask:255},this._tileClippingMaskIDs[S.key],0,E.KEEP,E.KEEP,E.REPLACE)},Oo.prototype.stencilConfigForOverlap=function(S){var E,T=this.context.gl,M=S.sort(function(ye,Ae){return Ae.overscaledZ-ye.overscaledZ}),B=M[M.length-1].overscaledZ,W=M[0].overscaledZ-B+1;if(W>1){this.currentStencilSource=void 0,this.nextStencilID+W>256&&this.clearStencil();for(var Y={},re=0;re<W;re++)Y[re+B]=new it({func:T.GEQUAL,mask:255},re+this.nextStencilID,255,T.KEEP,T.KEEP,T.REPLACE);return this.nextStencilID+=W,[Y,M]}return[(E={},E[B]=it.disabled,E),M]},Oo.prototype.colorModeForRenderPass=function(){var S=this.context.gl;return this._showOverdrawInspector?new wt([S.CONSTANT_COLOR,S.ONE],new p.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?wt.unblended:wt.alphaBlended},Oo.prototype.depthModeForSublayer=function(S,E,T){if(!this.opaquePassEnabledForLayer())return et.disabled;var M=1-((1+this.currentLayer)*this.numSublayers+S)*this.depthEpsilon;return new et(T||this.context.gl.LEQUAL,E,[M,M])},Oo.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Oo.prototype.render=function(S,E){var T=this;this.style=S,this.options=E,this.lineAtlas=S.lineAtlas,this.imageManager=S.imageManager,this.glyphManager=S.glyphManager,this.symbolFadeChange=S.placement.symbolFadeChange(p.browser.now()),this.imageManager.beginFrame();var M=this.style._order,B=this.style.sourceCaches;for(var W in B){var Y=B[W];Y.used&&Y.prepare(this.context)}var re,ye,Ae={},Ze={},Je={};for(var ke in B){var ut=B[ke];Ae[ke]=ut.getVisibleCoordinates(),Ze[ke]=Ae[ke].slice().reverse(),Je[ke]=ut.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ht=0;ht<M.length;ht++)if(this.style._layers[M[ht]].is3D()){this.opaquePassCutoff=ht;break}this.renderPass="offscreen";for(var Ct=0,lt=M;Ct<lt.length;Ct+=1){var It=this.style._layers[lt[Ct]];if(It.hasOffscreenPass()&&!It.isHidden(this.transform.zoom)){var Lt=Ze[It.source];(It.type==="custom"||Lt.length)&&this.renderLayer(this,B[It.source],It,Lt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:E.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=E.showOverdrawInspector,this.depthRangeFor3D=[0,1-(S._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){var Jt=this.style._layers[M[this.currentLayer]],vr=B[Jt.source],mr=Ae[Jt.source];this._renderTileClippingMasks(Jt,mr),this.renderLayer(this,vr,Jt,mr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){var wr=this.style._layers[M[this.currentLayer]],Ur=B[wr.source],on=(wr.type==="symbol"?Je:Ze)[wr.source];this._renderTileClippingMasks(wr,Ae[wr.source]),this.renderLayer(this,Ur,wr,on)}this.options.showTileBoundaries&&(p.values(this.style._layers).forEach(function(Hr){Hr.source&&!Hr.isHidden(T.transform.zoom)&&(Hr.source!==(ye&&ye.id)&&(ye=T.style.sourceCaches[Hr.source]),(!re||re.getSource().maxzoom<ye.getSource().maxzoom)&&(re=ye))}),re&&Aa.debug(this,re,re.getVisibleCoordinates())),this.options.showPadding&&function(Hr){var mn=Hr.transform.padding;Fu(Hr,Hr.transform.height-(mn.top||0),3,uu),Fu(Hr,mn.bottom||0,3,ip),Vu(Hr,mn.left||0,3,fd),Vu(Hr,Hr.transform.width-(mn.right||0),3,md);var Yn=Hr.transform.centerPoint;(function(ni,Jn,io,An){hu(ni,Jn-1,io-10,2,20,An),hu(ni,Jn-10,io-1,20,2,An)})(Hr,Yn.x,Hr.transform.height-Yn.y,wh)}(this),this.context.setDefault()},Oo.prototype.renderLayer=function(S,E,T,M){T.isHidden(this.transform.zoom)||(T.type==="background"||T.type==="custom"||M.length)&&(this.id=T.id,this.gpuTimingStart(T),Aa[T.type](S,E,T,M,this.style.placement.variableOffsets),this.gpuTimingEnd())},Oo.prototype.gpuTimingStart=function(S){if(this.options.gpuTiming){var E=this.context.extTimerQuery,T=this.gpuTimers[S.id];T||(T=this.gpuTimers[S.id]={calls:0,cpuTime:0,query:E.createQueryEXT()}),T.calls++,E.beginQueryEXT(E.TIME_ELAPSED_EXT,T.query)}},Oo.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var S=this.context.extTimerQuery;S.endQueryEXT(S.TIME_ELAPSED_EXT)}},Oo.prototype.collectGpuTimers=function(){var S=this.gpuTimers;return this.gpuTimers={},S},Oo.prototype.queryGpuTimers=function(S){var E={};for(var T in S){var M=S[T],B=this.context.extTimerQuery,W=B.getQueryObjectEXT(M.query,B.QUERY_RESULT_EXT)/1e6;B.deleteQueryEXT(M.query),E[T]=W}return E},Oo.prototype.translatePosMatrix=function(S,E,T,M,B){if(!T[0]&&!T[1])return S;var W=B?M==="map"?this.transform.angle:0:M==="viewport"?-this.transform.angle:0;if(W){var Y=Math.sin(W),re=Math.cos(W);T=[T[0]*re-T[1]*Y,T[0]*Y+T[1]*re]}var ye=[B?T[0]:Uo(E,T[0],this.transform.zoom),B?T[1]:Uo(E,T[1],this.transform.zoom),0],Ae=new Float32Array(16);return p.translate(Ae,S,ye),Ae},Oo.prototype.saveTileTexture=function(S){var E=this._tileTextures[S.size[0]];E?E.push(S):this._tileTextures[S.size[0]]=[S]},Oo.prototype.getTileTexture=function(S){var E=this._tileTextures[S];return E&&E.length>0?E.pop():null},Oo.prototype.isPatternMissing=function(S){if(!S)return!1;if(!S.from||!S.to)return!0;var E=this.imageManager.getPattern(S.from.toString()),T=this.imageManager.getPattern(S.to.toString());return!E||!T},Oo.prototype.useProgram=function(S,E){this.cache=this.cache||{};var T=""+S+(E?E.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[T]||(this.cache[T]=new $p(this.context,S,Nf[S],E,Xp[S],this._showOverdrawInspector)),this.cache[T]},Oo.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Oo.prototype.setBaseState=function(){var S=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(S.FUNC_ADD)},Oo.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Oo.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Is=function(S,E){this.points=S,this.planes=E};Is.fromInvProjectionMatrix=function(S,E,T){var M=Math.pow(2,T),B=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(Y){return p.transformMat4([],Y,S)}).map(function(Y){return p.scale$1([],Y,1/Y[3]/E*M)}),W=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(Y){var re=p.sub([],B[Y[0]],B[Y[1]]),ye=p.sub([],B[Y[2]],B[Y[1]]),Ae=p.normalize([],p.cross([],re,ye)),Ze=-p.dot(Ae,B[Y[1]]);return Ae.concat(Ze)});return new Is(B,W)};var du=function(S,E){this.min=S,this.max=E,this.center=p.scale$2([],p.add([],this.min,this.max),.5)};du.prototype.quadrant=function(S){for(var E=[S%2==0,S<2],T=p.clone$2(this.min),M=p.clone$2(this.max),B=0;B<E.length;B++)T[B]=E[B]?this.min[B]:this.center[B],M[B]=E[B]?this.center[B]:this.max[B];return M[2]=this.max[2],new du(T,M)},du.prototype.distanceX=function(S){return Math.max(Math.min(this.max[0],S[0]),this.min[0])-S[0]},du.prototype.distanceY=function(S){return Math.max(Math.min(this.max[1],S[1]),this.min[1])-S[1]},du.prototype.intersects=function(S){for(var E=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],T=!0,M=0;M<S.planes.length;M++){for(var B=S.planes[M],W=0,Y=0;Y<E.length;Y++)W+=p.dot$1(B,E[Y])>=0;if(W===0)return 0;W!==E.length&&(T=!1)}if(T)return 2;for(var re=0;re<3;re++){for(var ye=Number.MAX_VALUE,Ae=-Number.MAX_VALUE,Ze=0;Ze<S.points.length;Ze++){var Je=S.points[Ze][re]-this.min[re];ye=Math.min(ye,Je),Ae=Math.max(Ae,Je)}if(Ae<0||ye>this.max[re]-this.min[re])return 0}return 1};var pu=function(S,E,T,M){if(S===void 0&&(S=0),E===void 0&&(E=0),T===void 0&&(T=0),M===void 0&&(M=0),isNaN(S)||S<0||isNaN(E)||E<0||isNaN(T)||T<0||isNaN(M)||M<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=S,this.bottom=E,this.left=T,this.right=M};pu.prototype.interpolate=function(S,E,T){return E.top!=null&&S.top!=null&&(this.top=p.number(S.top,E.top,T)),E.bottom!=null&&S.bottom!=null&&(this.bottom=p.number(S.bottom,E.bottom,T)),E.left!=null&&S.left!=null&&(this.left=p.number(S.left,E.left,T)),E.right!=null&&S.right!=null&&(this.right=p.number(S.right,E.right,T)),this},pu.prototype.getCenter=function(S,E){var T=p.clamp((this.left+S-this.right)/2,0,S),M=p.clamp((this.top+E-this.bottom)/2,0,E);return new p.Point(T,M)},pu.prototype.equals=function(S){return this.top===S.top&&this.bottom===S.bottom&&this.left===S.left&&this.right===S.right},pu.prototype.clone=function(){return new pu(this.top,this.bottom,this.left,this.right)},pu.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var co=function(S,E,T,M,B){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=B===void 0||B,this._minZoom=S||0,this._maxZoom=E||22,this._minPitch=T??0,this._maxPitch=M??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pu,this._posMatrixCache={},this._alignedPosMatrixCache={}},ko={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};co.prototype.clone=function(){var S=new co(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return S.tileSize=this.tileSize,S.latRange=this.latRange,S.width=this.width,S.height=this.height,S._center=this._center,S.zoom=this.zoom,S.angle=this.angle,S._fov=this._fov,S._pitch=this._pitch,S._unmodified=this._unmodified,S._edgeInsets=this._edgeInsets.clone(),S._calcMatrices(),S},ko.minZoom.get=function(){return this._minZoom},ko.minZoom.set=function(S){this._minZoom!==S&&(this._minZoom=S,this.zoom=Math.max(this.zoom,S))},ko.maxZoom.get=function(){return this._maxZoom},ko.maxZoom.set=function(S){this._maxZoom!==S&&(this._maxZoom=S,this.zoom=Math.min(this.zoom,S))},ko.minPitch.get=function(){return this._minPitch},ko.minPitch.set=function(S){this._minPitch!==S&&(this._minPitch=S,this.pitch=Math.max(this.pitch,S))},ko.maxPitch.get=function(){return this._maxPitch},ko.maxPitch.set=function(S){this._maxPitch!==S&&(this._maxPitch=S,this.pitch=Math.min(this.pitch,S))},ko.renderWorldCopies.get=function(){return this._renderWorldCopies},ko.renderWorldCopies.set=function(S){S===void 0?S=!0:S===null&&(S=!1),this._renderWorldCopies=S},ko.worldSize.get=function(){return this.tileSize*this.scale},ko.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ko.size.get=function(){return new p.Point(this.width,this.height)},ko.bearing.get=function(){return-this.angle/Math.PI*180},ko.bearing.set=function(S){var E=-p.wrap(S,-180,180)*Math.PI/180;this.angle!==E&&(this._unmodified=!1,this.angle=E,this._calcMatrices(),this.rotationMatrix=p.create$2(),p.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ko.pitch.get=function(){return this._pitch/Math.PI*180},ko.pitch.set=function(S){var E=p.clamp(S,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==E&&(this._unmodified=!1,this._pitch=E,this._calcMatrices())},ko.fov.get=function(){return this._fov/Math.PI*180},ko.fov.set=function(S){S=Math.max(.01,Math.min(60,S)),this._fov!==S&&(this._unmodified=!1,this._fov=S/180*Math.PI,this._calcMatrices())},ko.zoom.get=function(){return this._zoom},ko.zoom.set=function(S){var E=Math.min(Math.max(S,this.minZoom),this.maxZoom);this._zoom!==E&&(this._unmodified=!1,this._zoom=E,this.scale=this.zoomScale(E),this.tileZoom=Math.floor(E),this.zoomFraction=E-this.tileZoom,this._constrain(),this._calcMatrices())},ko.center.get=function(){return this._center},ko.center.set=function(S){S.lat===this._center.lat&&S.lng===this._center.lng||(this._unmodified=!1,this._center=S,this._constrain(),this._calcMatrices())},ko.padding.get=function(){return this._edgeInsets.toJSON()},ko.padding.set=function(S){this._edgeInsets.equals(S)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,S,1),this._calcMatrices())},ko.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},co.prototype.isPaddingEqual=function(S){return this._edgeInsets.equals(S)},co.prototype.interpolatePadding=function(S,E,T){this._unmodified=!1,this._edgeInsets.interpolate(S,E,T),this._constrain(),this._calcMatrices()},co.prototype.coveringZoomLevel=function(S){var E=(S.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/S.tileSize));return Math.max(0,E)},co.prototype.getVisibleUnwrappedCoordinates=function(S){var E=[new p.UnwrappedTileID(0,S)];if(this._renderWorldCopies)for(var T=this.pointCoordinate(new p.Point(0,0)),M=this.pointCoordinate(new p.Point(this.width,0)),B=this.pointCoordinate(new p.Point(this.width,this.height)),W=this.pointCoordinate(new p.Point(0,this.height)),Y=Math.floor(Math.min(T.x,M.x,B.x,W.x)),re=Math.floor(Math.max(T.x,M.x,B.x,W.x)),ye=Y-1;ye<=re+1;ye++)ye!==0&&E.push(new p.UnwrappedTileID(ye,S));return E},co.prototype.coveringTiles=function(S){var E=this.coveringZoomLevel(S),T=E;if(S.minzoom!==void 0&&E<S.minzoom)return[];S.maxzoom!==void 0&&E>S.maxzoom&&(E=S.maxzoom);var M=p.MercatorCoordinate.fromLngLat(this.center),B=Math.pow(2,E),W=[B*M.x,B*M.y,0],Y=Is.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,E),re=S.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(re=E);var ye=function(Hr){return{aabb:new du([Hr*B,0,0],[(Hr+1)*B,B,0]),zoom:0,x:0,y:0,wrap:Hr,fullyVisible:!1}},Ae=[],Ze=[],Je=E,ke=S.reparseOverscaled?T:E;if(this._renderWorldCopies)for(var ut=1;ut<=3;ut++)Ae.push(ye(-ut)),Ae.push(ye(ut));for(Ae.push(ye(0));Ae.length>0;){var ht=Ae.pop(),Ct=ht.x,lt=ht.y,It=ht.fullyVisible;if(!It){var Lt=ht.aabb.intersects(Y);if(Lt===0)continue;It=Lt===2}var Jt=ht.aabb.distanceX(W),vr=ht.aabb.distanceY(W),mr=Math.max(Math.abs(Jt),Math.abs(vr));if(ht.zoom===Je||mr>3+(1<<Je-ht.zoom)-2&&ht.zoom>=re)Ze.push({tileID:new p.OverscaledTileID(ht.zoom===Je?ke:ht.zoom,ht.wrap,ht.zoom,Ct,lt),distanceSq:p.sqrLen([W[0]-.5-Ct,W[1]-.5-lt])});else for(var wr=0;wr<4;wr++){var Ur=(Ct<<1)+wr%2,on=(lt<<1)+(wr>>1);Ae.push({aabb:ht.aabb.quadrant(wr),zoom:ht.zoom+1,x:Ur,y:on,wrap:ht.wrap,fullyVisible:It})}}return Ze.sort(function(Hr,mn){return Hr.distanceSq-mn.distanceSq}).map(function(Hr){return Hr.tileID})},co.prototype.resize=function(S,E){this.width=S,this.height=E,this.pixelsToGLUnits=[2/S,-2/E],this._constrain(),this._calcMatrices()},ko.unmodified.get=function(){return this._unmodified},co.prototype.zoomScale=function(S){return Math.pow(2,S)},co.prototype.scaleZoom=function(S){return Math.log(S)/Math.LN2},co.prototype.project=function(S){var E=p.clamp(S.lat,-this.maxValidLatitude,this.maxValidLatitude);return new p.Point(p.mercatorXfromLng(S.lng)*this.worldSize,p.mercatorYfromLat(E)*this.worldSize)},co.prototype.unproject=function(S){return new p.MercatorCoordinate(S.x/this.worldSize,S.y/this.worldSize).toLngLat()},ko.point.get=function(){return this.project(this.center)},co.prototype.setLocationAtPoint=function(S,E){var T=this.pointCoordinate(E),M=this.pointCoordinate(this.centerPoint),B=this.locationCoordinate(S),W=new p.MercatorCoordinate(B.x-(T.x-M.x),B.y-(T.y-M.y));this.center=this.coordinateLocation(W),this._renderWorldCopies&&(this.center=this.center.wrap())},co.prototype.locationPoint=function(S){return this.coordinatePoint(this.locationCoordinate(S))},co.prototype.pointLocation=function(S){return this.coordinateLocation(this.pointCoordinate(S))},co.prototype.locationCoordinate=function(S){return p.MercatorCoordinate.fromLngLat(S)},co.prototype.coordinateLocation=function(S){return S.toLngLat()},co.prototype.pointCoordinate=function(S){var E=[S.x,S.y,0,1],T=[S.x,S.y,1,1];p.transformMat4(E,E,this.pixelMatrixInverse),p.transformMat4(T,T,this.pixelMatrixInverse);var M=E[3],B=T[3],W=E[1]/M,Y=T[1]/B,re=E[2]/M,ye=T[2]/B,Ae=re===ye?0:(0-re)/(ye-re);return new p.MercatorCoordinate(p.number(E[0]/M,T[0]/B,Ae)/this.worldSize,p.number(W,Y,Ae)/this.worldSize)},co.prototype.coordinatePoint=function(S){var E=[S.x*this.worldSize,S.y*this.worldSize,0,1];return p.transformMat4(E,E,this.pixelMatrix),new p.Point(E[0]/E[3],E[1]/E[3])},co.prototype.getBounds=function(){return new p.LngLatBounds().extend(this.pointLocation(new p.Point(0,0))).extend(this.pointLocation(new p.Point(this.width,0))).extend(this.pointLocation(new p.Point(this.width,this.height))).extend(this.pointLocation(new p.Point(0,this.height)))},co.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new p.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},co.prototype.setMaxBounds=function(S){S?(this.lngRange=[S.getWest(),S.getEast()],this.latRange=[S.getSouth(),S.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},co.prototype.calculatePosMatrix=function(S,E){E===void 0&&(E=!1);var T=S.key,M=E?this._alignedPosMatrixCache:this._posMatrixCache;if(M[T])return M[T];var B=S.canonical,W=this.worldSize/this.zoomScale(B.z),Y=B.x+Math.pow(2,B.z)*S.wrap,re=p.identity(new Float64Array(16));return p.translate(re,re,[Y*W,B.y*W,0]),p.scale(re,re,[W/p.EXTENT,W/p.EXTENT,1]),p.multiply(re,E?this.alignedProjMatrix:this.projMatrix,re),M[T]=new Float32Array(re),M[T]},co.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},co.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var S,E,T,M,B=-90,W=90,Y=-180,re=180,ye=this.size,Ae=this._unmodified;if(this.latRange){var Ze=this.latRange;B=p.mercatorYfromLat(Ze[1])*this.worldSize,S=(W=p.mercatorYfromLat(Ze[0])*this.worldSize)-B<ye.y?ye.y/(W-B):0}if(this.lngRange){var Je=this.lngRange;Y=p.mercatorXfromLng(Je[0])*this.worldSize,E=(re=p.mercatorXfromLng(Je[1])*this.worldSize)-Y<ye.x?ye.x/(re-Y):0}var ke=this.point,ut=Math.max(E||0,S||0);if(ut)return this.center=this.unproject(new p.Point(E?(re+Y)/2:ke.x,S?(W+B)/2:ke.y)),this.zoom+=this.scaleZoom(ut),this._unmodified=Ae,void(this._constraining=!1);if(this.latRange){var ht=ke.y,Ct=ye.y/2;ht-Ct<B&&(M=B+Ct),ht+Ct>W&&(M=W-Ct)}if(this.lngRange){var lt=ke.x,It=ye.x/2;lt-It<Y&&(T=Y+It),lt+It>re&&(T=re-It)}T===void 0&&M===void 0||(this.center=this.unproject(new p.Point(T!==void 0?T:ke.x,M!==void 0?M:ke.y))),this._unmodified=Ae,this._constraining=!1}},co.prototype._calcMatrices=function(){if(this.height){var S=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var E=Math.PI/2+this._pitch,T=this._fov*(.5+S.y/this.height),M=Math.sin(T)*this.cameraToCenterDistance/Math.sin(p.clamp(Math.PI-E-T,.01,Math.PI-.01)),B=this.point,W=B.x,Y=B.y,re=1.01*(Math.cos(Math.PI/2-this._pitch)*M+this.cameraToCenterDistance),ye=this.height/50,Ae=new Float64Array(16);p.perspective(Ae,this._fov,this.width/this.height,ye,re),Ae[8]=2*-S.x/this.width,Ae[9]=2*S.y/this.height,p.scale(Ae,Ae,[1,-1,1]),p.translate(Ae,Ae,[0,0,-this.cameraToCenterDistance]),p.rotateX(Ae,Ae,this._pitch),p.rotateZ(Ae,Ae,this.angle),p.translate(Ae,Ae,[-W,-Y,0]),this.mercatorMatrix=p.scale([],Ae,[this.worldSize,this.worldSize,this.worldSize]),p.scale(Ae,Ae,[1,1,p.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ae,this.invProjMatrix=p.invert([],this.projMatrix);var Ze=this.width%2/2,Je=this.height%2/2,ke=Math.cos(this.angle),ut=Math.sin(this.angle),ht=W-Math.round(W)+ke*Ze+ut*Je,Ct=Y-Math.round(Y)+ke*Je+ut*Ze,lt=new Float64Array(Ae);if(p.translate(lt,lt,[ht>.5?ht-1:ht,Ct>.5?Ct-1:Ct,0]),this.alignedProjMatrix=lt,Ae=p.create(),p.scale(Ae,Ae,[this.width/2,-this.height/2,1]),p.translate(Ae,Ae,[1,-1,0]),this.labelPlaneMatrix=Ae,Ae=p.create(),p.scale(Ae,Ae,[1,-1,1]),p.translate(Ae,Ae,[-1,-1,0]),p.scale(Ae,Ae,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ae,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ae=p.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ae,this._posMatrixCache={},this._alignedPosMatrixCache={}}},co.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var S=this.pointCoordinate(new p.Point(0,0)),E=[S.x*this.worldSize,S.y*this.worldSize,0,1];return p.transformMat4(E,E,this.pixelMatrix)[3]/this.cameraToCenterDistance},co.prototype.getCameraPoint=function(){var S=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.Point(0,S))},co.prototype.getCameraQueryGeometry=function(S){var E=this.getCameraPoint();if(S.length===1)return[S[0],E];for(var T=E.x,M=E.y,B=E.x,W=E.y,Y=0,re=S;Y<re.length;Y+=1){var ye=re[Y];T=Math.min(T,ye.x),M=Math.min(M,ye.y),B=Math.max(B,ye.x),W=Math.max(W,ye.y)}return[new p.Point(T,M),new p.Point(B,M),new p.Point(B,W),new p.Point(T,W),new p.Point(T,M)]},Object.defineProperties(co.prototype,ko);var Hs=function(S){var E,T,M,B;this._hashName=S&&encodeURIComponent(S),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(E=this._updateHashUnthrottled.bind(this),T=!1,M=null,B=function(){M=null,T&&(E(),M=setTimeout(B,300),T=!1)},function(){return T=!0,M||B(),M})};Hs.prototype.addTo=function(S){return this._map=S,p.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Hs.prototype.remove=function(){return p.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Hs.prototype.getHashString=function(S){var E=this._map.getCenter(),T=Math.round(100*this._map.getZoom())/100,M=Math.ceil((T*Math.LN2+Math.log(512/360/.5))/Math.LN10),B=Math.pow(10,M),W=Math.round(E.lng*B)/B,Y=Math.round(E.lat*B)/B,re=this._map.getBearing(),ye=this._map.getPitch(),Ae="";if(Ae+=S?"/"+W+"/"+Y+"/"+T:T+"/"+Y+"/"+W,(re||ye)&&(Ae+="/"+Math.round(10*re)/10),ye&&(Ae+="/"+Math.round(ye)),this._hashName){var Ze=this._hashName,Je=!1,ke=p.window.location.hash.slice(1).split("&").map(function(ut){var ht=ut.split("=")[0];return ht===Ze?(Je=!0,ht+"="+Ae):ut}).filter(function(ut){return ut});return Je||ke.push(Ze+"="+Ae),"#"+ke.join("&")}return"#"+Ae},Hs.prototype._getCurrentHash=function(){var S,E=this,T=p.window.location.hash.replace("#","");return this._hashName?(T.split("&").map(function(M){return M.split("=")}).forEach(function(M){M[0]===E._hashName&&(S=M)}),(S&&S[1]||"").split("/")):T.split("/")},Hs.prototype._onHashChange=function(){var S=this._getCurrentHash();if(S.length>=3&&!S.some(function(T){return isNaN(T)})){var E=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(S[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+S[2],+S[1]],zoom:+S[0],bearing:E,pitch:+(S[4]||0)}),!0}return!1},Hs.prototype._updateHashUnthrottled=function(){var S=p.window.location.href.replace(/(#.+)?$/,this.getHashString());try{p.window.history.replaceState(p.window.history.state,null,S)}catch{}};var fu={linearity:.3,easing:p.bezier(0,0,.3,1)},Sh=p.extend({deceleration:2500,maxSpeed:1400},fu),Kl=p.extend({deceleration:20,maxSpeed:1400},fu),Fm=p.extend({deceleration:1e3,maxSpeed:360},fu),_d=p.extend({deceleration:1e3,maxSpeed:90},fu),Th=function(S){this._map=S,this.clear()};function yd(S,E){(!S.duration||S.duration<E.duration)&&(S.duration=E.duration,S.easing=E.easing)}function mu(S,E,T){var M=T.maxSpeed,B=T.linearity,W=T.deceleration,Y=p.clamp(S*B/(E/1e3),-M,M),re=Math.abs(Y)/(W*B);return{easing:T.easing,duration:1e3*re,amount:Y*(re/2)}}Th.prototype.clear=function(){this._inertiaBuffer=[]},Th.prototype.record=function(S){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.browser.now(),settings:S})},Th.prototype._drainInertiaBuffer=function(){for(var S=this._inertiaBuffer,E=p.browser.now();S.length>0&&E-S[0].time>160;)S.shift()},Th.prototype._onMoveEnd=function(S){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var E={zoom:0,bearing:0,pitch:0,pan:new p.Point(0,0),pinchAround:void 0,around:void 0},T=0,M=this._inertiaBuffer;T<M.length;T+=1){var B=M[T].settings;E.zoom+=B.zoomDelta||0,E.bearing+=B.bearingDelta||0,E.pitch+=B.pitchDelta||0,B.panDelta&&E.pan._add(B.panDelta),B.around&&(E.around=B.around),B.pinchAround&&(E.pinchAround=B.pinchAround)}var W=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,Y={};if(E.pan.mag()){var re=mu(E.pan.mag(),W,p.extend({},Sh,S||{}));Y.offset=E.pan.mult(re.amount/E.pan.mag()),Y.center=this._map.transform.center,yd(Y,re)}if(E.zoom){var ye=mu(E.zoom,W,Kl);Y.zoom=this._map.transform.zoom+ye.amount,yd(Y,ye)}if(E.bearing){var Ae=mu(E.bearing,W,Fm);Y.bearing=this._map.transform.bearing+p.clamp(Ae.amount,-179,179),yd(Y,Ae)}if(E.pitch){var Ze=mu(E.pitch,W,_d);Y.pitch=this._map.transform.pitch+Ze.amount,yd(Y,Ze)}if(Y.zoom||Y.bearing){var Je=E.pinchAround===void 0?E.around:E.pinchAround;Y.around=Je?this._map.unproject(Je):this._map.getCenter()}return this.clear(),p.extend(Y,{noMoveStart:!0})}};var qo=function(S){function E(M,B,W,Y){Y===void 0&&(Y={});var re=L.mousePos(B.getCanvasContainer(),W),ye=B.unproject(re);S.call(this,M,p.extend({point:re,lngLat:ye,originalEvent:W},Y)),this._defaultPrevented=!1,this.target=B}S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E;var T={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},T.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,T),E}(p.Event),Uu=function(S){function E(M,B,W){var Y=M==="touchend"?W.changedTouches:W.touches,re=L.touchPos(B.getCanvasContainer(),Y),ye=re.map(function(Je){return B.unproject(Je)}),Ae=re.reduce(function(Je,ke,ut,ht){return Je.add(ke.div(ht.length))},new p.Point(0,0)),Ze=B.unproject(Ae);S.call(this,M,{points:re,point:Ae,lngLats:ye,lngLat:Ze,originalEvent:W}),this._defaultPrevented=!1}S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E;var T={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},T.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,T),E}(p.Event),op=function(S){function E(M,B,W){S.call(this,M,{originalEvent:W}),this._defaultPrevented=!1}S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E;var T={defaultPrevented:{configurable:!0}};return E.prototype.preventDefault=function(){this._defaultPrevented=!0},T.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(E.prototype,T),E}(p.Event),xa=function(S,E){this._map=S,this._clickTolerance=E.clickTolerance};xa.prototype.reset=function(){delete this._mousedownPos},xa.prototype.wheel=function(S){return this._firePreventable(new op(S.type,this._map,S))},xa.prototype.mousedown=function(S,E){return this._mousedownPos=E,this._firePreventable(new qo(S.type,this._map,S))},xa.prototype.mouseup=function(S){this._map.fire(new qo(S.type,this._map,S))},xa.prototype.click=function(S,E){this._mousedownPos&&this._mousedownPos.dist(E)>=this._clickTolerance||this._map.fire(new qo(S.type,this._map,S))},xa.prototype.dblclick=function(S){return this._firePreventable(new qo(S.type,this._map,S))},xa.prototype.mouseover=function(S){this._map.fire(new qo(S.type,this._map,S))},xa.prototype.mouseout=function(S){this._map.fire(new qo(S.type,this._map,S))},xa.prototype.touchstart=function(S){return this._firePreventable(new Uu(S.type,this._map,S))},xa.prototype.touchmove=function(S){this._map.fire(new Uu(S.type,this._map,S))},xa.prototype.touchend=function(S){this._map.fire(new Uu(S.type,this._map,S))},xa.prototype.touchcancel=function(S){this._map.fire(new Uu(S.type,this._map,S))},xa.prototype._firePreventable=function(S){if(this._map.fire(S),S.defaultPrevented)return{}},xa.prototype.isEnabled=function(){return!0},xa.prototype.isActive=function(){return!1},xa.prototype.enable=function(){},xa.prototype.disable=function(){};var Rn=function(S){this._map=S};Rn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Rn.prototype.mousemove=function(S){this._map.fire(new qo(S.type,this._map,S))},Rn.prototype.mousedown=function(){this._delayContextMenu=!0},Rn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Rn.prototype.contextmenu=function(S){this._delayContextMenu?this._contextMenuEvent=S:this._map.fire(new qo(S.type,this._map,S)),this._map.listens("contextmenu")&&S.preventDefault()},Rn.prototype.isEnabled=function(){return!0},Rn.prototype.isActive=function(){return!1},Rn.prototype.enable=function(){},Rn.prototype.disable=function(){};var Zs=function(S,E){this._map=S,this._el=S.getCanvasContainer(),this._container=S.getContainer(),this._clickTolerance=E.clickTolerance||1};function vd(S,E){for(var T={},M=0;M<S.length;M++)T[S[M].identifier]=E[M];return T}Zs.prototype.isEnabled=function(){return!!this._enabled},Zs.prototype.isActive=function(){return!!this._active},Zs.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Zs.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Zs.prototype.mousedown=function(S,E){this.isEnabled()&&S.shiftKey&&S.button===0&&(L.disableDrag(),this._startPos=this._lastPos=E,this._active=!0)},Zs.prototype.mousemoveWindow=function(S,E){if(this._active){var T=E;if(!(this._lastPos.equals(T)||!this._box&&T.dist(this._startPos)<this._clickTolerance)){var M=this._startPos;this._lastPos=T,this._box||(this._box=L.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",S));var B=Math.min(M.x,T.x),W=Math.max(M.x,T.x),Y=Math.min(M.y,T.y),re=Math.max(M.y,T.y);L.setTransform(this._box,"translate("+B+"px,"+Y+"px)"),this._box.style.width=W-B+"px",this._box.style.height=re-Y+"px"}}},Zs.prototype.mouseupWindow=function(S,E){var T=this;if(this._active&&S.button===0){var M=this._startPos,B=E;if(this.reset(),L.suppressClick(),M.x!==B.x||M.y!==B.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:S})),{cameraAnimation:function(W){return W.fitScreenCoordinates(M,B,T._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",S)}},Zs.prototype.keydown=function(S){this._active&&S.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",S))},Zs.prototype.blur=function(){this.reset()},Zs.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos},Zs.prototype._fireEvent=function(S,E){return this._map.fire(new p.Event(S,{originalEvent:E}))};var Eh=function(S){this.reset(),this.numTouches=S.numTouches};Eh.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Eh.prototype.touchstart=function(S,E,T){(this.centroid||T.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=S.timeStamp),T.length===this.numTouches&&(this.centroid=function(M){for(var B=new p.Point(0,0),W=0,Y=M;W<Y.length;W+=1)B._add(Y[W]);return B.div(M.length)}(E),this.touches=vd(T,E)))},Eh.prototype.touchmove=function(S,E,T){if(!this.aborted&&this.centroid){var M=vd(T,E);for(var B in this.touches){var W=M[B];(!W||W.dist(this.touches[B])>30)&&(this.aborted=!0)}}},Eh.prototype.touchend=function(S,E,T){if((!this.centroid||S.timeStamp-this.startTime>500)&&(this.aborted=!0),T.length===0){var M=!this.aborted&&this.centroid;if(this.reset(),M)return M}};var Xs=function(S){this.singleTap=new Eh(S),this.numTaps=S.numTaps,this.reset()};Xs.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Xs.prototype.touchstart=function(S,E,T){this.singleTap.touchstart(S,E,T)},Xs.prototype.touchmove=function(S,E,T){this.singleTap.touchmove(S,E,T)},Xs.prototype.touchend=function(S,E,T){var M=this.singleTap.touchend(S,E,T);if(M){var B=S.timeStamp-this.lastTime<500,W=!this.lastTap||this.lastTap.dist(M)<30;if(B&&W||this.reset(),this.count++,this.lastTime=S.timeStamp,this.lastTap=M,this.count===this.numTaps)return this.reset(),M}};var gs=function(){this._zoomIn=new Xs({numTouches:1,numTaps:2}),this._zoomOut=new Xs({numTouches:2,numTaps:1}),this.reset()};gs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},gs.prototype.touchstart=function(S,E,T){this._zoomIn.touchstart(S,E,T),this._zoomOut.touchstart(S,E,T)},gs.prototype.touchmove=function(S,E,T){this._zoomIn.touchmove(S,E,T),this._zoomOut.touchmove(S,E,T)},gs.prototype.touchend=function(S,E,T){var M=this,B=this._zoomIn.touchend(S,E,T),W=this._zoomOut.touchend(S,E,T);return B?(this._active=!0,S.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function(Y){return Y.easeTo({duration:300,zoom:Y.getZoom()+1,around:Y.unproject(B)},{originalEvent:S})}}):W?(this._active=!0,S.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function(Y){return Y.easeTo({duration:300,zoom:Y.getZoom()-1,around:Y.unproject(W)},{originalEvent:S})}}):void 0},gs.prototype.touchcancel=function(){this.reset()},gs.prototype.enable=function(){this._enabled=!0},gs.prototype.disable=function(){this._enabled=!1,this.reset()},gs.prototype.isEnabled=function(){return this._enabled},gs.prototype.isActive=function(){return this._active};var ap={0:1,2:2},un=function(S){this.reset(),this._clickTolerance=S.clickTolerance||1};un.prototype.blur=function(){this.reset()},un.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},un.prototype._correctButton=function(S,E){return!1},un.prototype._move=function(S,E){return{}},un.prototype.mousedown=function(S,E){if(!this._lastPoint){var T=L.mouseButton(S);this._correctButton(S,T)&&(this._lastPoint=E,this._eventButton=T)}},un.prototype.mousemoveWindow=function(S,E){var T=this._lastPoint;if(T){if(S.preventDefault(),function(M,B){var W=ap[B];return M.buttons===void 0||(M.buttons&W)!==W}(S,this._eventButton))this.reset();else if(this._moved||!(E.dist(T)<this._clickTolerance))return this._moved=!0,this._lastPoint=E,this._move(T,E)}},un.prototype.mouseupWindow=function(S){this._lastPoint&&L.mouseButton(S)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())},un.prototype.enable=function(){this._enabled=!0},un.prototype.disable=function(){this._enabled=!1,this.reset()},un.prototype.isEnabled=function(){return this._enabled},un.prototype.isActive=function(){return this._active};var $u=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.mousedown=function(T,M){S.prototype.mousedown.call(this,T,M),this._lastPoint&&(this._active=!0)},E.prototype._correctButton=function(T,M){return M===0&&!T.ctrlKey},E.prototype._move=function(T,M){return{around:M,panDelta:M.sub(T)}},E}(un),Ys=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype._correctButton=function(T,M){return M===0&&T.ctrlKey||M===2},E.prototype._move=function(T,M){var B=.8*(M.x-T.x);if(B)return this._active=!0,{bearingDelta:B}},E.prototype.contextmenu=function(T){T.preventDefault()},E}(un),Gu=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype._correctButton=function(T,M){return M===0&&T.ctrlKey||M===2},E.prototype._move=function(T,M){var B=-.5*(M.y-T.y);if(B)return this._active=!0,{pitchDelta:B}},E.prototype.contextmenu=function(T){T.preventDefault()},E}(un),xl=function(S){this._minTouches=1,this._clickTolerance=S.clickTolerance||1,this.reset()};xl.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new p.Point(0,0)},xl.prototype.touchstart=function(S,E,T){return this._calculateTransform(S,E,T)},xl.prototype.touchmove=function(S,E,T){if(this._active&&!(T.length<this._minTouches))return S.preventDefault(),this._calculateTransform(S,E,T)},xl.prototype.touchend=function(S,E,T){this._calculateTransform(S,E,T),this._active&&T.length<this._minTouches&&this.reset()},xl.prototype.touchcancel=function(){this.reset()},xl.prototype._calculateTransform=function(S,E,T){T.length>0&&(this._active=!0);var M=vd(T,E),B=new p.Point(0,0),W=new p.Point(0,0),Y=0;for(var re in M){var ye=M[re],Ae=this._touches[re];Ae&&(B._add(ye),W._add(ye.sub(Ae)),Y++,M[re]=ye)}if(this._touches=M,!(Y<this._minTouches)&&W.mag()){var Ze=W.div(Y);if(this._sum._add(Ze),!(this._sum.mag()<this._clickTolerance))return{around:B.div(Y),panDelta:Ze}}},xl.prototype.enable=function(){this._enabled=!0},xl.prototype.disable=function(){this._enabled=!1,this.reset()},xl.prototype.isEnabled=function(){return this._enabled},xl.prototype.isActive=function(){return this._active};var Ls=function(){this.reset()};function xd(S,E,T){for(var M=0;M<S.length;M++)if(S[M].identifier===T)return E[M]}function _c(S,E){return Math.log(S/E)/Math.LN2}Ls.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ls.prototype._start=function(S){},Ls.prototype._move=function(S,E,T){return{}},Ls.prototype.touchstart=function(S,E,T){this._firstTwoTouches||T.length<2||(this._firstTwoTouches=[T[0].identifier,T[1].identifier],this._start([E[0],E[1]]))},Ls.prototype.touchmove=function(S,E,T){if(this._firstTwoTouches){S.preventDefault();var M=this._firstTwoTouches,B=M[1],W=xd(T,E,M[0]),Y=xd(T,E,B);if(W&&Y){var re=this._aroundCenter?null:W.add(Y).div(2);return this._move([W,Y],re,S)}}},Ls.prototype.touchend=function(S,E,T){if(this._firstTwoTouches){var M=this._firstTwoTouches,B=M[1],W=xd(T,E,M[0]),Y=xd(T,E,B);W&&Y||(this._active&&L.suppressClick(),this.reset())}},Ls.prototype.touchcancel=function(){this.reset()},Ls.prototype.enable=function(S){this._enabled=!0,this._aroundCenter=!!S&&S.around==="center"},Ls.prototype.disable=function(){this._enabled=!1,this.reset()},Ls.prototype.isEnabled=function(){return this._enabled},Ls.prototype.isActive=function(){return this._active};var Si=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.reset=function(){S.prototype.reset.call(this),delete this._distance,delete this._startDistance},E.prototype._start=function(T){this._startDistance=this._distance=T[0].dist(T[1])},E.prototype._move=function(T,M){var B=this._distance;if(this._distance=T[0].dist(T[1]),this._active||!(Math.abs(_c(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_c(this._distance,B),pinchAround:M}},E}(Ls);function yc(S,E){return 180*S.angleWith(E)/Math.PI}var Vm=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.reset=function(){S.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},E.prototype._start=function(T){this._startVector=this._vector=T[0].sub(T[1]),this._minDiameter=T[0].dist(T[1])},E.prototype._move=function(T,M){var B=this._vector;if(this._vector=T[0].sub(T[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:yc(this._vector,B),pinchAround:M}},E.prototype._isBelowThreshold=function(T){this._minDiameter=Math.min(this._minDiameter,T.mag());var M=25/(Math.PI*this._minDiameter)*360,B=yc(T,this._startVector);return Math.abs(B)<M},E}(Ls);function qu(S){return Math.abs(S.y)>Math.abs(S.x)}var Jp=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.reset=function(){S.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},E.prototype._start=function(T){this._lastPoints=T,qu(T[0].sub(T[1]))&&(this._valid=!1)},E.prototype._move=function(T,M,B){var W=T[0].sub(this._lastPoints[0]),Y=T[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(W,Y,B.timeStamp),this._valid)return this._lastPoints=T,this._active=!0,{pitchDelta:(W.y+Y.y)/2*-.5}},E.prototype.gestureBeginsVertically=function(T,M,B){if(this._valid!==void 0)return this._valid;var W=T.mag()>=2,Y=M.mag()>=2;if(W||Y){if(!W||!Y)return this._firstMove===void 0&&(this._firstMove=B),B-this._firstMove<100&&void 0;var re=T.y>0==M.y>0;return qu(T)&&qu(M)&&re}},E}(Ls),sp={panStep:100,bearingStep:15,pitchStep:10},Jl=function(){var S=sp;this._panStep=S.panStep,this._bearingStep=S.bearingStep,this._pitchStep=S.pitchStep,this._rotationDisabled=!1};function Ks(S){return S*(2-S)}Jl.prototype.blur=function(){this.reset()},Jl.prototype.reset=function(){this._active=!1},Jl.prototype.keydown=function(S){var E=this;if(!(S.altKey||S.ctrlKey||S.metaKey)){var T=0,M=0,B=0,W=0,Y=0;switch(S.keyCode){case 61:case 107:case 171:case 187:T=1;break;case 189:case 109:case 173:T=-1;break;case 37:S.shiftKey?M=-1:(S.preventDefault(),W=-1);break;case 39:S.shiftKey?M=1:(S.preventDefault(),W=1);break;case 38:S.shiftKey?B=1:(S.preventDefault(),Y=-1);break;case 40:S.shiftKey?B=-1:(S.preventDefault(),Y=1);break;default:return}return this._rotationDisabled&&(M=0,B=0),{cameraAnimation:function(re){var ye=re.getZoom();re.easeTo({duration:300,easeId:"keyboardHandler",easing:Ks,zoom:T?Math.round(ye)+T*(S.shiftKey?2:1):ye,bearing:re.getBearing()+M*E._bearingStep,pitch:re.getPitch()+B*E._pitchStep,offset:[-W*E._panStep,-Y*E._panStep],center:re.getCenter()},{originalEvent:S})}}}},Jl.prototype.enable=function(){this._enabled=!0},Jl.prototype.disable=function(){this._enabled=!1,this.reset()},Jl.prototype.isEnabled=function(){return this._enabled},Jl.prototype.isActive=function(){return this._active},Jl.prototype.disableRotation=function(){this._rotationDisabled=!0},Jl.prototype.enableRotation=function(){this._rotationDisabled=!1};var oo=function(S,E){this._map=S,this._el=S.getCanvasContainer(),this._handler=E,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,p.bindAll(["_onTimeout"],this)};oo.prototype.setZoomRate=function(S){this._defaultZoomRate=S},oo.prototype.setWheelZoomRate=function(S){this._wheelZoomRate=S},oo.prototype.isEnabled=function(){return!!this._enabled},oo.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},oo.prototype.isZooming=function(){return!!this._zooming},oo.prototype.enable=function(S){this.isEnabled()||(this._enabled=!0,this._aroundCenter=S&&S.around==="center")},oo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},oo.prototype.wheel=function(S){if(this.isEnabled()){var E=S.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*S.deltaY:S.deltaY,T=p.browser.now(),M=T-(this._lastWheelEventTime||0);this._lastWheelEventTime=T,E!==0&&E%4.000244140625==0?this._type="wheel":E!==0&&Math.abs(E)<4?this._type="trackpad":M>400?(this._type=null,this._lastValue=E,this._timeout=setTimeout(this._onTimeout,40,S)):this._type||(this._type=Math.abs(M*E)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,E+=this._lastValue)),S.shiftKey&&E&&(E/=4),this._type&&(this._lastWheelEvent=S,this._delta-=E,this._active||this._start(S)),S.preventDefault()}},oo.prototype._onTimeout=function(S){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(S)},oo.prototype._start=function(S){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var E=L.mousePos(this._el,S);this._around=p.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(E)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},oo.prototype.renderFrame=function(){var S=this;if(this._frameId&&(this._frameId=null,this.isActive())){var E=this._map.transform;if(this._delta!==0){var T=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,M=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&M!==0&&(M=1/M);var B=typeof this._targetZoom=="number"?E.zoomScale(this._targetZoom):E.scale;this._targetZoom=Math.min(E.maxZoom,Math.max(E.minZoom,E.scaleZoom(B*M))),this._type==="wheel"&&(this._startZoom=E.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var W,Y=typeof this._targetZoom=="number"?this._targetZoom:E.zoom,re=this._startZoom,ye=this._easing,Ae=!1;if(this._type==="wheel"&&re&&ye){var Ze=Math.min((p.browser.now()-this._lastWheelEventTime)/200,1),Je=ye(Ze);W=p.number(re,Y,Je),Ze<1?this._frameId||(this._frameId=!0):Ae=!0}else W=Y,Ae=!0;return this._active=!0,Ae&&(this._active=!1,this._finishTimeout=setTimeout(function(){S._zooming=!1,S._handler._triggerRenderFrame(),delete S._targetZoom,delete S._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ae,zoomDelta:W-E.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},oo.prototype._smoothOutEasing=function(S){var E=p.ease;if(this._prevEase){var T=this._prevEase,M=(p.browser.now()-T.start)/T.duration,B=T.easing(M+.01)-T.easing(M),W=.27/Math.sqrt(B*B+1e-4)*.01,Y=Math.sqrt(.0729-W*W);E=p.bezier(W,Y,.25,1)}return this._prevEase={start:p.browser.now(),duration:S,easing:E},E},oo.prototype.blur=function(){this.reset()},oo.prototype.reset=function(){this._active=!1};var bl=function(S,E){this._clickZoom=S,this._tapZoom=E};bl.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},bl.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},bl.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},bl.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var zs=function(){this.reset()};zs.prototype.reset=function(){this._active=!1},zs.prototype.blur=function(){this.reset()},zs.prototype.dblclick=function(S,E){return S.preventDefault(),{cameraAnimation:function(T){T.easeTo({duration:300,zoom:T.getZoom()+(S.shiftKey?-1:1),around:T.unproject(E)},{originalEvent:S})}}},zs.prototype.enable=function(){this._enabled=!0},zs.prototype.disable=function(){this._enabled=!1,this.reset()},zs.prototype.isEnabled=function(){return this._enabled},zs.prototype.isActive=function(){return this._active};var ns=function(){this._tap=new Xs({numTouches:1,numTaps:1}),this.reset()};ns.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ns.prototype.touchstart=function(S,E,T){this._swipePoint||(this._tapTime&&S.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?T.length>0&&(this._swipePoint=E[0],this._swipeTouch=T[0].identifier):this._tap.touchstart(S,E,T))},ns.prototype.touchmove=function(S,E,T){if(this._tapTime){if(this._swipePoint){if(T[0].identifier!==this._swipeTouch)return;var M=E[0],B=M.y-this._swipePoint.y;return this._swipePoint=M,S.preventDefault(),this._active=!0,{zoomDelta:B/128}}}else this._tap.touchmove(S,E,T)},ns.prototype.touchend=function(S,E,T){this._tapTime?this._swipePoint&&T.length===0&&this.reset():this._tap.touchend(S,E,T)&&(this._tapTime=S.timeStamp)},ns.prototype.touchcancel=function(){this.reset()},ns.prototype.enable=function(){this._enabled=!0},ns.prototype.disable=function(){this._enabled=!1,this.reset()},ns.prototype.isEnabled=function(){return this._enabled},ns.prototype.isActive=function(){return this._active};var gu=function(S,E,T){this._el=S,this._mousePan=E,this._touchPan=T};gu.prototype.enable=function(S){this._inertiaOptions=S||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},gu.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},gu.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},gu.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ll=function(S,E,T){this._pitchWithRotate=S.pitchWithRotate,this._mouseRotate=E,this._mousePitch=T};Ll.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ll.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ll.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ll.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var zl=function(S,E,T,M){this._el=S,this._touchZoom=E,this._touchRotate=T,this._tapDragZoom=M,this._rotationDisabled=!1,this._enabled=!0};zl.prototype.enable=function(S){this._touchZoom.enable(S),this._rotationDisabled||this._touchRotate.enable(S),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},zl.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},zl.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},zl.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},zl.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},zl.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Cs=function(S){return S.zoom||S.drag||S.pitch||S.rotate},lp=function(S){function E(){S.apply(this,arguments)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E}(p.Event);function Kn(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta}var Bn=function(S,E){this._map=S,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Th(S),this._bearingSnap=E.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(E),p.bindAll(["handleEvent","handleWindowEvent"],this);var T=this._el;this._listeners=[[T,"touchstart",{passive:!0}],[T,"touchmove",{passive:!1}],[T,"touchend",void 0],[T,"touchcancel",void 0],[T,"mousedown",void 0],[T,"mousemove",void 0],[T,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[T,"mouseover",void 0],[T,"mouseout",void 0],[T,"dblclick",void 0],[T,"click",void 0],[T,"keydown",{capture:!1}],[T,"keyup",void 0],[T,"wheel",{passive:!1}],[T,"contextmenu",void 0],[p.window,"blur",void 0]];for(var M=0,B=this._listeners;M<B.length;M+=1){var W=B[M],Y=W[0];L.addEventListener(Y,W[1],Y===p.window.document?this.handleWindowEvent:this.handleEvent,W[2])}};Bn.prototype.destroy=function(){for(var S=0,E=this._listeners;S<E.length;S+=1){var T=E[S],M=T[0];L.removeEventListener(M,T[1],M===p.window.document?this.handleWindowEvent:this.handleEvent,T[2])}},Bn.prototype._addDefaultHandlers=function(S){var E=this._map,T=E.getCanvasContainer();this._add("mapEvent",new xa(E,S));var M=E.boxZoom=new Zs(E,S);this._add("boxZoom",M);var B=new gs,W=new zs;E.doubleClickZoom=new bl(W,B),this._add("tapZoom",B),this._add("clickZoom",W);var Y=new ns;this._add("tapDragZoom",Y);var re=E.touchPitch=new Jp;this._add("touchPitch",re);var ye=new Ys(S),Ae=new Gu(S);E.dragRotate=new Ll(S,ye,Ae),this._add("mouseRotate",ye,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate"]);var Ze=new $u(S),Je=new xl(S);E.dragPan=new gu(T,Ze,Je),this._add("mousePan",Ze),this._add("touchPan",Je,["touchZoom","touchRotate"]);var ke=new Vm,ut=new Si;E.touchZoomRotate=new zl(T,ut,ke,Y),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",ut,["touchPan","touchRotate"]);var ht=E.scrollZoom=new oo(E,this);this._add("scrollZoom",ht,["mousePan"]);var Ct=E.keyboard=new Jl;this._add("keyboard",Ct),this._add("blockableMapEvent",new Rn(E));for(var lt=0,It=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];lt<It.length;lt+=1){var Lt=It[lt];S.interactive&&S[Lt]&&E[Lt].enable(S[Lt])}},Bn.prototype._add=function(S,E,T){this._handlers.push({handlerName:S,handler:E,allowed:T}),this._handlersById[S]=E},Bn.prototype.stop=function(S){if(!this._updatingCamera){for(var E=0,T=this._handlers;E<T.length;E+=1)T[E].handler.reset();this._inertia.clear(),this._fireEvents({},{},S),this._changes=[]}},Bn.prototype.isActive=function(){for(var S=0,E=this._handlers;S<E.length;S+=1)if(E[S].handler.isActive())return!0;return!1},Bn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Bn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Bn.prototype.isMoving=function(){return!!Cs(this._eventsInProgress)||this.isZooming()},Bn.prototype._blockedByActive=function(S,E,T){for(var M in S)if(M!==T&&(!E||E.indexOf(M)<0))return!0;return!1},Bn.prototype.handleWindowEvent=function(S){this.handleEvent(S,S.type+"Window")},Bn.prototype._getMapTouches=function(S){for(var E=[],T=0,M=S;T<M.length;T+=1){var B=M[T];this._el.contains(B.target)&&E.push(B)}return E},Bn.prototype.handleEvent=function(S,E){this._updatingCamera=!0;for(var T=S.type==="renderFrame"?void 0:S,M={needsRenderFrame:!1},B={},W={},Y=S.touches?this._getMapTouches(S.touches):void 0,re=Y?L.touchPos(this._el,Y):L.mousePos(this._el,S),ye=0,Ae=this._handlers;ye<Ae.length;ye+=1){var Ze=Ae[ye],Je=Ze.handlerName,ke=Ze.handler,ut=Ze.allowed;if(ke.isEnabled()){var ht=void 0;this._blockedByActive(W,ut,Je)?ke.reset():ke[E||S.type]&&(ht=ke[E||S.type](S,re,Y),this.mergeHandlerResult(M,B,ht,Je,T),ht&&ht.needsRenderFrame&&this._triggerRenderFrame()),(ht||ke.isActive())&&(W[Je]=ke)}}var Ct={};for(var lt in this._previousActiveHandlers)W[lt]||(Ct[lt]=T);this._previousActiveHandlers=W,(Object.keys(Ct).length||Kn(M))&&(this._changes.push([M,B,Ct]),this._triggerRenderFrame()),(Object.keys(W).length||Kn(M))&&this._map._stop(!0),this._updatingCamera=!1;var It=M.cameraAnimation;It&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],It(this._map))},Bn.prototype.mergeHandlerResult=function(S,E,T,M,B){if(T){p.extend(S,T);var W={handlerName:M,originalEvent:T.originalEvent||B};T.zoomDelta!==void 0&&(E.zoom=W),T.panDelta!==void 0&&(E.drag=W),T.pitchDelta!==void 0&&(E.pitch=W),T.bearingDelta!==void 0&&(E.rotate=W)}},Bn.prototype._applyChanges=function(){for(var S={},E={},T={},M=0,B=this._changes;M<B.length;M+=1){var W=B[M],Y=W[0],re=W[1],ye=W[2];Y.panDelta&&(S.panDelta=(S.panDelta||new p.Point(0,0))._add(Y.panDelta)),Y.zoomDelta&&(S.zoomDelta=(S.zoomDelta||0)+Y.zoomDelta),Y.bearingDelta&&(S.bearingDelta=(S.bearingDelta||0)+Y.bearingDelta),Y.pitchDelta&&(S.pitchDelta=(S.pitchDelta||0)+Y.pitchDelta),Y.around!==void 0&&(S.around=Y.around),Y.pinchAround!==void 0&&(S.pinchAround=Y.pinchAround),Y.noInertia&&(S.noInertia=Y.noInertia),p.extend(E,re),p.extend(T,ye)}this._updateMapTransform(S,E,T),this._changes=[]},Bn.prototype._updateMapTransform=function(S,E,T){var M=this._map,B=M.transform;if(!Kn(S))return this._fireEvents(E,T,!0);var W=S.panDelta,Y=S.zoomDelta,re=S.bearingDelta,ye=S.pitchDelta,Ae=S.around,Ze=S.pinchAround;Ze!==void 0&&(Ae=Ze),M._stop(!0),Ae=Ae||M.transform.centerPoint;var Je=B.pointLocation(W?Ae.sub(W):Ae);re&&(B.bearing+=re),ye&&(B.pitch+=ye),Y&&(B.zoom+=Y),B.setLocationAtPoint(Je,Ae),this._map._update(),S.noInertia||this._inertia.record(S),this._fireEvents(E,T,!0)},Bn.prototype._fireEvents=function(S,E,T){var M=this,B=Cs(this._eventsInProgress),W=Cs(S),Y={};for(var re in S)this._eventsInProgress[re]||(Y[re+"start"]=S[re].originalEvent),this._eventsInProgress[re]=S[re];for(var ye in!B&&W&&this._fireEvent("movestart",W.originalEvent),Y)this._fireEvent(ye,Y[ye]);for(var Ae in W&&this._fireEvent("move",W.originalEvent),S)this._fireEvent(Ae,S[Ae].originalEvent);var Ze,Je={};for(var ke in this._eventsInProgress){var ut=this._eventsInProgress[ke],ht=ut.handlerName,Ct=ut.originalEvent;this._handlersById[ht].isActive()||(delete this._eventsInProgress[ke],Je[ke+"end"]=Ze=E[ht]||Ct)}for(var lt in Je)this._fireEvent(lt,Je[lt]);var It=Cs(this._eventsInProgress);if(T&&(B||W)&&!It){this._updatingCamera=!0;var Lt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Jt=function(vr){return vr!==0&&-M._bearingSnap<vr&&vr<M._bearingSnap};Lt?(Jt(Lt.bearing||this._map.getBearing())&&(Lt.bearing=0),this._map.easeTo(Lt,{originalEvent:Ze})):(this._map.fire(new p.Event("moveend",{originalEvent:Ze})),Jt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Bn.prototype._fireEvent=function(S,E){this._map.fire(new p.Event(S,E?{originalEvent:E}:{}))},Bn.prototype._requestFrame=function(){var S=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(E){delete S._frameId,S.handleEvent(new lp("renderFrame",{timeStamp:E})),S._applyChanges()})},Bn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Qp=function(S){function E(T,M){S.call(this),this._moving=!1,this._zooming=!1,this.transform=T,this._bearingSnap=M.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.getCenter=function(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)},E.prototype.setCenter=function(T,M){return this.jumpTo({center:T},M)},E.prototype.panBy=function(T,M,B){return T=p.Point.convert(T).mult(-1),this.panTo(this.transform.center,p.extend({offset:T},M),B)},E.prototype.panTo=function(T,M,B){return this.easeTo(p.extend({center:T},M),B)},E.prototype.getZoom=function(){return this.transform.zoom},E.prototype.setZoom=function(T,M){return this.jumpTo({zoom:T},M),this},E.prototype.zoomTo=function(T,M,B){return this.easeTo(p.extend({zoom:T},M),B)},E.prototype.zoomIn=function(T,M){return this.zoomTo(this.getZoom()+1,T,M),this},E.prototype.zoomOut=function(T,M){return this.zoomTo(this.getZoom()-1,T,M),this},E.prototype.getBearing=function(){return this.transform.bearing},E.prototype.setBearing=function(T,M){return this.jumpTo({bearing:T},M),this},E.prototype.getPadding=function(){return this.transform.padding},E.prototype.setPadding=function(T,M){return this.jumpTo({padding:T},M),this},E.prototype.rotateTo=function(T,M,B){return this.easeTo(p.extend({bearing:T},M),B)},E.prototype.resetNorth=function(T,M){return this.rotateTo(0,p.extend({duration:1e3},T),M),this},E.prototype.resetNorthPitch=function(T,M){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},T),M),this},E.prototype.snapToNorth=function(T,M){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(T,M):this},E.prototype.getPitch=function(){return this.transform.pitch},E.prototype.setPitch=function(T,M){return this.jumpTo({pitch:T},M),this},E.prototype.cameraForBounds=function(T,M){T=p.LngLatBounds.convert(T);var B=M&&M.bearing||0;return this._cameraForBoxAndBearing(T.getNorthWest(),T.getSouthEast(),B,M)},E.prototype._cameraForBoxAndBearing=function(T,M,B,W){var Y={top:0,bottom:0,right:0,left:0};if(typeof(W=p.extend({padding:Y,offset:[0,0],maxZoom:this.transform.maxZoom},W)).padding=="number"){var re=W.padding;W.padding={top:re,bottom:re,right:re,left:re}}W.padding=p.extend(Y,W.padding);var ye=this.transform,Ae=ye.padding,Ze=ye.project(p.LngLat.convert(T)),Je=ye.project(p.LngLat.convert(M)),ke=Ze.rotate(-B*Math.PI/180),ut=Je.rotate(-B*Math.PI/180),ht=new p.Point(Math.max(ke.x,ut.x),Math.max(ke.y,ut.y)),Ct=new p.Point(Math.min(ke.x,ut.x),Math.min(ke.y,ut.y)),lt=ht.sub(Ct),It=(ye.width-(Ae.left+Ae.right+W.padding.left+W.padding.right))/lt.x,Lt=(ye.height-(Ae.top+Ae.bottom+W.padding.top+W.padding.bottom))/lt.y;if(!(Lt<0||It<0)){var Jt=Math.min(ye.scaleZoom(ye.scale*Math.min(It,Lt)),W.maxZoom),vr=typeof W.offset.x=="number"?new p.Point(W.offset.x,W.offset.y):p.Point.convert(W.offset),mr=new p.Point((W.padding.left-W.padding.right)/2,(W.padding.top-W.padding.bottom)/2).rotate(B*Math.PI/180),wr=vr.add(mr).mult(ye.scale/ye.zoomScale(Jt));return{center:ye.unproject(Ze.add(Je).div(2).sub(wr)),zoom:Jt,bearing:B}}p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},E.prototype.fitBounds=function(T,M,B){return this._fitInternal(this.cameraForBounds(T,M),M,B)},E.prototype.fitScreenCoordinates=function(T,M,B,W,Y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(p.Point.convert(T)),this.transform.pointLocation(p.Point.convert(M)),B,W),W,Y)},E.prototype._fitInternal=function(T,M,B){return T?(delete(M=p.extend(T,M)).padding,M.linear?this.easeTo(M,B):this.flyTo(M,B)):this},E.prototype.jumpTo=function(T,M){this.stop();var B=this.transform,W=!1,Y=!1,re=!1;return"zoom"in T&&B.zoom!==+T.zoom&&(W=!0,B.zoom=+T.zoom),T.center!==void 0&&(B.center=p.LngLat.convert(T.center)),"bearing"in T&&B.bearing!==+T.bearing&&(Y=!0,B.bearing=+T.bearing),"pitch"in T&&B.pitch!==+T.pitch&&(re=!0,B.pitch=+T.pitch),T.padding==null||B.isPaddingEqual(T.padding)||(B.padding=T.padding),this.fire(new p.Event("movestart",M)).fire(new p.Event("move",M)),W&&this.fire(new p.Event("zoomstart",M)).fire(new p.Event("zoom",M)).fire(new p.Event("zoomend",M)),Y&&this.fire(new p.Event("rotatestart",M)).fire(new p.Event("rotate",M)).fire(new p.Event("rotateend",M)),re&&this.fire(new p.Event("pitchstart",M)).fire(new p.Event("pitch",M)).fire(new p.Event("pitchend",M)),this.fire(new p.Event("moveend",M))},E.prototype.easeTo=function(T,M){var B=this;this._stop(!1,T.easeId),((T=p.extend({offset:[0,0],duration:500,easing:p.ease},T)).animate===!1||!T.essential&&p.browser.prefersReducedMotion)&&(T.duration=0);var W=this.transform,Y=this.getZoom(),re=this.getBearing(),ye=this.getPitch(),Ae=this.getPadding(),Ze="zoom"in T?+T.zoom:Y,Je="bearing"in T?this._normalizeBearing(T.bearing,re):re,ke="pitch"in T?+T.pitch:ye,ut="padding"in T?T.padding:W.padding,ht=p.Point.convert(T.offset),Ct=W.centerPoint.add(ht),lt=W.pointLocation(Ct),It=p.LngLat.convert(T.center||lt);this._normalizeCenter(It);var Lt,Jt,vr=W.project(lt),mr=W.project(It).sub(vr),wr=W.zoomScale(Ze-Y);T.around&&(Lt=p.LngLat.convert(T.around),Jt=W.locationPoint(Lt));var Ur={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ze!==Y,this._rotating=this._rotating||re!==Je,this._pitching=this._pitching||ke!==ye,this._padding=!W.isPaddingEqual(ut),this._easeId=T.easeId,this._prepareEase(M,T.noMoveStart,Ur),this._ease(function(on){if(B._zooming&&(W.zoom=p.number(Y,Ze,on)),B._rotating&&(W.bearing=p.number(re,Je,on)),B._pitching&&(W.pitch=p.number(ye,ke,on)),B._padding&&(W.interpolatePadding(Ae,ut,on),Ct=W.centerPoint.add(ht)),Lt)W.setLocationAtPoint(Lt,Jt);else{var Hr=W.zoomScale(W.zoom-Y),mn=Ze>Y?Math.min(2,wr):Math.max(.5,wr),Yn=Math.pow(mn,1-on),ni=W.unproject(vr.add(mr.mult(on*Yn)).mult(Hr));W.setLocationAtPoint(W.renderWorldCopies?ni.wrap():ni,Ct)}B._fireMoveEvents(M)},function(on){B._afterEase(M,on)},T),this},E.prototype._prepareEase=function(T,M,B){B===void 0&&(B={}),this._moving=!0,M||B.moving||this.fire(new p.Event("movestart",T)),this._zooming&&!B.zooming&&this.fire(new p.Event("zoomstart",T)),this._rotating&&!B.rotating&&this.fire(new p.Event("rotatestart",T)),this._pitching&&!B.pitching&&this.fire(new p.Event("pitchstart",T))},E.prototype._fireMoveEvents=function(T){this.fire(new p.Event("move",T)),this._zooming&&this.fire(new p.Event("zoom",T)),this._rotating&&this.fire(new p.Event("rotate",T)),this._pitching&&this.fire(new p.Event("pitch",T))},E.prototype._afterEase=function(T,M){if(!this._easeId||!M||this._easeId!==M){delete this._easeId;var B=this._zooming,W=this._rotating,Y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,B&&this.fire(new p.Event("zoomend",T)),W&&this.fire(new p.Event("rotateend",T)),Y&&this.fire(new p.Event("pitchend",T)),this.fire(new p.Event("moveend",T))}},E.prototype.flyTo=function(T,M){var B=this;if(!T.essential&&p.browser.prefersReducedMotion){var W=p.pick(T,["center","zoom","bearing","pitch","around"]);return this.jumpTo(W,M)}this.stop(),T=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},T);var Y=this.transform,re=this.getZoom(),ye=this.getBearing(),Ae=this.getPitch(),Ze=this.getPadding(),Je="zoom"in T?p.clamp(+T.zoom,Y.minZoom,Y.maxZoom):re,ke="bearing"in T?this._normalizeBearing(T.bearing,ye):ye,ut="pitch"in T?+T.pitch:Ae,ht="padding"in T?T.padding:Y.padding,Ct=Y.zoomScale(Je-re),lt=p.Point.convert(T.offset),It=Y.centerPoint.add(lt),Lt=Y.pointLocation(It),Jt=p.LngLat.convert(T.center||Lt);this._normalizeCenter(Jt);var vr=Y.project(Lt),mr=Y.project(Jt).sub(vr),wr=T.curve,Ur=Math.max(Y.width,Y.height),on=Ur/Ct,Hr=mr.mag();if("minZoom"in T){var mn=p.clamp(Math.min(T.minZoom,re,Je),Y.minZoom,Y.maxZoom),Yn=Ur/Y.zoomScale(mn-re);wr=Math.sqrt(Yn/Hr*2)}var ni=wr*wr;function Jn(yi){var ii=(on*on-Ur*Ur+(yi?-1:1)*ni*ni*Hr*Hr)/(2*(yi?on:Ur)*ni*Hr);return Math.log(Math.sqrt(ii*ii+1)-ii)}function io(yi){return(Math.exp(yi)-Math.exp(-yi))/2}function An(yi){return(Math.exp(yi)+Math.exp(-yi))/2}var Qn=Jn(0),$n=function(yi){return An(Qn)/An(Qn+wr*yi)},vi=function(yi){return Ur*((An(Qn)*(io(ii=Qn+wr*yi)/An(ii))-io(Qn))/ni)/Hr;var ii},xi=(Jn(1)-Qn)/wr;if(Math.abs(Hr)<1e-6||!isFinite(xi)){if(Math.abs(Ur-on)<1e-6)return this.easeTo(T,M);var Ii=on<Ur?-1:1;xi=Math.abs(Math.log(on/Ur))/wr,vi=function(){return 0},$n=function(yi){return Math.exp(Ii*wr*yi)}}return T.duration="duration"in T?+T.duration:1e3*xi/("screenSpeed"in T?+T.screenSpeed/wr:+T.speed),T.maxDuration&&T.duration>T.maxDuration&&(T.duration=0),this._zooming=!0,this._rotating=ye!==ke,this._pitching=ut!==Ae,this._padding=!Y.isPaddingEqual(ht),this._prepareEase(M,!1),this._ease(function(yi){var ii=yi*xi,is=1/$n(ii);Y.zoom=yi===1?Je:re+Y.scaleZoom(is),B._rotating&&(Y.bearing=p.number(ye,ke,yi)),B._pitching&&(Y.pitch=p.number(Ae,ut,yi)),B._padding&&(Y.interpolatePadding(Ze,ht,yi),It=Y.centerPoint.add(lt));var ra=yi===1?Jt:Y.unproject(vr.add(mr.mult(vi(ii))).mult(is));Y.setLocationAtPoint(Y.renderWorldCopies?ra.wrap():ra,It),B._fireMoveEvents(M)},function(){return B._afterEase(M)},T),this},E.prototype.isEasing=function(){return!!this._easeFrameId},E.prototype.stop=function(){return this._stop()},E.prototype._stop=function(T,M){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var B=this._onEaseEnd;delete this._onEaseEnd,B.call(this,M)}if(!T){var W=this.handlers;W&&W.stop(!1)}return this},E.prototype._ease=function(T,M,B){B.animate===!1||B.duration===0?(T(1),M()):(this._easeStart=p.browser.now(),this._easeOptions=B,this._onEaseFrame=T,this._onEaseEnd=M,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},E.prototype._renderFrameCallback=function(){var T=Math.min((p.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(T)),T<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},E.prototype._normalizeBearing=function(T,M){T=p.wrap(T,-180,180);var B=Math.abs(T-M);return Math.abs(T-360-M)<B&&(T-=360),Math.abs(T+360-M)<B&&(T+=360),T},E.prototype._normalizeCenter=function(T){var M=this.transform;if(M.renderWorldCopies&&!M.lngRange){var B=T.lng-M.center.lng;T.lng+=B>180?-360:B<-180?360:0}},E}(p.Evented),As=function(S){S===void 0&&(S={}),this.options=S,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};As.prototype.getDefaultPosition=function(){return"bottom-right"},As.prototype.onAdd=function(S){var E=this.options&&this.options.compact;return this._map=S,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),E&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),E===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},As.prototype.onRemove=function(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},As.prototype._setElementTitle=function(S,E){var T=this._map._getUIString("AttributionControl."+E);S.title=T,S.setAttribute("aria-label",T)},As.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},As.prototype._updateEditLink=function(){var S=this._editLink;S||(S=this._editLink=this._container.querySelector(".mapbox-improve-map"));var E=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(S){var T=E.reduce(function(M,B,W){return B.value&&(M+=B.key+"="+B.value+(W<E.length-1?"&":"")),M},"?");S.href=p.config.FEEDBACK_URL+"/"+T+(this._map._hash?this._map._hash.getHashString(!0):""),S.rel="noopener nofollow",this._setElementTitle(S,"MapFeedback")}},As.prototype._updateData=function(S){!S||S.sourceDataType!=="metadata"&&S.sourceDataType!=="visibility"&&S.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},As.prototype._updateAttributions=function(){if(this._map.style){var S=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?S=S.concat(this.options.customAttribution.map(function(re){return typeof re!="string"?"":re})):typeof this.options.customAttribution=="string"&&S.push(this.options.customAttribution)),this._map.style.stylesheet){var E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}var T=this._map.style.sourceCaches;for(var M in T){var B=T[M];if(B.used){var W=B.getSource();W.attribution&&S.indexOf(W.attribution)<0&&S.push(W.attribution)}}S.sort(function(re,ye){return re.length-ye.length});var Y=(S=S.filter(function(re,ye){for(var Ae=ye+1;Ae<S.length;Ae++)if(S[Ae].indexOf(re)>=0)return!1;return!0})).join(" | ");Y!==this._attribHTML&&(this._attribHTML=Y,S.length?(this._innerContainer.innerHTML=Y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},As.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Nl=function(){p.bindAll(["_updateLogo"],this),p.bindAll(["_updateCompact"],this)};Nl.prototype.onAdd=function(S){this._map=S,this._container=L.create("div","mapboxgl-ctrl");var E=L.create("a","mapboxgl-ctrl-logo");return E.target="_blank",E.rel="noopener nofollow",E.href="https://www.mapbox.com/",E.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),E.setAttribute("rel","noopener nofollow"),this._container.appendChild(E),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Nl.prototype.onRemove=function(){L.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Nl.prototype.getDefaultPosition=function(){return"bottom-left"},Nl.prototype._updateLogo=function(S){S&&S.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Nl.prototype._logoRequired=function(){if(this._map.style){var S=this._map.style.sourceCaches;for(var E in S)if(S[E].getSource().mapbox_logo)return!0;return!1}},Nl.prototype._updateCompact=function(){var S=this._container.children;if(S.length){var E=S[0];this._map.getCanvasContainer().offsetWidth<250?E.classList.add("mapboxgl-compact"):E.classList.remove("mapboxgl-compact")}};var _s=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};_s.prototype.add=function(S){var E=++this._id;return this._queue.push({callback:S,id:E,cancelled:!1}),E},_s.prototype.remove=function(S){for(var E=this._currentlyRunning,T=0,M=E?this._queue.concat(E):this._queue;T<M.length;T+=1){var B=M[T];if(B.id===S)return void(B.cancelled=!0)}},_s.prototype.run=function(S){S===void 0&&(S=0);var E=this._currentlyRunning=this._queue;this._queue=[];for(var T=0,M=E;T<M.length;T+=1){var B=M[T];if(!B.cancelled&&(B.callback(S),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},_s.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ql={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},cp=p.window.HTMLImageElement,up=p.window.HTMLElement,Mo=p.window.ImageBitmap,Ya={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Wu=function(S){function E(M){var B=this;if((M=p.extend({},Ya,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var W=new co(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies);if(S.call(this,W,M),this._interactive=M.interactive,this._maxTileCacheSize=M.maxTileCacheSize,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new _s,this._controls=[],this._mapId=p.uniqueId(),this._locale=p.extend({},Ql,M.locale),this._clickTolerance=M.clickTolerance,this._requestManager=new p.RequestManager(M.transformRequest,M.accessToken),typeof M.container=="string"){if(this._container=p.window.document.getElementById(M.container),!this._container)throw new Error("Container '"+M.container+"' not found.")}else{if(!(M.container instanceof up))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return B._update(!1)}),this.on("moveend",function(){return B._update(!1)}),this.on("zoom",function(){return B._update(!0)}),p.window!==void 0&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Bn(this,M),this._hash=M.hash&&new Hs(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,p.extend({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new As({customAttribution:M.customAttribution})),this.addControl(new Nl,M.logoPosition),this.on("style.load",function(){B.transform.unmodified&&B.jumpTo(B.style.stylesheet)}),this.on("data",function(Y){B._update(Y.dataType==="style"),B.fire(new p.Event(Y.dataType+"data",Y))}),this.on("dataloading",function(Y){B.fire(new p.Event(Y.dataType+"dataloading",Y))})}S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E;var T={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return E.prototype._getMapId=function(){return this._mapId},E.prototype.addControl=function(M,B){if(B===void 0&&(B=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var W=M.onAdd(this);this._controls.push(M);var Y=this._controlPositions[B];return B.indexOf("bottom")!==-1?Y.insertBefore(W,Y.firstChild):Y.appendChild(W),this},E.prototype.removeControl=function(M){if(!M||!M.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var B=this._controls.indexOf(M);return B>-1&&this._controls.splice(B,1),M.onRemove(this),this},E.prototype.hasControl=function(M){return this._controls.indexOf(M)>-1},E.prototype.resize=function(M){var B=this._containerDimensions(),W=B[0],Y=B[1];if(W===this.transform.width&&Y===this.transform.height)return this;this._resizeCanvas(W,Y),this.transform.resize(W,Y),this.painter.resize(W,Y);var re=!this._moving;return re&&this.fire(new p.Event("movestart",M)).fire(new p.Event("move",M)),this.fire(new p.Event("resize",M)),re&&this.fire(new p.Event("moveend",M)),this},E.prototype.getBounds=function(){return this.transform.getBounds()},E.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},E.prototype.setMaxBounds=function(M){return this.transform.setMaxBounds(p.LngLatBounds.convert(M)),this._update()},E.prototype.setMinZoom=function(M){if((M=M??-2)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},E.prototype.getMinZoom=function(){return this.transform.minZoom},E.prototype.setMaxZoom=function(M){if((M=M??22)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")},E.prototype.getMaxZoom=function(){return this.transform.maxZoom},E.prototype.setMinPitch=function(M){if((M=M??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},E.prototype.getMinPitch=function(){return this.transform.minPitch},E.prototype.setMaxPitch=function(M){if((M=M??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")},E.prototype.getMaxPitch=function(){return this.transform.maxPitch},E.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},E.prototype.setRenderWorldCopies=function(M){return this.transform.renderWorldCopies=M,this._update()},E.prototype.project=function(M){return this.transform.locationPoint(p.LngLat.convert(M))},E.prototype.unproject=function(M){return this.transform.pointLocation(p.Point.convert(M))},E.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},E.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},E.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},E.prototype._createDelegatedListener=function(M,B,W){var Y,re=this;if(M==="mouseenter"||M==="mouseover"){var ye=!1;return{layer:B,listener:W,delegates:{mousemove:function(Ze){var Je=re.getLayer(B)?re.queryRenderedFeatures(Ze.point,{layers:[B]}):[];Je.length?ye||(ye=!0,W.call(re,new qo(M,re,Ze.originalEvent,{features:Je}))):ye=!1},mouseout:function(){ye=!1}}}}if(M==="mouseleave"||M==="mouseout"){var Ae=!1;return{layer:B,listener:W,delegates:{mousemove:function(Ze){(re.getLayer(B)?re.queryRenderedFeatures(Ze.point,{layers:[B]}):[]).length?Ae=!0:Ae&&(Ae=!1,W.call(re,new qo(M,re,Ze.originalEvent)))},mouseout:function(Ze){Ae&&(Ae=!1,W.call(re,new qo(M,re,Ze.originalEvent)))}}}}return{layer:B,listener:W,delegates:(Y={},Y[M]=function(Ze){var Je=re.getLayer(B)?re.queryRenderedFeatures(Ze.point,{layers:[B]}):[];Je.length&&(Ze.features=Je,W.call(re,Ze),delete Ze.features)},Y)}},E.prototype.on=function(M,B,W){if(W===void 0)return S.prototype.on.call(this,M,B);var Y=this._createDelegatedListener(M,B,W);for(var re in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push(Y),Y.delegates)this.on(re,Y.delegates[re]);return this},E.prototype.once=function(M,B,W){if(W===void 0)return S.prototype.once.call(this,M,B);var Y=this._createDelegatedListener(M,B,W);for(var re in Y.delegates)this.once(re,Y.delegates[re]);return this},E.prototype.off=function(M,B,W){var Y=this;return W===void 0?S.prototype.off.call(this,M,B):(this._delegatedListeners&&this._delegatedListeners[M]&&function(re){for(var ye=re[M],Ae=0;Ae<ye.length;Ae++){var Ze=ye[Ae];if(Ze.layer===B&&Ze.listener===W){for(var Je in Ze.delegates)Y.off(Je,Ze.delegates[Je]);return ye.splice(Ae,1),Y}}}(this._delegatedListeners),this)},E.prototype.queryRenderedFeatures=function(M,B){if(!this.style)return[];var W;if(B!==void 0||M===void 0||M instanceof p.Point||Array.isArray(M)||(B=M,M=void 0),B=B||{},(M=M||[[0,0],[this.transform.width,this.transform.height]])instanceof p.Point||typeof M[0]=="number")W=[p.Point.convert(M)];else{var Y=p.Point.convert(M[0]),re=p.Point.convert(M[1]);W=[Y,new p.Point(re.x,Y.y),re,new p.Point(Y.x,re.y),Y]}return this.style.queryRenderedFeatures(W,B,this.transform)},E.prototype.querySourceFeatures=function(M,B){return this.style.querySourceFeatures(M,B)},E.prototype.setStyle=function(M,B){return(B=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},B)).diff!==!1&&B.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,B),this):(this._localIdeographFontFamily=B.localIdeographFontFamily,this._updateStyle(M,B))},E.prototype._getUIString=function(M){var B=this._locale[M];if(B==null)throw new Error("Missing UI string '"+M+"'");return B},E.prototype._updateStyle=function(M,B){return this.style&&(this.style.setEventedParent(null),this.style._remove()),M?(this.style=new $a(this,B||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M):this.style.loadJSON(M),this):(delete this.style,this)},E.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new $a(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},E.prototype._diffStyle=function(M,B){var W=this;if(typeof M=="string"){var Y=this._requestManager.normalizeStyleURL(M),re=this._requestManager.transformRequest(Y,p.ResourceType.Style);p.getJSON(re,function(ye,Ae){ye?W.fire(new p.ErrorEvent(ye)):Ae&&W._updateDiff(Ae,B)})}else typeof M=="object"&&this._updateDiff(M,B)},E.prototype._updateDiff=function(M,B){try{this.style.setState(M)&&this._update(!0)}catch(W){p.warnOnce("Unable to perform style diff: "+(W.message||W.error||W)+".  Rebuilding the style from scratch."),this._updateStyle(M,B)}},E.prototype.getStyle=function(){if(this.style)return this.style.serialize()},E.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():p.warnOnce("There is no style added to the map.")},E.prototype.addSource=function(M,B){return this._lazyInitEmptyStyle(),this.style.addSource(M,B),this._update(!0)},E.prototype.isSourceLoaded=function(M){var B=this.style&&this.style.sourceCaches[M];if(B!==void 0)return B.loaded();this.fire(new p.ErrorEvent(new Error("There is no source with ID '"+M+"'")))},E.prototype.areTilesLoaded=function(){var M=this.style&&this.style.sourceCaches;for(var B in M){var W=M[B]._tiles;for(var Y in W){var re=W[Y];if(re.state!=="loaded"&&re.state!=="errored")return!1}}return!0},E.prototype.addSourceType=function(M,B,W){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,B,W)},E.prototype.removeSource=function(M){return this.style.removeSource(M),this._update(!0)},E.prototype.getSource=function(M){return this.style.getSource(M)},E.prototype.addImage=function(M,B,W){W===void 0&&(W={});var Y=W.pixelRatio;Y===void 0&&(Y=1);var re=W.sdf;re===void 0&&(re=!1);var ye=W.stretchX,Ae=W.stretchY,Ze=W.content;if(this._lazyInitEmptyStyle(),B instanceof cp||Mo&&B instanceof Mo){var Je=p.browser.getImageData(B);this.style.addImage(M,{data:new p.RGBAImage({width:Je.width,height:Je.height},Je.data),pixelRatio:Y,stretchX:ye,stretchY:Ae,content:Ze,sdf:re,version:0})}else{if(B.width===void 0||B.height===void 0)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ke=B;this.style.addImage(M,{data:new p.RGBAImage({width:B.width,height:B.height},new Uint8Array(B.data)),pixelRatio:Y,stretchX:ye,stretchY:Ae,content:Ze,sdf:re,version:0,userImage:ke}),ke.onAdd&&ke.onAdd(this,M)}},E.prototype.updateImage=function(M,B){var W=this.style.getImage(M);if(!W)return this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Y=B instanceof cp||Mo&&B instanceof Mo?p.browser.getImageData(B):B,re=Y.width,ye=Y.height,Ae=Y.data;return re===void 0||ye===void 0?this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):re!==W.data.width||ye!==W.data.height?this.fire(new p.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(W.data.replace(Ae,!(B instanceof cp||Mo&&B instanceof Mo)),void this.style.updateImage(M,W))},E.prototype.hasImage=function(M){return M?!!this.style.getImage(M):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)},E.prototype.removeImage=function(M){this.style.removeImage(M)},E.prototype.loadImage=function(M,B){p.getImage(this._requestManager.transformRequest(M,p.ResourceType.Image),B)},E.prototype.listImages=function(){return this.style.listImages()},E.prototype.addLayer=function(M,B){return this._lazyInitEmptyStyle(),this.style.addLayer(M,B),this._update(!0)},E.prototype.moveLayer=function(M,B){return this.style.moveLayer(M,B),this._update(!0)},E.prototype.removeLayer=function(M){return this.style.removeLayer(M),this._update(!0)},E.prototype.getLayer=function(M){return this.style.getLayer(M)},E.prototype.setLayerZoomRange=function(M,B,W){return this.style.setLayerZoomRange(M,B,W),this._update(!0)},E.prototype.setFilter=function(M,B,W){return W===void 0&&(W={}),this.style.setFilter(M,B,W),this._update(!0)},E.prototype.getFilter=function(M){return this.style.getFilter(M)},E.prototype.setPaintProperty=function(M,B,W,Y){return Y===void 0&&(Y={}),this.style.setPaintProperty(M,B,W,Y),this._update(!0)},E.prototype.getPaintProperty=function(M,B){return this.style.getPaintProperty(M,B)},E.prototype.setLayoutProperty=function(M,B,W,Y){return Y===void 0&&(Y={}),this.style.setLayoutProperty(M,B,W,Y),this._update(!0)},E.prototype.getLayoutProperty=function(M,B){return this.style.getLayoutProperty(M,B)},E.prototype.setLight=function(M,B){return B===void 0&&(B={}),this._lazyInitEmptyStyle(),this.style.setLight(M,B),this._update(!0)},E.prototype.getLight=function(){return this.style.getLight()},E.prototype.setFeatureState=function(M,B){return this.style.setFeatureState(M,B),this._update()},E.prototype.removeFeatureState=function(M,B){return this.style.removeFeatureState(M,B),this._update()},E.prototype.getFeatureState=function(M){return this.style.getFeatureState(M)},E.prototype.getContainer=function(){return this._container},E.prototype.getCanvasContainer=function(){return this._canvasContainer},E.prototype.getCanvas=function(){return this._canvas},E.prototype._containerDimensions=function(){var M=0,B=0;return this._container&&(M=this._container.clientWidth||400,B=this._container.clientHeight||300),[M,B]},E.prototype._detectMissingCSS=function(){p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},E.prototype._setupContainer=function(){var M=this._container;M.classList.add("mapboxgl-map"),(this._missingCSSCanary=L.create("div","mapboxgl-canary",M)).style.visibility="hidden",this._detectMissingCSS();var B=this._canvasContainer=L.create("div","mapboxgl-canvas-container",M);this._interactive&&B.classList.add("mapboxgl-interactive"),this._canvas=L.create("canvas","mapboxgl-canvas",B),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var W=this._containerDimensions();this._resizeCanvas(W[0],W[1]);var Y=this._controlContainer=L.create("div","mapboxgl-control-container",M),re=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ye){re[ye]=L.create("div","mapboxgl-ctrl-"+ye,Y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},E.prototype._resizeCanvas=function(M,B){var W=p.browser.devicePixelRatio||1;this._canvas.width=W*M,this._canvas.height=W*B,this._canvas.style.width=M+"px",this._canvas.style.height=B+"px"},E.prototype._setupPainter=function(){var M=p.extend({},s.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),B=this._canvas.getContext("webgl",M)||this._canvas.getContext("experimental-webgl",M);B?(this.painter=new Oo(B,this.transform),p.webpSupported.testSupport(B)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))},E.prototype._contextLost=function(M){M.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:M}))},E.prototype._contextRestored=function(M){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:M}))},E.prototype._onMapScroll=function(M){if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},E.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},E.prototype._update=function(M){return this.style?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this},E.prototype._requestRenderFrame=function(M){return this._update(),this._renderTaskQueue.add(M)},E.prototype._cancelRenderFrame=function(M){this._renderTaskQueue.remove(M)},E.prototype._render=function(M){var B,W=this,Y=0,re=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(B=re.createQueryEXT(),re.beginQueryEXT(re.TIME_ELAPSED_EXT,B),Y=p.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),!this._removed){var ye=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ae=this.transform.zoom,Ze=p.browser.now();this.style.zoomHistory.update(Ae,Ze);var Je=new p.EvaluationParameters(Ae,{now:Ze,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ke=Je.crossFadingFactor();ke===1&&ke===this._crossFadingFactor||(ye=!0,this._crossFadingFactor=ke),this.style.update(Je)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||ye)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ut=p.browser.now()-Y;re.endQueryEXT(re.TIME_ELAPSED_EXT,B),setTimeout(function(){var lt=re.getQueryObjectEXT(B,re.QUERY_RESULT_EXT)/1e6;re.deleteQueryEXT(B),W.fire(new p.Event("gpu-timing-frame",{cpuTime:ut,gpuTime:lt}))},50)}if(this.listens("gpu-timing-layer")){var ht=this.painter.collectGpuTimers();setTimeout(function(){var lt=W.painter.queryGpuTimers(ht);W.fire(new p.Event("gpu-timing-layer",{layerTimes:lt}))},50)}var Ct=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ct||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new p.Event("idle")),!this._loaded||this._fullyLoaded||Ct||(this._fullyLoaded=!0),this}},E.prototype.remove=function(){this._hash&&this._hash.remove();for(var M=0,B=this._controls;M<B.length;M+=1)B[M].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),p.window!==void 0&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1));var W=this.painter.context.gl.getExtension("WEBGL_lose_context");W&&W.loseContext(),ec(this._canvasContainer),ec(this._controlContainer),ec(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new p.Event("remove"))},E.prototype.triggerRepaint=function(){var M=this;this.style&&!this._frame&&(this._frame=p.browser.frame(function(B){M._frame=null,M._render(B)}))},E.prototype._onWindowOnline=function(){this._update()},E.prototype._onWindowResize=function(M){this._trackResize&&this.resize({originalEvent:M})._update()},T.showTileBoundaries.get=function(){return!!this._showTileBoundaries},T.showTileBoundaries.set=function(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())},T.showPadding.get=function(){return!!this._showPadding},T.showPadding.set=function(M){this._showPadding!==M&&(this._showPadding=M,this._update())},T.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},T.showCollisionBoxes.set=function(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())},T.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},T.showOverdrawInspector.set=function(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())},T.repaint.get=function(){return!!this._repaint},T.repaint.set=function(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())},T.vertices.get=function(){return!!this._vertices},T.vertices.set=function(M){this._vertices=M,this._update()},E.prototype._setCacheLimits=function(M,B){p.setCacheLimits(M,B)},T.version.get=function(){return p.version},Object.defineProperties(E.prototype,T),E}(Qp);function ec(S){S.parentNode&&S.parentNode.removeChild(S)}var hp={showCompass:!0,showZoom:!0,visualizePitch:!1},ll=function(S){var E=this;this.options=p.extend({},hp,S),this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(T){return T.preventDefault()}),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(T){return E._map.zoomIn({},{originalEvent:T})}),L.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(T){return E._map.zoomOut({},{originalEvent:T})}),L.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(T){E.options.visualizePitch?E._map.resetNorthPitch({},{originalEvent:T}):E._map.resetNorth({},{originalEvent:T})}),this._compassIcon=L.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ll.prototype._updateZoomButtons=function(){var S=this._map.getZoom(),E=S===this._map.getMaxZoom(),T=S===this._map.getMinZoom();this._zoomInButton.disabled=E,this._zoomOutButton.disabled=T,this._zoomInButton.setAttribute("aria-disabled",E.toString()),this._zoomOutButton.setAttribute("aria-disabled",T.toString())},ll.prototype._rotateCompassArrow=function(){var S=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=S},ll.prototype.onAdd=function(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cl(this._map,this._compass,this.options.visualizePitch)),this._container},ll.prototype.onRemove=function(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ll.prototype._createButton=function(S,E){var T=L.create("button",S,this._container);return T.type="button",T.addEventListener("click",E),T},ll.prototype._setButtonTitle=function(S,E){var T=this._map._getUIString("NavigationControl."+E);S.title=T,S.setAttribute("aria-label",T)};var cl=function(S,E,T){T===void 0&&(T=!1),this._clickTolerance=10,this.element=E,this.mouseRotate=new Ys({clickTolerance:S.dragRotate._mouseRotate._clickTolerance}),this.map=S,T&&(this.mousePitch=new Gu({clickTolerance:S.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(E,"mousedown",this.mousedown),L.addEventListener(E,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(E,"touchmove",this.touchmove),L.addEventListener(E,"touchend",this.touchend),L.addEventListener(E,"touchcancel",this.reset)};function _u(S,E,T){if(S=new p.LngLat(S.lng,S.lat),E){var M=new p.LngLat(S.lng-360,S.lat),B=new p.LngLat(S.lng+360,S.lat),W=T.locationPoint(S).distSqr(E);T.locationPoint(M).distSqr(E)<W?S=M:T.locationPoint(B).distSqr(E)<W&&(S=B)}for(;Math.abs(S.lng-T.center.lng)>180;){var Y=T.locationPoint(S);if(Y.x>=0&&Y.y>=0&&Y.x<=T.width&&Y.y<=T.height)break;S.lng>T.center.lng?S.lng-=360:S.lng+=360}return S}cl.prototype.down=function(S,E){this.mouseRotate.mousedown(S,E),this.mousePitch&&this.mousePitch.mousedown(S,E),L.disableDrag()},cl.prototype.move=function(S,E){var T=this.map,M=this.mouseRotate.mousemoveWindow(S,E);if(M&&M.bearingDelta&&T.setBearing(T.getBearing()+M.bearingDelta),this.mousePitch){var B=this.mousePitch.mousemoveWindow(S,E);B&&B.pitchDelta&&T.setPitch(T.getPitch()+B.pitchDelta)}},cl.prototype.off=function(){var S=this.element;L.removeEventListener(S,"mousedown",this.mousedown),L.removeEventListener(S,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(S,"touchmove",this.touchmove),L.removeEventListener(S,"touchend",this.touchend),L.removeEventListener(S,"touchcancel",this.reset),this.offTemp()},cl.prototype.offTemp=function(){L.enableDrag(),L.removeEventListener(p.window,"mousemove",this.mousemove),L.removeEventListener(p.window,"mouseup",this.mouseup)},cl.prototype.mousedown=function(S){this.down(p.extend({},S,{ctrlKey:!0,preventDefault:function(){return S.preventDefault()}}),L.mousePos(this.element,S)),L.addEventListener(p.window,"mousemove",this.mousemove),L.addEventListener(p.window,"mouseup",this.mouseup)},cl.prototype.mousemove=function(S){this.move(S,L.mousePos(this.element,S))},cl.prototype.mouseup=function(S){this.mouseRotate.mouseupWindow(S),this.mousePitch&&this.mousePitch.mouseupWindow(S),this.offTemp()},cl.prototype.touchstart=function(S){S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,S.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return S.preventDefault()}},this._startPos))},cl.prototype.touchmove=function(S){S.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,S.targetTouches)[0],this.move({preventDefault:function(){return S.preventDefault()}},this._lastPos))},cl.prototype.touchend=function(S){S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},cl.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var tc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function dp(S,E,T){var M=S.classList;for(var B in tc)M.remove("mapboxgl-"+T+"-anchor-"+B);M.add("mapboxgl-"+T+"-anchor-"+E)}var Hu,Zu=function(S){function E(T,M){if(S.call(this),(T instanceof p.window.HTMLElement||M)&&(T=p.extend({element:T},M)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=T&&T.anchor||"center",this._color=T&&T.color||"#3FB1CE",this._scale=T&&T.scale||1,this._draggable=T&&T.draggable||!1,this._clickTolerance=T&&T.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=T&&T.rotation||0,this._rotationAlignment=T&&T.rotationAlignment||"auto",this._pitchAlignment=T&&T.pitchAlignment&&T.pitchAlignment!=="auto"?T.pitchAlignment:this._rotationAlignment,T&&T.element)this._element=T.element,this._offset=p.Point.convert(T&&T.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");var B=L.createNS("http://www.w3.org/2000/svg","svg");B.setAttributeNS(null,"display","block"),B.setAttributeNS(null,"height","41px"),B.setAttributeNS(null,"width","27px"),B.setAttributeNS(null,"viewBox","0 0 27 41");var W=L.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"stroke","none"),W.setAttributeNS(null,"stroke-width","1"),W.setAttributeNS(null,"fill","none"),W.setAttributeNS(null,"fill-rule","evenodd");var Y=L.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"fill-rule","nonzero");var re=L.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(3.0, 29.0)"),re.setAttributeNS(null,"fill","#000000");for(var ye=0,Ae=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ye<Ae.length;ye+=1){var Ze=Ae[ye],Je=L.createNS("http://www.w3.org/2000/svg","ellipse");Je.setAttributeNS(null,"opacity","0.04"),Je.setAttributeNS(null,"cx","10.5"),Je.setAttributeNS(null,"cy","5.80029008"),Je.setAttributeNS(null,"rx",Ze.rx),Je.setAttributeNS(null,"ry",Ze.ry),re.appendChild(Je)}var ke=L.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill",this._color);var ut=L.createNS("http://www.w3.org/2000/svg","path");ut.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ke.appendChild(ut);var ht=L.createNS("http://www.w3.org/2000/svg","g");ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"fill","#000000");var Ct=L.createNS("http://www.w3.org/2000/svg","path");Ct.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ht.appendChild(Ct);var lt=L.createNS("http://www.w3.org/2000/svg","g");lt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),lt.setAttributeNS(null,"fill","#FFFFFF");var It=L.createNS("http://www.w3.org/2000/svg","g");It.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Lt=L.createNS("http://www.w3.org/2000/svg","circle");Lt.setAttributeNS(null,"fill","#000000"),Lt.setAttributeNS(null,"opacity","0.25"),Lt.setAttributeNS(null,"cx","5.5"),Lt.setAttributeNS(null,"cy","5.5"),Lt.setAttributeNS(null,"r","5.4999962");var Jt=L.createNS("http://www.w3.org/2000/svg","circle");Jt.setAttributeNS(null,"fill","#FFFFFF"),Jt.setAttributeNS(null,"cx","5.5"),Jt.setAttributeNS(null,"cy","5.5"),Jt.setAttributeNS(null,"r","5.4999962"),It.appendChild(Lt),It.appendChild(Jt),Y.appendChild(re),Y.appendChild(ke),Y.appendChild(ht),Y.appendChild(lt),Y.appendChild(It),B.appendChild(Y),B.setAttributeNS(null,"height",41*this._scale+"px"),B.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(B),this._offset=p.Point.convert(T&&T.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(vr){vr.preventDefault()}),this._element.addEventListener("mousedown",function(vr){vr.preventDefault()}),dp(this._element,this._anchor,"marker"),this._popup=null}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.addTo=function(T){return this.remove(),this._map=T,T.getCanvasContainer().appendChild(this._element),T.on("move",this._update),T.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},E.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this},E.prototype.getLngLat=function(){return this._lngLat},E.prototype.setLngLat=function(T){return this._lngLat=p.LngLat.convert(T),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},E.prototype.getElement=function(){return this._element},E.prototype.setPopup=function(T){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),T){if(!("offset"in T.options)){var M=Math.sqrt(Math.pow(13.5,2)/2);T.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[M,-1*(24.6+M)],"bottom-right":[-M,-1*(24.6+M)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=T,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},E.prototype._onKeyPress=function(T){var M=T.code,B=T.charCode||T.keyCode;M!=="Space"&&M!=="Enter"&&B!==32&&B!==13||this.togglePopup()},E.prototype._onMapClick=function(T){var M=T.originalEvent.target,B=this._element;this._popup&&(M===B||B.contains(M))&&this.togglePopup()},E.prototype.getPopup=function(){return this._popup},E.prototype.togglePopup=function(){var T=this._popup;return T?(T.isOpen()?T.remove():T.addTo(this._map),this):this},E.prototype._update=function(T){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=_u(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var M="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?M="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(M="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var B="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?B="rotateX(0deg)":this._pitchAlignment==="map"&&(B="rotateX("+this._map.getPitch()+"deg)"),T&&T.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,tc[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+B+" "+M)}},E.prototype.getOffset=function(){return this._offset},E.prototype.setOffset=function(T){return this._offset=p.Point.convert(T),this._update(),this},E.prototype._onMove=function(T){if(!this._isDragging){var M=this._clickTolerance||this._map._clickTolerance;this._isDragging=T.point.dist(this._pointerdownPos)>=M}this._isDragging&&(this._pos=T.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))},E.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new p.Event("dragend")),this._state="inactive"},E.prototype._addDragHandler=function(T){this._element.contains(T.originalEvent.target)&&(T.preventDefault(),this._positionDelta=T.point.sub(this._pos).add(this._offset),this._pointerdownPos=T.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},E.prototype.setDraggable=function(T){return this._draggable=!!T,this._map&&(T?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},E.prototype.isDraggable=function(){return this._draggable},E.prototype.setRotation=function(T){return this._rotation=T||0,this._update(),this},E.prototype.getRotation=function(){return this._rotation},E.prototype.setRotationAlignment=function(T){return this._rotationAlignment=T||"auto",this._update(),this},E.prototype.getRotationAlignment=function(){return this._rotationAlignment},E.prototype.setPitchAlignment=function(T){return this._pitchAlignment=T&&T!=="auto"?T:this._rotationAlignment,this._update(),this},E.prototype.getPitchAlignment=function(){return this._pitchAlignment},E}(p.Evented),ef={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xu=0,vc=!1,Ff=function(S){function E(T){S.call(this),this.options=p.extend({},ef,T),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.onAdd=function(T){var M;return this._map=T,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),M=this._setupUI,Hu!==void 0?M(Hu):p.window.navigator.permissions!==void 0?p.window.navigator.permissions.query({name:"geolocation"}).then(function(B){M(Hu=B.state!=="denied")}):M(Hu=!!p.window.navigator.geolocation),this._container},E.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xu=0,vc=!1},E.prototype._isOutOfMapMaxBounds=function(T){var M=this._map.getMaxBounds(),B=T.coords;return M&&(B.longitude<M.getWest()||B.longitude>M.getEast()||B.latitude<M.getSouth()||B.latitude>M.getNorth())},E.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},E.prototype._onSuccess=function(T){if(this._map){if(this._isOutOfMapMaxBounds(T))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",T)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=T,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(T),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(T),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",T)),this._finish()}},E.prototype._updateCamera=function(T){var M=new p.LngLat(T.coords.longitude,T.coords.latitude),B=T.coords.accuracy,W=this._map.getBearing(),Y=p.extend({bearing:W},this.options.fitBoundsOptions);this._map.fitBounds(M.toBounds(B),Y,{geolocateSource:!0})},E.prototype._updateMarker=function(T){if(T){var M=new p.LngLat(T.coords.longitude,T.coords.latitude);this._accuracyCircleMarker.setLngLat(M).addTo(this._map),this._userLocationDotMarker.setLngLat(M).addTo(this._map),this._accuracy=T.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},E.prototype._updateCircleRadius=function(){var T=this._map._container.clientHeight/2,M=this._map.unproject([0,T]),B=this._map.unproject([1,T]),W=M.distanceTo(B),Y=Math.ceil(2*this._accuracy/W);this._circleElement.style.width=Y+"px",this._circleElement.style.height=Y+"px"},E.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},E.prototype._onError=function(T){if(this._map){if(this.options.trackUserLocation)if(T.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var M=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(T.code===3&&vc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",T)),this._finish()}},E.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},E.prototype._setupUI=function(T){var M=this;if(this._container.addEventListener("contextmenu",function(Y){return Y.preventDefault()}),this._geolocateButton=L.create("button","mapboxgl-ctrl-geolocate",this._container),L.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",T===!1){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var B=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=B,this._geolocateButton.setAttribute("aria-label",B)}else{var W=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=W,this._geolocateButton.setAttribute("aria-label",W)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Zu(this._dotElement),this._circleElement=L.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Y){Y.geolocateSource||M._watchState!=="ACTIVE_LOCK"||Y.originalEvent&&Y.originalEvent.type==="resize"||(M._watchState="BACKGROUND",M._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),M._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),M.fire(new p.Event("trackuserlocationend")))})},E.prototype.trigger=function(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xu--,vc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var T;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xu>1?(T={maximumAge:6e5,timeout:0},vc=!0):(T=this.options.positionOptions,vc=!1),this._geolocationWatchID=p.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else p.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},E.prototype._clearWatch=function(){p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},E}(p.Evented),Yu={maxWidth:100,unit:"metric"},yu=function(S){this.options=p.extend({},Yu,S),p.bindAll(["_onMove","setUnit"],this)};function pp(S,E,T){var M=T&&T.maxWidth||100,B=S._container.clientHeight/2,W=S.unproject([0,B]),Y=S.unproject([M,B]),re=W.distanceTo(Y);if(T&&T.unit==="imperial"){var ye=3.2808*re;ye>5280?xc(E,M,ye/5280,S._getUIString("ScaleControl.Miles")):xc(E,M,ye,S._getUIString("ScaleControl.Feet"))}else T&&T.unit==="nautical"?xc(E,M,re/1852,S._getUIString("ScaleControl.NauticalMiles")):re>=1e3?xc(E,M,re/1e3,S._getUIString("ScaleControl.Kilometers")):xc(E,M,re,S._getUIString("ScaleControl.Meters"))}function xc(S,E,T,M){var B,W,Y,re=(B=T,(W=Math.pow(10,(""+Math.floor(B)).length-1))*(Y=(Y=B/W)>=10?10:Y>=5?5:Y>=3?3:Y>=2?2:Y>=1?1:function(ye){var Ae=Math.pow(10,Math.ceil(-Math.log(ye)/Math.LN10));return Math.round(ye*Ae)/Ae}(Y)));S.style.width=E*(re/T)+"px",S.innerHTML=re+"&nbsp;"+M}yu.prototype.getDefaultPosition=function(){return"bottom-left"},yu.prototype._onMove=function(){pp(this._map,this._container,this.options)},yu.prototype.onAdd=function(S){return this._map=S,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},yu.prototype.onRemove=function(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},yu.prototype.setUnit=function(S){this.options.unit=S,pp(this._map,this._container,this.options)};var Js=function(S){this._fullscreen=!1,S&&S.container&&(S.container instanceof p.window.HTMLElement?this._container=S.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in p.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in p.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in p.window.document&&(this._fullscreenchange="MSFullscreenChange")};Js.prototype.onAdd=function(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Js.prototype.onRemove=function(){L.remove(this._controlContainer),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Js.prototype._checkFullscreenSupport=function(){return!!(p.window.document.fullscreenEnabled||p.window.document.mozFullScreenEnabled||p.window.document.msFullscreenEnabled||p.window.document.webkitFullscreenEnabled)},Js.prototype._setupUI=function(){var S=this._fullscreenButton=L.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","mapboxgl-ctrl-icon",S).setAttribute("aria-hidden",!0),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Js.prototype._updateTitle=function(){var S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S},Js.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Js.prototype._isFullscreen=function(){return this._fullscreen},Js.prototype._changeIcon=function(){(p.window.document.fullscreenElement||p.window.document.mozFullScreenElement||p.window.document.webkitFullscreenElement||p.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Js.prototype._onClickFullscreen=function(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.mozCancelFullScreen?p.window.document.mozCancelFullScreen():p.window.document.msExitFullscreen?p.window.document.msExitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var bd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ih=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ch=function(S){function E(T){S.call(this),this.options=p.extend(Object.create(bd),T),p.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return S&&(E.__proto__=S),(E.prototype=Object.create(S&&S.prototype)).constructor=E,E.prototype.addTo=function(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new p.Event("open")),this},E.prototype.isOpen=function(){return!!this._map},E.prototype.remove=function(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new p.Event("close")),this},E.prototype.getLngLat=function(){return this._lngLat},E.prototype.setLngLat=function(T){return this._lngLat=p.LngLat.convert(T),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},E.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},E.prototype.getElement=function(){return this._container},E.prototype.setText=function(T){return this.setDOMContent(p.window.document.createTextNode(T))},E.prototype.setHTML=function(T){var M,B=p.window.document.createDocumentFragment(),W=p.window.document.createElement("body");for(W.innerHTML=T;M=W.firstChild;)B.appendChild(M);return this.setDOMContent(B)},E.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},E.prototype.setMaxWidth=function(T){return this.options.maxWidth=T,this._update(),this},E.prototype.setDOMContent=function(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this},E.prototype.addClassName=function(T){this._container&&this._container.classList.add(T)},E.prototype.removeClassName=function(T){this._container&&this._container.classList.remove(T)},E.prototype.setOffset=function(T){return this.options.offset=T,this._update(),this},E.prototype.toggleClassName=function(T){if(this._container)return this._container.classList.toggle(T)},E.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=L.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},E.prototype._onMouseUp=function(T){this._update(T.point)},E.prototype._onMouseMove=function(T){this._update(T.point)},E.prototype._onDrag=function(T){this._update(T.point)},E.prototype._update=function(T){var M=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=L.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Je){return M._container.classList.add(Je)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_u(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||T)){var B=this._pos=this._trackPointer&&T?T:this._map.project(this._lngLat),W=this.options.anchor,Y=function Je(ke){if(ke){if(typeof ke=="number"){var ut=Math.round(Math.sqrt(.5*Math.pow(ke,2)));return{center:new p.Point(0,0),top:new p.Point(0,ke),"top-left":new p.Point(ut,ut),"top-right":new p.Point(-ut,ut),bottom:new p.Point(0,-ke),"bottom-left":new p.Point(ut,-ut),"bottom-right":new p.Point(-ut,-ut),left:new p.Point(ke,0),right:new p.Point(-ke,0)}}if(ke instanceof p.Point||Array.isArray(ke)){var ht=p.Point.convert(ke);return{center:ht,top:ht,"top-left":ht,"top-right":ht,bottom:ht,"bottom-left":ht,"bottom-right":ht,left:ht,right:ht}}return{center:p.Point.convert(ke.center||[0,0]),top:p.Point.convert(ke.top||[0,0]),"top-left":p.Point.convert(ke["top-left"]||[0,0]),"top-right":p.Point.convert(ke["top-right"]||[0,0]),bottom:p.Point.convert(ke.bottom||[0,0]),"bottom-left":p.Point.convert(ke["bottom-left"]||[0,0]),"bottom-right":p.Point.convert(ke["bottom-right"]||[0,0]),left:p.Point.convert(ke.left||[0,0]),right:p.Point.convert(ke.right||[0,0])}}return Je(new p.Point(0,0))}(this.options.offset);if(!W){var re,ye=this._container.offsetWidth,Ae=this._container.offsetHeight;re=B.y+Y.bottom.y<Ae?["top"]:B.y>this._map.transform.height-Ae?["bottom"]:[],B.x<ye/2?re.push("left"):B.x>this._map.transform.width-ye/2&&re.push("right"),W=re.length===0?"bottom":re.join("-")}var Ze=B.add(Y[W]).round();L.setTransform(this._container,tc[W]+" translate("+Ze.x+"px,"+Ze.y+"px)"),dp(this._container,W,"popup")}},E.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var T=this._container.querySelector(Ih);T&&T.focus()}},E.prototype._onClose=function(){this.remove()},E}(p.Evented),Ah={version:p.version,supported:s,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:Wu,NavigationControl:ll,GeolocateControl:Ff,AttributionControl:As,ScaleControl:yu,FullscreenControl:Js,Popup:Ch,Marker:Zu,Style:$a,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.Point,MercatorCoordinate:p.MercatorCoordinate,Evented:p.Evented,config:p.config,prewarm:function(){Nt().acquire(bt)},clearPrewarmedResources:function(){var S=ar;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(bt),ar=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(S){p.config.ACCESS_TOKEN=S},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(S){p.config.API_URL=S},get workerCount(){return Rt.workerCount},set workerCount(S){Rt.workerCount=S},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(S){p.config.MAX_PARALLEL_IMAGE_REQUESTS=S},clearStorage:function(S){p.clearTileCache(S)},workerUrl:""};return Ah}),f})})(xB);var see=xB.exports;const Im=S0(see);function lee(e){if(Array.isArray(e))return e}function cee(e,n){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var u,f,w,p,s=[],L=!0,F=!1;try{if(w=(a=a.call(e)).next,n===0){if(Object(a)!==a)return;L=!1}else for(;!(L=(u=w.call(a)).done)&&(s.push(u.value),s.length!==n);L=!0);}catch(G){F=!0,f=G}finally{try{if(!L&&a.return!=null&&(p=a.return(),Object(p)!==p))return}finally{if(F)throw f}}return s}}function xL(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,u=new Array(n);a<n;a++)u[a]=e[a];return u}function uee(e,n){if(e){if(typeof e=="string")return xL(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return xL(e,n)}}function hee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p_(e,n){return lee(e)||cee(e,n)||uee(e,n)||hee()}var dee=1e-7;function aA(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function bB(e,n){if(e===n)return!0;if(aA(e)&&aA(n)){if(e.length!==n.length)return!1;for(var a=0;a<e.length;++a)if(!bB(e[a],n[a]))return!1;return!0}return Math.abs(e-n)<=dee}function qw(e,n,a){return Math.max(n,Math.min(a,e))}function vS(e,n,a){return aA(e)?e.map(function(u,f){return vS(u,n[f],a)}):a*n+(1-a)*e}function Cu(e,n){if(!e)throw new Error(n||"react-map-gl: assertion failed.")}function pee(e){if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(e=fee(e))){var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(L){throw L},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,f=!0,w=!1,p;return{s:function(){u=e[Symbol.iterator]()},n:function(){var L=u.next();return f=L.done,L},e:function(L){w=!0,p=L},f:function(){try{!f&&u.return!=null&&u.return()}finally{if(w)throw p}}}}function fee(e,n){if(e){if(typeof e=="string")return bL(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bL(e,n)}}function bL(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,u=new Array(n);a<n;a++)u[a]=e[a];return u}var wB=function(){function e(){al(this,e),pr(this,"propNames",[])}return $s(e,[{key:"arePropsEqual",value:function(a,u){var f=pee(this.propNames||[]),w;try{for(f.s();!(w=f.n()).done;){var p=w.value;if(!bB(a[p],u[p]))return!1}}catch(s){f.e(s)}finally{f.f()}return!0}},{key:"initializeProps",value:function(a,u){return{start:a,end:u}}},{key:"interpolateProps",value:function(a,u,f){Cu(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(a,u){return u.transitionDuration}}]),e}(),mee={longitude:1,bearing:1};function xS(e){return Number.isFinite(e)||Array.isArray(e)}function gee(e){return e in mee}function sA(e,n,a){return gee(e)&&Math.abs(a-n)>180&&(a=a<0?a+360:a-360),a}function CI(e){if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(e=_ee(e))){var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(L){throw L},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,f=!0,w=!1,p;return{s:function(){u=e[Symbol.iterator]()},n:function(){var L=u.next();return f=L.done,L},e:function(L){w=!0,p=L},f:function(){try{!f&&u.return!=null&&u.return()}finally{if(w)throw p}}}}function _ee(e,n){if(e){if(typeof e=="string")return wL(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return wL(e,n)}}function wL(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,u=new Array(n);a<n;a++)u[a]=e[a];return u}function yee(e){var n=vee();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function vee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var xee=["longitude","latitude","zoom","bearing","pitch"],bee=["latitude","longitude","zoom","width","height"],SL=["bearing","pitch"],wee={speed:1.2,curve:1.414};(function(e){Rc(a,e);var n=yee(a);function a(){var u,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return al(this,a),u=n.call(this),pr(On(u),"speed",void 0),pr(On(u),"propNames",xee),pr(On(u),"props",void 0),u.props=Object.assign({},wee,f),u}return $s(a,[{key:"initializeProps",value:function(f,w){var p={},s={},L=CI(bee),F;try{for(L.s();!(F=L.n()).done;){var G=F.value,H=f[G],X=w[G];Cu(xS(H)&&xS(X),"".concat(G," must be supplied for transition")),p[G]=H,s[G]=sA(G,H,X)}}catch(ce){L.e(ce)}finally{L.f()}var ne=CI(SL),ie;try{for(ne.s();!(ie=ne.n()).done;){var se=ie.value,Te=f[se]||0,ue=w[se]||0;p[se]=Te,s[se]=sA(se,Te,ue)}}catch(ce){ne.e(ce)}finally{ne.f()}return{start:p,end:s}}},{key:"interpolateProps",value:function(f,w,p){var s=eee(f,w,p,this.props),L=CI(SL),F;try{for(L.s();!(F=L.n()).done;){var G=F.value;s[G]=vS(f[G],w[G],p)}}catch(H){L.e(H)}finally{L.f()}return s}},{key:"getDuration",value:function(f,w){var p=w.transitionDuration;return p==="auto"&&(p=tee(f,w,this.props)),p}}]),a})(wB);function TL(e){if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(e=See(e))){var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(L){throw L},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u,f=!0,w=!1,p;return{s:function(){u=e[Symbol.iterator]()},n:function(){var L=u.next();return f=L.done,L},e:function(L){w=!0,p=L},f:function(){try{!f&&u.return!=null&&u.return()}finally{if(w)throw p}}}}function See(e,n){if(e){if(typeof e=="string")return EL(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return EL(e,n)}}function EL(e,n){(n==null||n>e.length)&&(n=e.length);for(var a=0,u=new Array(n);a<n;a++)u[a]=e[a];return u}function Tee(e){var n=Eee();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Eee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Iee=["longitude","latitude","zoom","bearing","pitch"],TM=function(e){Rc(a,e);var n=Tee(a);function a(){var u,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return al(this,a),u=n.call(this),pr(On(u),"around",void 0),Array.isArray(f)&&(f={transitionProps:f}),u.propNames=f.transitionProps||Iee,f.around&&(u.around=f.around),u}return $s(a,[{key:"initializeProps",value:function(f,w){var p={},s={};if(this.around){p.around=this.around;var L=new Zd(f).unproject(this.around);Object.assign(s,w,{around:new Zd(w).project(L),aroundLngLat:L})}var F=TL(this.propNames),G;try{for(F.s();!(G=F.n()).done;){var H=G.value,X=f[H],ne=w[H];Cu(xS(X)&&xS(ne),"".concat(H," must be supplied for transition")),p[H]=X,s[H]=sA(H,X,ne)}}catch(ie){F.e(ie)}finally{F.f()}return{start:p,end:s}}},{key:"interpolateProps",value:function(f,w,p){var s={},L=TL(this.propNames),F;try{for(L.s();!(F=L.n()).done;){var G=F.value;s[G]=vS(f[G],w[G],p)}}catch(se){L.e(se)}finally{L.f()}if(w.around){var H=new Zd(Object.assign({},w,s)).getMapCenterByLngLatPosition({lngLat:w.aroundLngLat,pos:vS(f.around,w.around,p)}),X=p_(H,2),ne=X[0],ie=X[1];s.longitude=ne,s.latitude=ie}return s}}]),a}(wB),hy={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},AI={pitch:0,bearing:0,altitude:1.5},eb=function(){function e(n){var a=n.width,u=n.height,f=n.latitude,w=n.longitude,p=n.zoom,s=n.bearing,L=s===void 0?AI.bearing:s,F=n.pitch,G=F===void 0?AI.pitch:F,H=n.altitude,X=H===void 0?AI.altitude:H,ne=n.maxZoom,ie=ne===void 0?hy.maxZoom:ne,se=n.minZoom,Te=se===void 0?hy.minZoom:se,ue=n.maxPitch,ce=ue===void 0?hy.maxPitch:ue,de=n.minPitch,Ee=de===void 0?hy.minPitch:de,Ne=n.transitionDuration,rt=n.transitionEasing,tt=n.transitionInterpolator,Ge=n.transitionInterruption,_t=n.startPanLngLat,yt=n.startZoomLngLat,Et=n.startBearing,Wt=n.startPitch,Ar=n.startZoom;al(this,e),pr(this,"_viewportProps",void 0),pr(this,"_interactiveState",void 0),Cu(Number.isFinite(a),"`width` must be supplied"),Cu(Number.isFinite(u),"`height` must be supplied"),Cu(Number.isFinite(w),"`longitude` must be supplied"),Cu(Number.isFinite(f),"`latitude` must be supplied"),Cu(Number.isFinite(p),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:a,height:u,latitude:f,longitude:w,zoom:p,bearing:L,pitch:G,altitude:X,maxZoom:ie,minZoom:Te,maxPitch:ce,minPitch:Ee,transitionDuration:Ne,transitionEasing:rt,transitionInterpolator:tt,transitionInterruption:Ge}),this._interactiveState={startPanLngLat:_t,startZoomLngLat:yt,startBearing:Et,startPitch:Wt,startZoom:Ar}}return $s(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(a){var u=a.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(u)})}},{key:"pan",value:function(a){var u=a.pos,f=a.startPos,w=this._interactiveState.startPanLngLat||this._unproject(f);if(!w)return this;var p=this._calculateNewLngLat({startPanLngLat:w,pos:u}),s=p_(p,2),L=s[0],F=s[1];return this._getUpdatedMapState({longitude:L,latitude:F})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(a){return a.pos,this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(a){var u=a.deltaScaleX,f=u===void 0?0:u,w=a.deltaScaleY,p=w===void 0?0:w,s=this._interactiveState,L=s.startBearing,F=s.startPitch;if(!Number.isFinite(L)||!Number.isFinite(F))return this;var G=this._calculateNewPitchAndBearing({deltaScaleX:f,deltaScaleY:p,startBearing:L||0,startPitch:F||0}),H=G.pitch,X=G.bearing;return this._getUpdatedMapState({bearing:X,pitch:H})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(a){var u=a.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(u),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(a){var u=a.pos,f=a.startPos,w=a.scale;Cu(w>0,"`scale` must be a positive number");var p=this._interactiveState,s=p.startZoom,L=p.startZoomLngLat;Number.isFinite(s)||(s=this._viewportProps.zoom,L=this._unproject(f)||this._unproject(u)),Cu(L,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var F=this._calculateNewZoom({scale:w,startZoom:s||0}),G=new Zd(Object.assign({},this._viewportProps,{zoom:F})),H=G.getMapCenterByLngLatPosition({lngLat:L,pos:u}),X=p_(H,2),ne=X[0],ie=X[1];return this._getUpdatedMapState({zoom:F,longitude:ne,latitude:ie})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(a){return new e(Object.assign({},this._viewportProps,this._interactiveState,a))}},{key:"_applyConstraints",value:function(a){var u=a.maxZoom,f=a.minZoom,w=a.zoom;a.zoom=qw(w,f,u);var p=a.maxPitch,s=a.minPitch,L=a.pitch;return a.pitch=qw(L,s,p),Object.assign(a,JQ(a)),a}},{key:"_unproject",value:function(a){var u=new Zd(this._viewportProps);return a&&u.unproject(a)}},{key:"_calculateNewLngLat",value:function(a){var u=a.startPanLngLat,f=a.pos,w=new Zd(this._viewportProps);return w.getMapCenterByLngLatPosition({lngLat:u,pos:f})}},{key:"_calculateNewZoom",value:function(a){var u=a.scale,f=a.startZoom,w=this._viewportProps,p=w.maxZoom,s=w.minZoom,L=f+Math.log2(u);return qw(L,s,p)}},{key:"_calculateNewPitchAndBearing",value:function(a){var u=a.deltaScaleX,f=a.deltaScaleY,w=a.startBearing,p=a.startPitch;f=qw(f,-1,1);var s=this._viewportProps,L=s.minPitch,F=s.maxPitch,G=w+180*u,H=p;return f>0?H=p+f*(F-p):f<0&&(H=p-f*(L-p)),{pitch:H,bearing:G}}}]),e}();function Cee(e){return e[0].toLowerCase()+e.slice(1)}function Aee(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hy;for(var a in n){var u=a.slice(0,3),f=Cee(a.slice(3));if(u==="min"&&e[f]<n[a]||u==="max"&&e[f]>n[a])return!1}return!0}const b0=fe.createContext({viewport:null,map:null,mapContainer:null,onViewportChange:null,onViewStateChange:null,eventManager:null,isDragging:!1});function IL(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);n&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(e,f).enumerable})),a.push.apply(a,u)}return a}function Xx(e){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?IL(Object(a),!0).forEach(function(u){pr(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):IL(Object(a)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function Pee(e){var n=Mee();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Mee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var kee="https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens",Ree="A valid API access token is required to use Mapbox data";function Dee(){}var Oee=401,CL={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},Lee=Object.assign({},ky.propTypes,{width:Or.oneOfType([Or.number,Or.string]),height:Or.oneOfType([Or.number,Or.string]),onResize:Or.func,preventStyleDiffing:Or.bool,disableTokenWarning:Or.bool,visible:Or.bool,className:Or.string,style:Or.object,visibilityConstraints:Or.object}),zee=Object.assign({},ky.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:Dee,className:"",style:null,visibilityConstraints:hy}),w0=function(e){Rc(a,e);var n=Pee(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"state",{accessTokenInvalid:!1}),pr(On(u),"_mapbox",null),pr(On(u),"_map",null),pr(On(u),"_mapboxMapRef",fe.createRef()),pr(On(u),"_mapContainerRef",fe.createRef()),pr(On(u),"_queryParams",{}),pr(On(u),"_width",0),pr(On(u),"_height",0),pr(On(u),"getMap",function(){return u._map}),pr(On(u),"queryRenderedFeatures",function(s){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u._map.queryRenderedFeatures(s,L)}),pr(On(u),"_mapboxMapError",function(s){var L=s.error&&s.error.status||s.status;L===Oee&&!u.state.accessTokenInvalid&&(console.error(Ree),u.setState({accessTokenInvalid:!0})),u.props.onError(s)}),u}return $s(a,[{key:"componentDidMount",value:function(){if(a.supported()){var f=this.props.mapStyle;this._mapbox=new ky(Object.assign({},this.props,{mapboxgl:Im,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:sL(f)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(f){this._mapbox&&(this._updateMapStyle(f,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(f,w){(this._width!==f||this._height!==w)&&(this._width=f,this._height=w,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(f,w){var p=w.mapStyle,s=f.mapStyle;p!==s&&p&&this._map.setStyle(sL(p),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(f){this._mapbox&&this._mapbox.setProps(Object.assign({},f,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){var f={position:"absolute",left:0,top:0};return fe.createElement("div",{key:"warning",id:"no-token-warning",style:f},fe.createElement("h3",{key:"header"},"NO_TOKEN_WARNING"),fe.createElement("div",{key:"text"},"For information on setting up your basemap, read"),fe.createElement("a",{key:"link",href:kee},"Note on Map Tokens"))}return null}},{key:"_renderOverlays",value:function(f){var w=this,p=f.width,s=f.height;return this._updateMapSize(p,s),fe.createElement(b0.Consumer,null,function(L){var F=Xx(Xx({},L),{},{viewport:new Zd(Xx(Xx(Xx({},w.props),w.props.viewState),{},{width:p,height:s})),map:w._map,mapContainer:L.mapContainer||w._mapContainerRef.current});return fe.createElement(b0.Provider,{value:F},fe.createElement("div",{key:"map-overlays",className:"overlays",style:CL},w.props.children))})}},{key:"render",value:function(){var f=this.props,w=f.className,p=f.width,s=f.height,L=f.style,F=f.visibilityConstraints,G=Object.assign({position:"relative"},L,{width:p,height:s}),H=this.props.visible&&Aee(this.props.viewState||this.props,F),X=Object.assign({},CL,{visibility:H?"inherit":"hidden"});return fe.createElement("div",{key:"map-container",style:G,ref:this._mapContainerRef},fe.createElement("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:X,className:w}),fe.createElement(nee,{key:"autosizer",onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning())}}],[{key:"supported",value:function(){return Im&&Im.supported()}}]),a}(fe.PureComponent);pr(w0,"propTypes",Lee);pr(w0,"defaultProps",zee);var Yx=function(){};function Nee(e,n){var a=e(n);return function(u){return 1/(1-a)*(e(u*(1-n)+n)-a)}}var b1={BREAK:1,SNAP_TO_END:2,IGNORE:3,UPDATE:4},jee={transitionDuration:0,transitionEasing:function(n){return n},transitionInterpolator:new TM,transitionInterruption:b1.BREAK,onTransitionStart:Yx,onTransitionInterrupt:Yx,onTransitionEnd:Yx,onViewportChange:Yx,onStateChange:Yx},LT=function(){function e(n,a){var u=this;al(this,e),pr(this,"props",void 0),pr(this,"state",void 0),pr(this,"time",void 0),pr(this,"_animationFrame",null),pr(this,"_onTransitionFrame",function(){u._animationFrame=requestAnimationFrame(u._onTransitionFrame),u._updateViewport()}),n&&(this.props=n),this.time=a||Date.now}return $s(e,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(a){var u=this.props;if(this.props=a,this._shouldIgnoreViewportChange(u,a))return!1;if(this._isTransitionEnabled(a)){var f=Object.assign({},u),w=Object.assign({},a);if(this._isTransitionInProgress()&&(u.onTransitionInterrupt(),this.state.interruption===b1.SNAP_TO_END?Object.assign(f,this.state.endProps):Object.assign(f,this.state.propsInTransition),this.state.interruption===b1.UPDATE)){var p=this.time(),s=(p-this.state.startTime)/this.state.duration;w.transitionDuration=this.state.duration-(p-this.state.startTime),w.transitionEasing=Nee(this.state.easing,s),w.transitionInterpolator=f.transitionInterpolator}return w.onTransitionStart(),this._triggerTransition(f,w),!0}return this._isTransitionInProgress()&&(u.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return!!this._animationFrame}},{key:"_isTransitionEnabled",value:function(a){var u=a.transitionDuration,f=a.transitionInterpolator;return(u>0||u==="auto")&&!!f}},{key:"_isUpdateDueToCurrentTransition",value:function(a){return this.state.propsInTransition?this.state.interpolator.arePropsEqual(a,this.state.propsInTransition):!1}},{key:"_shouldIgnoreViewportChange",value:function(a,u){return a?this._isTransitionInProgress()?this.state.interruption===b1.IGNORE||this._isUpdateDueToCurrentTransition(u):this._isTransitionEnabled(u)?u.transitionInterpolator.arePropsEqual(a,u):!0:!0}},{key:"_triggerTransition",value:function(a,u){Cu(this._isTransitionEnabled(u)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var f=u.transitionInterpolator,w=f.getDuration?f.getDuration(a,u):u.transitionDuration;if(w!==0){var p=u.transitionInterpolator.initializeProps(a,u),s={inTransition:!0,isZooming:a.zoom!==u.zoom,isPanning:a.longitude!==u.longitude||a.latitude!==u.latitude,isRotating:a.bearing!==u.bearing||a.pitch!==u.pitch};this.state={duration:w,easing:u.transitionEasing,interpolator:u.transitionInterpolator,interruption:u.transitionInterruption,startTime:this.time(),startProps:p.start,endProps:p.end,animation:null,propsInTransition:{},interactionState:s},this._onTransitionFrame(),this.props.onStateChange(s)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var a=this.time(),u=this.state,f=u.startTime,w=u.duration,p=u.easing,s=u.interpolator,L=u.startProps,F=u.endProps,G=!1,H=(a-f)/w;H>=1&&(H=1,G=!0),H=p(H);var X=s.interpolateProps(L,F,H),ne=new eb(Object.assign({},this.props,X));this.state.propsInTransition=ne.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),G&&(this._endTransition(),this.props.onTransitionEnd())}}]),e}();pr(LT,"defaultProps",jee);var SB={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(e){(function(n,a,u,f){var w=["","webkit","Moz","MS","ms","o"],p=a.createElement("div"),s="function",L=Math.round,F=Math.abs,G=Date.now;function H(He,Oe,ft){return setTimeout(de(He,ft),Oe)}function X(He,Oe,ft){return Array.isArray(He)?(ne(He,ft[Oe],ft),!0):!1}function ne(He,Oe,ft){var Vt;if(He)if(He.forEach)He.forEach(Oe,ft);else if(He.length!==f)for(Vt=0;Vt<He.length;)Oe.call(ft,He[Vt],Vt,He),Vt++;else for(Vt in He)He.hasOwnProperty(Vt)&&Oe.call(ft,He[Vt],Vt,He)}function ie(He,Oe,ft){var Vt="DEPRECATED METHOD: "+Oe+`
`+ft+` AT 
`;return function(){var Xr=new Error("get-stack-trace"),Gn=Xr&&Xr.stack?Xr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",kn=n.console&&(n.console.warn||n.console.log);return kn&&kn.call(n.console,Vt,Gn),He.apply(this,arguments)}}var se;typeof Object.assign!="function"?se=function(Oe){if(Oe===f||Oe===null)throw new TypeError("Cannot convert undefined or null to object");for(var ft=Object(Oe),Vt=1;Vt<arguments.length;Vt++){var Xr=arguments[Vt];if(Xr!==f&&Xr!==null)for(var Gn in Xr)Xr.hasOwnProperty(Gn)&&(ft[Gn]=Xr[Gn])}return ft}:se=Object.assign;var Te=ie(function(Oe,ft,Vt){for(var Xr=Object.keys(ft),Gn=0;Gn<Xr.length;)(!Vt||Vt&&Oe[Xr[Gn]]===f)&&(Oe[Xr[Gn]]=ft[Xr[Gn]]),Gn++;return Oe},"extend","Use `assign`."),ue=ie(function(Oe,ft){return Te(Oe,ft,!0)},"merge","Use `assign`.");function ce(He,Oe,ft){var Vt=Oe.prototype,Xr;Xr=He.prototype=Object.create(Vt),Xr.constructor=He,Xr._super=Vt,ft&&se(Xr,ft)}function de(He,Oe){return function(){return He.apply(Oe,arguments)}}function Ee(He,Oe){return typeof He==s?He.apply(Oe&&Oe[0]||f,Oe):He}function Ne(He,Oe){return He===f?Oe:He}function rt(He,Oe,ft){ne(yt(Oe),function(Vt){He.addEventListener(Vt,ft,!1)})}function tt(He,Oe,ft){ne(yt(Oe),function(Vt){He.removeEventListener(Vt,ft,!1)})}function Ge(He,Oe){for(;He;){if(He==Oe)return!0;He=He.parentNode}return!1}function _t(He,Oe){return He.indexOf(Oe)>-1}function yt(He){return He.trim().split(/\s+/g)}function Et(He,Oe,ft){if(He.indexOf&&!ft)return He.indexOf(Oe);for(var Vt=0;Vt<He.length;){if(ft&&He[Vt][ft]==Oe||!ft&&He[Vt]===Oe)return Vt;Vt++}return-1}function Wt(He){return Array.prototype.slice.call(He,0)}function Ar(He,Oe,ft){for(var Vt=[],Xr=[],Gn=0;Gn<He.length;){var kn=Oe?He[Gn][Oe]:He[Gn];Et(Xr,kn)<0&&Vt.push(He[Gn]),Xr[Gn]=kn,Gn++}return ft&&(Oe?Vt=Vt.sort(function(Ca,Ua){return Ca[Oe]>Ua[Oe]}):Vt=Vt.sort()),Vt}function mt(He,Oe){for(var ft,Vt,Xr=Oe[0].toUpperCase()+Oe.slice(1),Gn=0;Gn<w.length;){if(ft=w[Gn],Vt=ft?ft+Xr:Oe,Vt in He)return Vt;Gn++}return f}var nr=1;function Xt(){return nr++}function Ht(He){var Oe=He.ownerDocument||He;return Oe.defaultView||Oe.parentWindow||n}var Qt=/mobile|tablet|ip(ad|hone|od)|android/i,sr="ontouchstart"in n,Tr=mt(n,"PointerEvent")!==f,ln=sr&&Qt.test(navigator.userAgent),vn="touch",wi="pen",hi="mouse",Vn="kinect",Oi=25,fn=1,Nn=2,Pt=4,Dt=8,Ir=1,xr=2,Kt=4,Cn=8,gn=16,fr=xr|Kt,Zr=Cn|gn,qr=fr|Zr,sn=["x","y"],qn=["clientX","clientY"];function Li(He,Oe){var ft=this;this.manager=He,this.callback=Oe,this.element=He.element,this.target=He.options.inputTarget,this.domHandler=function(Vt){Ee(He.options.enable,[He])&&ft.handler(Vt)},this.init()}Li.prototype={handler:function(){},init:function(){this.evEl&&rt(this.element,this.evEl,this.domHandler),this.evTarget&&rt(this.target,this.evTarget,this.domHandler),this.evWin&&rt(Ht(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&tt(this.element,this.evEl,this.domHandler),this.evTarget&&tt(this.target,this.evTarget,this.domHandler),this.evWin&&tt(Ht(this.element),this.evWin,this.domHandler)}};function _i(He){var Oe,ft=He.options.inputClass;return ft?Oe=ft:Tr?Oe=Xi:ln?Oe=wt:sr?Oe=ot:Oe=Mr,new Oe(He,zi)}function zi(He,Oe,ft){var Vt=ft.pointers.length,Xr=ft.changedPointers.length,Gn=Oe&fn&&Vt-Xr===0,kn=Oe&(Pt|Dt)&&Vt-Xr===0;ft.isFirst=!!Gn,ft.isFinal=!!kn,Gn&&(He.session={}),ft.eventType=Oe,Pi(He,ft),He.emit("hammer.input",ft),He.recognize(ft),He.session.prevInput=ft}function Pi(He,Oe){var ft=He.session,Vt=Oe.pointers,Xr=Vt.length;ft.firstInput||(ft.firstInput=qe(Oe)),Xr>1&&!ft.firstMultiple?ft.firstMultiple=qe(Oe):Xr===1&&(ft.firstMultiple=!1);var Gn=ft.firstInput,kn=ft.firstMultiple,_a=kn?kn.center:Gn.center,Ca=Oe.center=at(Vt);Oe.timeStamp=G(),Oe.deltaTime=Oe.timeStamp-Gn.timeStamp,Oe.angle=en(_a,Ca),Oe.distance=br(_a,Ca),rr(ft,Oe),Oe.offsetDirection=cr(Oe.deltaX,Oe.deltaY);var Ua=$t(Oe.deltaTime,Oe.deltaX,Oe.deltaY);Oe.overallVelocityX=Ua.x,Oe.overallVelocityY=Ua.y,Oe.overallVelocity=F(Ua.x)>F(Ua.y)?Ua.x:Ua.y,Oe.scale=kn?Kr(kn.pointers,Vt):1,Oe.rotation=kn?ur(kn.pointers,Vt):0,Oe.maxPointers=ft.prevInput?Oe.pointers.length>ft.prevInput.maxPointers?Oe.pointers.length:ft.prevInput.maxPointers:Oe.pointers.length,Me(ft,Oe);var ya=He.element;Ge(Oe.srcEvent.target,ya)&&(ya=Oe.srcEvent.target),Oe.target=ya}function rr(He,Oe){var ft=Oe.center,Vt=He.offsetDelta||{},Xr=He.prevDelta||{},Gn=He.prevInput||{};(Oe.eventType===fn||Gn.eventType===Pt)&&(Xr=He.prevDelta={x:Gn.deltaX||0,y:Gn.deltaY||0},Vt=He.offsetDelta={x:ft.x,y:ft.y}),Oe.deltaX=Xr.x+(ft.x-Vt.x),Oe.deltaY=Xr.y+(ft.y-Vt.y)}function Me(He,Oe){var ft=He.lastInterval||Oe,Vt=Oe.timeStamp-ft.timeStamp,Xr,Gn,kn,_a;if(Oe.eventType!=Dt&&(Vt>Oi||ft.velocity===f)){var Ca=Oe.deltaX-ft.deltaX,Ua=Oe.deltaY-ft.deltaY,ya=$t(Vt,Ca,Ua);Gn=ya.x,kn=ya.y,Xr=F(ya.x)>F(ya.y)?ya.x:ya.y,_a=cr(Ca,Ua),He.lastInterval=Oe}else Xr=ft.velocity,Gn=ft.velocityX,kn=ft.velocityY,_a=ft.direction;Oe.velocity=Xr,Oe.velocityX=Gn,Oe.velocityY=kn,Oe.direction=_a}function qe(He){for(var Oe=[],ft=0;ft<He.pointers.length;)Oe[ft]={clientX:L(He.pointers[ft].clientX),clientY:L(He.pointers[ft].clientY)},ft++;return{timeStamp:G(),pointers:Oe,center:at(Oe),deltaX:He.deltaX,deltaY:He.deltaY}}function at(He){var Oe=He.length;if(Oe===1)return{x:L(He[0].clientX),y:L(He[0].clientY)};for(var ft=0,Vt=0,Xr=0;Xr<Oe;)ft+=He[Xr].clientX,Vt+=He[Xr].clientY,Xr++;return{x:L(ft/Oe),y:L(Vt/Oe)}}function $t(He,Oe,ft){return{x:Oe/He||0,y:ft/He||0}}function cr(He,Oe){return He===Oe?Ir:F(He)>=F(Oe)?He<0?xr:Kt:Oe<0?Cn:gn}function br(He,Oe,ft){ft||(ft=sn);var Vt=Oe[ft[0]]-He[ft[0]],Xr=Oe[ft[1]]-He[ft[1]];return Math.sqrt(Vt*Vt+Xr*Xr)}function en(He,Oe,ft){ft||(ft=sn);var Vt=Oe[ft[0]]-He[ft[0]],Xr=Oe[ft[1]]-He[ft[1]];return Math.atan2(Xr,Vt)*180/Math.PI}function ur(He,Oe){return en(Oe[1],Oe[0],qn)+en(He[1],He[0],qn)}function Kr(He,Oe){return br(Oe[0],Oe[1],qn)/br(He[0],He[1],qn)}var Vr={mousedown:fn,mousemove:Nn,mouseup:Pt},cn="mousedown",Xn="mousemove mouseup";function Mr(){this.evEl=cn,this.evWin=Xn,this.pressed=!1,Li.apply(this,arguments)}ce(Mr,Li,{handler:function(Oe){var ft=Vr[Oe.type];ft&fn&&Oe.button===0&&(this.pressed=!0),ft&Nn&&Oe.which!==1&&(ft=Pt),this.pressed&&(ft&Pt&&(this.pressed=!1),this.callback(this.manager,ft,{pointers:[Oe],changedPointers:[Oe],pointerType:hi,srcEvent:Oe}))}});var Fr={pointerdown:fn,pointermove:Nn,pointerup:Pt,pointercancel:Dt,pointerout:Dt},ri={2:vn,3:wi,4:hi,5:Vn},mi="pointerdown",gi="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(mi="MSPointerDown",gi="MSPointerMove MSPointerUp MSPointerCancel");function Xi(){this.evEl=mi,this.evWin=gi,Li.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ce(Xi,Li,{handler:function(Oe){var ft=this.store,Vt=!1,Xr=Oe.type.toLowerCase().replace("ms",""),Gn=Fr[Xr],kn=ri[Oe.pointerType]||Oe.pointerType,_a=kn==vn,Ca=Et(ft,Oe.pointerId,"pointerId");Gn&fn&&(Oe.button===0||_a)?Ca<0&&(ft.push(Oe),Ca=ft.length-1):Gn&(Pt|Dt)&&(Vt=!0),!(Ca<0)&&(ft[Ca]=Oe,this.callback(this.manager,Gn,{pointers:ft,changedPointers:[Oe],pointerType:kn,srcEvent:Oe}),Vt&&ft.splice(Ca,1))}});var mo={touchstart:fn,touchmove:Nn,touchend:Pt,touchcancel:Dt},eo="touchstart",Se="touchstart touchmove touchend touchcancel";function Re(){this.evTarget=eo,this.evWin=Se,this.started=!1,Li.apply(this,arguments)}ce(Re,Li,{handler:function(Oe){var ft=mo[Oe.type];if(ft===fn&&(this.started=!0),!!this.started){var Vt=Fe.call(this,Oe,ft);ft&(Pt|Dt)&&Vt[0].length-Vt[1].length===0&&(this.started=!1),this.callback(this.manager,ft,{pointers:Vt[0],changedPointers:Vt[1],pointerType:vn,srcEvent:Oe})}}});function Fe(He,Oe){var ft=Wt(He.touches),Vt=Wt(He.changedTouches);return Oe&(Pt|Dt)&&(ft=Ar(ft.concat(Vt),"identifier",!0)),[ft,Vt]}var et={touchstart:fn,touchmove:Nn,touchend:Pt,touchcancel:Dt},it="touchstart touchmove touchend touchcancel";function wt(){this.evTarget=it,this.targetIds={},Li.apply(this,arguments)}ce(wt,Li,{handler:function(Oe){var ft=et[Oe.type],Vt=$e.call(this,Oe,ft);Vt&&this.callback(this.manager,ft,{pointers:Vt[0],changedPointers:Vt[1],pointerType:vn,srcEvent:Oe})}});function $e(He,Oe){var ft=Wt(He.touches),Vt=this.targetIds;if(Oe&(fn|Nn)&&ft.length===1)return Vt[ft[0].identifier]=!0,[ft,ft];var Xr,Gn,kn=Wt(He.changedTouches),_a=[],Ca=this.target;if(Gn=ft.filter(function(Ua){return Ge(Ua.target,Ca)}),Oe===fn)for(Xr=0;Xr<Gn.length;)Vt[Gn[Xr].identifier]=!0,Xr++;for(Xr=0;Xr<kn.length;)Vt[kn[Xr].identifier]&&_a.push(kn[Xr]),Oe&(Pt|Dt)&&delete Vt[kn[Xr].identifier],Xr++;if(_a.length)return[Ar(Gn.concat(_a),"identifier",!0),_a]}var ve=2500,Le=25;function ot(){Li.apply(this,arguments);var He=de(this.handler,this);this.touch=new wt(this.manager,He),this.mouse=new Mr(this.manager,He),this.primaryTouch=null,this.lastTouches=[]}ce(ot,Li,{handler:function(Oe,ft,Vt){var Xr=Vt.pointerType==vn,Gn=Vt.pointerType==hi;if(!(Gn&&Vt.sourceCapabilities&&Vt.sourceCapabilities.firesTouchEvents)){if(Xr)Mt.call(this,ft,Vt);else if(Gn&&bt.call(this,Vt))return;this.callback(Oe,ft,Vt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Mt(He,Oe){He&fn?(this.primaryTouch=Oe.changedPointers[0].identifier,Ot.call(this,Oe)):He&(Pt|Dt)&&Ot.call(this,Oe)}function Ot(He){var Oe=He.changedPointers[0];if(Oe.identifier===this.primaryTouch){var ft={x:Oe.clientX,y:Oe.clientY};this.lastTouches.push(ft);var Vt=this.lastTouches,Xr=function(){var Gn=Vt.indexOf(ft);Gn>-1&&Vt.splice(Gn,1)};setTimeout(Xr,ve)}}function bt(He){for(var Oe=He.srcEvent.clientX,ft=He.srcEvent.clientY,Vt=0;Vt<this.lastTouches.length;Vt++){var Xr=this.lastTouches[Vt],Gn=Math.abs(Oe-Xr.x),kn=Math.abs(ft-Xr.y);if(Gn<=Le&&kn<=Le)return!0}return!1}var Rt=mt(p.style,"touchAction"),ar=Rt!==f,qt="compute",Nt="auto",Rr="manipulation",er="none",Nr="pan-x",Ln="pan-y",$r=xn();function si(He,Oe){this.manager=He,this.set(Oe)}si.prototype={set:function(He){He==qt&&(He=this.compute()),ar&&this.manager.element.style&&$r[He]&&(this.manager.element.style[Rt]=He),this.actions=He.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var He=[];return ne(this.manager.recognizers,function(Oe){Ee(Oe.options.enable,[Oe])&&(He=He.concat(Oe.getTouchAction()))}),Yi(He.join(" "))},preventDefaults:function(He){var Oe=He.srcEvent,ft=He.offsetDirection;if(this.manager.session.prevented){Oe.preventDefault();return}var Vt=this.actions,Xr=_t(Vt,er)&&!$r[er],Gn=_t(Vt,Ln)&&!$r[Ln],kn=_t(Vt,Nr)&&!$r[Nr];if(Xr){var _a=He.pointers.length===1,Ca=He.distance<2,Ua=He.deltaTime<250;if(_a&&Ca&&Ua)return}if(!(kn&&Gn)&&(Xr||Gn&&ft&fr||kn&&ft&Zr))return this.preventSrc(Oe)},preventSrc:function(He){this.manager.session.prevented=!0,He.preventDefault()}};function Yi(He){if(_t(He,er))return er;var Oe=_t(He,Nr),ft=_t(He,Ln);return Oe&&ft?er:Oe||ft?Oe?Nr:Ln:_t(He,Rr)?Rr:Nt}function xn(){if(!ar)return!1;var He={},Oe=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ft){He[ft]=Oe?n.CSS.supports("touch-action",ft):!0}),He}var $i=1,di=2,vo=4,to=8,xo=to,so=16,Ni=32;function qi(He){this.options=se({},this.defaults,He||{}),this.id=Xt(),this.manager=null,this.options.enable=Ne(this.options.enable,!0),this.state=$i,this.simultaneous={},this.requireFail=[]}qi.prototype={defaults:{},set:function(He){return se(this.options,He),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(He){if(X(He,"recognizeWith",this))return this;var Oe=this.simultaneous;return He=ga(He,this),Oe[He.id]||(Oe[He.id]=He,He.recognizeWith(this)),this},dropRecognizeWith:function(He){return X(He,"dropRecognizeWith",this)?this:(He=ga(He,this),delete this.simultaneous[He.id],this)},requireFailure:function(He){if(X(He,"requireFailure",this))return this;var Oe=this.requireFail;return He=ga(He,this),Et(Oe,He)===-1&&(Oe.push(He),He.requireFailure(this)),this},dropRequireFailure:function(He){if(X(He,"dropRequireFailure",this))return this;He=ga(He,this);var Oe=Et(this.requireFail,He);return Oe>-1&&this.requireFail.splice(Oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(He){return!!this.simultaneous[He.id]},emit:function(He){var Oe=this,ft=this.state;function Vt(Xr){Oe.manager.emit(Xr,He)}ft<to&&Vt(Oe.options.event+rs(ft)),Vt(Oe.options.event),He.additionalEvent&&Vt(He.additionalEvent),ft>=to&&Vt(Oe.options.event+rs(ft))},tryEmit:function(He){if(this.canEmit())return this.emit(He);this.state=Ni},canEmit:function(){for(var He=0;He<this.requireFail.length;){if(!(this.requireFail[He].state&(Ni|$i)))return!1;He++}return!0},recognize:function(He){var Oe=se({},He);if(!Ee(this.options.enable,[this,Oe])){this.reset(),this.state=Ni;return}this.state&(xo|so|Ni)&&(this.state=$i),this.state=this.process(Oe),this.state&(di|vo|to|so)&&this.tryEmit(Oe)},process:function(He){},getTouchAction:function(){},reset:function(){}};function rs(He){return He&so?"cancel":He&to?"end":He&vo?"move":He&di?"start":""}function kl(He){return He==gn?"down":He==Cn?"up":He==xr?"left":He==Kt?"right":""}function ga(He,Oe){var ft=Oe.manager;return ft?ft.get(He):He}function Ho(){qi.apply(this,arguments)}ce(Ho,qi,{defaults:{pointers:1},attrTest:function(He){var Oe=this.options.pointers;return Oe===0||He.pointers.length===Oe},process:function(He){var Oe=this.state,ft=He.eventType,Vt=Oe&(di|vo),Xr=this.attrTest(He);return Vt&&(ft&Dt||!Xr)?Oe|so:Vt||Xr?ft&Pt?Oe|to:Oe&di?Oe|vo:di:Ni}});function Oc(){Ho.apply(this,arguments),this.pX=null,this.pY=null}ce(Oc,Ho,{defaults:{event:"pan",threshold:10,pointers:1,direction:qr},getTouchAction:function(){var He=this.options.direction,Oe=[];return He&fr&&Oe.push(Ln),He&Zr&&Oe.push(Nr),Oe},directionTest:function(He){var Oe=this.options,ft=!0,Vt=He.distance,Xr=He.direction,Gn=He.deltaX,kn=He.deltaY;return Xr&Oe.direction||(Oe.direction&fr?(Xr=Gn===0?Ir:Gn<0?xr:Kt,ft=Gn!=this.pX,Vt=Math.abs(He.deltaX)):(Xr=kn===0?Ir:kn<0?Cn:gn,ft=kn!=this.pY,Vt=Math.abs(He.deltaY))),He.direction=Xr,ft&&Vt>Oe.threshold&&Xr&Oe.direction},attrTest:function(He){return Ho.prototype.attrTest.call(this,He)&&(this.state&di||!(this.state&di)&&this.directionTest(He))},emit:function(He){this.pX=He.deltaX,this.pY=He.deltaY;var Oe=kl(He.direction);Oe&&(He.additionalEvent=this.options.event+Oe),this._super.emit.call(this,He)}});function Wl(){Ho.apply(this,arguments)}ce(Wl,Ho,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[er]},attrTest:function(He){return this._super.attrTest.call(this,He)&&(Math.abs(He.scale-1)>this.options.threshold||this.state&di)},emit:function(He){if(He.scale!==1){var Oe=He.scale<1?"in":"out";He.additionalEvent=this.options.event+Oe}this._super.emit.call(this,He)}});function Qo(){qi.apply(this,arguments),this._timer=null,this._input=null}ce(Qo,qi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Nt]},process:function(He){var Oe=this.options,ft=He.pointers.length===Oe.pointers,Vt=He.distance<Oe.threshold,Xr=He.deltaTime>Oe.time;if(this._input=He,!Vt||!ft||He.eventType&(Pt|Dt)&&!Xr)this.reset();else if(He.eventType&fn)this.reset(),this._timer=H(function(){this.state=xo,this.tryEmit()},Oe.time,this);else if(He.eventType&Pt)return xo;return Ni},reset:function(){clearTimeout(this._timer)},emit:function(He){this.state===xo&&(He&&He.eventType&Pt?this.manager.emit(this.options.event+"up",He):(this._input.timeStamp=G(),this.manager.emit(this.options.event,this._input)))}});function Va(){Ho.apply(this,arguments)}ce(Va,Ho,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[er]},attrTest:function(He){return this._super.attrTest.call(this,He)&&(Math.abs(He.rotation)>this.options.threshold||this.state&di)}});function po(){Ho.apply(this,arguments)}ce(po,Ho,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:fr|Zr,pointers:1},getTouchAction:function(){return Oc.prototype.getTouchAction.call(this)},attrTest:function(He){var Oe=this.options.direction,ft;return Oe&(fr|Zr)?ft=He.overallVelocity:Oe&fr?ft=He.overallVelocityX:Oe&Zr&&(ft=He.overallVelocityY),this._super.attrTest.call(this,He)&&Oe&He.offsetDirection&&He.distance>this.options.threshold&&He.maxPointers==this.options.pointers&&F(ft)>this.options.velocity&&He.eventType&Pt},emit:function(He){var Oe=kl(He.offsetDirection);Oe&&this.manager.emit(this.options.event+Oe,He),this.manager.emit(this.options.event,He)}});function Hn(){qi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ce(Hn,qi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Rr]},process:function(He){var Oe=this.options,ft=He.pointers.length===Oe.pointers,Vt=He.distance<Oe.threshold,Xr=He.deltaTime<Oe.time;if(this.reset(),He.eventType&fn&&this.count===0)return this.failTimeout();if(Vt&&Xr&&ft){if(He.eventType!=Pt)return this.failTimeout();var Gn=this.pTime?He.timeStamp-this.pTime<Oe.interval:!0,kn=!this.pCenter||br(this.pCenter,He.center)<Oe.posThreshold;this.pTime=He.timeStamp,this.pCenter=He.center,!kn||!Gn?this.count=1:this.count+=1,this._input=He;var _a=this.count%Oe.taps;if(_a===0)return this.hasRequireFailures()?(this._timer=H(function(){this.state=xo,this.tryEmit()},Oe.interval,this),di):xo}return Ni},failTimeout:function(){return this._timer=H(function(){this.state=Ni},this.options.interval,this),Ni},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==xo&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ra(He,Oe){return Oe=Oe||{},Oe.recognizers=Ne(Oe.recognizers,Ra.defaults.preset),new Os(He,Oe)}Ra.VERSION="2.0.7",Ra.defaults={domEvents:!1,touchAction:qt,enable:!0,inputTarget:null,inputClass:null,preset:[[Va,{enable:!1}],[Wl,{enable:!1},["rotate"]],[po,{direction:fr}],[Oc,{direction:fr},["swipe"]],[Hn],[Hn,{event:"doubletap",taps:2},["tap"]],[Qo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Uo=1,Gs=2;function Os(He,Oe){this.options=se({},Ra.defaults,Oe||{}),this.options.inputTarget=this.options.inputTarget||He,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=He,this.input=_i(this),this.touchAction=new si(this,this.options.touchAction),_l(this,!0),ne(this.options.recognizers,function(ft){var Vt=this.add(new ft[0](ft[1]));ft[2]&&Vt.recognizeWith(ft[2]),ft[3]&&Vt.requireFailure(ft[3])},this)}Os.prototype={set:function(He){return se(this.options,He),He.touchAction&&this.touchAction.update(),He.inputTarget&&(this.input.destroy(),this.input.target=He.inputTarget,this.input.init()),this},stop:function(He){this.session.stopped=He?Gs:Uo},recognize:function(He){var Oe=this.session;if(!Oe.stopped){this.touchAction.preventDefaults(He);var ft,Vt=this.recognizers,Xr=Oe.curRecognizer;(!Xr||Xr&&Xr.state&xo)&&(Xr=Oe.curRecognizer=null);for(var Gn=0;Gn<Vt.length;)ft=Vt[Gn],Oe.stopped!==Gs&&(!Xr||ft==Xr||ft.canRecognizeWith(Xr))?ft.recognize(He):ft.reset(),!Xr&&ft.state&(di|vo|to)&&(Xr=Oe.curRecognizer=ft),Gn++}},get:function(He){if(He instanceof qi)return He;for(var Oe=this.recognizers,ft=0;ft<Oe.length;ft++)if(Oe[ft].options.event==He)return Oe[ft];return null},add:function(He){if(X(He,"add",this))return this;var Oe=this.get(He.options.event);return Oe&&this.remove(Oe),this.recognizers.push(He),He.manager=this,this.touchAction.update(),He},remove:function(He){if(X(He,"remove",this))return this;if(He=this.get(He),He){var Oe=this.recognizers,ft=Et(Oe,He);ft!==-1&&(Oe.splice(ft,1),this.touchAction.update())}return this},on:function(He,Oe){if(He!==f&&Oe!==f){var ft=this.handlers;return ne(yt(He),function(Vt){ft[Vt]=ft[Vt]||[],ft[Vt].push(Oe)}),this}},off:function(He,Oe){if(He!==f){var ft=this.handlers;return ne(yt(He),function(Vt){Oe?ft[Vt]&&ft[Vt].splice(Et(ft[Vt],Oe),1):delete ft[Vt]}),this}},emit:function(He,Oe){this.options.domEvents&&qs(He,Oe);var ft=this.handlers[He]&&this.handlers[He].slice();if(!(!ft||!ft.length)){Oe.type=He,Oe.preventDefault=function(){Oe.srcEvent.preventDefault()};for(var Vt=0;Vt<ft.length;)ft[Vt](Oe),Vt++}},destroy:function(){this.element&&_l(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function _l(He,Oe){var ft=He.element;if(ft.style){var Vt;ne(He.options.cssProps,function(Xr,Gn){Vt=mt(ft.style,Gn),Oe?(He.oldCssProps[Vt]=ft.style[Vt],ft.style[Vt]=Xr):ft.style[Vt]=He.oldCssProps[Vt]||""}),Oe||(He.oldCssProps={})}}function qs(He,Oe){var ft=a.createEvent("Event");ft.initEvent(He,!0,!0),ft.gesture=Oe,Oe.target.dispatchEvent(ft)}se(Ra,{INPUT_START:fn,INPUT_MOVE:Nn,INPUT_END:Pt,INPUT_CANCEL:Dt,STATE_POSSIBLE:$i,STATE_BEGAN:di,STATE_CHANGED:vo,STATE_ENDED:to,STATE_RECOGNIZED:xo,STATE_CANCELLED:so,STATE_FAILED:Ni,DIRECTION_NONE:Ir,DIRECTION_LEFT:xr,DIRECTION_RIGHT:Kt,DIRECTION_UP:Cn,DIRECTION_DOWN:gn,DIRECTION_HORIZONTAL:fr,DIRECTION_VERTICAL:Zr,DIRECTION_ALL:qr,Manager:Os,Input:Li,TouchAction:si,TouchInput:wt,MouseInput:Mr,PointerEventInput:Xi,TouchMouseInput:ot,SingleTouchInput:Re,Recognizer:qi,AttrRecognizer:Ho,Tap:Hn,Pan:Oc,Swipe:po,Pinch:Wl,Rotate:Va,Press:Qo,on:rt,off:tt,each:ne,merge:ue,extend:Te,assign:se,inherit:ce,bindFn:de,prefixed:mt});var zf=typeof n<"u"?n:typeof self<"u"?self:{};zf.Hammer=Ra,typeof f=="function"&&f.amd?f(function(){return Ra}):e.exports?e.exports=Ra:n[u]=Ra})(window,document,"Hammer")})(SB);var xb=SB.exports;const Bee=S0(xb),yf=az({__proto__:null,default:Bee},[xb]),TB=1,EB=2,lA=4,Fee={mousedown:TB,mousemove:EB,mouseup:lA};function Vee(e,n){for(let a=0;a<e.length;a++)if(n(e[a]))return!0;return!1}function Uee(e){const n=e.prototype.handler;e.prototype.handler=function(u){const f=this.store;u.button>0&&u.type==="pointerdown"&&(Vee(f,w=>w.pointerId===u.pointerId)||f.push(u)),n.call(this,u)}}function $ee(e){e.prototype.handler=function(a){let u=Fee[a.type];u&TB&&a.button>=0&&(this.pressed=!0),u&EB&&a.buttons===0&&(u=lA),this.pressed&&(u&lA&&(this.pressed=!1),this.callback(this.manager,u,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}}Uee(xb.PointerEventInput);$ee(xb.MouseInput);const Gee=xb.Manager;class zT{constructor(n,a,u){this.element=n,this.callback=a,this.options={enable:!0,...u}}}const qee=yf?[[yf.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[yf.Rotate,{enable:!1}],[yf.Pinch,{enable:!1}],[yf.Swipe,{enable:!1}],[yf.Pan,{threshold:0,enable:!1}],[yf.Press,{enable:!1}],[yf.Tap,{event:"doubletap",taps:2,enable:!1}],[yf.Tap,{event:"anytap",enable:!1}],[yf.Tap,{enable:!1}]]:null,AL={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Wee={doubletap:["tap"]},Hee={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},EM={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Zee={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},PL={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Xee=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Uv=typeof window<"u"?window:global;let cA=!1;try{const e={get passive(){return cA=!0,!0}};Uv.addEventListener("test",null,e),Uv.removeEventListener("test",null)}catch{cA=!1}const Yee=Xee.indexOf("firefox")!==-1,{WHEEL_EVENTS:Kee}=EM,ML="wheel",kL=4.000244140625,Jee=40,Qee=.25;class ete extends zT{constructor(n,a,u){super(n,a,u),this.handleEvent=f=>{if(!this.options.enable)return;let w=f.deltaY;Uv.WheelEvent&&(Yee&&f.deltaMode===Uv.WheelEvent.DOM_DELTA_PIXEL&&(w/=Uv.devicePixelRatio),f.deltaMode===Uv.WheelEvent.DOM_DELTA_LINE&&(w*=Jee)),w!==0&&w%kL===0&&(w=Math.floor(w/kL)),f.shiftKey&&w&&(w=w*Qee),this.callback({type:ML,center:{x:f.clientX,y:f.clientY},delta:-w,srcEvent:f,pointerType:"mouse",target:f.target})},this.events=(this.options.events||[]).concat(Kee),this.events.forEach(f=>n.addEventListener(f,this.handleEvent,cA?{passive:!1}:!1))}destroy(){this.events.forEach(n=>this.element.removeEventListener(n,this.handleEvent))}enableEventType(n,a){n===ML&&(this.options.enable=a)}}const{MOUSE_EVENTS:tte}=EM,RL="pointermove",DL="pointerover",OL="pointerout",LL="pointerenter",zL="pointerleave";class rte extends zT{constructor(n,a,u){super(n,a,u),this.handleEvent=w=>{this.handleOverEvent(w),this.handleOutEvent(w),this.handleEnterEvent(w),this.handleLeaveEvent(w),this.handleMoveEvent(w)},this.pressed=!1;const{enable:f}=this.options;this.enableMoveEvent=f,this.enableLeaveEvent=f,this.enableEnterEvent=f,this.enableOutEvent=f,this.enableOverEvent=f,this.events=(this.options.events||[]).concat(tte),this.events.forEach(w=>n.addEventListener(w,this.handleEvent))}destroy(){this.events.forEach(n=>this.element.removeEventListener(n,this.handleEvent))}enableEventType(n,a){n===RL&&(this.enableMoveEvent=a),n===DL&&(this.enableOverEvent=a),n===OL&&(this.enableOutEvent=a),n===LL&&(this.enableEnterEvent=a),n===zL&&(this.enableLeaveEvent=a)}handleOverEvent(n){this.enableOverEvent&&n.type==="mouseover"&&this._emit(DL,n)}handleOutEvent(n){this.enableOutEvent&&n.type==="mouseout"&&this._emit(OL,n)}handleEnterEvent(n){this.enableEnterEvent&&n.type==="mouseenter"&&this._emit(LL,n)}handleLeaveEvent(n){this.enableLeaveEvent&&n.type==="mouseleave"&&this._emit(zL,n)}handleMoveEvent(n){if(this.enableMoveEvent)switch(n.type){case"mousedown":n.button>=0&&(this.pressed=!0);break;case"mousemove":n.buttons===0&&(this.pressed=!1),this.pressed||this._emit(RL,n);break;case"mouseup":this.pressed=!1;break}}_emit(n,a){this.callback({type:n,center:{x:a.clientX,y:a.clientY},srcEvent:a,pointerType:"mouse",target:a.target})}}const{KEY_EVENTS:nte}=EM,NL="keydown",jL="keyup";class ite extends zT{constructor(n,a,u){super(n,a,u),this.handleEvent=f=>{const w=f.target||f.srcElement;w.tagName==="INPUT"&&w.type==="text"||w.tagName==="TEXTAREA"||(this.enableDownEvent&&f.type==="keydown"&&this.callback({type:NL,srcEvent:f,key:f.key,target:f.target}),this.enableUpEvent&&f.type==="keyup"&&this.callback({type:jL,srcEvent:f,key:f.key,target:f.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(nte),n.tabIndex=this.options.tabIndex||0,n.style.outline="none",this.events.forEach(f=>n.addEventListener(f,this.handleEvent))}destroy(){this.events.forEach(n=>this.element.removeEventListener(n,this.handleEvent))}enableEventType(n,a){n===NL&&(this.enableDownEvent=a),n===jL&&(this.enableUpEvent=a)}}const BL="contextmenu";class ote extends zT{constructor(n,a,u){super(n,a,u),this.handleEvent=f=>{this.options.enable&&this.callback({type:BL,center:{x:f.clientX,y:f.clientY},srcEvent:f,pointerType:"mouse",target:f.target})},n.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(n,a){n===BL&&(this.options.enable=a)}}const FL=1,uA=2,VL=4,ate={pointerdown:FL,pointermove:uA,pointerup:VL,mousedown:FL,mousemove:uA,mouseup:VL},ste=0,lte=1,cte=2,ute=1,hte=2,dte=4;function pte(e){const n=ate[e.srcEvent.type];if(!n)return null;const{buttons:a,button:u}=e.srcEvent;let f=!1,w=!1,p=!1;return n===uA?(f=!!(a&ute),w=!!(a&dte),p=!!(a&hte)):(f=u===ste,w=u===lte,p=u===cte),{leftButton:f,middleButton:w,rightButton:p}}function fte(e,n){const a=e.center;if(!a)return null;const u=n.getBoundingClientRect(),f=u.width/n.offsetWidth||1,w=u.height/n.offsetHeight||1,p={x:(a.x-u.left-n.clientLeft)/f,y:(a.y-u.top-n.clientTop)/w};return{center:a,offsetCenter:p}}const PI={srcElement:"root",priority:0};class mte{constructor(n){this.handleEvent=a=>{if(this.isEmpty())return;const u=this._normalizeEvent(a);let f=a.srcEvent.target;for(;f&&f!==u.rootElement;){if(this._emit(u,f),u.handled)return;f=f.parentNode}this._emit(u,"root")},this.eventManager=n,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(n,a,u,f=!1,w=!1){const{handlers:p,handlersByElement:s}=this;let L=PI;typeof u=="string"||u&&u.addEventListener?L={...PI,srcElement:u}:u&&(L={...PI,...u});let F=s.get(L.srcElement);F||(F=[],s.set(L.srcElement,F));const G={type:n,handler:a,srcElement:L.srcElement,priority:L.priority};f&&(G.once=!0),w&&(G.passive=!0),p.push(G),this._active=this._active||!G.passive;let H=F.length-1;for(;H>=0&&!(F[H].priority>=G.priority);)H--;F.splice(H+1,0,G)}remove(n,a){const{handlers:u,handlersByElement:f}=this;for(let w=u.length-1;w>=0;w--){const p=u[w];if(p.type===n&&p.handler===a){u.splice(w,1);const s=f.get(p.srcElement);s.splice(s.indexOf(p),1),s.length===0&&f.delete(p.srcElement)}}this._active=u.some(w=>!w.passive)}_emit(n,a){const u=this.handlersByElement.get(a);if(u){let f=!1;const w=()=>{n.handled=!0},p=()=>{n.handled=!0,f=!0},s=[];for(let L=0;L<u.length;L++){const{type:F,handler:G,once:H}=u[L];if(G({...n,type:F,stopPropagation:w,stopImmediatePropagation:p}),H&&s.push(u[L]),f)break}for(let L=0;L<s.length;L++){const{type:F,handler:G}=s[L];this.remove(F,G)}}}_normalizeEvent(n){const a=this.eventManager.getElement();return{...n,...pte(n),...fte(n,a),preventDefault:()=>{n.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:a}}}const gte={events:null,recognizers:null,recognizerOptions:{},Manager:Gee,touchAction:"none",tabIndex:0};class _te{constructor(n=null,a){this._onBasicInput=f=>{const{srcEvent:w}=f,p=Hee[w.type];p&&this.manager.emit(p,f)},this._onOtherEvent=f=>{this.manager.emit(f.type,f)},this.options={...gte,...a},this.events=new Map,this.setElement(n);const{events:u}=this.options;u&&this.on(u)}getElement(){return this.element}setElement(n){if(this.element&&this.destroy(),this.element=n,!n)return;const{options:a}=this,u=a.Manager;this.manager=new u(n,{touchAction:a.touchAction,recognizers:a.recognizers||qee}).on("hammer.input",this._onBasicInput),a.recognizers||Object.keys(AL).forEach(f=>{const w=this.manager.get(f);w&&AL[f].forEach(p=>{w.recognizeWith(p)})});for(const f in a.recognizerOptions){const w=this.manager.get(f);if(w){const p=a.recognizerOptions[f];delete p.enable,w.set(p)}}this.wheelInput=new ete(n,this._onOtherEvent,{enable:!1}),this.moveInput=new rte(n,this._onOtherEvent,{enable:!1}),this.keyInput=new ite(n,this._onOtherEvent,{enable:!1,tabIndex:a.tabIndex}),this.contextmenuInput=new ote(n,this._onOtherEvent,{enable:!1});for(const[f,w]of this.events)w.isEmpty()||(this._toggleRecognizer(w.recognizerName,!0),this.manager.on(f,w.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(n,a,u){this._addEventHandler(n,a,u,!1)}once(n,a,u){this._addEventHandler(n,a,u,!0)}watch(n,a,u){this._addEventHandler(n,a,u,!1,!0)}off(n,a){this._removeEventHandler(n,a)}_toggleRecognizer(n,a){const{manager:u}=this;if(!u)return;const f=u.get(n);if(f&&f.options.enable!==a){f.set({enable:a});const w=Wee[n];w&&!this.options.recognizers&&w.forEach(p=>{const s=u.get(p);a?(s.requireFailure(n),f.dropRequireFailure(p)):s.dropRequireFailure(n)})}this.wheelInput.enableEventType(n,a),this.moveInput.enableEventType(n,a),this.keyInput.enableEventType(n,a),this.contextmenuInput.enableEventType(n,a)}_addEventHandler(n,a,u,f,w){if(typeof n!="string"){u=a;for(const G in n)this._addEventHandler(G,n[G],u,f,w);return}const{manager:p,events:s}=this,L=PL[n]||n;let F=s.get(L);F||(F=new mte(this),s.set(L,F),F.recognizerName=Zee[L]||L,p&&p.on(L,F.handleEvent)),F.add(n,a,u,f,w),F.isEmpty()||this._toggleRecognizer(F.recognizerName,!0)}_removeEventHandler(n,a){if(typeof n!="string"){for(const p in n)this._removeEventHandler(p,n[p]);return}const{events:u}=this,f=PL[n]||n,w=u.get(f);if(w&&(w.remove(n,a),w.isEmpty())){const{recognizerName:p}=w;let s=!1;for(const L of u.values())if(L.recognizerName===p&&!L.isEmpty()){s=!0;break}s||this._toggleRecognizer(p,!1)}}}function yte(e,n){var a,u,f,w=function(){return f=null,e.apply(a,u)};return function(){a=this,u=arguments,f&&clearTimeout(f),f=setTimeout(w,n)}}var Av={transitionDuration:0},hA={transitionDuration:300,transitionEasing:function(n){return n},transitionInterpolator:new TM,transitionInterruption:b1.BREAK},UL=5,vte=1.2,xte=.01,Kx={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend","pinchcancel"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},IB=function(){function e(){var n=this;al(this,e),pr(this,"events",[]),pr(this,"mapState",void 0),pr(this,"onViewportChange",void 0),pr(this,"onStateChange",void 0),pr(this,"mapStateProps",void 0),pr(this,"eventManager",void 0),pr(this,"scrollZoom",!0),pr(this,"dragPan",!0),pr(this,"dragRotate",!0),pr(this,"doubleClickZoom",!0),pr(this,"touchZoom",!0),pr(this,"touchRotate",!1),pr(this,"keyboard",!0),pr(this,"_state",{isDragging:!1}),pr(this,"_events",{}),pr(this,"_transitionManager",new LT),pr(this,"setState",function(a){Object.assign(n._state,a),n.onStateChange&&n.onStateChange(n._state)}),this.handleEvent=this.handleEvent.bind(this),this._onWheelEnd=yte(this._onWheelEnd,100)}return $s(e,[{key:"handleEvent",value:function(a){switch(this.mapState=this.getMapState(),a.type){case"panstart":return this._onPanStart(a);case"panmove":return this._onPan(a);case"panend":return this._onPanEnd(a);case"pinchstart":return this._onPinchStart(a);case"pinchmove":return this._onPinch(a);case"pinchcancel":case"pinchend":return this._onPinchEnd(a);case"doubletap":return this._onDoubleTap(a);case"wheel":return this._onWheel(a);case"keydown":return this._onKeyDown(a);default:return!1}}},{key:"getCenter",value:function(a){var u=a.offsetCenter,f=u.x,w=u.y;return[f,w]}},{key:"isFunctionKeyPressed",value:function(a){var u=a.srcEvent;return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}},{key:"updateViewport",value:function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},w=this.mapState?this.mapState.getViewportProps():{},p=Object.assign({},a.getViewportProps(),u),s=Object.keys(p).some(function(L){return w[L]!==p[L]});s&&this.onViewportChange(p,f,w),this.setState(Object.assign({},a.getInteractiveState(),f))}},{key:"getMapState",value:function(a){return new eb(Object.assign({},this.mapStateProps,this._state,a))}},{key:"setOptions",value:function(a){var u=a.onViewportChange,f=a.onStateChange,w=a.eventManager,p=w===void 0?this.eventManager:w,s=a.isInteractive,L=s===void 0?!0:s,F=a.scrollZoom,G=F===void 0?this.scrollZoom:F,H=a.dragPan,X=H===void 0?this.dragPan:H,ne=a.dragRotate,ie=ne===void 0?this.dragRotate:ne,se=a.doubleClickZoom,Te=se===void 0?this.doubleClickZoom:se,ue=a.touchZoom,ce=ue===void 0?this.touchZoom:ue,de=a.touchRotate,Ee=de===void 0?this.touchRotate:de,Ne=a.keyboard,rt=Ne===void 0?this.keyboard:Ne;this.onViewportChange=u,this.onStateChange=f;var tt=!this.mapStateProps||this.mapStateProps.height!==a.height;this.mapStateProps=a,tt&&this.updateViewport(new eb(a)),this._transitionManager.processViewportChange(Object.assign({},a,{onStateChange:this.setState})),this.eventManager!==p&&(this.eventManager=p,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Kx.WHEEL,L&&G),this.toggleEvents(Kx.PAN,L&&(X||ie)),this.toggleEvents(Kx.PINCH,L&&(ce||Ee)),this.toggleEvents(Kx.DOUBLE_TAP,L&&Te),this.toggleEvents(Kx.KEYBOARD,L&&rt),this.scrollZoom=G,this.dragPan=X,this.dragRotate=ie,this.doubleClickZoom=Te,this.touchZoom=ce,this.touchRotate=Ee,this.keyboard=rt}},{key:"toggleEvents",value:function(a,u){var f=this;this.eventManager&&a.forEach(function(w){f._events[w]!==u&&(f._events[w]=u,u?f.eventManager.on(w,f.handleEvent):f.eventManager.off(w,f.handleEvent))})}},{key:"_onPanStart",value:function(a){var u=this.getCenter(a),f=this.mapState.panStart({pos:u}).rotateStart({pos:u});return this.updateViewport(f,Av,{isDragging:!0}),!0}},{key:"_onPan",value:function(a){return this.isFunctionKeyPressed(a)||a.rightButton?this._onPanRotate(a):this._onPanMove(a)}},{key:"_onPanEnd",value:function(a){var u=this.mapState.panEnd().rotateEnd();return this.updateViewport(u,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(a){if(!this.dragPan)return!1;var u=this.getCenter(a),f=this.mapState.pan({pos:u});return this.updateViewport(f,Av,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(a){if(!this.dragRotate)return!1;var u=a.deltaX,f=a.deltaY,w=this.getCenter(a),p=p_(w,2),s=p[1],L=s-f,F=this.mapState.getViewportProps(),G=F.width,H=F.height,X=u/G,ne=0;f>0?Math.abs(H-L)>UL&&(ne=f/(L-H)*vte):f<0&&L>UL&&(ne=1-s/L),ne=Math.min(1,Math.max(-1,ne));var ie=this.mapState.rotate({deltaScaleX:X,deltaScaleY:ne});return this.updateViewport(ie,Av,{isRotating:!0}),!0}},{key:"_onWheel",value:function(a){if(!this.scrollZoom)return!1;a.preventDefault();var u=this.getCenter(a),f=a.delta,w=2/(1+Math.exp(-Math.abs(f*xte)));f<0&&w!==0&&(w=1/w);var p=this.mapState.zoom({pos:u,scale:w});return this.updateViewport(p,Av,{isZooming:!0}),this._onWheelEnd(),!0}},{key:"_onWheelEnd",value:function(){this.setState({isZooming:!1})}},{key:"_onPinchStart",value:function(a){var u=this.getCenter(a),f=this.mapState.zoomStart({pos:u}).rotateStart({pos:u});return this._state.startPinchRotation=a.rotation,this.updateViewport(f,Av,{isDragging:!0}),!0}},{key:"_onPinch",value:function(a){if(!this.touchZoom&&!this.touchRotate)return!1;var u=this.mapState;if(this.touchZoom){var f=a.scale,w=this.getCenter(a);u=u.zoom({pos:w,scale:f})}if(this.touchRotate){var p=a.rotation,s=this._state.startPinchRotation;u=u.rotate({deltaScaleX:-(p-s)/180})}return this.updateViewport(u,Av,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(a){var u=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(u,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(a){if(!this.doubleClickZoom)return!1;var u=this.getCenter(a),f=this.isFunctionKeyPressed(a),w=this.mapState.zoom({pos:u,scale:f?.5:2});return this.updateViewport(w,Object.assign({},hA,{transitionInterpolator:new TM({around:u})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(a){if(!this.keyboard)return!1;var u=this.isFunctionKeyPressed(a),f=this.mapStateProps,w;switch(a.srcEvent.keyCode){case 189:u?w=this.getMapState({zoom:f.zoom-2}):w=this.getMapState({zoom:f.zoom-1});break;case 187:u?w=this.getMapState({zoom:f.zoom+2}):w=this.getMapState({zoom:f.zoom+1});break;case 37:u?w=this.getMapState({bearing:f.bearing-15}):w=this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:u?w=this.getMapState({bearing:f.bearing+15}):w=this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:u?w=this.getMapState({pitch:f.pitch+10}):w=this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:u?w=this.getMapState({pitch:f.pitch-10}):w=this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(w,hA)}}]),e}(),bte=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function wte(e){return"react-map-gl: `".concat(e,"` is removed.")}function Ste(e){return"Use `".concat(e,"` instead.")}function CB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bte.forEach(function(n){if(e.hasOwnProperty(n.old)){var a=wte(n.old);n.new&&(a="".concat(a," ").concat(Ste(n.new))),console.warn(a)}})}function Tte(e){var n=Ete();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Ete(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Ite=Object.assign({},w0.propTypes,{maxZoom:Or.number,minZoom:Or.number,maxPitch:Or.number,minPitch:Or.number,onViewStateChange:Or.func,onViewportChange:Or.func,onInteractionStateChange:Or.func,transitionDuration:Or.oneOfType([Or.number,Or.string]),transitionInterpolator:Or.object,transitionInterruption:Or.number,transitionEasing:Or.func,onTransitionStart:Or.func,onTransitionInterrupt:Or.func,onTransitionEnd:Or.func,scrollZoom:Or.bool,dragPan:Or.bool,dragRotate:Or.bool,doubleClickZoom:Or.bool,touchZoom:Or.bool,touchRotate:Or.bool,keyboard:Or.bool,onHover:Or.func,onClick:Or.func,onDblClick:Or.func,onContextMenu:Or.func,onMouseDown:Or.func,onMouseMove:Or.func,onMouseUp:Or.func,onTouchStart:Or.func,onTouchMove:Or.func,onTouchEnd:Or.func,onMouseEnter:Or.func,onMouseLeave:Or.func,onMouseOut:Or.func,onWheel:Or.func,touchAction:Or.string,clickRadius:Or.number,interactiveLayerIds:Or.array,getCursor:Or.func,controller:Or.instanceOf(IB)}),Cte=function(n){var a=n.isDragging,u=n.isHovering;return a?"grabbing":u?"pointer":"grab"},Ate=Object.assign({},w0.defaultProps,hy,LT.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(n){return n.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:Cte}),IM=function(e){Rc(a,e);var n=Tte(a);$s(a,null,[{key:"supported",value:function(){return w0.supported()}}]);function a(u){var f;return al(this,a),f=n.call(this,u),pr(On(f),"state",{isLoaded:!1,isDragging:!1,isHovering:!1}),pr(On(f),"_controller",void 0),pr(On(f),"_eventManager",void 0),pr(On(f),"_interactiveContext",void 0),pr(On(f),"_width",0),pr(On(f),"_height",0),pr(On(f),"_eventCanvasRef",fe.createRef()),pr(On(f),"_staticMapRef",fe.createRef()),pr(On(f),"getMap",function(){return f._staticMapRef.current?f._staticMapRef.current.getMap():null}),pr(On(f),"queryRenderedFeatures",function(w){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=f.getMap();return s&&s.queryRenderedFeatures(w,p)}),pr(On(f),"_onInteractionStateChange",function(w){var p=w.isDragging,s=p===void 0?!1:p;s!==f.state.isDragging&&(f._updateInteractiveContext({isDragging:s}),f.setState({isDragging:s}));var L=f.props.onInteractionStateChange;L&&L(w)}),pr(On(f),"_onResize",function(w){var p=w.width,s=w.height;f._width=p,f._height=s,f._setControllerProps(f.props),f.props.onResize({width:p,height:s})}),pr(On(f),"_onViewportChange",function(w,p,s){var L=f.props,F=L.onViewStateChange,G=L.onViewportChange;F&&F({viewState:w,interactionState:p,oldViewState:s}),G&&G(w,p,s)}),pr(On(f),"_onLoad",function(w){f.setState({isLoaded:!0}),f.props.onLoad(w)}),pr(On(f),"_onEvent",function(w,p){var s=f.props[w];s&&s(f._normalizeEvent(p))}),pr(On(f),"_onPointerDown",function(w){switch(w.pointerType){case"touch":f._onEvent("onTouchStart",w);break;default:f._onEvent("onMouseDown",w)}}),pr(On(f),"_onPointerUp",function(w){switch(w.pointerType){case"touch":f._onEvent("onTouchEnd",w);break;default:f._onEvent("onMouseUp",w)}}),pr(On(f),"_onPointerMove",function(w){switch(w.pointerType){case"touch":f._onEvent("onTouchMove",w);break;default:f._onEvent("onMouseMove",w)}if(!f.state.isDragging){var p=f.props,s=p.onHover,L=p.interactiveLayerIds,F;w=f._normalizeEvent(w),f.state.isLoaded&&(L||s)&&(F=f._getFeatures({pos:w.point,radius:f.props.clickRadius})),s&&(w.features=F,s(w));var G=!!(L&&F&&F.length>0),H=G&&!f.state.isHovering,X=!G&&f.state.isHovering;H&&f._onEvent("onMouseEnter",w),X&&f._onEvent("onMouseLeave",w),(H||X)&&f.setState({isHovering:G})}}),pr(On(f),"_onClick",function(w){var p=f.props,s=p.onClick,L=p.onNativeClick,F=p.onDblClick,G=p.doubleClickZoom,H=[],X=F||G;switch(w.type){case"anyclick":H.push(L),X||H.push(s);break;case"click":X&&H.push(s);break}H=H.filter(Boolean),H.length&&(w=f._normalizeEvent(w),w.features=f._getFeatures({pos:w.point,radius:f.props.clickRadius}),H.forEach(function(ne){return ne(w)}))}),CB(u),f._controller=u.controller||new IB,f._eventManager=new _te(null,{touchAction:u.touchAction}),f._updateInteractiveContext({isDragging:!1,eventManager:f._eventManager}),f}return $s(a,[{key:"componentDidMount",value:function(){var f=this._eventManager,w=this._eventCanvasRef.current;f.setElement(w),f.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,anyclick:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props),this._updateInteractiveContext({mapContainer:w})}},{key:"componentDidUpdate",value:function(){this._setControllerProps(this.props)}},{key:"componentWillUnmount",value:function(){this._eventManager.destroy()}},{key:"_setControllerProps",value:function(f){f=Object.assign({},f,f.viewState,{isInteractive:!!(f.onViewStateChange||f.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(f);var w=this._interactiveContext;w.onViewportChange=f.onViewportChange,w.onViewStateChange=f.onViewStateChange}},{key:"_getFeatures",value:function(f){var w=f.pos,p=f.radius,s,L={},F=this.getMap();if(this.props.interactiveLayerIds&&(L.layers=this.props.interactiveLayerIds),p){var G=p,H=[[w[0]-G,w[1]+G],[w[0]+G,w[1]-G]];s=F&&F.queryRenderedFeatures(H,L)}else s=F&&F.queryRenderedFeatures(w,L);return s}},{key:"_updateInteractiveContext",value:function(f){this._interactiveContext=Object.assign({},this._interactiveContext,f)}},{key:"_normalizeEvent",value:function(f){if(f.lngLat)return f;var w=f.offsetCenter,p=w.x,s=w.y,L=[p,s],F=new Zd(Object.assign({},this.props,{width:this._width,height:this._height}));return f.point=L,f.lngLat=F.unproject(L),f}},{key:"render",value:function(){var f=this.props,w=f.width,p=f.height,s=f.style,L=f.getCursor,F=Object.assign({position:"relative"},s,{width:w,height:p,cursor:L(this.state)});return fe.createElement(b0.Provider,{value:this._interactiveContext},fe.createElement("div",{key:"event-canvas",ref:this._eventCanvasRef,style:F},fe.createElement(w0,pn({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,onLoad:this._onLoad,ref:this._staticMapRef}),this.props.children)))}}]),a}(fe.PureComponent);pr(IM,"propTypes",Ite);pr(IM,"defaultProps",Ate);function dy(e,n){if(e===n)return!0;if(!e||!n)return!1;if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(var a=0;a<e.length;a++)if(!dy(e[a],n[a]))return!1;return!0}else if(Array.isArray(n))return!1;if(c_(e)==="object"&&c_(n)==="object"){var u=Object.keys(e),f=Object.keys(n);if(u.length!==f.length)return!1;for(var w=0,p=u;w<p.length;w++){var s=p[w];if(!n.hasOwnProperty(s)||!dy(e[s],n[s]))return!1}return!0}return!1}function Pte(e){var n=Mte();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Mte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var kte={type:Or.string.isRequired,id:Or.string},Rte=0,Dte=function(e){Rc(a,e);var n=Pte(a);function a(u){var f;return al(this,a),f=n.call(this,u),pr(On(f),"id",void 0),pr(On(f),"type",void 0),pr(On(f),"_map",null),pr(On(f),"_sourceOptions",{}),pr(On(f),"_updateSource",function(){var w=On(f),p=w.type,s=w._map;if(s){var L=On(f),F=L._sourceOptions,G=L.props;Cu(!G.id||G.id===f.id,"source id changed"),Cu(G.type===p,"source type changed");var H="",X=0;for(var ne in G)ne!=="children"&&ne!=="id"&&!dy(F[ne],G[ne])&&(F[ne]=G[ne],H=ne,X++);var ie=f.getSource();if(!ie){f._createSource(F);return}if(X)if(p==="geojson")ie.setData(F.data);else if(p==="image")ie.updateImage({url:F.url,coordinates:F.coordinates});else if((p==="canvas"||p==="video")&&X===1&&H==="coordinates")ie.setCoordinates(F.coordinates);else if(p==="vector"&&ie.setUrl)switch(H){case"url":ie.setUrl(F.url);break;case"tiles":ie.setTiles(F.tiles);break}else console.warn("Unable to update <Source> prop: ".concat(H))}}),f.id=u.id||"jsx-source-".concat(Rte++),f.type=u.type,f}return $s(a,[{key:"componentWillUnmount",value:function(){var f=this,w=this._map;w&&(w.off("styledata",this._updateSource),requestAnimationFrame(function(){w.style&&w.style._loaded&&w.removeSource(f.id)}))}},{key:"getSource",value:function(){var f=this._map;return f&&f.style&&f.getSource(this.id)}},{key:"_createSource",value:function(f){var w=this._map;w.style&&w.style._loaded&&w.addSource(this.id,f)}},{key:"_render",value:function(f){var w=this;return!this._map&&f.map&&(this._map=f.map,this._map.on("styledata",this._updateSource)),this._updateSource(),fe.Children.map(this.props.children,function(p){return p&&fe.cloneElement(p,{source:w.id})})}},{key:"render",value:function(){return fe.createElement(b0.Consumer,null,this._render.bind(this))}}]),a}(fe.PureComponent);pr(Dte,"propTypes",kte);function Ote(e,n){if(e==null)return{};var a=cc(e,n),u,f;if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(e);for(f=0;f<w.length;f++)u=w[f],!(n.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(e,u)&&(a[u]=e[u])}return a}function Lte(e){var n=zte();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function zte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Nte={fill:"fill",line:"line",symbol:"symbol",circle:"circle","fill-extrusion":"fill-extrusion",raster:"raster",background:"background",heatmap:"heatmap",hillshade:"hillshade"},jte={type:Or.oneOf(Object.keys(Nte)).isRequired,id:Or.string,source:Or.string,beforeId:Or.string};function Bte(e,n,a,u){var f=a.layout,w=f===void 0?{}:f,p=a.paint,s=p===void 0?{}:p,L=a.filter,F=a.minzoom,G=a.maxzoom,H=a.beforeId,X=Ote(a,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(H!==u.beforeId&&e.moveLayer(n,H),w!==u.layout){var ne=u.layout||{};for(var ie in w)dy(w[ie],ne[ie])||e.setLayoutProperty(n,ie,w[ie]);for(var se in ne)w.hasOwnProperty(se)||e.setLayoutProperty(n,se,void 0)}if(s!==u.paint){var Te=u.paint||{};for(var ue in s)dy(s[ue],Te[ue])||e.setPaintProperty(n,ue,s[ue]);for(var ce in Te)s.hasOwnProperty(ce)||e.setPaintProperty(n,ce,void 0)}dy(L,u.filter)||e.setFilter(n,L),(F!==u.minzoom||G!==u.maxzoom)&&e.setLayerZoomRange(n,F,G);for(var de in X)dy(X[de],u[de])||e.setLayerProperty(n,de,X[de])}var Fte=0,Vte=function(e){Rc(a,e);var n=Lte(a);function a(u){var f;return al(this,a),f=n.call(this,u),pr(On(f),"id",void 0),pr(On(f),"type",void 0),pr(On(f),"_map",null),pr(On(f),"_layerOptions",{}),pr(On(f),"_updateLayer",function(){var w=f._map;if(w){var p=On(f),s=p.props,L=p._layerOptions;if(Cu(!s.id||s.id===f.id,"layer id changed"),Cu(s.type===f.type,"layer type changed"),!f.getLayer()){f._createLayer();return}try{Bte(w,f.id,s,L),Object.assign(L,s)}catch(F){console.warn(F)}}}),f.id=u.id||"jsx-layer-".concat(Fte++),f.type=u.type,f}return $s(a,[{key:"componentDidMount",value:function(){this._updateLayer()}},{key:"componentDidUpdate",value:function(){this._updateLayer()}},{key:"componentWillUnmount",value:function(){var f=this._map;f&&(f.off("styledata",this._updateLayer),f.style&&f.style._loaded&&f.removeLayer(this.id))}},{key:"getLayer",value:function(){var f=this._map;return f&&f.style&&f.getLayer(this.id)}},{key:"_createLayer",value:function(){var f=this._map;if(f.style&&f.style._loaded){var w=Object.assign({},this.props);w.id=this.id,delete w.beforeId,f.addLayer(w,this.props.beforeId),this._layerOptions=w}}},{key:"_render",value:function(f){return!this._map&&f.map&&(this._map=f.map,this._map.on("styledata",this._updateLayer)),null}},{key:"render",value:function(){return fe.createElement(b0.Consumer,null,this._render.bind(this))}}]),a}(fe.PureComponent);pr(Vte,"propTypes",jte);function Ute(e){var n=$te();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function $te(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Gte={captureScroll:Or.bool,captureDrag:Or.bool,captureClick:Or.bool,captureDoubleClick:Or.bool,capturePointerMove:Or.bool},qte={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},fs=function(e){Rc(a,e);var n=Ute(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"_context",{}),pr(On(u),"_events",null),pr(On(u),"_containerRef",fe.createRef()),pr(On(u),"_onScroll",function(s){u.props.captureScroll&&s.stopPropagation()}),pr(On(u),"_onDragStart",function(s){u.props.captureDrag&&s.stopPropagation()}),pr(On(u),"_onDblClick",function(s){u.props.captureDoubleClick&&s.stopPropagation()}),pr(On(u),"_onClick",function(s){u.props.captureClick&&s.stopPropagation()}),pr(On(u),"_onPointerMove",function(s){u.props.capturePointerMove&&s.stopPropagation()}),u}return $s(a,[{key:"componentDidMount",value:function(){var f=this._containerRef.current;if(f){var w=this._context.eventManager;w&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,anyclick:this._onClick,click:this._onClick,dblclick:this._onDblClick,pointermove:this._onPointerMove},w.watch(this._events,f))}}},{key:"componentWillUnmount",value:function(){var f=this._context.eventManager;f&&this._events&&f.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var f=this;return fe.createElement(b0.Consumer,null,function(w){return f._context=w,f._render()})}}]),a}(fe.PureComponent);pr(fs,"propTypes",Gte);pr(fs,"defaultProps",qte);function Wte(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&(e=zo(e),e!==null););return e}function t0(){return typeof Reflect<"u"&&Reflect.get?t0=Reflect.get.bind():t0=function(n,a,u){var f=Wte(n,a);if(f){var w=Object.getOwnPropertyDescriptor(f,a);return w.get?w.get.call(arguments.length<3?n:u):w.value}},t0.apply(this,arguments)}function Hte(e){var n=Zte();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Zte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Xte=Object.assign({},fs.propTypes,{draggable:Or.bool,onDrag:Or.func,onDragEnd:Or.func,onDragStart:Or.func,offsetLeft:Or.number,offsetTop:Or.number}),Yte=Object.assign({},fs.defaultProps,{draggable:!1,offsetLeft:0,offsetTop:0}),bb=function(e){Rc(a,e);var n=Hte(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"state",{dragPos:null,dragOffset:null}),pr(On(u),"_dragEvents",null),pr(On(u),"_onDragStart",function(s){var L=u.props,F=L.draggable,G=L.captureDrag;if((F||G)&&s.stopPropagation(),!!F){var H=u._getDragEventPosition(s),X=u._getDragEventOffset(s);u.setState({dragPos:H,dragOffset:X}),u._setupDragEvents();var ne=u.props.onDragStart;if(ne&&X){var ie=Object.assign({},s);ie.lngLat=u._getDragLngLat(H,X),ne(ie)}}}),pr(On(u),"_onDrag",function(s){s.stopPropagation();var L=u._getDragEventPosition(s);u.setState({dragPos:L});var F=u.props.onDrag,G=u.state.dragOffset;if(F&&G){var H=Object.assign({},s);H.lngLat=u._getDragLngLat(L,G),F(H)}}),pr(On(u),"_onDragEnd",function(s){var L=u.state,F=L.dragPos,G=L.dragOffset;s.stopPropagation(),u.setState({dragPos:null,dragOffset:null}),u._removeDragEvents();var H=u.props.onDragEnd;if(H&&F&&G){var X=Object.assign({},s);X.lngLat=u._getDragLngLat(F,G),H(X)}}),pr(On(u),"_onDragCancel",function(s){s.stopPropagation(),u.setState({dragPos:null,dragOffset:null}),u._removeDragEvents()}),u}return $s(a,[{key:"componentWillUnmount",value:function(){t0(zo(a.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var f=this._context.eventManager;f&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},f.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var f=this._context.eventManager;!f||!this._dragEvents||(f.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(f){var w=f.offsetCenter,p=w.x,s=w.y;return[p,s]}},{key:"_getDragEventOffset",value:function(f){var w=f.center,p=w.x,s=w.y,L=this._containerRef.current;if(L){var F=L.getBoundingClientRect();return[F.left-p,F.top-s]}return null}},{key:"_getDraggedPosition",value:function(f,w){return[f[0]+w[0],f[1]+w[1]]}},{key:"_getDragLngLat",value:function(f,w){var p=this.props,s=p.offsetLeft,L=p.offsetTop,F=this._getDraggedPosition(f,w),G=p_(F,2),H=G[0],X=G[1];return this._context.viewport.unproject([H-s,X-L])}}]),a}(fs);pr(bb,"propTypes",Xte);pr(bb,"defaultProps",Yte);var $L=typeof window<"u"&&window.devicePixelRatio||1,tb=function(n){return Math.round(n*$L)/$L},GL=function(n,a){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"x";if(n===null)return a;var f=u==="x"?n.offsetWidth:n.offsetHeight;return tb(a/100*f)/f*100};function Kte(e){var n=Jte();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Jte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Qte=Object.assign({},bb.propTypes,{className:Or.string,longitude:Or.number.isRequired,latitude:Or.number.isRequired}),ere=Object.assign({},bb.defaultProps,{className:""}),NT=function(e){Rc(a,e);var n=Kte(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"_control",null),u}return $s(a,[{key:"_getPosition",value:function(){var f=this.props,w=f.longitude,p=f.latitude,s=f.offsetLeft,L=f.offsetTop,F=this.state,G=F.dragPos,H=F.dragOffset;if(G&&H)return this._getDraggedPosition(G,H);var X=this._context.viewport.project([w,p]),ne=p_(X,2),ie=ne[0],se=ne[1];return ie+=s,se+=L,[ie,se]}},{key:"_render",value:function(){var f=this._getPosition(),w=p_(f,2),p=w[0],s=w[1],L="translate(".concat(tb(p),"px, ").concat(tb(s),"px)"),F=this._containerRef.current;if(this._control&&F)F.style.transform=L;else{var G=this.props,H=G.className,X=G.draggable,ne=this.state.dragPos,ie={position:"absolute",left:0,top:0,transform:L,cursor:X?ne?"grabbing":"grab":"auto"};this._control=fe.createElement("div",{className:"mapboxgl-marker ".concat(H),ref:this._containerRef,style:ie},this.props.children)}return this._control}},{key:"render",value:function(){return this._control=null,t0(zo(a.prototype),"render",this).call(this)}}]),a}(bb);pr(NT,"propTypes",Qte);pr(NT,"defaultProps",ere);var rb={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},tre=Object.keys(rb);function rre(e){var n=e.x,a=e.y,u=e.width,f=e.height,w=e.selfWidth,p=e.selfHeight,s=e.anchor,L=e.padding,F=L===void 0?0:L,G=rb[s],H=G.x,X=G.y,ne=a-X*p,ie=ne+p,se=Math.max(0,F-ne)+Math.max(0,ie-f+F);if(se>0){var Te=X,ue=se;for(X=0;X<=1;X+=.5)ne=a-X*p,ie=ne+p,se=Math.max(0,F-ne)+Math.max(0,ie-f+F),se<ue&&(ue=se,Te=X);X=Te}var ce=.5;X===.5&&(H=Math.floor(H),ce=1);var de=n-H*w,Ee=de+w,Ne=Math.max(0,F-de)+Math.max(0,Ee-u+F);if(Ne>0){var rt=H,tt=Ne;for(H=0;H<=1;H+=ce)de=n-H*w,Ee=de+w,Ne=Math.max(0,F-de)+Math.max(0,Ee-u+F),Ne<tt&&(tt=Ne,rt=H);H=rt}return tre.find(function(Ge){var _t=rb[Ge];return _t.x===H&&_t.y===X})||s}function nre(e){var n=ire();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function ire(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var ore=Object.assign({},fs.propTypes,{className:Or.string,longitude:Or.number.isRequired,latitude:Or.number.isRequired,altitude:Or.number,offsetLeft:Or.number,offsetTop:Or.number,tipSize:Or.number,closeButton:Or.bool,closeOnClick:Or.bool,anchor:Or.oneOf(Object.keys(rb)),dynamicPosition:Or.bool,sortByDepth:Or.bool,onClose:Or.func}),are=Object.assign({},fs.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),AB=function(e){Rc(a,e);var n=nre(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"_closeOnClick",!1),pr(On(u),"_contentRef",fe.createRef()),pr(On(u),"_onClick",function(s){if(u.props.captureClick&&s.stopPropagation(),u.props.closeOnClick||s.target.className==="mapboxgl-popup-close-button"){u.props.onClose();var L=u._context.eventManager;L&&L.once("click",function(F){return F.stopPropagation()},s.target)}}),u}return $s(a,[{key:"componentDidMount",value:function(){t0(zo(a.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(f,w){var p=this._context.viewport,s=this.props,L=s.anchor,F=s.dynamicPosition,G=s.tipSize,H=this._contentRef.current;return H&&F?rre({x:f,y:w,anchor:L,padding:G,width:p.width,height:p.height,selfWidth:H.clientWidth,selfHeight:H.clientHeight}):L}},{key:"_getContainerStyle",value:function(f,w,p,s){var L=this._context.viewport,F=this.props,G=F.offsetLeft,H=F.offsetTop,X=F.sortByDepth,ne=rb[s],ie=f+G,se=w+H,Te=this._containerRef.current,ue=GL(Te,-ne.x*100),ce=GL(Te,-ne.y*100,"y"),de={position:"absolute",transform:`
        translate(`.concat(ue,"%, ").concat(ce,`%)
        translate(`).concat(tb(ie),"px, ").concat(tb(se),`px)
      `),display:void 0,zIndex:void 0};return X&&(p>1||p<-1||f<0||f>L.width||w<0||w>L.height?de.display="none":de.zIndex=Math.floor((1-p)/2*1e5)),de}},{key:"_renderTip",value:function(f){var w=this.props.tipSize;return fe.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:w}})}},{key:"_renderContent",value:function(){var f=this.props,w=f.closeButton,p=f.children,s=this._context.eventManager?null:this._onClick;return fe.createElement("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content",onClick:s},w&&fe.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},"×"),p)}},{key:"_render",value:function(){var f=this.props,w=f.className,p=f.longitude,s=f.latitude,L=f.altitude,F=this._context.viewport.project([p,s,L]),G=p_(F,3),H=G[0],X=G[1],ne=G[2],ie=this._getPosition(H,X),se=this._getContainerStyle(H,X,ne,ie);return fe.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(ie," ").concat(w),style:se,ref:this._containerRef},this._renderTip(ie),this._renderContent())}}]),a}(fs);pr(AB,"propTypes",ore);pr(AB,"defaultProps",are);function sre(e){var n=lre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function lre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var cre=Object.assign({},fs.propTypes,{className:Or.string,container:Or.object,label:Or.string}),ure=Object.assign({},fs.defaultProps,{className:"",container:null,label:"Toggle fullscreen"}),CM=function(e){Rc(a,e);var n=sre(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"state",{isFullscreen:!1,showButton:!1}),pr(On(u),"_mapboxFullscreenControl",null),pr(On(u),"_onFullscreenChange",function(){var s=!u._mapboxFullscreenControl._fullscreen;u._mapboxFullscreenControl._fullscreen=s,u.setState({isFullscreen:s})}),pr(On(u),"_onClickFullscreen",function(){u._mapboxFullscreenControl._onClickFullscreen()}),u}return $s(a,[{key:"componentDidMount",value:function(){var f=this.props.container||this._context.mapContainer;this._mapboxFullscreenControl=new Im.FullscreenControl({container:f}),this.setState({showButton:this._mapboxFullscreenControl._checkFullscreenSupport()}),Bg.addEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"componentWillUnmount",value:function(){Bg.removeEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"_renderButton",value:function(f,w,p){return fe.createElement("button",{key:f,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(f),type:"button",title:w,onClick:p},fe.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){if(!this.state.showButton)return null;var f=this.props,w=f.className,p=f.label,s=this.state.isFullscreen,L=s?"shrink":"fullscreen";return fe.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(w),ref:this._containerRef},this._renderButton(L,p,this._onClickFullscreen))}}]),a}(fs);pr(CM,"propTypes",cre);pr(CM,"defaultProps",ure);var Pv;function hre(){return Pv!==void 0?Promise.resolve(Pv):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(function(e){return Pv=e.state!=="denied",Pv}):(Pv=!!window.navigator.geolocation,Promise.resolve(Pv))}function dre(e){var n=pre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function pre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var fre=Object.assign({},LT.defaultProps,{transitionDuration:500}),qL=function(){},mre=Object.assign({},fs.propTypes,{className:Or.string,style:Or.object,label:Or.string,auto:Or.bool,positionOptions:Or.object,fitBoundsOptions:Or.object,trackUserLocation:Or.bool,showUserLocation:Or.bool,onViewStateChange:Or.func,onViewportChange:Or.func,onGeolocate:Or.func}),gre=Object.assign({},fs.defaultProps,{className:"",style:{},label:"Geolocate",auto:!1,positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0,onGeolocate:function(){}}),AM=function(e){Rc(a,e);var n=dre(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"state",{supportsGeolocation:!1,markerPosition:null}),pr(On(u),"_mapboxGeolocateControl",null),pr(On(u),"_geolocateButtonRef",fe.createRef()),pr(On(u),"_setupMapboxGeolocateControl",function(s){if(!s){console.warn("Geolocation support is not available, the GeolocateControl will not be visible.");return}var L={showUserLocation:!1};["positionOptions","fitBoundsOptions","trackUserLocation"].forEach(function(H){H in u.props&&u.props[H]!==null&&(L[H]=u.props[H])});var F=new Im.GeolocateControl(L);u._mapboxGeolocateControl=F,F._watchState="OFF",F._geolocateButton=u._geolocateButtonRef.current,F.options.trackUserLocation&&F._geolocateButton&&F._geolocateButton.setAttribute("aria-pressed","false"),F._updateMarker=u._updateMarker,F._updateCamera=u._updateCamera,F._setup=!0;var G=u._context.eventManager;F.options.trackUserLocation&&G&&G.on("panstart",function(){F._watchState==="ACTIVE_LOCK"&&(F._watchState="BACKGROUND",F._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),F._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"))}),F.on("geolocate",u.props.onGeolocate)}),pr(On(u),"_triggerGeolocate",function(){var s=u._mapboxGeolocateControl;return s._map=u._context.map,u.props.showUserLocation&&(s.on("geolocate",u._updateMarker),s.on("trackuserlocationend",u._updateMarker)),u._mapboxGeolocateControl.trigger()}),pr(On(u),"_updateMarker",function(s){s&&u.setState({markerPosition:s.coords})}),pr(On(u),"_getBounds",function(s){var L=new Im.LngLat(s.coords.longitude,s.coords.latitude),F=s.coords.accuracy,G=L.toBounds(F);return[[G._ne.lng,G._ne.lat],[G._sw.lng,G._sw.lat]]}),pr(On(u),"_updateCamera",function(s){var L=u._context.viewport,F=u._getBounds(s),G=new Zd(L).fitBounds(F),H=G.longitude,X=G.latitude,ne=G.zoom,ie=Object.assign({},L,{longitude:H,latitude:X,zoom:ne}),se=new eb(ie),Te=Object.assign({},se.getViewportProps(),fre),ue=u.props.onViewportChange||u._context.onViewportChange||qL,ce=u.props.onViewStateChange||u._context.onViewStateChange||qL;ce({viewState:Te}),ue(Te)}),pr(On(u),"_renderButton",function(s,L,F){return fe.createElement("button",{key:s,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(s),ref:u._geolocateButtonRef,type:"button",title:L,onClick:F},fe.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}),pr(On(u),"_renderMarker",function(){var s=u.state.markerPosition,L=u.props.showUserLocation;return!s||!L?null:fe.createElement(NT,{key:"location-maker",longitude:s.longitude,latitude:s.latitude,captureDrag:!1,captureDoubleClick:!1},fe.createElement("div",{className:"mapboxgl-user-location-dot",style:{transform:"translate(-50%, -50%)"}}))}),u}return $s(a,[{key:"componentDidMount",value:function(){var f=this;hre().then(function(w){f.setState({supportsGeolocation:w}),f._setupMapboxGeolocateControl(w),w&&f.props.auto&&f._triggerGeolocate()})}},{key:"componentDidUpdate",value:function(f){this.state.supportsGeolocation&&!f.auto&&this.props.auto&&this._triggerGeolocate()}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var f=this._mapboxGeolocateControl._geolocationWatchID;f!==void 0&&(window.navigator.geolocation.clearWatch(f),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var f=this.props,w=f.className,p=f.style,s=f.label;return fe.createElement("div",null,this._renderMarker(),fe.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(w),ref:this._containerRef,style:p},this._renderButton("geolocate",s,this._triggerGeolocate)))}}]),a}(fs);pr(AM,"propTypes",mre);pr(AM,"defaultProps",gre);function _re(e,n){for(var a=(e||"").split(".").map(Number),u=(n||"").split(".").map(Number),f=0;f<3;f++){var w=a[f]||0,p=u[f]||0;if(w<p)return-1;if(w>p)return 1}return 0}function yre(e){var n=vre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function vre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var WL=function(){},xre=Object.assign({},fs.propTypes,{className:Or.string,onViewStateChange:Or.func,onViewportChange:Or.func,showCompass:Or.bool,showZoom:Or.bool,zoomInLabel:Or.string,zoomOutLabel:Or.string,compassLabel:Or.string}),bre=Object.assign({},fs.defaultProps,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"}),wre=1,dA=2;function Sre(e){return _re(e,"1.6.0")>=0?dA:wre}var PM=function(e){Rc(a,e);var n=yre(a);function a(u){var f;return al(this,a),f=n.call(this,u),pr(On(f),"_uiVersion",void 0),pr(On(f),"_onZoomIn",function(){f._updateViewport({zoom:f._context.viewport.zoom+1})}),pr(On(f),"_onZoomOut",function(){f._updateViewport({zoom:f._context.viewport.zoom-1})}),pr(On(f),"_onResetNorth",function(){f._updateViewport({bearing:0,pitch:0})}),CB(u),f}return $s(a,[{key:"_updateViewport",value:function(f){var w=this._context.viewport,p=new eb(Object.assign({},w,f)),s=Object.assign({},p.getViewportProps(),hA),L=this.props.onViewportChange||this._context.onViewportChange||WL,F=this.props.onViewStateChange||this._context.onViewStateChange||WL;F({viewState:s}),L(s)}},{key:"_renderCompass",value:function(){var f=this._context.viewport.bearing,w={transform:"rotate(".concat(-f,"deg)")};return this._uiVersion===dA?fe.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:w}):fe.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:w})}},{key:"_renderButton",value:function(f,w,p,s){return fe.createElement("button",{key:f,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(f),type:"button",title:w,onClick:p},s||fe.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){var f=this.props,w=f.className,p=f.showCompass,s=f.showZoom,L=f.zoomInLabel,F=f.zoomOutLabel,G=f.compassLabel;if(!this._uiVersion){var H=this._context.map;this._uiVersion=H?Sre(H.version):dA}return fe.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(w),ref:this._containerRef},s&&this._renderButton("zoom-in",L,this._onZoomIn),s&&this._renderButton("zoom-out",F,this._onZoomOut),p&&this._renderButton("compass",G,this._onResetNorth,this._renderCompass()))}}]),a}(fs);pr(PM,"propTypes",xre);pr(PM,"defaultProps",bre);function Tre(e){var n=Ere();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Ere(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Ire=Object.assign({},fs.propTypes,{maxWidth:Or.number,unit:Or.oneOf(["imperial","metric","nautical"])}),Cre=Object.assign({},fs.defaultProps,{maxWidth:100,unit:"metric"}),PB=function(e){Rc(a,e);var n=Tre(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"_control",null),pr(On(u),"_mapboxScaleControl",null),u}return $s(a,[{key:"componentDidMount",value:function(){var f=new Im.ScaleControl;f._map=this._context.map,f._container=this._containerRef.current,this._mapboxScaleControl=f,this._update()}},{key:"_update",value:function(){var f=this._mapboxScaleControl;f&&(f.options=this.props,f._onMove())}},{key:"_render",value:function(){return this._control=this._control||fe.createElement("div",{ref:this._containerRef,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}),this._update(),this._control}}]),a}(fs);pr(PB,"propTypes",Ire);pr(PB,"defaultProps",Cre);function Are(e){var n=Pre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Pre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Mre=Object.assign({},fs.propTypes,{redraw:Or.func.isRequired}),kre={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1},MB=function(e){Rc(a,e);var n=Are(a);function a(){var u;al(this,a);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=n.call.apply(n,[this].concat(w)),pr(On(u),"_canvas",void 0),pr(On(u),"_ctx",void 0),pr(On(u),"_redraw",function(){var s=u._ctx;if(s){var L=yL.devicePixelRatio||1;s.save(),s.scale(L,L);var F=u._context,G=F.viewport,H=F.isDragging;u.props.redraw({width:G.width,height:G.height,ctx:s,isDragging:H,project:G.project.bind(G),unproject:G.unproject.bind(G)}),s.restore()}}),u}return $s(a,[{key:"componentDidMount",value:function(){var f=this._containerRef.current;f&&(this._canvas=f,this._ctx=f.getContext("2d")),this._redraw()}},{key:"_render",value:function(){var f=yL.devicePixelRatio||1,w=this._context.viewport,p=w.width,s=w.height;return this._redraw(),fe.createElement("canvas",{ref:this._containerRef,width:p*f,height:s*f,style:{width:"".concat(p,"px"),height:"".concat(s,"px"),position:"absolute",left:0,top:0}})}}]),a}(fs);pr(MB,"propTypes",Mre);pr(MB,"defaultProps",kre);function Rre(e){var n=Dre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Dre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var Ore=Object.assign({},fs.propTypes,{redraw:Or.func.isRequired,style:Or.object}),Lre={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1},kB=function(e){Rc(a,e);var n=Rre(a);function a(){return al(this,a),n.apply(this,arguments)}return $s(a,[{key:"_render",value:function(){var f=this._context,w=f.viewport,p=f.isDragging,s=Object.assign({position:"absolute",left:0,top:0,width:w.width,height:w.height},this.props.style);return fe.createElement("div",{ref:this._containerRef,style:s},this.props.redraw({width:w.width,height:w.height,isDragging:p,project:w.project.bind(w),unproject:w.unproject.bind(w)}))}}]),a}(fs);pr(kB,"propTypes",Ore);pr(kB,"defaultProps",Lre);function zre(e){var n=Nre();return function(){var a=zo(e),u;if(n){var f=zo(this).constructor;u=Reflect.construct(a,arguments,f)}else u=a.apply(this,arguments);return Dc(this,u)}}function Nre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}var jre=Object.assign({},fs.propTypes,{redraw:Or.func.isRequired,style:Or.object}),Bre={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1},RB=function(e){Rc(a,e);var n=zre(a);function a(){return al(this,a),n.apply(this,arguments)}return $s(a,[{key:"_render",value:function(){var f=this._context,w=f.viewport,p=f.isDragging,s=Object.assign({position:"absolute",left:0,top:0},this.props.style);return fe.createElement("svg",{width:w.width,height:w.height,ref:this._containerRef,style:s},this.props.redraw({width:w.width,height:w.height,isDragging:p,project:w.project.bind(w),unproject:w.unproject.bind(w)}))}}]),a}(fs);pr(RB,"propTypes",jre);pr(RB,"defaultProps",Bre);Im&&Im.setRTLTextPlugin;function Fre({data:e}){fe.useState(!0);const a=Ia()==="light"?"mapbox://styles/mapbox/streets-v12":"mapbox://styles/mapbox/dark-v11",u={}.VITE_MAPBOX_ACCESS_TOKEN,f=12,w={address:"1600 Amphitheatre Parkway, Mountain View, california.",longitude:5.62575,latitude:6.33815};return y.jsx("div",{className:"mapViewCard",children:y.jsxs(IM,{reuseMaps:!0,mapboxAccessToken:u,initialViewState:{longitude:w.longitude,latitude:w.latitude,zoom:f},mapStyle:a,scrollZoom:!1,attributionControl:!1,children:[y.jsx(CM,{}),y.jsx(AM,{positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),y.jsx(NT,{longitude:w.longitude,latitude:w.latitude}),y.jsx(PM,{position:"top-left"})]})})}function Vre({data:e}){var n,a,u,f,w,p,s,L;return y.jsx(y.Fragment,{children:((n=e==null?void 0:e.approval)==null?void 0:n.status)==="approved"?y.jsxs("div",{className:"plan-watermark approved",children:[y.jsx(pH,{className:"statusIcon"}),y.jsxs("div",{className:"wrapper",children:[y.jsxs("div",{className:"info",children:[y.jsx("div",{className:"status",children:"APPROVED"}),y.jsx("div",{className:"date",children:$l((a=e==null?void 0:e.approval)==null?void 0:a.statusDate,"eee, MMM d, yyyy")})]}),((u=e==null?void 0:e.approval)==null?void 0:u.isCollected)&&y.jsxs("div",{className:"info",children:[y.jsx("div",{className:"status",children:"Conveyance collected"}),y.jsx("div",{className:"date",children:$l((f=e==null?void 0:e.approval)==null?void 0:f.isCollectedDate,"eee, MMM d, yyyy")})]})]})]}):((w=e==null?void 0:e.approval)==null?void 0:w.status)==="kiv"?y.jsxs("div",{className:"plan-watermark kiv",children:[y.jsx(FC,{className:"statusIcon"})," ",y.jsxs("div",{className:"info",children:[y.jsx("div",{className:"status",children:"KIV"}),y.jsx("div",{className:"date",children:$l((p=e==null?void 0:e.approval)==null?void 0:p.statusDate,"eee, MMM d, yyyy")})]})]}):((s=e==null?void 0:e.approval)==null?void 0:s.status)==="rejected"?y.jsxs("div",{className:"plan-watermark rejected",children:[y.jsx(FC,{className:"statusIcon"})," ",y.jsxs("div",{className:"info",children:[y.jsx("div",{className:"status",children:"REJECTED"}),y.jsx("div",{className:"date",children:$l((L=e==null?void 0:e.approval)==null?void 0:L.statusDate,"eee, MMM d, yyyy")})]})]}):""})}function Ure({setTopBarData:e,setViewBills:n,state:a,reload:u}){var H,X,ne,ie,se,Te,ue,ce,de,Ee,Ne,rt,tt,Ge;const f=ql(),[w,p]=fe.useState(a),{currentUser:s,loading:L}=ma(_t=>_t.user);Ia();const F=s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)}),G=s.isManagement;return fe.useEffect(()=>{p(a)},[a]),y.jsxs("div",{className:"planInfo",children:[y.jsxs("div",{className:"planInfoSummary",children:[y.jsxs("div",{className:"planInfoSummaryDetails",children:[y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"File Name:"}),y.jsxs("span",{className:"planInfoSummaryText large",children:[(X=(H=w==null?void 0:w.applicant)==null?void 0:H.name)==null?void 0:X.toLowerCase(),((ne=w==null?void 0:w.dev)==null?void 0:ne.name)&&` (${(se=(ie=w==null?void 0:w.dev)==null?void 0:ie.name)==null?void 0:se.toLowerCase()})`]})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"Site Location:"}),y.jsxs("span",{className:"planInfoSummaryText large",children:[((Te=w==null?void 0:w.dev)==null?void 0:Te.plotNo)&&((ue=w==null?void 0:w.dev)==null?void 0:ue.plotNo)+","," ",((ce=w==null?void 0:w.dev)==null?void 0:ce.address)&&((Ee=(de=w==null?void 0:w.dev)==null?void 0:de.address)==null?void 0:Ee.toLowerCase())]})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"Current Office:"}),y.jsx("span",{className:"planInfoSummaryText",children:y.jsxs("span",{className:"planInfoSummaryStack",children:[(rt=(Ne=w==null?void 0:w.currentOffice)==null?void 0:Ne.id)==null?void 0:rt.name," Office"]})})]}),F&&y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"Current Stack:"}),y.jsx("span",{className:"planInfoSummaryText",children:y.jsx("span",{className:"planInfoSummaryStack",children:w==null?void 0:w.stack})})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[((w==null?void 0:w.isFastTrack)||(w==null?void 0:w.isFileOfInterest)||(w==null?void 0:w.isOldFile))&&y.jsx("span",{className:"planInfoSummaryTitle",children:"Tags:"}),y.jsxs("span",{className:"planInfoSummaryText",children:[(w==null?void 0:w.isFastTrack)&&y.jsx("span",{className:"tag tag-fastTrack",children:"Fast Track"}),(w==null?void 0:w.isOldFile)&&y.jsx("span",{className:"tag tag-oldFile",children:"Old File"}),(w==null?void 0:w.isFileOfInterest)&&y.jsx("span",{className:"tag tag-fileOfInterest",children:"File Of Interest"})]})]})]}),y.jsxs("div",{className:"planInfoSummaryDetails2",children:[s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)&&_t.tasks.includes("UPDATE PLAN")})&&y.jsx(y.Fragment,{children:y.jsx(gQ,{reload:u,state:w})}),s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)&&_t.tasks.includes("GENERATE PLAN NUMBER")})&&!(w!=null&&w.planNumber)&&y.jsx(yQ,{headerText:(tt=w==null?void 0:w.dev)!=null&&tt.type?`${w==null?void 0:w.uniqueId} - ${(Ge=w==null?void 0:w.dev)==null?void 0:Ge.type}`:w==null?void 0:w.uniqueId,buttonText:"Generate PN",title:"Generate Plan Number",body:"Clicking Okay will generate the next plan number available. Please ensure all criteria are met.",reload:u})]})]}),y.jsx(Vre,{data:w}),y.jsx(Fre,{}),y.jsxs("div",{className:"planInfoWrapper",children:[y.jsx(Qv,{type:w==null?void 0:w.applicant.type,BD:!0,data:w==null?void 0:w.applicant}),y.jsx(Qv,{type:"rep",BD:!0,data:w==null?void 0:w.rep}),y.jsx(Qv,{type:"building",data:w==null?void 0:w.dev})]}),y.jsxs("div",{className:"planInfoButtons",children:[s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)&&_t.tasks.includes("CREATE BILL")})&&y.jsx(y.Fragment,{children:y.jsx(a_,{to:"./create_bill",children:y.jsx("button",{className:"primary",children:"Generate Bill"})})}),(F||G)&&y.jsx(a_,{to:"./bills",children:y.jsx("button",{className:"secondary",children:"View Bills"})}),s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)&&_t.tasks.includes("COMMENT ON PLAN")})&&y.jsx(y.Fragment,{children:y.jsx(_Q,{data:w,reload:u})}),s.office.some(_t=>{var yt,Et,Wt;return((Et=(yt=w==null?void 0:w.currentOffice)==null?void 0:yt.id)==null?void 0:Et._id)===((Wt=_t==null?void 0:_t.id)==null?void 0:Wt._id)&&_t.tasks.includes("MINUTE PLAN")})&&y.jsx(y.Fragment,{children:y.jsx("div",{onClick:()=>{f("./minute",{state:w})},children:y.jsx("button",{className:"secondary",children:"Minute Plan"})})})]}),y.jsx(Pu,{})]})}function vh({topBarData:e,children:n}){const[a,u]=fe.useState(!1);return y.jsxs("div",{className:"middleBar",children:[y.jsx(oJ,{action:e.action,planNumber:e.planNumber,lastPlanNo:e.lastPlanNo,options:e.options,style:{boxShadow:a>0?"inset 0 8px 5px -5px rgb(0 0 0 / 0.4)":"none",border:"1px solid #ccc"}}),y.jsx("div",{className:"middleBarWrapper",onScroll:f=>{f.target.scrollTop>0?u(!0):u(!1)},children:n})]})}function Ey({label:e,toggled:n,onClick:a}){const[u,f]=fe.useState(n),w=()=>{f(!u),a(!u)};return y.jsx("div",{className:"container",children:y.jsxs("label",{className:"toggle-switch",children:[y.jsx("input",{type:"checkbox",defaultChecked:u,onClick:w}),y.jsx("span",{})]})})}function $re(){const[e,n]=fe.useState(!1),[a,u]=fe.useState(!1);fe.useState(!0);const[f,w]=fe.useState(!0),{currentUser:p,loading:s}=ma(ne=>ne.user),L=Ia(),F=ql(),G=async ne=>{ne.preventDefault();const ie=new FormData(ne.target);n(!0);let se={"applicant.type":a===!0?"organization":"individual","applicant.name":ie.get("applicantName")||"","applicant.gender":ie.get("applicantGender")||"","applicant.address":ie.get("applicantAddress")||"","applicant.email":ie.get("applicantEmail")||"","applicant.phone":ie.get("applicantPhone")||"","applicant.phone1":ie.get("applicantPhone1")||"","applicant.photo":ie.get("applicantPassport")||"","applicant.cacCertificate":ie.get("applicantCacCertificate")||"","applicant.idCard":ie.get("applicantIdCard")||"","rep.name":ie.get("repName")||"","rep.gender":ie.get("repGender")||"","rep.address":ie.get("repAddress")||"","rep.email":ie.get("repEmail")||"","rep.phone":ie.get("repPhone")||"","rep.phone1":ie.get("repPhone1")||"","rep.photo":ie.get("repPassport")||"","rep.idCard":ie.get("repIdCard")||"","dev.name":ie.get("planBuildingName")||"","dev.plotNo":ie.get("planPlotNo")||"","dev.address":ie.get("planAddress"),"dev.region":ie.get("planRegion")||"","dev.lga":ie.get("planLga")||"","dev.zone":ie.get("planZone")||"","dev.type":ie.get("planBuildingType")||"","dev.use":ie.get("planBuildingUse")||"","dev.status":ie.get("planBuildingStatus")||"","dev.noOfFloor":ie.get("planFloors")||"","dev.coordinates":ie.get("planCoordinates")||""};Zi.defaults.withCredentials=!0;try{let Te={}.VITE_SERVER;const ue=await Zi.post(`${Te}/staffs/plan`,se,{withCredentials:!0});F(`/permit/${ue.data._id}`),setTimeout(()=>{ai.success("New Application Created",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:L})},200)}catch(Te){let ue=Te.response?Te.response.data.message:Te.message;n(!1),ai.error(ue,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:L})}},H=ne=>y.jsxs("div",{className:"applicationItems",children:[y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{children:[y.jsx("label",{htmlFor:ne+"Name",children:a&&ne!=="rep"?"Organization Name:":"Full Name:"}),y.jsx("input",{type:"text",name:ne+"Name",id:ne+"Name",required:!0})]})}),(!a||ne==="rep")&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"Gender",children:"Gender:"}),y.jsxs("div",{className:"radioBoxWrapper",children:[y.jsxs("label",{htmlFor:ne+"Gender1",children:[y.jsx("span",{children:"Female"}),y.jsx("input",{type:"radio",name:ne+"Gender",value:"female",id:ne+"Gender1",required:!0})]}),y.jsxs("label",{htmlFor:ne+"Gender2",children:[y.jsx("span",{children:"Male"}),y.jsx("input",{type:"radio",name:ne+"Gender",value:"male",id:ne+"Gender2",required:!0})]})]})]}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"Address",children:a&&ne!=="rep"?"Organization Address:":"Address:"}),y.jsx("input",{type:"text",name:ne+"Address",id:ne+"Address",required:!0})]}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemPhone",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:ne+"Phone",children:"Phone 1:"}),y.jsx("input",{type:"tel",name:ne+"Phone",id:ne+"Phone",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:ne+"Phone1",children:"Phone 2:"}),y.jsx("input",{type:"tel",name:ne+"Phone1",id:ne+"Phone1"})]})]})}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"Email",children:"Email:"}),y.jsx("input",{type:"email",name:ne+"Email",id:ne+"Email"})]}),(!a||ne==="rep")&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"IdCard",children:"Select Means of identification:"}),y.jsxs("label",{htmlFor:ne+"IdCard",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:ne+"IdCard",id:ne+"IdCard",accept:"image/png, image/jpeg, image/jpg"})]})]}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"Passport",children:!a||ne==="rep"?"Select passport:":"Select Logo"}),y.jsxs("label",{htmlFor:ne+"Passport",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:ne+"Passport",id:ne+"Passport",accept:"image/png, image/jpeg, image/jpg"})]})]}),a&&ne!=="rep"&&y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:ne+"CacCertificate",children:"Select CAC Certificate:"}),y.jsxs("label",{htmlFor:ne+"CacCertificate",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:ne+"CacCertificate",id:ne+"CacCertificate",accept:"image/png, image/jpeg, image/jpg"})]})]})]}),X=(ne,ie)=>y.jsxs("div",{className:"applicationItem",children:[y.jsxs("label",{htmlFor:ne+"Document",children:[ie,":"]}),y.jsxs("label",{htmlFor:ne+"Document",className:"uploadFileWrapper",children:[y.jsxs("span",{children:[y.jsx(uy,{}),"Upload File"]}),y.jsx("input",{type:"file",name:ne+"Document",id:ne+"Document",accept:"image/png, image/jpeg, image/jpg, .pdf"})]})]});return y.jsx(y.Fragment,{children:y.jsx("form",{action:"#",onSubmit:G,children:y.jsxs("div",{className:"applicationForm",children:[y.jsx("div",{className:"applicationHeader",children:y.jsxs("div",{children:[y.jsx("span",{children:"Applicant Type:"}),y.jsxs("select",{required:!0,name:"applicantType",id:"applicantType",onChange:ne=>u(ne.target.value!=="individual"),children:[y.jsx("option",{value:"individual",children:"Individual"}),y.jsx("option",{value:"organization",children:"Organization"})]})]})}),y.jsxs("div",{className:"applicationInputWrapper",children:[y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsxs("div",{className:"applicationTitle",children:[y.jsxs("h3",{children:[" ",a?"Organization Information":"Applicant Personal Information"]}),y.jsxs("div",{children:[y.jsx("span",{children:"Has Rep"}),y.jsx(Ey,{label:"Rep:",toggled:f,onClick:()=>w(!f)})]})]}),H("applicant")]}),f&&y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Representative Information"})}),H("rep")]}),y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Development Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingName",children:"Development / Building Name:"}),y.jsx("input",{type:"text",name:"planBuildingName",id:"planBuildingName"})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemAddress",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planPlotNo",children:"Plot No:"}),y.jsx("input",{type:"text",name:"planPlotNo",required:!0,id:"planPlotNo"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planAddress",children:"Address:"}),y.jsx("input",{type:"text",name:"planAddress",id:"planAddress",required:!0})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemLocation",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planRegion",children:"Region:"}),y.jsx("input",{type:"text",readOnly:!0,name:"planRegion",value:p.region.name,id:"planRegion"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planLga",children:"LGA:"}),y.jsxs("select",{name:"planLga",id:"planLga",children:[y.jsx("option",{value:""}),X4.map(ne=>y.jsx("option",{value:ne,children:ne},Cc()))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planZone",children:"Zone:"}),y.jsxs("select",{name:"planZone",id:"planZone",children:[y.jsx("option",{value:""}),p.region.zones.map(ne=>y.jsx("option",{value:ne,children:ne},Cc()))]})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemType",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingType",children:"Building/Dev Type:"}),y.jsxs("select",{required:!0,name:"planBuildingType",id:"planBuildingType",children:[y.jsx("option",{value:""}),K4.map(ne=>y.jsx("option",{value:ne,children:ne},Cc()))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingUse",children:"Building/Dev Use:"}),y.jsx("input",{type:"text",name:"planBuildingUse",id:"planBuildingUse"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planBuildingStatus",children:"Building/Dev Status:"}),y.jsxs("select",{required:!0,name:"planBuildingStatus",id:"planBuildingStatus",children:[y.jsx("option",{value:""}),Y4.map(ne=>y.jsx("option",{value:ne,children:ne},Cc()))]})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemType",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planFloors",children:"No of Floors:"}),y.jsx("input",{type:"text",name:"planFloors",id:"planFloors"})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"planCoordinates",children:"Survey Coordinates:"}),y.jsx("input",{type:"text",name:"planCoordinates",id:"planCoordinates"})]})]})})]})]}),y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Upload The Relevant Documents"})}),y.jsxs("div",{className:"applicationItems",children:[X("survey","Survey plan"),X("layout","Layout plan"),X("deed","Deed of Transfer"),X("obaApproval","Oba approval"),X("cOfO","Certificate of occupancy"),X("sar","Site analysis report"),X("soilTest","Soil Test"),X("eia","Environmental impact analysis"),X("fireSafety","Fire safety report"),X("tax","Tax clearance"),X("mechanical","Mechanical Drawing"),X("electrical","Electrical Drawing"),X("architecture","Architectural Drawing"),X("structural","Structural Drawing")]})]})]}),y.jsx("button",{type:"submit",className:"btn  save-application primary",disabled:e,children:e?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Save Application"})]})})})}function DB(){return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"createApplication",children:[y.jsx(Of,{}),y.jsxs("div",{className:"createApplicationWrapper",children:[y.jsx("div",{className:"createApplicationSideBar",children:y.jsx(Lf,{})}),y.jsx("div",{className:"createApplicationMiddleBar",children:y.jsx(vh,{topBarData:{action:"Create New Application"},children:y.jsx($re,{})})})]})]})]})}const Ww=["load","mousemove","mousedown","click","scroll","keypress"];let HL=0;function Gre(){const{currentUser:e,loading:n}=ma(Ee=>Ee.user),a=Ia(),u=eu();ql();const[f,w]=fe.useState(!0),[p,s]=fe.useState(null),[L,F]=fe.useState(),[G,H]=fe.useState(!1);fe.useState(0),e.office.some(Ee=>{var Ne,rt;return(rt=(Ne=Ee==null?void 0:Ee.id)==null?void 0:Ne.name)==null?void 0:rt.includes("ASSESSMENT")}),fe.useState(e.office.some(Ee=>{var Ne,rt;return(rt=(Ne=Ee==null?void 0:Ee.id)==null?void 0:Ne.name)==null?void 0:rt.includes("ASSESSMENT")}));const[X,ne]=fe.useState(e.office.some(Ee=>{var Ne,rt;return(rt=(Ne=Ee==null?void 0:Ee.id)==null?void 0:Ne.name)==null?void 0:rt.includes("CLEARING HOUSE")}));fe.useState(e.office.some(Ee=>{var Ne,rt;return(rt=(Ne=Ee==null?void 0:Ee.id)==null?void 0:Ne.name)==null?void 0:rt.includes("ARCHIVE")}));let ie;const se=()=>{ie&&clearTimeout(ie)};fe.useEffect(()=>{if(e)return Object.values(Ww).forEach(Ee=>{window.addEventListener(Ee,()=>{se(),Te()})}),()=>{se(),Object.values(Ww).forEach(Ee=>{window.removeEventListener(Ee,se)})}});const Te=()=>{const Ee={}.VITE_LOGOUT_TIMER;e?ie=setTimeout(()=>{se(),HL===1&&ai.error("Session Timeout",{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a}),Object.values(Ww).forEach(Ne=>{window.removeEventListener(Ne,se)}),HL++,u(r_()),u(G4()),window.location.reload()},1e3*60*Ee):(se(),Object.values(Ww).forEach(Ne=>{window.removeEventListener(Ne,se)}))},ue=()=>{const Ne=sB(new Date);let rt;return Ne>=5&&Ne<12?rt="Good Morning":Ne>=12&&Ne<18?rt="Good Afternoon":rt="Good Evening",`${rt} ${e.firstName}`},ce=()=>`${$l(new Date,"EEEE, MMMM do, yyyy")}`,de=()=>y.jsx(y.Fragment,{children:y.jsx("div",{className:"feedCard__container",children:y.jsxs("div",{className:"feedCard__list",children:[y.jsx(OC,{priText:"Create New Application",secText:"Clearing",route:"/permit/new"}),y.jsx(OC,{count:44,priText:"Awaiting Action",secText:"Clearing"})]})})});return fe.useEffect(()=>{(async()=>{try{let Ne={}.VITE_SERVER;const rt=await Zi.get(`${Ne}/staffs/staff`);s(rt.data),w(!1),u($4(rt.data))}catch{w(!1),H(!0)}})()},[L]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"homeContainer",children:[y.jsx(Lf,{}),y.jsxs("div",{className:"homePage",children:[y.jsxs("div",{className:"home__greetings",children:[y.jsx("span",{children:ue()}),y.jsx("span",{children:ce()})]}),y.jsx(ub,{children:X&&de()})]})]})]})}function Ry({children:e}){return y.jsx("div",{className:"rightBar",children:e})}function OB({buttonIcon:e,buttonText:n,children:a,stateData:u}){var ne,ie,se,Te,ue,ce;const[f,w]=fe.useState(!1);fe.useState(!1);const[p,s]=fe.useState(u);Ia();const L=()=>w(!0),F=()=>w(!1),G="Escape",H="keyup";X(F);function X(de){const Ee=fe.useCallback(Ne=>{Ne.key===G&&de()},[de]);fe.useEffect(()=>(document.addEventListener(H,Ee,!1),()=>{document.removeEventListener(H,Ee,!1)}),[Ee])}return fe.useEffect(()=>{const de=document.querySelector(".modalView");de&&(f?de.showModal():de.close())},[f]),y.jsxs("div",{children:[y.jsx("div",{className:"modalTrigger activityCardViewMoreIcon",onClick:L,children:y.jsx(_H,{})}),f&&y.jsxs("dialog",{className:"modalView activityCardModal",children:[y.jsxs("header",{children:[y.jsx("span",{children:"Activities View"}),y.jsx("div",{className:"modalViewCloseButton",onClick:F,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("div",{className:"activityCardModalWrapper",children:[y.jsxs("div",{className:"head",children:[y.jsx("h3",{className:`${p.type} minuteType`,children:p.type}),y.jsxs("div",{className:"date",children:[$l(p.createdAt,"EEEE, MMMM do, yyyy"),` at ${$l(p.createdAt,"HH:mm")}`]})]}),y.jsx("div",{className:"activityCardHead",children:y.jsx("h2",{className:"action",children:p.type==="Minute"?"File Minuted":p.title})}),((ne=p==null?void 0:p.to)==null?void 0:ne.office)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"To:"}),y.jsxs("div",{className:"card",children:[y.jsx("span",{className:"text",children:`${p.to.office}`}),y.jsx("span",{className:"text",children:(p.to.staff!=="Unavailable"||p.to.staff!=="Multiple staff")&&`${p.to.staff}`})]})]}),((ie=p==null?void 0:p.from)==null?void 0:ie.office)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"From:"}),y.jsxs("div",{className:"card",children:[y.jsx("span",{className:"text",children:`${p.from.office}`}),y.jsx("span",{className:"text",children:p.from.staff&&`${p.from.staff}`})]})]}),((se=p==null?void 0:p.by)==null?void 0:se.office)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"By:"}),y.jsxs("div",{className:"card",children:[y.jsx("span",{className:"text",children:`${p.by.office}`}),y.jsx("span",{className:"text",children:p.by.staff&&`${p.by.staff}`})]})]}),((Te=p==null?void 0:p.through)==null?void 0:Te.office)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"Through:"}),y.jsxs("div",{className:"card",children:[y.jsx("span",{className:"text",children:`${p.through.office}`}),y.jsx("span",{className:"text",children:p.through.staff&&`${p.through.staff}`})]})]}),((ue=p==null?void 0:p.comment)==null?void 0:ue.status)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"Status:"}),y.jsx("div",{className:"card",children:y.jsx("span",{className:"text",children:`${p.comment.status}`})})]}),((ce=p==null?void 0:p.comment)==null?void 0:ce.text)&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"title",children:"Comment:"}),y.jsx("div",{className:"card comment",children:y.jsx("span",{className:"text ",children:`${p.comment.text}`})})]}),(p==null?void 0:p.type)==="Minute"&&y.jsx(y.Fragment,{children:y.jsx("div",{className:"title dio",children:"DIO: 45 days"})})]})]})]})}function qre({data:e}){var f,w,p,s,L,F,G;const[n,a]=fe.useState(!1),u=H=>lB(H)?y.jsx("span",{className:"date",children:"Today"}):cB(H)?y.jsx("span",{className:"date",children:"Yesterday"}):y.jsx("span",{className:"date",children:$l(H,"MMM d, yyyy")});return y.jsxs("div",{className:"activityCard",children:[y.jsx("div",{className:"activityCardArrow"}),y.jsxs("h1",{children:[" ",y.jsx("span",{className:`activityCardTypeTag ${e.type}`,children:e.type})]}),y.jsx(OB,{stateData:e}),y.jsxs("div",{className:"activityCardHead",children:[y.jsx("h2",{className:"title",children:e.type==="Minute"?(f=e.to)==null?void 0:f.office:e.title}),u(e.createdAt)]}),((w=e==null?void 0:e.from)==null?void 0:w.staff)&&y.jsxs("div",{children:[y.jsx("span",{className:"activityCardTitle",children:"From:"}),y.jsx("span",{className:"activityCardText",children:`${e.from.office}`})]}),((p=e==null?void 0:e.by)==null?void 0:p.staff)&&y.jsxs("div",{children:[y.jsx("span",{className:"activityCardTitle",children:"By:"}),y.jsx("span",{className:"activityCardText",children:`${e.by.office} `})]}),((s=e==null?void 0:e.comment)==null?void 0:s.status)&&y.jsxs("div",{children:[y.jsx("span",{className:"activityCardTitle",children:"Status:"})," ",y.jsx("span",{className:"activityCardText",children:(L=e==null?void 0:e.comment)==null?void 0:L.status})]}),y.jsxs("div",{className:"activityCardComment",children:[((F=e==null?void 0:e.comment)==null?void 0:F.text)&&y.jsxs("div",{className:"activityCardCommentButton",onClick:()=>a(!n),children:[y.jsx("span",{children:"Comment"}),n?y.jsx(nM,{className:"activityCardCommentButtonIcon"}):y.jsx(My,{className:"activityCardCommentButtonIcon"})]}),n&&y.jsx("p",{className:"activityCardCommentText",children:(G=e==null?void 0:e.comment)==null?void 0:G.text})]})]})}function b_(){return y.jsx("div",{className:"loading-container",children:y.jsx(kc,{thickness:3,size:55,className:"loading-icon"})})}function Wre({buttonIcon:e,buttonText:n,children:a,data:u,reload:f,isCleared:w,type:p}){var ce;const[s,L]=fe.useState(!1),[F,G]=fe.useState(!1),H=Ia(),X=()=>L(!0),ne=()=>{G(!1),L(!1)},ie="Escape",se="keyup";Te(ne);function Te(de){const Ee=fe.useCallback(Ne=>{Ne.key===ie&&de()},[de]);fe.useEffect(()=>(document.addEventListener(se,Ee,!1),()=>{document.removeEventListener(se,Ee,!1)}),[Ee])}const ue=async de=>{de.preventDefault();const Ee=new FormData(de.target),Ne={status:Ee.get("minuteStatus"),text:Ee.get("minuteText"),type:p};try{G(!0);let rt={}.VITE_SERVER;const tt=await Zi.post(`${rt}/staffs/plan/${u._id}/vet_plan`,Ne);ne(),f(()=>[]),setTimeout(()=>{ai.success(tt.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})},200)}catch(rt){let tt=rt.response?rt.response.data.message:rt.message;G(!1),ai.error(tt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})}};return fe.useEffect(()=>{const de=document.querySelector(".modalView");de&&(s?de.showModal():de.close())},[s]),y.jsxs(y.Fragment,{children:[y.jsx("button",{className:"btn vet__add",onClick:X,children:"Add"}),s&&y.jsxs("dialog",{className:"modalView vettingCardAddModal",children:[y.jsxs("header",{children:[y.jsxs("span",{children:["Plan - ",((ce=u==null?void 0:u.planNumber)==null?void 0:ce.fullValue)||(u==null?void 0:u.uniqueId)]}),y.jsx("div",{className:"modalViewCloseButton",onClick:ne,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:ue,children:[y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsxs("h3",{children:["Add ",p," Comment "]})}),w&&y.jsxs("div",{className:"errorProhibited",children:[y.jsx(FC,{className:"errorProhibitedIcon"})," ",y.jsx("p",{children:"Adding comment after it is cleared is prohibited. Make sure you have the appropriate permission to perform this task!"})]}),y.jsxs("div",{className:"minuteItems",children:[y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteStatus",children:"Status:"}),y.jsxs("select",{name:"minuteStatus",id:"minuteStatus",required:!0,children:[y.jsx("option",{value:"",children:"..."}),eJ.map(de=>y.jsx("option",{value:de,children:de}))]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteText",children:"Comment:"}),y.jsx("textarea",{required:!0,name:"minuteText",id:"minuteText",cols:"30",rows:"8"})]})]})]}),y.jsx("footer",{children:y.jsx("button",{type:"submit",className:"primary",disabled:F,children:F?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Save"})})]})]})]})}function Jx({data:e,header:n,reload:a}){var G,H,X,ne,ie,se,Te,ue,ce,de,Ee,Ne,rt;fe.useState(!1);const[u,f]=fe.useState(!1),{currentUser:w}=ma(tt=>tt.user);ma(tt=>tt.admin);const p=tt=>lB(tt)?y.jsx(y.Fragment,{children:y.jsx("span",{children:"Today"})}):cB(tt)?y.jsx(y.Fragment,{children:y.jsx("span",{children:"Yesterday"})}):y.jsx(y.Fragment,{children:y.jsx("span",{children:$l(tt,"dd/MM/yyyy")})}),s=(G=w==null?void 0:w.office)==null?void 0:G.some(tt=>{var Ge,_t,yt,Et;return((yt=(_t=(Ge=e==null?void 0:e.plan)==null?void 0:Ge.currentOffice)==null?void 0:_t.id)==null?void 0:yt._id)===((Et=tt==null?void 0:tt.id)==null?void 0:Et._id)&&tt.tasks.includes("VET PLAN")}),L=((H=w==null?void 0:w.jobTitle)==null?void 0:H.toLowerCase())===n.jobTitle.toLowerCase(),F=((ne=(X=e==null?void 0:e.vetting)==null?void 0:X.status)==null?void 0:ne.toLowerCase())==="cleared"||((se=(ie=e==null?void 0:e.vetting)==null?void 0:ie.status)==null?void 0:se.toLowerCase())==="process further";return y.jsxs("div",{className:"vettingCard",children:[y.jsx(OB,{stateData:e.plan}),y.jsxs("div",{className:"type",onClick:()=>f(!u),children:[y.jsx("h2",{className:"type__title",children:n.title}),y.jsx("span",{className:`type__status ${(ue=(Te=e==null?void 0:e.vetting)==null?void 0:Te.status)==null?void 0:ue.toLowerCase()}`,children:((ce=e==null?void 0:e.vetting)==null?void 0:ce.status)||"No Action"})]}),u&&y.jsxs(y.Fragment,{children:[(Ee=(de=e==null?void 0:e.vetting)==null?void 0:de.items)==null?void 0:Ee.map((tt,Ge)=>{var _t;return y.jsxs("div",{className:"vet",children:[y.jsxs("div",{className:"vet__head",children:[y.jsx("div",{className:`vet__status ${(_t=tt==null?void 0:tt.status)==null?void 0:_t.toLowerCase()}`,children:tt==null?void 0:tt.status}),y.jsx("div",{className:"vet__date",children:p(tt==null?void 0:tt.date)})]}),y.jsx("div",{className:"vet__comment",children:tt==null?void 0:tt.comment}),y.jsx("div",{className:"vet__officer",children:tt==null?void 0:tt.staffName})]},Ge)}),((rt=(Ne=e==null?void 0:e.vetting)==null?void 0:Ne.items)==null?void 0:rt.length)===0&&"No Professional Comment",L&&s&&y.jsx(Wre,{data:e.plan,reload:a,isCleared:F,type:n.jobTitle,className:"btn vet__add"})]})]})}function Dy({setRightBarView:e,reload:n,admin:a,plan:u}){var Wt,Ar,mt,nr,Xt,Ht,Qt;const[f,w]=fe.useState(!1),[p,s]=fe.useState([]),[L,F]=fe.useState(a),[G,H]=fe.useState([]),[X,ne]=fe.useState("All"),[ie,se]=fe.useState("No Record...");fe.useState(u);const[Te,ue]=fe.useState(),{currentUser:ce,loading:de}=ma(sr=>sr.user),{currentAdmin:Ee}=ma(sr=>sr.admin),Ne=Ay(),rt=Ia(),tt=sr=>{var Tr,ln,vn,wi,hi,Vn,Oi,fn,Nn,Pt,Dt,Ir,xr,Kt,Cn;return!(!(((vn=(ln=(Tr=sr==null?void 0:sr.vetting)==null?void 0:Tr.architect)==null?void 0:ln.status)==null?void 0:vn.toLowerCase())==="no action"||((Vn=(hi=(wi=sr==null?void 0:sr.vetting)==null?void 0:wi.mechanicalEngineer)==null?void 0:hi.status)==null?void 0:Vn.toLowerCase())==="no action"||((Nn=(fn=(Oi=sr==null?void 0:sr.vetting)==null?void 0:Oi.electricalEngineer)==null?void 0:fn.status)==null?void 0:Nn.toLowerCase())==="no action"||((Ir=(Dt=(Pt=sr==null?void 0:sr.vetting)==null?void 0:Pt.civilEngineer)==null?void 0:Dt.status)==null?void 0:Ir.toLowerCase())==="no action"||((Cn=(Kt=(xr=sr==null?void 0:sr.vetting)==null?void 0:xr.townPlanner)==null?void 0:Kt.status)==null?void 0:Cn.toLowerCase())==="no action")&&Te)},Ge=()=>{var sr,Tr,ln,vn,wi,hi,Vn,Oi,fn,Nn,Pt,Dt,Ir,xr,Kt,Cn,gn,fr,Zr,qr,sn,qn,Li,_i,zi,Pi,rr,Me,qe,at,$t,cr,br,en,ur,Kr,Vr,cn,Xn,Mr,Fr,ri,mi,gi,Xi,mo,eo,Se,Re,Fe,et,it,wt,$e;return y.jsxs("div",{className:"vettingCommentSheet",children:[y.jsxs("div",{className:"date",children:["Printed: ",$l(new Date,"dd/MM/yyyy")]}),y.jsx("h1",{className:"header",children:"Vetting Comment Sheet"}),y.jsxs("div",{className:"detailsWrapper",children:[y.jsxs("div",{className:"details",children:[y.jsxs("div",{className:"detailsItem",children:[y.jsx("span",{className:"detailsItem-name",children:"Plan Number:"}),y.jsx("span",{className:"detailsItem-value",children:((sr=u==null?void 0:u.planNumber)==null?void 0:sr.fullValue)||(u==null?void 0:u.uniqueId)})]}),y.jsxs("div",{className:"detailsItem",children:[y.jsx("span",{className:"detailsItem-name",children:"Applicant Name:"}),y.jsx("span",{className:"detailsItem-value",children:(ln=(Tr=u==null?void 0:u.applicant)==null?void 0:Tr.name)==null?void 0:ln.toLowerCase()})]}),y.jsxs("div",{className:"detailsItem",children:[y.jsx("span",{className:"detailsItem-name",children:"Development Address:"}),y.jsxs("span",{className:"detailsItem-value",children:[" ",((vn=u==null?void 0:u.dev)==null?void 0:vn.plotNo)&&((wi=u==null?void 0:u.dev)==null?void 0:wi.plotNo)+","," ",((hi=u==null?void 0:u.dev)==null?void 0:hi.address)&&((Oi=(Vn=u==null?void 0:u.dev)==null?void 0:Vn.address)==null?void 0:Oi.toLowerCase())]})]}),y.jsxs("div",{className:"detailsItem",children:[y.jsx("span",{className:"detailsItem-name",children:"Development Type:"}),y.jsx("span",{className:"detailsItem-value",children:(fn=u==null?void 0:u.dev)==null?void 0:fn.type})]})]}),y.jsx("h2",{className:"header2",children:"Comments"}),y.jsxs("div",{className:"comments-wrapper",children:[!(((Dt=(Pt=(Nn=u==null?void 0:u.vetting)==null?void 0:Nn.architect)==null?void 0:Pt.status)==null?void 0:Dt.toLowerCase())==="cleared"||((Kt=(xr=(Ir=u==null?void 0:u.vetting)==null?void 0:Ir.architect)==null?void 0:xr.status)==null?void 0:Kt.toLowerCase())==="process further")&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"comments",children:[y.jsx("p",{className:"comment-type",children:"Architect"}),(fr=(gn=(Cn=u==null?void 0:u.vetting)==null?void 0:Cn.architect)==null?void 0:gn.items)==null?void 0:fr.map((ve,Le)=>{if(ve.status.toLowerCase()!=="cleared"||ve.status.toLowerCase()!=="process further")return y.jsx("div",{className:"comment-body",children:y.jsxs("div",{className:"comment-body-item",children:[y.jsx("span",{className:"comment-number",children:Le+1}),y.jsx("span",{className:"comment-text",children:ve.comment})]})})})]})}),!(((sn=(qr=(Zr=u==null?void 0:u.vetting)==null?void 0:Zr.civilEngineer)==null?void 0:qr.status)==null?void 0:sn.toLowerCase())==="cleared"||((_i=(Li=(qn=u==null?void 0:u.vetting)==null?void 0:qn.civilEngineer)==null?void 0:Li.status)==null?void 0:_i.toLowerCase())==="process further")&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"comments",children:[y.jsx("p",{className:"comment-type",children:"Civil Engineer"}),(rr=(Pi=(zi=u==null?void 0:u.vetting)==null?void 0:zi.civilEngineer)==null?void 0:Pi.items)==null?void 0:rr.map((ve,Le)=>{if(ve.status.toLowerCase()!=="cleared"||ve.status.toLowerCase()!=="process further")return y.jsx("div",{className:"comment-body",children:y.jsxs("div",{className:"comment-body-item",children:[y.jsx("span",{className:"comment-number",children:Le+1}),y.jsx("span",{className:"comment-text",children:ve.comment})]})})})]})}),!(((at=(qe=(Me=u==null?void 0:u.vetting)==null?void 0:Me.electricalEngineer)==null?void 0:qe.status)==null?void 0:at.toLowerCase())==="cleared"||((br=(cr=($t=u==null?void 0:u.vetting)==null?void 0:$t.electricalEngineer)==null?void 0:cr.status)==null?void 0:br.toLowerCase())==="process further")&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"comments",children:[y.jsx("p",{className:"comment-type",children:"Electrical Engineer"}),(Kr=(ur=(en=u==null?void 0:u.vetting)==null?void 0:en.electricalEngineer)==null?void 0:ur.items)==null?void 0:Kr.map((ve,Le)=>{if(ve.status.toLowerCase()!=="cleared"||ve.status.toLowerCase()!=="process further")return y.jsx("div",{className:"comment-body",children:y.jsxs("div",{className:"comment-body-item",children:[y.jsx("span",{className:"comment-number",children:Le+1}),y.jsx("span",{className:"comment-text",children:ve.comment})]})})})]})}),!(((Xn=(cn=(Vr=u==null?void 0:u.vetting)==null?void 0:Vr.mechanicalEngineer)==null?void 0:cn.status)==null?void 0:Xn.toLowerCase())==="cleared"||((ri=(Fr=(Mr=u==null?void 0:u.vetting)==null?void 0:Mr.mechanicalEngineer)==null?void 0:Fr.status)==null?void 0:ri.toLowerCase())==="process further")&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"comments",children:[y.jsx("p",{className:"comment-type",children:"Mechanical Engineer"}),(Xi=(gi=(mi=u==null?void 0:u.vetting)==null?void 0:mi.mechanicalEngineer)==null?void 0:gi.items)==null?void 0:Xi.map((ve,Le)=>{if(ve.status.toLowerCase()!=="cleared"||ve.status.toLowerCase()!=="process further")return y.jsx("div",{className:"comment-body",children:y.jsxs("div",{className:"comment-body-item",children:[y.jsx("span",{className:"comment-number",children:Le+1}),y.jsx("span",{className:"comment-text",children:ve.comment})]})})})]})}),!(((Se=(eo=(mo=u==null?void 0:u.vetting)==null?void 0:mo.townPlanner)==null?void 0:eo.status)==null?void 0:Se.toLowerCase())==="cleared"||((et=(Fe=(Re=u==null?void 0:u.vetting)==null?void 0:Re.townPlanner)==null?void 0:Fe.status)==null?void 0:et.toLowerCase())==="process further")&&y.jsx(y.Fragment,{children:y.jsxs("div",{className:"comments",children:[y.jsx("p",{className:"comment-type",children:"Town Planner"}),($e=(wt=(it=u==null?void 0:u.vetting)==null?void 0:it.townPlanner)==null?void 0:wt.items)==null?void 0:$e.map((ve,Le)=>{if(ve.status.toLowerCase()!=="cleared"||ve.status.toLowerCase()!=="process further")return y.jsx("div",{className:"comment-body",children:y.jsxs("div",{className:"comment-body-item",children:[y.jsx("span",{className:"comment-number",children:Le+1}),y.jsx("span",{className:"comment-text",children:ve.comment})]})})})]})})]})]})]})},_t=async()=>{var sr;try{let Tr={}.VITE_SERVER,ln;L?ln=await Promise.all([Zi.get(`${Tr}/admin/plan/${Ne.id}/activities`)]):ln=await Promise.all([Zi.get(`${Tr}/staffs/plan/${Ne.id}/activities`)]);const vn=ln[0].data,wi=((sr=ce==null?void 0:ce.office)==null?void 0:sr.some(hi=>{var Vn,Oi,fn;return((Oi=(Vn=u==null?void 0:u.currentOffice)==null?void 0:Vn.id)==null?void 0:Oi._id)===((fn=hi==null?void 0:hi.id)==null?void 0:fn._id)}))||(ce==null?void 0:ce.isManagement)===!0||Ee;ue(wi),s(vn),H(wi?vn:[...vn].slice(0,2)),w(!1)}catch(Tr){let ln=Tr.response?Tr.response.data.message:Tr.message;se(Tr.message||"Network Error"),setTimeout(()=>{ai.error(ln,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:rt})},0),w(!1)}},yt=sr=>sr==="All"?p:p.filter(Tr=>Tr.type===sr),Et=sr=>{const Tr=sr.target.getAttribute("data-value");H(Te?yt(Tr):[...yt(Tr)].slice(0,2)),ne(Tr)};return fe.useEffect(()=>{w(!0)},[]),fe.useEffect(()=>{u&&_t()},[u,n,Ne.id]),y.jsxs("div",{className:"activities",children:[y.jsxs("div",{className:"activitiesTop",children:[y.jsx("span",{className:"activitiesTopActive",children:"Activities"}),y.jsx("span",{onClick:()=>e(1),children:"Documents"})]}),y.jsxs("div",{className:"activitiesLabels",children:[y.jsx("span",{"data-value":"All",className:X==="All"?"activitiesLabelActive":"",onClick:Et,children:"All"}),y.jsx("span",{"data-value":"Minute",className:X==="Minute"?"activitiesLabelActive":"",onClick:Et,children:"Minutes"}),y.jsx("span",{"data-value":"Action",className:X==="Action"?"activitiesLabelActive":"",onClick:Et,children:"Actions"}),y.jsx("span",{"data-value":"Vetting",className:X==="Vetting"?"activitiesLabelActive":"",onClick:Et,children:"Vetting"})]}),y.jsxs("div",{className:`activitiesWrapper ${X.toLowerCase()}`,children:[f&&y.jsx(b_,{}),!f&&(G.length<1&&!f&&X.toLowerCase()!=="vetting"?y.jsx("div",{className:"empty",children:y.jsx("p",{children:ie})}):X.toLowerCase()!=="vetting"&&G.map(sr=>y.jsx(qre,{data:sr},sr._id))),X.toLowerCase()==="vetting"&&!f&&y.jsxs(y.Fragment,{children:[y.jsx(Jx,{reload:n,data:{plan:u,vetting:(Wt=u==null?void 0:u.vetting)==null?void 0:Wt.architect},header:{jobTitle:"Architect",title:"Architect"}}),y.jsx(Jx,{reload:n,data:{plan:u,vetting:(Ar=u==null?void 0:u.vetting)==null?void 0:Ar.electricalEngineer},header:{jobTitle:"Electrical Engineer",title:"Elect. Engr"}}),y.jsx(Jx,{reload:n,data:{plan:u,vetting:(mt=u==null?void 0:u.vetting)==null?void 0:mt.mechanicalEngineer},header:{jobTitle:"Mechanical Engineer",title:"Mech. Engr"}}),y.jsx(Jx,{reload:n,data:{plan:u,vetting:(nr=u==null?void 0:u.vetting)==null?void 0:nr.civilEngineer},header:{jobTitle:"Civil Engineer",title:"Civil Engr"}}),y.jsx(Jx,{reload:n,data:{plan:u,vetting:(Xt=u==null?void 0:u.vetting)==null?void 0:Xt.townPlanner},header:{jobTitle:"Town Planning Officer",title:"Town Planner"}}),y.jsxs("div",{className:"printBtn",children:[y.jsx(JC,{title:`vetting_Comment_${(Ht=u==null?void 0:u.planNumber)==null?void 0:Ht.fullValue}`,classes:"btn",label:"Print Vetting Sheet",error:tt(u)}),y.jsx(JC,{title:`vetting_Comment_${(Qt=u==null?void 0:u.planNumber)==null?void 0:Qt.fullValue}`,classes:"btn",label:"Print Comment Sheet",content:Ge(),error:tt(u)})]}),y.jsx("br",{})]})]})]})}function Oy({setRightBarView:e}){return y.jsxs("div",{className:"document",children:[y.jsxs("div",{className:"documentTop",children:[y.jsx("span",{onClick:()=>e(0),children:"Activities"}),y.jsx("span",{className:"documentTopActive",children:"Documents"})]}),y.jsxs("div",{className:"documentWrapper",children:[y.jsxs("div",{className:"documentPages",children:[y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 34 / DN34"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]}),y.jsxs("div",{className:"documentPage",children:[y.jsx("div",{className:"documentPageBg"}),y.jsx("div",{className:"documentPageName",children:y.jsx("span",{children:"Page 343 / DN343"})})]})]}),y.jsxs("div",{className:"documentItems",children:[y.jsxs("div",{className:"documentItem",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Survey Plan"})})]}),y.jsx(a_,{to:"/permit/planId/documents",children:y.jsxs("div",{className:"documentItem selected",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Governor's Consent"})})]})}),y.jsxs("div",{className:"documentItem",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Environmental Impact Analysis"})})]}),y.jsxs("div",{className:"documentItem",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Document Name even if its deof Here"})})]}),y.jsxs("div",{className:"documentItem",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Document Name even if its deof Here"})})]}),y.jsxs("div",{className:"documentItem",children:[y.jsx("div",{className:"documentItemBg"}),y.jsx("div",{className:"documentItemName",children:y.jsx("span",{children:"Document Name even if its deof Here"})})]})]})]})]})}function Hre(){const[e,n]=fe.useState("assessment");return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"generateBillType",children:[y.jsx("span",{children:"Select Bill Type:"}),y.jsxs("select",{className:"secondary",onChange:a=>{n(a.target.value)},children:[y.jsx("option",{value:"assessment",children:"Assessment"}),y.jsx("option",{value:"fastTrack",children:"FastTrack"})]})]}),e==="assessment"?y.jsxs("div",{className:"generateBillWrapper",children:[y.jsx("div",{className:"generateBillTitle",children:"Fees Analysis"}),y.jsxs("div",{className:"generateBillItems",children:[y.jsx("div",{className:"generateBillItem",children:y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Registration Fee:"}),y.jsx("span",{className:"generateBillItemValue",children:"35,000"})]})}),y.jsx("div",{className:"generateBillItem",children:y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Development Fees:"}),y.jsx("span",{className:"generateBillItemValue",children:"34,000"})]})}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Volume of Building:"}),y.jsx("span",{className:"generateBillItemValue",children:"65,989"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsx("div",{children:y.jsx("button",{children:y.jsx(Gx,{})})}),y.jsxs("div",{className:"generateBillItemBreakdown",children:[y.jsxs("div",{className:"VOBLength",children:[y.jsx("span",{children:"Length:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{className:"VOBBreath",children:[y.jsx("span",{children:"Breath:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{children:[y.jsx("span",{className:"VOBHeight",children:"Height:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Fee Per Sq Meter:"}),y.jsxs("button",{children:["25 ",y.jsx(Iv,{})]})]})]}),y.jsx("div",{children:"54,908"})]}),y.jsx("button",{children:y.jsx($x,{})})]}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Land Area:"}),y.jsx("span",{className:"generateBillItemValue",children:"34,909"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsxs("div",{className:"generateBillItemBreakdown",children:[y.jsxs("div",{className:"AreaOfPlot",children:[y.jsx("span",{children:"Area of Plot:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Fee Per Sq Meter:"}),y.jsxs("button",{children:["25 ",y.jsx(Iv,{})]})]})]}),y.jsx("div",{children:"54,908"})]})]}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Building Facilities:"}),y.jsx("span",{className:"generateBillItemValue",children:"34,909"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsx("div",{children:y.jsx("button",{children:y.jsx(Gx,{})})}),y.jsx("div",{className:"generateBillItemBreakdown",children:y.jsxs("div",{children:[y.jsx("span",{children:"Type of Facility:"}),y.jsxs("button",{children:["Gate House ",y.jsx(Iv,{})]})]})}),y.jsx("div",{children:"54,908"})]}),y.jsx("button",{children:y.jsx($x,{})})]}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Other Fees:"}),y.jsx("span",{className:"generateBillItemValue",children:"34,909"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsx("div",{children:y.jsx("button",{children:y.jsx(Gx,{})})}),y.jsx("div",{className:"generateBillItemBreakdown",children:y.jsxs("div",{children:[y.jsx("span",{children:"Type of Fee:"}),y.jsxs("button",{children:["Land Use Fee ",y.jsx(Iv,{})]})]})}),y.jsx("div",{children:"54,908"})]}),y.jsx("button",{children:y.jsx($x,{})})]}),y.jsx("div",{className:"generateBillItem",children:y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"TOTAL AMOUNT:"}),y.jsx("span",{className:"generateBillItemValue",children:"346,909"})]})})]})]}):e==="fastTrack"?y.jsxs("div",{className:"generateBillWrapper",children:[y.jsx("div",{className:"generateBillTitle",children:"Fees Analysis"}),y.jsxs("div",{className:"generateBillItems",children:[y.jsx("div",{className:"generateBillItem",children:y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"FastTrack Fee:"}),y.jsx("span",{className:"generateBillItemValue",children:"35,000"})]})}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Volume of Building:"}),y.jsx("span",{className:"generateBillItemValue",children:"65,989"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsx("div",{children:y.jsx("button",{children:y.jsx(Gx,{})})}),y.jsxs("div",{className:"generateBillItemBreakdown",children:[y.jsxs("div",{className:"VOBLength",children:[y.jsx("span",{children:"Length:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{className:"VOBBreath",children:[y.jsx("span",{children:"Breath:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{children:[y.jsx("span",{className:"VOBHeight",children:"Height:"}),y.jsx("input",{type:"text",placeholder:"00..."})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Fee Per Sq Meter:"}),y.jsxs("button",{children:["25 ",y.jsx(Iv,{})]})]})]}),y.jsx("div",{children:"54,908"})]}),y.jsx("button",{children:y.jsx($x,{})})]}),y.jsxs("div",{className:"generateBillItem",children:[y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"Other Fees:"}),y.jsx("span",{className:"generateBillItemValue",children:"34,909"})]}),y.jsxs("div",{className:"generateBillBreakdown",children:[y.jsx("div",{children:y.jsx("button",{children:y.jsx(Gx,{})})}),y.jsx("div",{className:"generateBillItemBreakdown",children:y.jsxs("div",{children:[y.jsx("span",{children:"Type of Fee:"}),y.jsxs("button",{children:["Land Use Fee ",y.jsx(Iv,{})]})]})}),y.jsx("div",{children:"54,908"})]}),y.jsx("button",{children:y.jsx($x,{})})]}),y.jsx("div",{className:"generateBillItem",children:y.jsxs("div",{className:"generateBillItemSummary",children:[y.jsx("span",{className:"generateBillItemName",children:"TOTAL AMOUNT:"}),y.jsx("span",{className:"generateBillItemValue",children:"346,909"})]})})]})]}):"",y.jsxs("button",{className:"primary",children:["Save ",e]})]})}function Zre(){var ce,de,Ee;const[e,n]=fe.useState(0),[a,u]=fe.useState(""),{currentUser:f,loading:w}=ma(Ne=>Ne.user),p=a==="viewBills"?"View Bills":a==="generateBill"?"Generate Bill":"Plan Info",[s,L]=fe.useState(!0),[F,G]=fe.useState(null),H=Ia(),[X,ne]=fe.useState(),[ie,se]=fe.useState(),Te=Ay();Vp();const ue=async()=>{L(!0);try{let Ne={}.VITE_SERVER;const rt=await Zi.get(`${Ne}/staffs/plan/${Te.id}`);se(f.office.some(tt=>{var Ge,_t,yt;return((_t=(Ge=rt.data.currentOffice)==null?void 0:Ge.id)==null?void 0:_t._id)===((yt=tt==null?void 0:tt.id)==null?void 0:yt._id)})||(f==null?void 0:f.isManagement)===!0),G(()=>rt.data),L(!1)}catch(Ne){let rt=Ne.response?Ne.response.data.message:Ne.message;setTimeout(()=>{ai.error(rt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})},0),L(!1)}};return fe.useEffect(()=>{ue()},[]),fe.useEffect(()=>{ue()},[X,Te.id]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Lf,{}),y.jsx(vh,{topBarData:{action:p,planNumber:F!=null&&F.planNumber?`${(de=(ce=F==null?void 0:F.dev)==null?void 0:ce.region)==null?void 0:de.substring(0,3).toUpperCase()}/${F==null?void 0:F.planNumber.value}/${new Date((Ee=F==null?void 0:F.planNumber)==null?void 0:Ee.date).getFullYear()}`:F==null?void 0:F.uniqueId},children:s?y.jsx(b_,{}):y.jsx(Ure,{setViewBills:u,state:F,reload:ne})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{isInUserOffice:ie,reload:ne,setRightBarView:n,plan:F}):y.jsx(Oy,{setRightBarView:n})})]}),y.jsx(Pu,{})]})}function nb({data:e,officeState:n,scrollSection:a,type:u,reload:f}){var s,L,F,G,H,X,ne,ie,se,Te,ue,ce;const w=ql(),p=eu();return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"listCard listFormat",onClick:()=>{p(i5({...n,scroll:a.current.scrollTop})),w(`/permit/${e==null?void 0:e._id}`,{state:e})},children:[y.jsx("span",{children:e!=null&&e.planNumber?`${(s=e==null?void 0:e.planNumber)==null?void 0:s.value} / ${new Date((L=e==null?void 0:e.planNumber)==null?void 0:L.date).getFullYear()}`:e==null?void 0:e.uniqueId}),y.jsx("span",{children:(F=e==null?void 0:e.applicant)==null?void 0:F.name}),y.jsxs("span",{children:[" ",((G=e.dev)==null?void 0:G.plotNo)&&((H=e.dev)==null?void 0:H.plotNo)+","," ",((X=e.dev)==null?void 0:X.address)&&((ie=(ne=e.dev)==null?void 0:ne.address)==null?void 0:ie.toLowerCase())]}),y.jsx("span",{children:(se=e.dev)==null?void 0:se.type}),y.jsx("span",{children:(Te=e.rep)!=null&&Te.phone&&((ue=e.rep)==null?void 0:ue.phone)!==""?"yes":"no"}),u==="current"?y.jsx("span",{children:(e==null?void 0:e.stack)||"Not Stacked"}):y.jsx("span",{children:(ce=e==null?void 0:e.dev)==null?void 0:ce.zone}),y.jsxs("div",{className:"tags",children:[(e==null?void 0:e.isFastTrack)&&y.jsx("div",{className:"fast_track",children:"ftr"}),(e==null?void 0:e.isFileOfInterest)&&y.jsx("div",{className:"file_of_interest",children:"foi"}),(e==null?void 0:e.isOldFile)&&y.jsx("div",{className:"old_file",children:"old"})]})]})})}function pA({date:e,count:n,children:a}){const[u,f]=fe.useState(!0);return y.jsxs("div",{className:"listCardContainer",children:[y.jsxs("div",{className:"listCardContainerTop",onClick:()=>f(!u),children:[y.jsxs("div",{className:"listCardContainerCount",children:[y.jsx("span",{children:$l(e,"dd MMM yyyy")}),y.jsx("span",{children:n})]}),u?y.jsx(nM,{}):y.jsx(My,{})]},Cc()),y.jsx("div",{className:u?"listCardContainerCards ":"listCardContainerCards collapsed",children:a})]})}function Om(e){return Array.isArray?Array.isArray(e):NB(e)==="[object Array]"}const Xre=1/0;function Yre(e){if(typeof e=="string")return e;let n=e+"";return n=="0"&&1/e==-Xre?"-0":n}function Kre(e){return e==null?"":Yre(e)}function Tf(e){return typeof e=="string"}function LB(e){return typeof e=="number"}function Jre(e){return e===!0||e===!1||Qre(e)&&NB(e)=="[object Boolean]"}function zB(e){return typeof e=="object"}function Qre(e){return zB(e)&&e!==null}function Uh(e){return e!=null}function MI(e){return!e.trim().length}function NB(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const ene="Incorrect 'index' type",tne=e=>`Invalid value for key ${e}`,rne=e=>`Pattern length exceeds max of ${e}.`,nne=e=>`Missing ${e} property in key`,ine=e=>`Property 'weight' in key '${e}' must be a positive integer`,ZL=Object.prototype.hasOwnProperty;class one{constructor(n){this._keys=[],this._keyMap={};let a=0;n.forEach(u=>{let f=jB(u);this._keys.push(f),this._keyMap[f.id]=f,a+=f.weight}),this._keys.forEach(u=>{u.weight/=a})}get(n){return this._keyMap[n]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function jB(e){let n=null,a=null,u=null,f=1,w=null;if(Tf(e)||Om(e))u=e,n=XL(e),a=fA(e);else{if(!ZL.call(e,"name"))throw new Error(nne("name"));const p=e.name;if(u=p,ZL.call(e,"weight")&&(f=e.weight,f<=0))throw new Error(ine(p));n=XL(p),a=fA(p),w=e.getFn}return{path:n,id:a,weight:f,src:u,getFn:w}}function XL(e){return Om(e)?e:e.split(".")}function fA(e){return Om(e)?e.join("."):e}function ane(e,n){let a=[],u=!1;const f=(w,p,s)=>{if(Uh(w))if(!p[s])a.push(w);else{let L=p[s];const F=w[L];if(!Uh(F))return;if(s===p.length-1&&(Tf(F)||LB(F)||Jre(F)))a.push(Kre(F));else if(Om(F)){u=!0;for(let G=0,H=F.length;G<H;G+=1)f(F[G],p,s+1)}else p.length&&f(F,p,s+1)}};return f(e,Tf(n)?n.split("."):n,0),u?a:a[0]}const sne={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},lne={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,n)=>e.score===n.score?e.idx<n.idx?-1:1:e.score<n.score?-1:1},cne={location:0,threshold:.6,distance:100},une={useExtendedSearch:!1,getFn:ane,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Eo={...lne,...sne,...cne,...une};const hne=/[^ ]+/g;function dne(e=1,n=3){const a=new Map,u=Math.pow(10,n);return{get(f){const w=f.match(hne).length;if(a.has(w))return a.get(w);const p=1/Math.pow(w,.5*e),s=parseFloat(Math.round(p*u)/u);return a.set(w,s),s},clear(){a.clear()}}}class MM{constructor({getFn:n=Eo.getFn,fieldNormWeight:a=Eo.fieldNormWeight}={}){this.norm=dne(a,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}setSources(n=[]){this.docs=n}setIndexRecords(n=[]){this.records=n}setKeys(n=[]){this.keys=n,this._keysMap={},n.forEach((a,u)=>{this._keysMap[a.id]=u})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Tf(this.docs[0])?this.docs.forEach((n,a)=>{this._addString(n,a)}):this.docs.forEach((n,a)=>{this._addObject(n,a)}),this.norm.clear())}add(n){const a=this.size();Tf(n)?this._addString(n,a):this._addObject(n,a)}removeAt(n){this.records.splice(n,1);for(let a=n,u=this.size();a<u;a+=1)this.records[a].i-=1}getValueForItemAtKeyId(n,a){return n[this._keysMap[a]]}size(){return this.records.length}_addString(n,a){if(!Uh(n)||MI(n))return;let u={v:n,i:a,n:this.norm.get(n)};this.records.push(u)}_addObject(n,a){let u={i:a,$:{}};this.keys.forEach((f,w)=>{let p=f.getFn?f.getFn(n):this.getFn(n,f.path);if(Uh(p)){if(Om(p)){let s=[];const L=[{nestedArrIndex:-1,value:p}];for(;L.length;){const{nestedArrIndex:F,value:G}=L.pop();if(Uh(G))if(Tf(G)&&!MI(G)){let H={v:G,i:F,n:this.norm.get(G)};s.push(H)}else Om(G)&&G.forEach((H,X)=>{L.push({nestedArrIndex:X,value:H})})}u.$[w]=s}else if(Tf(p)&&!MI(p)){let s={v:p,n:this.norm.get(p)};u.$[w]=s}}}),this.records.push(u)}toJSON(){return{keys:this.keys,records:this.records}}}function BB(e,n,{getFn:a=Eo.getFn,fieldNormWeight:u=Eo.fieldNormWeight}={}){const f=new MM({getFn:a,fieldNormWeight:u});return f.setKeys(e.map(jB)),f.setSources(n),f.create(),f}function pne(e,{getFn:n=Eo.getFn,fieldNormWeight:a=Eo.fieldNormWeight}={}){const{keys:u,records:f}=e,w=new MM({getFn:n,fieldNormWeight:a});return w.setKeys(u),w.setIndexRecords(f),w}function Hw(e,{errors:n=0,currentLocation:a=0,expectedLocation:u=0,distance:f=Eo.distance,ignoreLocation:w=Eo.ignoreLocation}={}){const p=n/e.length;if(w)return p;const s=Math.abs(u-a);return f?p+s/f:s?1:p}function fne(e=[],n=Eo.minMatchCharLength){let a=[],u=-1,f=-1,w=0;for(let p=e.length;w<p;w+=1){let s=e[w];s&&u===-1?u=w:!s&&u!==-1&&(f=w-1,f-u+1>=n&&a.push([u,f]),u=-1)}return e[w-1]&&w-u>=n&&a.push([u,w-1]),a}const ay=32;function mne(e,n,a,{location:u=Eo.location,distance:f=Eo.distance,threshold:w=Eo.threshold,findAllMatches:p=Eo.findAllMatches,minMatchCharLength:s=Eo.minMatchCharLength,includeMatches:L=Eo.includeMatches,ignoreLocation:F=Eo.ignoreLocation}={}){if(n.length>ay)throw new Error(rne(ay));const G=n.length,H=e.length,X=Math.max(0,Math.min(u,H));let ne=w,ie=X;const se=s>1||L,Te=se?Array(H):[];let ue;for(;(ue=e.indexOf(n,ie))>-1;){let tt=Hw(n,{currentLocation:ue,expectedLocation:X,distance:f,ignoreLocation:F});if(ne=Math.min(tt,ne),ie=ue+G,se){let Ge=0;for(;Ge<G;)Te[ue+Ge]=1,Ge+=1}}ie=-1;let ce=[],de=1,Ee=G+H;const Ne=1<<G-1;for(let tt=0;tt<G;tt+=1){let Ge=0,_t=Ee;for(;Ge<_t;)Hw(n,{errors:tt,currentLocation:X+_t,expectedLocation:X,distance:f,ignoreLocation:F})<=ne?Ge=_t:Ee=_t,_t=Math.floor((Ee-Ge)/2+Ge);Ee=_t;let yt=Math.max(1,X-_t+1),Et=p?H:Math.min(X+_t,H)+G,Wt=Array(Et+2);Wt[Et+1]=(1<<tt)-1;for(let mt=Et;mt>=yt;mt-=1){let nr=mt-1,Xt=a[e.charAt(nr)];if(se&&(Te[nr]=+!!Xt),Wt[mt]=(Wt[mt+1]<<1|1)&Xt,tt&&(Wt[mt]|=(ce[mt+1]|ce[mt])<<1|1|ce[mt+1]),Wt[mt]&Ne&&(de=Hw(n,{errors:tt,currentLocation:nr,expectedLocation:X,distance:f,ignoreLocation:F}),de<=ne)){if(ne=de,ie=nr,ie<=X)break;yt=Math.max(1,2*X-ie)}}if(Hw(n,{errors:tt+1,currentLocation:X,expectedLocation:X,distance:f,ignoreLocation:F})>ne)break;ce=Wt}const rt={isMatch:ie>=0,score:Math.max(.001,de)};if(se){const tt=fne(Te,s);tt.length?L&&(rt.indices=tt):rt.isMatch=!1}return rt}function gne(e){let n={};for(let a=0,u=e.length;a<u;a+=1){const f=e.charAt(a);n[f]=(n[f]||0)|1<<u-a-1}return n}class FB{constructor(n,{location:a=Eo.location,threshold:u=Eo.threshold,distance:f=Eo.distance,includeMatches:w=Eo.includeMatches,findAllMatches:p=Eo.findAllMatches,minMatchCharLength:s=Eo.minMatchCharLength,isCaseSensitive:L=Eo.isCaseSensitive,ignoreLocation:F=Eo.ignoreLocation}={}){if(this.options={location:a,threshold:u,distance:f,includeMatches:w,findAllMatches:p,minMatchCharLength:s,isCaseSensitive:L,ignoreLocation:F},this.pattern=L?n:n.toLowerCase(),this.chunks=[],!this.pattern.length)return;const G=(X,ne)=>{this.chunks.push({pattern:X,alphabet:gne(X),startIndex:ne})},H=this.pattern.length;if(H>ay){let X=0;const ne=H%ay,ie=H-ne;for(;X<ie;)G(this.pattern.substr(X,ay),X),X+=ay;if(ne){const se=H-ay;G(this.pattern.substr(se),se)}}else G(this.pattern,0)}searchIn(n){const{isCaseSensitive:a,includeMatches:u}=this.options;if(a||(n=n.toLowerCase()),this.pattern===n){let ie={isMatch:!0,score:0};return u&&(ie.indices=[[0,n.length-1]]),ie}const{location:f,distance:w,threshold:p,findAllMatches:s,minMatchCharLength:L,ignoreLocation:F}=this.options;let G=[],H=0,X=!1;this.chunks.forEach(({pattern:ie,alphabet:se,startIndex:Te})=>{const{isMatch:ue,score:ce,indices:de}=mne(n,ie,se,{location:f+Te,distance:w,threshold:p,findAllMatches:s,minMatchCharLength:L,includeMatches:u,ignoreLocation:F});ue&&(X=!0),H+=ce,ue&&de&&(G=[...G,...de])});let ne={isMatch:X,score:X?H/this.chunks.length:1};return X&&u&&(ne.indices=G),ne}}class w_{constructor(n){this.pattern=n}static isMultiMatch(n){return YL(n,this.multiRegex)}static isSingleMatch(n){return YL(n,this.singleRegex)}search(){}}function YL(e,n){const a=e.match(n);return a?a[1]:null}class _ne extends w_{constructor(n){super(n)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(n){const a=n===this.pattern;return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}class yne extends w_{constructor(n){super(n)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(n){const u=n.indexOf(this.pattern)===-1;return{isMatch:u,score:u?0:1,indices:[0,n.length-1]}}}class vne extends w_{constructor(n){super(n)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(n){const a=n.startsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[0,this.pattern.length-1]}}}class xne extends w_{constructor(n){super(n)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(n){const a=!n.startsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[0,n.length-1]}}}class bne extends w_{constructor(n){super(n)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(n){const a=n.endsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[n.length-this.pattern.length,n.length-1]}}}class wne extends w_{constructor(n){super(n)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(n){const a=!n.endsWith(this.pattern);return{isMatch:a,score:a?0:1,indices:[0,n.length-1]}}}class VB extends w_{constructor(n,{location:a=Eo.location,threshold:u=Eo.threshold,distance:f=Eo.distance,includeMatches:w=Eo.includeMatches,findAllMatches:p=Eo.findAllMatches,minMatchCharLength:s=Eo.minMatchCharLength,isCaseSensitive:L=Eo.isCaseSensitive,ignoreLocation:F=Eo.ignoreLocation}={}){super(n),this._bitapSearch=new FB(n,{location:a,threshold:u,distance:f,includeMatches:w,findAllMatches:p,minMatchCharLength:s,isCaseSensitive:L,ignoreLocation:F})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(n){return this._bitapSearch.searchIn(n)}}class UB extends w_{constructor(n){super(n)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(n){let a=0,u;const f=[],w=this.pattern.length;for(;(u=n.indexOf(this.pattern,a))>-1;)a=u+w,f.push([u,a-1]);const p=!!f.length;return{isMatch:p,score:p?0:1,indices:f}}}const mA=[_ne,UB,vne,xne,wne,bne,yne,VB],KL=mA.length,Sne=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Tne="|";function Ene(e,n={}){return e.split(Tne).map(a=>{let u=a.trim().split(Sne).filter(w=>w&&!!w.trim()),f=[];for(let w=0,p=u.length;w<p;w+=1){const s=u[w];let L=!1,F=-1;for(;!L&&++F<KL;){const G=mA[F];let H=G.isMultiMatch(s);H&&(f.push(new G(H,n)),L=!0)}if(!L)for(F=-1;++F<KL;){const G=mA[F];let H=G.isSingleMatch(s);if(H){f.push(new G(H,n));break}}}return f})}const Ine=new Set([VB.type,UB.type]);class Cne{constructor(n,{isCaseSensitive:a=Eo.isCaseSensitive,includeMatches:u=Eo.includeMatches,minMatchCharLength:f=Eo.minMatchCharLength,ignoreLocation:w=Eo.ignoreLocation,findAllMatches:p=Eo.findAllMatches,location:s=Eo.location,threshold:L=Eo.threshold,distance:F=Eo.distance}={}){this.query=null,this.options={isCaseSensitive:a,includeMatches:u,minMatchCharLength:f,findAllMatches:p,ignoreLocation:w,location:s,threshold:L,distance:F},this.pattern=a?n:n.toLowerCase(),this.query=Ene(this.pattern,this.options)}static condition(n,a){return a.useExtendedSearch}searchIn(n){const a=this.query;if(!a)return{isMatch:!1,score:1};const{includeMatches:u,isCaseSensitive:f}=this.options;n=f?n:n.toLowerCase();let w=0,p=[],s=0;for(let L=0,F=a.length;L<F;L+=1){const G=a[L];p.length=0,w=0;for(let H=0,X=G.length;H<X;H+=1){const ne=G[H],{isMatch:ie,indices:se,score:Te}=ne.search(n);if(ie){if(w+=1,s+=Te,u){const ue=ne.constructor.type;Ine.has(ue)?p=[...p,...se]:p.push(se)}}else{s=0,w=0,p.length=0;break}}if(w){let H={isMatch:!0,score:s/w};return u&&(H.indices=p),H}}return{isMatch:!1,score:1}}}const gA=[];function Ane(...e){gA.push(...e)}function _A(e,n){for(let a=0,u=gA.length;a<u;a+=1){let f=gA[a];if(f.condition(e,n))return new f(e,n)}return new FB(e,n)}const bS={AND:"$and",OR:"$or"},yA={PATH:"$path",PATTERN:"$val"},vA=e=>!!(e[bS.AND]||e[bS.OR]),Pne=e=>!!e[yA.PATH],Mne=e=>!Om(e)&&zB(e)&&!vA(e),JL=e=>({[bS.AND]:Object.keys(e).map(n=>({[n]:e[n]}))});function $B(e,n,{auto:a=!0}={}){const u=f=>{let w=Object.keys(f);const p=Pne(f);if(!p&&w.length>1&&!vA(f))return u(JL(f));if(Mne(f)){const L=p?f[yA.PATH]:w[0],F=p?f[yA.PATTERN]:f[L];if(!Tf(F))throw new Error(tne(L));const G={keyId:fA(L),pattern:F};return a&&(G.searcher=_A(F,n)),G}let s={children:[],operator:w[0]};return w.forEach(L=>{const F=f[L];Om(F)&&F.forEach(G=>{s.children.push(u(G))})}),s};return vA(e)||(e=JL(e)),u(e)}function kne(e,{ignoreFieldNorm:n=Eo.ignoreFieldNorm}){e.forEach(a=>{let u=1;a.matches.forEach(({key:f,norm:w,score:p})=>{const s=f?f.weight:null;u*=Math.pow(p===0&&s?Number.EPSILON:p,(s||1)*(n?1:w))}),a.score=u})}function Rne(e,n){const a=e.matches;n.matches=[],Uh(a)&&a.forEach(u=>{if(!Uh(u.indices)||!u.indices.length)return;const{indices:f,value:w}=u;let p={indices:f,value:w};u.key&&(p.key=u.key.src),u.idx>-1&&(p.refIndex=u.idx),n.matches.push(p)})}function Dne(e,n){n.score=e.score}function One(e,n,{includeMatches:a=Eo.includeMatches,includeScore:u=Eo.includeScore}={}){const f=[];return a&&f.push(Rne),u&&f.push(Dne),e.map(w=>{const{idx:p}=w,s={item:n[p],refIndex:p};return f.length&&f.forEach(L=>{L(w,s)}),s})}class O0{constructor(n,a={},u){this.options={...Eo,...a},this.options.useExtendedSearch,this._keyStore=new one(this.options.keys),this.setCollection(n,u)}setCollection(n,a){if(this._docs=n,a&&!(a instanceof MM))throw new Error(ene);this._myIndex=a||BB(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(n){Uh(n)&&(this._docs.push(n),this._myIndex.add(n))}remove(n=()=>!1){const a=[];for(let u=0,f=this._docs.length;u<f;u+=1){const w=this._docs[u];n(w,u)&&(this.removeAt(u),u-=1,f-=1,a.push(w))}return a}removeAt(n){this._docs.splice(n,1),this._myIndex.removeAt(n)}getIndex(){return this._myIndex}search(n,{limit:a=-1}={}){const{includeMatches:u,includeScore:f,shouldSort:w,sortFn:p,ignoreFieldNorm:s}=this.options;let L=Tf(n)?Tf(this._docs[0])?this._searchStringList(n):this._searchObjectList(n):this._searchLogical(n);return kne(L,{ignoreFieldNorm:s}),w&&L.sort(p),LB(a)&&a>-1&&(L=L.slice(0,a)),One(L,this._docs,{includeMatches:u,includeScore:f})}_searchStringList(n){const a=_A(n,this.options),{records:u}=this._myIndex,f=[];return u.forEach(({v:w,i:p,n:s})=>{if(!Uh(w))return;const{isMatch:L,score:F,indices:G}=a.searchIn(w);L&&f.push({item:w,idx:p,matches:[{score:F,value:w,norm:s,indices:G}]})}),f}_searchLogical(n){const a=$B(n,this.options),u=(s,L,F)=>{if(!s.children){const{keyId:H,searcher:X}=s,ne=this._findMatches({key:this._keyStore.get(H),value:this._myIndex.getValueForItemAtKeyId(L,H),searcher:X});return ne&&ne.length?[{idx:F,item:L,matches:ne}]:[]}const G=[];for(let H=0,X=s.children.length;H<X;H+=1){const ne=s.children[H],ie=u(ne,L,F);if(ie.length)G.push(...ie);else if(s.operator===bS.AND)return[]}return G},f=this._myIndex.records,w={},p=[];return f.forEach(({$:s,i:L})=>{if(Uh(s)){let F=u(a,s,L);F.length&&(w[L]||(w[L]={idx:L,item:s,matches:[]},p.push(w[L])),F.forEach(({matches:G})=>{w[L].matches.push(...G)}))}}),p}_searchObjectList(n){const a=_A(n,this.options),{keys:u,records:f}=this._myIndex,w=[];return f.forEach(({$:p,i:s})=>{if(!Uh(p))return;let L=[];u.forEach((F,G)=>{L.push(...this._findMatches({key:F,value:p[G],searcher:a}))}),L.length&&w.push({idx:s,item:p,matches:L})}),w}_findMatches({key:n,value:a,searcher:u}){if(!Uh(a))return[];let f=[];if(Om(a))a.forEach(({v:w,i:p,n:s})=>{if(!Uh(w))return;const{isMatch:L,score:F,indices:G}=u.searchIn(w);L&&f.push({score:F,key:n,value:w,idx:p,norm:s,indices:G})});else{const{v:w,n:p}=a,{isMatch:s,score:L,indices:F}=u.searchIn(w);s&&f.push({score:L,key:n,value:w,norm:p,indices:F})}return f}}O0.version="7.0.0";O0.createIndex=BB;O0.parseIndex=pne;O0.config=Eo;O0.parseQuery=$B;Ane(Cne);function Lne({children:e}){var Xt;const{officeData:n}=ma(Ht=>Ht.app);fe.useState(!0);const[a,u]=fe.useState(n.type||"current"),[f,w]=fe.useState([]),[p,s]=fe.useState(n.endDate||new Date().toISOString().slice(0,10)),[L,F]=fe.useState(n.startDate||new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),[G,H]=fe.useState(""),[X,ne]=fe.useState([]),[ie,se]=fe.useState([]),Te=eu(),ce=Vp().state,[de,Ee]=fe.useState(!0),[Ne,rt]=fe.useState(),[tt,Ge]=fe.useState(!1);fe.useState([]);const _t=Ia(),[yt,Et]=fe.useState();fe.useState(),fe.useState();const Wt=fe.useRef(),Ar=(Ht,Qt,sr)=>{if(!Ht)return[];let Tr={};Ht.forEach(vn=>{var hi,Vn,Oi;let wi=sr?(Vn=(hi=vn.currentOffice)==null?void 0:hi.date)==null?void 0:Vn.split("T")[0]:(Oi=vn.minuteDate)==null?void 0:Oi.split("T")[0];Tr[wi]?Tr[wi].items.push(vn):Tr[wi]={date:wi,items:[vn]}});let ln;return Qt?ln=Object.values(Tr).sort((vn,wi)=>new Date(vn.date)-new Date(wi.date)):ln=Object.values(Tr).sort((vn,wi)=>new Date(wi.date)-new Date(vn.date)),ln},mt=async()=>{Zi.defaults.withCredentials=!0;try{let Ht={}.VITE_SERVER,Qt;a!=="current"?Qt=await Zi.get(`${Ht}/staffs/office/${ce.id._id}/${a}?dateFrom=${L}&dateTo=${p}`,{withCredentials:!0}):Qt=await Zi.get(`${Ht}/staffs/office/${ce.id._id}/${a}`,{withCredentials:!0}),Ee(!1),rt(Qt.data);let sr;a==="current"?sr=Ar(Qt.data,tt,!0):sr=Ar(Qt.data,tt,!1),w(sr),Te(i5({active:!0,type:a,data:Qt.data,listArray:sr,startDate:L,endDate:p,searchQuery:G,searchResult:X,searchData:ie,sort:tt}))}catch(Ht){w([]),rt([]);let Qt=Ht.response?Ht.response.data.message:Ht.message;setTimeout(()=>{ai.error(Qt,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:_t})},0),Ee(!1)}};fe.useEffect(()=>{Ee(!0),n.active?(rt(n.data),u(n.type),w(n.listArray),F(n.startDate),s(n.endDate),H(n.searchQuery),ne(n.searchResult),Et(()=>[]),Ee(!1)):mt()},[a,p,L]),fe.useEffect(()=>{n.scroll&&Wt.current.scrollTo({top:n.scroll})},[yt]);const nr={includeScore:!0,includeMatches:!0,threshold:.2,keys:["uniqueId","planNumber.value","planNumber.fullValue","applicant.name","applicant.email","applicant.phone","rep.name","rep.phone","dev.address","dev.plotNo","dev.name","dev.type","dev.use","dev.lga"]};return fe.useEffect(()=>{if(G.length===0){ne(null);return}const sr=new O0(Ne,nr).search(G).map(Tr=>Tr.item);se(sr),ne(a==="current"?Ar(sr,tt,!0):Ar(sr,tt,!1))},[G]),y.jsxs("div",{className:"listWrapper",children:[y.jsxs("div",{className:"listQuery",children:[y.jsx("div",{className:"listQueryOptions",children:y.jsxs("select",{name:"listQueryOption",id:"listQueryOption",defaultValue:a,onChange:Ht=>{Te(r_()),u(Ht.target.value)},children:[y.jsx("option",{value:"current",children:"Current"}),y.jsx("option",{value:"incoming",children:"Incoming"}),y.jsx("option",{value:"Outgoing",children:"Outgoing"})]})}),a!=="current"&&y.jsxs("div",{className:"listQueryDate",children:[y.jsxs("div",{className:"listQueryDateWrapper",children:[y.jsx("label",{htmlFor:"listQueryDateStart",children:"From:"}),y.jsx("input",{type:"date",name:"listQueryDateStart",id:"listQueryDateStart",value:L,onChange:Ht=>{Te(r_()),F(Ht.target.value)}})]}),y.jsxs("div",{className:"listQueryDateWrapper",children:[y.jsx("label",{htmlFor:"listQueryDateEnd",children:"To:"}),y.jsx("input",{type:"date",name:"listQueryDateEnd",id:"listQueryDateEnd",value:p,onChange:Ht=>{Te(r_()),s(Ht.target.value)}})]})]}),y.jsxs("div",{className:"querySearchBar",children:[y.jsx("input",{value:G,onChange:Ht=>{H(Ht.target.value)},type:"text",placeholder:`Search ${(Xt=ce==null?void 0:ce.id)==null?void 0:Xt.name.toLowerCase()} record...`}),G&&y.jsxs("div",{className:"searchBarCloseButton",onClick:()=>H(""),children:[" ",y.jsx(Mc,{})]})]}),y.jsxs("div",{className:"listCount",children:[y.jsx("span",{children:"Count:"}),!G&&y.jsx("span",{children:(Ne==null?void 0:Ne.length)||"0"}),G&&y.jsx("span",{children:(ie==null?void 0:ie.length)||"0"})]}),y.jsxs("div",{className:"listSort",onClick:()=>{Ge(!tt),w(Ar(Ne,!tt,a==="current"))},children:[y.jsx("span",{children:tt?"Old to New":"New to Old"}),tt?y.jsx(nM,{}):y.jsx(My,{})]})]}),G&&y.jsx("div",{className:"searchHeader",children:y.jsx("p",{children:"Search Results"})}),y.jsxs("div",{className:"listHeader listFormat",children:[y.jsx("span",{children:"PlanNo"}),y.jsx("span",{children:"File Name"}),y.jsx("span",{children:"Location"}),y.jsx("span",{children:"Property Type"}),y.jsx("span",{children:"Has Rep"}),y.jsx("span",{children:"Zone / stk"})]}),y.jsx("div",{className:G?"listCardContainerWrapper Search":"listCardContainerWrapper",ref:Wt,children:de?y.jsx("div",{className:"loading",children:y.jsx(b_,{})}):y.jsxs(y.Fragment,{children:[((f==null?void 0:f.length)===0||G&&(X==null?void 0:X.length)===0)&&y.jsx("p",{className:"empty",children:"No Data Found..."}),!G&&f.map((Ht,Qt)=>y.jsx(pA,{date:Ht.date,count:Ht.items.length,children:Ht.items.toReversed().map((sr,Tr)=>y.jsx(nb,{data:sr,type:a,officeState:{active:!0,type:a,data:Ne,listArray:f,startDate:L,endDate:p,searchQuery:G,searchResult:X,searchData:ie,sort:tt},scrollSection:Wt},Cc()))},Qt)),G&&(X==null?void 0:X.map((Ht,Qt)=>y.jsx(pA,{date:Ht.date,count:Ht.items.length,children:Ht.items.map((sr,Tr)=>y.jsx(nb,{data:sr,type:a,officeState:{active:!0,type:a,data:Ne,listArray:f,startDate:L,endDate:p,searchQuery:G,searchResult:X,searchData:ie,sort:tt},scrollSection:Wt},Cc()))},Cc())))]})})]})}function QL({data:e}){var n;return y.jsxs(H5,{children:[y.jsx(K5,{className:"dropdown-button",children:y.jsx("span",{children:e.title})}),y.jsx(h4,{className:"dropdown",slotProps:{listbox:{className:"dropdown-listbox"}},children:(n=e==null?void 0:e.items)==null?void 0:n.map(a=>y.jsx(m2,{disabled:(a==null?void 0:a.disabled)||!1,className:`dropdown-item ${(a==null?void 0:a.disabled)&&"disabled"}`,onClick:()=>a==null?void 0:a.action(),children:y.jsx("span",{children:a==null?void 0:a.text})},Cc()))})]})}function GB(){var ie,se,Te;eu();const n=Vp().state,{officeData:a}=ma(ue=>ue.app),{currentUser:u}=ma(ue=>ue.user),f=fe.useRef();function w(){var ue,ce,de,Ee;return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"exportPDF",ref:f,children:[y.jsx("img",{alt:"",src:"/assets/logos/Logo-Mpphurd.png",className:"watermark"}),y.jsxs("table",{className:"report-container",children:[y.jsx("thead",{className:"report-header",children:y.jsx("tr",{children:y.jsx("th",{className:"report-header-cell",children:y.jsxs("div",{className:"header",children:[y.jsxs("div",{className:"header-info",children:[y.jsxs("div",{className:"header-info-left",children:[y.jsxs("div",{className:"header-logos",children:[y.jsx("img",{className:"header-logo",src:"/assets/logos/Logo-Edo State.png",alt:""}),y.jsx("div",{}),y.jsx("img",{className:"header-logo",src:"/assets/logos/Logo-Mpphurd.png",alt:""})]}),y.jsxs("div",{className:"header-text",children:[y.jsxs("span",{className:"header-text-office",children:[(ue=n==null?void 0:n.id)==null?void 0:ue.name," OFFICE RECORD"]}),y.jsxs("div",{children:[y.jsx("span",{className:"header-text-type",children:(ce=a==null?void 0:a.type)==null?void 0:ce.toUpperCase()}),y.jsx("span",{className:"header-text-date",children:(a==null?void 0:a.type)!=="current"&&y.jsxs(y.Fragment,{children:["(",$l(a==null?void 0:a.startDate,"dd/MM/yyyy")," ","- ",$l(a==null?void 0:a.endDate,"dd/MM/yyyy"),")"]})})]})]})]}),y.jsxs("div",{className:"header-info-right",children:[y.jsxs("span",{className:"header-text-total",children:["Total - ",(de=a==null?void 0:a.data)==null?void 0:de.length]}),y.jsxs("span",{className:"header-text-printdate",children:["Printed on ",$l(new Date,"dd/MM/yyyy, HH:mm")]})]})]}),y.jsx("div",{className:"header-rule"}),y.jsxs("div",{className:"listHeader listFormat",children:[y.jsx("span",{children:"Plan No"}),y.jsx("span",{children:"File Name"}),y.jsx("span",{children:"Location"}),y.jsx("span",{children:"Property Type"}),y.jsx("span",{children:"Has Rep"}),y.jsx("span",{children:"Zone / stk"})]})]})})})}),y.jsx("tfoot",{className:"report-footer",children:y.jsx("tr",{children:y.jsx("td",{className:"report-footer-cell",children:y.jsx("div",{className:"footer-info",children:y.jsxs("div",{className:"page-footer",children:[y.jsx("div",{className:"footer-rule"}),y.jsx("div",{children:y.jsx("p",{children:"Ministry of Physical Planning, Housing, Urban and Regional Development."})})]})})})})}),y.jsx("tbody",{className:"report-content",children:y.jsx("tr",{children:y.jsx("td",{className:"report-content-cell",children:y.jsx("div",{className:"main",children:(Ee=a==null?void 0:a.listArray)==null?void 0:Ee.map((Ne,rt)=>y.jsx(pA,{date:Ne.date,count:Ne.items.length,children:Ne.items.toReversed().map((tt,Ge)=>y.jsx(nb,{data:tt,type:a==null?void 0:a.type},Cc()))},rt))})})})})]})]})})}const p=(ie=u==null?void 0:u.office)==null?void 0:ie.some(ue=>{var ce,de;return((ce=n==null?void 0:n.id)==null?void 0:ce._id)===((de=ue==null?void 0:ue.id)==null?void 0:de._id)&&ue.tasks.includes("EXPORT DATA")}),s=eB.useReactToPrint({content:()=>f.current,documentTitle:`${(se=n==null?void 0:n.id)==null?void 0:se.name}_OFFICE_RECORD_${(Te=a==null?void 0:a.type)==null?void 0:Te.toUpperCase()}${(a==null?void 0:a.type)!=="current"?`__${$l(a==null?void 0:a.startDate,"dd-MM-yyyy")}_to_
				  ${$l(a==null?void 0:a.endDate,"dd-MM-yyyy")}`:""}`,removeAfterPrint:!0,suppressErrors:!0}),[L,F]=fe.useState(),[G,H]=fe.useState(),X=()=>n.id.name.toUpperCase()==="ASSESSMENT";let ne=X()?{action:n.id.name+" Office",options:y.jsx(QL,{disable:!0,data:{title:"Export Data",items:[{text:"Download PDF Format",disabled:!p,action:p?s:()=>null},{text:"Download CSV Format",disabled:!0,action:()=>null}]}}),lastPlanNo:G}:{action:n.id.name+" Office",options:y.jsx(QL,{disable:!0,data:{title:"Export Data",items:[{text:"Download PDF Format",disabled:!p,action:p?s:()=>null},{text:"Download CSV Format",disabled:!0,action:()=>null}]}})};return fe.useEffect(()=>{const ue=async()=>{try{let ce={}.VITE_SERVER;const de=await Zi.get(`${ce}/staffs/plan/last-plan-number`);H(de.data)}catch{}};X()&&ue()},[L]),y.jsxs(y.Fragment,{children:[w(),y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(Of,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Lf,{selected:"office"})}),y.jsx("div",{className:"OfficeMiddleBar",children:y.jsx(vh,{topBarData:ne,children:y.jsx(Lne,{state:n})})})]})]})]})}function xA(){var rt,tt;const[e,n]=fe.useState(0),[a,u]=fe.useState([]),[f,w]=fe.useState(),[p,s]=fe.useState(),[L,F]=fe.useState(),[G,H]=fe.useState(),{currentUser:X}=ma(Ge=>Ge.user),ne=Ay(),[ie,se]=fe.useState([]),Te=ql(),ce=Vp().state,de=Ia(),Ee=eu(),Ne=async Ge=>{Ge.preventDefault(),w(!0);const _t=new FormData(Ge.target),yt={status:_t.get("minuteStatus"),text:_t.get("minuteText"),proposedActions:_t.get("proposedActions"),newOfficeId:_t.get("minuteToOfficer")};Zi.defaults.withCredentials=!0;try{let Et={}.VITE_SERVER;const Wt=await Zi.post(`${Et}/staffs/plan/${ce._id}/minute`,yt,{withCredentials:!0});w(!1),Ee(r_()),Te(-2),setTimeout(()=>{ai.success(Wt.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})},200)}catch(Et){w(!1);let Wt=Et.response?Et.response.data.message:Et.message;ai.error(Wt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})}};return fe.useEffect(()=>{Zi.defaults.withCredentials=!0,(async()=>{try{let _t={}.VITE_SERVER;const yt=await Promise.all([Zi.get(`${_t}/staffs/office/all`,{withCredentials:!0}),Zi.get(`${_t}/staffs/staff/all`,{withCredentials:!0}),Zi.get(`${_t}/staffs/plan/${ne.id}`)]),Et=yt[0].data,Wt=yt[1].data,Ar=yt[2].data;F(Ar),H(X.office.some(nr=>{var Xt,Ht,Qt;return((Ht=(Xt=Ar.currentOffice)==null?void 0:Xt.id)==null?void 0:Ht._id)===((Qt=nr==null?void 0:nr.id)==null?void 0:Qt._id)})||(X==null?void 0:X.isManagement)===!0);let mt=Et.map(nr=>{if(nr._id===ce.currentOffice.id._id)return;let Xt=Wt.filter(Qt=>Qt.office.some(sr=>sr.id===nr._id)),Ht;return Xt.length===0?Ht=`${nr.name}`:Xt.length>1?Ht=`${nr.name} (Multiple)`:Ht=`${nr.name} (${Xt[0].fullName})`,{office:nr,officeId:nr._id,text:Ht}});u(mt.sort((nr,Xt)=>{const Ht=nr.text.toUpperCase(),Qt=Xt.text.toUpperCase();return Ht<Qt?-1:Ht>Qt?1:0}))}catch(_t){_t.response?_t.response.data.message:_t.message}})()},[]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Lf,{selected:"home"}),y.jsx(vh,{topBarData:{action:"Minute Plan",planNumber:ce!=null&&ce.planNumber?`${ce==null?void 0:ce.dev.region.substring(0,3).toUpperCase()}/${ce==null?void 0:ce.planNumber.value}/${new Date(ce==null?void 0:ce.planNumber.date).getFullYear()}`:ce==null?void 0:ce.uniqueId},children:y.jsxs("div",{children:[y.jsx("div",{className:"minuteItems",children:y.jsxs("form",{action:"",onSubmit:Ne,children:[y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteStatus",children:"Status:"}),y.jsxs("select",{required:!0,name:"minuteStatus",id:"minuteStatus",children:[y.jsx("option",{value:"",children:"..."}),J4.map(Ge=>y.jsx("option",{value:Ge,children:Ge}))]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteText",children:"Comment:"}),y.jsx("textarea",{required:!0,name:"minuteText",id:"minuteText",cols:"30",rows:"10"})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("span",{children:"Proposed Actions"}),y.jsxs("div",{className:"minuteItemActions",children:[ie.map((Ge,_t)=>{const yt=Cc();return y.jsxs("div",{className:"minuteItemAction",children:[y.jsx("button",{type:"button",onClick:()=>{let Et=[...ie];Et.splice(_t,1),se(Et)},children:"-"}),y.jsx("span",{children:_t+1}),y.jsx("input",{id:"proposedAction"+(_t+1),name:"proposedAction"+(_t+1),type:"text",value:ie[_t],onChange:Et=>{let Wt=[...ie];Wt[_t]=Et.target.value,se(Wt)}})]},yt)}),y.jsx("button",{type:"button",onClick:()=>{let Ge=[...ie];Ge.push(""),se(Ge)},children:"+"})]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("span",{children:"Select Officer/Office:"}),y.jsxs("select",{required:!0,name:"minuteToOfficer",id:"minuteToOfficer",children:[y.jsx("option",{value:""}),((tt=(rt=L==null?void 0:L.currentOffice)==null?void 0:rt.id)==null?void 0:tt.name.toUpperCase())==="CLEARING HOUSE"?a.map(Ge=>{if((Ge==null?void 0:Ge.office.name)==="ASSESSMENT")return y.jsx("option",{value:Ge.officeId,children:Ge.text},Ge.officeId)}):a.map(Ge=>{if(Ge!=null&&Ge.officeId)return y.jsx("option",{value:Ge.officeId,children:Ge.text},Ge.officeId)})]})]}),y.jsx("button",{type:"submit",className:"primary",children:f?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Minute Plan"})]})}),y.jsx(Pu,{})]})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{isInUserOffice:G,reload:s,setRightBarView:n,plan:ce}):y.jsx(Oy,{setRightBarView:n})})]})]})}function bA(){const[e,n]=fe.useState(0);return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Lf,{selected:"home"}),y.jsx(vh,{topBarData:{action:"Create New Bill",planNumber:"BC/3421/2023"},children:y.jsx(Hre,{})}),y.jsx(Ry,{children:!e===1?y.jsx(Dy,{setRightBarView:n}):y.jsx(Oy,{setRightBarView:n})})]})]})}function wA(){const[e,n]=fe.useState(0),[a,u]=fe.useState(),[f,w]=fe.useState(),[p,s]=fe.useState(),{currentUser:L}=ma(G=>G.user),F=Ay();return fe.useEffect(()=>{Zi.defaults.withCredentials=!0,(async()=>{try{let H={}.VITE_SERVER;const X=await Zi.get(`${H}/staffs/plan/${F.id}`);u(X.data),s(L.office.some(ne=>{var ie,se,Te;return((se=(ie=X.data.currentOffice)==null?void 0:ie.id)==null?void 0:se._id)===((Te=ne==null?void 0:ne.id)==null?void 0:Te._id)})||(L==null?void 0:L.isManagement)===!0)}catch(H){H.response?H.response.data.message:H.message}})()},[f]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Lf,{selected:"home"}),y.jsx(vh,{topBarData:{action:"View Bills",planNumber:(a!=null&&a.planNumber?`${a==null?void 0:a.dev.region.substring(0,3).toUpperCase()}/${a==null?void 0:a.planNumber.value}/${new Date(a==null?void 0:a.planNumber.date).getFullYear()}`:a==null?void 0:a.uniqueId)+" (This Feature Is In Development...)"},children:y.jsx(tB,{})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{isInUserOffice:p,reload:w,setRightBarView:n,plan:a}):y.jsx(Oy,{setRightBarView:n})})]})]})}function ez(){const[e,n]=fe.useState(!1),{currentAdmin:a,loading:u}=ma(H=>H.admin),f=eu(),w=ql();ma(H=>H.app);const p=Ia(),s=fe.useRef(),L=fe.useRef(),F={}.VITE_TIMEOUT;Zi.interceptors.request.use(H=>(H.timeout=F,H.signal=AbortSignal.timeout(F),H)),Zi.interceptors.response.use(H=>H,H=>((H.code==="ECONNABORTED"||H.code==="ERR_CANCELED")&&(H.message="Request timed out"),Promise.reject(H))),Zi.defaults.withCredentials=!0;const G=async H=>{H.preventDefault(),f($K());try{let X={}.VITE_SERVER;const ne=await Zi.post(`${X}/staffs/auth/admin_login`,{email:s.current.value,password:L.current.value});f(GK(ne.data)),w("/"),setTimeout(()=>{ai.success("Login Successful",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:p})},200)}catch(X){let ne=X.response?X.response.data.message:X.message;ai.error(ne,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:p}),f(qK())}};return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"login",children:[y.jsx("div",{className:"login__background"}),y.jsx("section",{className:"login__header",children:y.jsxs("div",{className:"login__formBackground",children:[y.jsxs("section",{className:"app-cover__info",children:[y.jsxs("div",{className:"app-cover__info-top",children:[y.jsx("div",{className:"app-cover__info__logo",children:y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:"MPPHURD Logo"})}),y.jsx("h1",{children:"M-FLOW / ADMIN"})]}),y.jsx("h2",{children:"ministry of physical planning, housing, urban and regional development app"}),y.jsxs("p",{children:["For a simplified, efficient and automated ",y.jsx("br",{}),y.jsxs("span",{className:"app-cover__info--highlight",children:["Workflow ",y.jsx("span",{className:"app-cover__info--svg"})]}),"of the Ministry"]})]}),y.jsxs("form",{action:"#",className:"login__form",onSubmit:G,children:[y.jsx("div",{className:"form-logo"}),y.jsx("p",{className:"form-greeting",children:"Login to continue as Admin"}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"email",children:"Email"}),y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(iM,{className:"formIcon"})}),y.jsx("input",{type:"email",name:"email",id:"email",placeholder:"Enter your email address",required:!0,ref:s})]})]}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"password",children:"Password"}),y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(cS,{className:"formIcon"})}),y.jsx("input",{type:e?"text":"password",name:"password",id:"password",placeholder:"Enter your password",required:!0,ref:L}),y.jsx("span",{className:"btn",onClick:()=>n(!e),children:e?y.jsx(hS,{className:"formIcon"}):y.jsx(uS,{className:"formIcon"})})]})]}),y.jsx("p",{}),y.jsx("button",{type:"submit",className:"btn btn-form-submit",disabled:u,children:u?y.jsx(kc,{thickness:5,size:25,sx:{color:"white"}}):"Login Admin"}),y.jsx(Pu,{})]})]})}),y.jsxs("footer",{className:"login__footer",children:[y.jsx("div",{className:"login__footer--copyright",children:y.jsxs("div",{children:["© ",new Date().getFullYear()," Copyright MPPHURD"]})}),y.jsxs("div",{className:"login__footer--mda",children:[y.jsxs("div",{className:"login__footer--logos",children:[y.jsx("div",{className:"login__footer--logo",children:y.jsx("img",{src:"/assets/logos/Logo-Edo State.png",alt:"Edo State Logo"})}),y.jsx("div",{className:"login__footer--logo",children:y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:"MPPHURD Logo"})})]}),y.jsx("div",{className:"login__footer--text",children:"EDO STATE MINISTRY OF PHYSICAL PLANNING, HOUSING, URBAN AND REGIONAL DEVELOPMENT"})]}),y.jsxs("div",{className:"login__footer--social",children:[y.jsxs("div",{className:"login__socialIcons",children:[y.jsx(j5,{className:"btn login__socialIcon"}),y.jsx(B5,{className:"btn login__socialIcon"}),y.jsx(q5,{className:"btn login__socialIcon"})]}),y.jsx("div",{className:"login__socialText",children:y.jsx("p",{children:"Follow On Social Media"})})]})]})]})})}function zm(){const[e,n]=fe.useState(""),[a,u]=fe.useState([]),[f,w]=fe.useState(!1),[p,s]=fe.useState(!1),{currentAdmin:L,loading:F}=ma(ie=>ie.admin),G=L;eu();const H=Ia();fe.useState(!0),fe.useState(null),fe.useState(),fe.useState(!1);const X=ie=>{s(!0),n(ie.target.value)},ne=()=>{w(!1)};return fe.useEffect(()=>{s(!0);const ie=async()=>{try{let Te={}.VITE_SERVER;const ue=await Zi.get(`${Te}/admin/plan?search=${e}`,{withCredentials:!0});u(ue.data),s(!1)}catch(Te){let ue=Te.response?Te.response.data.message:Te.message;s(!1),ai.error(ue,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})}};let se=setTimeout(()=>{e&&ie()},1500);return()=>clearTimeout(se)},[e]),y.jsxs("div",{className:"admin headerContainer",children:[y.jsx("div",{className:"headerLeft",children:y.jsx(a_,{to:"/",children:y.jsxs("span",{className:"headerLogo",children:[y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:""}),y.jsx("div",{}),y.jsx("p",{children:"MPPHURD / ADMIN"})]})})}),y.jsx("div",{className:"headerSearch headerMiddle",children:y.jsx(f4,{onClickAway:ne,children:y.jsxs("div",{className:"searchBar",children:[y.jsx("label",{htmlFor:"headerSearchInput",children:y.jsx($5,{className:"searchIcon"})}),y.jsx("input",{id:"headerSearchInput",type:"text",placeholder:"Start typing to search",className:"searchInput",onChange:ie=>X(ie),onFocus:()=>w(!0),value:e}),e&&y.jsxs("div",{className:"searchBarCloseButton",onClick:()=>n(""),children:[" ",y.jsx(Mc,{})]}),e&&f&&y.jsxs("div",{className:"searchResult",children:[y.jsxs("header",{children:[p&&y.jsx(N4,{}),y.jsxs("div",{className:"searchResultTitle",children:[y.jsx("h2",{children:"Search Results"}),y.jsxs("div",{children:[y.jsx("span",{children:a.length||0}),y.jsx("span",{children:"Found"})]})]})]}),y.jsxs("section",{children:[a==null?void 0:a.map(ie=>y.jsx(m4,{data:ie,changeOpen:w},ie._id)),a.length<1&&y.jsx("div",{children:"No Result Found"})]})]})]})})}),y.jsxs("div",{className:"headerRight",children:[y.jsx("div",{className:"headerLinks",children:y.jsx(p4,{})}),y.jsxs("div",{className:"headerIcons",children:[y.jsxs("div",{className:"headerIconItem",children:[y.jsx(V5,{className:"notificationIcon"}),y.jsx("span",{className:"headerIconBadge",children:"3"})]}),y.jsxs("div",{className:"headerIconItem",children:[y.jsx(N5,{className:"emailIcon"}),y.jsx("span",{className:"headerIconBadge",children:"5"})]})]}),y.jsxs("div",{className:"headerUser",children:[y.jsxs("div",{className:"headerDetails",children:[y.jsx("span",{className:"headerName",children:`${G.firstName} ${G.lastName}`}),y.jsx("span",{className:"headerOffice",children:`${G.position}`})]}),y.jsx("img",{src:G.profilePicture||"/assets/persons/no_avatar.png",alt:"",className:"headerImg"})]})]})]})}function Nm({selected:e}){const n=eu(),a=ql();ma(w=>w.app);const u=Ia(),f=()=>{n(H4()),a("/login"),setTimeout(()=>{ai.success("Logout Successful",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:u})},0)};return y.jsx("div",{className:"sideBar",children:y.jsxs("div",{className:"sideBarWrapper",children:[y.jsxs("ul",{className:"sideBarList",children:[y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/",children:[y.jsx(z5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText ",children:"Dashboard"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/staffs",children:[y.jsx(mH,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Staff"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/offices",children:[y.jsx(L5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Offices"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/regions",children:[y.jsx(yH,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Regions"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/permit",children:[y.jsx(G5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Permit"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/public",children:[y.jsx(vH,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Public Users"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/activities",children:[y.jsx(O5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Activities"})]})}),y.jsx("li",{children:y.jsxs(Iu,{className:"sideBarListItem",to:"/analysis",children:[y.jsx(U5,{className:"sideBarIcon"}),y.jsx("span",{className:"sideBarListItemText",children:"Analysis"})]})})]}),y.jsxs("div",{className:"sideBarLogout",onClick:f,children:[y.jsx(F5,{className:"sideBarIcon"}),y.jsx("span",{children:"Log Out"})]}),y.jsx(Pu,{})]})})}const Zw=["load","mousemove","mousedown","click","scroll","keypress"];let tz=0;function zne(){const{currentAdmin:e,loading:n}=ma(F=>F.admin),a=Ia(),u=eu();ql(),fe.useState(!0),fe.useState(null),fe.useState(),fe.useState(!1),fe.useState(0);let f;const w=()=>{f&&clearTimeout(f)};fe.useEffect(()=>{if(e)return Object.values(Zw).forEach(F=>{window.addEventListener(F,()=>{w(),p()})}),()=>{w(),Object.values(Zw).forEach(F=>{window.removeEventListener(F,w)})}});const p=()=>{const F={}.VITE_ADMIN_LOGOUT_TIMER;e?f=setTimeout(()=>{w(),tz===1&&ai.error("Session Timeout",{position:"top-right",autoClose:2500,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:a}),Object.values(Zw).forEach(G=>{window.removeEventListener(G,w)}),tz++,u(H4()),window.location.reload()},1e3*60*F):(w(),Object.values(Zw).forEach(G=>{window.removeEventListener(G,w)}))},s=()=>{const G=sB(new Date);let H;return G>=5&&G<12?H="Good Morning":G>=12&&G<18?H="Good Afternoon":H="Good Evening",`${H} ${e==null?void 0:e.firstName} (Admin)`},L=()=>`${$l(new Date,"EEEE, MMMM do, yyyy")}`;return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(zm,{}),y.jsxs("div",{className:"homeContainer",children:[y.jsx(Nm,{}),y.jsxs("div",{className:"homePage",children:[y.jsxs("div",{className:"home__greetings",children:[y.jsx("span",{children:s()}),y.jsx("span",{children:L()})]}),y.jsx(ub,{})]})]})]})}function Vo(e){const n=e.data;return y.jsx(y.Fragment,{children:n.map(a=>{var u,f;return y.jsxs(a_,{className:"adminStaffListCard",to:"./staff",state:{data:a},children:[y.jsx("span",{className:"adminStaffListCard__avatar",children:y.jsx("img",{src:a.profilePicture||"/assets/persons/no_avatar.png",alt:"avatar"})}),y.jsx("span",{className:"adminStaffListCard__name",children:[a.title,a.firstName,a.middleName,a.lastName,a.prefix].filter(function(w){return w!==null&&w!==""&&w!==void 0}).join(" ")}),y.jsx("span",{className:"adminStaffListCard__email",children:a.email}),y.jsx("span",{className:"adminStaffListCard__phone",children:a.phone}),y.jsx("span",{className:"adminStaffListCard__region",children:(u=a.region)==null?void 0:u.name}),y.jsx("span",{className:"adminStaffListCard__office",children:(f=a.office)==null?void 0:f.map((w,p)=>{var s;return y.jsx("span",{children:(s=w==null?void 0:w.id)==null?void 0:s.name},p)})}),y.jsx("span",{className:"adminStaffListCard__title",children:a.jobTitle}),y.jsx("span",{className:a.isActive?"adminStaffListCard__status active":"adminStaffListCard__status inactive",children:y.jsx("span",{children:a.isActive?"Active":"Inactive"})})]},a._id)})})}function kM({...e}){const[n,a]=fe.useState(!1),[u,f]=fe.useState(!0),[w,p]=fe.useState(!1),[s,L]=fe.useState(!1),[F,G]=fe.useState(!1),[H,X]=fe.useState(""),[ne,ie]=fe.useState(""),[se,Te]=fe.useState(!0),[ue,ce]=fe.useState(null),[de,Ee]=fe.useState({firstName:"",title:"",middleName:"",lastName:"",suffix:""}),[Ne,rt]=fe.useState({}),[tt,Ge]=fe.useState(""),[_t,yt]=fe.useState(void 0),[Et,Wt]=fe.useState({}),[Ar,mt]=fe.useState(void 0),[nr,Xt]=fe.useState(void 0),[Ht,Qt]=fe.useState([]),[sr,Tr]=fe.useState(void 0),[ln,vn]=fe.useState([]),[wi,hi]=fe.useState([]),[Vn,Oi]=fe.useState([]),fn=Ia(),Nn=async()=>{var Zr;if(a(!0),G(!0),ie(((Zr=e==null?void 0:e.data)==null?void 0:Zr.profilePicture)||"/assets/persons/no_avatar.png"),await(async()=>{var qr;try{let sn={}.VITE_SERVER,qn=await Zi.get(`${sn}/admin/office`);const _i=(await qn.data).filter(Pi=>Pi.isActive===!0);vn(_i.sort((Pi,rr)=>{const Me=Pi.name.toUpperCase(),qe=rr.name.toUpperCase();return Me<qe?-1:Me>qe?1:0}));const zi=await((qr=qn.data.filter((Pi,rr,Me)=>Me.findIndex(qe=>qe.region._id===Pi.region._id)===rr))==null?void 0:qr.map(Pi=>Pi.region));Tr(zi[0]),hi(zi)}catch(sn){let qn=sn.response?sn.response.data.message:sn.message;ai.error(qn,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:fn})}})(),e.modalType==="edit"){const qr={...e.data};ce(qr),f(qr.isActive),p(qr.isManagement),X(qr.profilePicture),Ee({title:qr.title,firstName:qr.firstName,middleName:qr.middleName,lastName:qr.lastName,suffix:qr.suffix}),Ge(qr.gender),yt(qr.address),rt({phone:qr.phone,phone1:qr.phone1}),Wt({email:qr.email,email1:qr.email1}),Xt(qr.jobTitle),mt(qr.position),Tr(qr.region),Oi(qr.office)}G(!1)},Pt=()=>{f(null),p(null),X(null),Ee({}),rt({}),Ge(""),yt(""),Wt({}),mt(void 0),Xt(""),Qt([]),Tr(void 0),vn([]),hi([]),Oi([]),L(!1),a(!1)},Dt="Escape",Ir="keyup";xr(Pt);function xr(fr){const Zr=fe.useCallback(qr=>{qr.key===Dt&&fr()},[fr]);fe.useEffect(()=>(document.addEventListener(Ir,Zr,!1),()=>{document.removeEventListener(Ir,Zr,!1)}),[Zr])}fe.useEffect(()=>{const fr=document.querySelector(".adminStaffEditModal");return fr&&(n?fr.showModal():fr.close()),()=>{}},[n]);const Kt=fr=>{fr.target.files&&fr.target.files[0]&&(X(fr.target.files[0]),ie(URL.createObjectURL(fr.target.files[0])),new FormData().append("my-image-file",fr.target.files[0],fr.target.files[0].name))},Cn=async()=>{L(!0);let fr={};fr.password=Cc(),fr.isActive=u,fr.isManagement=w,fr.title=de.title,fr.firstName=de.firstName,fr.middleName=de.middleName,fr.lastName=de.lastName,fr.suffix=de.suffix,fr.gender=tt,fr.address=_t,fr.phone=Ne.phone,fr.phone1=Ne.phone1,fr.email=Et.email,fr.email1=Et.email1,fr.jobTitle=nr,fr.position=Ar,fr.region=sr,fr.office=Vn;try{let Zr={}.VITE_SERVER,qr=await Zi.post(`${Zr}/admin/staff`,fr);Pt(),e.setReload(()=>[]),setTimeout(()=>{ai.success(qr.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:fn})},0)}catch(Zr){L(!1);let qr=Zr.response?Zr.response.data.message:Zr.message;ai.error(qr,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:fn})}},gn=async fr=>{L(!0);let Zr={};Zr.isActive=u,Zr.isManagement=w,Zr.title=de.title,Zr.firstName=de.firstName,Zr.middleName=de.middleName,Zr.lastName=de.lastName,Zr.suffix=de.suffix,Zr.gender=tt,Zr.address=_t,Zr.phone=Ne.phone,Zr.phone1=Ne.phone1,Zr.email=Et.email,Zr.email1=Et.email1,Zr.jobTitle=nr,Zr.position=Ar,Zr.region=sr,Zr.office=Vn;try{let qr={}.VITE_SERVER,sn=await Zi.put(`${qr}/admin/staff/${fr._id}`,Zr);e.setReload(()=>[]),L(!1),a(!1),setTimeout(()=>{ai.success(sn.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:fn})},0)}catch(qr){L(!1);let sn=qr.response?qr.response.data.message:qr.message;ai.error(sn,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:fn})}};return y.jsxs(y.Fragment,{children:[y.jsxs("button",{className:e.buttonClass,onClick:Nn,children:[e.buttonIcon,e.buttonName]}),n&&y.jsx("dialog",{className:"modalView adminStaffEditModal ",children:F?y.jsx("div",{className:"loading-container",children:y.jsx(kc,{thickness:3,size:55,className:"loading-icon"})}):y.jsxs(y.Fragment,{children:[y.jsxs("header",{children:[y.jsx("span",{children:"Staff Info"}),y.jsx("div",{className:"modalViewCloseButton",onClick:Pt,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:fr=>{fr.preventDefault(),e.modalType==="edit"?gn(ue):Cn()},children:[y.jsxs("div",{className:"inputStaffHeader",children:[y.jsxs("div",{className:"staffImage",onMouseEnter:()=>Te(!0),onMouseLeave:()=>Te(!1),children:[se&&H&&y.jsx("div",{className:"clearPhotoButton",children:y.jsx(Mc,{className:"clearPhotoIcon",onClick:()=>X(null)})}),y.jsxs("label",{htmlFor:"staffMeansOfIdentification",className:"uploadImageWrapper",children:[H?y.jsx("img",{src:ne,alt:""}):y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(sH,{fontSize:"large"})}),y.jsx("span",{children:"Select Image"})]}),y.jsx("input",{type:"file",name:"staffMeansOfIdentification",id:"staffMeansOfIdentification",accept:"image/png, image/jpeg, image/jpg",onChange:Kt})]})]}),y.jsxs("div",{className:"inputStaffHeaderRight",children:[y.jsxs("div",{children:[y.jsx("span",{children:"Active Status:"}),y.jsx(Ey,{toggled:u,label:"isActive",onClick:f})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Management Staff:"}),y.jsx(Ey,{toggled:w,label:"isManagement",onClick:p})]})]})]}),y.jsx("div",{className:"applicationForm",children:y.jsx("div",{className:"applicationInputWrapper",children:y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Staff Personal Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemName",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffTitle",children:"Title:"}),y.jsx("input",{type:"text",name:"staffTitle",id:"staffTitle",value:de.title,onChange:fr=>{let Zr=fr.target.value,qr={...de};qr.title=Zr,Ee(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffFirstName",children:"First name:"}),y.jsx("input",{type:"text",name:"staffFirstName",id:"staffFirstName",required:!0,min:2,value:de==null?void 0:de.firstName,onChange:fr=>{let Zr=fr.target.value,qr={...de};qr.firstName=Zr,Ee(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffSurname",children:"Surname:"}),y.jsx("input",{type:"text",name:"staffSurname",id:"staffSurname",required:!0,min:2,value:de==null?void 0:de.lastName,onChange:fr=>{let Zr=fr.target.value,qr={...de};qr.lastName=Zr,Ee(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffOtherName",children:"Other name:"}),y.jsx("input",{type:"text",name:"staffOtherName",id:"staffOtherName",min:2,value:de==null?void 0:de.middleName,onChange:fr=>{let Zr=fr.target.value,qr={...de};qr.middleName=Zr,Ee(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffSuffix",children:"Suffix:"}),y.jsx("input",{type:"text",name:"staffSuffix",id:"staffSuffix",value:de==null?void 0:de.suffix,onChange:fr=>{let Zr=fr.target.value,qr={...de};qr.suffix=Zr,Ee(qr)}})]})]})}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"staffGender",children:"Gender:"}),y.jsxs("div",{className:"radioBoxWrapper",children:[y.jsxs("label",{htmlFor:"staffGender1",children:[y.jsx("span",{children:"Female"}),y.jsx("input",{type:"radio",name:"gender",value:"female",id:"staffGender1",defaultChecked:tt==="female",onChange:fr=>Ge(fr.target.value)})]}),y.jsxs("label",{htmlFor:"staffGender2",children:[y.jsx("span",{children:"Male"}),y.jsx("input",{type:"radio",name:"gender",value:"male",id:"staffGender2",defaultChecked:tt==="male",onChange:fr=>Ge(fr.target.value)})]})]})]}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemPhone",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffPhone1",children:"Phone 1:"}),y.jsx("input",{type:"tel",name:"staffPhone1",id:"staffPhone1",value:Ne==null?void 0:Ne.phone,onChange:fr=>{let Zr=fr.target.value,qr={...Ne};qr.phone=Zr,rt(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffPhone2",children:"Phone 2:"}),y.jsx("input",{type:"tel",name:"staffPhone1",id:"staffPhone2",value:Ne==null?void 0:Ne.phone1,onChange:fr=>{let Zr=fr.target.value,qr={...Ne};qr.phone1=Zr,rt(qr)}})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemEmail",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffOfficialEmail",children:"Official Email:"}),y.jsx("input",{type:"email",id:"staffOfficialEmail",required:!0,min:10,max:50,value:Et.email,onChange:fr=>{let Zr=fr.target.value,qr={...Et};qr.email=Zr,Wt(qr)}})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffAlternativeEmail",children:"Alternative Email:"}),y.jsx("input",{type:"email",id:"staffAlternativeEmail",required:!0,min:10,max:50,value:Et.email1,onChange:fr=>{let Zr=fr.target.value,qr={...Et};qr.email1=Zr,Wt(qr)}})]})]})}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemLocation",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffDesignation",children:"Designation:"}),y.jsxs("select",{defaultValue:nr,onChange:fr=>Xt(fr.target.value),name:"staffDesignation",id:"staffDesignation",children:[y.jsx("option",{value:"",children:"----"}),tJ.map(fr=>y.jsx("option",{value:fr,children:fr}))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffPosition",children:"Position:"}),y.jsxs("select",{defaultValue:Ar,onChange:fr=>mt(fr.target.value),name:"staffPosition",id:"staffPosition",children:[y.jsx("option",{value:"",children:"----"}),rJ.map(fr=>y.jsx("option",{value:fr,children:fr}))]})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"staffEditRegion",children:"Region:"}),y.jsx("select",{name:"staffEditRegion",id:"staffEditRegion",defaultValue:sr==null?void 0:sr._id,onChange:fr=>{const Zr=wi.find(qr=>qr._id===fr.target.value);ln.find(qr=>qr.region._id===fr.target.value),Tr(Zr),Oi([])},children:wi==null?void 0:wi.map((fr,Zr)=>y.jsx("option",{data:Zr,value:fr._id,children:fr.name},Zr))})]})]})}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"",children:"Office and Tasks"}),y.jsxs("div",{className:"inputStaffOfficeWrapper",children:[y.jsx("div",{className:"inputStaffOfficeList",children:Vn==null?void 0:Vn.map((fr,Zr)=>{var qr,sn,qn,Li;return y.jsxs("div",{className:"inputStaffOffice",children:[y.jsx("button",{type:"button",onClick:()=>{let _i=[...Vn];_i.splice(Zr,1),Oi(_i)},children:"Del"}),y.jsxs("div",{children:[y.jsx("label",{children:"Office"}),y.jsx("select",{name:"staffEditOffice",id:"staffEditOffice",defaultValue:(qr=fr==null?void 0:fr.id)==null?void 0:qr._id,onChange:_i=>{let zi=[...Vn];zi[Zr].id=ln.find(Pi=>Pi._id===_i.target.value),Oi(()=>zi)},children:ln==null?void 0:ln.map((_i,zi)=>{var Pi;if(((Pi=_i==null?void 0:_i.region)==null?void 0:Pi._id)===(sr==null?void 0:sr._id))return y.jsx("option",{data:_i._id,value:_i._id,children:_i.name},_i._id)})})]}),y.jsxs("div",{children:[y.jsx("label",{children:"Tasks"}),y.jsx("div",{className:"taskList",children:(qn=(sn=fr.id)==null?void 0:sn.tasks)==null?void 0:qn.map((_i,zi)=>{var Pi,rr;return y.jsxs("span",{children:[y.jsx("input",{type:"checkbox",name:`staffEditTasks${_i+zi}`,value:(Pi=fr.id)==null?void 0:Pi.tasks[zi],id:`staffEditTasks${Zr+"-"+zi}`,defaultChecked:(rr=fr==null?void 0:fr.tasks)==null?void 0:rr.includes(_i),onChange:Me=>{var cr;const{value:qe,checked:at}=Me.target;let $t=[...Vn];at?($t[Zr].tasks=[...(cr=$t[Zr])==null?void 0:cr.tasks,qe],Oi(()=>$t)):($t[Zr].tasks=$t[Zr].tasks.filter(br=>br!==qe),Oi(()=>$t))}}),y.jsx("label",{htmlFor:`staffEditTasks${Zr+"-"+zi}`,children:_i})]},_i+zi)})})]})]},`${(Li=fr==null?void 0:fr.id)==null?void 0:Li._id}${Zr}`)})}),y.jsx("button",{type:"button",onClick:()=>{let fr=[...Vn];fr.push({}),fr[Vn.length].id=ln.find(Zr=>{var qr;return((qr=Zr==null?void 0:Zr.region)==null?void 0:qr._id)===(sr==null?void 0:sr._id)}),fr[Vn.length].tasks=[],Oi(fr)},children:"Add"})]})]})]})]})})}),y.jsx("footer",{children:y.jsx("button",{disabled:s,type:"submit",className:"primary",children:s?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):e.modalType==="edit"?"Update":"Save"})})]})]})})]})}function Nne(){const[e,n]=fe.useState(!0),[a,u]=fe.useState(null),f=Ia(),[w,p]=fe.useState();return fe.useEffect(()=>{(async()=>{try{let L={}.VITE_SERVER;const F=await Zi.get(`${L}/admin/staff`);u(F.data),n(!1)}catch(L){let F=L.response?L.response.data.message:L.message;setTimeout(()=>{ai.error(F,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:f})},0),n(!1)}})()},[w]),new Date().toISOString().slice(0,10),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(zm,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Nm,{selected:"office"})}),y.jsxs("div",{className:"OfficeMiddleBar",children:[y.jsxs(vh,{topBarData:{action:"Staff List",options:y.jsx(kM,{buttonIcon:y.jsx(oM,{}),buttonClass:"addStaffButton primary",buttonName:"Add New Staff",setReload:p,modalType:"new"})},children:[e&&y.jsx(b_,{}),a&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"listQuery",children:[y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"STATUS: "}),y.jsxs("select",{defaultValue:"active",name:"listQueryOption",id:"listQueryOption",children:[y.jsx("option",{value:"active",children:"Active"}),y.jsx("option",{value:"inactive",children:"Inactive"})]})]}),y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"REGION: "}),y.jsx("select",{name:"listQueryOption",id:"listQueryOption",children:y.jsx("option",{value:"incoming",children:"Benin"})})]}),y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"DESIGNATION: "}),y.jsx("select",{name:"listQueryOption",id:"listQueryOption"})]}),y.jsx("div",{children:y.jsx("input",{type:"text",placeholder:"Search list..."})}),y.jsxs("div",{className:"listCount",children:[y.jsx("span",{children:"Count:"}),y.jsx("span",{children:a.length})]}),y.jsxs("div",{className:"listSort",children:[y.jsx("span",{children:"Latest to Oldest"}),y.jsx(My,{})]})]}),y.jsxs("div",{className:"adminStaffListHeader",children:[y.jsx("span",{className:"adminStaffListHeader__avatar",children:"Photo"}),y.jsx("span",{className:"adminStaffListHeader__name",children:" Name"}),y.jsx("span",{className:"adminStaffListHeader__email",children:"Email"}),y.jsx("span",{className:"adminStaffListHeader__phone",children:"Phone"}),y.jsx("span",{className:"adminStaffListHeader__region",children:"Region"}),y.jsx("span",{className:"adminStaffListHeader__office",children:"Office"}),y.jsx("span",{className:"adminStaffListHeader__designation",children:"Designation"}),y.jsx("span",{className:"adminStaffListHeader__status",children:"Status"})]}),y.jsx("div",{className:"adminStaffListCardWrapper",children:y.jsx(Vo,{data:a})})]})]}),y.jsx(Pu,{})]})]})]})]})}function jne(){var X,ne;const[e,n]=fe.useState(!0),[a,u]=fe.useState({}),[f,w]=fe.useState(!0),[p,s]=fe.useState(!1),[L,F]=fe.useState(),{state:G}=Vp(),H=Ia();return fe.useEffect(()=>{(async()=>{try{let se={}.VITE_SERVER;const Te=await Zi.get(`${se}/admin/staff/${G.data._id}`);u(()=>Te.data),n(!1)}catch(se){let Te=se.response?se.response.data.message:se.message;setTimeout(()=>{ai.error(Te,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:H})},0),n(!1)}})()},[L]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(zm,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Nm,{selected:"office"})}),y.jsx("div",{className:"OfficeMiddleBar",children:y.jsxs(vh,{topBarData:{action:"Staff View",options:y.jsx(kM,{buttonIcon:y.jsx(oM,{}),buttonClass:"addStaffButton primary",buttonName:"Update Staff",data:a,setReload:F,modalType:"edit"})},children:[e&&y.jsx(b_,{}),!e&&y.jsxs("div",{className:"staffView",children:[y.jsxs("div",{className:"staffViewHeader",children:[y.jsxs("div",{children:[y.jsxs("h2",{children:[" ",[a.title,a.firstName,a.middleName,a.lastName,a.prefix].filter(function(ie){return ie!==null&&ie!==""&&ie!==void 0}).join(" ")," "]}),y.jsx("h4",{children:(X=a.jobTitle)==null?void 0:X.fullName}),(ne=a.office)==null?void 0:ne.map((ie,se)=>{var Te;return y.jsxs("h4",{children:[" ",(Te=ie==null?void 0:ie.id)==null?void 0:Te.name]},se)}),y.jsx("p",{children:"Department of Development Control+"}),y.jsxs("div",{children:[y.jsx("span",{children:"Official Email:"}),y.jsx("span",{children:a.email})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Alt Email:"}),y.jsx("span",{children:a.email1})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Phone:"}),y.jsx("span",{children:a.phone})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Gender:"}),y.jsx("span",{children:a.gender})]})]}),y.jsx("div",{className:"staffImage",children:y.jsx("label",{htmlFor:"staffMeansOfIdentification",className:"uploadImageWrapper",children:y.jsx("img",{src:a.profilePicture||"/assets/persons/no_avatar.png",alt:"photo"})})})]}),y.jsxs("div",{className:"inputStaffHeaderRight",children:[y.jsxs("div",{children:[y.jsx("span",{children:"Active Status:"}),y.jsx(Ey,{toggled:a.isActive,label:"isActive",onClick:w})]}),y.jsxs("div",{children:[y.jsx("span",{children:"Management Staff:"}),y.jsx(Ey,{toggled:a.isManagement,label:"isManagement",onClick:s})]})]})]})]})})]})]})]})}function rz({...e}){var Ar;const[n,a]=fe.useState(!1),[u,f]=fe.useState(null),[w,p]=fe.useState([]),[s,L]=fe.useState(!1),[F,G]=fe.useState(!0),[H,X]=fe.useState(void 0),[ne,ie]=fe.useState(void 0),[se,Te]=fe.useState(void 0),[ue,ce]=fe.useState([]),de=Ia(),[Ee,Ne]=fe.useState(null),rt=()=>{p(e.region),e.modalType==="edit"?(f(e.data),G(e.data.isActive),X(e.data.name),ie(e.data.region),Te(e.data.zone),ce(e.data.tasks),G(e.data.isActive)):ie(e.region[0]),a(!0)},tt=()=>{L(!1),a(!1),X(void 0),ie(void 0),Te(void 0),ce([])},Ge="Escape",_t="keyup";yt(tt);function yt(mt){const nr=fe.useCallback(Xt=>{Xt.key===Ge&&mt()},[mt]);fe.useEffect(()=>(document.addEventListener(_t,nr,!1),()=>{document.removeEventListener(_t,nr,!1)}),[nr])}fe.useEffect(()=>{const mt=document.querySelector(".adminOfficeEditModal");return mt&&(n?mt.showModal():mt.close()),()=>{}},[n]);const Et=async()=>{L(!0);let mt={};mt.isActive=F,H&&(mt.name=H),ne&&(mt.region=ne._id),se&&(mt.zone=se),ue&&(mt.tasks=ue.filter(nr=>nr!==""));try{let nr={}.VITE_SERVER,Xt=await Zi.post(`${nr}/admin/office`,mt);tt(),e.setReload(()=>[]),setTimeout(()=>{ai.success(Xt.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})},0)}catch(nr){L(!1);let Xt=nr.response?nr.response.data.message:nr.message;ai.error(Xt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})}},Wt=async()=>{L(!0);let mt={};mt.isActive=F,H&&(mt.name=H),ne&&(mt.region=ne._id),se&&(mt.zone=se),ue&&(mt.tasks=ue.filter(nr=>nr!==""));try{let nr={}.VITE_SERVER,Xt=await Zi.put(`${nr}/admin/office/${u._id}`,mt);L(!1),a(!1),e.setReload(()=>[]),setTimeout(()=>{ai.success(Xt.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})},0)}catch(nr){L(!1);let Xt=nr.response?nr.response.data.message:nr.message;ai.error(Xt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})}};return y.jsxs(y.Fragment,{children:[y.jsxs("button",{className:e.buttonClass,onClick:rt,children:[e.buttonIcon,e.buttonName]}),n&&y.jsxs("dialog",{className:"modalView adminOfficeEditModal ",children:[y.jsxs("header",{children:[y.jsx("span",{children:e.modalType==="add"?"Create New Office":e.modalType==="edit"?"Edit Office Info":""}),y.jsx("div",{className:"modalViewCloseButton",onClick:tt,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsx("div",{className:"applicationForm",children:y.jsx("div",{className:"applicationInputWrapper",children:y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsxs("div",{className:"inputStaffHeader",children:[y.jsx("div",{className:"inputStaffHeaderLeft",children:y.jsx("div",{children:y.jsx("span",{children:"Active Status:"})})}),y.jsx("div",{className:"inputStaffHeaderRight",children:y.jsx("div",{children:y.jsx(Ey,{toggled:F,label:"isActive",onClick:G})})})]}),y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Office Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"adminEditOfficeName",children:"Office Name:"}),y.jsx("input",{type:"text",name:"adminEditOfficeName",id:"adminEditOfficeName",value:H,onChange:mt=>X(mt.target.value.toUpperCase())})]}),y.jsx("div",{className:"applicationItem",children:y.jsxs("div",{className:"applicationItemType",children:[y.jsxs("div",{children:[y.jsx("label",{htmlFor:"adminEditOfficeRegion",children:"Region:"}),y.jsx("select",{name:"adminEditOfficeRegion",id:"adminEditOfficeRegion",defaultValue:ne==null?void 0:ne._id,onChange:mt=>{const nr=w.find(Xt=>Xt._id===mt.target.value);ie(nr)},children:w==null?void 0:w.map((mt,nr)=>y.jsx("option",{data:nr,value:mt._id,children:mt.name},nr))})]}),y.jsxs("div",{children:[y.jsx("label",{htmlFor:"adminEditOfficeZone",children:"Zone:"}),y.jsxs("select",{name:"adminEditOfficeZone",id:"adminEditOfficeZone",defaultValue:se||"",children:[(Ar=ne==null?void 0:ne.zones)==null?void 0:Ar.map(mt=>y.jsx("option",{value:mt,children:mt})),y.jsx("option",{value:"",children:"----"})]})]})]})}),y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Tasks"})}),ue==null?void 0:ue.map((mt,nr)=>y.jsxs("div",{className:"applicationItem zones",onMouseEnter:()=>Ne(nr),onMouseLeave:()=>Ne(!1),children:[Ee===nr&&y.jsx("div",{className:"removeItemButton",children:y.jsx(Mc,{className:"clearPhotoIcon",onClick:()=>{let Xt=[...ue];Xt.splice(nr,1),ce(Xt)}})}),y.jsxs("label",{htmlFor:"adminEditOfficeTaskCount",children:[nr+1," :"]}),y.jsxs("select",{name:"adminEditOfficeTaskCount",id:"adminEditOfficeTaskCount",defaultValue:ue[nr],onChange:Xt=>{let Ht=[...ue];Ht[nr]=Xt.target.value.toUpperCase().trim(),ce(Ht)},children:[y.jsx("option",{value:""}),JK.map(Xt=>y.jsx("option",{value:Xt,children:Xt}))]})]},nr)),y.jsx("button",{onClick:()=>{let mt=[...ue];mt.push(""),ce(mt)},children:"Add"})]})]})})}),y.jsx("footer",{children:y.jsx("button",{disabled:s,onClick:e.modalType==="edit"?Wt:Et,className:"primary",children:s?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):e.modalType==="edit"?"Update":"Save"})})]})]})}function Bne(){const[e,n]=fe.useState(!0),[a,u]=fe.useState(),[f,w]=fe.useState([]),[p,s]=fe.useState([]),L=Ia(),[F,G]=fe.useState(),H=ql();return fe.useEffect(()=>{(async()=>{try{let ne={}.VITE_SERVER;const ie=await Promise.all([Zi.get(`${ne}/admin/office`),Zi.get(`${ne}/admin/staff`),Zi.get(`${ne}/admin/region`)]);u(ie[0].data),w(ie[1].data),s(ie[2].data),n(!1)}catch(ne){let ie=ne.response?ne.response.data.message:ne.message;setTimeout(()=>{ai.error(ie,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:L})},0),n(!1)}})()},[F]),new Date().toISOString().slice(0,10),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(zm,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Nm,{selected:"office"})}),y.jsx("div",{className:"OfficeMiddleBar",children:y.jsxs(vh,{topBarData:{action:"Office List",options:y.jsx(rz,{modalType:"add",buttonIcon:y.jsx(lH,{}),buttonClass:"addStaffButton primary",buttonName:"Create Office",setReload:G,region:p})},children:[e&&y.jsx(b_,{}),a&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"listQuery",children:[y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"REGION: "}),y.jsx("select",{name:"listQueryOption",id:"listQueryOption",children:y.jsx("option",{value:"incoming",children:"Benin"})})]}),y.jsx("div",{children:y.jsx("input",{type:"text",placeholder:"Search list..."})}),y.jsxs("div",{className:"listCount",children:[y.jsx("span",{children:"Count:"}),y.jsx("span",{children:a.length})]}),y.jsxs("div",{className:"listSort",children:[y.jsx("span",{children:"Latest to Oldest"}),y.jsx(My,{})]})]}),y.jsxs("div",{className:"adminStaffListHeader",children:[y.jsx("span",{className:"adminOfficeListHeader__name",children:" Name"}),y.jsx("span",{className:"adminOfficeListHeader__staff",children:"Staff"}),y.jsx("span",{className:"adminOfficeListHeader__tasks",children:"Tasks"}),y.jsx("span",{className:"adminOfficeListHeader__region",children:"Region"}),y.jsx("span",{className:"adminOfficeListHeader__status",children:"Status"}),y.jsx("span",{className:"adminOfficeListHeader__edit",children:"Edit"})]}),y.jsx("div",{className:"adminStaffListCardWrapper",children:a.map(X=>{var ne;return y.jsxs("div",{className:" adminOfficeListCard",children:[y.jsx("div",{className:"adminOfficeListCard__name",children:X.name}),y.jsx("div",{className:"adminOfficeListCard__staff",children:f.filter(ie=>ie.office.some(se=>{var Te;return((Te=se==null?void 0:se.id)==null?void 0:Te._id)===(X==null?void 0:X._id)})).map((ie,se)=>y.jsx("span",{onClick:()=>{H("/staffs/staff",{state:{data:ie}})},children:[ie.title,ie.firstName,ie.middleName,ie.lastName,ie.prefix].filter(Te=>Te!=null&&Te!==""&&Te!==void 0).join(" ")},se))}),y.jsx("div",{className:"adminOfficeListCard__tasks",children:X.tasks.map(ie=>ie.split(" ").map(ue=>ue.charAt(0).toUpperCase()+ue.slice(1)).join(" "))}),y.jsx("div",{className:"adminOfficeListCard__region",children:(ne=X==null?void 0:X.region)==null?void 0:ne.name}),y.jsx("div",{className:X.isActive?"adminOfficeListCard__status active":"adminOfficeListCard__status inactive",children:X.isActive?"Active":"Inactive"}),y.jsx("div",{className:"adminOfficeListCard__edit",children:y.jsx(rz,{className:"adminOfficeListCardEditButton",buttonName:"Edit",modalType:"edit",setReload:G,data:X,region:p})})]},X._id)})})]})]})})]})]})]})}function Fne(){return new Date().toISOString().slice(0,10),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(zm,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Nm,{selected:"office"})}),y.jsx("div",{className:"OfficeMiddleBar",children:y.jsxs(vh,{topBarData:{action:"Staff List",options:y.jsx(kM,{buttonIcon:y.jsx(oM,{}),buttonClass:"addStaffButton primary",buttonName:"Add New Staff"})},children:[y.jsxs("div",{className:"listQuery",children:[y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"STATUS: "}),y.jsxs("select",{name:"listQueryOption",id:"listQueryOption",children:[y.jsx("option",{value:"active",selected:!0,children:"Active"}),y.jsx("option",{value:"inactive",children:"Inactive"})]})]}),y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"REGION: "}),y.jsxs("select",{name:"listQueryOption",id:"listQueryOption",children:[y.jsx("option",{value:"incoming",children:"Incoming"}),y.jsx("option",{value:"Outgoing",children:"Outgoing"}),y.jsx("option",{value:"current",children:"Current"})]})]}),y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"DESIGNATION: "}),y.jsxs("select",{name:"listQueryOption",id:"listQueryOption",children:[y.jsx("option",{value:"incoming",children:"Incoming"}),y.jsx("option",{value:"Outgoing",children:"Outgoing"}),y.jsx("option",{value:"current",children:"Current"}),y.jsx("option",{value:"current",children:"Current"}),y.jsx("option",{value:"current",children:"Current"}),y.jsx("option",{value:"current",children:"Current"}),y.jsx("option",{value:"current",children:"Current"})]})]}),y.jsx("div",{children:y.jsx("input",{type:"text",placeholder:"Search list..."})}),y.jsxs("div",{className:"listCount",children:[y.jsx("span",{children:"Count:"}),y.jsx("span",{children:"78,867"})]}),y.jsxs("div",{className:"listSort",children:[y.jsx("span",{children:"Latest to Oldest"}),y.jsx(My,{})]})]}),y.jsxs("div",{className:"adminStaffListHeader",children:[y.jsx("span",{className:"adminStaffListHeader__avatar",children:"Photo"}),y.jsx("span",{className:"adminStaffListHeader__name",children:" Name"}),y.jsx("span",{className:"adminStaffListHeader__email",children:"Email"}),y.jsx("span",{className:"adminStaffListHeader__phone",children:"Phone"}),y.jsx("span",{className:"adminStaffListHeader__region",children:"Region"}),y.jsx("span",{className:"adminStaffListHeader__office",children:"Office"}),y.jsx("span",{className:"adminStaffListHeader__designation",children:"Designation"}),y.jsx("span",{className:"adminStaffListHeader__status",children:"Status"})]}),y.jsxs("div",{className:"adminStaffListCardWrapper",children:[y.jsx(Vo,{}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{}),y.jsx(Vo,{}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{active:!0}),y.jsx(Vo,{}),y.jsx(Vo,{}),y.jsx(nb,{}),y.jsx(nb,{})]})]})})]})]})]})}function nz({...e}){const[n,a]=fe.useState(!1),[u,f]=fe.useState(!0),[w,p]=fe.useState(!1),[s,L]=fe.useState(null),[F,G]=fe.useState(void 0),[H,X]=fe.useState(void 0),[ne,ie]=fe.useState([]),[se,Te]=fe.useState(null),ue=Ia(),ce=()=>{a(!0),e.modalType==="edit"&&(L(e.data),G(e.data.name),X(e.data.code),ie(e.data.zones),f(e.data.isActive))},de=()=>{p(!1),a(!1),G(void 0),X(void 0),ie([])},Ee="Escape",Ne="keyup";rt(de);function rt(_t){const yt=fe.useCallback(Et=>{Et.key===Ee&&_t()},[_t]);fe.useEffect(()=>(document.addEventListener(Ne,yt,!1),()=>{document.removeEventListener(Ne,yt,!1)}),[yt])}fe.useEffect(()=>{const _t=document.querySelector(".adminStaffEditModal");return _t&&(n?_t.showModal():_t.close()),()=>{}},[n]);const tt=async()=>{p(!0);let _t={};_t.isActive=u,H&&(_t.code=H),F&&(_t.name=F),ne&&(_t.zones=ne.filter(yt=>yt!==""));try{let yt={}.VITE_SERVER,Et=await Zi.post(`${yt}/admin/region`,_t);de(),e.setReload(()=>[]),setTimeout(()=>{ai.success(Et.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ue})},0)}catch(yt){p(!1);let Et=yt.response?yt.response.data.message:yt.message;ai.error(Et,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ue})}},Ge=async()=>{p(!0);let _t={};_t.isActive=u,H&&(_t.code=H),F&&(_t.name=F),ne&&(_t.zones=ne.filter(yt=>yt!==""));try{let yt={}.VITE_SERVER,Et=await Zi.put(`${yt}/admin/region/${s._id}`,_t);p(!1),a(!1),e.setReload(()=>[]),setTimeout(()=>{ai.success(Et.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ue})},0)}catch(yt){p(!1);let Et=yt.response?yt.response.data.message:yt.message;ai.error(Et,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:ue})}};return y.jsxs(y.Fragment,{children:[y.jsxs("button",{className:e.buttonClass,onClick:ce,children:[e.buttonIcon,e.buttonName]}),n&&y.jsxs("dialog",{className:"modalView adminStaffEditModal adminRegionEditModal ",children:[y.jsxs("div",{children:[y.jsxs("header",{children:[y.jsx("span",{children:e.modalType==="add"?"Create New Region":e.modalType==="edit"?"Edit Region Info":""}),y.jsx("div",{className:"modalViewCloseButton",onClick:de,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("div",{className:"inputStaffHeader",children:[y.jsx("div",{className:"inputStaffHeaderLeft",children:y.jsx("div",{children:y.jsx("span",{children:"Active Status:"})})}),y.jsx("div",{className:"inputStaffHeaderRight",children:y.jsx("div",{children:y.jsx(Ey,{toggled:u,label:"isActive",onClick:f})})})]}),y.jsx("div",{className:"applicationForm",children:y.jsx("div",{className:"applicationInputWrapper",children:y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Region Information"})}),y.jsxs("div",{className:"applicationItems",children:[y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"staffAddress",children:"Code:"}),y.jsx("input",{type:"text",name:"staffAddress",id:"staffAddress",value:H,onChange:_t=>X(_t.target.value)})]}),y.jsxs("div",{className:"applicationItem",children:[y.jsx("label",{htmlFor:"staffAddress",children:"Name:"}),y.jsx("input",{type:"text",name:"staffAddress",id:"staffAddress",onChange:_t=>G(_t.target.value),value:F})]}),y.jsx("br",{}),y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Zones"})}),ne.map((_t,yt)=>y.jsxs("div",{className:"applicationItem zones",onMouseEnter:()=>Te(yt),onMouseLeave:()=>Te(!1),children:[se===yt&&y.jsx("div",{className:"removeItemButton",children:y.jsx(Mc,{className:"clearPhotoIcon",onClick:()=>{let Et=[...ne];Et.splice(yt,1),ie(Et)}})}),y.jsxs("label",{htmlFor:"staffAddress",children:[yt+1," :"]}),y.jsx("input",{type:"text",name:"staffAddress",id:"staffAddress",value:ne[yt],onChange:Et=>{let Wt=[...ne];Wt[yt]=Et.target.value,ie(Wt)}})]},yt)),y.jsx("button",{onClick:()=>{let _t=[...ne];_t.push(""),ie(_t)},children:"Add"})]})]})})}),y.jsx("footer",{children:y.jsx("button",{disabled:w,onClick:e.modalType==="edit"?Ge:tt,className:"primary",children:w?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):e.modalType==="edit"?"Update":"Save"})})]}),y.jsx(Pu,{})]})]})}function Vne(){const[e,n]=fe.useState(!0),[a,u]=fe.useState(null),f=Ia(),[w,p]=fe.useState();return fe.useEffect(()=>{(async()=>{try{let L={}.VITE_SERVER;const F=await Zi.get(`${L}/admin/region`);u(F.data),n(!1)}catch(L){let F=L.response?L.response.data.message:L.message;setTimeout(()=>{ai.error(F,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:f})},0),n(!1)}})()},[w]),new Date().toISOString().slice(0,10),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsxs("div",{className:"Office",children:[y.jsx(zm,{}),y.jsxs("div",{className:"OfficeWrapper",children:[y.jsx("div",{className:"OfficeSideBar",children:y.jsx(Nm,{selected:"office"})}),y.jsxs("div",{className:"OfficeMiddleBar",children:[y.jsxs(vh,{topBarData:{action:"Region List",options:y.jsx(nz,{buttonClass:"addStaffButton primary",buttonName:"Add New Region",setReload:p,modalType:"add"})},children:[e&&y.jsx(b_,{}),a&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"listQuery",children:[y.jsxs("div",{className:"listQueryOptions",children:[y.jsx("span",{children:"STATUS: "}),y.jsxs("select",{name:"listQueryOption",id:"listQueryOption",children:[y.jsx("option",{value:"active",selected:!0,children:"Active"}),y.jsx("option",{value:"inactive",children:"Inactive"})]})]}),y.jsx("div",{children:y.jsx("input",{type:"text",placeholder:"Search list..."})}),y.jsxs("div",{className:"listCount",children:[y.jsx("span",{children:"Count:"}),y.jsx("span",{children:a.length})]}),y.jsxs("div",{className:"listSort",children:[y.jsx("span",{children:"Latest to Oldest"}),y.jsx(My,{})]})]}),y.jsxs("div",{className:"adminStaffListHeader",children:[y.jsx("span",{className:"adminRegionListHeader__code",children:" Code"}),y.jsx("span",{className:"adminRegionListHeader__name",children:"Name"}),y.jsx("span",{className:"adminRegionListHeader__zones",children:"Zones"}),y.jsx("span",{className:"adminRegionListHeader__status",children:"Status"}),y.jsx("span",{className:"adminRegionListHeader__edit",children:"Edit"})]}),y.jsxs("div",{className:"adminStaffListCardWrapper",children:[a.length<1?y.jsx("p",{className:"nodatacurrently",children:"No Data Currently"}):"",a.map(s=>{var L;return y.jsxs("div",{className:" adminOfficeListCard",children:[y.jsxs("div",{className:"adminRegionListCard__code",children:[((L=s==null?void 0:s.code)==null?void 0:L.toUpperCase())||""," "]}),y.jsx("div",{className:"adminRegionListCard__name",children:s==null?void 0:s.name}),y.jsxs("div",{className:"adminRegionListCard__zones",children:[" ",s.zones.join(",   ")]}),y.jsxs("div",{className:s.isActive?"adminRegionListCard__status active":"adminRegionListCard__status inactive",children:[s.isActive?"Active":"Inactive"," "]}),y.jsx("div",{className:"adminRegionListCard__edit",children:y.jsx(nz,{data:s,setReload:p,buttonName:"Edit",modalType:"edit"})})]})})]})]})]}),y.jsx(Pu,{})]})]})]})]})}function Une(){return y.jsxs("div",{className:"documentViewerContainer",children:[y.jsxs("div",{className:"documentViewerTopControl",children:[y.jsx(bH,{className:"documentViewerIcon"}),y.jsx(wH,{className:"documentViewerIcon"}),y.jsx(SH,{className:"documentViewerIcon"}),y.jsx(hH,{className:"documentViewerIcon"}),y.jsx(uH,{className:"documentViewerIcon"})]}),y.jsx("span",{children:"DocumentViewer"}),y.jsxs("div",{className:"documentViewerBottomControl",children:[y.jsxs("div",{children:["Page ",y.jsx("input",{type:"number",name:"",id:"",min:"1"})," of 45"]}),y.jsx("div",{children:"Comment"})]})]})}function qB(){const[e,n]=fe.useState(1);return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"documentViewContainer",children:[y.jsx(Lf,{}),y.jsx(vh,{style:{background:"transparent"},topBarData:{action:"Environmental Impact Analysis",planNumber:"BC/3421/2023"},children:y.jsx(Une,{})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{setRightBarView:n}):y.jsx(Oy,{setRightBarView:n})})]})]})}function $ne({buttonIcon:e,buttonText:n,children:a,data:u,reload:f}){var rt;const[w,p]=fe.useState(!1),[s,L]=fe.useState(!1);fe.useState(u);const[F,G]=fe.useState([]),[H,X]=fe.useState([]),[ne,ie]=fe.useState(!1),se=Ia(),Te=()=>p(!0),ue=()=>p(!1),ce="Escape",de="keyup";Ee(ue);function Ee(tt){const Ge=fe.useCallback(_t=>{_t.key===ce&&tt()},[tt]);fe.useEffect(()=>(document.addEventListener(de,Ge,!1),()=>{document.removeEventListener(de,Ge,!1)}),[Ge])}const Ne=async tt=>{tt.preventDefault(),L(!0);const Ge=new FormData(tt.target);let _t={newOfficeId:Ge.get("minuteToOfficer"),status:Ge.get("minuteStatus"),text:Ge.get("minuteText"),date:Ge.get("minuteItemData"),fromOfficeId:Ge.get("minuteFromOffice")};Zi.defaults.withCredentials=!0;try{let yt={}.VITE_SERVER;const Et=await Zi.post(`${yt}/admin/plan/${u._id}/minute`,_t,{withCredentials:!0});f(()=>[]),ue(),setTimeout(()=>{ai.success(Et.data,{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:se})},200)}catch(yt){let Et=yt.response?yt.response.data.message:yt.message;ai.error(Et,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:se})}L(!1)};return fe.useEffect(()=>{const tt=document.querySelector(".modalView");tt&&(w?tt.showModal():tt.close())},[w]),fe.useEffect(()=>{ie(!0),(async()=>{Zi.defaults.withCredentials=!0;try{let Ge={}.VITE_SERVER;const _t=await Promise.all([Zi.get(`${Ge}/admin/office`,{withCredentials:!0}),Zi.get(`${Ge}/admin/staff/active`,{withCredentials:!0})]),yt=_t[0].data,Et=_t[1].data;let Wt=Et.filter(mt=>{var nr;return(nr=mt==null?void 0:mt.office)==null?void 0:nr.some(Xt=>{var Ht,Qt,sr;return((Ht=Xt==null?void 0:Xt.id)==null?void 0:Ht._id)===((sr=(Qt=u==null?void 0:u.currentOffice)==null?void 0:Qt.id)==null?void 0:sr._id)})});X(Wt);let Ar=yt.map(mt=>{let nr=Et.filter(Ht=>Ht.office.some(Qt=>{var sr;return((sr=Qt==null?void 0:Qt.id)==null?void 0:sr._id)===mt._id})),Xt;return nr.length===0?Xt=`${mt.name}`:nr.length>1?Xt=`${mt.name} (Multiple)`:Xt=`${mt.name} (${nr[0].fullName})`,{office:mt,officeId:mt._id,text:Xt}});G(Ar.sort((mt,nr)=>{const Xt=mt.text.toUpperCase(),Ht=nr.text.toUpperCase();return Xt<Ht?-1:Xt>Ht?1:0})),ie(!1)}catch(Ge){Ge.response?Ge.response.data.message:Ge.message}})()},[]),y.jsxs("div",{children:[y.jsx("div",{children:y.jsx("button",{className:"modalTrigger primary",onClick:Te,children:"Minute"})}),w&&y.jsx("dialog",{className:"modalView",children:ne?y.jsx("div",{className:"loading-container",children:y.jsx(kc,{thickness:3,size:55,className:"loading-icon"})}):y.jsxs(y.Fragment,{children:[y.jsxs("header",{children:[y.jsx("span",{children:((rt=u==null?void 0:u.planNumber)==null?void 0:rt.fullValue)||(u==null?void 0:u.uniqueId)}),y.jsx("div",{className:"modalViewCloseButton",onClick:ue,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsxs("form",{action:"",onSubmit:Ne,children:[y.jsxs("div",{className:"applicationItemsWrapper",children:[y.jsx("div",{className:"applicationTitle",children:y.jsx("h3",{children:"Minute Plan"})}),y.jsx("div",{children:y.jsxs("div",{className:"minuteItems",children:[y.jsxs("div",{className:"minuteItem",children:[y.jsxs("label",{htmlFor:"minuteItemData",children:["Date:"," ",y.jsx("span",{className:"optionIssueTag",children:"Do not select a date except for backlog"})]}),y.jsx("input",{type:"date",name:"minuteItemData",id:"minuteItemData"})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteToOfficer",children:"From Office:"}),y.jsxs("select",{name:"minuteFromOffice",id:"minuteFromOffice",children:[y.jsx("option",{value:""}),F.map(tt=>{if(tt!=null&&tt.officeId)return y.jsx("option",{value:tt.officeId,children:tt.text},tt.officeId)})]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteToOfficer",children:"To Office:"}),y.jsxs("select",{name:"minuteToOfficer",id:"minuteToOfficer",children:[y.jsx("option",{value:""}),F.map(tt=>{if(tt!=null&&tt.officeId)return y.jsx("option",{value:tt.officeId,children:tt.text},tt.officeId)})]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteStatus",children:"Status:"}),y.jsxs("select",{required:!0,name:"minuteStatus",id:"minuteStatus",children:[y.jsx("option",{value:"",children:"..."}),J4.map(tt=>y.jsx("option",{value:tt,children:tt}))]})]}),y.jsxs("div",{className:"minuteItem",children:[y.jsx("label",{htmlFor:"minuteText",children:"Comment:"}),y.jsx("textarea",{required:!0,name:"minuteText",id:"minuteText",cols:"30",rows:"7"})]})]})})]}),y.jsx("footer",{children:y.jsx("button",{type:"submit",className:"primary",children:s?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):"Minute"})})]})]})})]})}function Gne(){var X,ne,ie,se,Te,ue,ce,de,Ee,Ne,rt,tt,Ge,_t,yt,Et,Wt,Ar,mt;const[e,n]=fe.useState(0);fe.useState("");const[a,u]=fe.useState(!0),[f,w]=fe.useState(null),p=Ia(),[s,L]=fe.useState(),F=Ay(),G=Vp(),H=async()=>{u(!0);try{let nr={}.VITE_SERVER;const Xt=await Zi.get(`${nr}/admin/plan/${F.id}`);w(()=>Xt.data),u(!1)}catch(nr){let Xt=nr.response?nr.response.data.message:nr.message;setTimeout(()=>{ai.error(Xt,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:p})},0),u(!1)}};return fe.useEffect(()=>{G.state?(w(G.state),u(!1)):H()},[]),fe.useEffect(()=>{H()},[s,F.id]),new Date().toISOString().slice(0,10),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(zm,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Nm,{selected:"office"}),y.jsx(vh,{topBarData:{action:"Plan Info",planNumber:f!=null&&f.planNumber?`${(ie=(ne=(X=f==null?void 0:f.dev)==null?void 0:X.region)==null?void 0:ne.substring(0,3))==null?void 0:ie.toUpperCase()}/${(se=f==null?void 0:f.planNumber)==null?void 0:se.value}/${(ue=new Date((Te=f==null?void 0:f.planNumber)==null?void 0:Te.date))==null?void 0:ue.getFullYear()}`:f==null?void 0:f.uniqueId},children:a?y.jsx(b_,{}):f&&y.jsxs("div",{className:"planInfo",children:[y.jsx("div",{className:f.approval.status==="approved"?"watermark approved":f.approval.status==="kiv"?"watermark kiv":f.approval.status==="rejected"?"watermark rejected":"watermark processing",children:y.jsx("span",{children:f.approval.status==="approved"?"APPROVED":f.approval.status==="kiv"?"KIV":f.approval.status==="rejected"?"REJECTED":""})}),y.jsxs("div",{className:"planInfoSummary",children:[y.jsxs("div",{className:"planInfoSummaryDetails",children:[y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"File Name:"}),y.jsxs("span",{className:"planInfoSummaryText large",children:[(de=(ce=f.applicant)==null?void 0:ce.name)==null?void 0:de.toLowerCase(),((Ee=f.dev)==null?void 0:Ee.name)&&` (${(rt=(Ne=f.dev)==null?void 0:Ne.name)==null?void 0:rt.toLowerCase()})`]})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"Site Location:"}),y.jsxs("span",{className:"planInfoSummaryText large",children:[((tt=f.dev)==null?void 0:tt.plotNo)&&((Ge=f.dev)==null?void 0:Ge.plotNo)+","," ",((_t=f.dev)==null?void 0:_t.address)&&((Et=(yt=f.dev)==null?void 0:yt.address)==null?void 0:Et.toLowerCase())]})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[y.jsx("span",{className:"planInfoSummaryTitle",children:"Current Office:"}),y.jsxs("span",{className:"planInfoSummaryText",children:[y.jsxs("span",{className:"planInfoSummaryStack",children:[(Ar=(Wt=f.currentOffice)==null?void 0:Wt.id)==null?void 0:Ar.name," Office"]}),"."]})]}),y.jsxs("div",{className:"planInfoSummaryItem",children:[(f.isFastTrack||f.isFileOfInterest||f.isOldFile)&&y.jsx("span",{className:"planInfoSummaryTitle",children:"Tags:"}),y.jsxs("span",{className:"planInfoSummaryText",children:[f.isFastTrack&&y.jsx("span",{className:"tag tag-fastTrack",children:"Fast Track"}),f.isOldFile&&y.jsx("span",{className:"tag tag-oldFile",children:"Old File"}),f.isFileOfInterest&&y.jsx("span",{className:"tag tag-fileOfInterest",children:"File Of Interest"})]})]})]}),y.jsx("div",{className:"planInfoSummaryDetails2"})]}),y.jsxs("div",{className:"planInfoWrapper",children:[y.jsx(Qv,{type:(mt=f.applicant)==null?void 0:mt.type,BD:!0,data:f.applicant}),y.jsx(Qv,{type:"rep",BD:!0,data:f.rep}),y.jsx(Qv,{type:"building",data:f.dev})]}),y.jsxs("div",{className:"planInfoButtons",children:[y.jsx(a_,{to:"./bills",children:y.jsx("button",{className:"secondary",children:"View Bills"})}),y.jsx($ne,{data:f,reload:L})]})]})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{isInUserOffice:!0,admin:!0,reload:s,setRightBarView:n,plan:f}):y.jsx(Oy,{setRightBarView:n})})]}),y.jsx(Pu,{})]})}function qne(){const[e,n]=fe.useState(0),[a,u]=fe.useState(),[f,w]=fe.useState();fe.useState(),ma(s=>s.user);const p=Ay();return fe.useEffect(()=>{(async()=>{try{let L={}.VITE_SERVER;const F=await Zi.get(`${L}/admin/plan/${p.id}`);u(F.data)}catch(L){L.response?L.response.data.message:L.message}})()},[f]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(zm,{}),y.jsxs("div",{className:"planContainer",children:[y.jsx(Nm,{selected:"home"}),y.jsx(vh,{topBarData:{action:"View Bills",planNumber:"BC/3421/2023"},children:y.jsx(tB,{})}),y.jsx(Ry,{children:e!==1?y.jsx(Dy,{isInUserOffice:!0,admin:!0,reload:f,setRightBarView:n,plan:a}):y.jsx(Oy,{setRightBarView:n})})]})]})}function Xw(){return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(zm,{}),y.jsxs("div",{className:"homeContainer",children:[y.jsx(Nm,{}),y.jsx("div",{className:"homePage",children:y.jsx(ub,{children:y.jsx("div",{className:"inDevelopmentText",children:"In Progress..."})})})]})]})}function Wne(){const{currentAdmin:e}=ma(u=>u.admin),n=ql(),{theme:a}=ma(u=>u.app);return fe.useEffect(()=>{V4(a)},[a]),fe.useEffect(()=>{e||n("/login")},[e]),y.jsx(y.Fragment,{children:e?y.jsxs(Mj,{children:[y.jsx(Di,{path:"/",children:y.jsx(Di,{index:!0,element:y.jsx(zne,{})})}),y.jsx(Di,{path:"/login",children:y.jsx(Di,{index:!0,element:y.jsx(ez,{})})}),y.jsxs(Di,{path:"/permit",children:[y.jsx(Di,{path:"new",element:y.jsx(DB,{})}),y.jsxs(Di,{path:":id",children:[y.jsx(Di,{index:!0,element:y.jsx(Gne,{})}),y.jsx(Di,{path:"bills",element:y.jsx(qne,{})}),y.jsx(Di,{path:"documents",element:y.jsx(qB,{})})]}),y.jsx(Di,{path:"office",children:y.jsx(Di,{path:":id",element:y.jsx(GB,{})})})]}),y.jsxs(Di,{path:"/staffs",children:[y.jsx(Di,{index:!0,element:y.jsx(Nne,{})}),y.jsxs(Di,{path:"staff",children:[y.jsx(Di,{index:!0,element:y.jsx(jne,{})}),y.jsx(Di,{path:"bills",element:y.jsx(wA,{})}),y.jsx(Di,{path:"createbill",element:y.jsx(bA,{})}),y.jsx(Di,{path:"minute",element:y.jsx(xA,{})})]})]}),y.jsxs(Di,{path:"/offices",children:[y.jsx(Di,{index:!0,element:y.jsx(Bne,{})}),y.jsxs(Di,{path:"office",children:[y.jsx(Di,{index:!0,element:y.jsx(Fne,{})}),y.jsx(Di,{path:"bills",element:y.jsx(wA,{})}),y.jsx(Di,{path:"createbill",element:y.jsx(bA,{})}),y.jsx(Di,{path:"minute",element:y.jsx(xA,{})})]})]}),y.jsx(Di,{path:"/regions",children:y.jsx(Di,{index:!0,element:y.jsx(Vne,{})})}),y.jsx(Di,{path:"/permit",children:y.jsx(Di,{index:!0,element:y.jsx(Xw,{})})}),y.jsx(Di,{path:"/public",children:y.jsx(Di,{index:!0,element:y.jsx(Xw,{})})}),y.jsx(Di,{path:"/activities",children:y.jsx(Di,{index:!0,element:y.jsx(Xw,{})})}),y.jsx(Di,{path:"/analysis",children:y.jsx(Di,{index:!0,element:y.jsx(Xw,{})})})]}):y.jsx(ez,{})})}function Hne({...e}){const[n,a]=fe.useState(!1),[u,f]=fe.useState(!0),[w,p]=fe.useState(!1),[s,L]=fe.useState(""),[F,G]=fe.useState(!1),[H,X]=fe.useState(""),[ne,ie]=fe.useState(""),[se,Te]=fe.useState(""),[ue,ce]=fe.useState(""),de=Ia(),Ee=()=>a(!0),Ne=()=>{X(""),f(!0),a(!1)},rt=Ge=>{if(G(!0),H===""||ne===""||ne!==se){L("Passwords do not match"),G(!1);return}u?(async Et=>{try{let Wt={}.VITE_SERVER;const Ar=await Zi.post(`${Wt}/staffs/staff/send-otp`,{email:Et});G(!1),f(!1)}catch(Wt){G(!1);let Ar=Wt.response?Wt.response.data.message:Wt.message;ai.error(Ar,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})}})(H):u||(async(Et,Wt,Ar)=>{try{let mt={}.VITE_SERVER;const nr=await Zi.post(`${mt}/staffs/auth/change-password`,{email:Et,password:Wt,otp:Ar});G(!1),f(!0),a(!1),setTimeout(()=>{ai.success(nr.data,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de})},0)}catch(mt){let nr=mt.response?mt.response.data.message:mt.message;ai.error(nr,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:de}),G(!1)}})(H,ne,ue)};tt(Ne,"Escape","keyup"),tt(rt,"Enter","keydown");function tt(Ge,_t,yt){const Et=fe.useCallback(Wt=>{Wt.key===_t&&Ge()},[Ge]);fe.useEffect(()=>(document.addEventListener(yt,Et,!1),()=>{document.removeEventListener(yt,Et,!1)}),[Et])}return fe.useEffect(()=>{const Ge=document.querySelector(".changePasswordModal");return Ge&&(n?Ge.showModal():Ge.close()),()=>{}},[n]),y.jsxs("div",{children:[y.jsx("p",{className:e.class,onClick:Ee,children:e.name}),n&&y.jsx("dialog",{className:"modalView changePasswordModal ",children:y.jsxs("div",{className:"",children:[y.jsxs("header",{children:[y.jsx("span",{children:"Change Password"}),y.jsx("div",{className:"modalViewCloseButton",onClick:Ne,children:y.jsx(Mc,{className:"closeButton"})})]}),y.jsx("div",{className:"login__form",children:u?y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"",children:"Enter your email address and a new and unique password. Select continue to receive an email containing an OTP Code. Enter the OTP code to successfully change your password."}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"emailUpdate",children:"Email"}),y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(iM,{className:"formIcon"})}),y.jsx("input",{type:"email",name:"emailUpdate",id:"emailUpdate",placeholder:"Enter your email address",required:!0,onChange:Ge=>X(Ge.target.value)})]})]}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"passwordUpdate1",children:"New Password"}),y.jsxs("div",{className:s&&"passwordErrorDiv",children:[y.jsx("span",{children:y.jsx(cS,{className:"formIcon"})}),y.jsx("input",{type:w?"text":"password",name:"passwordUpdate1",id:"passwordUpdate1",placeholder:"Enter new password",required:!0,onChange:Ge=>{ie(Ge.target.value),L("")}}),y.jsx("span",{className:"btn",onClick:()=>p(!w),children:w?y.jsx(hS,{className:"formIcon"}):y.jsx(uS,{className:"formIcon"})})]})]}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"passwordUpdate2",children:"Confirm New Password"}),y.jsxs("div",{className:s&&"passwordErrorDiv",children:[y.jsx("span",{children:y.jsx(cS,{className:"formIcon"})}),y.jsx("input",{type:w?"text":"password",name:"passwordUpdate2",id:"passwordUpdate2",placeholder:"Confirm new password",required:!0,onChange:Ge=>{Te(Ge.target.value),L("")}}),y.jsx("span",{className:"btn",onClick:()=>p(!w),children:w?y.jsx(hS,{className:"formIcon"}):y.jsx(uS,{className:"formIcon"})}),s&&y.jsx("span",{className:"passwordErrorText",children:s})]})]})]}):y.jsxs(y.Fragment,{children:[y.jsx("p",{className:"form-greeting",children:"An email containing your OTP Code has been sent. Check your email"}),y.jsxs("div",{className:"form-input otp-code",children:[y.jsx("label",{htmlFor:"email",children:"Enter OTP Code"}),y.jsx("div",{children:y.jsx("input",{type:"otpCode",name:"otpCode",id:"otpCode",required:!0,onChange:Ge=>ce(Ge.target.value)})})]})]})}),y.jsx("footer",{children:y.jsx("button",{type:"button",className:"btn primary",disabled:F,onClick:rt,children:F?y.jsx(kc,{thickness:5,size:20,sx:{color:"white"}}):u?"Continue":"Submit"})}),y.jsx(Pu,{})]})})]})}function iz(){const[e,n]=fe.useState(!1),{currentUser:a,loading:u}=ma(H=>H.user),f=Ia(),w=eu(),p=ql(),s=fe.useRef(),L=fe.useRef(),F={}.VITE_TIMEOUT;Zi.interceptors.request.use(H=>(H.timeout=F,H.signal=AbortSignal.timeout(F),H)),Zi.interceptors.response.use(H=>H,H=>((H.code==="ECONNABORTED"||H.code==="ERR_CANCELED")&&(H.message="Request timed out"),Promise.reject(H))),Zi.defaults.withCredentials=!0;const G=async H=>{H.preventDefault(),w(RK());try{let X={}.VITE_SERVER;const ne=await Zi.post(`${X}/staffs/auth/login`,{email:s.current.value,password:L.current.value});w($4(ne.data)),p("/"),setTimeout(()=>{ai.success("Login Successful",{position:"top-right",autoClose:1e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:f})},200)}catch(X){let ne=X.response?X.response.data.message:X.message;ai.error(ne,{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:f}),w(YO())}u&&w(YO())};return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"login",children:[y.jsx("div",{className:"pageWrapper"}),y.jsx("section",{className:"login__header",children:y.jsxs("div",{className:"login__formBackground",children:[y.jsxs("section",{className:"app-cover__info",children:[y.jsxs("div",{className:"app-cover__info-top",children:[y.jsx("div",{className:"app-cover__info__logo",children:y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:"MPPHURD Logo"})}),y.jsx("h1",{children:"M-FLOW"})]}),y.jsx("h2",{children:"ministry of physical planning, housing, urban and regional development app"}),y.jsxs("p",{children:["For a simplified, efficient and automated ",y.jsx("br",{}),y.jsxs("span",{className:"app-cover__info--highlight",children:["Workflow ",y.jsx("span",{className:"app-cover__info--svg"})]}),"of the Ministry"]})]}),y.jsxs("form",{action:"#",className:"login__form",onSubmit:G,children:[y.jsx("div",{className:"form-logo"}),y.jsx("p",{className:"form-greeting",children:"Login to continue"}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"email",children:"Email"}),y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(iM,{className:"formIcon"})}),y.jsx("input",{type:"email",name:"email",id:"email",placeholder:"Enter your email address",required:!0,ref:s})]})]}),y.jsxs("div",{className:"form-input",children:[y.jsx("label",{htmlFor:"password",children:"Password"}),y.jsxs("div",{children:[y.jsx("span",{children:y.jsx(cS,{className:"formIcon"})}),y.jsx("input",{type:e?"text":"password",name:"password",id:"password",placeholder:"Enter your password",required:!0,ref:L}),y.jsx("span",{className:"btn",onClick:()=>n(!e),children:e?y.jsx(hS,{className:"formIcon"}):y.jsx(uS,{className:"formIcon"})})]})]}),y.jsx("div",{className:"btn password-reset",children:u?"Forgot Password":y.jsx(Hne,{name:"Forgot Password",onSubmit:H=>{H.preventDefault(),alert("WOWOWOWOWOWO")}})}),y.jsx("button",{type:"submit",className:"btn btn-form-submit",children:u?y.jsx(kc,{thickness:5,size:25,sx:{color:"white"}}):"Login"}),y.jsx(Pu,{})]})]})}),y.jsxs("footer",{className:"login__footer",children:[y.jsx("div",{className:"login__footer--copyright",children:y.jsxs("div",{children:["© ",new Date().getFullYear()," Copyright MPPHURD"]})}),y.jsxs("div",{className:"login__footer--mda",children:[y.jsxs("div",{className:"login__footer--logos",children:[y.jsx("div",{className:"login__footer--logo",children:y.jsx("img",{src:"/assets/logos/Logo-Edo State.png",alt:"Edo State Logo"})}),y.jsx("div",{className:"login__footer--logo",children:y.jsx("img",{src:"/assets/logos/Logo-Mpphurd.png",alt:"MPPHURD Logo"})})]}),y.jsx("div",{className:"login__footer--text",children:"EDO STATE MINISTRY OF PHYSICAL PLANNING, HOUSING, URBAN AND REGIONAL DEVELOPMENT"})]}),y.jsxs("div",{className:"login__footer--social",children:[y.jsxs("div",{className:"login__socialIcons",children:[y.jsx(j5,{className:"btn login__socialIcon"}),y.jsx(B5,{className:"btn login__socialIcon"}),y.jsx(q5,{className:"btn login__socialIcon"})]}),y.jsx("div",{className:"login__socialText",children:y.jsx("p",{children:"Follow On Social Media"})})]})]})]})})}function Zne(){var a,u;const{currentUser:e,loading:n}=ma(f=>f.user);return eu(),ql(),fe.useState(!0),fe.useState(null),fe.useState(),fe.useState(!1),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"homeContainer",children:[y.jsx(Lf,{}),y.jsx("div",{className:"officeSelect",children:y.jsx(ub,{children:y.jsxs("div",{className:"feedCard__container",children:[y.jsx("h2",{className:"feedCard__title",children:((a=e==null?void 0:e.office)==null?void 0:a.length)>1?"OFFICES":"OFFICE"}),y.jsx("div",{className:"feedCard__list",children:(u=e==null?void 0:e.office)==null?void 0:u.map(f=>y.jsx(OC,{route:`office/${f.id._id}`,priText:f.id.name,secText:"Office",data:f},f.id._id))})]})})})]})]})}function Qx(){return y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"pageWrapper"}),y.jsx(Of,{}),y.jsxs("div",{className:"homeContainer",children:[y.jsx(Lf,{}),y.jsx(ub,{children:y.jsx("div",{className:"inDevelopmentText",children:"In Progress..."})})]})]})}function Xne(){const e=ql(),{currentUser:n}=ma(u=>u.user),{theme:a}=ma(u=>u.app);return fe.useEffect(()=>{V4(a)},[a]),fe.useEffect(()=>{n||e("/login")},[n]),y.jsx(y.Fragment,{children:n?y.jsxs(Mj,{children:[y.jsx(Di,{path:"/",children:y.jsx(Di,{index:!0,element:y.jsx(Gre,{})})}),y.jsx(Di,{path:"/login",children:y.jsx(Di,{index:!0,element:y.jsx(iz,{})})}),y.jsxs(Di,{path:"/permit",children:[y.jsx(Di,{index:!0,element:y.jsx(Zne,{})}),y.jsx(Di,{path:"new",element:y.jsx(DB,{})}),y.jsxs(Di,{path:":id",children:[y.jsx(Di,{index:!0,element:y.jsx(Zre,{})}),y.jsx(Di,{path:"bills",element:y.jsx(wA,{})}),y.jsx(Di,{path:"create_bill",element:y.jsx(bA,{})}),y.jsx(Di,{path:"minute",element:y.jsx(xA,{})}),y.jsx(Di,{path:"documents",element:y.jsx(qB,{})})]}),y.jsx(Di,{path:"office",children:y.jsx(Di,{path:":id",element:y.jsx(GB,{})})})]}),y.jsx(Di,{path:"/petition",children:y.jsx(Di,{index:!0,element:y.jsx(Qx,{})})}),y.jsx(Di,{path:"/b_control",children:y.jsx(Di,{index:!0,element:y.jsx(Qx,{})})}),y.jsx(Di,{path:"/d_control",children:y.jsx(Di,{index:!0,element:y.jsx(Qx,{})})}),y.jsx(Di,{path:"/activities",children:y.jsx(Di,{index:!0,element:y.jsx(Qx,{})})}),y.jsx(Di,{path:"/analysis",children:y.jsx(Di,{index:!0,element:y.jsx(Qx,{})})})]}):y.jsx(iz,{})})}function Yne(){const[e,n]=fe.useState(null);return fe.useEffect(()=>{const u=window.location.host.split(".");u[0].toLowerCase()==="admin-mpphurd"?n("admin"):u[0].toLowerCase()==="mpphurd"&&n("staff")},[window.location.host]),y.jsx(y.Fragment,{children:e==="staff"?y.jsx(Xne,{}):e==="admin"?y.jsx(Wne,{}):""})}function S2(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S2=function(a){return typeof a}:S2=function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},S2(e)}function Kne(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function oz(e,n){for(var a=0;a<n.length;a++){var u=n[a];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function Jne(e,n,a){return n&&oz(e.prototype,n),a&&oz(e,a),e}function Qne(e,n){return n&&(S2(n)==="object"||typeof n=="function")?n:T2(e)}function SA(e){return SA=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},SA(e)}function T2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eie(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&TA(e,n)}function TA(e,n){return TA=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u},TA(e,n)}function E2(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}var WB=function(e){eie(n,e);function n(){var a,u;Kne(this,n);for(var f=arguments.length,w=new Array(f),p=0;p<f;p++)w[p]=arguments[p];return u=Qne(this,(a=SA(n)).call.apply(a,[this].concat(w))),E2(T2(u),"state",{bootstrapped:!1}),E2(T2(u),"_unsubscribe",void 0),E2(T2(u),"handlePersistorState",function(){var s=u.props.persistor,L=s.getState(),F=L.bootstrapped;F&&(u.props.onBeforeLift?Promise.resolve(u.props.onBeforeLift()).finally(function(){return u.setState({bootstrapped:!0})}):u.setState({bootstrapped:!0}),u._unsubscribe&&u._unsubscribe())}),u}return Jne(n,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),n}(fe.PureComponent);E2(WB,"defaultProps",{children:null,loading:null});Zi.defaults.withCredentials=!0;kI.createRoot(document.getElementById("root")).render(y.jsx(ts.StrictMode,{children:y.jsx(O7,{store:Z4,children:y.jsx(WB,{loading:null,persistor:YK,children:y.jsx(V9,{children:y.jsx(Yne,{})})})})}));
